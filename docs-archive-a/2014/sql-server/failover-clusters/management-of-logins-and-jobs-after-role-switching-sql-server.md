---
title: Gestione di account di accesso e di processi dopo un cambio di ruolo (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
ms.assetid: fc2fc949-746f-40c7-b5d4-3fd51ccfbd7b
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 9c099bf9ea271b5ea93fdebfe8f35c98864bca09
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628286"
---
# <a name="management-of-logins-and-jobs-after-role-switching-sql-server"></a><span data-ttu-id="69549-102">Gestione di account di accesso e di processi dopo un cambio di ruolo (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="69549-102">Management of Logins and Jobs After Role Switching (SQL Server)</span></span>
  <span data-ttu-id="69549-103"> Quando si distribuisce una soluzione di disponibilità elevata e ripristino di emergenza per un database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], è importante riprodurre le informazioni più significative archiviate per il database nei database **master** o **msdb**.</span><span class="sxs-lookup"><span data-stu-id="69549-103">When deploying a high-availability or disaster-recovery solution for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, it is important to reproduce relevant information that is stored for the database in the **master** or **msdb** databases.</span></span> <span data-ttu-id="69549-104">In genere, tra queste informazioni sono inclusi i processi del database primario/principale e gli account di accesso di utenti o processi necessari per la connessione al database.</span><span class="sxs-lookup"><span data-stu-id="69549-104">Typically, the relevant information includes the jobs of the primary/principal database and the logins of users or processes that need to connect to the database.</span></span> <span data-ttu-id="69549-105">È consigliabile duplicare queste informazioni in qualsiasi istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in cui viene ospitato un database secondario/mirror.</span><span class="sxs-lookup"><span data-stu-id="69549-105">You should duplicate this information on any instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that hosts a secondary/mirror database.</span></span> <span data-ttu-id="69549-106">Se possibile, dopo il cambio di ruolo, è opportuno riprodurre le informazioni a livello di programmazione nel nuovo database primario/principale.</span><span class="sxs-lookup"><span data-stu-id="69549-106">If possible after roles are switched, it is best to programmatically reproduce the information on the new primary/principal database.</span></span>  
  
## <a name="logins"></a><span data-ttu-id="69549-107">Logins</span><span class="sxs-lookup"><span data-stu-id="69549-107">Logins</span></span>  
 <span data-ttu-id="69549-108">In tutte le istanze del server in cui viene ospitata una copia del database, è consigliabile riprodurre gli account di accesso con l'autorizzazione ad accedere al database principale.</span><span class="sxs-lookup"><span data-stu-id="69549-108">On every server instances that hosts a copy of the database, you should reproduce the logins that have permission to access the principal database.</span></span> <span data-ttu-id="69549-109">Quando il ruolo primario/principale cambia, solo gli utenti con account di accesso presenti nella nuova istanza del server primario/principale possono accedere al nuovo database primario/principale.</span><span class="sxs-lookup"><span data-stu-id="69549-109">When the primary/principal role switches, only users whose logins exist on the new primary/principal server instance can access the new primary/principal database.</span></span> <span data-ttu-id="69549-110">Gli utenti i cui account di accesso non sono definiti nella nuova istanza del server primario/principale sono orfani e non possono accedere al database.</span><span class="sxs-lookup"><span data-stu-id="69549-110">Users whose logins are not defined on the new primary/principal server instance are orphaned and cannot access the database.</span></span>  
  
 <span data-ttu-id="69549-111">Se un utente è orfano, creare l'account di accesso nella nuova istanza del server primario/principale ed eseguire [sp_change_users_login](/sql/relational-databases/system-stored-procedures/sp-change-users-login-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="69549-111">If a user is orphaned, create the login on the new primary/principal server instance and run [sp_change_users_login](/sql/relational-databases/system-stored-procedures/sp-change-users-login-transact-sql).</span></span> <span data-ttu-id="69549-112">Per altre informazioni, vedere [Risolvere i problemi relativi agli utenti isolati &#40;SQL Server&#41;](troubleshoot-orphaned-users-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="69549-112">For more information, see [Troubleshoot Orphaned Users &#40;SQL Server&#41;](troubleshoot-orphaned-users-sql-server.md).</span></span>  
  
###  <a name="logins-of-applications-that-use-sql-server-authentication-or-a-local-windows-login"></a><a name="SSauthentication"></a> <span data-ttu-id="69549-113">Account di accesso di applicazioni in cui viene utilizzata l'autenticazione di SQL Server o un account di accesso di Windows locale</span><span class="sxs-lookup"><span data-stu-id="69549-113">Logins Of Applications That Use SQL Server Authentication or a Local Windows Login</span></span>  
 <span data-ttu-id="69549-114">Se in un'applicazione viene utilizzata l'autenticazione di SQL Server o un account di accesso di Windows locale, i SID non corrispondenti possono impedire la risoluzione in un'istanza remota di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]da parte dell'account di accesso dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="69549-114">If an application uses SQL Server Authentication or a local Windows login, mismatched SIDs can prevent the application's login from resolving on a remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="69549-115">In caso di SID non corrispondenti, l'account di accesso diventa un utente orfano nell'istanza del server remoto.</span><span class="sxs-lookup"><span data-stu-id="69549-115">The mismatched SIDs cause the login to become an orphaned user on the remote server instance.</span></span> <span data-ttu-id="69549-116">Questo problema si può verificare quando tramite un'applicazione si effettua la connessione a un database di log shipping o con mirroring dopo un failover o a un database Sottoscrittore di replica inizializzato da un backup.</span><span class="sxs-lookup"><span data-stu-id="69549-116">This issue can occur when an application connects to a mirrored or log shipping database after a failover or to a replication subscriber database that was initialized from a backup.</span></span>  
  
 <span data-ttu-id="69549-117">Per evitare questo problema, è consigliabile intraprendere misure preventive quando si configura un'applicazione di questo tipo per utilizzare un database ospitato da un'istanza remota di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="69549-117">To prevent this issue, we recommend that you take preventative measures when you set up such an application to use a database that is hosted by a remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="69549-118">La prevenzione comporta il trasferimento degli account di accesso e delle password dall'istanza locale di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] all'istanza remota di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="69549-118">Prevention involves transferring the logins and the passwords from the local instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="69549-119">Per altre informazioni su come evitare questo problema, vedere l'articolo della Knowledge Base 918992 relativo alla[modalità di trasferimento degli account di accesso e delle password tra le istanze di SQL Server](https://support.microsoft.com/kb/918992/).</span><span class="sxs-lookup"><span data-stu-id="69549-119">For more information about how to prevent this issue, see KB article 918992 -[How to transfer logins and passwords between instances of SQL Server](https://support.microsoft.com/kb/918992/)).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="69549-120">Questo problema influisce sugli account di Windows locali in computer diversi.</span><span class="sxs-lookup"><span data-stu-id="69549-120">This problem affects Windows local accounts on different computers.</span></span> <span data-ttu-id="69549-121">Tuttavia, non si verifica in caso di account di dominio, dal momento che il SID è identico in ogni computer.</span><span class="sxs-lookup"><span data-stu-id="69549-121">However, this problem does not occur for domain accounts because the SID is the same on each of the computers.</span></span>  
  
 <span data-ttu-id="69549-122">Per altre informazioni, vedere la pagina relativa agli [utenti orfani con log shipping e mirroring del database](https://blogs.msdn.com/b/sqlserverfaq/archive/2009/04/13/orphaned-users-with-database-mirroring-and-log-shipping.aspx) (blog del motore di database).</span><span class="sxs-lookup"><span data-stu-id="69549-122">For more information, see [Orphaned Users with Database Mirroring and Log Shipping](https://blogs.msdn.com/b/sqlserverfaq/archive/2009/04/13/orphaned-users-with-database-mirroring-and-log-shipping.aspx) (a Database Engine blog).</span></span>  
  
## <a name="jobs"></a><span data-ttu-id="69549-123">Processi</span><span class="sxs-lookup"><span data-stu-id="69549-123">Jobs</span></span>  
 <span data-ttu-id="69549-124">I processi, ad esempio quelli di backup, richiedono una particolare attenzione.</span><span class="sxs-lookup"><span data-stu-id="69549-124">Jobs, such as backup jobs, require special consideration.</span></span> <span data-ttu-id="69549-125">Dopo un cambio di ruolo, in genere il proprietario del database o l'amministratore di sistema deve ricreare i processi per il nuovo database primario/principale.</span><span class="sxs-lookup"><span data-stu-id="69549-125">Typically, after a role switch, the database owner or system administrator must re-create the jobs for the new primary/principal database.</span></span>  
  
 <span data-ttu-id="69549-126">Se l'istanza del server primario/principale precedente è disponibile, è consigliabile eliminare i processi originali nell'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]in questione.</span><span class="sxs-lookup"><span data-stu-id="69549-126">When the former primary/principal server instance is available, you should delete the original jobs on that instanceof [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="69549-127">Si noti che i processi nel database mirror attuale non vengono eseguiti poiché il database si trova nello stato RESTORING e, pertanto, non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="69549-127">Note that jobs on the current mirror database fail because it is in the RESTORING state, making it unavailable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="69549-128">È possibile che istanze differenti di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] siano configurate in modo diverso, ad esempio con lettere di unità differenti.</span><span class="sxs-lookup"><span data-stu-id="69549-128">Different instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might be configured differently, with different drive letters or such.</span></span> <span data-ttu-id="69549-129">I processi di ogni partner devono supportare eventuali differenze di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="69549-129">The jobs for each partner must allow for any such differences.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="69549-130">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="69549-130">See Also</span></span>  
 <span data-ttu-id="69549-131">[Gestire i metadati quando si rende disponibile un database in un'altra istanza del server &#40;SQL Server&#41;](../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md) </span><span class="sxs-lookup"><span data-stu-id="69549-131">[Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;](../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md) </span></span>  
 [<span data-ttu-id="69549-132">Risolvere i problemi relativi agli utenti isolati &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="69549-132">Troubleshoot Orphaned Users &#40;SQL Server&#41;</span></span>](troubleshoot-orphaned-users-sql-server.md)  
  
  
