---
title: Riferimenti a codice personalizzato e ad assembly in espressioni in Progettazione report (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721216"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="9a366-102">Riferimenti a codice personalizzato e ad assembly in espressioni in Progettazione report (SSRS)</span><span class="sxs-lookup"><span data-stu-id="9a366-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="9a366-103">È possibile aggiungere riferimenti a codice personalizzato incorporato in un report o ad assembly personalizzati compilati e salvati nel computer in uso e distribuiti nel server di report.</span><span class="sxs-lookup"><span data-stu-id="9a366-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="9a366-104">Usare codice incorporato per costanti personalizzate, funzioni complesse o funzioni usate più volte in un singolo report.</span><span class="sxs-lookup"><span data-stu-id="9a366-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="9a366-105">Usare gli assembly di codice personalizzati per mantenere il codice in un'unica posizione e condividerne l'utilizzo in più report.</span><span class="sxs-lookup"><span data-stu-id="9a366-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="9a366-106">Il codice personalizzato può includere nuove costanti, variabili, funzioni o subroutine personalizzate.</span><span class="sxs-lookup"><span data-stu-id="9a366-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="9a366-107">È possibile includere riferimenti di sola lettura a raccolte predefinite come ad esempio Parameters.</span><span class="sxs-lookup"><span data-stu-id="9a366-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="9a366-108">Non è tuttavia possibile passare alle funzioni personalizzate set di valori di dati. In particolare, non sono supportate le aggregazioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="9a366-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9a366-109">Per i calcoli che dipendono dal tempo, valutati una volta sola in fase di esecuzione e di cui si desidera mantenere inalterato il valore durante tutta l'elaborazione del report, considerare se utilizzare una variabile di report o una variabile di gruppo.</span><span class="sxs-lookup"><span data-stu-id="9a366-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="9a366-110">Per altre informazioni, vedere [Riferimenti a raccolte di variabili di report e di gruppo &#40;Generatore report e SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="9a366-111">Progettazione report è l'ambiente di creazione preferito da usare per l'aggiunta di codice personalizzato a un report.</span><span class="sxs-lookup"><span data-stu-id="9a366-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="9a366-112">Generatore report supporta l'elaborazione di report che dispongono di espressioni valide o in cui sono inclusi riferimenti agli assembly personalizzati in un server di report.</span><span class="sxs-lookup"><span data-stu-id="9a366-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="9a366-113">Generatore report non consente di aggiungere un riferimento a un assembly personalizzato.</span><span class="sxs-lookup"><span data-stu-id="9a366-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9a366-114">Tenere presente che durante un aggiornamento di un server di report, i report che dipendono dagli assembly personalizzati potrebbero richiedere passaggi aggiuntivi per il completamento dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9a366-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="9a366-115">Per altre informazioni, vedere [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="9a366-116">Utilizzo di codice personalizzato in Generatore report</span><span class="sxs-lookup"><span data-stu-id="9a366-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="9a366-117">In Generatore report è possibile aprire un report da un server di report in cui sono inclusi riferimenti agli assembly personalizzati.</span><span class="sxs-lookup"><span data-stu-id="9a366-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="9a366-118">Ad esempio, è possibile modificare report creati e distribuiti tramite Progettazione report in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9a366-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9a366-119">Gli assembly personalizzati devono essere distribuiti nel server di report.</span><span class="sxs-lookup"><span data-stu-id="9a366-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="9a366-120">Non è possibile effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="9a366-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="9a366-121">Aggiungere riferimenti o istanze del membro della classe a un report.</span><span class="sxs-lookup"><span data-stu-id="9a366-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="9a366-122">Visualizzare in anteprima un report con i riferimenti agli assembly personalizzati in modalità locale.</span><span class="sxs-lookup"><span data-stu-id="9a366-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="9a366-123">Inclusione di riferimenti a funzioni usate di frequente</span><span class="sxs-lookup"><span data-stu-id="9a366-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="9a366-124">Usare la finestra di dialogo **Espressione** per visualizzare un elenco per categoria di funzioni comuni predefinite di [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9a366-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="9a366-125">Quando si espande **Funzioni comuni** e fa clic su una categoria, nel riquadro **Elemento** viene visualizzato l'elenco di funzioni da includere in un'espressione.</span><span class="sxs-lookup"><span data-stu-id="9a366-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="9a366-126">Le funzioni comuni includono classi degli [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> <xref:System.Convert> spazi dei nomi e e [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] funzioni della libreria di run-time.</span><span class="sxs-lookup"><span data-stu-id="9a366-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="9a366-127">Per praticità, è possibile visualizzare le funzioni usate più di frequente nella finestra di dialogo **Espressione** , in cui sono elencate per categoria: Testo, Data e ora, Matematiche, Ispezione, Flusso programma, Aggregazione, Finanziarie, Conversione e Varie.</span><span class="sxs-lookup"><span data-stu-id="9a366-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="9a366-128">Le funzioni usate meno di frequente non sono riportate nell'elenco, ma possono comunque essere usate in un'espressione.</span><span class="sxs-lookup"><span data-stu-id="9a366-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="9a366-129">Per utilizzare una funzione predefinita, fare doppio clic sul relativo nome nel riquadro Elemento.</span><span class="sxs-lookup"><span data-stu-id="9a366-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="9a366-130">Nel riquadro Descrizione verrà visualizzata una descrizione della funzione e nel riquadro Esempio un esempio della chiamata alla funzione.</span><span class="sxs-lookup"><span data-stu-id="9a366-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="9a366-131">Nel riquadro del codice, quando si digita il nome della funzione seguito da una parentesi aperta **(**, la Guida di IntelliSense visualizza ogni sintassi valida per la chiamata di funzione.</span><span class="sxs-lookup"><span data-stu-id="9a366-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="9a366-132">Ad esempio per calcolare il valore massimo per un campo denominato `Quantity` in una tabella, aggiungere l'espressione semplice `=Max(` nel riquadro del codice, quindi usare gli smart tag per visualizzare tutte le possibili sintassi valide per la chiamata alla funzione.</span><span class="sxs-lookup"><span data-stu-id="9a366-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="9a366-133">Per completare questo esempio, digitare `=Max(Fields!Quantity.Value)`.</span><span class="sxs-lookup"><span data-stu-id="9a366-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="9a366-134">Per altre informazioni su ogni funzione, vedere <xref:System.Math>, <xref:System.Convert>e la pagina relativa ai [membri delle librerie run-time di Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) in MSDN.</span><span class="sxs-lookup"><span data-stu-id="9a366-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="9a366-135">Inclusione di riferimenti a funzioni usate meno di frequente</span><span class="sxs-lookup"><span data-stu-id="9a366-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="9a366-136">Per includere un riferimento ad altri spazi dei nomi CLR usati meno di frequente, è necessario usare un riferimento completo, ad esempio <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="9a366-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="9a366-137">IntelliSense non è supportato nel riquadro del codice della finestra di dialogo **Espressione** per queste funzioni usate meno di frequente.</span><span class="sxs-lookup"><span data-stu-id="9a366-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="9a366-138">Per altre informazioni, vedere la pagina relativa ai [membri delle librerie di runtime di Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) in MSDN.</span><span class="sxs-lookup"><span data-stu-id="9a366-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a> <span data-ttu-id="9a366-139">Inclusione di riferimenti ad assembly esterni</span><span class="sxs-lookup"><span data-stu-id="9a366-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="9a366-140">Per includere un riferimento a una classe in un assembly esterno, è necessario identificare l'assembly per il componente Elaborazione report.</span><span class="sxs-lookup"><span data-stu-id="9a366-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="9a366-141">Usare la pagina **Riferimenti** della finestra di dialogo **Proprietà report** per specificare il nome completo dell'assembly da aggiungere al report.</span><span class="sxs-lookup"><span data-stu-id="9a366-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="9a366-142">Nell'espressione è necessario usare il nome completo per la classe nell'assembly.</span><span class="sxs-lookup"><span data-stu-id="9a366-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="9a366-143">Le classi di un assembly esterno non vengono visualizzate nella finestra di dialogo **Espressione** ; è necessario fornire il relativo nome corretto.</span><span class="sxs-lookup"><span data-stu-id="9a366-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="9a366-144">Un nome completo include lo spazio dei nomi, il nome della classe e il nome del membro.</span><span class="sxs-lookup"><span data-stu-id="9a366-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a> <span data-ttu-id="9a366-145">Inclusione di codice incorporato</span><span class="sxs-lookup"><span data-stu-id="9a366-145">Including Embedded Code</span></span>  
 <span data-ttu-id="9a366-146">Per aggiungere codice incorporato a un report, usare la scheda Codice della finestra di dialogo **Proprietà report** .</span><span class="sxs-lookup"><span data-stu-id="9a366-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="9a366-147">Il blocco di codice creato può contenere più metodi.</span><span class="sxs-lookup"><span data-stu-id="9a366-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="9a366-148">È necessario che i metodi nel codice incorporato siano scritti in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] e siano basati su istanze.</span><span class="sxs-lookup"><span data-stu-id="9a366-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="9a366-149">Tramite il componente Elaborazione report, vengono aggiunti automaticamente i riferimenti per gli spazi dei nomi System.Convert e System.Math.</span><span class="sxs-lookup"><span data-stu-id="9a366-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="9a366-150">Usare la pagina **Riferimenti** della finestra di dialogo **Proprietà report** per aggiungere altri riferimenti ad assembly.</span><span class="sxs-lookup"><span data-stu-id="9a366-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="9a366-151">Per altre informazioni, vedere [Aggiungere un riferimento a un assembly in un report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="9a366-152">I metodi nel codice incorporato sono disponibili tramite un membro `Code` definito a livello globale.</span><span class="sxs-lookup"><span data-stu-id="9a366-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="9a366-153">Per accedere ai metodi, fare riferimento al membro `Code` e al nome del metodo.</span><span class="sxs-lookup"><span data-stu-id="9a366-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="9a366-154">L'esempio seguente consente di chiamare il metodo `ToUSD` per la conversione del valore del campo `StandardCost` in un valore in dollari:</span><span class="sxs-lookup"><span data-stu-id="9a366-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="9a366-155">Per fare riferimento a raccolte predefinite nel codice personalizzato, includere un riferimento all'oggetto `Report` predefinito:</span><span class="sxs-lookup"><span data-stu-id="9a366-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="9a366-156">Negli esempi seguenti viene illustrato come definire alcune variabili e costanti personalizzate.</span><span class="sxs-lookup"><span data-stu-id="9a366-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="9a366-157">Sebbene le variabili e le costanti personalizzate non siano presenti nella categoria **Costanti** nella finestra di dialogo **Espressioni** , in cui vengono visualizzate solo costanti predefinite, è possibile farvi riferimento da qualsiasi espressione, come illustrato negli esempi seguenti.</span><span class="sxs-lookup"><span data-stu-id="9a366-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="9a366-158">In un'espressione una costante personalizzata viene considerata come un elemento `Variant`.</span><span class="sxs-lookup"><span data-stu-id="9a366-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="9a366-159">Nell'esempio seguente sono inclusi sia il riferimento al codice sia l'implementazione del codice della funzione `FixSpelling` che consente la sostituzione del testo `"Bicycle"` per tutte le occorrenze del testo "Bike" nel campo `SubCategory`.</span><span class="sxs-lookup"><span data-stu-id="9a366-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="9a366-160">Il codice seguente, se incorporato nel blocco di codice di una definizione del report, indica un'implementazione del metodo `FixSpelling`.</span><span class="sxs-lookup"><span data-stu-id="9a366-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="9a366-161">Questo esempio illustra come usare un riferimento completo alla [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` classe.</span><span class="sxs-lookup"><span data-stu-id="9a366-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="9a366-162">Per altre informazioni sulle raccolte di oggetti predefiniti e sull'inizializzazione, vedere [Riferimenti alle raccolte predefinite Globals e Users &#40;Generatore report e SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) e [Inizializzazione di oggetti assembly personalizzati](../custom-assemblies/initializing-custom-assembly-objects.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a> <span data-ttu-id="9a366-163">Inclusione di riferimenti ai parametri da codice</span><span class="sxs-lookup"><span data-stu-id="9a366-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="9a366-164">È possibile fare riferimento alla raccolta globale di parametri tramite codice personalizzato in un blocco di codice della definizione del report oppure in un assembly personalizzato specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="9a366-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="9a366-165">La raccolta di parametri è di sola lettura e non include iteratori pubblici.</span><span class="sxs-lookup"><span data-stu-id="9a366-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="9a366-166">Non è possibile usare un [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` costrutto per eseguire l'istruzione nella raccolta.</span><span class="sxs-lookup"><span data-stu-id="9a366-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="9a366-167">È necessario conoscere il nome del parametro definito nella definizione del report per potervi fare riferimento nel codice personalizzato.</span><span class="sxs-lookup"><span data-stu-id="9a366-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="9a366-168">È tuttavia possibile scorrere tutti i valori di un parametro multivalore.</span><span class="sxs-lookup"><span data-stu-id="9a366-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="9a366-169">Nella tabella seguente sono inclusi esempi di riferimenti alla raccolta predefinita `Parameters` da codice personalizzato:</span><span class="sxs-lookup"><span data-stu-id="9a366-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="9a366-170">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9a366-170">Description</span></span>|<span data-ttu-id="9a366-171">Riferimento nell'espressione</span><span class="sxs-lookup"><span data-stu-id="9a366-171">Reference in Expression</span></span>|<span data-ttu-id="9a366-172">Definizione del codice personalizzato</span><span class="sxs-lookup"><span data-stu-id="9a366-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="9a366-173">Passaggio di un'intera raccolta globale di parametri al codice personalizzato.</span><span class="sxs-lookup"><span data-stu-id="9a366-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="9a366-174">Questa funzione restituisce il valore di un parametro di report *MyParameter*specifico.</span><span class="sxs-lookup"><span data-stu-id="9a366-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="9a366-175">Passaggio di un singolo parametro al codice personalizzato.</span><span class="sxs-lookup"><span data-stu-id="9a366-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="9a366-176">In questo esempio viene restituito il valore del parametro passato.</span><span class="sxs-lookup"><span data-stu-id="9a366-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="9a366-177">Se il parametro è un parametro multivalore, la stringa restituita è una concatenazione di tutti i valori.</span><span class="sxs-lookup"><span data-stu-id="9a366-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a><span data-ttu-id="9a366-178">Inclusione di riferimenti al codice da assembly personalizzati</span><span class="sxs-lookup"><span data-stu-id="9a366-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="9a366-179">Per usare assembly personalizzati in un report, è innanzitutto necessario creare l'assembly, renderlo disponibile in Progettazione report, aggiungere un riferimento all'assembly nel report e quindi usare un'espressione nel report per fare riferimento ai metodi contenuti in tale assembly.</span><span class="sxs-lookup"><span data-stu-id="9a366-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="9a366-180">Quando il report viene distribuito al server di report, è necessario distribuire anche l'assembly personalizzato al server di report.</span><span class="sxs-lookup"><span data-stu-id="9a366-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="9a366-181">Per informazioni su come creare un assembly personalizzato e renderlo disponibile per [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], vedere [Uso di assembly personalizzati con i report](../custom-assemblies/using-custom-assemblies-with-reports.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="9a366-182">Per fare riferimento al codice personalizzato in un'espressione, è necessario chiamare il membro di una classe nell'assembly.</span><span class="sxs-lookup"><span data-stu-id="9a366-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="9a366-183">La modalità di esecuzione di tale operazione dipende dal tipo di metodo, ovvero statico o basato su istanze.</span><span class="sxs-lookup"><span data-stu-id="9a366-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="9a366-184">I metodi statici all'interno di un assembly personalizzato sono disponibili globalmente all'interno del report.</span><span class="sxs-lookup"><span data-stu-id="9a366-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="9a366-185">È possibile accedere ai metodi statici nelle espressioni specificando lo spazio dei nomi, la classe e il nome del metodo.</span><span class="sxs-lookup"><span data-stu-id="9a366-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="9a366-186">Nell'esempio seguente viene chiamato il metodo `ToGBP` , che converte il valore del valore di **StandardCost** da dollari a sterline:</span><span class="sxs-lookup"><span data-stu-id="9a366-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="9a366-187">I metodi basati su istanze sono disponibili tramite un membro `Code` definito a livello globale.</span><span class="sxs-lookup"><span data-stu-id="9a366-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="9a366-188">Per accedere ai metodi, fare riferimento al membro `Code`, aggiungendo l'istanza e il nome del metodo.</span><span class="sxs-lookup"><span data-stu-id="9a366-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="9a366-189">Nell'esempio seguente viene chiamato il metodo `ToEUR` di istanza, che converte il valore di **StandardCost** dal dollaro all'euro:</span><span class="sxs-lookup"><span data-stu-id="9a366-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="9a366-190">In Progettazione report un assembly personalizzato viene caricato una volta e non viene scaricato finché non si chiude [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9a366-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="9a366-191">Se si visualizza in anteprima un report, si apportano modifiche a un assembly personalizzato usato nel report e quindi si visualizza di nuovo il report in anteprima, le modifiche non compariranno nella seconda anteprima.</span><span class="sxs-lookup"><span data-stu-id="9a366-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="9a366-192">Per ricaricare l'assembly, chiudere e riaprire [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] , quindi visualizzare l'anteprima del report.</span><span class="sxs-lookup"><span data-stu-id="9a366-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="9a366-193">Per altre informazioni sull'accesso al codice, vedere [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="9a366-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a> <span data-ttu-id="9a366-194">Passaggio di raccolte predefinite in assembly personalizzati</span><span class="sxs-lookup"><span data-stu-id="9a366-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="9a366-195">Se si vuole passare raccolte predefinite, ad esempio la raccolta *Globals* o *Parameters* , in un assembly personalizzato per l'elaborazione, è necessario aggiungere nel progetto di codice un riferimento all'assembly che definisce le raccolte predefinite e accede allo spazio dei nomi corretto.</span><span class="sxs-lookup"><span data-stu-id="9a366-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="9a366-196">A seconda del fatto che l'assembly personalizzato venga sviluppato per un report eseguito in un server di report (report del server) o un report eseguito localmente in un'applicazione .NET (report locale), l'assembly a cui è necessario fare riferimento è diverso.</span><span class="sxs-lookup"><span data-stu-id="9a366-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="9a366-197">Per informazioni dettagliate, vedi di seguito.</span><span class="sxs-lookup"><span data-stu-id="9a366-197">See below for details.</span></span>  
  
-   <span data-ttu-id="9a366-198">**Spazio dei nomi:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="9a366-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="9a366-199">**Assembly (report locale):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="9a366-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="9a366-200">**Assembly (report del server):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="9a366-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="9a366-201">Poiché il contenuto delle raccolte *Fields* e *ReportItems* può cambiare dinamicamente in fase di esecuzione, non è consigliabile mantenere i riferimenti tra diverse chiamate nell'assembly personalizzato (ad esempio in una variabile membro).</span><span class="sxs-lookup"><span data-stu-id="9a366-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="9a366-202">Lo stesso consiglio si applica in genere a tutte le raccolte predefinite.</span><span class="sxs-lookup"><span data-stu-id="9a366-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9a366-203">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9a366-203">See Also</span></span>  
 <span data-ttu-id="9a366-204">[Aggiungere codice a un report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9a366-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="9a366-205">[Utilizzo di assembly personalizzati con i report](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="9a366-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="9a366-206">[Aggiungere un riferimento a un assembly in un report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9a366-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="9a366-207">[Reporting Services esercitazioni &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9a366-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="9a366-208">[Esempi di espressioni &#40;Generatore report e SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="9a366-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="9a366-209">Esempi di report (Generatore report e SSRS)</span><span class="sxs-lookup"><span data-stu-id="9a366-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
