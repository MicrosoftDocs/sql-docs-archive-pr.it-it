---
title: Riferimenti alla raccolta di campi del set di dati (Generatore report e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87636589"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="bd37e-102">Riferimenti alla raccolta di campi del set di dati (Generatore report e SSRS)</span><span class="sxs-lookup"><span data-stu-id="bd37e-102">Dataset Fields Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="bd37e-103">In ogni set di dati di un report è contenuta una raccolta Campi.</span><span class="sxs-lookup"><span data-stu-id="bd37e-103">Each dataset in a report contains one Fields collection.</span></span> <span data-ttu-id="bd37e-104">La raccolta Campi rappresenta il set di campi specificati dalla query del set di dati, più qualsiasi campo calcolato aggiuntivo creato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="bd37e-104">The Fields collection is the set of fields specified by the dataset query plus any additional calculated fields that you create.</span></span> <span data-ttu-id="bd37e-105">Dopo la creazione di un set di dati, la raccolta di campi viene visualizzata nel riquadro **Dati report** .</span><span class="sxs-lookup"><span data-stu-id="bd37e-105">After you create a dataset, the field collection appears in the **Report Data** pane.</span></span>  
  
 <span data-ttu-id="bd37e-106">In un'espressione un riferimento di campo semplice viene visualizzato nell'area di progettazione come un'espressione semplice.</span><span class="sxs-lookup"><span data-stu-id="bd37e-106">A simple field reference in an expression displays on the design surface as a simple expression.</span></span> <span data-ttu-id="bd37e-107">Quando ad esempio si trascina il campo `Sales` dal riquadro dei dati del report in una cella della tabella nell'area di progettazione, viene visualizzato `[Sales]` .</span><span class="sxs-lookup"><span data-stu-id="bd37e-107">For example, when you drag the field `Sales` from the Report Data pane to a table cell on the design surface, `[Sales]` is displayed.</span></span> <span data-ttu-id="bd37e-108">Questo parametro rappresenta l'espressione `=Fields!Sales.Value` sottostante impostata nella proprietà Value della casella di testo.</span><span class="sxs-lookup"><span data-stu-id="bd37e-108">This represents the underlying expression `=Fields!Sales.Value` that is set on the text box Value property.</span></span> <span data-ttu-id="bd37e-109">Durante l'esecuzione del report, questa espressione viene valutata in Elaborazione report e i dati effettivi vengono visualizzati dall'origine dati nella casella di testo nella cella della tabella.</span><span class="sxs-lookup"><span data-stu-id="bd37e-109">When the report runs, the report processor evaluates this expression and displays the actual data from the data source in the text box in the table cell.</span></span> <span data-ttu-id="bd37e-110">Per altre informazioni, vedere [Espressioni &#40;Generatore report e SSRS&#41;](expressions-report-builder-and-ssrs.md) e [Riferimenti alla raccolta di campi del set di dati &#40;Generatore report e SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="bd37e-110">For more, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) and [Dataset Fields Collection &#40;Report Builder and SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a><span data-ttu-id="bd37e-111">Visualizzazione della raccolta di campi per un set di dati</span><span class="sxs-lookup"><span data-stu-id="bd37e-111">Displaying the Field Collection for a Dataset</span></span>  
 <span data-ttu-id="bd37e-112">Per visualizzare i singoli valori per una raccolta di campi, trascinare ogni campo in una riga di dettaglio della tabella ed eseguire il report.</span><span class="sxs-lookup"><span data-stu-id="bd37e-112">To display the individual values for a field collection, drag each field to a table detail row and run the report.</span></span> <span data-ttu-id="bd37e-113">I riferimenti dalla riga di dettaglio di un'area dati tabella o elenco consentono di visualizzare un valore per ogni riga del set di dati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-113">References from the detail row of a table or list data region display a value for each row in the dataset.</span></span>  
  
 <span data-ttu-id="bd37e-114">Per visualizzare i valori di riepilogo per un campo, trascinare ogni campo numerico nell'area dati di una matrice.</span><span class="sxs-lookup"><span data-stu-id="bd37e-114">To display summarized values for a field, drag each numeric field to the data area of a matrix.</span></span> <span data-ttu-id="bd37e-115">La funzione di aggregazione predefinita per la riga del totale è Sum, ad esempio `=Sum(Fields!Sales.Value)`.</span><span class="sxs-lookup"><span data-stu-id="bd37e-115">The default aggregate function for the total row is Sum, for example, `=Sum(Fields!Sales.Value)`.</span></span> <span data-ttu-id="bd37e-116">È possibile modificare la funzione predefinita per calcolare totali diversi.</span><span class="sxs-lookup"><span data-stu-id="bd37e-116">You can change the default function in order to calculate different totals.</span></span> <span data-ttu-id="bd37e-117">Per altre informazioni, vedere [Riferimento a funzioni di aggregazione &#40;Generatore report e SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="bd37e-117">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
 <span data-ttu-id="bd37e-118">Per visualizzare valori di riepilogo per una raccolta di campi in una casella di testo direttamente nell'area di progettazione (non appartenente a un'area dati), è necessario specificare il nome del set di dati come ambito per la funzione di aggregazione.</span><span class="sxs-lookup"><span data-stu-id="bd37e-118">To display summarized values for a field collection in a text box directly on the design surface (not part of a data region), you must specify the dataset name as a scope for the aggregate function.</span></span> <span data-ttu-id="bd37e-119">Per un set di dati denominato `SalesData`, ad esempio, l'espressione seguente specifica il totale di tutti i valori per il campo `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span><span class="sxs-lookup"><span data-stu-id="bd37e-119">For example, for a dataset named `SalesData`, the following expression specifies the total of all values for the field `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span></span>  
  
 <span data-ttu-id="bd37e-120">Quando si usa la finestra di dialogo **Espressione** per definire un riferimento di campo semplice, è possibile selezionare la raccolta Campi nel riquadro Categoria e visualizzare l'elenco dei campi disponibili nel riquadro **Campo** .</span><span class="sxs-lookup"><span data-stu-id="bd37e-120">When you use the **Expression** dialog box to define a simple field reference, you can select the Fields collection in the Category pane and see the list of available fields in the **Field** pane.</span></span> <span data-ttu-id="bd37e-121">A ogni campo sono associate diverse proprietà, ad esempio Value e IsMissing.</span><span class="sxs-lookup"><span data-stu-id="bd37e-121">Each field has several properties, including Value and IsMissing.</span></span> <span data-ttu-id="bd37e-122">Le proprietà rimanenti sono proprietà di campo estese predefinite che possono essere disponibili per il set di dati in base al tipo dell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-122">The remaining properties are predefined extended field properties that may be available to the dataset depending on the data source type.</span></span>  
  
### <a name="detecting-nulls-for-a-dataset-field"></a><span data-ttu-id="bd37e-123">Rilevamento di valori Null per un campo del set di dati</span><span class="sxs-lookup"><span data-stu-id="bd37e-123">Detecting Nulls for a Dataset Field</span></span>  
 <span data-ttu-id="bd37e-124">Per rilevare un valore Null in un campo (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), è possibile utilizzare la funzione `IsNothing`.</span><span class="sxs-lookup"><span data-stu-id="bd37e-124">To detect a field value that is null (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), you can use the function `IsNothing`.</span></span> <span data-ttu-id="bd37e-125">Quando è posizionata in una casella di testo in una riga dei dettagli della tabella, l'espressione seguente esegue il test del campo `MiddleName` . Se il valore è Null, viene sostituito il testo "No Middle Name". In caso contrario, viene sostituito il valore del campo stesso:</span><span class="sxs-lookup"><span data-stu-id="bd37e-125">When placed in a text box in a table details row, the following expression tests the field `MiddleName` and substitutes the text "No Middle Name" when the value is null, and the field value itself when the value is not null:</span></span>  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a><span data-ttu-id="bd37e-126">Rilevamento di campi mancanti per query dinamiche in fase di esecuzione</span><span class="sxs-lookup"><span data-stu-id="bd37e-126">Detecting Missing Fields for Dynamic Queries at Run Time</span></span>  
 <span data-ttu-id="bd37e-127">Per impostazione predefinita, agli elementi della raccolta Campi sono associate due proprietà: Value e IsMissing.</span><span class="sxs-lookup"><span data-stu-id="bd37e-127">By default, items in the Fields collection have two properties: Value and IsMissing.</span></span> <span data-ttu-id="bd37e-128">La proprietà IsMissing indica se un campo definito per un set di dati in fase di progettazione è incluso nei campi recuperati in fase di runtime.</span><span class="sxs-lookup"><span data-stu-id="bd37e-128">The IsMissing property indicates whether a field that is defined for a dataset at design time is contained in the fields retrieved at run time.</span></span> <span data-ttu-id="bd37e-129">È possibile, ad esempio, che la query chiami un stored procedure in cui il set di risultati varia in base a un parametro di input oppure che la query potrebbe essere `SELECT * FROM` *\<table>* la posizione in cui la definizione della tabella è stata modificata.</span><span class="sxs-lookup"><span data-stu-id="bd37e-129">For example, your query might call a stored procedure in which the result set varies with an input parameter, or your query might be `SELECT * FROM` *\<table>* where the table definition changed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bd37e-130">IsMissing consente di rilevare le modifiche nello schema del set di dati tra la fase di progettazione e quella di runtime per qualsiasi tipo di origine dati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-130">IsMissing detects changes in the dataset schema between design time and run time for any type of data source.</span></span> <span data-ttu-id="bd37e-131">Non è possibile utilizzare l'oggetto per rilevare i membri vuoti in un cubo multidimensionale e non è correlato ai concetti del linguaggio di query MDX di `EMPTY` e di `NON EMPTY` .</span><span class="sxs-lookup"><span data-stu-id="bd37e-131">IsMissing cannot be used to detect empty members in a multidimensional cube and is not related to the MDX query language concepts of `EMPTY` and `NON EMPTY`.</span></span>  
  
 <span data-ttu-id="bd37e-132">È possibile eseguire il test della proprietà IsMissing con un codice personalizzato per determinare se un campo è presente nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-132">You can test the IsMissing property in custom code to determine if a field is present in the result set.</span></span> <span data-ttu-id="bd37e-133">Non è possibile eseguire il test relativo a tale presenza utilizzando un'espressione con una chiamata a una funzione [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], ad esempio `IIF` o `SWITCH`, poiché in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] vengono valutati tutti i parametri presenti nella chiamata alla funzione e viene restituito un errore quando viene valutato il riferimento al parametro mancante.</span><span class="sxs-lookup"><span data-stu-id="bd37e-133">You cannot test for its presence using an expression with a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] function call such as `IIF` or `SWITCH`, because [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] evaluates all parameters in the call to the function, which results in an error when the reference to the missing is evaluated.</span></span>  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a><span data-ttu-id="bd37e-134">Esempio per il controllo della visibilità di una colonna dinamica per un campo mancante</span><span class="sxs-lookup"><span data-stu-id="bd37e-134">Example for Controlling the Visibility of a Dynamic Column for a Missing Field</span></span>  
 <span data-ttu-id="bd37e-135">Per impostare un'espressione che controlla la visibilità di una colonna in cui viene visualizzato un campo in un set di dati, è necessario innanzitutto definire una funzione di codice personalizzata che restituisca un valore booleano in base alla presenza o all'assenza del campo.</span><span class="sxs-lookup"><span data-stu-id="bd37e-135">To set an expression that controls the visibility of a column that displays a field in a dataset, you must first define a custom code function that returns a Boolean value based on whether the field is missing.</span></span> <span data-ttu-id="bd37e-136">La funzione di codice personalizzata seguente, ad esempio, restituisce true se il campo non è presente. In caso contrario, restituisce false.</span><span class="sxs-lookup"><span data-stu-id="bd37e-136">For example, the following custom code function returns true if the field is missing and false if the field exists.</span></span>  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 <span data-ttu-id="bd37e-137">Per usare questa funzione al fine di controllare la visibilità di una colonna, impostare la proprietà Nascosto della colonna sull'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="bd37e-137">To use this function to control visibility of a column, set the Hidden property of the column to the following expression:</span></span>  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 <span data-ttu-id="bd37e-138">Quando il campo non esiste, la colonna è nascosta.</span><span class="sxs-lookup"><span data-stu-id="bd37e-138">The column is hidden when the field does not exist.</span></span>  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a><span data-ttu-id="bd37e-139">Esempio per il controllo del valore della casella di testo per un campo mancante</span><span class="sxs-lookup"><span data-stu-id="bd37e-139">Example for Controlling the Text Box Value for a Missing Field</span></span>  
 <span data-ttu-id="bd37e-140">Per sostituire il testo da scrivere al posto del valore di un campo mancante, è necessario scrivere codice personalizzato che restituisca il testo da utilizzare in sostituzione di un valore di campo quando quest'ultimo non è presente.</span><span class="sxs-lookup"><span data-stu-id="bd37e-140">To substitute text that you write in place of the value of a missing field, you must write custom code that returns text you can use in place of a field value when the field is missing.</span></span> <span data-ttu-id="bd37e-141">La funzione di codice personalizzata seguente restituisce ad esempio il valore del campo se il campo esiste e il messaggio specificato dall'utente come secondo parametro se il campo non esiste:</span><span class="sxs-lookup"><span data-stu-id="bd37e-141">For example, the following custom code function returns the value of the field if the field exists, and the message that you specify as the second parameter if the field does not exist:</span></span>  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 <span data-ttu-id="bd37e-142">Per usare questa funzione in una casella di testo, aggiungere l'espressione seguente alla proprietà Value:</span><span class="sxs-lookup"><span data-stu-id="bd37e-142">To use this function in a text box, add the following expression to the Value property:</span></span>  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 <span data-ttu-id="bd37e-143">Nella casella di testo viene visualizzato il valore del campo o il testo specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="bd37e-143">The text box displays either the field value or the text that you specified.</span></span>  
  
### <a name="using-extended-field-properties"></a><span data-ttu-id="bd37e-144">Utilizzo delle proprietà di campo estese</span><span class="sxs-lookup"><span data-stu-id="bd37e-144">Using Extended Field Properties</span></span>  
 <span data-ttu-id="bd37e-145">Le proprietà di campo estese sono proprietà aggiuntive definite in un campo dall'estensione per l'elaborazione dati determinata dal tipo di origine dati per il set di dati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-145">Extended field properties are additional properties defined on a field by the data processing extension, which is determined by the data source type for the dataset.</span></span> <span data-ttu-id="bd37e-146">Tali proprietà sono predefinite o specifiche per un tipo di origine dati.</span><span class="sxs-lookup"><span data-stu-id="bd37e-146">Extended field properties are predefined or specific to a data source type.</span></span> <span data-ttu-id="bd37e-147">Per altre informazioni, vedere [Proprietà di campo estese per un database di Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="bd37e-147">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
 <span data-ttu-id="bd37e-148">Se si specifica una proprietà non supportata per un campo specifico, tale espressione restituirà `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="bd37e-148">If you specify a property that is not supported for that field, the expression evaluates to `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="bd37e-149">Se un provider di dati non supporta le proprietà di campo estese o se il campo non viene trovato durante l'esecuzione della query, il valore della proprietà è `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) per le proprietà di tipo `String` e `Object` e zero (0) per le proprietà di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="bd37e-149">If a data provider does not support extended field properties, or if the field is not found when the query is executed, the value for the property is `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) for properties of type `String` and `Object`, and zero (0) for properties of type `Integer`.</span></span> <span data-ttu-id="bd37e-150">Un'estensione per l'elaborazione dati può sfruttare le proprietà predefinite ottimizzando le query che includono tale sintassi.</span><span class="sxs-lookup"><span data-stu-id="bd37e-150">A data processing extension may take advantage of predefined properties by optimizing queries that include this syntax.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bd37e-151">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="bd37e-151">See Also</span></span>  
 <span data-ttu-id="bd37e-152">[Esempi di espressioni &#40;Generatore report e SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="bd37e-152">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="bd37e-153">Aggiungere dati a un report &#40;Generatore report e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="bd37e-153">Add Data to a Report &#40;Report Builder and SSRS&#41;</span></span>](../report-data/report-datasets-ssrs.md)  
  
  
