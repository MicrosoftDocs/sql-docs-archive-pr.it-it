---
title: Tipi di dati nelle espressioni (Generatore report e SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721186"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="ac9ee-102">Tipi di dati nelle espressioni (Generatore report e SSRS)</span><span class="sxs-lookup"><span data-stu-id="ac9ee-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="ac9ee-103">I tipi di dati rappresentano tipologie di dati diversi che possono essere archiviati ed elaborati in modo efficiente.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="ac9ee-104">I tipi di dati standard includono testo, noto anche come stringhe, numeri con e senza posizioni decimali, date e ore e immagini.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="ac9ee-105">I valori in un report devono essere costituiti da un tipo di dati RDL (Report Definition Language).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="ac9ee-106">È possibile formattare un valore in base alle proprie preferenze quando si lo visualizza in un report.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="ac9ee-107">Un campo che rappresenta la valuta, ad esempio, viene archiviato nella definizione del report come numero a virgola mobile, ma può essere visualizzato in diversi formati a seconda della proprietà di formattazione scelta.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="ac9ee-108">Per altre informazioni sui formati di visualizzazione, vedere [Formattazione degli elementi del report &#40;Generatore report e SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="ac9ee-109">Tipi di dati RDL (Report Definition Language) e tipi di dati CLR (Common Language Runtime)</span><span class="sxs-lookup"><span data-stu-id="ac9ee-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="ac9ee-110">I valori specificati in un file RDL devono essere un tipo di dati RDL.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="ac9ee-111">Quando il report viene compilato ed elaborato, i tipi di dati RDL vengono convertiti in tipi di dati CLR.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="ac9ee-112">Nella tabella seguente viene visualizzata la conversione, contrassegnata come valore predefinito:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="ac9ee-113">Tipo RDL</span><span class="sxs-lookup"><span data-stu-id="ac9ee-113">RDL Type</span></span>|<span data-ttu-id="ac9ee-114">Tipi CLR</span><span class="sxs-lookup"><span data-stu-id="ac9ee-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="ac9ee-115">string</span><span class="sxs-lookup"><span data-stu-id="ac9ee-115">String</span></span>|<span data-ttu-id="ac9ee-116">Valore predefinito: String</span><span class="sxs-lookup"><span data-stu-id="ac9ee-116">Default: String</span></span><br /><br /> <span data-ttu-id="ac9ee-117">Chart, GUID, Timespan</span><span class="sxs-lookup"><span data-stu-id="ac9ee-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="ac9ee-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="ac9ee-118">Boolean</span></span>|<span data-ttu-id="ac9ee-119">Valore predefinito: Boolean</span><span class="sxs-lookup"><span data-stu-id="ac9ee-119">Default: Boolean</span></span>|  
|<span data-ttu-id="ac9ee-120">Integer</span><span class="sxs-lookup"><span data-stu-id="ac9ee-120">Integer</span></span>|<span data-ttu-id="ac9ee-121">Valore predefinito: Int64</span><span class="sxs-lookup"><span data-stu-id="ac9ee-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="ac9ee-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span><span class="sxs-lookup"><span data-stu-id="ac9ee-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="ac9ee-123">Datetime</span><span class="sxs-lookup"><span data-stu-id="ac9ee-123">DateTime</span></span>|<span data-ttu-id="ac9ee-124">Valore predefinito: DateTime</span><span class="sxs-lookup"><span data-stu-id="ac9ee-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="ac9ee-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ac9ee-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="ac9ee-126">Float</span><span class="sxs-lookup"><span data-stu-id="ac9ee-126">Float</span></span>|<span data-ttu-id="ac9ee-127">Valore predefinito: Double</span><span class="sxs-lookup"><span data-stu-id="ac9ee-127">Default: Double</span></span><br /><br /> <span data-ttu-id="ac9ee-128">Single, Decimal</span><span class="sxs-lookup"><span data-stu-id="ac9ee-128">Single, Decimal</span></span>|  
|<span data-ttu-id="ac9ee-129">Binary</span><span class="sxs-lookup"><span data-stu-id="ac9ee-129">Binary</span></span>|<span data-ttu-id="ac9ee-130">Valore predefinito: Byte []</span><span class="sxs-lookup"><span data-stu-id="ac9ee-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="ac9ee-131">Variant</span><span class="sxs-lookup"><span data-stu-id="ac9ee-131">Variant</span></span>|<span data-ttu-id="ac9ee-132">Uno qualsiasi tra quelli riportati in precedenza eccetto Byte []</span><span class="sxs-lookup"><span data-stu-id="ac9ee-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="ac9ee-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="ac9ee-133">VariantArray</span></span>|<span data-ttu-id="ac9ee-134">Matrice di Variant</span><span class="sxs-lookup"><span data-stu-id="ac9ee-134">Array of Variant</span></span>|  
|<span data-ttu-id="ac9ee-135">Serializable</span><span class="sxs-lookup"><span data-stu-id="ac9ee-135">Serializable</span></span>|<span data-ttu-id="ac9ee-136">Variant oppure tipi contrassegnati con Serializable o che consentono di implementare ISerializable.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="ac9ee-137">Informazioni sui tipi di dati e scrittura di espressioni</span><span class="sxs-lookup"><span data-stu-id="ac9ee-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="ac9ee-138">È importante comprendere i tipi di dati quando si scrivono espressioni per confrontare o combinare valori, ad esempio quando si definiscono espressioni di raggruppamento o di filtro o quando si calcolano le aggregazioni.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="ac9ee-139">Confronti e calcoli sono validi solo tra elementi dello stesso tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="ac9ee-140">Se i tipi di dati non corrispondono, è necessario convertire esplicitamente il tipo di dati nell'elemento del report utilizzando un'espressione.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="ac9ee-141">Nell'elenco seguente sono descritti i casi in cui potrebbe essere necessario convertire i dati in un altro tipo di dati:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="ac9ee-142">Confronto del valore di un parametro del report di un tipo di dati con un campo del set di dati di un altro tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="ac9ee-143">Scrittura di espressioni di filtro che confrontano valori di tipi di dati differenti.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="ac9ee-144">Scrittura di espressioni di ordinamento che combinano campi di tipi di dati diversi.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="ac9ee-145">Scrittura di espressioni di raggruppamento che combinano campi di tipi di dati diversi.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="ac9ee-146">Conversione da un tipo di dati a un altro tipo di dati di un valore recuperato dall'origine dati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="ac9ee-147">Determinazione del tipo di dati del report</span><span class="sxs-lookup"><span data-stu-id="ac9ee-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="ac9ee-148">Per determinare il tipo di dati di un elemento del report è possibile scrivere un'espressione.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="ac9ee-149">Ad esempio, per visualizzare il tipo di dati del campo `MyField`, aggiungere l'espressione `=Fields!MyField.Value.GetType().ToString()`a una cella della tabella.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="ac9ee-150">Il risultato indica il tipo di dati CLR utilizzato per rappresentare `MyField`, ad esempio `System.String` o `System.DateTime`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="ac9ee-151">Conversione dei campi del set di dati in un altro tipo di dati</span><span class="sxs-lookup"><span data-stu-id="ac9ee-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="ac9ee-152">È inoltre possibile convertire i campi del set di dati prima di utilizzarli in un report.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="ac9ee-153">Nell'elenco seguente vengono descritte le modalità di conversione di un campo del set di dati esistente:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="ac9ee-154">Modificare la query del set di dati in modo da aggiungere un nuovo campo di query con i dati convertiti.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="ac9ee-155">Per le origini dati relazionali o multidimensionali, per eseguire la conversione vengono utilizzate le risorse dell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="ac9ee-156">Creare un campo calcolato basato su un campo del set di dati del report esistente scrivendo un'espressione che converte tutti i dati di una colonna del set di risultati in una nuova colonna con un tipo di dati differente.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="ac9ee-157">L'espressione seguente, ad esempio, converte il campo Year da un valore di tipo Integer in un valore di tipo String: `=CStr(Fields!Year.Value)`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="ac9ee-158">Per altre informazioni, vedere [Aggiunta, modifica e aggiornamento di campi nel riquadro dei dati del report &#40;Generatore report e SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="ac9ee-159">Controllare se l'estensione per l'elaborazione dati in uso include metadati per il recupero dei dati preformattati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="ac9ee-160">Una query MDX di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] include ad esempio una proprietà estesa FORMATTED_VALUE per i valori del cubo già formattati durante l'elaborazione del cubo.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="ac9ee-161">Per altre informazioni, vedere [Proprietà di campo estese per un database di Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="ac9ee-162">Informazioni sui tipi di dati dei parametri</span><span class="sxs-lookup"><span data-stu-id="ac9ee-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="ac9ee-163">I parametri del report devono essere di uno dei cinque tipi di dati seguenti: Boolean, DateTime, Integer, Float o Text (anche noto come String).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="ac9ee-164">Quando una query del set di dati include parametri di query, i parametri del report vengono creati automaticamente e collegati ai parametri di query.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="ac9ee-165">Il tipo di dati predefinito per un parametro di report è String.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="ac9ee-166">Per modificare tale tipo di dati, selezionare il valore corretto nell'elenco a discesa **Tipo di dati** nella pagina **Generale** della finestra di dialogo **Proprietà parametri report** .</span><span class="sxs-lookup"><span data-stu-id="ac9ee-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ac9ee-167">I parametri di report di tipo DateTime non supportano i millisecondi.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="ac9ee-168">Sebbene sia possibile creare un parametro basato su valori che includono millisecondi, non è possibile selezionare un valore da un elenco a discesa di valori disponibili contenente valori di tipo Date o Time che includono millisecondi.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="ac9ee-169">Scrittura di espressioni che convertono tipi di dati o estraggono parti di dati</span><span class="sxs-lookup"><span data-stu-id="ac9ee-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="ac9ee-170">Quando si combinano testo e campi del set di dati utilizzando l'operatore di concatenazione (&), Common Language Runtime (CLR) fornisce in genere formati predefiniti.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="ac9ee-171">Per convertire in modo esplicito un parametro o un campo del set di dati in un tipo di dati specifico, è necessario utilizzare un metodo CLR o una funzione della libreria di runtime di Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="ac9ee-172">Nella tabella seguente sono riportati alcuni esempi di conversione dei tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="ac9ee-173">Tipo di conversione</span><span class="sxs-lookup"><span data-stu-id="ac9ee-173">Type of conversion</span></span>|<span data-ttu-id="ac9ee-174">Esempio</span><span class="sxs-lookup"><span data-stu-id="ac9ee-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="ac9ee-175">Da DateTime a String</span><span class="sxs-lookup"><span data-stu-id="ac9ee-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="ac9ee-176">Da String a DateTime</span><span class="sxs-lookup"><span data-stu-id="ac9ee-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="ac9ee-177">Da String a DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ac9ee-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="ac9ee-178">Estrazione dell'anno</span><span class="sxs-lookup"><span data-stu-id="ac9ee-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="ac9ee-179">Da Boolean a Integer</span><span class="sxs-lookup"><span data-stu-id="ac9ee-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="ac9ee-180">\- 1 è True e 0 è False.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="ac9ee-181">Da Boolean a Integer</span><span class="sxs-lookup"><span data-stu-id="ac9ee-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="ac9ee-182">1 è True e 0 è False.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="ac9ee-183">Solo la parte DateTime di un valore DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ac9ee-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="ac9ee-184">Solo la parte Offset di un valore DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ac9ee-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="ac9ee-185">È inoltre possibile utilizzare la funzione Format per controllare il formato di visualizzazione del valore.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="ac9ee-186">Per altre informazioni, vedere [Funzioni (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="ac9ee-187">Esempi avanzati</span><span class="sxs-lookup"><span data-stu-id="ac9ee-187">Advanced Examples</span></span>  
 <span data-ttu-id="ac9ee-188">Quando ci si connette a un'origine dati con un provider di dati che non fornisce il supporto di conversione per tutti i tipi di dati dell'origine dati, il tipo di dati predefinito per i tipi di origine dati non supportati corrisponde a String.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="ac9ee-189">Negli esempi seguenti sono fornite le soluzioni per i tipi di dati specifici restituiti come stringa.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="ac9ee-190">Concatenazione di una stringa e di un tipo di dati DateTimeOffset CLR</span><span class="sxs-lookup"><span data-stu-id="ac9ee-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="ac9ee-191">Per la maggior parte dei tipi di dati, CLR fornisce conversioni predefinite in modo da consentire la concatenazione di valori con tipi di dati diversi in una stringa mediante l'operatore &.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="ac9ee-192">Nell'espressione seguente, ad esempio, viene concatenato il testo "The date and time are: " con il campo del set di dati StartDate, che rappresenta un valore <xref:System.DateTime> : `="The date and time are: " & Fields!StartDate.Value`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="ac9ee-193">Per alcuni tipi di dati, potrebbe essere necessario includere la funzione ToString.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="ac9ee-194">Nell'espressione seguente, ad esempio, è riportato lo stesso esempio con il tipo di dati CLR <xref:System.DateTimeOffset>che include la data, l'ora e una differenza di fuso orario rispetto al fuso orario UTC: `="The time is: " & Fields!StartDate.Value.ToString()`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="ac9ee-195">Conversione del tipo di dati String in un tipo di dati DateTime CLR</span><span class="sxs-lookup"><span data-stu-id="ac9ee-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="ac9ee-196">Se un'estensione per l'elaborazione dati non supporta tutti i tipi di dati definiti in un'origine dati, i dati possono essere recuperati come testo.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="ac9ee-197">Un valore del tipo di dati `datetimeoffset(7)` può essere, ad esempio, recuperato come dati di tipo String.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="ac9ee-198">A Perth, in Australia, il valore stringa per il 1 luglio 2008, alle 6:05:07.9999999 AM</span><span class="sxs-lookup"><span data-stu-id="ac9ee-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="ac9ee-199">è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="ac9ee-200">In questo esempio viene mostrata la data (1 luglio 2008), seguita dall'ora espressa con una precisione di 7 cifre (06:05:07.9999999 AM), seguita da una differenza di fuso orario dall'ora UTC espressa in ore e minuti (più 8 ore e 0 minuti).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="ac9ee-201">Per l'esempio seguente, questo valore è stato inserito in un campo `String` denominato `MyDateTime.Value`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="ac9ee-202">Per convertire questi dati in uno o più valori CLR, è possibile adottare una delle strategie seguenti:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="ac9ee-203">In una casella di testo utilizzare un'espressione per estrarre parti della stringa.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="ac9ee-204">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-204">For example:</span></span>  
  
    -   <span data-ttu-id="ac9ee-205">Nell'espressione seguente solo la parte relativa all'ora della differenza di fuso orario dall'ora UTC viene prima estratta e poi convertita in minuti: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="ac9ee-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="ac9ee-206">Il risultato è `480`.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="ac9ee-207">Nell'espressione seguente la stringa viene convertita in un valore di data e ora: `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="ac9ee-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="ac9ee-208">Se la stringa `MyDateTime.Value` include una differenza UTC, la funzione `DateTime.Parse` regola in primo luogo l'ora in base alla differenza UTC: 7 AM,</span><span class="sxs-lookup"><span data-stu-id="ac9ee-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="ac9ee-209">- [`+08:00`] con l'ora UTC 11 PM.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="ac9ee-210">della notte precedente).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-210">the night before).</span></span> <span data-ttu-id="ac9ee-211">La funzione `DateTime.Parse` applica quindi la differenza UTC del server di report locale e, se necessario, regola nuovamente l'ora in base all'ora legale.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="ac9ee-212">Ad esempio, a Redmond, Washington, la differenza tra ora locale e ora legale è `[-07:00]`, ovvero 7 ore prima delle 23.00.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="ac9ee-213">Il risultato è il valore `DateTime` seguente: `2007-07-06 04:07:07 PM` (6 luglio 2007 alle 4.07 PM).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="ac9ee-214">Per ulteriori informazioni sulla conversione di stringhe in `DateTime` tipi di dati, vedere [analisi di stringhe di data e ora](https://go.microsoft.com/fwlink/?LinkId=89703), [formattazione di data e ora per impostazioni cultura specifiche](https://go.microsoft.com/fwlink/?LinkId=89704)e [scelta tra DateTime, DateTimeOffset e TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) in MSDN.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="ac9ee-215">Aggiungere un nuovo campo calcolato al set di dati del report che utilizza un'espressione per estrarre parti della stringa.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="ac9ee-216">Per altre informazioni, vedere [Aggiunta, modifica e aggiornamento di campi nel riquadro dei dati del report &#40;Generatore report e SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="ac9ee-217">Modificare la query del set di dati del report per utilizzare le funzioni [!INCLUDE[tsql](../../includes/tsql-md.md)] per estrarre i valori di data e ora indipendentemente in modo da creare colonne separate.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="ac9ee-218">Nell'esempio seguente viene illustrato come utilizzare la funzione `DatePart` per aggiungere una colonna per l'anno e una colonna per il fuso orario UTC convertito in minuti:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="ac9ee-219">Il set di risultati contiene tre colonne.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-219">The result set has three columns.</span></span> <span data-ttu-id="ac9ee-220">La prima colonna indica la data e l'ora, la seconda indica l'anno e la terza indica la differenza UTC espressa in minuti.</span><span class="sxs-lookup"><span data-stu-id="ac9ee-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="ac9ee-221">Nella riga seguente sono riportati dati di esempio:</span><span class="sxs-lookup"><span data-stu-id="ac9ee-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="ac9ee-222">Per altre informazioni sui tipi di database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], vedere [Tipi di dati &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) e [Funzioni e tipi di dati di data e ora &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) nella [documentazione online di SQL Server](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="ac9ee-223">Per altre nellaformazioni sui tipi di dati di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , vedere [Tipi di dati nella Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) nella [SQL Server Books Onlnellae](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="ac9ee-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ac9ee-224">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ac9ee-224">See Also</span></span>  
 [<span data-ttu-id="ac9ee-225">Formattazione degli elementi del report &#40;Generatore report e SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="ac9ee-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
