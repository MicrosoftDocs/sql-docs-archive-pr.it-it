---
title: Usare una connessione Office Data Connection (ODC) con i report (Reporting Services in modalità integrata SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- Office Data Connection (.odc) files
- SharePoint integration [Reporting Services], shared data sources
- .odc files
ms.assetid: e8d6896d-f886-4390-8b5d-96f0a50c250c
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d795c46f46b45511079ac03add2d18214ac54489
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87623813"
---
# <a name="use-an-office-data-connection-odc-with-reports-reporting-services-in-sharepoint-integrated-mode"></a><span data-ttu-id="0239c-102">Utilizzare una connessione Office Data Connection (odc) ai report (Reporting Services in modalità integrata SharePoint)</span><span class="sxs-lookup"><span data-stu-id="0239c-102">Use an Office Data Connection (.odc) with Reports (Reporting Services in SharePoint Integrated Mode)</span></span>
  <span data-ttu-id="0239c-103">In particolari scenari è possibile utilizzare un file Office Data Connection (odc) esistente per fornire informazioni di connessione a un report di [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0239c-103">For limited scenarios, you can use an existing Office Data Connection (.odc) file to provide connection information to a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report.</span></span> <span data-ttu-id="0239c-104">Quando si vuole creare un'origine dati condivisa, è possibile usare un file con estensione odc al posto di un file con estensione rsds.</span><span class="sxs-lookup"><span data-stu-id="0239c-104">An .odc file can be used in place of an .rsds file when you create a shared data source.</span></span> <span data-ttu-id="0239c-105">Nel server di report il file con estensione odc viene infatti utilizzato in modo analogo del file con estensione rsds, ovvero per il recupero del tipo dell'origine dati, della stringa di connessione e delle informazioni relative alle credenziali.</span><span class="sxs-lookup"><span data-stu-id="0239c-105">The report server uses an .odc file in the same way it uses an .rsds file; it reads the file for the data source type, a connection string, and credential information.</span></span>  
  
 <span data-ttu-id="0239c-106">Non tutti i file odc possono essere usati con un report di [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0239c-106">Not all .odc files can be used with a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report.</span></span> <span data-ttu-id="0239c-107">La possibilità di utilizzare o meno un file con estensione odc è determinata dall'estensione per l'elaborazione dei dati nonché dalle caratteristiche del report e del file stesso:</span><span class="sxs-lookup"><span data-stu-id="0239c-107">The data processing extension and characteristics of the report and .odc file determine whether an .odc can be used:</span></span>  
  
-   <span data-ttu-id="0239c-108">Il report deve essere progettato per l'utilizzo con un provider di dati OLE DB o ODBC.</span><span class="sxs-lookup"><span data-stu-id="0239c-108">The report must be designed to work with an OLE DB or ODBC data provider.</span></span> <span data-ttu-id="0239c-109">Se per la creazione del report era stata utilizzata un'altra estensione per l'elaborazione dati, è possibile che il report o le relative query includano funzionalità non supportate dal provider di dati OLE DB o ODBC.</span><span class="sxs-lookup"><span data-stu-id="0239c-109">If you used a different data processing extension to create the report, the report or its queries might include functionality that is not supported by the OLE DB or ODBC data provider.</span></span>  
  
-   <span data-ttu-id="0239c-110">Il file odc deve presentare la struttura e gli elementi previsti.</span><span class="sxs-lookup"><span data-stu-id="0239c-110">The .odc file must have the expected elements and structure.</span></span> <span data-ttu-id="0239c-111">Le impostazioni relative alle credenziali e al provider di dati devono essere impostate esplicitamente nel file in modo che possano essere lette dal server di report.</span><span class="sxs-lookup"><span data-stu-id="0239c-111">The data provider and credential settings must be set explicitly in the file so that they can be read by the report server.</span></span> <span data-ttu-id="0239c-112">Il modo migliore per impostare tali valori consiste nell'esportare il file odc prima di caricarlo nella raccolta di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0239c-112">The best way to set these values is to export the .odc file before uploading it to the SharePoint library.</span></span>  
  
-   <span data-ttu-id="0239c-113">Il file odc deve specificare una connessione di tipo OLE DB o ODBC.</span><span class="sxs-lookup"><span data-stu-id="0239c-113">The .odc file must specify a connection type of OLE DB or ODBC.</span></span>  
  
-   <span data-ttu-id="0239c-114">Nel file odc deve essere specificata una stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="0239c-114">The .odc file must specify a connection string.</span></span>  
  
-   <span data-ttu-id="0239c-115">Le credenziali possono essere impostate su `None`, `Stored` o `Integrated`.</span><span class="sxs-lookup"><span data-stu-id="0239c-115">Credentials can be set to `None`, `Stored`, or `Integrated`.</span></span> <span data-ttu-id="0239c-116">Se per le credenziali è selezionata l'opzione `Stored`, anziché utilizzare le credenziali archiviate il server di report visualizzerà un messaggio per richiederle all'utente,</span><span class="sxs-lookup"><span data-stu-id="0239c-116">If the credentials method is set to `Stored`, the report server will prompt the user for credentials instead of using the stored credentials.</span></span> <span data-ttu-id="0239c-117">perché non è in grado di utilizzare credenziali archiviate definite nel file con estensioni odc.</span><span class="sxs-lookup"><span data-stu-id="0239c-117">The report server cannot use stored credentials as defined in the .odc file.</span></span>  
  
-   <span data-ttu-id="0239c-118">Lo schema dell'origine dati deve essere identico a quello utilizzato per creare il report.</span><span class="sxs-lookup"><span data-stu-id="0239c-118">The data source must have schema that is identical to the one used to create the report.</span></span> <span data-ttu-id="0239c-119">Se le strutture di dati sono diverse, il report non verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="0239c-119">If the data structures are different, the report will not run.</span></span>  
  
-   <span data-ttu-id="0239c-120">Il file con estensione odc deve essere creato in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007. Le versioni precedenti di tale file non sono compatibili con i file di definizione del report.</span><span class="sxs-lookup"><span data-stu-id="0239c-120">The .odc file must be created in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007 (older versions of .odc are not compatible with report definition files).</span></span>  
  
 <span data-ttu-id="0239c-121">Non è possibile utilizzare file odc che specificano connessioni a origini dati che non possono essere elaborate in un server di report, anche se i tipi di origini dati specificati nei file odc sono simili ai tipi di origini dati supportati.</span><span class="sxs-lookup"><span data-stu-id="0239c-121">You cannot use .odc files that specify connections to data sources that cannot be processed on a report server, even if the .odc data source types look similar to supported data source types.</span></span> <span data-ttu-id="0239c-122">In particolare, se si crea in Microsoft Excel 2007 un file con estensione odc che recupera dati da Microsoft Access, dal Web o da un file di testo, non sarà possibile utilizzarlo per fornire dati a un report.</span><span class="sxs-lookup"><span data-stu-id="0239c-122">Specifically, if you created an .odc file in Microsoft Excel 2007 that retrieves data from Microsoft Access, the Web, or a text file, you cannot use that .odc file to provide data to a report.</span></span>  
  
 <span data-ttu-id="0239c-123">I report e i modelli di Generatore report non supportano i file con estensione odc.</span><span class="sxs-lookup"><span data-stu-id="0239c-123">Report Builder reports and models do not work with .odc file.</span></span> <span data-ttu-id="0239c-124">Non è possibile utilizzare un file odc per generare un modello, né configurare un modello per l'utilizzo di un'origine dati condivisa collegata a un file odc.</span><span class="sxs-lookup"><span data-stu-id="0239c-124">You cannot use an .odc file to generate a model, and you cannot configure the model to use a shared data source that links to an .odc file.</span></span>  
  
 <span data-ttu-id="0239c-125">Se non si ha alcuna familiarità con i file odc, è possibile seguire le istruzioni seguenti per creare ed esportare un file odc.</span><span class="sxs-lookup"><span data-stu-id="0239c-125">If you are not familiar with .odc files, you can use the following instructions to create and export one.</span></span> <span data-ttu-id="0239c-126">Uno dei metodi più semplici per creare un file odc per un'origine dati OLE DB consiste nell'utilizzare Excel 2007 e la Connessione guidata dati.</span><span class="sxs-lookup"><span data-stu-id="0239c-126">One easy way to create an .odc file for an OLE DB data source is to use Excel 2007 and the Data Connection Wizard.</span></span> <span data-ttu-id="0239c-127">Si noti che tale procedura guidata non consente di creare un'origine dati. È pertanto necessario disporre di un'origine dati esterna definita in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0239c-127">Note that the wizard does not create a data source; you must have an external data source that is already defined.</span></span>  
  
 <span data-ttu-id="0239c-128">È possibile utilizzare un file odc esistente solo se è completamente compatibile con il report e le query.</span><span class="sxs-lookup"><span data-stu-id="0239c-128">An existing .odc file should only be used if it is fully compatible with the report and queries.</span></span> <span data-ttu-id="0239c-129">Se vengono generati errori che richiedono una modifica significativa del report o del file odc, sarà necessario creare un nuovo file rsds per il report.</span><span class="sxs-lookup"><span data-stu-id="0239c-129">If you run into errors that require significant modifications to either the report or to the .odc file, you should create a new .rsds file for the report.</span></span> <span data-ttu-id="0239c-130">Per altre informazioni sulla creazione di un'origine dati condivisa che usa un file rsds, vedere [Creare e gestire origini dati condivise &#40;Reporting Services in modalità integrata SharePoint&#41;](../create-manage-shared-data-sources-reporting-services-sharepoint-integrated-mode.md).</span><span class="sxs-lookup"><span data-stu-id="0239c-130">For more information about how to create a shared data source that uses an .rsds file, see [Create and Manage Shared Data Sources &#40;Reporting Services in SharePoint Integrated Mode&#41;](../create-manage-shared-data-sources-reporting-services-sharepoint-integrated-mode.md).</span></span>  
  
### <a name="to-create-and-export-an-odc-file"></a><span data-ttu-id="0239c-131">Per creare ed esportare un file odc</span><span class="sxs-lookup"><span data-stu-id="0239c-131">To create and export an .odc file</span></span>  
  
1.  <span data-ttu-id="0239c-132">Avviare Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="0239c-132">Start Excel 2007.</span></span>  
  
2.  <span data-ttu-id="0239c-133">Nel gruppo **Carica dati esterni** della scheda **Dati** fare clic su **Da altre origini**e quindi su **Da Connessione guidata dati**.</span><span class="sxs-lookup"><span data-stu-id="0239c-133">On the **Data** tab, in the **Get External Data** group, click **From Other Sources**, and then click **From Data Connection Wizard**.</span></span>  
  
3.  <span data-ttu-id="0239c-134">Selezionare **Altri server/Opzioni avanzate**e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="0239c-134">Select **Other/Advanced**, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="0239c-135">Selezionare **Provider Microsoft OLE DB per SQL Server**e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="0239c-135">Select **Microsoft OLE DB Provider for SQL Server**, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="0239c-136">Specificare il nome del server, che per impostazione predefinita è il nome di rete del computer, e un account utente dotato di un account di accesso valido e autorizzazioni per il database.</span><span class="sxs-lookup"><span data-stu-id="0239c-136">Enter the name of the server (by default, it is the network name of the computer) and a user account that has a valid login and database permissions.</span></span> <span data-ttu-id="0239c-137">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="0239c-137">Click **Next**.</span></span>  
  
6.  <span data-ttu-id="0239c-138">Selezionare un database e quindi fare clic su **OK** per chiudere la finestra di dialogo **Collegamento dati** .</span><span class="sxs-lookup"><span data-stu-id="0239c-138">Select a database, and then click **OK** to close the **Data Link** dialog box.</span></span>  
  
7.  <span data-ttu-id="0239c-139">La casella di controllo **Connetti a una tabella specifica** è selezionata per impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="0239c-139">The **Connect to specific table** check box is selected by default.</span></span> <span data-ttu-id="0239c-140">e consente di recuperare dati da una tabella specifica.</span><span class="sxs-lookup"><span data-stu-id="0239c-140">It is used to retrieve data from a specific table.</span></span> <span data-ttu-id="0239c-141">Poiché il server di report ignora tutte le query presenti in un file odc, lo stato di selezione di tale casella di controllo non influisce sui risultati.</span><span class="sxs-lookup"><span data-stu-id="0239c-141">The report server ignores all queries in an .odc file, so it does not matter whether you select or clear the check box.</span></span> <span data-ttu-id="0239c-142">Le query che recuperano i dati per un report sono incluse nel file di definizione del report e non nei file esterni.</span><span class="sxs-lookup"><span data-stu-id="0239c-142">Queries that retrieve data for a report are included in a report definition file and not in external files.</span></span>  
  
8.  <span data-ttu-id="0239c-143">Mentre la connessione è aperta è possibile modificarne le proprietà ed esportare il file di connessione.</span><span class="sxs-lookup"><span data-stu-id="0239c-143">While the connection is open, you can edit properties and export it.</span></span> <span data-ttu-id="0239c-144">Nel gruppo **Connessioni** della scheda **Dati** fare clic su **Proprietà**e quindi sul pulsante **Proprietà connessione** accanto al nome della connessione.</span><span class="sxs-lookup"><span data-stu-id="0239c-144">On the **Data** tab, in the **Connections** group, click **Properties**, and then click the **Connection Properties** button next to the connection name.</span></span>  
  
9. <span data-ttu-id="0239c-145">Nella scheda **Definizione** fare clic su **Esporta file di connessione**.</span><span class="sxs-lookup"><span data-stu-id="0239c-145">On the **Definition** tab, click **Export Connection File**.</span></span>  
  
10. <span data-ttu-id="0239c-146">Immettere un nome per il file e quindi fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="0239c-146">Enter a name for the file, and then click **Save**.</span></span> <span data-ttu-id="0239c-147">Chiudere l'applicazione e tutti i file aperti.</span><span class="sxs-lookup"><span data-stu-id="0239c-147">Close the application and all open files.</span></span>  
  
### <a name="to-upload-and-use-an-odc-file"></a><span data-ttu-id="0239c-148">Per caricare e utilizzare un file odc</span><span class="sxs-lookup"><span data-stu-id="0239c-148">To upload and use an .odc file</span></span>  
  
1.  <span data-ttu-id="0239c-149">Aprire la libreria in cui si desidera caricare il file di connessione.</span><span class="sxs-lookup"><span data-stu-id="0239c-149">Open the library into which you want to upload the connection file.</span></span>  
  
2.  <span data-ttu-id="0239c-150">Scegliere **Carica documento** dal menu **Carica**.</span><span class="sxs-lookup"><span data-stu-id="0239c-150">On the **Upload** menu, click **Upload document**.</span></span>  
  
3.  <span data-ttu-id="0239c-151">Fare clic su **Sfoglia**.</span><span class="sxs-lookup"><span data-stu-id="0239c-151">Click **Browse**.</span></span>  
  
4.  <span data-ttu-id="0239c-152">Selezionare il file odc creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0239c-152">Select the .odc file you created.</span></span> <span data-ttu-id="0239c-153">Per impostazione predefinita, il file odc si trova in Origini dati utente nella cartella Documenti.</span><span class="sxs-lookup"><span data-stu-id="0239c-153">By default, the .odc file is in the My Documents folder, in My Data Sources.</span></span>  
  
5.  <span data-ttu-id="0239c-154">Fare clic su **Apri** per selezionare il file e quindi fare clic su **OK** per salvare la selezione.</span><span class="sxs-lookup"><span data-stu-id="0239c-154">Click **Open** to select the file, click **OK** to save the selection.</span></span> <span data-ttu-id="0239c-155">Viene automaticamente aperta la pagina delle proprietà per il nuovo elemento.</span><span class="sxs-lookup"><span data-stu-id="0239c-155">The properties page for the new item opens automatically.</span></span>  
  
6.  <span data-ttu-id="0239c-156">In Tipo contenuto selezionare **Origine dati report**e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0239c-156">In Content Type, select **Report Data Source**, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="0239c-157">Selezionare un report.</span><span class="sxs-lookup"><span data-stu-id="0239c-157">Point to a report.</span></span>  
  
8.  <span data-ttu-id="0239c-158">Fare clic sulla freccia in giù e selezionare **Gestisci origini dati**.</span><span class="sxs-lookup"><span data-stu-id="0239c-158">Click the down arrow, and select **Manage Data Sources**.</span></span>  
  
9. <span data-ttu-id="0239c-159">Fare clic sul nome dell'origine dati.</span><span class="sxs-lookup"><span data-stu-id="0239c-159">Click the data source name.</span></span>  
  
10. <span data-ttu-id="0239c-160">Se il report usa informazioni di un'origine dati personalizzata, fare clic su **Condivisa**.</span><span class="sxs-lookup"><span data-stu-id="0239c-160">If the report uses custom data source information, click **Shared**.</span></span>  
  
11. <span data-ttu-id="0239c-161">In **Collegamento origine dati**fare clic sul pulsante con i puntini di sospensione ( **...** ).</span><span class="sxs-lookup"><span data-stu-id="0239c-161">In **Data Source Link**, click the browse (**...**) button.</span></span>  
  
12. <span data-ttu-id="0239c-162">Selezionare il file odc caricato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0239c-162">Select the .odc file you just uploaded.</span></span>  
  
13. <span data-ttu-id="0239c-163">Fare clic su **OK** per selezionare il file e quindi su **OK** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="0239c-163">Click **OK** to select the file, and then click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="0239c-164">Se si sta provando questa procedura con il database di esempio [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] e i report di esempio, tenere presente che solo il report Company Sales funziona con un file odc incluso.</span><span class="sxs-lookup"><span data-stu-id="0239c-164">If you are trying these steps with the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] sample database and sample reports, be aware that only the Company Sales report will work out-of-the-box with an .odc file.</span></span> <span data-ttu-id="0239c-165">Gli altri report di esempio contengono funzionalità e parametri di query che non supportano il provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="0239c-165">The other sample reports contain query parameters and features that do not work with the OLE DB provider.</span></span> <span data-ttu-id="0239c-166">È tuttavia possibile fare in modo che i report supportino il provider OLE DB modificandoli innanzitutto in Progettazione report.</span><span class="sxs-lookup"><span data-stu-id="0239c-166">However, you can make the reports work with the OLE DB provider if you modify them first in Report Designer.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0239c-167">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0239c-167">See Also</span></span>  
 [<span data-ttu-id="0239c-168">Creare, modificare ed eliminare origini dati condivise &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="0239c-168">Create, Modify, and Delete Shared Data Sources &#40;SSRS&#41;</span></span>](create-modify-and-delete-shared-data-sources-ssrs.md)  
  
  
