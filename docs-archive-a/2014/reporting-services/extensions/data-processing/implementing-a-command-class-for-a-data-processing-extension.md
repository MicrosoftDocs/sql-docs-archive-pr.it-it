---
title: Implementazione di una classe Command per un'estensione per l'elaborazione dati | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- data processing extensions [Reporting Services], commands
- Command class
- commands [Reporting Services]
ms.assetid: 465ef8d1-c503-407c-8afd-58d620e344ee
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: f07b9beb798b1cd33ec2fee6af890a09a516b2f5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725276"
---
# <a name="implementing-a-command-class-for-a-data-processing-extension"></a><span data-ttu-id="e6a0a-102">Implementazione di una classe Command per un'estensione per l'elaborazione dati</span><span class="sxs-lookup"><span data-stu-id="e6a0a-102">Implementing a Command Class for a Data Processing Extension</span></span>
  <span data-ttu-id="e6a0a-103">L'oggetto **Command** formula una richiesta e la passa all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-103">The **Command** object formulates a request and passes it on to the data source.</span></span> <span data-ttu-id="e6a0a-104">Il testo del comando può avere forme sintattiche diverse, tra cui testo e XML.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-104">The command text can take many different syntactical forms, including text and XML.</span></span> <span data-ttu-id="e6a0a-105">Se vengono restituiti risultati, l'oggetto **Command** restituisce i risultati come oggetto **DataReader**.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-105">If results are returned, the **Command** object returns results as a **DataReader** object.</span></span>  
  
 <span data-ttu-id="e6a0a-106">Per creare una classe **Command**, implementare <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand>.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-106">To create a **Command** class, implement <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand>.</span></span> <span data-ttu-id="e6a0a-107">Implementare il metodo <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> per restituire un set di risultati come oggetto **DataReader**.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-107">Implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> method to return a result set as a **DataReader** object.</span></span> <span data-ttu-id="e6a0a-108">Il metodo <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> della classe **Command** deve includere un'implementazione che accetti un'enumerazione <xref:Microsoft.ReportingServices.DataProcessing.CommandBehavior> come argomento.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-108">The <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> method of your **Command** class should include an implementation that takes a <xref:Microsoft.ReportingServices.DataProcessing.CommandBehavior> enumeration as an argument.</span></span> <span data-ttu-id="e6a0a-109">Se si distribuisce l'estensione per l'elaborazione dati in Progettazione report, fornire un'implementazione in grado di gestire un caso <xref:Microsoft.ReportingServices.DataProcessing.CommandBehavior.SchemaOnly> nel metodo <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A>.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-109">If you deploy your data processing extension to Report Designer, provide an implementation that handles a <xref:Microsoft.ReportingServices.DataProcessing.CommandBehavior.SchemaOnly> case in the <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> method.</span></span> <span data-ttu-id="e6a0a-110">Un'implementazione di solo schema viene utilizzata per fornire un elenco di campi a Progettazione report.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-110">A schema-only implementation is used to supply Report Designer with a fields list.</span></span> <span data-ttu-id="e6a0a-111">L'oggetto **DataReader** restituito dal metodo <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> deve contenere informazioni relative a tipo e nome per i campi, o le colonne, del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-111">The **DataReader** object returned by the <xref:Microsoft.ReportingServices.DataProcessing.IDbCommand.ExecuteReader%2A> method needs to contain type and name information for the fields, or columns, in your result set.</span></span>  
  
 <span data-ttu-id="e6a0a-112">Facoltativamente, la classe **Command** può implementare <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis>.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-112">Optionally, your **Command** class can implement <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis>.</span></span> <span data-ttu-id="e6a0a-113">Questa interfaccia consente a una classe di implementazione di analizzare una query e restituire un elenco di parametri della query.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-113">This interface enables an implementing class to analyze a query and return a list of parameters in the query.</span></span> <span data-ttu-id="e6a0a-114">La funzionalità dell'interfaccia <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis> viene utilizzata solo in Progettazione report.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-114">The functionality of the <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis> interface is only used in Report Designer.</span></span> <span data-ttu-id="e6a0a-115">Quando si implementa <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis>, si consente agli utenti di Progettazione report di ricevere una richiesta per i parametri ogni volta che un report viene eseguito in modalità di anteprima.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-115">When you implement <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis>, you enable users of Report Designer to be prompted for parameters whenever a report is run in preview mode.</span></span> <span data-ttu-id="e6a0a-116">È anche possibile visualizzare i parametri nella scheda **Parametri** della finestra di dialogo **Set di dati**.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-116">In addition, you can view the parameters in the **Parameters** tab of the **Data Set** dialog.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e6a0a-117">Non implementare <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis> se l'estensione per l'elaborazione dati personalizzata non supporta i parametri.</span><span class="sxs-lookup"><span data-stu-id="e6a0a-117">You should not implement <xref:Microsoft.ReportingServices.DataProcessing.IDbCommandAnalysis> if your custom data processing extension does not support parameters.</span></span>  
  
 <span data-ttu-id="e6a0a-118">Per un'implementazione di esempio della classe **Command**, vedere la pagina degli [esempi del prodotto SQL Server Reporting Services](https://go.microsoft.com/fwlink/?LinkId=177889).</span><span class="sxs-lookup"><span data-stu-id="e6a0a-118">For a sample **Command** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e6a0a-119">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e6a0a-119">See Also</span></span>  
 <span data-ttu-id="e6a0a-120">[Estensioni di Reporting Services](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="e6a0a-120">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="e6a0a-121">[Implementazione di un'estensione per l'elaborazione dati](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="e6a0a-121">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="e6a0a-122">Libreria di estensioni di Reporting Services</span><span class="sxs-lookup"><span data-stu-id="e6a0a-122">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
