---
title: Utilità SQLdiag | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
helpviewer_keywords:
- command prompt utilities [SQL Server], SQLdiag
- stopping diagnostic collection
- storing diagnostic information
- performance [SQL Server], diagnostic collection
- diagnostic records [SQL Server]
- scripts [SQL Server], diagnostic collection
- logs [SQL Server], diagnostic collection
- starting diagnostic collection
- clustered instance of SQL Server
- monitoring performance [SQL Server], diagnostic collection
- security [SQL Server], diagnostic collection
- SQLDIAG service
- space [SQL Server], diagnostic collection
- SQLdiag utility
- disk space [SQL Server], diagnostic collection
- configuration files [SQL Server]
- automatic diagnostic collection
- clusters [SQL Server], diagnostic collection
ms.assetid: 45ba1307-33d1-431e-872c-a6e4556f5ff2
author: stevestein
ms.author: sstein
ms.openlocfilehash: 0559e0b2261ed5ba1c9c384608d04194d685f695
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87711240"
---
# <a name="sqldiag-utility"></a><span data-ttu-id="75d37-102">SQLdiag - utilità</span><span class="sxs-lookup"><span data-stu-id="75d37-102">SQLdiag Utility</span></span>
  <span data-ttu-id="75d37-103">**SQLdiag** è un'utilità di raccolta di dati diagnostici generica che può essere eseguita come applicazione console o come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-103">The **SQLdiag** utility is a general purpose diagnostics collection utility that can be run as a console application or as a service.</span></span> <span data-ttu-id="75d37-104">È possibile usare **SQLdiag** per raccogliere i log e i file di dati da [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e altri tipi di server, nonché per monitorare i server in un intervallo di tempo oppure risolvere problemi specifici dei server.</span><span class="sxs-lookup"><span data-stu-id="75d37-104">You can use **SQLdiag** to collect logs and data files from [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] and other types of servers, and use it to monitor your servers over time or troubleshoot specific problems with your servers.</span></span> <span data-ttu-id="75d37-105">L'utilità**SQLdiag** è stata creata per velocizzare e semplificare la raccolta delle informazioni diagnostiche necessarie per il Servizio Supporto Tecnico Clienti [!INCLUDE[msCoName](../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-105">**SQLdiag** is intended to expedite and simplify diagnostic information gathering for [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-106">Poiché questa utilità è soggetta a modifiche, le applicazioni o gli script che ne utilizzano gli argomenti della riga di comando o che dipendono dal suo comportamento potrebbero non funzionare correttamente nelle versioni future.</span><span class="sxs-lookup"><span data-stu-id="75d37-106">This utility may be changed, and applications or scripts that rely on its command line arguments or behavior may not work correctly in future releases.</span></span>  
  
 <span data-ttu-id="75d37-107">L'utilità**SQLdiag** può raccogliere i tipi di informazioni diagnostiche riportate di seguito:</span><span class="sxs-lookup"><span data-stu-id="75d37-107">**SQLdiag** can collect the following types of diagnostic information:</span></span>  
  
-   <span data-ttu-id="75d37-108">Registri di prestazioni di Windows</span><span class="sxs-lookup"><span data-stu-id="75d37-108">Windows performance logs</span></span>  
  
-   <span data-ttu-id="75d37-109">Log eventi di Windows</span><span class="sxs-lookup"><span data-stu-id="75d37-109">Windows event logs</span></span>  
  
-   [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] <span data-ttu-id="75d37-110">tracce</span><span class="sxs-lookup"><span data-stu-id="75d37-110">traces</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="75d37-111">informazioni di blocco</span><span class="sxs-lookup"><span data-stu-id="75d37-111">blocking information</span></span>  
  
-   [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="75d37-112">informazioni di configurazione</span><span class="sxs-lookup"><span data-stu-id="75d37-112">configuration information</span></span>  
  
 <span data-ttu-id="75d37-113">Per specificare i tipi di informazione che si vogliono raccogliere con l'utilità **SQLdiag** , modificare il file di configurazione SQLDiag.xml, descritto nella sezione seguente.</span><span class="sxs-lookup"><span data-stu-id="75d37-113">You can specify what types of information you want **SQLdiag** to collect by editing the configuration file SQLDiag.xml, which is described in a following section.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="75d37-114">Sintassi</span><span class="sxs-lookup"><span data-stu-id="75d37-114">Syntax</span></span>  
  
```  
  
      sqldiag   
     { [/?] }  
     |  
     { [/I configuration_file]  
       [/O output_folder_path]  
       [/Psupport_folder_path]  
       [/Noutput_folder_management_option]  
       [/Mmachine1 [ machine2machineN]| @machinelistfile]  
       [/Cfile_compression_type]  
       [/B [+]start_time]  
       [/E [+]stop_time]  
       [/ASQLdiag_application_name]  
       [/T { tcp [ ,port ] | np | lpc } ]  
       [/Q] [/G] [/R] [/U] [/L] [/X] }  
     |  
     { [START | STOP | STOP_ABORT] }  
     |  
     { [START | STOP | STOP_ABORT] /ASQLdiag_application_name }  
```  
  
## <a name="arguments"></a><span data-ttu-id="75d37-115">Argomenti</span><span class="sxs-lookup"><span data-stu-id="75d37-115">Arguments</span></span>  
 <span data-ttu-id="75d37-116">**/?**</span><span class="sxs-lookup"><span data-stu-id="75d37-116">**/?**</span></span>  
 <span data-ttu-id="75d37-117">Visualizza le informazioni sull'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="75d37-117">Displays usage information.</span></span>  
  
 <span data-ttu-id="75d37-118">**/I** _configuration_file_</span><span class="sxs-lookup"><span data-stu-id="75d37-118">**/I** _configuration_file_</span></span>  
 <span data-ttu-id="75d37-119">Imposta il file di configurazione usato da **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-119">Sets the configuration file for **SQLdiag** to use.</span></span> <span data-ttu-id="75d37-120">Per impostazione predefinita, **/I** è impostato su SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="75d37-120">By default, **/I** is set to SQLDiag.Xml.</span></span>  
  
 <span data-ttu-id="75d37-121">**/O** _output_folder_path_</span><span class="sxs-lookup"><span data-stu-id="75d37-121">**/O** _output_folder_path_</span></span>  
 <span data-ttu-id="75d37-122">Reindirizza l'output dell'utilità **SQLdiag** sulla cartella specificata.</span><span class="sxs-lookup"><span data-stu-id="75d37-122">Redirects **SQLdiag** output to the specified folder.</span></span> <span data-ttu-id="75d37-123">Se si omette l'opzione **/O** , l'output dell'utilità **SQLdiag** viene scritto in una sottocartella denominata SQLDIAG nella cartella di avvio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-123">If the **/O** option is not specified, **SQLdiag** output is written to a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="75d37-124">Se la cartella SQLDIAG non esiste, l'utilità **SQLdiag** cercherà di crearla.</span><span class="sxs-lookup"><span data-stu-id="75d37-124">If the SQLDIAG folder does not exist, **SQLdiag** attempts to create it.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-125">La posizione della cartella di output è relativa alla posizione della cartella di supporto che è possibile specificare mediante **/P**.</span><span class="sxs-lookup"><span data-stu-id="75d37-125">The output folder location is relative to the support folder location that can be specified with **/P**.</span></span> <span data-ttu-id="75d37-126">Per impostare una cartella di output completamente diversa, specificare il percorso completo della directory per **/O**.</span><span class="sxs-lookup"><span data-stu-id="75d37-126">To set an entirely different location for the output folder, specify the full directory path for **/O**.</span></span>  
  
 <span data-ttu-id="75d37-127">**/P** _support_folder_path_</span><span class="sxs-lookup"><span data-stu-id="75d37-127">**/P** _support_folder_path_</span></span>  
 <span data-ttu-id="75d37-128">Imposta il percorso della cartella di supporto.</span><span class="sxs-lookup"><span data-stu-id="75d37-128">Sets the support folder path.</span></span> <span data-ttu-id="75d37-129">Per impostazione predefinita, **/P** viene impostata sulla cartella nella quale risiede il file eseguibile di **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-129">By default, **/P** is set to the folder where the **SQLdiag** executable resides.</span></span> <span data-ttu-id="75d37-130">La cartella di supporto contiene i file di supporto di **SQLdiag** , ad esempio il file di configurazione XML, gli script di Transact-SQL e altri file che l'utilità usa durante la raccolta dei dati diagnostici.</span><span class="sxs-lookup"><span data-stu-id="75d37-130">The support folder contains **SQLdiag** support files, such as the XML configuration file, Transact-SQL scripts, and other files that the utility uses during diagnostics collection.</span></span> <span data-ttu-id="75d37-131">Se si usa questa opzione per specificare un percorso alternativo per i file di supporto, **SQLdiag** copierà automaticamente i file di supporto necessari nella cartella specificata, se non esistono già.</span><span class="sxs-lookup"><span data-stu-id="75d37-131">If you use this option to specify an alternate support files path, **SQLdiag** will automatically copy the support files it requires to the specified folder if they do not already exist.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-132">Per impostare la cartella corrente come percorso di supporto, specificare **%cd%** nella riga di comando come segue:</span><span class="sxs-lookup"><span data-stu-id="75d37-132">To set your current folder as the support path, specify **%cd%** on the command line as follows:</span></span>  
>   
>  <span data-ttu-id="75d37-133">**SQLDIAG /P %cd%**</span><span class="sxs-lookup"><span data-stu-id="75d37-133">**SQLDIAG /P %cd%**</span></span>  
  
 <span data-ttu-id="75d37-134">**/N** _output_folder_management_option_</span><span class="sxs-lookup"><span data-stu-id="75d37-134">**/N** _output_folder_management_option_</span></span>  
 <span data-ttu-id="75d37-135">Imposta la sovrascrittura o la ridenominazione della cartella di output all'avvio dell'utilità **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-135">Sets whether **SQLdiag** overwrites or renames the output folder when it starts up.</span></span> <span data-ttu-id="75d37-136">Opzioni disponibili:</span><span class="sxs-lookup"><span data-stu-id="75d37-136">Available options:</span></span>  
  
 <span data-ttu-id="75d37-137">1 = sovrascrive la cartella di output (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="75d37-137">1 = Overwrites the output folder (default)</span></span>  
  
 <span data-ttu-id="75d37-138">2 = all'avvio di **SQLdiag** , rinomina la cartella di output in SQLDIAG_00001, SQLDIAG_00002 e così via.</span><span class="sxs-lookup"><span data-stu-id="75d37-138">2 = When **SQLdiag** starts up, it renames the output folder to SQLDIAG_00001, SQLDIAG_00002, and so on.</span></span> <span data-ttu-id="75d37-139">Dopo aver rinominato la cartella di output corrente, **SQLdiag** scrive l'output nella cartella di output predefinita SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="75d37-139">After renaming the current output folder, **SQLdiag** writes output to the default output folder SQLDIAG.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-140">Con**SQLdiag** l'output non viene accodato alla cartella di output corrente al momento dell'avvio.</span><span class="sxs-lookup"><span data-stu-id="75d37-140">**SQLdiag** does not append output to the current output folder when it starts up.</span></span> <span data-ttu-id="75d37-141">È possibile soltanto sovrascrivere la cartella di output predefinita (opzione 1) o rinominare la cartella (opzione 2), quindi l'output viene scritto nella nuova cartella di output predefinita denominata SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="75d37-141">It can only overwrite the default output folder (option 1) or rename the folder (option 2), and then it writes output to the new default output folder named SQLDIAG.</span></span>  
  
 <span data-ttu-id="75d37-142">**/M** _machine1_ [ *COMPUTER2 \* \* Machinen*] |*@machinelistfile*</span><span class="sxs-lookup"><span data-stu-id="75d37-142">**/M** _machine1_ [ *machine2\*\*machineN*] | *@machinelistfile*</span></span>  
 <span data-ttu-id="75d37-143">Esegue l'override del computer specificato nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="75d37-143">Overrides the machines specified in the configuration file.</span></span> <span data-ttu-id="75d37-144">Per impostazione predefinita il file di configurazione è SQLDiag.Xml o è impostato con il parametro **/I** .</span><span class="sxs-lookup"><span data-stu-id="75d37-144">By default the configuration file is SQLDiag.Xml, or is set with the **/I** parameter.</span></span> <span data-ttu-id="75d37-145">Quando si specifica più di un computer, separare ogni nome di computer con uno spazio.</span><span class="sxs-lookup"><span data-stu-id="75d37-145">When specifying more than one machine, separate each machine name with a space.</span></span>  
  
 <span data-ttu-id="75d37-146">*@machinelistfile*L'utilizzo di consente di specificare un nome file di un elenco di computer da archiviare nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="75d37-146">Using *@machinelistfile* specifies a machine list filename to be stored in the configuration file.</span></span>  
  
 <span data-ttu-id="75d37-147">**/C** _file_compression_type_</span><span class="sxs-lookup"><span data-stu-id="75d37-147">**/C** _file_compression_type_</span></span>  
 <span data-ttu-id="75d37-148">Imposta il tipo di compressione usato per i file nella cartella di output **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-148">Sets the type of file compression used on the **SQLdiag** output folder files.</span></span> <span data-ttu-id="75d37-149">Opzioni disponibili:</span><span class="sxs-lookup"><span data-stu-id="75d37-149">Available options:</span></span>  
  
 <span data-ttu-id="75d37-150">0 = nessuna compressione (impostazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="75d37-150">0 = none (default)</span></span>  
  
 <span data-ttu-id="75d37-151">1 = compressione NTFS</span><span class="sxs-lookup"><span data-stu-id="75d37-151">1 = uses NTFS compression</span></span>  
  
 <span data-ttu-id="75d37-152">**/B** [ **+** ]*start_time*</span><span class="sxs-lookup"><span data-stu-id="75d37-152">**/B** [**+**]*start_time*</span></span>  
 <span data-ttu-id="75d37-153">Specifica la data e l'ora di inizio della raccolta di dati diagnostici nel formato seguente:</span><span class="sxs-lookup"><span data-stu-id="75d37-153">Specifies the date and time to start collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="75d37-154">AAAAMMGG_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="75d37-154">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="75d37-155">L'ora viene specificata nel formato 24 ore.</span><span class="sxs-lookup"><span data-stu-id="75d37-155">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="75d37-156">Per specificare ad esempio le 2 del pomeriggio</span><span class="sxs-lookup"><span data-stu-id="75d37-156">For example, 2:00 P.M.</span></span> <span data-ttu-id="75d37-157">deve essere specificato come **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="75d37-157">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="75d37-158">Usare **+** senza specificare la data, ovvero solo HH:MM:SS, per specificare un'ora in relazione alla data e all'ora correnti.</span><span class="sxs-lookup"><span data-stu-id="75d37-158">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="75d37-159">Ad esempio, se si specifica **/B +02:00:00**, **SQLdiag** attenderà due ore prima di iniziare a raccogliere informazioni.</span><span class="sxs-lookup"><span data-stu-id="75d37-159">For example, if you specify **/B +02:00:00**, **SQLdiag** will wait 2 hours before it starts collecting information.</span></span>  
  
 <span data-ttu-id="75d37-160">Non inserire spazi tra **+** e il valore specificato per *start_time*.</span><span class="sxs-lookup"><span data-stu-id="75d37-160">Do not insert a space between **+** and the specified *start_time*.</span></span>  
  
 <span data-ttu-id="75d37-161">Se si specifica un'ora di inizio già trascorsa, **SQLdiag** modifica forzatamente la data di inizio in modo che faccia riferimento a un periodo futuro.</span><span class="sxs-lookup"><span data-stu-id="75d37-161">If you specify a start time that is in the past, **SQLdiag** forcibly changes the start date so the start date and time are in the future.</span></span> <span data-ttu-id="75d37-162">Se ad esempio si specifica **/B 01:00:00** e l'ora corrente è 08:00:00, **SQLdiag** modifica forzatamente la data di inizio in modo che venga impostata in corrispondenza del giorno successivo.</span><span class="sxs-lookup"><span data-stu-id="75d37-162">For example, if you specify **/B 01:00:00** and the current time is 08:00:00, **SQLdiag** forcibly changes the start date so that the start date is the next day.</span></span>  
  
 <span data-ttu-id="75d37-163">L'utilità **SQLdiag** usa l'ora locale del computer in cui è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="75d37-163">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="75d37-164">**/E** [ **+** ]*stop_time*</span><span class="sxs-lookup"><span data-stu-id="75d37-164">**/E** [**+**]*stop_time*</span></span>  
 <span data-ttu-id="75d37-165">Specifica la data e l'ora di arresto della raccolta di dati diagnostici nel formato seguente:</span><span class="sxs-lookup"><span data-stu-id="75d37-165">Specifies the date and time to stop collecting diagnostic data in the following format:</span></span>  
  
 <span data-ttu-id="75d37-166">AAAAMMGG_HH:MM:SS</span><span class="sxs-lookup"><span data-stu-id="75d37-166">YYYYMMDD_HH:MM:SS</span></span>  
  
 <span data-ttu-id="75d37-167">L'ora viene specificata nel formato 24 ore.</span><span class="sxs-lookup"><span data-stu-id="75d37-167">The time is specified using 24-hour notation.</span></span> <span data-ttu-id="75d37-168">Per specificare ad esempio le 2 del pomeriggio</span><span class="sxs-lookup"><span data-stu-id="75d37-168">For example, 2:00 P.M.</span></span> <span data-ttu-id="75d37-169">deve essere specificato come **14:00:00**.</span><span class="sxs-lookup"><span data-stu-id="75d37-169">should be specified as **14:00:00**.</span></span>  
  
 <span data-ttu-id="75d37-170">Usare **+** senza specificare la data, ovvero solo HH:MM:SS, per specificare un'ora in relazione alla data e all'ora correnti.</span><span class="sxs-lookup"><span data-stu-id="75d37-170">Use **+** without the date (HH:MM:SS only) to specify a time that is relative to the current date and time.</span></span> <span data-ttu-id="75d37-171">Se ad esempio si specifica un'ora di inizio e un'ora di fine usando **/B +02:00:00 /E +03:00:00**, **SQLdiag** attenderà 2 ore prima di iniziare a raccogliere informazioni. I dati verranno raccolti per 3 ore prima che l'utilità venga arrestata e chiusa.</span><span class="sxs-lookup"><span data-stu-id="75d37-171">For example, if you specify a start time and end time by using **/B +02:00:00 /E +03:00:00**, **SQLdiag** waits 2 hours before it starts collecting information, then collects information for 3 hours before it stops and exits.</span></span> <span data-ttu-id="75d37-172">Se si omette **/B** , **SQLdiag** inizia a raccogliere subito i dati diagnostici e termina alla data e all'ora specificate da **/E**.</span><span class="sxs-lookup"><span data-stu-id="75d37-172">If **/B** is not specified, **SQLdiag** starts collecting diagnostics immediately and ends at the date and time specified by **/E**.</span></span>  
  
 <span data-ttu-id="75d37-173">Non inserire spazi tra **+** e il valore specificato per *start_time* o *end_time*.</span><span class="sxs-lookup"><span data-stu-id="75d37-173">Do not insert a space between **+** and the specified *start_time* or *end_time*.</span></span>  
  
 <span data-ttu-id="75d37-174">L'utilità **SQLdiag** usa l'ora locale del computer in cui è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="75d37-174">Note that **SQLdiag** uses the local time on the computer where the utility is running.</span></span>  
  
 <span data-ttu-id="75d37-175">**/A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="75d37-175">**/A** _SQLdiag_application_name_</span></span>  
 <span data-ttu-id="75d37-176">Abilita l'esecuzione di più istanze dell'utilità **SQLdiag** sulla base della stessa istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-176">Enables running multiple instances of the **SQLdiag** utility against the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="75d37-177">Ogni *SQLdiag_application_name* identifica un'istanza diversa di **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="75d37-177">Each *SQLdiag_application_name* identifies a different instance of **SQLdiag**.</span></span> <span data-ttu-id="75d37-178">Non esiste alcuna relazione tra un'istanza *SQLdiag_application_name* e il nome di un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-178">No relationship exists between a *SQLdiag_application_name* instance and a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance name.</span></span>  
  
 <span data-ttu-id="75d37-179">È possibile usare*SQLdiag_application_name* per avviare o arrestare un'istanza specifica del servizio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-179">*SQLdiag_application_name* can be used to start or stop a specific instance of the **SQLdiag** service.</span></span>  
  
 <span data-ttu-id="75d37-180">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="75d37-180">For example:</span></span>  
  
 <span data-ttu-id="75d37-181">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="75d37-181">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
 <span data-ttu-id="75d37-182">È anche possibile usare tale parametro con l'opzione **/R** per registrare un'istanza specifica di **SQLdiag** come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-182">It can also be used with the **/R** option to register a specific instance of **SQLdiag** as a service.</span></span> <span data-ttu-id="75d37-183">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="75d37-183">For example:</span></span>  
  
 <span data-ttu-id="75d37-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="75d37-184">**SQLDIAG /R /A** _SQLdiag_application_name_</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-185">**SQLdiag** aggiunge automaticamente il prefisso DIAG$ al nome dell'istanza specificato per *SQLdiag_application_name*.</span><span class="sxs-lookup"><span data-stu-id="75d37-185">**SQLdiag** automatically prefixes DIAG$ to the instance name specified for *SQLdiag_application_name*.</span></span> <span data-ttu-id="75d37-186">In questo modo viene messo a disposizione un nome di servizio appropriato se si registra **SQLdiag** come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-186">This provides a sensible service name if you register **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="75d37-187">/T { tcp [ ,*port* ] | np | lpc }</span><span class="sxs-lookup"><span data-stu-id="75d37-187">/T { tcp [ ,*port* ] | np | lpc }</span></span>  
 <span data-ttu-id="75d37-188">Consente di connettersi a un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando il protocollo specificato.</span><span class="sxs-lookup"><span data-stu-id="75d37-188">Connects to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] using the specified protocol.</span></span>  
  
 <span data-ttu-id="75d37-189">tcp [,*port*]</span><span class="sxs-lookup"><span data-stu-id="75d37-189">tcp [,*port*]</span></span>  
 <span data-ttu-id="75d37-190">Protocollo TCP/IP (Transmission Control Protocol/Internet Protocol).</span><span class="sxs-lookup"><span data-stu-id="75d37-190">Transmission Control Protocol/Internet Protocol (TCP/IP).</span></span> <span data-ttu-id="75d37-191">È possibile specificare facoltativamente un numero di porta per la connessione.</span><span class="sxs-lookup"><span data-stu-id="75d37-191">You can optionally specify a port number for the connection.</span></span>  
  
 <span data-ttu-id="75d37-192">np</span><span class="sxs-lookup"><span data-stu-id="75d37-192">np</span></span>  
 <span data-ttu-id="75d37-193">Named pipe.</span><span class="sxs-lookup"><span data-stu-id="75d37-193">Named pipes.</span></span> <span data-ttu-id="75d37-194">Per impostazione predefinita, l'istanza predefinita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] resta in attesa sulla named pipe `\\.\pipe\sql\query` e `\\.\pipe\MSSQL$<instancename>\sql\query` per un'istanza denominata.</span><span class="sxs-lookup"><span data-stu-id="75d37-194">By default, the default instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] listens on named pipe `\\.\pipe\sql\query` and `\\.\pipe\MSSQL$<instancename>\sql\query` for a named instance.</span></span> <span data-ttu-id="75d37-195">Non è possibile connettersi a un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] tramite un nome della pipe alternativo.</span><span class="sxs-lookup"><span data-stu-id="75d37-195">You cannot connect to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using an alternate pipe name.</span></span>  
  
 <span data-ttu-id="75d37-196">lpc</span><span class="sxs-lookup"><span data-stu-id="75d37-196">lpc</span></span>  
 <span data-ttu-id="75d37-197">Chiamata di procedura locale.</span><span class="sxs-lookup"><span data-stu-id="75d37-197">Local procedure call.</span></span> <span data-ttu-id="75d37-198">Il protocollo Shared Memory è disponibile se il client si connette a un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="75d37-198">This shared memory protocol is available if the client is connecting to an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] on the same computer.</span></span>  
  
 <span data-ttu-id="75d37-199">**/Q**</span><span class="sxs-lookup"><span data-stu-id="75d37-199">**/Q**</span></span>  
 <span data-ttu-id="75d37-200">Esegue **SQLdiag** in modalità non interattiva.</span><span class="sxs-lookup"><span data-stu-id="75d37-200">Runs **SQLdiag** in quiet mode.</span></span> <span data-ttu-id="75d37-201">**/Q** disattiva tutti i prompt, ad esempio i prompt delle password.</span><span class="sxs-lookup"><span data-stu-id="75d37-201">**/Q** suppresses all prompts, such as password prompts.</span></span>  
  
 <span data-ttu-id="75d37-202">**/G**</span><span class="sxs-lookup"><span data-stu-id="75d37-202">**/G**</span></span>  
 <span data-ttu-id="75d37-203">Esegue **SQLdiag** in modalità generica.</span><span class="sxs-lookup"><span data-stu-id="75d37-203">Runs **SQLdiag** in generic mode.</span></span> <span data-ttu-id="75d37-204">Se si specifica **/G** , all'avvio dell'utilità **SQLdiag** non vengono eseguiti i controlli della connettività di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] né viene verificata l'appartenenza dell'utente al ruolo predefinito del server **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="75d37-204">When **/G** is specified, on startup **SQLdiag** does not enforce [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] connectivity checks or verify that the user is a member of the **sysadmin** fixed server role.</span></span> <span data-ttu-id="75d37-205">L'utilità **SQLdiag** usa invece Windows per determinare se un utente ha le autorizzazioni sufficienti per raccogliere i dati diagnostici richiesti.</span><span class="sxs-lookup"><span data-stu-id="75d37-205">Instead, **SQLdiag** defers to Windows to determine whether a user has the appropriate rights to gather each requested diagnostic.</span></span>  
  
 <span data-ttu-id="75d37-206">Se si omette **/G** , **SQLdiag** verifica se l'utente è membro del gruppo **Administrators** di Windows e non procede alla raccolta dei dati diagnostici di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] se l'utente non appartiene al gruppo **Administrators** .</span><span class="sxs-lookup"><span data-stu-id="75d37-206">If **/G** is not specified, **SQLdiag** checks to determine whether the user is a member of the Windows **Administrators** group, and will not collect [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] diagnostics if the user is not an **Administrators** group member.</span></span>  
  
 <span data-ttu-id="75d37-207">**/R**</span><span class="sxs-lookup"><span data-stu-id="75d37-207">**/R**</span></span>  
 <span data-ttu-id="75d37-208">Registra **SQLdiag** come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-208">Registers **SQLdiag** as a service.</span></span> <span data-ttu-id="75d37-209">Gli argomenti della riga di comando specificati per registrare l'utilità **SQLdiag** come servizio vengono conservati per le esecuzioni future del servizio stesso.</span><span class="sxs-lookup"><span data-stu-id="75d37-209">Any command line arguments that are specified when you register **SQLdiag** as a service are preserved for future runs of the service.</span></span>  
  
 <span data-ttu-id="75d37-210">Se l'utilità **SQLdiag** viene registrata come servizio, il nome del servizio predefinito è SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="75d37-210">When **SQLdiag** is registered as a service, the default service name is SQLDIAG.</span></span> <span data-ttu-id="75d37-211">È possibile modificare il nome del servizio usando l'argomento **/A** .</span><span class="sxs-lookup"><span data-stu-id="75d37-211">You can change the service name by using the **/A** argument.</span></span>  
  
 <span data-ttu-id="75d37-212">Utilizzare l'argomento della riga di comando **START** per avviare il servizio:</span><span class="sxs-lookup"><span data-stu-id="75d37-212">Use the **START** command line argument to start the service:</span></span>  
  
 <span data-ttu-id="75d37-213">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="75d37-213">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="75d37-214">È inoltre possibile utilizzare il comando **net start** per avviare il servizio:</span><span class="sxs-lookup"><span data-stu-id="75d37-214">You can also use the **net start** command to start the service:</span></span>  
  
 <span data-ttu-id="75d37-215">**NET Start SQLdiag**</span><span class="sxs-lookup"><span data-stu-id="75d37-215">**net start SQLDIAG**</span></span>  
  
 <span data-ttu-id="75d37-216">**/U**</span><span class="sxs-lookup"><span data-stu-id="75d37-216">**/U**</span></span>  
 <span data-ttu-id="75d37-217">Annulla la registrazione di **SQLdiag** come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-217">Unregisters **SQLdiag** as a service.</span></span>  
  
 <span data-ttu-id="75d37-218">Usare l'argomento **/A** anche se si annulla la registrazione di un'istanza denominata di **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-218">Use the **/A** argument also if unregistering a named **SQLdiag** instance.</span></span>  
  
 <span data-ttu-id="75d37-219">**/L**</span><span class="sxs-lookup"><span data-stu-id="75d37-219">**/L**</span></span>  
 <span data-ttu-id="75d37-220">Esegue l'utilità **SQLdiag** in modalità continua quando si specificano un'ora di inizio o fine rispettivamente con gli argomenti **/B** o **/E** .</span><span class="sxs-lookup"><span data-stu-id="75d37-220">Runs **SQLdiag** in continuous mode when a start time or end time is also specified with the **/B** or **/E** arguments, respectively.</span></span> <span data-ttu-id="75d37-221">L'utilità**SQLdiag** viene automaticamente riavviata in seguito all'arresto della raccolta di dati diagnostici a causa di una chiusura pianificata impostata</span><span class="sxs-lookup"><span data-stu-id="75d37-221">**SQLdiag** automatically restarts after diagnostics collection stops due to a scheduled shutdown.</span></span> <span data-ttu-id="75d37-222">tramite, ad esempio, l'argomento **/E** o **/X** .</span><span class="sxs-lookup"><span data-stu-id="75d37-222">For example, by using the **/E** or the **/X** arguments.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-223">**SQLdiag** ignora l'argomento **/L** se non si specifica un'ora di inizio e fine con gli argomenti della riga di comando **/B** e **/E** .</span><span class="sxs-lookup"><span data-stu-id="75d37-223">**SQLdiag** ignores the **/L** argument if a start time or end time is not specified by using the **/B** and **/E** command line arguments.</span></span>  
  
 <span data-ttu-id="75d37-224">L'uso dell'argomento **/L** non implica la definizione della modalità del servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-224">Using **/L** does not imply the service mode.</span></span> <span data-ttu-id="75d37-225">Per usare **/L** per l'esecuzione dell'utilità **SQLdiag** come servizio, specificare l'argomento nella riga di comando quando si registra il servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-225">To use **/L** when running **SQLdiag** as a service, specify it on the command line when you register the service.</span></span>  
  
 <span data-ttu-id="75d37-226">**/X**</span><span class="sxs-lookup"><span data-stu-id="75d37-226">**/X**</span></span>  
 <span data-ttu-id="75d37-227">Esegue **SQLdiag** in modalità snapshot.</span><span class="sxs-lookup"><span data-stu-id="75d37-227">Runs **SQLdiag** in snapshot mode.</span></span> <span data-ttu-id="75d37-228">L'utilità**SQLdiag** esegue uno snapshot di tutti i dati diagnostici configurati, quindi viene chiusa automaticamente.</span><span class="sxs-lookup"><span data-stu-id="75d37-228">**SQLdiag** takes a snapshot of all configured diagnostics and then shuts down automatically.</span></span>  
  
 <span data-ttu-id="75d37-229">**START** | **STOP** | **STOP_ABORT**</span><span class="sxs-lookup"><span data-stu-id="75d37-229">**START** | **STOP** | **STOP_ABORT**</span></span>  
 <span data-ttu-id="75d37-230">Avvia o arresta il servizio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-230">Starts or stops the **SQLdiag** service.</span></span> <span data-ttu-id="75d37-231">**STOP_ABORT** forza il servizio di arrestarsi al più presto senza portare a termine la raccolta dei dati diagnostici in corso.</span><span class="sxs-lookup"><span data-stu-id="75d37-231">**STOP_ABORT** forces the service to shut down as quickly as possible without finishing collection of diagnostics it is currently collecting.</span></span>  
  
 <span data-ttu-id="75d37-232">Questi argomenti di controllo del servizio devono essere i primi nella riga di comando quando vengono utilizzati.</span><span class="sxs-lookup"><span data-stu-id="75d37-232">When these service control arguments are used, they must be the first argument used on the command line.</span></span> <span data-ttu-id="75d37-233">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="75d37-233">For example:</span></span>  
  
 <span data-ttu-id="75d37-234">**SQLDIAG START**</span><span class="sxs-lookup"><span data-stu-id="75d37-234">**SQLDIAG START**</span></span>  
  
 <span data-ttu-id="75d37-235">L' argomento **/A** , che specifica un'istanza denominata di **SQLdiag**, è l'unico che può essere usato con **START**, **STOP**o **STOP_ABORT** per il controllo di un'istanza specifica del servizio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-235">Only the **/A** argument, which specifies a named instance of **SQLdiag**, can be used with **START**, **STOP**, or **STOP_ABORT** to control a specific instance of the **SQLdiag** service.</span></span> <span data-ttu-id="75d37-236">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="75d37-236">For example:</span></span>  
  
 <span data-ttu-id="75d37-237">**SQLDIAG START /A** _SQLdiag_application_name_</span><span class="sxs-lookup"><span data-stu-id="75d37-237">**SQLDIAG START /A** _SQLdiag_application_name_</span></span>  
  
## <a name="security-requirements"></a><span data-ttu-id="75d37-238">Requisiti di sicurezza</span><span class="sxs-lookup"><span data-stu-id="75d37-238">Security Requirements</span></span>  
 <span data-ttu-id="75d37-239">Se l'utilità **SQLdiag** non viene eseguita in modalità generica specificando l'argomento della riga di comando **/G**, l'utente che esegue **SQLdiag** deve essere membro del gruppo **Administrators** di Windows e membro del ruolo predefinito del server **sysadmin** di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="75d37-239">Unless **SQLdiag** is run in generic mode (by specifying the **/G** command line argument), the user who runs **SQLdiag** must be a member of the Windows **Administrators** group and a member of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sysadmin** fixed server role.</span></span> <span data-ttu-id="75d37-240">Per impostazione predefinita, l'utilità **SQLdiag** esegue la connessione a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] usando l'autenticazione di Windows, ma supporta anche l'autenticazione di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-240">By default, **SQLdiag** connects to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] by using Windows Authentication, but it also supports [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication.</span></span>  
  
## <a name="performance-considerations"></a><span data-ttu-id="75d37-241">Considerazioni sulle prestazioni</span><span class="sxs-lookup"><span data-stu-id="75d37-241">Performance Considerations</span></span>  
 <span data-ttu-id="75d37-242">Le prestazioni relative all'esecuzione dell'utilità **SQLdiag** dipendono dal tipo di dati diagnostici configurati per la raccolta.</span><span class="sxs-lookup"><span data-stu-id="75d37-242">The performance effects of running **SQLdiag** depend on the type of diagnostic data you have configured it to collect.</span></span> <span data-ttu-id="75d37-243">Se ad esempio l'utilità **SQLdiag** è stata configurata per raccogliere informazioni di traccia di [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , maggiore è il numero di classi degli eventi selezionate per la raccolta delle tracce, maggiore sarà l'impatto sulle prestazioni del server.</span><span class="sxs-lookup"><span data-stu-id="75d37-243">For example, if you have configured **SQLdiag** to collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] tracing information, the more event classes you choose to trace, the more your server performance is affected.</span></span>  
  
 <span data-ttu-id="75d37-244">L'impatto sulle prestazioni dell'esecuzione dell'utilità **SQLdiag** è pari circa alla somma dei costi di raccolta dei dati diagnostici configurati separatamente.</span><span class="sxs-lookup"><span data-stu-id="75d37-244">The performance impact of running **SQLdiag** is approximately equivalent to the sum of the costs of collecting the configured diagnostics separately.</span></span> <span data-ttu-id="75d37-245">La raccolta di una traccia con l'utilità **SQLdiag** , ad esempio, è caratterizzata dagli stessi costi a livello di prestazioni della raccolta degli stessi dati con [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="75d37-245">For example, collecting a trace with **SQLdiag** incurs the same performance cost as collecting it with [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="75d37-246">L'impatto dell'uso dell'utilità **SQLdiag** sulle prestazioni è irrilevante.</span><span class="sxs-lookup"><span data-stu-id="75d37-246">The performance impact of using **SQLdiag** is negligible.</span></span>  
  
## <a name="required-disk-space"></a><span data-ttu-id="75d37-247">Spazio su disco richiesto</span><span class="sxs-lookup"><span data-stu-id="75d37-247">Required Disk Space</span></span>  
 <span data-ttu-id="75d37-248">Poiché l'utilità **SQLdiag** può raccogliere tipi diversi di dati diagnostici, lo spazio libero su disco richiesto per l'esecuzione di **SQLdiag** può variare.</span><span class="sxs-lookup"><span data-stu-id="75d37-248">Because **SQLdiag** can collect different types of diagnostic information, the free disk space that is required to run **SQLdiag** varies.</span></span> <span data-ttu-id="75d37-249">La quantità di dati diagnostici raccolti dipende dalla natura e dal volume del carico di lavoro che il server sta elaborando e può variare da pochi megabyte a una quantità rilevante di gigabyte.</span><span class="sxs-lookup"><span data-stu-id="75d37-249">The amount of diagnostic information collected depends on the nature and volume of the workload that the server is processing and may range from a few megabytes to several gigabytes.</span></span>  
  
## <a name="configuration-files"></a><span data-ttu-id="75d37-250">File di configurazione</span><span class="sxs-lookup"><span data-stu-id="75d37-250">Configuration Files</span></span>  
 <span data-ttu-id="75d37-251">All'avvio dell'utilità **SQLdiag** vengono letti il file di configurazione e gli argomenti della riga di comando specificati.</span><span class="sxs-lookup"><span data-stu-id="75d37-251">On startup, **SQLdiag** reads the configuration file and the command line arguments that have been specified.</span></span> <span data-ttu-id="75d37-252">Nel file di configurazione vengono specificati i tipi di dati diagnostici raccolti dall'utilità **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-252">You specify the types of diagnostic information that **SQLdiag** collects in the configuration file.</span></span> <span data-ttu-id="75d37-253">Per impostazione predefinita, l'utilità **SQLdiag** usa il file di configurazione SQLDiag.Xml, disponibile a ogni esecuzione nella cartella di avvio dell'utilità **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-253">By default, **SQLdiag** uses the SQLDiag.Xml configuration file, which is extracted each time the tool runs and is located in the **SQLdiag** utility startup folder.</span></span> <span data-ttu-id="75d37-254">Il file di configurazione usa l'XML Schema SQLDiag_schema.xsd estratto dalla directory di avvio dell'utilità dal file eseguibile ad ogni esecuzione di **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-254">The configuration file uses the XML schema, SQLDiag_schema.xsd, which is also extracted into the utility startup directory from the executable file each time **SQLdiag** runs.</span></span>  
  
### <a name="editing-the-configuration-files"></a><span data-ttu-id="75d37-255">Modifica dei file di configurazione</span><span class="sxs-lookup"><span data-stu-id="75d37-255">Editing the Configuration Files</span></span>  
 <span data-ttu-id="75d37-256">È possibile copiare e modificare il file SQLDiag.Xml per modificare i tipi di dati diagnostici raccolti dall'utilità **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-256">You can copy and edit SQLDiag.Xml to change the types of diagnostic data that **SQLdiag** collects.</span></span> <span data-ttu-id="75d37-257">Durante la modifica del file di configurazione utilizzare sempre un editor XML in grado di convalidare il file in base al relativo XML Schema, ad esempio [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span><span class="sxs-lookup"><span data-stu-id="75d37-257">When editing the configuration file always use an XML editor that can validate the configuration file against its XML schema, such as [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)].</span></span> <span data-ttu-id="75d37-258">Non è consigliabile modificare SQLDiag.Xml direttamente.</span><span class="sxs-lookup"><span data-stu-id="75d37-258">You should not edit SQLDiag.Xml directly.</span></span> <span data-ttu-id="75d37-259">Creare invece una copia del file SQLDiag.Xml e ridenominarlo con un nome file diverso nella stessa cartella.</span><span class="sxs-lookup"><span data-stu-id="75d37-259">Instead, make a copy of SQLDiag.Xml and rename it to a new file name in the same folder.</span></span> <span data-ttu-id="75d37-260">A questo punto, modificare il nuovo file e usare l'argomento **/I** per passarlo all'utilità **SQLdiag**.</span><span class="sxs-lookup"><span data-stu-id="75d37-260">Then edit the new file, and use the **/I** argument to pass it to **SQLdiag**.</span></span>  
  
#### <a name="editing-the-configuration-file-when-sqldiag-runs-as-a-service"></a><span data-ttu-id="75d37-261">Modifica del file di configurazione in caso di esecuzione di SQLdiag come servizio</span><span class="sxs-lookup"><span data-stu-id="75d37-261">Editing the Configuration File When SQLdiag Runs as a Service</span></span>  
 <span data-ttu-id="75d37-262">Se l'utilità **SQLdiag** è già stata eseguita come servizio ed è necessario modificare il file di configurazione, annullare la registrazione del servizio SQLDIAG specificando l'argomento della riga di comando **/U** e quindi rieseguendo la registrazione del servizio usando l'argomento della riga di comando **/R** .</span><span class="sxs-lookup"><span data-stu-id="75d37-262">If you have already run **SQLdiag** as a service and need to edit the configuration file, unregister the SQLDIAG service by specifying the **/U** command line argument and then re-register the service by using the **/R** command line argument.</span></span> <span data-ttu-id="75d37-263">L'annullamento della registrazione e la successiva nuova registrazione comportano la rimozione delle vecchie informazioni di configurazione memorizzate nella cache del Registro di sistema di Windows.</span><span class="sxs-lookup"><span data-stu-id="75d37-263">Unregistering and re-registering the service removes old configuration information that was cached in the Windows registry.</span></span>  
  
## <a name="output-folder"></a><span data-ttu-id="75d37-264">Cartella di output</span><span class="sxs-lookup"><span data-stu-id="75d37-264">Output Folder</span></span>  
 <span data-ttu-id="75d37-265">Se non si specifica una cartella di output con l'argomento **/O** , l'utilità **SQLdiag** crea una sottocartella denominata SQLDIAG nella cartella di avvio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-265">If you do not specify an output folder with the **/O** argument, **SQLdiag** creates a subfolder named SQLDIAG under the **SQLdiag** startup folder.</span></span> <span data-ttu-id="75d37-266">Per la raccolta di dati diagnostici che comportano un elevato numero di tracce, ad esempio [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , verificare che la cartella di output si trovi in un'unità locale dotata di spazio sufficiente per archiviare l'output di dati diagnostici richiesto.</span><span class="sxs-lookup"><span data-stu-id="75d37-266">For diagnostic information collection that involves high volume tracing, such as [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , make sure that the output folder is on a local drive with enough space to store the requested diagnostic output.</span></span>  
  
 <span data-ttu-id="75d37-267">Quando l'utilità **SQLdiag** viene riavviata, i contenuti della cartella di output vengono sovrascritti.</span><span class="sxs-lookup"><span data-stu-id="75d37-267">When **SQLdiag** is restarted, it overwrites the contents of the output folder.</span></span> <span data-ttu-id="75d37-268">Per evitare la sovrascrittura, specificare **/N 2** nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-268">To avoid this, specify **/N 2** on the command line.</span></span>  
  
## <a name="data-collection-process"></a><span data-ttu-id="75d37-269">Processo di raccolta dei dati</span><span class="sxs-lookup"><span data-stu-id="75d37-269">Data Collection Process</span></span>  
 <span data-ttu-id="75d37-270">Quando viene avviata, l'utilità **SQLdiag** esegue i controlli di inizializzazione necessari per raccogliere i dati diagnostici specificati nel file SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="75d37-270">When **SQLdiag** starts, it performs the initialization checks necessary to collect the diagnostic data that have been specified in SQLDiag.Xml.</span></span> <span data-ttu-id="75d37-271">Questo processo potrebbe richiedere alcuni secondi.</span><span class="sxs-lookup"><span data-stu-id="75d37-271">This process may take several seconds.</span></span> <span data-ttu-id="75d37-272">Dopo che l'utilità **SQLdiag** eseguita come applicazione console ha iniziato a raccogliere i dati diagnostici, viene visualizzato un messaggio indicante che la raccolta di **SQLdiag** è iniziata e che è possibile premere CTRL+C per arrestarla.</span><span class="sxs-lookup"><span data-stu-id="75d37-272">After **SQLdiag** has started collecting diagnostic data when it is run as a console application, a message displays informing you that **SQLdiag** collection has started and that you can press CTRL+C to stop it.</span></span> <span data-ttu-id="75d37-273">Se l'utilità **SQLdiag** viene eseguita come servizio, un messaggio simile viene scritto nel registro eventi di Windows.</span><span class="sxs-lookup"><span data-stu-id="75d37-273">When **SQLdiag** is run as a service, a similar message is written to the Windows event log.</span></span>  
  
 <span data-ttu-id="75d37-274">In caso di uso dell'utilità **SQLdiag** per diagnosticare un problema che è possibile riprodurre, attendere la visualizzazione di questo messaggio prima di riprodurre il problema nel server.</span><span class="sxs-lookup"><span data-stu-id="75d37-274">If you are using **SQLdiag** to diagnose a problem that you can reproduce, wait until you receive this message before you reproduce the problem on your server.</span></span>  
  
 <span data-ttu-id="75d37-275">L'utilità**SQLdiag** raccoglie la maggior parte dei dati diagnostici in parallelo.</span><span class="sxs-lookup"><span data-stu-id="75d37-275">**SQLdiag** collects most diagnostic data in parallel.</span></span> <span data-ttu-id="75d37-276">Tutti i dati diagnostici vengono raccolti con la connessione a strumenti, ad esempio l'utilità **sqlcmd** di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] oppure il processore dei comandi di Windows, tranne quando le informazioni vengono raccolte dai registri di prestazioni e dai registri eventi di Windows.</span><span class="sxs-lookup"><span data-stu-id="75d37-276">All diagnostic information is collected by connecting to tools, such as the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] **sqlcmd** utility or the Windows command processor, except when information is collected from Windows performance logs and event logs.</span></span> <span data-ttu-id="75d37-277">L'utilità**SQLdiag** usa un thread di lavoro per computer per monitorare la raccolta di dati diagnostici da questi strumenti, spesso attendendo contemporaneamente il completamento della raccolta da parte di più strumenti.</span><span class="sxs-lookup"><span data-stu-id="75d37-277">**SQLdiag** uses one worker thread per computer to monitor the diagnostic data collection of these other tools, often simultaneously waiting for several tools to complete.</span></span> <span data-ttu-id="75d37-278">Durante il processo di raccolta l'utilità **SQLdiag** instrada l'output di ogni dato diagnostico alla cartella di output.</span><span class="sxs-lookup"><span data-stu-id="75d37-278">During the collection process, **SQLdiag** routes the output from each diagnostic to the output folder.</span></span>  
  
## <a name="stopping-data-collection"></a><span data-ttu-id="75d37-279">Arresto della raccolta di dati</span><span class="sxs-lookup"><span data-stu-id="75d37-279">Stopping Data Collection</span></span>  
 <span data-ttu-id="75d37-280">Dopo l'inizio della raccolta di dati diagnostici, l'utilità **SQLdiag** continua a raccogliere informazioni finché non viene arrestata manualmente oppure in base all'ora di arresto specificata.</span><span class="sxs-lookup"><span data-stu-id="75d37-280">After **SQLdiag** starts collecting diagnostic data, it continues to do so unless you stop it or it is configured to stop at a specified time.</span></span> <span data-ttu-id="75d37-281">Per configurare l'arresto dell'esecuzione dell'utilità **SQLdiag** a un'ora specifica, usare l'argomento **/E** , che consente di specificare l'ora di arresto desiderata, oppure l'argomento **/X** , che imposta l'esecuzione dell'utilità **SQLdiag** in modalità snapshot.</span><span class="sxs-lookup"><span data-stu-id="75d37-281">You can configure **SQLdiag** to stop at a specified time by using the **/E** argument, which allows you to specify a stop time, or by using the **/X** argument, which causes **SQLdiag** to run in snapshot mode.</span></span>  
  
 <span data-ttu-id="75d37-282">Quando viene arrestata, l'utilità **SQLdiag** arresta tutti i processi di diagnostica avviati.</span><span class="sxs-lookup"><span data-stu-id="75d37-282">When **SQLdiag** stops, it stops all diagnostics it has started.</span></span> <span data-ttu-id="75d37-283">Vengono ad esempio arrestati la raccolta delle tracce di [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] , gli script [!INCLUDE[tsql](../includes/tsql-md.md)] in esecuzione e qualsiasi processo secondario generato durante la raccolta dei dati.</span><span class="sxs-lookup"><span data-stu-id="75d37-283">For example, it stops [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] traces it was collecting, it stops executing [!INCLUDE[tsql](../includes/tsql-md.md)] scripts it was running, and it stops any sub processes it has spawned during data collection.</span></span> <span data-ttu-id="75d37-284">Quando la raccolta di dati diagnostici è completata, l'utilità **SQLdiag** viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="75d37-284">After diagnostic data collection has completed, **SQLdiag** exits.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-285">La sospensione del servizio dell'utilità **SQLdiag** non è supportata.</span><span class="sxs-lookup"><span data-stu-id="75d37-285">Pausing the **SQLdiag** service is not supported.</span></span> <span data-ttu-id="75d37-286">Se si prova a sospendere il servizio **SQLdiag** , l'arresto si verifica al termine della raccolta dei dati diagnostici in corso al momento della sospensione.</span><span class="sxs-lookup"><span data-stu-id="75d37-286">If you attempt to pause the **SQLdiag** service, it stops after it finishes collecting the diagnostics that it was collecting when you paused it.</span></span> <span data-ttu-id="75d37-287">Se si riavvia l'utilità **SQLdiag** dopo averla arrestata, l'applicazione viene riavviata e sovrascrive la cartella di output.</span><span class="sxs-lookup"><span data-stu-id="75d37-287">If you restart **SQLdiag** after stopping it, the application restarts and overwrites the output folder.</span></span> <span data-ttu-id="75d37-288">Per evitare la sovrascrittura della cartella di output, specificare **/N 2** nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-288">To avoid overwriting the output folder, specify **/N 2** on the command line.</span></span>  
  
 <span data-ttu-id="75d37-289">**Per arrestare l'esecuzione dell'utilità SQLdiag come applicazione console**</span><span class="sxs-lookup"><span data-stu-id="75d37-289">**To stop SQLdiag when running as a console application**</span></span>  
  
 <span data-ttu-id="75d37-290">Se l'utilità **SQLdiag** è eseguita come applicazione console, premere CTRL+C nella finestra della console in cui l'utilità **SQLdiag** è in esecuzione per arrestarla.</span><span class="sxs-lookup"><span data-stu-id="75d37-290">If you are running **SQLdiag** as a console application, press CTRL+C in the console window where **SQLdiag** is running to stop it.</span></span> <span data-ttu-id="75d37-291">Dopo aver premuto CTRL+C, nella finestra della console viene visualizzato un messaggio indicante che la raccolta di dati da parte di **SQLDiag** sta per essere interrotta, che è necessario attendere che il processo venga interrotto e che questa operazione potrebbe richiedere alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="75d37-291">After you press CTRL+C, a message displays in the console window informing you that **SQLDiag** data collection is ending, and that you should wait until the process shuts down, which may take several minutes.</span></span>  
  
 <span data-ttu-id="75d37-292">Premere Ctrl+C due volte per terminare tutti i processi figlio di raccolta dei dati diagnostici e terminare l'applicazione immediatamente.</span><span class="sxs-lookup"><span data-stu-id="75d37-292">Press Ctrl+C twice to terminate all child diagnostic processes and immediately terminate the application.</span></span>  
  
 <span data-ttu-id="75d37-293">**Per arrestare l'esecuzione dell'utilità SQLdiag come servizio**</span><span class="sxs-lookup"><span data-stu-id="75d37-293">**To stop SQLdiag when running as a service**</span></span>  
  
 <span data-ttu-id="75d37-294">Se si esegue l'utilità **SQLdiag** come servizio, eseguire **SQLDiag STOP** nella cartella di avvio di **SQLdiag** per arrestarlo.</span><span class="sxs-lookup"><span data-stu-id="75d37-294">If you are running **SQLdiag** as a service, run **SQLDiag STOP** in the **SQLdiag** startup folder to stop it.</span></span>  
  
 <span data-ttu-id="75d37-295">Se si eseguono più istanze di **SQLdiag** nello stesso computer, è anche possibile passare il nome dell'istanza di **SQLdiag** nella riga di comando quando si arresta il servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-295">If you are running multiple instances of **SQLdiag** on the same computer, you can also pass the **SQLdiag** instance name to on the command line when you stop the service.</span></span> <span data-ttu-id="75d37-296">Per arrestare un'istanza di **SQLdiag** denominata Instance1, ad esempio, usare la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="75d37-296">For example, to stop a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG STOP /A Instance1  
```  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-297">**/A** è il solo argomento della riga di comando che può essere utilizzato con **START**, **STOP**o **STOP_ABORT**.</span><span class="sxs-lookup"><span data-stu-id="75d37-297">**/A** is the only command-line argument that can be used with **START**, **STOP**, or **STOP_ABORT**.</span></span> <span data-ttu-id="75d37-298">Se è necessario specificare un'istanza denominata di **SQLdiag** con uno dei verbi di controllo del servizio, specificare **/A** dopo il verbo di controllo nella riga di comando, come indicato nell'esempio di sintassi precedente.</span><span class="sxs-lookup"><span data-stu-id="75d37-298">If you need to specify a named instance of **SQLdiag** with one of the service control verbs, specify **/A** after the control verb on the command line as shown in the previous syntax example.</span></span> <span data-ttu-id="75d37-299">I verbi di controllo del servizio devono essere il primo argomento nella riga di comando quando vengono utilizzati.</span><span class="sxs-lookup"><span data-stu-id="75d37-299">When control verbs are used, they must be the first argument on the command line.</span></span>  
  
 <span data-ttu-id="75d37-300">Per arrestare il servizio al più presto, eseguire **SQLDIAG STOP_ABORT** nella cartella di avvio dell'utilità.</span><span class="sxs-lookup"><span data-stu-id="75d37-300">To stop the service as quickly as possible, run **SQLDIAG STOP_ABORT** in the utility startup folder.</span></span> <span data-ttu-id="75d37-301">Questo comando annulla tutte le raccolte di dati diagnostici in corso senza attenderne il completamento.</span><span class="sxs-lookup"><span data-stu-id="75d37-301">This command aborts any diagnostics collecting currently being performed without waiting for them to finish.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-302">Usare **SQLDiag STOP** o **SQLDIAG STOP_ABORT** per arrestare il servizio **SQLdiag** .</span><span class="sxs-lookup"><span data-stu-id="75d37-302">Use **SQLDiag STOP** or **SQLDIAG STOP_ABORT** to stop the **SQLdiag** service.</span></span> <span data-ttu-id="75d37-303">Non usare la console dei servizi Windows per arrestare **SQLdiag** o gli altri servizi di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-303">Do not use the Windows Services Console to stop **SQLdiag** or other [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] services.</span></span>  
  
## <a name="automatically-starting-and-stopping-sqldiag"></a><span data-ttu-id="75d37-304">Avvio e arresto automatici dell'utilità SQLdiag</span><span class="sxs-lookup"><span data-stu-id="75d37-304">Automatically Starting and Stopping SQLdiag</span></span>  
 <span data-ttu-id="75d37-305">Per avviare e arrestare automaticamente la raccolta dei dati di diagnostica a un'ora specificata, utilizzare gli argomenti **/b**_start_time_ e **/e**_stop_time_ , utilizzando la notazione a 24 ore.</span><span class="sxs-lookup"><span data-stu-id="75d37-305">To automatically start and stop diagnostic data collection at a specified time, use the **/B**_start_time_ and **/E**_stop_time_ arguments, using 24-hour notation.</span></span> <span data-ttu-id="75d37-306">Se, ad esempio, si sta cercando di risolvere un problema che si verifica regolarmente alle 02:00:00 circa, è possibile configurare l'utilità **SQLdiag** in modo che inizi automaticamente a raccogliere dati diagnostici alle 01:00 e si arresti automaticamente alle 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="75d37-306">For example, if you are troubleshooting a problem that consistently appears at approximately 02:00:00, you can configure **SQLdiag** to automatically start collecting diagnostic data at 01:00 and automatically stop at 03:00:00.</span></span> <span data-ttu-id="75d37-307">Usare gli argomenti **/B** e **/E** per specificare l'ora di inizio e di fine.</span><span class="sxs-lookup"><span data-stu-id="75d37-307">Use the **/B** and **/E** arguments to specify the start and stop time.</span></span> <span data-ttu-id="75d37-308">Utilizzare il formato 24 ore per specificare la data e l'ora di inizio e fine corrette nel formato AAAAMMGG_HH:MM:SS.</span><span class="sxs-lookup"><span data-stu-id="75d37-308">Use 24-hour notation to specify an exact start and stop date and time with the format YYYYMMDD_HH:MM:SS.</span></span> <span data-ttu-id="75d37-309">Per specificare una data di inizio o fine relativa, anteporre il segno **+** all'ora di inizio e fine omettendo la parte relativa alla data (AAAAMMGG_) come illustrato nell'esempio seguente. In questo modo, l'utilità **SQLdiag** attende un'ora prima di iniziare a raccogliere le informazioni. I dati vengono raccolti per 3 ore prima che l'utilità venga arrestata e chiusa.</span><span class="sxs-lookup"><span data-stu-id="75d37-309">To specify a relative start or stop time, prefix the start and stop time with **+** and omit the date portion (YYYYMMDD_) as shown in the following example, which causes **SQLdiag** to wait 1 hour before it starts collecting information, then it collects information for 3 hours before it stops and exits:</span></span>  
  
```  
sqldiag /B +01:00:00 /E +03:00:00  
```  
  
 <span data-ttu-id="75d37-310">Se si specifica un valore relativo per *start_time* , l'utilità **SQLdiag** viene avviata a un'ora relativa rispetto alla data e all'ora correnti.</span><span class="sxs-lookup"><span data-stu-id="75d37-310">When a relative *start_time* is specified, **SQLdiag** starts at a time that is relative to the current date and time.</span></span> <span data-ttu-id="75d37-311">Se si specifica un valore relativo per *end_time* , l'utilità **SQLdiag** viene interrotta a un'ora relativa rispetto al valore specificato per *start_time*.</span><span class="sxs-lookup"><span data-stu-id="75d37-311">When a relative *end_time* is specified, **SQLdiag** ends at a time that is relative to the specified *start_time*.</span></span> <span data-ttu-id="75d37-312">Se la data o l'ora di inizio e fine specificate sono già trascorse, l'utilità **SQLdiag** modifica forzatamente la data e l'ora di inizio in modo che facciano riferimento a un periodo futuro.</span><span class="sxs-lookup"><span data-stu-id="75d37-312">If the start or end date and time that you have specified is in the past, **SQLdiag** forcibly changes the start date so that the start date and time are in the future.</span></span>  
  
 <span data-ttu-id="75d37-313">Ciò ha implicazioni molto importanti sulle date di inizio e fine selezionate.</span><span class="sxs-lookup"><span data-stu-id="75d37-313">This has important implications on the start and end dates you choose.</span></span> <span data-ttu-id="75d37-314">Prendere in considerazione gli esempi seguenti:</span><span class="sxs-lookup"><span data-stu-id="75d37-314">Consider the following example:</span></span>  
  
```  
sqldiag /B +01:00:00 /E 08:30:00  
```  
  
 <span data-ttu-id="75d37-315">Se l'ora corrente è 08:00, l'ora di fine è già trascorsa prima dell'inizio della raccolta di dati diagnostici.</span><span class="sxs-lookup"><span data-stu-id="75d37-315">If the current time is 08:00, the end time passes before diagnostic collection actually begins.</span></span> <span data-ttu-id="75d37-316">Poiché l'utilità **SQLDiag** modifica automaticamente le date di inizio e fine riferendole al giorno successivo qualora siano già trascorse, in questo esempio la raccolta di dati diagnostici inizia alle 09:00 della data corrente (è stata specificata un'ora di inizio relativa con il prefisso **+** ) e continua fino alle 08:30 del giorno successivo.</span><span class="sxs-lookup"><span data-stu-id="75d37-316">Because **SQLDiag** automatically adjusts start and end dates to the next day when they occur in the past, in this example diagnostic collection starts at 09:00 today (a relative start time has been specified with **+**) and continues collecting until 08:30 the following morning.</span></span>  
  
### <a name="stopping-and-restarting-sqldiag-to-collect-daily-diagnostics"></a><span data-ttu-id="75d37-317">Arresto e riavvio di SQLdiag per la raccolta giornaliera di dati diagnostici</span><span class="sxs-lookup"><span data-stu-id="75d37-317">Stopping and Restarting SQLdiag to Collect Daily Diagnostics</span></span>  
 <span data-ttu-id="75d37-318">Per raccogliere un set specifico di dati diagnostici su base giornaliera senza dover avviare e arrestare manualmente l'utilità **SQLdiag**, usare l'argomento **/L** .</span><span class="sxs-lookup"><span data-stu-id="75d37-318">To collect a specified set of diagnostics on a daily basis without having to manually start and stop **SQLdiag**, use the **/L** argument.</span></span> <span data-ttu-id="75d37-319">L'argomento **/L** consente di impostare l'esecuzione continua dell'utilità **SQLdiag** grazie all'impostazione del riavvio automatico dell'utilità dopo un'interruzione pianificata.</span><span class="sxs-lookup"><span data-stu-id="75d37-319">The **/L** argument causes **SQLdiag** to run continuously by automatically restarting itself after a scheduled shutdown.</span></span> <span data-ttu-id="75d37-320">Se si specifica l'argomento **/L** e l'utilità **SQLdiag** viene arrestata perché ha raggiunto l'ora di fine specificata dall'argomento **/E** oppure perché viene eseguita in modalità snapshot specificata con l'argomento **/X** , l'utilità **SQLdiag** non viene chiusa, bensì riavviata.</span><span class="sxs-lookup"><span data-stu-id="75d37-320">When **/L** is specified, and **SQLdiag** stops because it has reached the end time specified with the **/E** argument, or it stops because it is being run in snapshot mode by using the **/X** argument, **SQLdiag** restarts instead of exiting.</span></span>  
  
 <span data-ttu-id="75d37-321">Nell'esempio seguente l'utilità **SQLdiag** eseguita in modalità continua viene automaticamente riavviata dopo che la raccolta di dati diagnostici è stata eseguita dalle 03:00:00 alle 05:00:00.</span><span class="sxs-lookup"><span data-stu-id="75d37-321">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after diagnostic data collecting occurs between 03:00:00 and 05:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /E 05:00:00 /L  
```  
  
 <span data-ttu-id="75d37-322">Nell'esempio seguente l'utilità **SQLdiag** eseguita in modalità continua viene riavviata automaticamente dopo l'esecuzione di uno snapshot dei dati diagnostici alle 03:00:00.</span><span class="sxs-lookup"><span data-stu-id="75d37-322">The following example specifies that **SQLdiag** run in continuous mode to automatically restart after taking a diagnostic data snapshot at 03:00:00.</span></span>  
  
```  
sqldiag /B 03:00:00 /X /L  
```  
  
## <a name="running-sqldiag-as-a-service"></a><span data-ttu-id="75d37-323">Esecuzione dell'utilità SQLdiag come servizio</span><span class="sxs-lookup"><span data-stu-id="75d37-323">Running SQLdiag as a Service</span></span>  
 <span data-ttu-id="75d37-324">Se si vuole usare l'utilità **SQLdiag** per raccogliere dati diagnostici per lunghi periodi di tempo durante i quali potrebbe essere necessario disconnettersi dal computer sul quale l'utilità **SQLdiag** è in esecuzione, è possibile eseguire l'utilità come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-324">When you want to use **SQLdiag** to collect diagnostic data for long periods of time during which you might need to log out of the computer on which **SQLdiag** is running, you can run it as a service.</span></span>  
  
 <span data-ttu-id="75d37-325">**Per registrare l'utilità SQLDiag in modo che venga eseguita come servizio**</span><span class="sxs-lookup"><span data-stu-id="75d37-325">**To register SQLDiag to run as a service**</span></span>  
  
 <span data-ttu-id="75d37-326">È possibile registrare l'utilità **SQLdiag** in modo che venga eseguita come servizio specificando l'argomento **/R** nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-326">You can register **SQLdiag** to run as a service by specifying the **/R** argument at the command line.</span></span> <span data-ttu-id="75d37-327">L'utilità **SQLdiag** viene registrata in modo che venga eseguita come servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-327">This registers **SQLdiag** to run as a service.</span></span> <span data-ttu-id="75d37-328">Il nome del servizio dell'utilità **SQLdiag** è SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="75d37-328">The **SQLdiag** service name is SQLDIAG.</span></span> <span data-ttu-id="75d37-329">Qualsiasi altro argomento specificato nella riga di comando durante la registrazione dell'utilità **SQLDiag** come servizio viene memorizzato e riutilizzato quando il servizio viene avviato.</span><span class="sxs-lookup"><span data-stu-id="75d37-329">Any other arguments you specify on the command line when you register **SQLDiag** as a service are preserved and reused when the service is started.</span></span>  
  
 <span data-ttu-id="75d37-330">Per modificare il nome del servizio SQLDIAG predefinito, usare l'argomento della riga di comando **/A** per specificare un altro nome.</span><span class="sxs-lookup"><span data-stu-id="75d37-330">To change the default SQLDIAG service name, use the **/A** command-line argument to specify another name.</span></span> <span data-ttu-id="75d37-331">**SQLdiag** aggiunge automaticamente il prefisso DIAG$ a qualsiasi nome dell'istanza di **SQLdiag** specificato con **/A** per creare nomi di servizio appropriati.</span><span class="sxs-lookup"><span data-stu-id="75d37-331">**SQLdiag** automatically prefixes DIAG$ to any **SQLdiag** instance name specified with **/A** to create sensible service names.</span></span>  
  
 <span data-ttu-id="75d37-332">**Per annullare la registrazione del servizio SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="75d37-332">**To unregister the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="75d37-333">Per annullare la registrazione del servizio, specificare l'argomento **/U** .</span><span class="sxs-lookup"><span data-stu-id="75d37-333">To unregister the service, specify the **/U** argument.</span></span> <span data-ttu-id="75d37-334">L'annullamento della registrazione dell'utilità **SQLdiag** come servizio comporta l'eliminazione anche delle chiavi del Registro di sistema di Windows.</span><span class="sxs-lookup"><span data-stu-id="75d37-334">Unregistering **SQLdiag** as a service also deletes the Windows registry keys of the service.</span></span>  
  
 <span data-ttu-id="75d37-335">**Per avviare o riavviare il servizio SQLDIAG**</span><span class="sxs-lookup"><span data-stu-id="75d37-335">**To start or restart the SQLDIAG service**</span></span>  
  
 <span data-ttu-id="75d37-336">Per avviare o riavviare il servizio SQLDIAG, eseguire **SQLDiag START** dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-336">To start or restart the SQLDIAG service, run **SQLDiag START** from the command line.</span></span>  
  
 <span data-ttu-id="75d37-337">Se si eseguono più istanze di **SQLdiag** usando l'argomento **/A** , è anche possibile passare il nome dell'istanza di **SQLdiag** nella riga di comando quando si avvia il servizio.</span><span class="sxs-lookup"><span data-stu-id="75d37-337">If you are running multiple instances of **SQLdiag** by using the **/A** argument, you can also pass the **SQLdiag** instance name on the command line when you start the service.</span></span> <span data-ttu-id="75d37-338">Per avviare un'istanza di **SQLdiag** denominata Instance1, ad esempio, usare la sintassi seguente:</span><span class="sxs-lookup"><span data-stu-id="75d37-338">For example, to start a **SQLdiag** instance named Instance1, use the following syntax:</span></span>  
  
```  
SQLDIAG START /A Instance1  
```  
  
 <span data-ttu-id="75d37-339">È inoltre possibile utilizzare il comando **net start** per avviare il servizio SQLDIAG.</span><span class="sxs-lookup"><span data-stu-id="75d37-339">You can also use the **net start** command to start the SQLDIAG service.</span></span>  
  
 <span data-ttu-id="75d37-340">Quando **SQLdiag**viene riavviato, i contenuti della cartella di output vengono sovrascritti.</span><span class="sxs-lookup"><span data-stu-id="75d37-340">When you restart **SQLdiag**, it overwrites the contents in the current output folder.</span></span> <span data-ttu-id="75d37-341">Per evitare la sovrascrittura, specificare **/N 2** nella riga di comando per rinominare la cartella di output all'avvio dell'utilità.</span><span class="sxs-lookup"><span data-stu-id="75d37-341">To avoid this, specify **/N 2** on the command line to rename the output folder when the utility starts.</span></span>  
  
 <span data-ttu-id="75d37-342">La sospensione del servizio dell'utilità **SQLdiag** non è supportata.</span><span class="sxs-lookup"><span data-stu-id="75d37-342">Pausing the **SQLdiag** service is not supported.</span></span>  
  
## <a name="running-multiple-instances-of-sqldiag"></a><span data-ttu-id="75d37-343">Esecuzione di più istanze di SQLdiag</span><span class="sxs-lookup"><span data-stu-id="75d37-343">Running Multiple Instances of SQLdiag</span></span>  
 <span data-ttu-id="75d37-344">Eseguire più istanze di **SQLdiag** nello stesso computer specificando **/a**_SQLdiag_application_name_ nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-344">Run multiple instances of **SQLdiag** on the same computer by specifying **/A**_SQLdiag_application_name_ on the command line.</span></span> <span data-ttu-id="75d37-345">Ciò consente di raccogliere diversi set di dati diagnostici contemporaneamente dalla stessa istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-345">This is useful for collecting different sets of diagnostics simultaneously from the same [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="75d37-346">È ad esempio possibile configurare un'istanza denominata di **SQLdiag** per eseguire in modo continuo una raccolta di dati lightweight.</span><span class="sxs-lookup"><span data-stu-id="75d37-346">For example, you can configure a named instance of **SQLdiag** to continuously perform lightweight data collection.</span></span> <span data-ttu-id="75d37-347">Se quindi si verifica un problema specifico relativo a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], è possibile eseguire l'istanza di **SQLdiag** predefinita per raccogliere i dati diagnostici relativi a quel problema o per la raccolta di un set di dati diagnostici su richiesta del Servizio Supporto Tecnico Clienti [!INCLUDE[msCoName](../includes/msconame-md.md)] per elaborare una diagnosi relativa al problema.</span><span class="sxs-lookup"><span data-stu-id="75d37-347">Then, if a specific problem occurs on [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], you can run the default **SQLdiag** instance to collect diagnostics for that problem, or to gather a set of diagnostics that [!INCLUDE[msCoName](../includes/msconame-md.md)] Customer Support Services has asked you to gather to diagnose a problem.</span></span>  
  
## <a name="collecting-diagnostic-data-from-clustered-sql-server-instances"></a><span data-ttu-id="75d37-348">Raccolta dei dati diagnostici dalle istanze di SQL Server del cluster</span><span class="sxs-lookup"><span data-stu-id="75d37-348">Collecting Diagnostic Data from Clustered SQL Server Instances</span></span>  
 <span data-ttu-id="75d37-349">L'utilità**SQLdiag** supporta la raccolta di dati diagnostici dalle istanze cluster di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-349">**SQLdiag** supports collecting diagnostic data from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances.</span></span> <span data-ttu-id="75d37-350">Per raccogliere dati diagnostici dalle istanze cluster di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], verificare di aver specificato **"."** per l'attributo **name** dell'elemento **\<Machine>** nel file di configurazione SQLDiag.Xml e di non aver specificato l'argomento **/G** nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="75d37-350">To gather diagnostics from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, make sure that **"."** is specified for the **name** attribute of the **\<Machine>** element in the configuration file SQLDiag.Xml and do not specify the **/G** argument on the command line.</span></span> <span data-ttu-id="75d37-351">Per impostazione predefinita, viene specificato **"."** per l'attributo **name** nel file di configurazione e l'argomento **/G** è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="75d37-351">By default, **"."** is specified for the **name** attribute in the configuration file and the **/G** argument is turned off.</span></span> <span data-ttu-id="75d37-352">Non è in genere necessario modificare il file di configurazione o gli argomenti della riga di comando durante la raccolta di dati da un'istanza cluster di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="75d37-352">Typically, you do not need to edit the configuration file or change the command line arguments when collecting from a clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="75d37-353">Se si specifica **"."** come nome del computer, l'utilità **SQLdiag** rileva che è in esecuzione in un cluster e contemporaneamente recupera i dati diagnostici da tutte le istanze virtuali di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] installate nel cluster.</span><span class="sxs-lookup"><span data-stu-id="75d37-353">When **"."** is specified as the machine name, **SQLdiag** detects that it is running on a cluster, and simultaneously retrieves diagnostic information from all virtual instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that are installed on the cluster.</span></span> <span data-ttu-id="75d37-354">Se si desidera raccogliere dati diagnostici da una sola istanza virtuale di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] in un computer, specificare l'istanza virtuale di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] per l'attributo **name** dell'elemento **\<Machine>** nel file SQLDiag.Xml.</span><span class="sxs-lookup"><span data-stu-id="75d37-354">If you want to collect diagnostic information from only one virtual instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that is running on a computer, specify that virtual [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] for the **name** attribute of the **\<Machine>** element in SQLDiag.Xml.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="75d37-355">Per raccogliere le informazioni di traccia di [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] dalle istanze cluster di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , è necessario abilitare le condivisioni amministrative (ADMIN$) nel cluster.</span><span class="sxs-lookup"><span data-stu-id="75d37-355">To collect [!INCLUDE[ssSqlProfiler](../includes/sssqlprofiler-md.md)] trace information from clustered [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instances, administrative shares (ADMIN$) must be enabled on the cluster.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="75d37-356">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="75d37-356">See Also</span></span>  
 [<span data-ttu-id="75d37-357">Guida di riferimento alle utilità del prompt dei comandi &#40;motore di database&#41;</span><span class="sxs-lookup"><span data-stu-id="75d37-357">Command Prompt Utility Reference &#40;Database Engine&#41;</span></span>](command-prompt-utility-reference-database-engine.md)  
  
  
