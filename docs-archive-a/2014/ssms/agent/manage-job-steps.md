---
title: Gestire passaggi di processo | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87630244"
---
# <a name="manage-job-steps"></a><span data-ttu-id="e8cfa-102">Gestire passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-102">Manage Job Steps</span></span>
  <span data-ttu-id="e8cfa-103">Un passaggio di processo è un'operazione eseguita dal processo in un database o in un server.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="e8cfa-104">Ogni processo deve essere composto da almeno un passaggio.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-104">Every job must have at least one job step.</span></span> <span data-ttu-id="e8cfa-105">I passaggi di processo possono essere costituiti dagli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="e8cfa-106">Programmi eseguibili e comandi del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="e8cfa-107">istruzioni, incluse stored procedure e stored procedure estese.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="e8cfa-108">Script di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="e8cfa-109">Script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="e8cfa-110">Attività di replica.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="e8cfa-111">attività.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="e8cfa-112">pacchetti.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-112">packages.</span></span>  
  
 <span data-ttu-id="e8cfa-113">Ogni passaggio di processo viene eseguito in un contesto di sicurezza specifico.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="e8cfa-114">Se tramite il passaggio di processo viene specificato un proxy, il passaggio viene eseguito nel contesto di sicurezza della credenziale per il proxy.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="e8cfa-115">Se tramite il passaggio di processo non viene specificato un proxy, il passaggio viene eseguito nel contesto dell'account del servizio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="e8cfa-116">Solo i membri del ruolo predefinito del server sysadmin possono creare processi in cui non venga specificato esplicitamente un proxy.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="e8cfa-117">Poiché i passaggi di processo vengono eseguiti nel contesto di un utente specifico di [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows, l'utente deve essere in possesso delle autorizzazioni e della configurazione necessarie per l'esecuzione del passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="e8cfa-118">Se, ad esempio, si crea un processo che richiede una lettera di unità o un percorso UNC (Universal Naming Convention), i passaggi di processo possono essere eseguiti con l'account utente di Windows durante la verifica delle operazioni.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="e8cfa-119">L'utente di Windows per il passaggio di processo, tuttavia, deve inoltre disporre delle autorizzazioni richieste, delle configurazioni della lettera di unità o dell'accesso all'unità necessaria.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="e8cfa-120">In caso contrario, il passaggio di processo non verrà eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="e8cfa-121">Per evitare questo problema, assicurarsi che il proxy per ogni passaggio di processo disponga delle autorizzazioni necessarie per l'operazione eseguita dal passaggio.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="e8cfa-122">Per altre informazioni, vedere [Centro sicurezza per SQL Server motore di database e il database SQL di Azure](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="e8cfa-123">Log dei passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e8cfa-124">Agent può scrivere output da alcuni passaggi di processo in un file del sistema operativo o nella tabella sysjobstepslogs del database msdb.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="e8cfa-125">I tipi di passaggi di processo seguenti consentono la scrittura dell'output in entrambe le destinazioni:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="e8cfa-126">Programmi eseguibili e comandi del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-126">Executable programs and operating system commands.</span></span>  
  
-   <span data-ttu-id="e8cfa-127">Istruzioni[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e8cfa-127">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="e8cfa-128">attività.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-128">tasks.</span></span>  
  
 <span data-ttu-id="e8cfa-129">Solo i passaggi di processo eseguiti dagli utenti membri del ruolo predefinito del server sysadmin possono scrivere l'output dei passaggi di processo nei file del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="e8cfa-130">Se i passaggi di processo vengono eseguiti da utenti membri dei ruoli del database predefiniti SQLAgentUserRole, SQLAgentReaderRole o SQLAgentOperatorRole nel database msdb, l'output di questi passaggi di processo può essere scritto solo nella tabella sysjobstepslogs.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="e8cfa-131">I log dei passaggi di processo vengono eliminati automaticamente quando vengono eliminati i processi o i passaggi di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8cfa-132">La registrazione delle attività di replica e dei passaggi di processo dei pacchetti [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] viene gestita dal rispettivo sottosistema.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="e8cfa-133">Non è possibile utilizzare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent per configurare la registrazione di questi tipi di passaggi di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="e8cfa-134">Utilizzo di programmi eseguibili e comandi del sistema operativo come passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="e8cfa-135">I programmi eseguibili e i comandi del sistema operativo possono essere utilizzati come passaggi di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="e8cfa-136">Questi file possono avere estensione bat, cmd, com o exe.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="e8cfa-137">Quando si utilizza un programma eseguibile o un comando del sistema operativo come passaggio di processo, è necessario specificare gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="e8cfa-138">Il codice di uscita del processo, restituito se il comando ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="e8cfa-139">Comando da eseguire.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-139">The command to execute.</span></span> <span data-ttu-id="e8cfa-140">Per eseguire un comando del sistema operativo, è necessario immettere solo il comando specifico.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="e8cfa-141">Per un programma esterno, è necessario immettere il nome del programma e gli argomenti del programma, ad esempio: **C:\Programmi\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span><span class="sxs-lookup"><span data-stu-id="e8cfa-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e8cfa-142">È necessario indicare il percorso completo del programma eseguibile se questo non è incluso in una directory specificata nel percorso di sistema o nel percorso per l'account utente con cui viene eseguito il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="e8cfa-143">Passaggi di processo Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e8cfa-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="e8cfa-144">Quando si crea un passaggio di processo [!INCLUDE[tsql](../../includes/tsql-md.md)] , è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="e8cfa-145">Identificare il database in cui eseguire il processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="e8cfa-146">Digitare l'istruzione [!INCLUDE[tsql](../../includes/tsql-md.md)] da eseguire.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="e8cfa-147">L'istruzione può chiamare una stored procedure o una stored procedure estesa.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="e8cfa-148">In alternativa, è possibile aprire un file [!INCLUDE[tsql](../../includes/tsql-md.md)] esistente come comando per il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="e8cfa-149">I passaggi di processo non usano proxy di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="e8cfa-150">Il passaggio di processo viene invece eseguito come proprietario del passaggio oppure come account del servizio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent se il proprietario è un membro del ruolo predefinito del server sysadmin.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="e8cfa-151">I membri del ruolo predefinito del server sysadmin possono anche specificare che i passaggi di processo [!INCLUDE[tsql](../../includes/tsql-md.md)] vengano eseguiti nel contesto di un altro utente tramite il parametro *database_user_name* della stored procedure sp_add_jobstep.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="e8cfa-152">Per ulteriori informazioni, vedere [sp_add_jobstep &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e8cfa-153">Un singolo passaggio di processo [!INCLUDE[tsql](../../includes/tsql-md.md)] può contenere più batch.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="e8cfa-154">I passaggi di processo possono contenere comandi GO incorporati.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="e8cfa-155">Utilizzo di script di PowerShell come passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="e8cfa-156">Quando si utilizza uno script di PowerShell per creare un passaggio di processo, come comando del passaggio è necessario specificare uno dei due elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="e8cfa-157">Il testo di uno script di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="e8cfa-158">Un file script di PowerShell esistente da aprire.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="e8cfa-159">Il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sottosistema PowerShell di Agent apre una sessione di PowerShell e carica gli [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-in di PowerShell. Lo script di PowerShell usato come comando per il passaggio di processo può fare riferimento al [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider e ai cmdlet di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="e8cfa-160">Per altre informazioni sulla scrittura di script di PowerShell tramite gli snap-in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell, vedere [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="e8cfa-161">Utilizzo di Script ActiveX come passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e8cfa-162">Il passaggio di processo con script ActiveX verrà rimosso da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in una versione futura di [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8cfa-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e8cfa-163">Evitare di usare questa funzionalità in un nuovo progetto di sviluppo e prevedere interventi di modifica nelle applicazioni in cui è attualmente implementata.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="e8cfa-164">Quando si crea un passaggio di processo con script ActiveX, è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="e8cfa-165">Identificare il linguaggio di script con cui scrivere il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="e8cfa-166">Scrivere lo script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="e8cfa-167">È inoltre possibile aprire un file di script ActiveX esistente come comando per il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="e8cfa-168">In alternativa, i comandi degli script ActiveX possono essere compilati esternamente, ad esempio tramite Microsoft Visual Basic, e quindi eseguiti come file eseguibili.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="e8cfa-169">Quando un comando di un passaggio di processo è uno script ActiveX, è possibile utilizzare l'oggetto SQLActiveScriptHost per stampare l'output nella cronologia dei passaggi di processo o per creare oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="e8cfa-170">SQLActiveScriptHost è un oggetto globale introdotto dal sistema di hosting di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent nello spazio dei nomi dello script.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="e8cfa-171">L'oggetto dispone di due metodi (Stampa e CreateObject).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="e8cfa-172">Nell'esempio seguente viene illustrato il funzionamento degli script ActiveX in Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="e8cfa-173">Passaggi dei processi di replica</span><span class="sxs-lookup"><span data-stu-id="e8cfa-173">Replication Job Steps</span></span>  
 <span data-ttu-id="e8cfa-174">Quando si creano pubblicazioni e sottoscrizioni tramite la replica, i processi di replica vengono creati per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="e8cfa-175">Il tipo di processo creato è determinato dal tipo di replica (snapshot, transazionale o di tipo merge) e dalle opzioni utilizzate.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="e8cfa-176">I passaggi dei processi di replica attivano uno degli agenti di replica seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="e8cfa-177">Agente snapshot (processo Snapshot)</span><span class="sxs-lookup"><span data-stu-id="e8cfa-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="e8cfa-178">Agente lettura log (processo LogReader)</span><span class="sxs-lookup"><span data-stu-id="e8cfa-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="e8cfa-179">Agente di distribuzione (processo Distribuzione)</span><span class="sxs-lookup"><span data-stu-id="e8cfa-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="e8cfa-180">Agente di merge (processo Merge)</span><span class="sxs-lookup"><span data-stu-id="e8cfa-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="e8cfa-181">Agente di lettura coda (processo QueueReader)</span><span class="sxs-lookup"><span data-stu-id="e8cfa-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="e8cfa-182">Durante la configurazione della replica, è possibile specificare di eseguire gli agenti di replica in tre modi diversi: in modo continuativo dopo l'avvio di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, su richiesta o in base a una pianificazione.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="e8cfa-183">Per altre informazioni sugli agenti di replica, vedere [Panoramica degli agenti di replica](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="e8cfa-184">Passaggi di processo Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e8cfa-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e8cfa-185">Agent supporta due tipi diversi di passaggi di processo Analysis Services, ovvero i passaggi di processo con comandi e i passaggi di processo con query.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="e8cfa-186">Passaggi di processo con comandi di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e8cfa-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="e8cfa-187">Quando si crea un passaggio di processo con un comando di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="e8cfa-188">Identificare il server OLAP di database in cui eseguire il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="e8cfa-189">Digitare l'istruzione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-189">Type the statement to execute.</span></span> <span data-ttu-id="e8cfa-190">È necessario che l'istruzione sia un file XML per il metodo  **Execute** di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8cfa-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="e8cfa-191">L'istruzione non può includere una busta SOAP completa o un file XML per il metodo  **Discover** di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8cfa-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="e8cfa-192">A differenza di [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] , i passaggi di processo di **Agent non supportano le buste SOAP complete e il metodo** Discover [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e8cfa-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="e8cfa-193">Passaggi di processo con query Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e8cfa-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="e8cfa-194">Quando si crea un passaggio di processo con una query di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="e8cfa-195">Identificare il server OLAP di database in cui eseguire il passaggio di processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="e8cfa-196">Digitare l'istruzione da eseguire.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-196">Type the statement to execute.</span></span> <span data-ttu-id="e8cfa-197">L'istruzione deve essere una query MDX.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="e8cfa-198">Per ulteriori informazioni su MDX, vedere [nozioni fondamentali sulle query mdx &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="e8cfa-199">Pacchetti Integration Services</span><span class="sxs-lookup"><span data-stu-id="e8cfa-199">Integration Services Packages</span></span>  
 <span data-ttu-id="e8cfa-200">Quando si crea un passaggio di processo con un pacchetto di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , è necessario eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e8cfa-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="e8cfa-201">Identificare l'origine del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="e8cfa-202">Identificare la posizione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="e8cfa-203">Se per il pacchetto sono necessari file di configurazione, identificare i file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="e8cfa-204">Se per il pacchetto sono necessari file di comando, identificare i file di comando.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="e8cfa-205">Identificare la verifica da utilizzare per il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="e8cfa-206">È possibile, ad esempio, specificare che il pacchetto deve essere firmato o deve disporre di un ID pacchetto specifico.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="e8cfa-207">Identificare le origini dei dati per il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="e8cfa-208">Identificare i provider di log per il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="e8cfa-209">Specificare le variabili e i valori da impostare prima di eseguire il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="e8cfa-210">Identificare le opzioni di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="e8cfa-211">Aggiungere o modificare le opzioni della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="e8cfa-212">Se il pacchetto è stato distribuito al catalogo SSIS e si specifica **Catalogo SSIS** come origine del pacchetto, molte di queste informazioni di configurazione vengono ottenute automaticamente dal pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="e8cfa-213">Nella scheda **Configurazione** è possibile specificare l'ambiente, i valori dei parametri, i valori della gestione connessione, gli override delle proprietà e se il pacchetto è in esecuzione in un ambiente di runtime a 32 bit.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="e8cfa-214">Per altre informazioni sulla creazione di passaggi di processo eseguiti come pacchetti [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , vedere [Processi di SQL Server Agent per i pacchetti](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="e8cfa-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="e8cfa-215">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="e8cfa-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="e8cfa-216">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="e8cfa-216">**Description**</span></span>|<span data-ttu-id="e8cfa-217">**Argomento**</span><span class="sxs-lookup"><span data-stu-id="e8cfa-217">**Topic**</span></span>|  
|<span data-ttu-id="e8cfa-218">Viene descritto come creare un passaggio di processo con un programma eseguibile.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="e8cfa-219">Creare un passaggio di processo CmdExec</span><span class="sxs-lookup"><span data-stu-id="e8cfa-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="e8cfa-220">Viene descritto come reimpostare le autorizzazioni di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="e8cfa-221">Configure a User to Create and Manage SQL Server Agent Jobs</span><span class="sxs-lookup"><span data-stu-id="e8cfa-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="e8cfa-222">Viene descritto come creare un passaggio di processo di [!INCLUDE[tsql](../../includes/tsql-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="e8cfa-223">Create a Transact-SQL Job Step</span><span class="sxs-lookup"><span data-stu-id="e8cfa-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="e8cfa-224">Viene descritto come definire le opzioni per i passaggi di processo Transact-SQL di Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="e8cfa-225">Definire le opzioni del passaggio di processo Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e8cfa-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="e8cfa-226">Viene descritto come creare un passaggio di processo dello script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="e8cfa-227">Create an ActiveX Script Job Step</span><span class="sxs-lookup"><span data-stu-id="e8cfa-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="e8cfa-228">Viene descritto come creare e definire passaggi di processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent tramite cui vengono eseguiti comandi e query di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="e8cfa-229">Create an Analysis Services Job Step</span><span class="sxs-lookup"><span data-stu-id="e8cfa-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="e8cfa-230">Viene descritta quale azione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] occorre eseguire se si verifica un errore durante l'esecuzione del processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="e8cfa-231">Impostare il flusso di interventi in caso di esito positivo o negativo del passaggio di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="e8cfa-232">Viene descritto come visualizzare informazioni dettagliate sui passaggi di processo nella finestra di dialogo Proprietà passaggio processo.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="e8cfa-233">Visualizzare informazioni sui passaggi di processo</span><span class="sxs-lookup"><span data-stu-id="e8cfa-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="e8cfa-234">Viene descritto come eliminare un log dei passaggi di processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="e8cfa-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="e8cfa-235">Delete a Job Step Log</span><span class="sxs-lookup"><span data-stu-id="e8cfa-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="e8cfa-236">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e8cfa-236">See Also</span></span>  
 <span data-ttu-id="e8cfa-237">[dbo.sysjobstepslogs &#40;&#41;Transact-SQL](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e8cfa-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="e8cfa-238">[Creazione di processi](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="e8cfa-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="e8cfa-239">sp_add_job &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e8cfa-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  
