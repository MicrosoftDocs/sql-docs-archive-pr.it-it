---
title: Definire una variabile di stato | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 45d66152-883a-49a7-a877-2e8ab45f8f79
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5214b3512ea0113d1abace61a76033e5531ac99f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87726140"
---
# <a name="define-a-state-variable"></a><span data-ttu-id="28d70-102">Definire una variabile di stato</span><span class="sxs-lookup"><span data-stu-id="28d70-102">Define a State Variable</span></span>
  <span data-ttu-id="28d70-103">In questa procedura viene descritto come definire una variabile del pacchetto in cui è archiviato lo stato CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-103">This procedure describes how to define a package variable where the CDC state is stored.</span></span>  
  
 <span data-ttu-id="28d70-104">La variabile di stato CDC viene caricata, inizializzata e aggiornata tramite l'attività di controllo CDC e viene utilizzata dal componente flusso di dati dell'origine CDC per determinare l'intervallo di elaborazione corrente per i record delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="28d70-104">The CDC state variable is loaded, initialized, and updated by the CDC Control task and is used by the CDC Source data flow component to determine the current processing range for change records.</span></span> <span data-ttu-id="28d70-105">È possibile definire la variabile di stato CDC in qualsiasi contenitore comune all'attività di controllo CDC e all'origine CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-105">The CDC state variable can be defined on any container common to the CDC Control task and the CDC source.</span></span> <span data-ttu-id="28d70-106">Ciò può avvenire a livello di pacchetto, ma anche in altri contenitori, ad esempio un contenitore Ciclo.</span><span class="sxs-lookup"><span data-stu-id="28d70-106">This may be at the package level but may also be on other containers such as a loop container.</span></span>  
  
 <span data-ttu-id="28d70-107">Non è consigliabile modificare manualmente il valore della variabile di stato CDC, tuttavia questa operazione può risultare utile per comprenderne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="28d70-107">Manually modifying the CDC state variable value is not recommended, however it can be useful to understand its contents.</span></span>  
  
 <span data-ttu-id="28d70-108">Nella tabella seguente viene fornita una descrizione di alto livello dei componenti del valore della variabile di stato CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-108">The following table provides a high-level description of the components of the CDC state variable value.</span></span>  
  
|<span data-ttu-id="28d70-109">Componente</span><span class="sxs-lookup"><span data-stu-id="28d70-109">Component</span></span>|<span data-ttu-id="28d70-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="28d70-110">Description</span></span>|  
|---------------|-----------------|  
|`<state-name>`|<span data-ttu-id="28d70-111">Si tratta del nome dello stato CDC corrente.</span><span class="sxs-lookup"><span data-stu-id="28d70-111">This is the name of the current CDC state.</span></span>|  
|`CS`|<span data-ttu-id="28d70-112">Viene contrassegnato il punto di inizio dell'intervallo di elaborazione corrente (inizio corrente).</span><span class="sxs-lookup"><span data-stu-id="28d70-112">This marks the current processing range start point (Current Start).</span></span>|  
|`<cs-lsn>`|<span data-ttu-id="28d70-113">Si tratta dell'ultimo numero di sequenza del file di log (LSN) elaborato nell'esecuzione CDC precedente.</span><span class="sxs-lookup"><span data-stu-id="28d70-113">This is the last (Log Sequence Number) LSN processed in the previous CDC run.</span></span>|  
|`CE`|<span data-ttu-id="28d70-114">Viene contrassegnato il punto di fine dell'intervallo di elaborazione corrente (fine corrente).</span><span class="sxs-lookup"><span data-stu-id="28d70-114">This marks the current processing range end point (Current End).</span></span> <span data-ttu-id="28d70-115">La presenza del componente CE nello stato CDC indica che un pacchetto CDC è attualmente in fase di elaborazione o che si è verificato un errore di esecuzione di un pacchetto CDC prima del completamento dell'elaborazione dell'intervallo di elaborazione CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-115">The presence of the CE component in the CDC state is an indication that either a CDC package is currently processing or that a CDC package failed before fully processing its CDC processing range.</span></span>|  
|`<ce-lsn>`|<span data-ttu-id="28d70-116">Si tratta dell'ultimo LSN da elaborare nell'esecuzione CDC corrente.</span><span class="sxs-lookup"><span data-stu-id="28d70-116">This is the last LSN to be processed in the current CDC Run.</span></span> <span data-ttu-id="28d70-117">Viene sempre presupposto che l'ultimo numero di sequenza da elaborare sia il valore massimo (0xFFF...).</span><span class="sxs-lookup"><span data-stu-id="28d70-117">It is always assumed that the last sequence number to be processed is the maximum (0xFFF...).</span></span>|  
|`IR`|<span data-ttu-id="28d70-118">Viene contrassegnato l'intervallo di elaborazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="28d70-118">This marks the initial processing range.</span></span>|  
|`<ir-start>`|<span data-ttu-id="28d70-119">Si tratta di un numero LSN di una modifica appena prima dell'avvio del caricamento iniziale.</span><span class="sxs-lookup"><span data-stu-id="28d70-119">This is an LSN of a change just before the initial load began.</span></span>|  
|`<ir-end>`|<span data-ttu-id="28d70-120">Si tratta di un numero LSN di una modifica appena dopo il completamento del caricamento iniziale.</span><span class="sxs-lookup"><span data-stu-id="28d70-120">This is an LSN of a change just after the initial load ended.</span></span>|  
|`TS`|<span data-ttu-id="28d70-121">Viene contrassegnato il timestamp per l'ultimo aggiornamento dello stato CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-121">This marks the timestamp for the last CDC state update.</span></span>|  
|**\<timestamp>**|<span data-ttu-id="28d70-122">Si tratta di una rappresentazione decimale della proprietà System.DateTime.UtcNow a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="28d70-122">This is a decimal representation of the 64-bit, System.DateTime.UtcNow property.</span></span>|  
|`ER`|<span data-ttu-id="28d70-123">Viene visualizzato quando si verifica un errore durante l'esecuzione dell'ultima operazione ed è inclusa una breve descrizione della causa dell'errore.</span><span class="sxs-lookup"><span data-stu-id="28d70-123">This appears when the last operation failed and includes a short description of the cause of the error.</span></span> <span data-ttu-id="28d70-124">Se il componente è presente, viene sempre visualizzato per ultimo.</span><span class="sxs-lookup"><span data-stu-id="28d70-124">If this component is present, it will always appear last.</span></span>|  
|`<short-error-text>`|<span data-ttu-id="28d70-125">Si tratta della breve descrizione dell'errore.</span><span class="sxs-lookup"><span data-stu-id="28d70-125">This is the short error description.</span></span>|  
  
 <span data-ttu-id="28d70-126">I numeri LSN e di sequenza sono tutti codificati come stringa esadecimale fino a un massimo di 20 cifre che rappresentano il valore LSN di Binary(10).</span><span class="sxs-lookup"><span data-stu-id="28d70-126">The LSNs and sequence numbers are each encoded as a hexadecimal string of up to 20 digits representing the LSN value of Binary(10).</span></span>  
  
 <span data-ttu-id="28d70-127">Nella tabella seguente vengono descritti i possibili valori dello stato CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-127">The following table describes the possible CDC state values.</span></span>  
  
|<span data-ttu-id="28d70-128">State</span><span class="sxs-lookup"><span data-stu-id="28d70-128">State</span></span>|<span data-ttu-id="28d70-129">Descrizione</span><span class="sxs-lookup"><span data-stu-id="28d70-129">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="28d70-130">(INITIAL)</span><span class="sxs-lookup"><span data-stu-id="28d70-130">(INITIAL)</span></span>|<span data-ttu-id="28d70-131">Si tratta dello stato iniziale prima dell'esecuzione di qualsiasi pacchetto nel gruppo CDC corrente.</span><span class="sxs-lookup"><span data-stu-id="28d70-131">This is the initial state before the any package was run on the current CDC group.</span></span> <span data-ttu-id="28d70-132">È anche lo stato quando lo stato CDC è vuoto.</span><span class="sxs-lookup"><span data-stu-id="28d70-132">This is also the state when the CDC state is empty.</span></span>|  
|<span data-ttu-id="28d70-133">ILSTART (Initial Load Started)</span><span class="sxs-lookup"><span data-stu-id="28d70-133">ILSTART (Initial Load Started)</span></span>|<span data-ttu-id="28d70-134">Si tratta dello stato all'avvio del pacchetto di caricamento iniziale, dopo la chiamata dell'operazione `MarkInitialLoadStart` all'attività di controllo CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-134">This is the state when the initial load package starts, after the `MarkInitialLoadStart` operation call to the CDC Control task.</span></span>|  
|<span data-ttu-id="28d70-135">ILEND (Initial Load Ended)</span><span class="sxs-lookup"><span data-stu-id="28d70-135">ILEND (Initial Load Ended)</span></span>|<span data-ttu-id="28d70-136">Si tratta dello stato al corretto completamento del pacchetto di caricamento iniziale, dopo la chiamata dell'operazione `MarkInitialLoadEnd` all'attività di controllo CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-136">This is the state when the initial load package ends successfully, after the `MarkInitialLoadEnd` operation call to the CDC Control task.</span></span>|  
|<span data-ttu-id="28d70-137">ILUPDATE (Initial Load Update)</span><span class="sxs-lookup"><span data-stu-id="28d70-137">ILUPDATE (Initial Load Update)</span></span>|<span data-ttu-id="28d70-138">Si tratta dello stato durante l'esecuzione del pacchetto di aggiornamento Trickle-Feed in seguito al caricamento iniziale, mentre l'elaborazione dell'intervallo di elaborazione iniziale è ancora in corso.</span><span class="sxs-lookup"><span data-stu-id="28d70-138">This is the state on the runs of the trickle feed update package following the initial load, while still processing the initial processing range.</span></span> <span data-ttu-id="28d70-139">Si verifica dopo la chiamata dell'operazione `GetProcessingRange` all'attività di controllo CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-139">This is after the `GetProcessingRange` operation call to the CDC Control task.</span></span><br /><br /> <span data-ttu-id="28d70-140">Se si utilizza la colonna __$reprocessing, viene impostato su 1 per indicare che a livello di destinazione è possibile che le righe siano già in corso di rielaborazione.</span><span class="sxs-lookup"><span data-stu-id="28d70-140">If using the __$reprocessing column, it is set to 1 to indicate that the package may be re-processing rows already at the target.</span></span>|  
|<span data-ttu-id="28d70-141">TFEND (Trickle-Feed Update Ended)</span><span class="sxs-lookup"><span data-stu-id="28d70-141">TFEND (Trickle-Feed Update Ended)</span></span>|<span data-ttu-id="28d70-142">Si tratta dello stato previsto per le esecuzioni CDC normali.</span><span class="sxs-lookup"><span data-stu-id="28d70-142">This is the state expected for regular CDC runs.</span></span> <span data-ttu-id="28d70-143">Indica che l'esecuzione precedente è stata completata e che è possibile avviare una nuova esecuzione con un nuovo intervallo di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="28d70-143">It indicates that the previous run completed successfully and that a new run with a new processing range can be started.</span></span>|  
|<span data-ttu-id="28d70-144">TFSTART</span><span class="sxs-lookup"><span data-stu-id="28d70-144">TFSTART</span></span>|<span data-ttu-id="28d70-145">Si tratta dello stato durante un'esecuzione non iniziale del pacchetto di aggiornamento Trickle-Feed, dopo la chiamata dell'operazione `GetProcessingRange` all'attività di controllo CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-145">This is the state on a non-initial run of the trickle feed update package, after the `GetProcessingRange` operation call to the CDC Control task.</span></span><br /><br /> <span data-ttu-id="28d70-146">Viene indicato che un'esecuzione CDC normale è stata avviata in maniera pulita, ma non è stata, o non è ancora, terminata (`MarkProcessedRange`).</span><span class="sxs-lookup"><span data-stu-id="28d70-146">This indicates that a regular CDC run is started but has not finished or has not yet finished, cleanly (`MarkProcessedRange`).</span></span>|  
|<span data-ttu-id="28d70-147">TFREDO (Reprocessing Trickle-Feed Updates)</span><span class="sxs-lookup"><span data-stu-id="28d70-147">TFREDO (Reprocessing Trickle-Feed Updates)</span></span>|<span data-ttu-id="28d70-148">Si tratta dello stato di `GetProcessingRange` che si verifica dopo TFSTART.</span><span class="sxs-lookup"><span data-stu-id="28d70-148">This is the state on a `GetProcessingRange` that occurs after TFSTART.</span></span> <span data-ttu-id="28d70-149">Indica che l'esecuzione precedente non è stata completata correttamente.</span><span class="sxs-lookup"><span data-stu-id="28d70-149">This indicates that the previous run did not complete successfully.</span></span><br /><br /> <span data-ttu-id="28d70-150">Se si utilizza la colonna __$reprocessing, viene impostato su 1 per indicare che a livello di destinazione è possibile che le righe siano già in corso di rielaborazione.</span><span class="sxs-lookup"><span data-stu-id="28d70-150">If using the __$reprocessing column, it is set to 1 to indicate that the package may be re-processing rows already at the target.</span></span>|  
|<span data-ttu-id="28d70-151">ERRORE</span><span class="sxs-lookup"><span data-stu-id="28d70-151">ERROR</span></span>|<span data-ttu-id="28d70-152">Il gruppo CDC si trova in uno stato ERROR.</span><span class="sxs-lookup"><span data-stu-id="28d70-152">The CDC group is in an ERROR state.</span></span>|  
  
 <span data-ttu-id="28d70-153">Di seguito sono riportati esempi di valori della variabile di stato CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-153">The following are examples of CDC state variable values.</span></span>  
  
-   <span data-ttu-id="28d70-154">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span><span class="sxs-lookup"><span data-stu-id="28d70-154">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span></span>  
  
-   <span data-ttu-id="28d70-155">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span><span class="sxs-lookup"><span data-stu-id="28d70-155">ILSTART/IR/0x0000162B158700000000//TS/2011-08-07T17:10:43.0031645/</span></span>  
  
-   <span data-ttu-id="28d70-156">TFEND/CS/0x0000025B000001BC0003/TS/2011-07-17T12:05:58.1001145/</span><span class="sxs-lookup"><span data-stu-id="28d70-156">TFEND/CS/0x0000025B000001BC0003/TS/2011-07-17T12:05:58.1001145/</span></span>  
  
-   <span data-ttu-id="28d70-157">TFSTART/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:43.9344900/</span><span class="sxs-lookup"><span data-stu-id="28d70-157">TFSTART/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:43.9344900/</span></span>  
  
-   <span data-ttu-id="28d70-158">TFREDO/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:59.5544900/</span><span class="sxs-lookup"><span data-stu-id="28d70-158">TFREDO/CS/0x0000030D000000AE0003/CE/0x0000159D1E0F01000000/TS/2011-08-09T05:30:59.5544900/</span></span>  
  
### <a name="to-define-a-cdc-state-variable"></a><span data-ttu-id="28d70-159">Per definire una variabile di stato CDC</span><span class="sxs-lookup"><span data-stu-id="28d70-159">To define a CDC state variable</span></span>  
  
1.  <span data-ttu-id="28d70-160">In [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]aprire il pacchetto di [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] contenente il flusso CDC in cui è necessario definire la variabile.</span><span class="sxs-lookup"><span data-stu-id="28d70-160">In [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], open the [!INCLUDE[ssISCurrent](../../includes/ssiscurrent-md.md)] package that has the CDC flow where you need to define the variable.</span></span>  
  
2.  <span data-ttu-id="28d70-161">Fare clic sulla scheda **Esplora pacchetti** e aggiungere una nuova variabile.</span><span class="sxs-lookup"><span data-stu-id="28d70-161">Click the **Package Explorer** tab, and add a new variable.</span></span>  
  
3.  <span data-ttu-id="28d70-162">Assegnare un nome alla variabile in modo da poterla riconoscere come variabile di stato.</span><span class="sxs-lookup"><span data-stu-id="28d70-162">Give the variable a name that you can recognize as your state variable.</span></span>  
  
4.  <span data-ttu-id="28d70-163">Assegnare alla variabile un tipo di dati **String** .</span><span class="sxs-lookup"><span data-stu-id="28d70-163">Give the variable a **String** data type.</span></span>  
  
 <span data-ttu-id="28d70-164">Non assegnare alla variabile un valore come parte della definizione.</span><span class="sxs-lookup"><span data-stu-id="28d70-164">Do not give the variable a value as part of its definition.</span></span> <span data-ttu-id="28d70-165">Il valore deve essere impostato tramite l'attività di controllo CDC.</span><span class="sxs-lookup"><span data-stu-id="28d70-165">The value must be set by the CDC Control task.</span></span>  
  
 <span data-ttu-id="28d70-166">Se si intende utilizzare l'attività di controllo CDC con **Automatic State Persistence**, la variabile di stato CDC verrà letta dalla tabella degli stati del database specificata e verrà riaggiornata nella stessa tabella quando cambia il relativo valore.</span><span class="sxs-lookup"><span data-stu-id="28d70-166">If you plan to use the CDC Control task with **Automatic State Persistence**, the CDC State variable will be read from the database state table you specify and will be updated back to that same table when its value changes.</span></span> <span data-ttu-id="28d70-167">Per ulteriori informazioni sulla tabella degli stati, vedere [CDC Control Task](../control-flow/cdc-control-task.md)e [CDC Control Task Editor](../cdc-control-task-editor.md).</span><span class="sxs-lookup"><span data-stu-id="28d70-167">For more information about the State table, see [CDC Control Task](../control-flow/cdc-control-task.md)and [CDC Control Task Editor](../cdc-control-task-editor.md).</span></span>  
  
 <span data-ttu-id="28d70-168">Se non si utilizza l'attività di controllo CDC con Automatic State Persistence, è necessario caricare il valore della variabile dall'archivio permanente in cui sono stati salvati i relativi valori all'ultima esecuzione del pacchetto e riscriverlo nell'archivio permanente in cui è stata completata l'elaborazione dell'intervallo di elaborazione corrente.</span><span class="sxs-lookup"><span data-stu-id="28d70-168">If you are not using the CDC Control task with Automatic State Persistence then you must load the variable value from persistent storage where its value was saved the last time the package ran and to write it back to the persistent storage when the processing of the current processing range was completed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="28d70-169">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="28d70-169">See Also</span></span>  
 <span data-ttu-id="28d70-170">[Attività di controllo CDC](../control-flow/cdc-control-task.md) </span><span class="sxs-lookup"><span data-stu-id="28d70-170">[CDC Control Task](../control-flow/cdc-control-task.md) </span></span>  
 [<span data-ttu-id="28d70-171">Editor dell'attività di controllo CDC</span><span class="sxs-lookup"><span data-stu-id="28d70-171">CDC Control Task Editor</span></span>](../cdc-control-task-editor.md)  
  
  
