---
title: Componente script| Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scriptcomponentdetails.f1
helpviewer_keywords:
- Script transformation
- scripts [Integration Services], transformations
- Script component [Integration Services], about Script component
- Script component [Integration Services]
ms.assetid: 131c2d0c-2e33-4785-94af-ada5c049821e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: af8e500e399b0f69a7e34c9e2e01c74d83256107
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727095"
---
# <a name="script-component"></a><span data-ttu-id="3b705-102">Componente script</span><span class="sxs-lookup"><span data-stu-id="3b705-102">Script Component</span></span>
  <span data-ttu-id="3b705-103">Il componente Script ospita lo script e consente a un pacchetto di includere ed eseguire codice script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="3b705-103">The Script component hosts script and enables a package to include and run custom script code.</span></span> <span data-ttu-id="3b705-104">È possibile utilizzare il componente script nei pacchetti per gli scopi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b705-104">You can use the Script component in packages for the following purposes:</span></span>  
  
-   <span data-ttu-id="3b705-105">Applicare più trasformazioni ai dati anziché utilizzare più trasformazioni nel flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="3b705-105">Apply multiple transformations to data instead of using multiple transformations in the data flow.</span></span> <span data-ttu-id="3b705-106">Uno script può ad esempio sommare i valori in due colonne e quindi calcolare la media della somma.</span><span class="sxs-lookup"><span data-stu-id="3b705-106">For example, a script can add the values in two columns and then calculate the average of the sum.</span></span>  
  
-   <span data-ttu-id="3b705-107">Accedere a regole business in un assembly .NET esistente.</span><span class="sxs-lookup"><span data-stu-id="3b705-107">Access business rules in an existing .NET assembly.</span></span> <span data-ttu-id="3b705-108">Uno script può ad esempio applicare una regola business che specifica l'intervallo dei valori validi in una colonna di nome `Income`.</span><span class="sxs-lookup"><span data-stu-id="3b705-108">For example, a script can apply a business rule that specifies the range of values that are valid in an `Income` column.</span></span>  
  
-   <span data-ttu-id="3b705-109">Utilizzare formule e funzioni personalizzate, in aggiunta alle funzioni e agli operatori forniti dalla grammatica delle espressioni di [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3b705-109">Use custom formulas and functions in addition to the functions and operators that the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression grammar provides.</span></span> <span data-ttu-id="3b705-110">È ad esempio possibile convalidare i numeri delle carte di credito che usano la formula LUHN.</span><span class="sxs-lookup"><span data-stu-id="3b705-110">For example, validate credit card numbers that use the LUHN formula.</span></span>  
  
-   <span data-ttu-id="3b705-111">Convalidare i dati delle colonne e ignorare i record che contengono dati non validi.</span><span class="sxs-lookup"><span data-stu-id="3b705-111">Validate column data and skip records that contain invalid data.</span></span> <span data-ttu-id="3b705-112">Uno script può ad esempio stabilire se l'importo delle spese postali è ragionevole e ignorare i record che includono importi troppo alti o troppo bassi.</span><span class="sxs-lookup"><span data-stu-id="3b705-112">For example, a script can assess the reasonableness of a postage amount and skip records with extremely high or low amounts.</span></span>  
  
 <span data-ttu-id="3b705-113">Il componente script consente di includere in modo facile e veloce funzioni personalizzate in un flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="3b705-113">The Script component provides an easy and quick way to include custom functions in a data flow.</span></span> <span data-ttu-id="3b705-114">Se tuttavia si prevede di riutilizzare il codice di script in più pacchetti, è preferibile creare un componente personalizzato anziché utilizzare il componente script.</span><span class="sxs-lookup"><span data-stu-id="3b705-114">However, if you plan to reuse the script code in multiple packages, you should consider programming a custom component instead of using the Script component.</span></span> <span data-ttu-id="3b705-115">Per altre informazioni, vedere [Sviluppo di un componente del flusso di dati personalizzato](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="3b705-115">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3b705-116">Se il componente script contiene uno script che tenta di leggere il valore di una colonna NULL, quando si esegue il pacchetto si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="3b705-116">If the Script component contains a script that tries to read the value of a column that is NULL, the Script component fails when you run the package.</span></span> <span data-ttu-id="3b705-117">È consigliabile che lo script usi il metodo <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> per determinare se la colonna è NULL prima di tentare di leggere il valore della colonna.</span><span class="sxs-lookup"><span data-stu-id="3b705-117">We recommend that your script use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> method to determine whether the column is NULL before trying to read the column value.</span></span>  
  
 <span data-ttu-id="3b705-118">Il componente script può essere utilizzato come origine, trasformazione o destinazione.</span><span class="sxs-lookup"><span data-stu-id="3b705-118">The Script component can be used as a source, a transformation, or a destination.</span></span> <span data-ttu-id="3b705-119">Questo componente supporta un input e più output.</span><span class="sxs-lookup"><span data-stu-id="3b705-119">This component supports one input and multiple outputs.</span></span> <span data-ttu-id="3b705-120">A seconda di come viene utilizzato, il componente supporta un input o più output oppure entrambi.</span><span class="sxs-lookup"><span data-stu-id="3b705-120">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="3b705-121">Lo script viene richiamato da ogni riga nell'input o nell'output.</span><span class="sxs-lookup"><span data-stu-id="3b705-121">The script is invoked by every row in the input or output.</span></span>  
  
-   <span data-ttu-id="3b705-122">Se utilizzato come origine, il componente script supporta più output.</span><span class="sxs-lookup"><span data-stu-id="3b705-122">If used as a source, the Script component supports multiple outputs.</span></span>  
  
-   <span data-ttu-id="3b705-123">Se utilizzato come trasformazione, il componente script supporta un input e più output.</span><span class="sxs-lookup"><span data-stu-id="3b705-123">If used as a transformation, the Script component supports one input and multiple outputs.</span></span>  
  
-   <span data-ttu-id="3b705-124">Se utilizzato come destinazione, il componente script supporta un input.</span><span class="sxs-lookup"><span data-stu-id="3b705-124">If used as a destination, the Script component supports one input.</span></span>  
  
 <span data-ttu-id="3b705-125">Il componente script non supporta output degli errori.</span><span class="sxs-lookup"><span data-stu-id="3b705-125">The Script component does not support error outputs.</span></span>  
  
 <span data-ttu-id="3b705-126">Una volta stabilito che il componente Script è la scelta più appropriata per il pacchetto, è necessario configurare gli input e gli output, sviluppare lo script utilizzato dal componente e configurare il componente stesso.</span><span class="sxs-lookup"><span data-stu-id="3b705-126">After you decide that the Script component is the appropriate choice for your package, you have to configure the inputs and outputs, develop the script that the component uses, and configure the component itself.</span></span>  
  
## <a name="understanding-the-script-component-modes"></a><span data-ttu-id="3b705-127">Informazioni sulle modalità del componente script</span><span class="sxs-lookup"><span data-stu-id="3b705-127">Understanding the Script Component Modes</span></span>  
 <span data-ttu-id="3b705-128">In Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] sono disponibili due modalità per il componente script: progettazione metadati e progettazione codice.</span><span class="sxs-lookup"><span data-stu-id="3b705-128">In the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata-design mode and code-design mode.</span></span> <span data-ttu-id="3b705-129">In modalità progettazione metadati è possibile aggiungere e modificare gli input e gli output del componente script, ma non scrivere codice.</span><span class="sxs-lookup"><span data-stu-id="3b705-129">In metadata-design mode, you can add and modify the Script component inputs and outputs, but you cannot write code.</span></span> <span data-ttu-id="3b705-130">Dopo avere configurato tutti gli input e gli output è possibile passare alla modalità progettazione codice per creare lo script.</span><span class="sxs-lookup"><span data-stu-id="3b705-130">After all the inputs and outputs are configured, you switch to code-design mode to write the script.</span></span> <span data-ttu-id="3b705-131">Il componente script genera automaticamente il codice di base dai metadati degli input e degli output.</span><span class="sxs-lookup"><span data-stu-id="3b705-131">The Script component automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="3b705-132">Se si modificano i metadati dopo la generazione del codice di base, non sarà più possibile compilare il codice perché il codice di base aggiornato potrebbe essere incompatibile con quello inserito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="3b705-132">If you change the metadata after the Script component generates the base code, your code may no longer compile because the updated base code may be incompatible with your code.</span></span>  
  
## <a name="writing-the-script-that-the-component-uses"></a><span data-ttu-id="3b705-133">Scrittura dello script utilizzato dal componente</span><span class="sxs-lookup"><span data-stu-id="3b705-133">Writing the Script that the Component Uses</span></span>  
 <span data-ttu-id="3b705-134">Il componente script usa [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) come ambiente di scrittura degli script.</span><span class="sxs-lookup"><span data-stu-id="3b705-134">The Script component uses [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts.</span></span> <span data-ttu-id="3b705-135">Si accede a VSTA dall' **Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="3b705-135">You access VSTA from the **Script Transformation Editor**.</span></span> <span data-ttu-id="3b705-136">Per altre informazioni, vedere [Editor trasformazione Script &#40;pagina Script&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="3b705-136">For more information, see [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="3b705-137">Il componente script fornisce un progetto VSTA che include una classe generata automaticamente, ScriptMain, che rappresenta i metadati del componente.</span><span class="sxs-lookup"><span data-stu-id="3b705-137">The Script component provides a VSTA project that includes an auto-generated class, named ScriptMain, that represents the component metadata.</span></span> <span data-ttu-id="3b705-138">Se ad esempio il componente script viene utilizzato come trasformazione con tre output, la classe ScriptMain includerà un metodo per ogni output.</span><span class="sxs-lookup"><span data-stu-id="3b705-138">For example, if the Script component is used as a transformation that has three outputs, ScriptMain includes a method for each output.</span></span> <span data-ttu-id="3b705-139">La classe ScriptMain costituisce il punto di ingresso dello script.</span><span class="sxs-lookup"><span data-stu-id="3b705-139">ScriptMain is the entry point to the script.</span></span>  
  
 <span data-ttu-id="3b705-140">In VSTA sono disponibili tutte le caratteristiche standard dell'ambiente [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] , come l'editor di [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] con codifica a colori, la tecnologia IntelliSense e il Visualizzatore oggetti.</span><span class="sxs-lookup"><span data-stu-id="3b705-140">VSTA includes all the standard features of the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] editor, IntelliSense, and Object Browser.</span></span> <span data-ttu-id="3b705-141">Lo script utilizzato dal componente script è archiviato nella definizione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="3b705-141">The script that the Script component uses is stored in the package definition.</span></span> <span data-ttu-id="3b705-142">Durante la progettazione del pacchetto, il codice di script viene scritto temporaneamente in un file di progetto.</span><span class="sxs-lookup"><span data-stu-id="3b705-142">When you are designing the package, the script code is temporarily written to a project file.</span></span>  
  
 <span data-ttu-id="3b705-143">VSTA supporta il linguaggio di programmazione [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# e [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="3b705-143">VSTA supports the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic programming languages.</span></span>  
  
 <span data-ttu-id="3b705-144">Per altre informazioni sulla programmazione del componente Script, vedere [Estensione del flusso di dati con il componente script](script-component.md).</span><span class="sxs-lookup"><span data-stu-id="3b705-144">For information about how to program the Script component, see [Extending the Data Flow with the Script Component](script-component.md).</span></span> <span data-ttu-id="3b705-145">Per altre informazioni sulla configurazione del componente script come origine, trasformazione o destinazione, vedere [Sviluppo di tipi specifici di componenti script](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="3b705-145">For more specific information about how to configure the Script component as a source, transformation, or destination, see [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span> <span data-ttu-id="3b705-146">Per altri esempi, come una destinazione ODBC che dimostri l'uso del componente script, vedere [Ulteriori esempi di componente script](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span><span class="sxs-lookup"><span data-stu-id="3b705-146">For additional examples such as an ODBC destination that demonstrate the use of the Script component, see [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3b705-147">A differenza delle versioni precedenti in cui era possibile indicare se gli script erano precompilati o meno, in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] e versioni successive tutti gli script sono precompilati.</span><span class="sxs-lookup"><span data-stu-id="3b705-147">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="3b705-148">Se uno script è precompilato, il motore del linguaggio non verrà caricato in fase di esecuzione e il pacchetto verrà eseguito molto più rapidamente.</span><span class="sxs-lookup"><span data-stu-id="3b705-148">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="3b705-149">I file binari precompilati occupano tuttavia una notevole quantità di spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="3b705-149">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-component"></a><span data-ttu-id="3b705-150">Configurazione del componente script</span><span class="sxs-lookup"><span data-stu-id="3b705-150">Configuring the Script Component</span></span>  
 <span data-ttu-id="3b705-151">Per configurare il componente script, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="3b705-151">You can configure the Script component in the following ways:</span></span>  
  
-   <span data-ttu-id="3b705-152">Selezionare le colonne di input a cui fare riferimento.</span><span class="sxs-lookup"><span data-stu-id="3b705-152">Select the input columns to reference.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3b705-153">È possibile configurare un solo input quando si usa Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3b705-153">You can configure only one input when you use the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer.</span></span>  
  
-   <span data-ttu-id="3b705-154">Specificare lo script che deve essere eseguito dal componente.</span><span class="sxs-lookup"><span data-stu-id="3b705-154">Provide the script that the component runs.</span></span>  
  
-   <span data-ttu-id="3b705-155">Specificare il linguaggio di scripting.</span><span class="sxs-lookup"><span data-stu-id="3b705-155">Specify the script language.</span></span>  
  
-   <span data-ttu-id="3b705-156">Specificare le variabili in sola lettura e in lettura e scrittura in elenchi delimitati da virgole.</span><span class="sxs-lookup"><span data-stu-id="3b705-156">Provide comma-separated lists of read-only and read/write variables.</span></span>  
  
-   <span data-ttu-id="3b705-157">Aggiungere altri output e le colonne di output a cui lo script assegna valori.</span><span class="sxs-lookup"><span data-stu-id="3b705-157">Add more outputs, and add output columns to which the script assigns.</span></span>  
  
 <span data-ttu-id="3b705-158">È possibile impostare le proprietà tramite Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] o a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="3b705-158">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-component-in-the-designer"></a><span data-ttu-id="3b705-159">Configurazione del componente script in Progettazione</span><span class="sxs-lookup"><span data-stu-id="3b705-159">Configuring the Script Component in the Designer</span></span>  
 <span data-ttu-id="3b705-160">Per altre informazioni sulle proprietà che è possibile impostare nella finestra di dialogo **Editor trasformazione Script**, fare clic su uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b705-160">For more information about the properties that you can set in the **Script Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="3b705-161">Editor trasformazione Script &#40;pagina Colonne di input&#41;</span><span class="sxs-lookup"><span data-stu-id="3b705-161">Script Transformation Editor &#40;Input Columns Page&#41;</span></span>](../../script-transformation-editor-input-columns-page.md)  
  
-   [<span data-ttu-id="3b705-162">Editor trasformazione Script &#40;pagina Input e output&#41;</span><span class="sxs-lookup"><span data-stu-id="3b705-162">Script Transformation Editor &#40;Inputs and Outputs Page&#41;</span></span>](../../script-transformation-editor-inputs-and-outputs-page.md)  
  
-   [<span data-ttu-id="3b705-163">Editor trasformazione Script &#40;pagina Script&#41;</span><span class="sxs-lookup"><span data-stu-id="3b705-163">Script Transformation Editor &#40;Script Page&#41;</span></span>](../../script-transformation-editor-script-page.md)  
  
-   [<span data-ttu-id="3b705-164">Editor trasformazione Script &#40;pagina Gestioni connessioni&#41;</span><span class="sxs-lookup"><span data-stu-id="3b705-164">Script Transformation Editor &#40;Connection Managers Page&#41;</span></span>](../../script-transformation-editor-connection-managers-page.md)  
  
 <span data-ttu-id="3b705-165">Per altre informazioni sull'impostazione di queste proprietà in Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , fare clic sull'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="3b705-165">For more information about how to set these properties in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="3b705-166">Impostazione delle proprietà di un componente del flusso di dati</span><span class="sxs-lookup"><span data-stu-id="3b705-166">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
### <a name="configuring-the-script-component-programmatically"></a><span data-ttu-id="3b705-167">Configurazione del componente script a livello di codice</span><span class="sxs-lookup"><span data-stu-id="3b705-167">Configuring the Script Component Programmatically</span></span>  
 <span data-ttu-id="3b705-168">Per altre informazioni sulle proprietà che è possibile impostare nella finestra **Proprietà** o a livello di codice, fare clic su uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b705-168">For more information about the properties that you can set in the **Properties** window or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="3b705-169">Proprietà comuni</span><span class="sxs-lookup"><span data-stu-id="3b705-169">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="3b705-170">Proprietà personalizzate delle trasformazioni</span><span class="sxs-lookup"><span data-stu-id="3b705-170">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
 <span data-ttu-id="3b705-171">Per ulteriori informazioni sulle procedure per l'impostazione delle proprietà, fare clic su uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="3b705-171">For more information about how to set properties, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="3b705-172">Impostazione delle proprietà di un componente del flusso di dati</span><span class="sxs-lookup"><span data-stu-id="3b705-172">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="3b705-173">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="3b705-173">Related Content</span></span>  
 [<span data-ttu-id="3b705-174">Trasformazioni di Integration Services</span><span class="sxs-lookup"><span data-stu-id="3b705-174">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
 [<span data-ttu-id="3b705-175">Estensione del flusso di dati con il componente script</span><span class="sxs-lookup"><span data-stu-id="3b705-175">Extending the Data Flow with the Script Component</span></span>](script-component.md)  
  
  
