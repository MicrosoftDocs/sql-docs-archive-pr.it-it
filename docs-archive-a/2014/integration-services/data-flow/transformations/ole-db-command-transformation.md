---
title: Trasformazione Comando OLE DB | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727108"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="2a35e-102">Comando OLE DB - trasformazione</span><span class="sxs-lookup"><span data-stu-id="2a35e-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="2a35e-103">La trasformazione Comando OLE DB esegue un'istruzione SQL per ogni riga in un flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="2a35e-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="2a35e-104">È ad esempio possibile eseguire un'istruzione SQL che inserisce, aggiorna o elimina righe in una tabella di database.</span><span class="sxs-lookup"><span data-stu-id="2a35e-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="2a35e-105">Per configurare la trasformazione comando OLE DB, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="2a35e-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="2a35e-106">Specificare l'istruzione SQL eseguita dalla trasformazione per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="2a35e-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="2a35e-107">Specificare il numero di secondi prima del timeout dell'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="2a35e-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="2a35e-108">Specificare la tabella codici predefinita.</span><span class="sxs-lookup"><span data-stu-id="2a35e-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="2a35e-109">In genere l'istruzione SQL include parametri.</span><span class="sxs-lookup"><span data-stu-id="2a35e-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="2a35e-110">I valori dei parametri vengono archiviati in colonne esterne nell'input della trasformazione e, se si esegue il mapping di una colonna di input a una colonna esterna, verrà eseguito il mapping di una colonna di input a un parametro.</span><span class="sxs-lookup"><span data-stu-id="2a35e-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="2a35e-111">Per individuare ad esempio le righe della tabella **DimProduct** in base al valore nella relativa colonna **ProductKey** ed eliminarle, è possibile eseguire il mapping della colonna esterna con il nome **Param_0** alla colonna di input con il nome **ProductKey,** , quindi eseguire l'istruzione SQL `DELETE FROM DimProduct WHERE ProductKey = ?`.</span><span class="sxs-lookup"><span data-stu-id="2a35e-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="2a35e-112">I nomi dei parametri sono specificati dalla trasformazione Comando OLE DB e non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="2a35e-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="2a35e-113">I nomi dei parametri sono **Param_0**, **Param_1**e così via.</span><span class="sxs-lookup"><span data-stu-id="2a35e-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="2a35e-114">Se si configura la trasformazione Comando OLE DB tramite la finestra di dialogo **Editor avanzato** , sarà possibile eseguire automaticamente il mapping dei parametri dell'istruzione SQL alle colonne esterne nell'input della trasformazione e definire le caratteristiche di ogni parametro facendo clic sul pulsante **Aggiorna** .</span><span class="sxs-lookup"><span data-stu-id="2a35e-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="2a35e-115">Se tuttavia il provider OLE DB utilizzato dalla trasformazione Comando OLE DB non supporta la derivazione di informazioni sui parametri dai parametri, sarà necessario configurare le colonne esterne manualmente.</span><span class="sxs-lookup"><span data-stu-id="2a35e-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="2a35e-116">Questo significa che è necessario aggiungere una colonna per ogni parametro all'input esterno della trasformazione, aggiornare i nomi delle colonne in modo da usare nomi quale **Param_0**, specificare il valore della proprietà DBParamInfoFlags ed eseguire il mapping delle colonne di input contenenti i valori dei parametri alle colonne esterne.</span><span class="sxs-lookup"><span data-stu-id="2a35e-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="2a35e-117">Il valore di DBParamInfoFlags rappresenta le caratteristiche del parametro.</span><span class="sxs-lookup"><span data-stu-id="2a35e-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="2a35e-118">Il valore **1** , ad esempio, specifica che si tratta di un parametro di input, mentre il valore **65** specifica che si tratta di un parametro di input che può contenere un valore Null.</span><span class="sxs-lookup"><span data-stu-id="2a35e-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="2a35e-119">I valori devono corrispondere a quelli nell'enumerazione OLE DB DBPARAMFLAGSENUM.</span><span class="sxs-lookup"><span data-stu-id="2a35e-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="2a35e-120">Per ulteriori informazioni, vedere la documentazione di riferimento di OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2a35e-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="2a35e-121">La trasformazione Comando OLE DB include la proprietà personalizzata `SQLCommand`,</span><span class="sxs-lookup"><span data-stu-id="2a35e-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="2a35e-122">che può essere aggiornata da un'espressione di proprietà al caricamento del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="2a35e-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="2a35e-123">Per altre informazioni, vedere [Espressioni di Integration Services &#40;SSIS&#41;](../../expressions/integration-services-ssis-expressions.md), [Utilizzo delle espressioni di proprietà nei pacchetti](../../expressions/use-property-expressions-in-packages.md) e [Proprietà personalizzate delle trasformazioni](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="2a35e-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="2a35e-124">Questa trasformazione include un input, un output regolare e un output degli errori.</span><span class="sxs-lookup"><span data-stu-id="2a35e-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="2a35e-125">Registrazione</span><span class="sxs-lookup"><span data-stu-id="2a35e-125">Logging</span></span>  
 <span data-ttu-id="2a35e-126">È possibile registrare le chiamate eseguite dalla trasformazione Comando OLE DB a provider di dati esterni.</span><span class="sxs-lookup"><span data-stu-id="2a35e-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="2a35e-127">Questa nuova funzionalità di registrazione può essere utilizzata per risolvere i problemi relativi alle connessioni e ai comandi a origini dati esterne impartiti dalla trasformazione Comando OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2a35e-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="2a35e-128">Per registrare le chiamate eseguite dalla trasformazione Comando OLE DB a provider di dati esterni, abilitare la registrazione dei pacchetti e selezionare l'evento **Diagnostic** a livello del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="2a35e-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="2a35e-129">Per altre informazioni, vedere [Risoluzione dei problemi relativi agli strumenti per l'esecuzione del pacchetto](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="2a35e-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="2a35e-130">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="2a35e-130">Related Tasks</span></span>  
 <span data-ttu-id="2a35e-131">È possibile configurare la trasformazione utilizzando Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] o il modello a oggetti.</span><span class="sxs-lookup"><span data-stu-id="2a35e-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="2a35e-132">Per informazioni dettagliate sulla configurazione della trasformazione usando Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , vedere  [Configurazione della trasformazione Comando OLE DB](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="2a35e-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="2a35e-133">Vedere la Guida per gli sviluppatori per informazioni dettagliate sulla configurazione a livello di codice di questa trasformazione.</span><span class="sxs-lookup"><span data-stu-id="2a35e-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2a35e-134">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2a35e-134">See Also</span></span>  
 <span data-ttu-id="2a35e-135">[Flusso di dati](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="2a35e-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="2a35e-136">Trasformazioni di Integration Services</span><span class="sxs-lookup"><span data-stu-id="2a35e-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
