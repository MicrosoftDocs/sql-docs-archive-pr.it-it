---
title: Creazione di una trasformazione asincrona con il componente script | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- asynchronous outputs [Integration Services]
- transformation components [Integration Services]
- Script component [Integration Services], transformation components
ms.assetid: 0d814404-21e4-4a68-894c-96fa47ab25ae
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 465c4a597b4a18d7bd956116cd5d7640a5393958
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87629479"
---
# <a name="creating-an-asynchronous-transformation-with-the-script-component"></a><span data-ttu-id="0da9f-102">Creazione di una trasformazione asincrona con il componente script</span><span class="sxs-lookup"><span data-stu-id="0da9f-102">Creating an Asynchronous Transformation with the Script Component</span></span>
  <span data-ttu-id="0da9f-103">Utilizzare un componente di trasformazione nel flusso di dati di un pacchetto di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] per modificare e analizzare i dati quando vengono passati dall'origine alla destinazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-103">You use a transformation component in the data flow of an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package to modify and analyze data as it passes from source to destination.</span></span> <span data-ttu-id="0da9f-104">Una trasformazione con output sincroni elabora ogni riga di input non appena viene passata attraverso il componente.</span><span class="sxs-lookup"><span data-stu-id="0da9f-104">A transformation with synchronous outputs processes each input row as it passes through the component.</span></span> <span data-ttu-id="0da9f-105">Una trasformazione con output asincroni potrebbe invece attendere di ricevere tutte le righe di input prima di completare l'elaborazione oppure inviare determinate righe all'output prima di aver ricevuto tutte le righe di input.</span><span class="sxs-lookup"><span data-stu-id="0da9f-105">A transformation with asynchronous outputs may wait to complete its processing until the transformation has received all input rows, or the transformation may output certain rows before it has received all input rows.</span></span> <span data-ttu-id="0da9f-106">In questo argomento viene descritta una trasformazione asincrona.</span><span class="sxs-lookup"><span data-stu-id="0da9f-106">This topic discusses an asynchronous transformation.</span></span> <span data-ttu-id="0da9f-107">Se l'elaborazione richiede una trasformazione sincrona, vedere [Creazione di una trasformazione sincrona con il componente script](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-107">If your processing requires a synchronous transformation, see [Creating a Synchronous Transformation with the Script Component](../data-flow/transformations/script-component.md).</span></span> <span data-ttu-id="0da9f-108">Per altre informazioni sulle differenze tra componenti sincroni e asincroni, vedere [Informazioni sulle trasformazioni sincrone e asincrone](../understanding-synchronous-and-asynchronous-transformations.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-108">For more information about the differences between synchronous and asynchronous components, see [Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md).</span></span>

 <span data-ttu-id="0da9f-109">Per una panoramica sulla programmazione del componente Script, vedere [Estensione del flusso di dati con il componente script](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-109">For an overview of the Script component, see [Extending the Data Flow with the Script Component](../extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md).</span></span>

 <span data-ttu-id="0da9f-110">Il componente script e il codice dell'infrastruttura che genera semplificano il processo di sviluppo di un componente del flusso di dati personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0da9f-110">The Script component and the infrastructure code that it generates for you simplify the process of developing a custom data flow component.</span></span> <span data-ttu-id="0da9f-111">Per comprendere il funzionamento del componente script, può tuttavia risultare utile leggere informazioni sui passaggi necessari per lo sviluppo di un componente del flusso di dati personalizzato nella sezione [Sviluppo di un componente del flusso di dati personalizzato](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) e in particolare in [Sviluppo di un componente di destinazione personalizzato con output sincroni](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-111">However, to understand how the Script component works, you may find it useful to read through the steps that you must follow in developing a custom data flow component in the [Developing a Custom Data Flow Component](../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) section, and especially [Developing a Custom Transformation Component with Synchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-synchronous-outputs.md).</span></span>

## <a name="getting-started-with-an-asynchronous-transformation-component"></a><span data-ttu-id="0da9f-112">Introduzione ai componenti di trasformazione asincroni</span><span class="sxs-lookup"><span data-stu-id="0da9f-112">Getting Started with an Asynchronous Transformation Component</span></span>
 <span data-ttu-id="0da9f-113">Quando si aggiunge un componente script alla scheda Flusso di dati di Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] viene visualizzata la finestra di dialogo **Seleziona tipo componente script** che richiede di preconfigurare il componente come origine, trasformazione o destinazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-113">When you add a Script component to the Data Flow tab of [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears, prompting you to preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="0da9f-114">In questa finestra di dialogo selezionare **Trasformazione**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-114">In this dialog box, select **Transformation**.</span></span>

## <a name="configuring-an-asynchronous-transformation-component-in-metadata-design-mode"></a><span data-ttu-id="0da9f-115">Configurazione di un componente di trasformazione asincrono in modalità di progettazione metadati</span><span class="sxs-lookup"><span data-stu-id="0da9f-115">Configuring an Asynchronous Transformation Component in Metadata-Design Mode</span></span>
 <span data-ttu-id="0da9f-116">Dopo aver selezionato l'opzione per creare un componente di trasformazione, configurare il componente mediante **Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-116">After you select the option to create a transformation component, you configure the component by using the **Script Transformation Editor**.</span></span> <span data-ttu-id="0da9f-117">Per altre informazioni, vedere [Configurazione del componente script nell'editor corrispondente](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-117">For more information, see [Configuring the Script Component in the Script Component Editor](../extending-packages-scripting/data-flow-script-component/configuring-the-script-component-in-the-script-component-editor.md).</span></span>

 <span data-ttu-id="0da9f-118">Per selezionare il linguaggio di scripting che verrà usato dal componente script impostare la proprietà **ScriptLanguage** nella pagina **Script** della finestra di dialogo **Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-118">To select the script language that the Script component will use, you set the **ScriptLanguage** property on the **Script** page of the **Script Transformation Editor** dialog box.</span></span>

> [!NOTE]
>  <span data-ttu-id="0da9f-119">Per impostare il linguaggio di scripting predefinito per il componente script, usare l'opzione **Linguaggio di scripting** nella pagina **Generale** della finestra di dialogo **Opzioni**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-119">To set the default scripting language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="0da9f-120">Per ulteriori informazioni, vedere [General Page](../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-120">For more information, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span>

 <span data-ttu-id="0da9f-121">Un componente di trasformazione del flusso di dati include un input e supporta uno o più output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-121">A data flow transformation component has one input and supports one or more outputs.</span></span> <span data-ttu-id="0da9f-122">La configurazione dell'input e degli output del componente è uno dei passaggi da completare in modalità di progettazione metadati tramite **Editor trasformazione Script** prima di creare lo script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0da9f-122">Configuring the input and outputs of your component is one of the steps that you must complete in metadata design mode, by using the **Script Transformation Editor**, before you write your custom script.</span></span>

### <a name="configuring-input-columns"></a><span data-ttu-id="0da9f-123">Configurazione delle colonne di input</span><span class="sxs-lookup"><span data-stu-id="0da9f-123">Configuring Input Columns</span></span>
 <span data-ttu-id="0da9f-124">Un componente di trasformazione creato tramite il componente script include un unico input.</span><span class="sxs-lookup"><span data-stu-id="0da9f-124">A transformation component created by using the Script component has a single input.</span></span>

 <span data-ttu-id="0da9f-125">Nella pagina **Colonne di input** di **Editor trasformazione Script** l'elenco di colonne contiene le colonne disponibili dell'output del componente a monte nel flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="0da9f-125">On the **Input Columns** page of the **Script Transformation Editor**, the columns list shows the available columns from the output of the upstream component in the data flow.</span></span> <span data-ttu-id="0da9f-126">Selezionare le colonne che si desidera trasformare o passare.</span><span class="sxs-lookup"><span data-stu-id="0da9f-126">Select the columns that you want to transform or pass through.</span></span> <span data-ttu-id="0da9f-127">Contrassegnare le colonne che si desidera trasformare sul posto come di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="0da9f-127">Mark any columns that you want to transform in place as Read/Write.</span></span>

 <span data-ttu-id="0da9f-128">Per altre informazioni sulla pagina **Colonne di input** di **Editor trasformazione Script**, vedere [Editor trasformazione Script &#40;pagina Colonne di input&#41;](../script-transformation-editor-input-columns-page.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-128">For more information about the **Input Columns** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Input Columns Page&#41;](../script-transformation-editor-input-columns-page.md).</span></span>

### <a name="configuring-inputs-outputs-and-output-columns"></a><span data-ttu-id="0da9f-129">Configurazione di input, output e colonne di output</span><span class="sxs-lookup"><span data-stu-id="0da9f-129">Configuring Inputs, Outputs, and Output Columns</span></span>
 <span data-ttu-id="0da9f-130">Un componente di trasformazione supporta uno o più output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-130">A transformation component supports one or more outputs.</span></span>

 <span data-ttu-id="0da9f-131">In genere una trasformazione con output asincroni include due output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-131">Frequently a transformation with asynchronous outputs has two outputs.</span></span> <span data-ttu-id="0da9f-132">Ad esempio, per il conteggio del numero di indirizzi di una specifica città, è possibile passare i dati degli indirizzi a un output, inviando il risultato dell'aggregazione a un altro output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-132">For example, when you count the number of addresses located in a specific city, you may want to pass the address data through to one output, while sending the result of the aggregation to another output.</span></span> <span data-ttu-id="0da9f-133">L'output di aggregazione richiede anche una nuova colonna di output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-133">The aggregation output also requires a new output column.</span></span>

 <span data-ttu-id="0da9f-134">Nella pagina **Input e output** di **Editor trasformazione Script** è possibile verificare che è stato creato un singolo output per impostazione predefinita, ma non sono state create colonne di output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-134">On the **Inputs and Outputs** page of the **Script Transformation Editor**, you see that a single output has been created by default, but no output columns have been created.</span></span> <span data-ttu-id="0da9f-135">In questa pagina dell'editor è possibile configurare gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="0da9f-135">On this page of the editor, you can configure the following items:</span></span>

-   <span data-ttu-id="0da9f-136">È possibile creare uno o più output aggiuntivi, ad esempio un output per il risultato di un'aggregazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-136">You may want to create one or more additional outputs, such as an output for the result of an aggregation.</span></span> <span data-ttu-id="0da9f-137">Usare i pulsanti **Aggiungi output** e **Rimuovi output** per gestire gli output del componente di trasformazione asincrono.</span><span class="sxs-lookup"><span data-stu-id="0da9f-137">Use the **Add Output** and **Remove Output** buttons to manage the outputs of your asynchronous transformation component.</span></span> <span data-ttu-id="0da9f-138">Impostare la proprietà `SynchronousInputID` di ogni output su zero per indicare che l'output non si limita a passare i dati da un componente a monte o a trasformarli sul posto nelle righe e nelle colonne esistenti.</span><span class="sxs-lookup"><span data-stu-id="0da9f-138">Set the `SynchronousInputID` property of each output to zero to indicate that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns.</span></span> <span data-ttu-id="0da9f-139">Questa impostazione rende gli output asincroni rispetto all'input.</span><span class="sxs-lookup"><span data-stu-id="0da9f-139">It is this setting that makes the outputs asynchronous to the input.</span></span>

-   <span data-ttu-id="0da9f-140">È possibile assegnare un nome descrittivo all'input e agli output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-140">You may want to assign a friendly name to the input and outputs.</span></span> <span data-ttu-id="0da9f-141">Il componente script utilizza questi nomi per generare le proprietà delle funzioni di accesso tipizzate che verranno utilizzate per fare riferimento all'input e agli output nello script.</span><span class="sxs-lookup"><span data-stu-id="0da9f-141">The Script component uses these names to generate the typed accessor properties that you will use to refer to the input and outputs in your script.</span></span>

-   <span data-ttu-id="0da9f-142">In genere una trasformazione asincrona aggiunge colonne al flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="0da9f-142">Frequently an asynchronous transformation adds columns to the data flow.</span></span> <span data-ttu-id="0da9f-143">Quando la proprietà `SynchronousInputID` di un output è impostata su zero, a indicare che l'output non si limita a passare i dati da un componente a monte o a trasformarli sul posto nelle righe e nelle colonne esistenti, è necessario aggiungere e configurare in modo esplicito le colonne di output nell'output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-143">When the `SynchronousInputID` property of an output is zero, indicating that the output does not simply pass through data from an upstream component or transform it in place in the existing rows and columns, you must add and configure output columns explicitly on the output.</span></span> <span data-ttu-id="0da9f-144">Tali colonne non devono necessariamente avere gli stessi nomi delle colonne di input a cui sono mappate.</span><span class="sxs-lookup"><span data-stu-id="0da9f-144">Output columns do not have to have the same names as the input columns to which they are mapped.</span></span>

-   <span data-ttu-id="0da9f-145">È possibile aggiungere più colonne per includere ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="0da9f-145">You may want to add more columns to contain additional information.</span></span> <span data-ttu-id="0da9f-146">È necessario scrivere codice personalizzato per inserire dati nelle colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="0da9f-146">You must write your own code to fill the additional columns with data.</span></span> <span data-ttu-id="0da9f-147">Per informazioni sulla riproduzione del comportamento di un output degli errori standard, vedere [Simulazione di un output degli errori per il componente script](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-147">For information about reproducing the behavior of a standard error output, see [Simulating an Error Output for the Script Component](../extending-packages-scripting-data-flow-script-component-examples/simulating-an-error-output-for-the-script-component.md).</span></span>

 <span data-ttu-id="0da9f-148">Per altre informazioni sulla pagina **Input e output** di **Editor trasformazione Script**, vedere [Editor trasformazione Script &#40;pagina Input e output&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-148">For more information about the **Inputs and Outputs** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Inputs and Outputs Page&#41;](../script-transformation-editor-inputs-and-outputs-page.md).</span></span>

### <a name="adding-variables"></a><span data-ttu-id="0da9f-149">Aggiunta di variabili</span><span class="sxs-lookup"><span data-stu-id="0da9f-149">Adding Variables</span></span>
 <span data-ttu-id="0da9f-150">Se si vuole usare valori di variabili esistenti nello script, è possibile aggiungerli nei campi delle proprietà ReadOnlyVariables e ReadWriteVariables della pagina **Script** di **Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-150">If there are any existing variables whose values you want to use in your script, you can add them in the ReadOnlyVariables and ReadWriteVariables property fields on the **Script** page of the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="0da9f-151">Quando si aggiungono più variabili nei campi delle proprietà, separare i relativi nomi con virgole.</span><span class="sxs-lookup"><span data-stu-id="0da9f-151">When you add multiple variables in the property fields, separate the variable names by commas.</span></span> <span data-ttu-id="0da9f-152">È anche possibile selezionare più variabili facendo clic sul pulsante con i puntini di sospensione (**...**) accanto ai `ReadOnlyVariables` campi delle `ReadWriteVariables` proprietà e e quindi selezionando le variabili nella finestra di dialogo **Seleziona variabili** .</span><span class="sxs-lookup"><span data-stu-id="0da9f-152">You can also select multiple variables by clicking the ellipsis (**...**) button next to the `ReadOnlyVariables` and `ReadWriteVariables` property fields, and then selecting the variables in the **Select variables** dialog box.</span></span>

 <span data-ttu-id="0da9f-153">Per informazioni generali sull'uso delle variabili con il componente script, vedere [Uso di variabili nel componente script](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-153">For general information about how to use variables with the Script component, see [Using Variables in the Script Component](../extending-packages-scripting/data-flow-script-component/using-variables-in-the-script-component.md).</span></span>

 <span data-ttu-id="0da9f-154">Per altre informazioni sulla pagina **Script** di **Editor trasformazione Script**, vedere [Editor trasformazione Script &#40;pagina Script&#41;](../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-154">For more information about the **Script** page of the **Script Transformation Editor**, see [Script Transformation Editor &#40;Script Page&#41;](../script-transformation-editor-script-page.md).</span></span>

## <a name="scripting-an-asynchronous-transformation-component-in-code-design-mode"></a><span data-ttu-id="0da9f-155">Scripting di un componente di trasformazione asincrono in modalità di progettazione codice</span><span class="sxs-lookup"><span data-stu-id="0da9f-155">Scripting an Asynchronous Transformation Component in Code-Design Mode</span></span>
 <span data-ttu-id="0da9f-156">Dopo aver configurato tutti i metadati per il componente, è possibile scrivere lo script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0da9f-156">After you have configured all the metadata for your component, you can write your custom script.</span></span> <span data-ttu-id="0da9f-157">Nella pagina **Script** di **Editor trasformazione Script** fare clic su **Modifica script** per aprire l'IDE di [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA), in cui è possibile aggiungere lo script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0da9f-157">In the **Script Transformation Editor**, on the **Script** page, click **Edit Script** to open the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE where you can add your custom script.</span></span> <span data-ttu-id="0da9f-158">Il linguaggio di scripting che si usa varia a seconda che sia stato selezionato [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic o [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# come linguaggio di scripting per la proprietà **ScriptLanguage** nella pagina **Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-158">The scripting language that you use depends on whether you selected [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# as the script language for the **ScriptLanguage** property on the **Script** page.</span></span>

 <span data-ttu-id="0da9f-159">Per importanti informazioni applicabili a tutti i tipi di componenti creati tramite il componente script, vedere [Codifica e debug del componente script](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-159">For important information that applies to all kinds of components created by using the Script component, see [Coding and Debugging the Script Component](../extending-packages-scripting/data-flow-script-component/coding-and-debugging-the-script-component.md).</span></span>

### <a name="understanding-the-auto-generated-code"></a><span data-ttu-id="0da9f-160">Informazioni sul codice generato automaticamente</span><span class="sxs-lookup"><span data-stu-id="0da9f-160">Understanding the Auto-generated Code</span></span>
 <span data-ttu-id="0da9f-161">Quando si apre l'IDE di VSTA dopo la creazione e la configurazione di un componente di trasformazione, la classe modificabile `ScriptMain` viene visualizzata nell'editor di codice con stub per i metodi ProcessInputRow e CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="0da9f-161">When you open the VSTA IDE after creating and configuring a transformation component, the editable `ScriptMain` class appears in the code editor with stubs for the ProcessInputRow and the CreateNewOutputRows methods.</span></span> <span data-ttu-id="0da9f-162">La classe ScriptMain è quella in cui si scriverà il codice personalizzato, mentre ProcessInputRow è il metodo più importante in un componente di trasformazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-162">The ScriptMain class is where you will write your custom code, and ProcessInputRow is the most important method in a transformation component.</span></span> <span data-ttu-id="0da9f-163">Il metodo `CreateNewOutputRows` viene in genere utilizzato in un componente di origine, che è simile a una trasformazione asincrona in quanto entrambi i componenti devono creare le rispettive righe di output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-163">The `CreateNewOutputRows` method is more typically used in a source component, which is like an asynchronous transformation in that both components must create their own output rows.</span></span>

 <span data-ttu-id="0da9f-164">Se si apre la finestra **Esplora progetti** di VSTA, è possibile osservare che il componente script ha generato anche gli `BufferWrapper` elementi di progetto e di sola lettura `ComponentWrapper` .</span><span class="sxs-lookup"><span data-stu-id="0da9f-164">If you open the VSTA **Project Explorer** window, you can see that the Script component has also generated read-only `BufferWrapper` and `ComponentWrapper` project items.</span></span> <span data-ttu-id="0da9f-165">La classe ScriptMain eredita dalla classe UserComponent nell'elemento di `ComponentWrapper` progetto.</span><span class="sxs-lookup"><span data-stu-id="0da9f-165">The ScriptMain class inherits from the UserComponent class in the `ComponentWrapper` project item.</span></span>

 <span data-ttu-id="0da9f-166">In fase di esecuzione, il motore flusso di dati chiama il metodo PrimeOutput nella `UserComponent` classe, che esegue l'override del <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> metodo della <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> classe padre.</span><span class="sxs-lookup"><span data-stu-id="0da9f-166">At run time, the data flow engine calls the PrimeOutput method in the `UserComponent` class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="0da9f-167">Il metodo PrimeOutput chiama a sua volta il metodo CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="0da9f-167">The PrimeOutput method in turn calls the CreateNewOutputRows method.</span></span>

 <span data-ttu-id="0da9f-168">In fase di esecuzione il motore flusso di dati chiama il metodo ProcessInput nella classe UserComponent, che esegue l'override del metodo <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> della classe padre <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent>.</span><span class="sxs-lookup"><span data-stu-id="0da9f-168">Next, the data flow engine invokes the ProcessInput method in the UserComponent class, which overrides the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ProcessInput%2A> method of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> parent class.</span></span> <span data-ttu-id="0da9f-169">A sua volta il metodo ProcessInput esegue il ciclo delle righe nel buffer di input e chiama il metodo ProcessInputRow una volta per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="0da9f-169">The ProcessInput method in turn loops through the rows in the input buffer and calls the ProcessInputRow method one time for each row.</span></span>

### <a name="writing-your-custom-code"></a><span data-ttu-id="0da9f-170">Scrittura di codice personalizzato</span><span class="sxs-lookup"><span data-stu-id="0da9f-170">Writing Your Custom Code</span></span>
 <span data-ttu-id="0da9f-171">Per completare la creazione di un componente di trasformazione asincrono, è necessario usare il metodo ProcessInputRow sottoposto a override per elaborare i dati in ogni riga del buffer di input.</span><span class="sxs-lookup"><span data-stu-id="0da9f-171">To finish creating a custom asynchronous transformation component, you must use the overridden ProcessInputRow method to process the data in each row of the input buffer.</span></span> <span data-ttu-id="0da9f-172">Poiché gli output non sono sincroni rispetto all'input, è necessario scrivere in modo esplicito le righe di dati negli output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-172">Because the outputs are not synchronous to the input, you must explicitly write rows of data to the outputs.</span></span>

 <span data-ttu-id="0da9f-173">In una trasformazione asincrona è possibile usare il metodo AddRow per aggiungere righe all'output, se necessario, dall'interno dei metodi ProcessInputRow o ProcessInput.</span><span class="sxs-lookup"><span data-stu-id="0da9f-173">In an asynchronous transformation, you can use the AddRow method to add rows to the output as appropriate from within the ProcessInputRow or ProcessInput methods.</span></span> <span data-ttu-id="0da9f-174">Non è necessario usare il metodo CreateNewOutputRows.</span><span class="sxs-lookup"><span data-stu-id="0da9f-174">You do not have to use the CreateNewOutputRows method.</span></span> <span data-ttu-id="0da9f-175">Se si scrive una singola riga di risultati, ad esempio i risultati di un'aggregazione, in un determinato output, è possibile creare prima la riga di output usando il metodo CreateNewOutputRows e inserire i valori in seguito dopo l'elaborazione di tutte le righe di input.</span><span class="sxs-lookup"><span data-stu-id="0da9f-175">If you are writing a single row of results, such as aggregation results, to a particular output, you can create the output row beforehand by using the CreateNewOutputRows method, and fill in its values later after processing all input rows.</span></span> <span data-ttu-id="0da9f-176">Tuttavia non è utile creare più righe nel metodo CreateNewOutputRows, perché il componente script consente di usare solo la riga corrente in un input o in un output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-176">However it is not useful to create multiple rows in the CreateNewOutputRows method, because the Script component only lets you use the current row in an input or output.</span></span> <span data-ttu-id="0da9f-177">Il metodo CreateNewOutputRows è più importante in un componente di origine, in cui non sono presenti righe di input da elaborare.</span><span class="sxs-lookup"><span data-stu-id="0da9f-177">The CreateNewOutputRows method is more important in a source component where there are no input rows to process.</span></span>

 <span data-ttu-id="0da9f-178">È anche possibile eseguire l'override del metodo ProcessInput stesso, in modo da poter eseguire un'elaborazione aggiuntiva preliminare o finale prima o dopo aver eseguito il ciclo del buffer di input e aver chiamato ProcessInputRow per ogni riga.</span><span class="sxs-lookup"><span data-stu-id="0da9f-178">You may also want to override the ProcessInput method itself, so that you can do additional preliminary or final processing before or after you loop through the input buffer and call ProcessInputRow for each row.</span></span> <span data-ttu-id="0da9f-179">Uno degli esempi di codice in questo argomento, ad esempio, esegue l'override di ProcessInput per contare il numero di indirizzi in una determinata città perché ProcessInputRow scorre le righe `.` . l'esempio scrive il valore di riepilogo nel secondo output dopo l'elaborazione di tutte le righe.</span><span class="sxs-lookup"><span data-stu-id="0da9f-179">For example, one of the code examples in this topic overrides ProcessInput to count the number of addresses in a specific city as ProcessInputRow loops through rows`.` The example writes the summary value to the second output after all rows have been processed.</span></span> <span data-ttu-id="0da9f-180">L'output dell'esempio viene completato in ProcessInput, perché quando viene chiamato PostExecute non sono più disponibili buffer di output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-180">The example completes the output in ProcessInput because the output buffers are no longer available when PostExecute is called.</span></span>

 <span data-ttu-id="0da9f-181">A seconda delle esigenze è anche possibile creare script nei metodi PreExecute e PostExecute, disponibili nella classe ScriptMain, per eseguire l'elaborazione preliminare o finale.</span><span class="sxs-lookup"><span data-stu-id="0da9f-181">Depending on your requirements, you may also want to write script in the PreExecute and PostExecute methods available in the ScriptMain class to perform any preliminary or final processing.</span></span>

> [!NOTE]
>  <span data-ttu-id="0da9f-182">Se si sviluppa un componente del flusso di dati personalizzato da zero, è importante eseguire l'override del metodo PrimeOutput per memorizzare nella cache i riferimenti ai buffer di output, in modo da poter aggiungere righe di dati ai buffer in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="0da9f-182">If you were developing a custom data flow component from scratch, it would be important to override the PrimeOutput method to cache references to the output buffers so that you could add rows of data to the buffers later.</span></span> <span data-ttu-id="0da9f-183">Nel componente script questa operazione non è necessaria perché è disponibile una classe generata automaticamente che rappresenta ogni buffer di output nell'elemento di progetto `BufferWrapper`.</span><span class="sxs-lookup"><span data-stu-id="0da9f-183">In the Script component, this is not necessary because you have an automatically generated class representing each output buffer in the `BufferWrapper` project item.</span></span>

## <a name="example"></a><span data-ttu-id="0da9f-184">Esempio</span><span class="sxs-lookup"><span data-stu-id="0da9f-184">Example</span></span>
 <span data-ttu-id="0da9f-185">In questo esempio è illustrato il codice personalizzato necessario nella classe ScriptMain per creare un componente di trasformazione asincrono.</span><span class="sxs-lookup"><span data-stu-id="0da9f-185">This example demonstrates the custom code that is required in the ScriptMain class to create an asynchronous transformation component.</span></span>

> [!NOTE]
>  <span data-ttu-id="0da9f-186">Gli esempi usano la tabella **Person.Address** del database di esempio **AdventureWorks** e passano la prima e la quarta colonna, ovvero le colonne **intAddressID** e **nvarchar(30)City**, attraverso il flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="0da9f-186">These examples use the **Person.Address** table in the **AdventureWorks** sample database and pass its first and fourth columns, the **intAddressID** and **nvarchar(30)City** columns, through the data flow.</span></span> <span data-ttu-id="0da9f-187">Gli stessi dati vengono utilizzati negli esempi relativi a origine, trasformazione e destinazione in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-187">The same data is used in the source, transformation, and destination samples in this section.</span></span> <span data-ttu-id="0da9f-188">Per ogni esempio, sono documentati ulteriori prerequisiti e presupposti.</span><span class="sxs-lookup"><span data-stu-id="0da9f-188">Additional prerequisites and assumptions are documented for each example.</span></span>

 <span data-ttu-id="0da9f-189">In questo esempio viene illustrato un componente di trasformazione asincrono con due output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-189">This example demonstrates an asynchronous transformation component with two outputs.</span></span> <span data-ttu-id="0da9f-190">Questa trasformazione passa le colonne **AddressID** e **City** a un output mentre conta il numero di indirizzi di una specifica città (Redmond, Washington, U.S.A.), quindi restituisce il valore risultante a un secondo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-190">This transformation passes through the **AddressID** and **City** columns to one output, while it counts the number of addresses located in a specific city (Redmond, Washington, U.S.A.), and then outputs the resulting value to a second output.</span></span>

 <span data-ttu-id="0da9f-191">Se si desidera eseguire questo codice di esempio, è necessario configurare il pacchetto e il componente come segue:</span><span class="sxs-lookup"><span data-stu-id="0da9f-191">If you want to run this sample code, you must configure the package and the component as follows:</span></span>

1.  <span data-ttu-id="0da9f-192">Aggiungere un nuovo componente script all'area di progettazione del flusso di dati e configurarlo come trasformazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-192">Add a new Script component to the Data Flow designer surface and configure it as a transformation.</span></span>

2.  <span data-ttu-id="0da9f-193">Connettere l'output di un'origine o di un'altra trasformazione al nuovo componente di trasformazione nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-193">Connect the output of a source or of another transformation to the new transformation component in the designer.</span></span> <span data-ttu-id="0da9f-194">Questo output deve specificare dati della tabella **Person.Address** del database di esempio **AdventureWorks** che contiene almeno le colonne **AddressID** e **City**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-194">This output should provide data from the **Person.Address** table of the **AdventureWorks** sample database that contains at least the **AddressID** and **City** columns.</span></span>

3.  <span data-ttu-id="0da9f-195">Aprire l'**Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-195">Open the **Script Transformation Editor**.</span></span> <span data-ttu-id="0da9f-196">Nella pagina **Colonne di input** selezionare le colonne **AddressID** e **City**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-196">On the **Input Columns** page, select the **AddressID** and **City** columns.</span></span>

4.  <span data-ttu-id="0da9f-197">Nella pagina **Input e output** aggiungere e configurare le colonne di output **AddressID** e **City** nel primo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-197">On the **Inputs and Outputs** page, add and configure the **AddressID** and **City** output columns on the first output.</span></span> <span data-ttu-id="0da9f-198">Aggiungere un secondo output, quindi aggiungere una colonna di output per il valore di riepilogo nel secondo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-198">Add a second output, and add an output column for the summary value on the second output.</span></span> <span data-ttu-id="0da9f-199">Impostare la proprietà SynchronousInputID del primo output su 0, perché in questo esempio ogni riga di input viene copiata in modo esplicito nel primo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-199">Set the SynchronousInputID property of the first output to 0, because this example copies each input row explicitly to the first output.</span></span> <span data-ttu-id="0da9f-200">La proprietà SynchronousInputID dell'output appena creato è già impostata su 0.</span><span class="sxs-lookup"><span data-stu-id="0da9f-200">The SynchronousInputID property of the newly-created output is already set to 0.</span></span>

5.  <span data-ttu-id="0da9f-201">Rinominare l'input, gli output e la nuova colonna di output specificando nomi più descrittivi.</span><span class="sxs-lookup"><span data-stu-id="0da9f-201">Rename the input, the outputs, and the new output column to give them more descriptive names.</span></span> <span data-ttu-id="0da9f-202">Nell'esempio si usano **MyAddressInput** come nome dell'input, **MyAddressOutput** e **MySummaryOutput** per gli output e **MyRedmondCount** per la colonna di output nel secondo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-202">The example uses **MyAddressInput** as the name of the input, **MyAddressOutput** and **MySummaryOutput** for the outputs, and **MyRedmondCount** for the output column on the second output.</span></span>

6.  <span data-ttu-id="0da9f-203">Nella pagina **Script** fare clic su **Modifica script** e immettere lo script seguente.</span><span class="sxs-lookup"><span data-stu-id="0da9f-203">On the **Script** page, click **Edit Script** and enter the script that follows.</span></span> <span data-ttu-id="0da9f-204">Chiudere quindi l'ambiente di sviluppo dello script e **Editor trasformazione Script**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-204">Then close the script development environment and the **Script Transformation Editor**.</span></span>

7.  <span data-ttu-id="0da9f-205">Creare e configurare un componente di destinazione per il primo output in cui sono previste le colonne **AddressID** e **City**, ad esempio una destinazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], oppure il componente di destinazione di esempio illustrato in [Creazione di una destinazione con il componente script](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="0da9f-205">Create and configure a destination component for the first output that expects the **AddressID** and **City** columns, such as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] destination, or the sample destination component demonstrated in [Creating a Destination with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md), .</span></span> <span data-ttu-id="0da9f-206">Connettere quindi il primo output della trasformazione, **MyAddressOutput**, al componente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-206">Then connect the first output of the transformation, **MyAddressOutput**, to the destination component.</span></span> <span data-ttu-id="0da9f-207">È possibile creare una tabella di destinazione eseguendo il comando [!INCLUDE[tsql](../../includes/tsql-md.md)] seguente nel database **AdventureWorks**:</span><span class="sxs-lookup"><span data-stu-id="0da9f-207">You can create a destination table by running the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command in the **AdventureWorks** database:</span></span>

    ```
    CREATE TABLE [Person].[Address2]([AddressID] [int] NOT NULL,
        [City] [nvarchar](30) NOT NULL)
    ```

8.  <span data-ttu-id="0da9f-208">Creare e configurare un altro componente di destinazione per il secondo output.</span><span class="sxs-lookup"><span data-stu-id="0da9f-208">Create and configure another destination component for the second output.</span></span> <span data-ttu-id="0da9f-209">Connettere quindi il secondo output della trasformazione, **MySummaryOutput**, al componente di destinazione.</span><span class="sxs-lookup"><span data-stu-id="0da9f-209">Then connect the second output of the transformation, **MySummaryOutput**, to the destination component.</span></span> <span data-ttu-id="0da9f-210">Poiché il secondo output scrive una singola riga con un singolo valore, è possibile configurare facilmente una destinazione con una gestione connessione file flat che si connette a un nuovo file con una singola colonna.</span><span class="sxs-lookup"><span data-stu-id="0da9f-210">Because the second output writes a single row with a single value, you can easily configure a destination with a Flat File connection manager that connects to a new file that has a single column.</span></span> <span data-ttu-id="0da9f-211">Nell'esempio questa colonna di destinazione è denominata **MyRedmondCount**.</span><span class="sxs-lookup"><span data-stu-id="0da9f-211">In the example, this destination column is named **MyRedmondCount**.</span></span>

9. <span data-ttu-id="0da9f-212">Eseguire l'esempio.</span><span class="sxs-lookup"><span data-stu-id="0da9f-212">Run the sample.</span></span>

```vb
Public Class ScriptMain
    Inherits UserComponent

    Private myRedmondAddressCount As Integer

    Public Overrides Sub CreateNewOutputRows()

        MySummaryOutputBuffer.AddRow()

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInput(ByVal Buffer As MyAddressInputBuffer)

        While Buffer.NextRow()
            MyAddressInput_ProcessInputRow(Buffer)
        End While

        If Buffer.EndOfRowset Then
            MyAddressOutputBuffer.SetEndOfRowset()
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount
            MySummaryOutputBuffer.SetEndOfRowset()
        End If

    End Sub

    Public Overrides Sub MyAddressInput_ProcessInputRow(ByVal Row As MyAddressInputBuffer)

        With MyAddressOutputBuffer
            .AddRow()
            .AddressID = Row.AddressID
            .City = Row.City
        End With

        If Row.City.ToUpper = "REDMOND" Then
            myRedmondAddressCount += 1
        End If

    End Sub

End Class
```

```csharp
public class ScriptMain:
    UserComponent

{
    private int myRedmondAddressCount;

    public override void CreateNewOutputRows()
    {

        MySummaryOutputBuffer.AddRow();

    }

    public override void MyAddressInput_ProcessInput(MyAddressInputBuffer Buffer)
    {

        while (Buffer.NextRow())
        {
            MyAddressInput_ProcessInputRow(Buffer);
        }

        if (Buffer.EndOfRowset())
        {
            MyAddressOutputBuffer.SetEndOfRowset();
            MySummaryOutputBuffer.MyRedmondCount = myRedmondAddressCount;
            MySummaryOutputBuffer.SetEndOfRowset();
        }

    }

    public override void MyAddressInput_ProcessInputRow(MyAddressInputBuffer Row)
    {

        {
            MyAddressOutputBuffer.AddRow();
            MyAddressOutputBuffer.AddressID = Row.AddressID;
            MyAddressOutputBuffer.City = Row.City;
        }

        if (Row.City.ToUpper() == "REDMOND")
        {
            myRedmondAddressCount += 1;
        }

    }

}

```

<span data-ttu-id="0da9f-213">![Integration Services icona (piccola)](../media/dts-16.gif "Icona di Integration Services (piccola)")  **rimane aggiornata con Integration Services**</span><span class="sxs-lookup"><span data-stu-id="0da9f-213">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="0da9f-214">Per i download, gli articoli, gli esempi e i video Microsoft più recenti, oltre alle soluzioni selezionate dalla community, visitare la pagina [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] sul sito MSDN:</span><span class="sxs-lookup"><span data-stu-id="0da9f-214">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="0da9f-215">Visitare la pagina relativa a Integration Services su MSDN</span><span class="sxs-lookup"><span data-stu-id="0da9f-215">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="0da9f-216">Per ricevere una notifica automatica su questi aggiornamenti, sottoscrivere i feed RSS disponibili nella pagina.</span><span class="sxs-lookup"><span data-stu-id="0da9f-216">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="0da9f-217">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0da9f-217">See Also</span></span>
 <span data-ttu-id="0da9f-218">[Informazioni sulle trasformazioni sincrone e asincrone](../understanding-synchronous-and-asynchronous-transformations.md) [creazione di una trasformazione sincrona con il componente script](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [sviluppo di un componente di trasformazione personalizzato con output asincroni](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span><span class="sxs-lookup"><span data-stu-id="0da9f-218">[Understanding Synchronous and Asynchronous Transformations](../understanding-synchronous-and-asynchronous-transformations.md) [Creating a Synchronous Transformation with the Script Component](../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md) [Developing a Custom Transformation Component with Asynchronous Outputs](../extending-packages-custom-objects-data-flow-types/developing-a-custom-transformation-component-with-asynchronous-outputs.md)</span></span>


