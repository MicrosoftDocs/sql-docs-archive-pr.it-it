---
title: Query di Integration Services (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628866"
---
# <a name="integration-services-ssis-queries"></a><span data-ttu-id="68b06-102">Query di Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="68b06-102">Integration Services (SSIS) Queries</span></span>
  <span data-ttu-id="68b06-103">L'attività Esegui SQL, l'origine OLE DB, la destinazione OLE DB e la trasformazione Ricerca possono utilizzare query SQL.</span><span class="sxs-lookup"><span data-stu-id="68b06-103">The Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation can use SQL queries.</span></span> <span data-ttu-id="68b06-104">Nell'attività Esegui SQL, tramite le istruzioni SQL vengono creati, aggiornati ed eliminati dati e oggetti di database e vengono eseguite stored procedure e istruzioni SELECT.</span><span class="sxs-lookup"><span data-stu-id="68b06-104">In the Execute SQL task, the SQL statements can create, update, and delete database objects and data; run stored procedures; and perform SELECT statements.</span></span> <span data-ttu-id="68b06-105">Nell'origine OLE DB e nella trasformazione Ricerca, le istruzioni SQL sono solitamente istruzioni SELECT o EXEC.</span><span class="sxs-lookup"><span data-stu-id="68b06-105">In the OLE DB source and the Lookup transformation, the SQL statements are typically SELECT statements or EXEC statements.</span></span> <span data-ttu-id="68b06-106">Queste ultime eseguono in genere stored procedure che restituiscono set di risultati.</span><span class="sxs-lookup"><span data-stu-id="68b06-106">The latter most frequently run stored procedures that return result sets.</span></span>  
  
 <span data-ttu-id="68b06-107">Le query possono essere analizzate per stabilire se sono valide.</span><span class="sxs-lookup"><span data-stu-id="68b06-107">A query can be parsed to establish whether it is valid.</span></span> <span data-ttu-id="68b06-108">Quando si analizza una query che utilizza una connessione a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], la query viene analizzata ed eseguita e il risultato dell'esecuzione, ovvero esito positivo o negativo, viene assegnato al risultato dell'analisi.</span><span class="sxs-lookup"><span data-stu-id="68b06-108">When parsing a query that uses a connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the query is parsed, executed, and the execution outcome (success or failure) is assigned to the parsing outcome.</span></span> <span data-ttu-id="68b06-109">Se la query utilizza una connessione a dati diversi da [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], l'istruzione viene semplicemente analizzata.</span><span class="sxs-lookup"><span data-stu-id="68b06-109">If the query uses a connection to a data other than [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the statement is parsed only.</span></span>  
  
 <span data-ttu-id="68b06-110">È possibile definire l'istruzione SQL immettendola direttamente nella finestra di progettazione oppure specificando una connessione file o una variabile contenente l'istruzione.</span><span class="sxs-lookup"><span data-stu-id="68b06-110">The SQL statement can be defined either by entering it directly in the designer, or by specifying a file connection or a variable that contains the statement.</span></span>  
  
## <a name="direct-input-sql"></a><span data-ttu-id="68b06-111">SQL a input diretto</span><span class="sxs-lookup"><span data-stu-id="68b06-111">Direct Input SQL</span></span>  
 <span data-ttu-id="68b06-112">Generatore query è disponibile nell'interfaccia utente per l'attività Esegui SQL, l'origine OLE DB, la destinazione OLE DB e la trasformazione Ricerca.</span><span class="sxs-lookup"><span data-stu-id="68b06-112">Query Builder is available in the user interface for the Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation.</span></span> <span data-ttu-id="68b06-113">Tramite Generatore query è possibile:</span><span class="sxs-lookup"><span data-stu-id="68b06-113">Query Builder offers the following advantages:</span></span>  
  
-   <span data-ttu-id="68b06-114">Lavorare in modo visivo o con comandi SQL.</span><span class="sxs-lookup"><span data-stu-id="68b06-114">Work visually or with SQL commands.</span></span>  
  
     <span data-ttu-id="68b06-115">Generatore query include riquadri grafici per la formulazione delle query in modo visivo e un riquadro di testo in cui viene visualizzato il testo SQL per la query.</span><span class="sxs-lookup"><span data-stu-id="68b06-115">Query Builder includes graphical panes that compose your query visually and a text pane that displays the SQL text of your query.</span></span> <span data-ttu-id="68b06-116">È possibile lavorare nei riquadri grafici o in quello di testo.</span><span class="sxs-lookup"><span data-stu-id="68b06-116">You can work in either the graphical or text panes.</span></span> <span data-ttu-id="68b06-117">Generatore query sincronizza i due tipi di visualizzazione affinché il testo della query e la rappresentazione grafica siano sempre corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="68b06-117">Query Builder synchronizes the views so that the query text and graphical representation always match.</span></span>  
  
-   <span data-ttu-id="68b06-118">Unire in join tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="68b06-118">Join related tables.</span></span>  
  
     <span data-ttu-id="68b06-119">Se in una query si aggiungono più tabelle, Generatore query determina automaticamente il tipo di relazione tra le tabelle e formula il comando di join appropriato.</span><span class="sxs-lookup"><span data-stu-id="68b06-119">If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="68b06-120">Eseguire query o aggiornare database.</span><span class="sxs-lookup"><span data-stu-id="68b06-120">Query or update databases.</span></span>  
  
     <span data-ttu-id="68b06-121">Tramite Generatore query è possibile restituire dati eseguendo istruzioni Transact-SQL SELECT oppure creare query per l'aggiornamento, l'aggiunta o l'eliminazione di record in un database.</span><span class="sxs-lookup"><span data-stu-id="68b06-121">You can use Query Builder to return data using Transact-SQL SELECT statements, or to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="68b06-122">Visualizzare e modificare immediatamente i risultati.</span><span class="sxs-lookup"><span data-stu-id="68b06-122">View and edit results immediately.</span></span>  
  
     <span data-ttu-id="68b06-123">È possibile eseguire una query e utilizzare un recordset in una griglia che consente di scorrere e modificare i record del database.</span><span class="sxs-lookup"><span data-stu-id="68b06-123">You can execute your query and work with a recordset in a grid that lets you scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="68b06-124">Sebbene Generatore query consenta di creare solamente query SELECT in modo visivo, nel riquadro di testo è possibile digitare il codice SQL per altri tipi di istruzioni, ad esempio DELETE e UPDATE.</span><span class="sxs-lookup"><span data-stu-id="68b06-124">Although Query Builder is visually limited to creating SELECT queries, you can type the SQL for other types of statements such as DELETE and UPDATE statements in the text pane.</span></span> <span data-ttu-id="68b06-125">Il riquadro grafico viene aggiornato automaticamente in base all'istruzione SQL digitata.</span><span class="sxs-lookup"><span data-stu-id="68b06-125">The graphical pane is automatically updated to reflect the SQL statement that you typed.</span></span>  
  
 <span data-ttu-id="68b06-126">È inoltre possibile fornire input diretto digitando la query nella finestra di dialogo dell'attività o del componente del flusso di dati oppure nella finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="68b06-126">You can also provide direct input by typing the query in the task or data flow component dialog box or the Properties window.</span></span>  
  
 <span data-ttu-id="68b06-127">Per altre informazioni, vedere [Generatore di query](../../2014/integration-services/query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="68b06-127">For more information, see [Query Builder](../../2014/integration-services/query-builder.md).</span></span>  
  
## <a name="sql-in-files"></a><span data-ttu-id="68b06-128">SQL nei file</span><span class="sxs-lookup"><span data-stu-id="68b06-128">SQL in Files</span></span>  
 <span data-ttu-id="68b06-129">L'istruzione SQL dell'attività Esegui SQL può essere inclusa inoltre in un file distinto.</span><span class="sxs-lookup"><span data-stu-id="68b06-129">The SQL statement for the Execute SQL task can also reside in a separate file.</span></span> <span data-ttu-id="68b06-130">È possibile, ad esempio, scrivere query utilizzando strumenti quali l'editor di query in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], salvare la query in un file e quindi leggere la query dal file durante l'esecuzione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="68b06-130">For example, you can write queries using tools such as the Query Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], save the query to a file, and then read the query from the file when running a package.</span></span> <span data-ttu-id="68b06-131">Il file può contenere soltanto le istruzioni SQL da eseguire e commenti.</span><span class="sxs-lookup"><span data-stu-id="68b06-131">The file can contain only the SQL statements to run and comments.</span></span> <span data-ttu-id="68b06-132">Per eseguire un'istruzione SQL archiviata in un file, è necessario fornire una connessione file che specifica il nome e la posizione del file.</span><span class="sxs-lookup"><span data-stu-id="68b06-132">To use a SQL statement stored in a file, you must provide a file connection that specifies the file name and location.</span></span> <span data-ttu-id="68b06-133">Per altre informazioni, vedere [File Connection Manager](connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="68b06-133">For more information, see [File Connection Manager](connection-manager/file-connection-manager.md).</span></span>  
  
## <a name="sql-in-variables"></a><span data-ttu-id="68b06-134">SQL nelle variabili</span><span class="sxs-lookup"><span data-stu-id="68b06-134">SQL in Variables</span></span>  
 <span data-ttu-id="68b06-135">Se l'origine dell'istruzione SQL nell'attività Esegui SQL è una variabile, è necessario specificare il nome delle variabile contenente la query.</span><span class="sxs-lookup"><span data-stu-id="68b06-135">If the source of the SQL statement in the Execute SQL task is a variable, you provide the name of the variable that contains the query.</span></span> <span data-ttu-id="68b06-136">Il testo della query è specificato nella proprietà Value della variabile.</span><span class="sxs-lookup"><span data-stu-id="68b06-136">The Value property of the variable contains the query text.</span></span> <span data-ttu-id="68b06-137">È necessario impostare la proprietà ValueType della variabile su un tipo di dati string e quindi digitare o copiare l'istruzione SQL nella proprietà Value.</span><span class="sxs-lookup"><span data-stu-id="68b06-137">You set the ValueType property of the variable to a string data type and then type or copy the SQL statement into the Value property.</span></span> <span data-ttu-id="68b06-138">Per altre informazioni, vedere [Variabili di Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) e [Utilizzo di variabili nei pacchetti](../../2014/integration-services/use-variables-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="68b06-138">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [Use Variables in Packages](../../2014/integration-services/use-variables-in-packages.md).</span></span>  
  
  
