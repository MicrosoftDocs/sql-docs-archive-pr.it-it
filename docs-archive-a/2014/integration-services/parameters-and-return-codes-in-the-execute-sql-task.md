---
title: Parametri e codici restituiti nell'attività Esegui SQL | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- return codes [Integration Services]
- parameters [Integration Services]
- parameterized SQL statements [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: a3ca65e8-65cf-4272-9a81-765a706b8663
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cdc32e103642e086e81f6499bf56e5fbb71c3bd1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87636792"
---
# <a name="parameters-and-return-codes-in-the-execute-sql-task"></a><span data-ttu-id="e675b-102">Parametri e codici restituiti nell’attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="e675b-102">Parameters and Return Codes in the Execute SQL Task</span></span>
  <span data-ttu-id="e675b-103">Le stored procedure e le istruzioni SQL utilizzano spesso parametri di `input`, parametri di `output`e codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="e675b-103">SQL statements and stored procedures frequently use `input` parameters, `output` parameters, and return codes.</span></span> <span data-ttu-id="e675b-104">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] l'attività Esegui SQL supporta parametri di tipo `Input`, `Output` e `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="e675b-104">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="e675b-105">Il tipo `Input` viene utilizzato per i parametri di input, il tipo `Output` per i parametri di output e il tipo `ReturnValue` per i codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="e675b-105">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e675b-106">È possibile utilizzare parametri in un'attività Esegui SQL solo se il provider di dati li supporta.</span><span class="sxs-lookup"><span data-stu-id="e675b-106">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="e675b-107">Sui parametri inclusi nei comandi SQL, comprese le query e le stored procedure, viene eseguito il mapping a variabili definite dall'utente create nell'ambito dell'attività Esegui SQL, in un contenitore padre o nell'ambito del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="e675b-107">Parameters in SQL commands, including queries and stored procedures, are mapped to user-defined variables that are created within the scope of the Execute SQL task, a parent container, or within the scope of the package.</span></span> <span data-ttu-id="e675b-108">I valori delle variabili possono essere impostati in fase di progettazione o popolati dinamicamente in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e675b-108">The values of variables can be set at design time or populated dynamically at run time.</span></span> <span data-ttu-id="e675b-109">È inoltre possibile eseguire il mapping dei parametri a variabili di sistema.</span><span class="sxs-lookup"><span data-stu-id="e675b-109">You can also map parameters to system variables.</span></span> <span data-ttu-id="e675b-110">Per altre informazioni, vedere [Variabili di Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) e [Variabili di sistema](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="e675b-110">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="e675b-111">Tuttavia, l'utilizzo di parametri e di codici restituiti in un'attività Esegui SQL non si limita solo alla conoscenza dei tipi di parametro supportati dall'attività e del modo in cui si esegue il mapping di questi parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-111">However, working with parameters and return codes in an Execute SQL task is more than just knowing what parameter types the task supports and how these parameters will be mapped.</span></span> <span data-ttu-id="e675b-112">Sono previsti ulteriori requisiti e linee guida per utilizzare correttamente i parametri e i codici restituiti nell'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-112">There are additional usage requirements and guidelines to successfully use parameters and return codes in the Execute SQL task.</span></span> <span data-ttu-id="e675b-113">Nella parte restante di questo argomento vengono illustrati tali requisiti e linee guida:</span><span class="sxs-lookup"><span data-stu-id="e675b-113">The remainder of this topic covers these usage requirements and guidelines:</span></span>  
  
-   [<span data-ttu-id="e675b-114">Uso di nomi e marcatori di parametro</span><span class="sxs-lookup"><span data-stu-id="e675b-114">Using parameters names and markers</span></span>](#Parameter_names_and_markers)  
  
-   [<span data-ttu-id="e675b-115">Uso di parametri con i tipi di dati di data e ora</span><span class="sxs-lookup"><span data-stu-id="e675b-115">Using parameters with date and time data types</span></span>](#Date_and_time_data_types)  
  
-   [<span data-ttu-id="e675b-116">Uso di parametri nelle clausole WHERE</span><span class="sxs-lookup"><span data-stu-id="e675b-116">Using parameters in WHERE clauses</span></span>](#WHERE_clauses)  
  
-   [<span data-ttu-id="e675b-117">Uso di parametri con le stored procedure</span><span class="sxs-lookup"><span data-stu-id="e675b-117">Using parameters with stored procedures</span></span>](#Stored_procedures)  
  
-   [<span data-ttu-id="e675b-118">Recupero dei valori dei codici restituiti</span><span class="sxs-lookup"><span data-stu-id="e675b-118">Getting values of return codes</span></span>](#Return_codes)  
  
-   [<span data-ttu-id="e675b-119">Configurazione di parametri e di codici restituiti nell'editor attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="e675b-119">Configuring parameters and return codes in the Execute SQL Task Editor</span></span>](#Configure_parameters_and_return_codes)  
  
##  <a name="using-parameter-names-and-markers"></a><a name="Parameter_names_and_markers"></a><span data-ttu-id="e675b-120">Uso di nomi e marcatori di parametro</span><span class="sxs-lookup"><span data-stu-id="e675b-120">Using Parameter Names and Markers</span></span>  
 <span data-ttu-id="e675b-121">Nella sintassi del comando SQL possono essere utilizzati marcatori di parametro diversi, a seconda del tipo di connessione utilizzato dall'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-121">Depending on the connection type that the Execute SQL task uses, the syntax of the SQL command uses different parameter markers.</span></span> <span data-ttu-id="e675b-122">Per il tipo di gestione connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)], ad esempio, l'indicatore di parametro usato nel comando SQL deve avere il formato **\@varParameter**, mentre per il tipo di connessione OLE DB l'indicatore di parametro deve essere costituito da un punto interrogativo (?).</span><span class="sxs-lookup"><span data-stu-id="e675b-122">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type requires that the SQL command uses a parameter marker in the format **\@varParameter**, whereas OLE DB connection type requires the question mark (?) parameter marker.</span></span>  
  
 <span data-ttu-id="e675b-123">Anche i nomi che è possibile utilizzare come nomi di parametro nei mapping tra variabili e parametri variano a seconda del tipo di gestione connessione.</span><span class="sxs-lookup"><span data-stu-id="e675b-123">The names that you can use as parameter names in the mappings between variables and parameters also vary by connection manager type.</span></span> <span data-ttu-id="e675b-124">Il tipo di gestione connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)] usa ad esempio un nome definito dall'utente con prefisso \@, mentre il tipo di gestione connessione OLE DB richiede nomi di parametro costituiti dal valore numerico di un ordinale in base 0.</span><span class="sxs-lookup"><span data-stu-id="e675b-124">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type uses a user-defined name with a \@ prefix, whereas the OLE DB connection manager type requires that you use the numeric value of a 0-based ordinal as the parameter name.</span></span>  
  
 <span data-ttu-id="e675b-125">Nella tabella seguente sono riepilogati i requisiti dei comandi SQL, a seconda dei tipi di gestione connessione utilizzati dall'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-125">The following table summarizes the requirements for SQL commands for the connection manager types that the Execute SQL task can use.</span></span>  
  
|<span data-ttu-id="e675b-126">Tipo di connessione</span><span class="sxs-lookup"><span data-stu-id="e675b-126">Connection type</span></span>|<span data-ttu-id="e675b-127">Marcatore di parametro</span><span class="sxs-lookup"><span data-stu-id="e675b-127">Parameter marker</span></span>|<span data-ttu-id="e675b-128">Nome parametro</span><span class="sxs-lookup"><span data-stu-id="e675b-128">Parameter name</span></span>|<span data-ttu-id="e675b-129">Comando SQL di esempio</span><span class="sxs-lookup"><span data-stu-id="e675b-129">Example SQL command</span></span>|  
|---------------------|----------------------|--------------------|-------------------------|  
|<span data-ttu-id="e675b-130">ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-130">ADO</span></span>|<span data-ttu-id="e675b-131">?</span><span class="sxs-lookup"><span data-stu-id="e675b-131">?</span></span>|<span data-ttu-id="e675b-132">Param1, Param2, ...</span><span class="sxs-lookup"><span data-stu-id="e675b-132">Param1, Param2, ...</span></span>|<span data-ttu-id="e675b-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="e675b-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|\@\<parameter name>|\@\<parameter name>|<span data-ttu-id="e675b-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span><span class="sxs-lookup"><span data-stu-id="e675b-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span></span>|  
|<span data-ttu-id="e675b-135">ODBC</span><span class="sxs-lookup"><span data-stu-id="e675b-135">ODBC</span></span>|<span data-ttu-id="e675b-136">?</span><span class="sxs-lookup"><span data-stu-id="e675b-136">?</span></span>|<span data-ttu-id="e675b-137">1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="e675b-137">1, 2, 3, ...</span></span>|<span data-ttu-id="e675b-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="e675b-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|<span data-ttu-id="e675b-139">EXCEL e OLE DB</span><span class="sxs-lookup"><span data-stu-id="e675b-139">EXCEL and OLE DB</span></span>|<span data-ttu-id="e675b-140">?</span><span class="sxs-lookup"><span data-stu-id="e675b-140">?</span></span>|<span data-ttu-id="e675b-141">0, 1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="e675b-141">0, 1, 2, 3, ...</span></span>|<span data-ttu-id="e675b-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="e675b-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
  
### <a name="using-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="e675b-143">Utilizzo di parametri con le gestioni connessioni ADO.NET e ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-143">Using Parameters with ADO.NET and ADO Connection Managers</span></span>  
 [!INCLUDE[vstecado](../includes/vstecado-md.md)] <span data-ttu-id="e675b-144">e le gestioni connessioni ADO hanno requisiti specifici per i comandi SQL che usano parametri:</span><span class="sxs-lookup"><span data-stu-id="e675b-144">and ADO connection managers have specific requirements for SQL commands that use parameters:</span></span>  
  
-   <span data-ttu-id="e675b-145">Le gestioni connessioni [!INCLUDE[vstecado](../includes/vstecado-md.md)] richiedono che il comando SQL usi nomi di parametro come indicatori di parametro.</span><span class="sxs-lookup"><span data-stu-id="e675b-145">[!INCLUDE[vstecado](../includes/vstecado-md.md)] connection managers require that the SQL command use parameter names as parameter markers.</span></span> <span data-ttu-id="e675b-146">È pertanto possibile eseguire il mapping direttamente delle variabili ai parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-146">This means that variables can be mapped directly to parameters.</span></span> <span data-ttu-id="e675b-147">Se ad esempio sulla variabile `@varName` viene eseguito il mapping a un parametro di nome `@parName` , fornirà il valore per il parametro `@parName`.</span><span class="sxs-lookup"><span data-stu-id="e675b-147">For example, the variable `@varName` is mapped to the parameter named `@parName` and provides a value to the parameter `@parName`.</span></span>  
  
-   <span data-ttu-id="e675b-148">Per le gestioni connessioni ADO, è necessario che il comando SQL utilizzi punti interrogativi (?) come marcatori di parametro.</span><span class="sxs-lookup"><span data-stu-id="e675b-148">ADO connection managers require that the SQL command use question marks (?) as parameter markers.</span></span> <span data-ttu-id="e675b-149">Tuttavia, come nomi di parametro è possibile utilizzare qualsiasi nome definito dall'utente, ad eccezione dei valori interi.</span><span class="sxs-lookup"><span data-stu-id="e675b-149">However, you can use any user-defined name, except for integer values, as parameter names.</span></span>  
  
 <span data-ttu-id="e675b-150">Per fornire i valori ai parametri sulle variabili viene eseguito il mapping ai nomi di parametro.</span><span class="sxs-lookup"><span data-stu-id="e675b-150">To provide values to parameters, variables are mapped to parameter names.</span></span> <span data-ttu-id="e675b-151">L'attività Esegui SQL utilizza quindi il valore ordinale del nome di parametro nell'elenco dei parametri per caricare i valori dalle variabili ai parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-151">Then, the Execute SQL task uses the ordinal value of the parameter name in the parameter list to load values from variables to parameters.</span></span>  
  
### <a name="using-parameters-with-excel-odbc-and-ole-db-connection-managers"></a><span data-ttu-id="e675b-152">Utilizzo di parametri con le gestioni connessioni EXCEL, ODBC e OLE DB</span><span class="sxs-lookup"><span data-stu-id="e675b-152">Using Parameters with EXCEL, ODBC, and OLE DB Connection Managers</span></span>  
 <span data-ttu-id="e675b-153">Per le gestioni connessioni EXCEL, ODBC e OLE DB, è necessario che il comando SQL utilizzi punti interrogativi (?) come marcatori di parametro e valori numerici in base 0 o in base 1 come nomi di parametro.</span><span class="sxs-lookup"><span data-stu-id="e675b-153">EXCEL, ODBC, and OLE DB connection managers require that the SQL command use question marks (?) as parameter markers and 0-based or 1-based numeric values as parameter names.</span></span> <span data-ttu-id="e675b-154">Se l'attività Esegui SQL utilizza la gestione connessione ODBC, il nome del parametro di cui viene eseguito il mapping al primo parametro nella query è 1, altrimenti è 0.</span><span class="sxs-lookup"><span data-stu-id="e675b-154">If the Execute SQL task uses the ODBC connection manager, the parameter name that maps to the first parameter in the query is named 1; otherwise, the parameter is named 0.</span></span> <span data-ttu-id="e675b-155">Per i parametri successivi, il valore numerico del nome del parametro indica il parametro del comando SQL a cui viene eseguito il mapping del nome di parametro.</span><span class="sxs-lookup"><span data-stu-id="e675b-155">For subsequent parameters, the numeric value of the parameter name indicates the parameter in the SQL command that the parameter name maps to.</span></span> <span data-ttu-id="e675b-156">Sul parametro di nome 3, ad esempio, viene eseguito il mapping al terzo parametro, rappresentato dal terzo punto interrogativo (?) nel comando SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-156">For example, the parameter named 3 maps to the third parameter, which is represented by the third question mark (?) in the SQL command.</span></span>  
  
 <span data-ttu-id="e675b-157">Per fornire i valori ai parametri, sulle variabili viene eseguito il mapping ai nomi di parametro e l'attività Esegui SQL utilizza il valore ordinale del nome di parametro per caricare i valori dalle variabili ai parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-157">To provide values to parameters, variables are mapped to parameter names and the Execute SQL task uses the ordinal value of the parameter name to load values from variables to parameters.</span></span>  
  
 <span data-ttu-id="e675b-158">A seconda del provider utilizzato dalla gestione connessione, alcuni tipi di dati OLE DB potrebbero non essere supportati.</span><span class="sxs-lookup"><span data-stu-id="e675b-158">Depending on the provider that the connection manager uses, some OLE DB data types may not be supported.</span></span> <span data-ttu-id="e675b-159">Il driver per Excel, ad esempio, riconosce solo un set limitato di tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="e675b-159">For example, the Excel driver recognizes only a limited set of data types.</span></span> <span data-ttu-id="e675b-160">Per altre informazioni sul comportamento del provider Jet usato insieme al driver per Excel, vedere [Origine Excel](data-flow/excel-source.md).</span><span class="sxs-lookup"><span data-stu-id="e675b-160">For more information about the behavior of the Jet provider with the Excel driver, see [Excel Source](data-flow/excel-source.md).</span></span>  
  
#### <a name="using-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="e675b-161">Utilizzo di parametri con le gestioni connessioni OLE DB</span><span class="sxs-lookup"><span data-stu-id="e675b-161">Using Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="e675b-162">Quando l'attività Esegui SQL usa la gestione connessione OLE DB, è disponibile la proprietà BypassPrepare dell'attività.</span><span class="sxs-lookup"><span data-stu-id="e675b-162">When the Execute SQL task uses the OLE DB connection manager, the BypassPrepare property of the task is available.</span></span> <span data-ttu-id="e675b-163">Questa proprietà deve essere impostata su `true` se l'attività Esegui SQL utilizza istruzioni SQL con parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-163">You should set this property to `true` if the Execute SQL task uses SQL statements with parameters.</span></span>  
  
 <span data-ttu-id="e675b-164">Quando si utilizza una gestione connessione OLE DB, non è possibile utilizzare sottoquery con parametri, perché l'attività Esegui SQL non può derivare le informazioni sui parametri tramite il provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="e675b-164">When you use an OLE DB connection manager, you cannot use parameterized subqueries because the Execute SQL Task cannot derive parameter information through the OLE DB provider.</span></span> <span data-ttu-id="e675b-165">Tuttavia, è possibile utilizzare un'espressione per concatenare i valori dei parametri nella stringa di query e impostare la proprietà SqlStatementSource dell'attività.</span><span class="sxs-lookup"><span data-stu-id="e675b-165">However, you can use an expression to concatenate the parameter values into the query string and to set the SqlStatementSource property of the task.</span></span>  
  
##  <a name="using-parameters-with-date-and-time-data-types"></a><a name="Date_and_time_data_types"></a><span data-ttu-id="e675b-166">Utilizzo di parametri con i tipi di dati di data e ora</span><span class="sxs-lookup"><span data-stu-id="e675b-166">Using Parameters with Date and Time Data Types</span></span>  
  
### <a name="using-date-and-time-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="e675b-167">Utilizzo di parametri di data e ora con le gestioni connessioni ADO.NET e ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-167">Using Date and Time Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="e675b-168">Durante la lettura dei tipi di dati di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `time` e `datetimeoffset`, un'attività Esegui SQL che utilizza una gestione connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)] o ADO prevede i requisiti aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e675b-168">When reading data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] types, `time` and `datetimeoffset`, an Execute SQL task that uses either an [!INCLUDE[vstecado](../includes/vstecado-md.md)] or ADO connection manager has the following additional requirements:</span></span>  
  
-   <span data-ttu-id="e675b-169">Per i dati `time`, una gestione connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)] richiede che i dati vengano archiviati in un parametro con tipo di parametro `Input` o `Output` e con tipo di dati `string`.</span><span class="sxs-lookup"><span data-stu-id="e675b-169">For `time` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `string`.</span></span>  
  
-   <span data-ttu-id="e675b-170">Per i dati `datetimeoffset`, una gestione connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)] richiede che i dati vengano archiviati in uno dei parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="e675b-170">For `datetimeoffset` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="e675b-171">Un parametro il cui tipo di parametro è `Input` e il cui tipo di dati è `string`.</span><span class="sxs-lookup"><span data-stu-id="e675b-171">A parameter whose parameter type is `Input` and whose data type is `string`.</span></span>  
  
    -   <span data-ttu-id="e675b-172">Un parametro il cui tipo di parametro è `Output` o `ReturnValue` e il cui tipo di dati è `datetimeoffset`, `string` o `datetime2`.</span><span class="sxs-lookup"><span data-stu-id="e675b-172">A parameter whose parameter type is `Output` or `ReturnValue`, and whose data type is `datetimeoffset`, `string`, or `datetime2`.</span></span> <span data-ttu-id="e675b-173">Se si seleziona un parametro il cui tipo di dati è `string` o `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] converte i dati in string o datetime2.</span><span class="sxs-lookup"><span data-stu-id="e675b-173">If you select a parameter whose data type is either `string` or `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] converts the data to either string or datetime2.</span></span>  
  
-   <span data-ttu-id="e675b-174">Una gestione connessione ADO richiede che i dati `time` o `datetimeoffset` vengano archiviati in un parametro con tipo di parametro `Input` o `Output` e con tipo di dati `adVarWchar`.</span><span class="sxs-lookup"><span data-stu-id="e675b-174">An ADO connection manager requires that either `time` or `datetimeoffset` data be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `adVarWchar`.</span></span>  
  
 <span data-ttu-id="e675b-175">Per altre informazioni sui tipi di dati [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e sul relativo mapping nei tipi di dati [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], vedere [Tipi di dati &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) e [Tipi di dati di Integration Services](data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="e675b-175">For more information about [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types and how they map to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) and [Integration Services Data Types](data-flow/integration-services-data-types.md).</span></span>  
  
### <a name="using-date-and-time-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="e675b-176">Utilizzo di parametri di data e ora con le gestioni connessioni OLE DB</span><span class="sxs-lookup"><span data-stu-id="e675b-176">Using Date and Time Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="e675b-177">Quando si utilizza una gestione connessione OLE DB, un'attività Esegui SQL prevede requisiti di archiviazione specifici per i tipi di dati di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `date`, `time`, `datetime`, `datetime2` e `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="e675b-177">When using an OLE DB connection manager, an Execute SQL task has specific storage requirements for data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, and `datetimeoffset`.</span></span> <span data-ttu-id="e675b-178">È necessario archiviare questi dati in uno dei seguenti tipi di parametro:</span><span class="sxs-lookup"><span data-stu-id="e675b-178">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="e675b-179">Un parametro di input del tipo di dati NVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="e675b-179">An input parameter of the NVARCHAR data type.</span></span>  
  
-   <span data-ttu-id="e675b-180">Un parametro di output con il tipo di dati appropriato, come elencato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e675b-180">An output parameter of with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="e675b-181">Tipo di parametro `Output`</span><span class="sxs-lookup"><span data-stu-id="e675b-181">`Output` parameter type</span></span>|<span data-ttu-id="e675b-182">Tipo di dati date</span><span class="sxs-lookup"><span data-stu-id="e675b-182">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="e675b-183">DBDATE</span><span class="sxs-lookup"><span data-stu-id="e675b-183">DBDATE</span></span>|`date`|  
    |<span data-ttu-id="e675b-184">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="e675b-184">DBTIME2</span></span>|`time`|  
    |<span data-ttu-id="e675b-185">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e675b-185">DBTIMESTAMP</span></span>|<span data-ttu-id="e675b-186">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="e675b-186">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="e675b-187">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e675b-187">DBTIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="e675b-188">Se i dati non vengono archiviati nel parametro di input o di output appropriato, il pacchetto non viene eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="e675b-188">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
### <a name="using-date-and-time-parameters-with-odbc-connection-managers"></a><span data-ttu-id="e675b-189">Utilizzo di parametri di data e ora con le gestioni connessioni ODBC</span><span class="sxs-lookup"><span data-stu-id="e675b-189">Using Date and Time Parameters with ODBC Connection Managers</span></span>  
 <span data-ttu-id="e675b-190">Quando si utilizza una gestione connessione ODBC, un'attività Esegui SQL prevede requisiti di archiviazione specifici per i tipi di dati di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `date`, `time`, `datetime`, `datetime2` e `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="e675b-190">When using an ODBC connection manager, an Execute SQL task has specific storage requirements for data with one of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, or `datetimeoffset`.</span></span> <span data-ttu-id="e675b-191">È necessario archiviare questi dati in uno dei seguenti tipi di parametro:</span><span class="sxs-lookup"><span data-stu-id="e675b-191">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="e675b-192">Un parametro di `input` del tipo di dati SQL_WVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="e675b-192">An `input` parameter of the SQL_WVARCHAR data type</span></span>  
  
-   <span data-ttu-id="e675b-193">Un parametro di `output` con il tipo di dati appropriato, come elencato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="e675b-193">An `output` parameter with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="e675b-194">Tipo di parametro `Output`</span><span class="sxs-lookup"><span data-stu-id="e675b-194">`Output` parameter type</span></span>|<span data-ttu-id="e675b-195">Tipo di dati date</span><span class="sxs-lookup"><span data-stu-id="e675b-195">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="e675b-196">SQL_DATE</span><span class="sxs-lookup"><span data-stu-id="e675b-196">SQL_DATE</span></span>|`date`|  
    |<span data-ttu-id="e675b-197">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e675b-197">SQL_SS_TIME2</span></span>|`time`|  
    |<span data-ttu-id="e675b-198">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e675b-198">SQL_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="e675b-199">-oppure-</span><span class="sxs-lookup"><span data-stu-id="e675b-199">-or-</span></span><br /><br /> <span data-ttu-id="e675b-200">SQL_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e675b-200">SQL_TIMESTAMP</span></span>|<span data-ttu-id="e675b-201">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="e675b-201">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="e675b-202">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e675b-202">SQL_SS_TIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="e675b-203">Se i dati non vengono archiviati nel parametro di input o di output appropriato, il pacchetto non viene eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="e675b-203">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
##  <a name="using-parameters-in-where-clauses"></a><a name="WHERE_clauses"></a><span data-ttu-id="e675b-204">Utilizzo di parametri nelle clausole WHERE</span><span class="sxs-lookup"><span data-stu-id="e675b-204">Using Parameters in WHERE Clauses</span></span>  
 <span data-ttu-id="e675b-205">I comandi SELECT, INSERT, UPDATE e DELETE includono spesso la clausola WHERE per specificare filtri che definiscono le condizioni che ogni riga nelle tabelle di origine deve soddisfare per essere qualificata per un comando SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-205">SELECT, INSERT, UPDATE, and DELETE commands frequently include WHERE clauses to specify filters that define the conditions each row in the source tables must meet to qualify for an SQL command.</span></span> <span data-ttu-id="e675b-206">I parametri specificano i valori del filtro per la clausola WHERE.</span><span class="sxs-lookup"><span data-stu-id="e675b-206">Parameters provide the filter values in the WHERE clauses.</span></span>  
  
 <span data-ttu-id="e675b-207">È possibile utilizzare marcatori di parametro per specificare dinamicamente i valori dei parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-207">You can use parameter markers to dynamically provide parameter values.</span></span> <span data-ttu-id="e675b-208">Le regole che determinano se è possibile utilizzare marcatori di parametro e nomi di parametro in un'istruzione SQL dipendono dal tipo di gestione connessione utilizzato dall'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-208">The rules for which parameter markers and parameter names can be used in the SQL statement depend on the type of connection manager that the Execute SQL uses.</span></span>  
  
 <span data-ttu-id="e675b-209">Nella tabella seguente sono elencati esempi di comandi SELECT per tipo di gestione connessione.</span><span class="sxs-lookup"><span data-stu-id="e675b-209">The following table lists examples of the SELECT command by connection manager type.</span></span> <span data-ttu-id="e675b-210">Le istruzioni INSERT, UPDATE e DELETE sono analoghe.</span><span class="sxs-lookup"><span data-stu-id="e675b-210">The INSERT, UPDATE, and DELETE statements are similar.</span></span> <span data-ttu-id="e675b-211">Negli esempi l'istruzione SELECT viene usata per recuperare dalla tabella **Product** del database [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] i prodotti con **ProductID** compreso tra i valori specificati da due parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-211">The examples use SELECT to return products from the **Product** table in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] that have a **ProductID** greater than and less than the values specified by two parameters.</span></span>  
  
|<span data-ttu-id="e675b-212">Tipo di connessione</span><span class="sxs-lookup"><span data-stu-id="e675b-212">Connection type</span></span>|<span data-ttu-id="e675b-213">Sintassi dell'istruzione SELECT</span><span class="sxs-lookup"><span data-stu-id="e675b-213">SELECT syntax</span></span>|  
|---------------------|-------------------|  
|<span data-ttu-id="e675b-214">EXCEL, ODBC e OLEDB</span><span class="sxs-lookup"><span data-stu-id="e675b-214">EXCEL, ODBC, and OLEDB</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|<span data-ttu-id="e675b-215">ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-215">ADO</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|`SELECT* FROM Production.Product WHERE ProductId > @parmMinProductID AND ProductID < @parmMaxProductID`|  
  
 <span data-ttu-id="e675b-216">Gli esempi richiedono parametri con i nomi seguenti:</span><span class="sxs-lookup"><span data-stu-id="e675b-216">The examples would require parameters that have the following names:</span></span>  
  
-   <span data-ttu-id="e675b-217">Per le gestioni connessioni EXCEL e OLED DB vengono utilizzati i nomi di parametro 0 e 1.</span><span class="sxs-lookup"><span data-stu-id="e675b-217">The EXCEL and OLED DB connection managers use the parameter names 0 and 1.</span></span> <span data-ttu-id="e675b-218">Per il tipo di connessione ODBC vengono utilizzati 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="e675b-218">The ODBC connection type uses 1 and 2.</span></span>  
  
-   <span data-ttu-id="e675b-219">Per il tipo di connessione ADO è possibile utilizzare qualsiasi nome per i due parametri, ad esempio Param1 e Param2, ma è necessario eseguire il mapping di entrambi i parametri in base alla relativa posizione ordinale nell'elenco di parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-219">The ADO connection type could use any two parameter names, such as Param1 and Param2, but the parameters must be mapped by their ordinal position in the parameter list.</span></span>  
  
-   <span data-ttu-id="e675b-220">Per il tipo di connessione [!INCLUDE[vstecado](../includes/vstecado-md.md)] vengono usati i nomi di parametro \@parmMinProductID e \@parmMaxProductID.</span><span class="sxs-lookup"><span data-stu-id="e675b-220">The [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection type uses the parameter names \@parmMinProductID and \@parmMaxProductID.</span></span>  
  
##  <a name="using-parameters-with-stored-procedures"></a><a name="Stored_procedures"></a><span data-ttu-id="e675b-221">Utilizzo di parametri con stored procedure</span><span class="sxs-lookup"><span data-stu-id="e675b-221">Using Parameters with Stored Procedures</span></span>  
 <span data-ttu-id="e675b-222">Anche i comandi SQL che eseguono stored procedure possono utilizzare il mapping dei parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-222">SQL commands that run stored procedures can also use parameter mapping.</span></span> <span data-ttu-id="e675b-223">Come avviene per le regole delle query con parametri, anche le regole che determinano la modalità di utilizzo di marcatori di parametro e nomi di parametro dipendono dal tipo di gestione connessione utilizzato dall'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="e675b-223">The rules for how to use parameter markers and parameter names depends on the type of connection manager that the Execute SQL uses, just like the rules for parameterized queries.</span></span>  
  
 <span data-ttu-id="e675b-224">Nella tabella seguente sono elencati esempi di comandi EXEC per tipo di gestione connessione.</span><span class="sxs-lookup"><span data-stu-id="e675b-224">The following table lists examples of the EXEC command by connection manager type.</span></span> <span data-ttu-id="e675b-225">Gli esempi eseguono la stored procedure **uspGetBillOfMaterials** nel database [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e675b-225">The examples run the **uspGetBillOfMaterials** stored procedure in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span></span> <span data-ttu-id="e675b-226">Il stored procedure usa i `@StartProductID` `@CheckDate` `input` parametri e.</span><span class="sxs-lookup"><span data-stu-id="e675b-226">The stored procedure uses the `@StartProductID` and `@CheckDate` `input` parameters.</span></span>  
  
|<span data-ttu-id="e675b-227">Tipo di connessione</span><span class="sxs-lookup"><span data-stu-id="e675b-227">Connection type</span></span>|<span data-ttu-id="e675b-228">Sintassi dell'istruzione EXEC</span><span class="sxs-lookup"><span data-stu-id="e675b-228">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="e675b-229">EXCEL e OLEDB</span><span class="sxs-lookup"><span data-stu-id="e675b-229">EXCEL and OLEDB</span></span>|`EXEC uspGetBillOfMaterials ?, ?`|  
|<span data-ttu-id="e675b-230">ODBC</span><span class="sxs-lookup"><span data-stu-id="e675b-230">ODBC</span></span>|`{call uspGetBillOfMaterials(?, ?)}`<br /><br /> <span data-ttu-id="e675b-231">Per altre informazioni sulla sintassi ODBC, vedere l'argomento [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462)(Parametri di procedura) nella guida di riferimento per programmatori ODBC in MSDN Library.</span><span class="sxs-lookup"><span data-stu-id="e675b-231">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="e675b-232">ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-232">ADO</span></span>|<span data-ttu-id="e675b-233">Se IsQueryStoredProcedure è impostato su `False` ,`EXEC uspGetBillOfMaterials ?, ?`</span><span class="sxs-lookup"><span data-stu-id="e675b-233">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials ?, ?`</span></span><br /><br /> <span data-ttu-id="e675b-234">Se IsQueryStoredProcedure è impostato su `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="e675b-234">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="e675b-235">Se IsQueryStoredProcedure è impostato su `False` ,`EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span><span class="sxs-lookup"><span data-stu-id="e675b-235">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span></span><br /><br /> <span data-ttu-id="e675b-236">Se IsQueryStoredProcedure è impostato su `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="e675b-236">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
  
 <span data-ttu-id="e675b-237">La sintassi per l'utilizzo dei parametri di output richiede che dopo ogni marcatore di parametro venga specificata la parola chiave OUTPUT.</span><span class="sxs-lookup"><span data-stu-id="e675b-237">To use output parameters, the syntax requires that the OUTPUT keyword follow each parameter marker.</span></span> <span data-ttu-id="e675b-238">Ad esempio, la sintassi del parametro di output seguente è corretta: `EXEC myStoredProcedure ? OUTPUT`.</span><span class="sxs-lookup"><span data-stu-id="e675b-238">For example, the following output parameter syntax is correct: `EXEC myStoredProcedure ? OUTPUT`.</span></span>  
  
 <span data-ttu-id="e675b-239">Per altre informazioni sull'utilizzo di parametri di input e di output con le stored procedure Transact-SQL, vedere [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e675b-239">For more information about using input and output parameters with Transact-SQL stored procedures, see [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span></span>  
  
##  <a name="getting-values-of-return-codes"></a><a name="Return_codes"></a><span data-ttu-id="e675b-240">Recupero dei valori dei codici restituiti</span><span class="sxs-lookup"><span data-stu-id="e675b-240">Getting Values of Return Codes</span></span>  
 <span data-ttu-id="e675b-241">Una stored procedure può restituire un valore intero, denominato codice restituito, per indicare lo stato di esecuzione di una procedura.</span><span class="sxs-lookup"><span data-stu-id="e675b-241">A stored procedure can return an integer value, called a return code, to indicate the execution status of a procedure.</span></span> <span data-ttu-id="e675b-242">Per implementare codici restituiti nell'attività Esegui SQL, è necessario utilizzare parametri di tipo `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="e675b-242">To implement return codes in the Execute SQL task, you use parameters of the `ReturnValue` type.</span></span>  
  
 <span data-ttu-id="e675b-243">Nella tabella seguente sono elencati, per tipo di gestione connessione, esempi di comandi EXEC che implementano codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="e675b-243">The following table lists by connection type some examples of EXEC commands that implement return codes.</span></span> <span data-ttu-id="e675b-244">In tutti gli esempi viene utilizzato un parametro di `input`.</span><span class="sxs-lookup"><span data-stu-id="e675b-244">All examples use an `input` parameter.</span></span> <span data-ttu-id="e675b-245">Le regole per la modalità di utilizzo di marcatori di parametro e nomi di parametro sono le stesse per tutti i tipi di parametro `Input` , `Output` , e `ReturnValue` .</span><span class="sxs-lookup"><span data-stu-id="e675b-245">The rules for how to use parameter markers and parameter names are the same for all parameter types-`Input`, `Output`, and `ReturnValue`.</span></span>  
  
 <span data-ttu-id="e675b-246">In alcune sintassi non è supportato l'utilizzo di valori letterali come parametri.</span><span class="sxs-lookup"><span data-stu-id="e675b-246">Some syntax does not support parameter literals.</span></span> <span data-ttu-id="e675b-247">In tali casi è necessario specificare il valore del parametro utilizzando una variabile.</span><span class="sxs-lookup"><span data-stu-id="e675b-247">In that case, you must provide the parameter value by using a variable.</span></span>  
  
|<span data-ttu-id="e675b-248">Tipo di connessione</span><span class="sxs-lookup"><span data-stu-id="e675b-248">Connection type</span></span>|<span data-ttu-id="e675b-249">Sintassi dell'istruzione EXEC</span><span class="sxs-lookup"><span data-stu-id="e675b-249">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="e675b-250">EXCEL e OLEDB</span><span class="sxs-lookup"><span data-stu-id="e675b-250">EXCEL and OLEDB</span></span>|`EXEC ? = myStoredProcedure 1`|  
|<span data-ttu-id="e675b-251">ODBC</span><span class="sxs-lookup"><span data-stu-id="e675b-251">ODBC</span></span>|`{? = call myStoredProcedure(1)}`<br /><br /> <span data-ttu-id="e675b-252">Per altre informazioni sulla sintassi ODBC, vedere l'argomento [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462)(Parametri di procedura) nella guida di riferimento per programmatori ODBC in MSDN Library.</span><span class="sxs-lookup"><span data-stu-id="e675b-252">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="e675b-253">ADO</span><span class="sxs-lookup"><span data-stu-id="e675b-253">ADO</span></span>|<span data-ttu-id="e675b-254">Se IsQueryStoreProcedure ha valore è impostato su `False` ,`EXEC ? = myStoredProcedure 1`</span><span class="sxs-lookup"><span data-stu-id="e675b-254">If IsQueryStoreProcedure is set to `False`, `EXEC ? = myStoredProcedure 1`</span></span><br /><br /> <span data-ttu-id="e675b-255">Se IsQueryStoreProcedure ha valore è impostato su `True` ,`myStoredProcedure`</span><span class="sxs-lookup"><span data-stu-id="e675b-255">If IsQueryStoreProcedure is set to `True`, `myStoredProcedure`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="e675b-256">Set IsQueryStoreProcedure ha valore è impostato su `True` .</span><span class="sxs-lookup"><span data-stu-id="e675b-256">Set IsQueryStoreProcedure is set to `True`.</span></span><br /><br /> `myStoredProcedure`|  
  
 <span data-ttu-id="e675b-257">Nella sintassi illustrata nella tabella precedente, l'attività Esegui SQL usa il tipo di origine **Input diretto** per eseguire la stored procedure.</span><span class="sxs-lookup"><span data-stu-id="e675b-257">In the syntax shown in the previous table, the Execute SQL task uses the **Direct Input** source type to run the stored procedure.</span></span> <span data-ttu-id="e675b-258">L'attività Esegui SQL può usare anche il tipo di origine **Connessione file** per eseguire una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="e675b-258">The Execute SQL task can also use the **File Connection** source type to run a stored procedure.</span></span> <span data-ttu-id="e675b-259">Indipendentemente dal fatto che l'attività Esegui SQL utilizzi il tipo di origine di **input diretto** o **connessione file** , usare un parametro del `ReturnValue` tipo per implementare il codice restituito.</span><span class="sxs-lookup"><span data-stu-id="e675b-259">Regardless of whether the Execute SQL task uses the **Direct Input** or **File Connection** source type, use a parameter of the `ReturnValue` type to implement the return code.</span></span> <span data-ttu-id="e675b-260">Per altre informazioni sulla configurazione del tipo di origine dell'istruzione SQL eseguita dall'attività Esegui SQL, vedere [Editor attività Esegui SQL &#40;pagina Generale&#41;](general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="e675b-260">For more information about how to configure the source type of the SQL statement that the Execute SQL task runs, see [Execute SQL Task Editor &#40;General Page&#41;](general-page-of-integration-services-designers-options.md).</span></span>  
  
 <span data-ttu-id="e675b-261">Per altre informazioni sull'utilizzo di codici restituiti con le stored procedure Transact-SQL, vedere [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e675b-261">For more information about using return codes with Transact-SQL stored procedures, see [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span></span>  
  
##  <a name="configuring-parameters-and-return-codes-in-the-execute-sql-task"></a><a name="Configure_parameters_and_return_codes"></a><span data-ttu-id="e675b-262">Configurazione di parametri e codici restituiti nell'attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="e675b-262">Configuring Parameters and Return Codes in the Execute SQL Task</span></span>  
 <span data-ttu-id="e675b-263">Per altre informazioni sulle proprietà dei parametri e dei codici restituiti che è possibile impostare in Progettazione [!INCLUDE[ssIS](../includes/ssis-md.md)] , fare clic sull'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="e675b-263">For more information about the properties of parameters and return codes that you can set in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="e675b-264">Editor attività Esegui SQL &#40;pagina Mapping parametri&#41;</span><span class="sxs-lookup"><span data-stu-id="e675b-264">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../../2014/integration-services/execute-sql-task-editor-parameter-mapping-page.md)  
  
 <span data-ttu-id="e675b-265">Per altre informazioni sull'impostazione di queste proprietà in Progettazione [!INCLUDE[ssIS](../includes/ssis-md.md)] , fare clic sull'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="e675b-265">For more information about how to set these properties in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="e675b-266">Impostazione delle proprietà di un'attività o di un contenitore</span><span class="sxs-lookup"><span data-stu-id="e675b-266">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="e675b-267">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="e675b-267">Related Tasks</span></span>  
 [<span data-ttu-id="e675b-268">Impostazione delle proprietà di un'attività o di un contenitore</span><span class="sxs-lookup"><span data-stu-id="e675b-268">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-content"></a><span data-ttu-id="e675b-269">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="e675b-269">Related Content</span></span>  
  
-   <span data-ttu-id="e675b-270">Intervento nel blog relativo alle [stored procedure con parametri di output](https://go.microsoft.com/fwlink/?LinkId=157786)nel sito Web all'indirizzo blogs.msdn.com</span><span class="sxs-lookup"><span data-stu-id="e675b-270">Blog entry, [Stored procedures with output parameters](https://go.microsoft.com/fwlink/?LinkId=157786), on blogs.msdn.com</span></span>  
  
-   <span data-ttu-id="e675b-271">Esempio CodePlex sull' [esecuzione di parametri SQL e set di risultati](https://go.microsoft.com/fwlink/?LinkId=157863)sul sito Web msftisprodsamples.codeplex.com</span><span class="sxs-lookup"><span data-stu-id="e675b-271">CodePlex sample, [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863), on msftisprodsamples.codeplex.com</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e675b-272">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e675b-272">See Also</span></span>  
 <span data-ttu-id="e675b-273">[Attività Esegui SQL](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="e675b-273">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 [<span data-ttu-id="e675b-274">Set di risultati nell’attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="e675b-274">Result Sets in the Execute SQL Task</span></span>](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)  
  
  
