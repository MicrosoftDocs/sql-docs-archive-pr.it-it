---
title: Gestione connessione file flat | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- connection managers [Integration Services], Flat File
- connections [Integration Services], flat files
- files [Integration Services], connections
- Flat File connection manager
- flat files
- flat file connections [Integration Services]
ms.assetid: 7830f80d-af32-4e8f-a6fc-f03af6bc1946
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 961fa5ebd0c254c152cb4a84a855f719b6dfaa43
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722944"
---
# <a name="flat-file-connection-manager"></a><span data-ttu-id="637a1-102">Flat File Connection Manager</span><span class="sxs-lookup"><span data-stu-id="637a1-102">Flat File Connection Manager</span></span>
  <span data-ttu-id="637a1-103">Una gestione connessione file flat consente a un pacchetto di accedere ai dati contenuti in un file flat.</span><span class="sxs-lookup"><span data-stu-id="637a1-103">A Flat File connection manager enables a package to access data in a flat file.</span></span> <span data-ttu-id="637a1-104">L'origine e la destinazione del file flat possono ad esempio utilizzare gestioni connessioni file flat per estrarre e caricare dati.</span><span class="sxs-lookup"><span data-stu-id="637a1-104">For example, the Flat File source and destination can use Flat File connection managers to extract and load data.</span></span>  
  
 <span data-ttu-id="637a1-105">La gestione connessione file flat è in grado di accedere a un solo file.</span><span class="sxs-lookup"><span data-stu-id="637a1-105">The Flat File connection manager can access only one file.</span></span> <span data-ttu-id="637a1-106">Per fare riferimento a più file, al posto di una gestione connessione file flat utilizzare una gestione connessione per più file flat.</span><span class="sxs-lookup"><span data-stu-id="637a1-106">To reference multiple files, use a Multiple Flat Files connection manager instead of a Flat File connection manager.</span></span> <span data-ttu-id="637a1-107">Per ulteriori informazioni, vedere [Multiple Flat Files Connection Manager](multiple-flat-files-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="637a1-107">For more information, see [Multiple Flat Files Connection Manager](multiple-flat-files-connection-manager.md).</span></span>  
  
## <a name="column-length"></a><span data-ttu-id="637a1-108">Lunghezza di colonna</span><span class="sxs-lookup"><span data-stu-id="637a1-108">Column Length</span></span>  
 <span data-ttu-id="637a1-109">Per impostazione predefinita la gestione connessione file flat imposta la lunghezza delle colonne di tipo stringa su 50 caratteri.</span><span class="sxs-lookup"><span data-stu-id="637a1-109">By default, the Flat File connection manager sets the length of string columns to 50 characters.</span></span> <span data-ttu-id="637a1-110">Nella finestra di dialogo **Editor gestione connessione file flat** è possibile valutare dati di esempio e modificare automaticamente la lunghezza di tali colonne in modo da evitare il troncamento dei dati o il superamento della larghezza massima delle colonne.</span><span class="sxs-lookup"><span data-stu-id="637a1-110">In the **Flat File Connection Manager Editor** dialog box, you can evaluate sample data and automatically resize the length of these columns to prevent truncation of data or excess column width.</span></span> <span data-ttu-id="637a1-111">La lunghezza di una colonna di tipo stringa rimane inoltre invariata per tutto il flusso di dati, a meno che non venga modificata successivamente in un'origine file flat o in una trasformazione.</span><span class="sxs-lookup"><span data-stu-id="637a1-111">Also, unless you subsequently resize the column length in a Flat File source or a transformation, the column length of string column remains the same throughout the data flow.</span></span> <span data-ttu-id="637a1-112">Se su tali colonne di tipo stringa viene eseguito il mapping a colonne di destinazione di larghezza inferiore, verrà visualizzato un avviso nell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="637a1-112">If these string columns map to destination columns that are narrower, warnings appear in the user interface.</span></span> <span data-ttu-id="637a1-113">e in fase di esecuzione potrebbero verificarsi errori dovuti al troncamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="637a1-113">Moreover, at run time, errors may occur due to data truncation.</span></span> <span data-ttu-id="637a1-114">Per evitare errori o troncamenti, è possibile ridimensionare le colonne in modo che siano compatibili con le colonne di destinazione nella gestione connessione file flat, nell'origine file flat o in una trasformazione.</span><span class="sxs-lookup"><span data-stu-id="637a1-114">To avoid errors or truncation, you can resize the columns to be compatible with the destination columns in the Flat File connection manager, the Flat File source, or a transformation.</span></span> <span data-ttu-id="637a1-115">Per modificare la lunghezza delle colonne di output, impostare la `Length` proprietà della colonna di output nella scheda **Proprietà input e output** della finestra di dialogo **Editor avanzato** .</span><span class="sxs-lookup"><span data-stu-id="637a1-115">To modify the length of output columns, you set the `Length` property of the output column on the **Input and Output Properties** tab in the **Advanced Editor** dialog box.</span></span>  
  
 <span data-ttu-id="637a1-116">Se, dopo avere aggiunto e configurato l'origine file flat che utilizza la gestione connessione, si modifica la lunghezza delle colonne nella gestione connessione file flat, non sarà necessario ridimensionare manualmente le colonne di output nell'origine file flat.</span><span class="sxs-lookup"><span data-stu-id="637a1-116">If you update column lengths in the Flat File connection manager after you have added and configured the Flat File source that uses the connection manager, you do not have to manually resize the output columns in the Flat File source.</span></span> <span data-ttu-id="637a1-117">Nella finestra di dialogo **Origine file flat** è disponibile un'opzione che consente di sincronizzare i metadati delle colonne per l'origine file flat.</span><span class="sxs-lookup"><span data-stu-id="637a1-117">When you open the **Flat File Source** dialog box, the Flat File source provides an option to synchronize the column metadata.</span></span>  
  
## <a name="configuration-of-the-flat-file-connection-manager"></a><span data-ttu-id="637a1-118">Configurazione della gestione connessione file flat</span><span class="sxs-lookup"><span data-stu-id="637a1-118">Configuration of the Flat File Connection Manager</span></span>  
 <span data-ttu-id="637a1-119">Quando si aggiunge una gestione connessione file flat a un pacchetto, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] Crea una gestione connessione che in fase di esecuzione verrà risolta in una connessione file flat, imposta le proprietà della connessione file flat e aggiunge la gestione connessione file flat alla `Connections` raccolta del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="637a1-119">When you add a Flat File connection manager to a package, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] creates a connection manager that will resolve to a Flat File connection at run time, sets the Flat File connection properties, and adds the Flat File connection manager to the `Connections` collection of the package.</span></span>  
  
 <span data-ttu-id="637a1-120">La proprietà `ConnectionManagerType` della gestione connessione viene impostata su `FLATFILE`.</span><span class="sxs-lookup"><span data-stu-id="637a1-120">The `ConnectionManagerType` property of the connection manager is set to `FLATFILE`.</span></span>  
  
 <span data-ttu-id="637a1-121">Per impostazione predefinita, tramite la gestione connessione file flat viene sempre verificata la presenza di un delimitatore di riga in dati senza virgolette e viene iniziata una nuova riga quando viene individuato un relativo delimitatore.</span><span class="sxs-lookup"><span data-stu-id="637a1-121">By default, the Flat File connection manager always checks for a row delimiter in unquoted data, and starts a new row when a row delimiter is found.</span></span> <span data-ttu-id="637a1-122">In questo modo, con la gestione connessione è possibile analizzare correttamente i file con righe prive di campi colonna.</span><span class="sxs-lookup"><span data-stu-id="637a1-122">This enables the connection manager to correctly parse files with rows that are missing column fields.</span></span>  
  
 <span data-ttu-id="637a1-123">In alcuni casi, la disabilitazione di questa funzionalità potrebbe migliorare le prestazioni del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="637a1-123">In some cases, disabling this feature may improve package performance.</span></span> <span data-ttu-id="637a1-124">È possibile disabilitare questa funzionalità impostando la proprietà della gestione connessione file flat, **AlwaysCheckForRowDelimiters**, su `False` .</span><span class="sxs-lookup"><span data-stu-id="637a1-124">You can disable this feature by setting the Flat File connection manager property, **AlwaysCheckForRowDelimiters**, to `False`.</span></span>  
  
 <span data-ttu-id="637a1-125">Per configurare la gestione connessione file flat, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="637a1-125">You can configure the Flat File connection manager in the following ways:</span></span>  
  
-   <span data-ttu-id="637a1-126">Specificare il file, le impostazioni locali e la tabella codici da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="637a1-126">Specify the file, locale, and code page to use.</span></span> <span data-ttu-id="637a1-127">Le impostazioni locali vengono utilizzate per interpretare i dati con formato dipendente dalla lingua, come le date, mentre la tabella codici viene utilizzata per convertire i dati stringa in formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="637a1-127">The locale is used to interpret locale-sensitive data such as dates, and the code page is used to convert string data to Unicode.</span></span>  
  
-   <span data-ttu-id="637a1-128">Specificare il formato dei file.</span><span class="sxs-lookup"><span data-stu-id="637a1-128">Specify the file format.</span></span> <span data-ttu-id="637a1-129">È possibile utilizzare un formato delimitato, a larghezza fissa o non allineato a destra.</span><span class="sxs-lookup"><span data-stu-id="637a1-129">You can use a delimited, fixed width, or ragged right format.</span></span>  
  
-   <span data-ttu-id="637a1-130">Specificare i delimitatori della riga di intestazione, delle righe di dati e delle colonne.</span><span class="sxs-lookup"><span data-stu-id="637a1-130">Specify a header row, data row, and column delimiters.</span></span> <span data-ttu-id="637a1-131">I delimitatori delle colonne possono essere impostati a livello di file e sovrascritti a livello di colonna.</span><span class="sxs-lookup"><span data-stu-id="637a1-131">Column delimiters can be set at the file level and overwritten at the column level.</span></span>  
  
-   <span data-ttu-id="637a1-132">Indicare se la prima riga del file contiene i nomi delle colonne.</span><span class="sxs-lookup"><span data-stu-id="637a1-132">Indicate whether the first row in the file contains column names.</span></span>  
  
-   <span data-ttu-id="637a1-133">Specificare un qualificatore di testo.</span><span class="sxs-lookup"><span data-stu-id="637a1-133">Specify a text qualifier character.</span></span> <span data-ttu-id="637a1-134">Ogni colonna può essere configurata in modo da riconoscere un qualificatore di testo.</span><span class="sxs-lookup"><span data-stu-id="637a1-134">Each column can be configured to recognize a text qualifier.</span></span>  
  
     <span data-ttu-id="637a1-135">Ora è supportato l'utilizzo di un qualificatore di testo per incorporare quest'ultimo in una stringa qualificata.</span><span class="sxs-lookup"><span data-stu-id="637a1-135">The use of a qualifier character to embed a qualifier character into a qualified string is now supported.</span></span> <span data-ttu-id="637a1-136">L'istanza doppia di un qualificatore di testo viene interpretata come una singola istanza letterale di questa stringa.</span><span class="sxs-lookup"><span data-stu-id="637a1-136">The double instance of a text qualifier is interpreted as a literal, single instance of that string.</span></span> <span data-ttu-id="637a1-137">Ad esempio, se il qualificatore di testo è una virgoletta singola e i dati di input sono 'abc', 'def', 'g'hi', i dati di output saranno abc, def, g'hi.</span><span class="sxs-lookup"><span data-stu-id="637a1-137">For example, if the text qualifier is a single quote and the input data is 'abc', 'def', 'g'hi', the output data is abc, def, g'hi.</span></span>  
  
-   <span data-ttu-id="637a1-138">Impostare proprietà quali il nome, il tipo di dati e la larghezza massima delle singole colonne.</span><span class="sxs-lookup"><span data-stu-id="637a1-138">Set properties such as the name, data type, and maximum width on individual columns.</span></span>  
  
 <span data-ttu-id="637a1-139">È possibile impostare la proprietà ConnectionString per la gestione connessione file flat specificando un'espressione nella finestra Proprietà di [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="637a1-139">You can set the ConnectionString property for the Flat File connection manager by specifying an expression in the Properties window of [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="637a1-140">Per evitare errori di convalida, effettuare le operazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="637a1-140">To avoid a validation error, do the following.</span></span>  
  
-   <span data-ttu-id="637a1-141">Quando si usa un'espressione per specificare il file, aggiungere il percorso del file nella casella **Nome file** nell' **Editor gestione connessione file flat**.</span><span class="sxs-lookup"><span data-stu-id="637a1-141">When you use an expression to specify the file, add a file path in the **File name** box in the **Flat File Connection Manager Editor**.</span></span>  
  
-   <span data-ttu-id="637a1-142">Impostare la proprietà **DelayValidation** della gestione connessione file flat su **True**.</span><span class="sxs-lookup"><span data-stu-id="637a1-142">Set the **DelayValidation** property on the Flat File connection manager to **True**.</span></span>  
  
 <span data-ttu-id="637a1-143">È possibile utilizzare un'espressione per creare un nome di file in fase di esecuzione utilizzando la gestione connessione file flat con la destinazione file flat.</span><span class="sxs-lookup"><span data-stu-id="637a1-143">You can use an expression to create a file name at runtime by using the Flat File connection manager with the Flat File destination.</span></span>  
  
 <span data-ttu-id="637a1-144">È possibile impostare le proprietà tramite Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] o a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="637a1-144">You can set properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
 <span data-ttu-id="637a1-145">Per ulteriori informazioni sulle proprietà che è possibile impostare in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] , fare clic su uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="637a1-145">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="637a1-146">Editor gestione connessione file flat &#40;pagina Generale&#41;</span><span class="sxs-lookup"><span data-stu-id="637a1-146">Flat File Connection Manager Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="637a1-147">Editor gestione connessione file flat &#40;pagina Colonne&#41;</span><span class="sxs-lookup"><span data-stu-id="637a1-147">Flat File Connection Manager Editor &#40;Columns Page&#41;</span></span>](../flat-file-connection-manager-editor-columns-page.md)  
  
-   [<span data-ttu-id="637a1-148">Editor gestione connessione file flat &#40;pagina Avanzate&#41;</span><span class="sxs-lookup"><span data-stu-id="637a1-148">Flat File Connection Manager Editor &#40;Advanced Page&#41;</span></span>](../flat-file-connection-manager-editor-advanced-page.md)  
  
-   [<span data-ttu-id="637a1-149">Editor gestione connessione file flat &#40;pagina Anteprima&#41;</span><span class="sxs-lookup"><span data-stu-id="637a1-149">Flat File Connection Manager Editor &#40;Preview Page&#41;</span></span>](../flat-file-connection-manager-editor-preview-page.md)  
  
 <span data-ttu-id="637a1-150">Per informazioni sulla configurazione di una gestione connessione a livello di programmazione, vedere l'articolo relativo a <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> e [Aggiunta di connessioni a livello di programmazione](../building-packages-programmatically/adding-connections-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="637a1-150">For information about configuring a connection manager programmatically, see <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> and [Adding Connections Programmatically](../building-packages-programmatically/adding-connections-programmatically.md).</span></span>  
  
  
