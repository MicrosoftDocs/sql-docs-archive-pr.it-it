---
title: Attività Esegui SQL | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713388"
---
# <a name="execute-sql-task"></a><span data-ttu-id="7d050-102">Attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-102">Execute SQL Task</span></span>
  <span data-ttu-id="7d050-103">L'attività Esegui SQL consente di eseguire istruzioni SQL o stored procedure da un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="7d050-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="7d050-104">L'attività può includere una o più istruzioni SQL che vengono eseguite in ordine sequenziale.</span><span class="sxs-lookup"><span data-stu-id="7d050-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="7d050-105">È possibile utilizzare l'attività Esegui SQL per gli scopi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d050-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="7d050-106">Troncare una tabella o una vista per prepararla per l'inserimento di dati.</span><span class="sxs-lookup"><span data-stu-id="7d050-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="7d050-107">Creare, modificare ed eliminare oggetti di database come tabelle e viste.</span><span class="sxs-lookup"><span data-stu-id="7d050-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="7d050-108">Ricreare tabelle dei fatti e delle dimensioni prima di caricarvi i dati.</span><span class="sxs-lookup"><span data-stu-id="7d050-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="7d050-109">Eseguire stored procedure.</span><span class="sxs-lookup"><span data-stu-id="7d050-109">Run stored procedures.</span></span> <span data-ttu-id="7d050-110">Se l'istruzione SQL richiama una stored procedure che restituisce risultati da una tabella temporanea, utilizzare l'opzione WITH RESULT SETS per definire metadati per il set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="7d050-111">Salvare in una variabile il set di righe restituito da una query.</span><span class="sxs-lookup"><span data-stu-id="7d050-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="7d050-112">L'attività Esegui SQL può essere usata in combinazione con i contenitori Ciclo Foreach e Ciclo For per eseguire più istruzioni SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="7d050-113">Questi contenitori consentono di implementare flussi di controllo ripetuti in un pacchetto e possono eseguire più volte l'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="7d050-114">Utilizzando ad esempio il contenitore Ciclo Foreach, il pacchetto può enumerare i file in una cartella ed eseguire ripetutamente un'attività Esegui SQL per elaborare l'istruzione SQL archiviata in ogni file.</span><span class="sxs-lookup"><span data-stu-id="7d050-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="7d050-115">Connessione a un'origine dati</span><span class="sxs-lookup"><span data-stu-id="7d050-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="7d050-116">Per connettersi all'origine dei dati su cui eseguire l'istruzione SQL o la stored procedure, l'attività Esegui SQL può utilizzare diversi tipi di gestione connessione,</span><span class="sxs-lookup"><span data-stu-id="7d050-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="7d050-117">elencati nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="7d050-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="7d050-118">Tipo di connessione</span><span class="sxs-lookup"><span data-stu-id="7d050-118">Connection type</span></span>|<span data-ttu-id="7d050-119">Gestione connessione</span><span class="sxs-lookup"><span data-stu-id="7d050-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="7d050-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="7d050-120">EXCEL</span></span>|[<span data-ttu-id="7d050-121">Gestione connessione Excel</span><span class="sxs-lookup"><span data-stu-id="7d050-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="7d050-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="7d050-122">OLE DB</span></span>|[<span data-ttu-id="7d050-123">Gestione connessione OLE DB</span><span class="sxs-lookup"><span data-stu-id="7d050-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="7d050-124">ODBC</span><span class="sxs-lookup"><span data-stu-id="7d050-124">ODBC</span></span>|[<span data-ttu-id="7d050-125">Gestione connessione ODBC</span><span class="sxs-lookup"><span data-stu-id="7d050-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="7d050-126">ADO</span><span class="sxs-lookup"><span data-stu-id="7d050-126">ADO</span></span>|[<span data-ttu-id="7d050-127">Gestione connessione ADO</span><span class="sxs-lookup"><span data-stu-id="7d050-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="7d050-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="7d050-128">ADO.NET</span></span>|[<span data-ttu-id="7d050-129">Gestione connessione ADO.NET</span><span class="sxs-lookup"><span data-stu-id="7d050-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="7d050-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="7d050-130">SQLMOBILE</span></span>|[<span data-ttu-id="7d050-131">Gestione connessione SQL Server Compact Edition</span><span class="sxs-lookup"><span data-stu-id="7d050-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="7d050-132">Creazione di istruzioni SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="7d050-133">L'origine delle istruzioni SQL utilizzate da questa attività può essere una proprietà dell'attività che contiene un'istruzione, una connessione a un file che contiene una o più istruzioni oppure il nome di una variabile che contiene un'istruzione.</span><span class="sxs-lookup"><span data-stu-id="7d050-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="7d050-134">Le istruzioni SQL devono essere scritte nel sottolinguaggio del sistema di gestione di database (DBMS) di origine.</span><span class="sxs-lookup"><span data-stu-id="7d050-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="7d050-135">Per altre informazioni, vedere [Query di Integration Services &#40;SSIS&#41;](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="7d050-136">Se le istruzioni SQL sono memorizzate in un file, per connettersi al file l'attività utilizzerà una gestione connessione file.</span><span class="sxs-lookup"><span data-stu-id="7d050-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="7d050-137">Per altre informazioni, vedere [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="7d050-138">In Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] per creare query SQL è possibile digitare le istruzioni nella finestra di dialogo **Editor attività Esegui SQL** o utilizzare l'interfaccia utente grafica **Generatore di query**.</span><span class="sxs-lookup"><span data-stu-id="7d050-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="7d050-139">Per altre informazioni, vedere [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) e [Generatore di query](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d050-140">L'attività Esegui SQL non è in grado di elaborare correttamente le istruzioni SQL valide scritte al di fuori dell'attività stessa.</span><span class="sxs-lookup"><span data-stu-id="7d050-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d050-141">L'attività Esegui SQL utilizza il valore di enumerazione ParseMode `RecognizeAll`.</span><span class="sxs-lookup"><span data-stu-id="7d050-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="7d050-142">Per altre informazioni, vedere [Spazio dei nomi ManagedBatchParser](https://go.microsoft.com/fwlink/?LinkId=223617).</span><span class="sxs-lookup"><span data-stu-id="7d050-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="7d050-143">Invio di più istruzioni in un batch</span><span class="sxs-lookup"><span data-stu-id="7d050-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="7d050-144">Se un'attività Esegui SQL include più istruzioni, sarà possibile raggrupparle ed eseguirle come batch,</span><span class="sxs-lookup"><span data-stu-id="7d050-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="7d050-145">utilizzando il comando GO per segnalare la fine del batch.</span><span class="sxs-lookup"><span data-stu-id="7d050-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="7d050-146">Tutte le istruzioni SQL comprese tra due comandi GO vengono inviate in batch al provider OLE DB per l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7d050-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="7d050-147">Il comando SQL può includere più batch separati da comandi GO.</span><span class="sxs-lookup"><span data-stu-id="7d050-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="7d050-148">I tipi di istruzioni SQL che è possibile raggruppare in un batch sono soggetti a restrizioni.</span><span class="sxs-lookup"><span data-stu-id="7d050-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="7d050-149">Per altre informazioni, vedere [Batch di istruzioni](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="7d050-150">Se l'attività Esegui SQL esegue un batch di istruzioni SQL, al batch verranno applicate le regole seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d050-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="7d050-151">Può restituire un set di risultati una sola istruzione, che deve essere la prima del batch.</span><span class="sxs-lookup"><span data-stu-id="7d050-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="7d050-152">Se il set di risultati utilizza associazioni di risultati, le query dovranno restituire lo stesso numero di colonne.</span><span class="sxs-lookup"><span data-stu-id="7d050-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="7d050-153">Se le query restituiscono numeri di colonne diversi, l'attività avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="7d050-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="7d050-154">Le query eseguite dall'attività, ad esempio DELETE o INSERT, possono tuttavia avere esito positivo anche se l'attività non viene eseguita correttamente.</span><span class="sxs-lookup"><span data-stu-id="7d050-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="7d050-155">Se le associazioni di risultati utilizzano nomi di colonne, la query dovrà restituire colonne con nomi uguali a quelli del set di risultati dell'attività.</span><span class="sxs-lookup"><span data-stu-id="7d050-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="7d050-156">Se le colonne non sono presenti, l'attività avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="7d050-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="7d050-157">Se l'attività utilizza un'associazione di parametri, tutte le query incluse nel batch dovranno avere lo stesso numero e gli stessi tipi di parametri.</span><span class="sxs-lookup"><span data-stu-id="7d050-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="7d050-158">Esecuzione di comandi SQL con parametri</span><span class="sxs-lookup"><span data-stu-id="7d050-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="7d050-159">Le istruzioni SQL e le stored procedure utilizzano spesso parametri di input, parametri di output e codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="7d050-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="7d050-160">L'attività Esegui SQL supporta parametri di tipo `Input`, `Output` e `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="7d050-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="7d050-161">Il tipo `Input` viene utilizzato per i parametri di input, il tipo `Output` per i parametri di output e il tipo `ReturnValue` per i codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="7d050-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d050-162">È possibile utilizzare parametri in un'attività Esegui SQL solo se il provider di dati li supporta.</span><span class="sxs-lookup"><span data-stu-id="7d050-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="7d050-163">Per informazioni sull'uso di parametri e codici restituiti nell'attività Esegui SQL, vedere [Parametri e codici restituiti nell’attività Esegui SQL](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="7d050-164">Impostazione del tipo di un set di risultati</span><span class="sxs-lookup"><span data-stu-id="7d050-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="7d050-165">A seconda del tipo di comando SQL, all'attività Esegui SQL può essere restituito o meno un set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="7d050-166">Se si utilizzano ad esempio le istruzioni SELECT, viene in genere restituito un set di risultati, mentre questo non avviene per le istruzioni INSERT.</span><span class="sxs-lookup"><span data-stu-id="7d050-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="7d050-167">Il set di risultati restituito da un'istruzione SELECT può contenere zero, una o più righe.</span><span class="sxs-lookup"><span data-stu-id="7d050-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="7d050-168">Le stored procedure possono restituire anche un valore intero, detto codice restituito, che indica lo stato dell'esecuzione della procedura.</span><span class="sxs-lookup"><span data-stu-id="7d050-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="7d050-169">In questo caso il set di risultati è costituito da una sola riga.</span><span class="sxs-lookup"><span data-stu-id="7d050-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="7d050-170">Per informazioni sul recupero di set di risultati dai comandi SQL nell'attività Esegui SQL, vedere [Set di risultati nell’attività Esegui SQL](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="7d050-171">Risoluzione dei problemi relativi all'attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="7d050-172">È possibile registrare le chiamate eseguite dall'attività Esegui SQL a provider di dati esterni.</span><span class="sxs-lookup"><span data-stu-id="7d050-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="7d050-173">Questa funzionalità di registrazione può essere utilizzata per risolvere i problemi relativi ai comandi SQL eseguiti dall'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="7d050-174">Per registrare le chiamate eseguite dall'attività Esegui SQL a provider di dati esterni, abilitare la registrazione dei pacchetti e selezionare l'evento **Diagnostic** a livello del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="7d050-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="7d050-175">Per altre informazioni, vedere [Risoluzione dei problemi relativi agli strumenti per l'esecuzione del pacchetto](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="7d050-176">Talvolta un comando SQL o una stored procedure restituiscono più set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="7d050-177">Tali set di risultati non solo includono i set di righe che sono il risultato di query `SELECT`, ma anche valori singoli che sono il risultato di errori di istruzioni `RAISERROR` o `PRINT`.</span><span class="sxs-lookup"><span data-stu-id="7d050-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="7d050-178">L'attività ignora gli errori nei set di risultati che si verificano dopo il primo set di risultati in base al tipo di gestione connessione utilizzata:</span><span class="sxs-lookup"><span data-stu-id="7d050-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="7d050-179">Se si utilizzano le gestioni connessioni OLE DB e ADO, l'attività ignora i set di risultati che si verificano dopo il primo set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="7d050-180">Pertanto, con tali gestioni connessioni, l'attività ignora un errore restituito da un comando SQL o da una stored procedure quando l'errore non fa parte del primo set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="7d050-181">Se si utilizzano le gestioni connessioni ODBC e ADO.NET, l'attività non ignora i set di risultati che si verificano dopo il primo set di risultati.</span><span class="sxs-lookup"><span data-stu-id="7d050-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="7d050-182">Con queste gestioni connessioni, l'attività non riesce e viene restituito un errore qualora un set di risultati diverso dal primo set di risultati contiene un errore.</span><span class="sxs-lookup"><span data-stu-id="7d050-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="7d050-183">Voci di log personalizzate</span><span class="sxs-lookup"><span data-stu-id="7d050-183">Custom Log Entries</span></span>  
 <span data-ttu-id="7d050-184">Nella tabella seguente è indicata la voce di log personalizzata disponibile per l'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="7d050-185">Per altre informazioni, vedere [Registrazione di Integration Services &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) e [Messaggi personalizzati per la registrazione](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="7d050-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="7d050-186">Voce di log</span><span class="sxs-lookup"><span data-stu-id="7d050-186">Log entry</span></span>|<span data-ttu-id="7d050-187">Descrizione</span><span class="sxs-lookup"><span data-stu-id="7d050-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="7d050-188">Fornisce informazioni sulle fasi di esecuzione dell'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="7d050-189">Vengono scritte voci di log quando l'attività acquisisce la connessione al database, quando inizia a preparare l'istruzione SQL e al termine dell'esecuzione dell'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="7d050-190">La voce di log per la fase di preparazione include l'istruzione SQL utilizzata dall'attività.</span><span class="sxs-lookup"><span data-stu-id="7d050-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="7d050-191">Configurazione dell'attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="7d050-192">Per configurare l'attività Esegui SQL, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="7d050-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="7d050-193">Specificare il tipo di gestione connessione da utilizzare per la connessione a un database.</span><span class="sxs-lookup"><span data-stu-id="7d050-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="7d050-194">Specificare il tipo di set di risultati restituito dall'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="7d050-195">Specificare un timeout per l'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="7d050-196">Specificare l'origine dell'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="7d050-197">Indicare se l'attività salta la fase di preparazione per l'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="7d050-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="7d050-198">Se si utilizza il tipo di connessione ADO, è necessario indicare se l'istruzione SQL è una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="7d050-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="7d050-199">Per altri tipi di connessione questa proprietà è di sola lettura e ha sempre valore `false`.</span><span class="sxs-lookup"><span data-stu-id="7d050-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="7d050-200">È possibile impostare le proprietà a livello di programmazione o tramite Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7d050-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="7d050-201">Per ulteriori informazioni sulle proprietà che è possibile impostare in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] , fare clic su uno degli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d050-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="7d050-202">Editor attività Esegui SQL &#40;pagina generale&#41;</span><span class="sxs-lookup"><span data-stu-id="7d050-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="7d050-203">Editor attività Esegui SQL &#40;pagina Mapping parametri&#41;</span><span class="sxs-lookup"><span data-stu-id="7d050-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="7d050-204">Editor attività Esegui SQL &#40;pagina del set di risultati&#41;</span><span class="sxs-lookup"><span data-stu-id="7d050-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="7d050-205">Pagina Espressioni</span><span class="sxs-lookup"><span data-stu-id="7d050-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="7d050-206">Per altre informazioni sull'impostazione di queste proprietà in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] , fare clic sull'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="7d050-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="7d050-207">Impostazione delle proprietà di un'attività o di un contenitore</span><span class="sxs-lookup"><span data-stu-id="7d050-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="7d050-208">Configurazione dell'attività Esegui SQL a livello di codice</span><span class="sxs-lookup"><span data-stu-id="7d050-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="7d050-209">Per ulteriori informazioni sull'impostazione di queste proprietà a livello di codice, fare clic sull'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="7d050-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="7d050-210">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="7d050-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="7d050-211">Mapping di parametri di query a variabili in un'attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="7d050-212">Mapping di set di risultati a variabili in un'attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="7d050-213">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="7d050-213">Related Content</span></span>  
  
-   [<span data-ttu-id="7d050-214">Parametri e codici restituiti nell’attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="7d050-215">Set di risultati nell’attività Esegui SQL</span><span class="sxs-lookup"><span data-stu-id="7d050-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="7d050-216">Guida di riferimento a Transact-SQL &#40;Motore di database&#41;</span><span class="sxs-lookup"><span data-stu-id="7d050-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="7d050-217">Intervento nel blog relativo alle [nuove funzioni di data e ora in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783)sul sito Web mssqltips.com</span><span class="sxs-lookup"><span data-stu-id="7d050-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  
