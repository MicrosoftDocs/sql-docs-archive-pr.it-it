---
title: Attività Script | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scripttask.f1
helpviewer_keywords:
- scripts [Integration Services], tasks
- Script task [Integration Services], about Script task
- Script task [Integration Services]
ms.assetid: f6cce7df-4bd6-4b75-9f89-6c37b4bb5558
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 69c051994eb06cbab041db3db2683a487a6e1994
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87623437"
---
# <a name="script-task"></a><span data-ttu-id="2cd97-102">Attività Script</span><span class="sxs-lookup"><span data-stu-id="2cd97-102">Script Task</span></span>
  <span data-ttu-id="2cd97-103">L'attività Script fornisce il codice necessario per eseguire le funzioni non disponibili nelle trasformazioni e nelle attività predefinite di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2cd97-103">The Script task provides code to perform functions that are not available in the built-in tasks and transformations that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span> <span data-ttu-id="2cd97-104">Tale attività consente inoltre di combinare più funzioni in un unico script, anziché utilizzare più attività e trasformazioni.</span><span class="sxs-lookup"><span data-stu-id="2cd97-104">The Script task can also combine functions in one script instead of using multiple tasks and transformations.</span></span> <span data-ttu-id="2cd97-105">L'attività Script può essere utilizzata per operazioni che devono essere eseguite una sola volta in un pacchetto o una sola volta per oggetto enumerato, anziché una volta per ogni riga di dati.</span><span class="sxs-lookup"><span data-stu-id="2cd97-105">You use the Script task for work that must be done once in a package (or once per enumerated object), instead than once per data row.</span></span>  
  
 <span data-ttu-id="2cd97-106">È possibile utilizzare l'attività Script per gli scopi seguenti:</span><span class="sxs-lookup"><span data-stu-id="2cd97-106">You can use the Script task for the following purposes:</span></span>  
  
-   <span data-ttu-id="2cd97-107">Accedere ai dati tramite tecnologie non supportate dai tipi di connessioni predefiniti.</span><span class="sxs-lookup"><span data-stu-id="2cd97-107">Access data by using other technologies that are not supported by built-in connection types.</span></span> <span data-ttu-id="2cd97-108">Negli script è ad esempio possibile utilizzare ADSI (Active Directory Service Interfaces) per accedere ad Active Directory ed estrarre i nomi utente.</span><span class="sxs-lookup"><span data-stu-id="2cd97-108">For example, a script can use Active Directory Service Interfaces (ADSI) to access and extract user names from Active Directory.</span></span>  
  
-   <span data-ttu-id="2cd97-109">Creare contatori delle prestazioni specifici dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="2cd97-109">Create a package-specific performance counter.</span></span> <span data-ttu-id="2cd97-110">Uno script può ad esempio creare un contatore delle prestazioni che viene aggiornato durante l'esecuzione di un'attività complessa o con prestazioni insufficienti.</span><span class="sxs-lookup"><span data-stu-id="2cd97-110">For example, a script can create a performance counter that is updated while a complex or poorly performing task runs.</span></span>  
  
-   <span data-ttu-id="2cd97-111">Determinare il numero delle righe contenute nei file specificati o stabilire se sono vuoti e quindi modificare il flusso di controllo di un pacchetto in base alle informazioni ottenute.</span><span class="sxs-lookup"><span data-stu-id="2cd97-111">Identify whether specified files are empty or how many rows they contain, and then based on that information affect the control flow in a package.</span></span> <span data-ttu-id="2cd97-112">Se ad esempio un file non contiene righe, il valore di una determinata variabile verrà impostato su 0 e un vincolo di precedenza che valuta tale valore impedirà all'attività File system di copiare il file.</span><span class="sxs-lookup"><span data-stu-id="2cd97-112">For example, if a file contains zero rows, the value of a variable set to 0, and a precedence constraint that evaluates the value prevents a File System task from copying the file.</span></span>  
  
 <span data-ttu-id="2cd97-113">Se è necessario utilizzare lo script per eseguire le stesse operazioni per ogni riga di dati in una set, è consigliabile utilizzare il componente script anziché l'attività Script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-113">If you have to use the script to do the same work for each row of data in a set, you should use the Script component instead of the Script task.</span></span> <span data-ttu-id="2cd97-114">Se ad esempio si desidera stabilire se l'importo delle spese postali è ragionevole e ignorare le righe di dati che includono importi troppo alti o troppo bassi, è consigliabile utilizzare il componente script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-114">For example, if you want to assess the reasonableness of a postage amount and skip data rows that have very high or low amounts, you would use a Script component.</span></span> <span data-ttu-id="2cd97-115">Per altre informazioni, vedere [Componente script](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="2cd97-115">For more information, see [Script Component](../data-flow/transformations/script-component.md).</span></span>  
  
 <span data-ttu-id="2cd97-116">Per gli script utilizzati da più di un pacchetto è preferibile creare un'attività personalizzata, anziché utilizzare l'attività Script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-116">If more than one package uses a script, consider writing a custom task instead of using the Script task.</span></span> <span data-ttu-id="2cd97-117">Per altre informazioni, vedere [Sviluppo di un'attività personalizzata](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span><span class="sxs-lookup"><span data-stu-id="2cd97-117">For more information, see [Developing a Custom Task](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span></span>  
  
 <span data-ttu-id="2cd97-118">Una volta stabilito che l'attività Script è la scelta più appropriata per il pacchetto, è necessario sia sviluppare lo script utilizzato dall'attività sia configurare l'attività stessa.</span><span class="sxs-lookup"><span data-stu-id="2cd97-118">After you decide that the Script task is the appropriate choice for your package, you have to both develop the script that the task uses and configure the task itself.</span></span>  
  
## <a name="writing-and-running-the-script-that-the-task-uses"></a><span data-ttu-id="2cd97-119">Scrittura ed esecuzione di script utilizzati dall'attività</span><span class="sxs-lookup"><span data-stu-id="2cd97-119">Writing and Running the Script that the Task Uses</span></span>  
 <span data-ttu-id="2cd97-120">L'attività Script usa [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) come ambiente in cui scrivere gli script e come motore in cui eseguirli.</span><span class="sxs-lookup"><span data-stu-id="2cd97-120">The Script task uses [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts and the engine that runs those scripts.</span></span>  
  
 <span data-ttu-id="2cd97-121">In VSTA sono disponibili tutte le funzionalità standard dell'ambiente [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], come l'editor di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] contraddistinto dal colore, la tecnologia IntelliSense ed **Esplora oggetti**.</span><span class="sxs-lookup"><span data-stu-id="2cd97-121">VSTA provides all the standard features of the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] editor, IntelliSense, and **Object Explorer**.</span></span> <span data-ttu-id="2cd97-122">VSTA utilizza anche lo stesso debugger usato da altri strumenti di sviluppo di [!INCLUDE[msCoName](../../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2cd97-122">VSTA also uses the same debugger that other [!INCLUDE[msCoName](../../includes/msconame-md.md)] development tools use.</span></span> <span data-ttu-id="2cd97-123">I punti di interruzione degli script si integrano completamente con quelli delle attività e dei contenitori di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2cd97-123">Breakpoints in the script work seamlessly with breakpoints on [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tasks and containers.</span></span> <span data-ttu-id="2cd97-124">VSTA supporta i linguaggi di programmazione [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic e [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C#.</span><span class="sxs-lookup"><span data-stu-id="2cd97-124">VSTA supports both the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# programming languages.</span></span>  
  
 <span data-ttu-id="2cd97-125">Per eseguire uno script, VSTA deve essere pertanto installato nel computer in cui viene eseguito il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="2cd97-125">To run a script, you must have VSTA installed on the computer where the package runs.</span></span> <span data-ttu-id="2cd97-126">Durante l'esecuzione di un pacchetto l'attività carica il motore di scripting ed esegue lo script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-126">When the package runs, the task loads the script engine and runs the script.</span></span> <span data-ttu-id="2cd97-127">È possibile accedere ad assembly .NET esterni dagli script aggiungendo i riferimenti a tali assembly nel progetto.</span><span class="sxs-lookup"><span data-stu-id="2cd97-127">You can access external .NET assemblies in scripts by adding references to the assemblies in the project.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2cd97-128">A differenza delle versioni precedenti in cui era possibile indicare se gli script erano precompilati o meno, in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] e versioni successive tutti gli script sono precompilati.</span><span class="sxs-lookup"><span data-stu-id="2cd97-128">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="2cd97-129">Se uno script è precompilato, il motore del linguaggio non verrà caricato in fase di esecuzione e il pacchetto verrà eseguito molto più rapidamente.</span><span class="sxs-lookup"><span data-stu-id="2cd97-129">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="2cd97-130">I file binari precompilati occupano tuttavia una notevole quantità di spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="2cd97-130">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-task"></a><span data-ttu-id="2cd97-131">Configurazione dell'attività Script</span><span class="sxs-lookup"><span data-stu-id="2cd97-131">Configuring the Script Task</span></span>  
 <span data-ttu-id="2cd97-132">Per configurare l'attività Script, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="2cd97-132">You can configure the Script task in the following ways:</span></span>  
  
-   <span data-ttu-id="2cd97-133">Specificare lo script personalizzato che deve essere eseguito dall'attività.</span><span class="sxs-lookup"><span data-stu-id="2cd97-133">Provide the custom script that the task runs.</span></span>  
  
-   <span data-ttu-id="2cd97-134">Nel progetto VSTA, specificare il metodo chiamato dal runtime [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] come punto di ingresso nel codice dell'attività Script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-134">Specify the method in the VSTA project that the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime calls as the entry point into the Script task code.</span></span>  
  
-   <span data-ttu-id="2cd97-135">Specificare il linguaggio di scripting.</span><span class="sxs-lookup"><span data-stu-id="2cd97-135">Specify the script language.</span></span>  
  
-   <span data-ttu-id="2cd97-136">È facoltativamente possibile specificare gli elenchi delle variabili in sola lettura e in lettura e scrittura da utilizzare nello script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-136">Optionally, provide lists of read-only and read/write variables for use in the script.</span></span>  
  
 <span data-ttu-id="2cd97-137">È possibile impostare queste proprietà tramite Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] o a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="2cd97-137">You can set these properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-task-in-the-designer"></a><span data-ttu-id="2cd97-138">Configurazione dell'attività Script in Progettazione</span><span class="sxs-lookup"><span data-stu-id="2cd97-138">Configuring the Script Task in the Designer</span></span>  
 <span data-ttu-id="2cd97-139">Nella tabella seguente viene descritto l'evento `ScriptTaskLogEntry` che può essere registrato per l'attività Script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-139">The following table describes the `ScriptTaskLogEntry` event that can be logged for Script task.</span></span> <span data-ttu-id="2cd97-140">L' `ScriptTaskLogEntry` evento è selezionato per la registrazione nella scheda **Dettagli** della finestra di dialogo **Configura log SSIS** .</span><span class="sxs-lookup"><span data-stu-id="2cd97-140">The `ScriptTaskLogEntry` event is selected for logging on the **Details** tab of the **Configure SSIS Logs** dialog box.</span></span> <span data-ttu-id="2cd97-141">Per altre informazioni, vedere [Registrazione di Integration Services &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) e [Messaggi personalizzati per la registrazione](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="2cd97-141">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="2cd97-142">Voce di log</span><span class="sxs-lookup"><span data-stu-id="2cd97-142">Log entry</span></span>|<span data-ttu-id="2cd97-143">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2cd97-143">Description</span></span>|  
|---------------|-----------------|  
|`ScriptTaskLogEntry`|<span data-ttu-id="2cd97-144">Restituisce i risultati dell'implementazione della registrazione nell'ambito dello script.</span><span class="sxs-lookup"><span data-stu-id="2cd97-144">Reports the results of implementing logging in the script.</span></span> <span data-ttu-id="2cd97-145">L'attività scrive una voce di log per ogni chiamata al metodo `Log` dell'oggetto `Dts`.</span><span class="sxs-lookup"><span data-stu-id="2cd97-145">The task writes a log entry for each call to the `Log` method of the `Dts` object.</span></span> <span data-ttu-id="2cd97-146">Tali voci vengono scritte dall'attività al momento dell'esecuzione del codice.</span><span class="sxs-lookup"><span data-stu-id="2cd97-146">The task writes these entries when the code is run.</span></span> <span data-ttu-id="2cd97-147">Per altre informazioni, vedere [Registrazione nell'attività Script](../extending-packages-scripting/task/logging-in-the-script-task.md).</span><span class="sxs-lookup"><span data-stu-id="2cd97-147">For more information, see [Logging in the Script Task](../extending-packages-scripting/task/logging-in-the-script-task.md).</span></span>|  
  
 <span data-ttu-id="2cd97-148">Per ulteriori informazioni sulle proprietà che è possibile impostare in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] , vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="2cd97-148">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topics:</span></span>  
  
-   [<span data-ttu-id="2cd97-149">Editor attività Script &#40;pagina Generale&#41;</span><span class="sxs-lookup"><span data-stu-id="2cd97-149">Script Task Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="2cd97-150">Editor attività Script &#40;pagina Script&#41;</span><span class="sxs-lookup"><span data-stu-id="2cd97-150">Script Task Editor &#40;Script Page&#41;</span></span>](../script-task-editor-script-page.md)  
  
-   [<span data-ttu-id="2cd97-151">Pagina Espressioni</span><span class="sxs-lookup"><span data-stu-id="2cd97-151">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="2cd97-152">Per altre informazioni sull'impostazione di queste proprietà in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] , vedere l'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="2cd97-152">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topic:</span></span>  
  
-   [<span data-ttu-id="2cd97-153">Impostazione delle proprietà di un'attività o di un contenitore</span><span class="sxs-lookup"><span data-stu-id="2cd97-153">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
### <a name="configuring-the-script-task-programmatically"></a><span data-ttu-id="2cd97-154">Configurazione dell'attività Script a livello di codice</span><span class="sxs-lookup"><span data-stu-id="2cd97-154">Configuring the Script Task Programmatically</span></span>  
 <span data-ttu-id="2cd97-155">Per ulteriori informazioni sull'impostazione di queste proprietà a livello di codice, vedere l'argomento seguente:</span><span class="sxs-lookup"><span data-stu-id="2cd97-155">For more information about programmatically setting these properties, see the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ScriptTask.ScriptTask>  
  
## <a name="related-content"></a><span data-ttu-id="2cd97-156">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="2cd97-156">Related Content</span></span>  
  
-   <span data-ttu-id="2cd97-157">Articolo tecnico relativo all' [invio della posta elettronica con notifica di recapito in C#](https://go.microsoft.com/fwlink/?LinkId=237625)su shareourideas.com</span><span class="sxs-lookup"><span data-stu-id="2cd97-157">Technical article, [How to send email with delivery notification in C#](https://go.microsoft.com/fwlink/?LinkId=237625), on shareourideas.com</span></span>  
  
  
