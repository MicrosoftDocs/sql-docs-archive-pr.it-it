---
title: Usare variabili nei pacchetti | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625444"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="3f5bb-102">Utilizzo di variabili nei pacchetti</span><span class="sxs-lookup"><span data-stu-id="3f5bb-102">Use Variables in Packages</span></span>
  <span data-ttu-id="3f5bb-103">Le variabili rappresentano un elemento aggiuntivo utile e flessibile dei pacchetti di [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] . Consentono infatti la comunicazione tra i vari oggetti di un pacchetto e tra pacchetti padre e figlio.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="3f5bb-104">Le variabili possono essere utilizzate anche in espressioni e script.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="3f5bb-105">Variabili definite dall'utente e variabili di sistema</span><span class="sxs-lookup"><span data-stu-id="3f5bb-105">User-Defined Variables and System Variables</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="3f5bb-106">supporta variabili di sistema e variabili definite dall'utente.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-106">provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="3f5bb-107">Quando si crea un nuovo pacchetto, si aggiunge un contenitore o un'attività a un pacchetto oppure si crea un gestore dell'evento, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] include un set di variabili di sistema per il contenitore.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="3f5bb-108">Le variabili di sistema contengono informazioni utili su pacchetto, contenitore, attività o gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="3f5bb-109">Ad esempio, in fase di esecuzione la variabile di sistema **MachineName** include il nome del computer su cui è in esecuzione il pacchetto mentre la variabile **StartTime** include l'ora di inizio dell'esecuzione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="3f5bb-110">Le variabili di sistema sono di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-110">System variables are read-only.</span></span> <span data-ttu-id="3f5bb-111">Per altre informazioni, vedere [Variabili di sistema](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="3f5bb-112">È possibile creare variabili definite dall'utente e utilizzarle quindi nei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="3f5bb-113">In [!INCLUDE[ssIS](../includes/ssis-md.md)]queste variabili possono essere incluse negli script, nelle espressioni usate da vincoli di precedenza, nel contenitore Ciclo For, nelle trasformazioni Colonna derivata e Suddivisione condizionale, nonché nelle espressioni di proprietà per l'aggiornamento dei valori delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="3f5bb-114">È possibile, ad esempio, includere una variabile definita dall'utente nella condizione di valutazione per il contenitore Ciclo For.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="3f5bb-115">È inoltre possibile eseguire il mapping tra il valore della raccolta di enumeratori di un contenitore Ciclo Foreach e una variabile e, se un'attività Esegui SQL utilizza un'istruzione SQL con parametri, è possibile eseguire il mapping tra parametri dell'istruzione e variabili.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="3f5bb-116">Per altre informazioni, vedere [Variabili di Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="3f5bb-117">Scenari di utilizzo delle variabili</span><span class="sxs-lookup"><span data-stu-id="3f5bb-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="3f5bb-118">Nei pacchetti [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] le variabili vengono utilizzate in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="3f5bb-119">Durante lo sviluppo di un pacchetto vengono in genere aggiunte variabili definite dall'utente allo scopo di implementare la flessibilità e la gestibilità richieste dalla soluzione.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="3f5bb-120">A seconda dello scenario, vengono comunemente utilizzate anche variabili di sistema.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="3f5bb-121">**Espressioni di proprietà** Usano le variabili per specificare i valori nelle espressioni di proprietà che impostano gli oggetti e le proprietà dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="3f5bb-122">L'espressione `SELECT * FROM @varTableName` , ad esempio, include la variabile `varTableName` che aggiorna l'istruzione SQL eseguita da un'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="3f5bb-123">L'espressione `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`" aggiorna il pacchetto eseguito dall'attività Esegui pacchetto, eseguendo il pacchetto specificato nella variabile `varPackageFirst` il primo giorno del mese e il pacchetto specificato nella variabile `varPackageOther` in altri giorni.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="3f5bb-124">Per altre informazioni, vedere [Utilizzo delle espressioni di proprietà nei pacchetti](expressions/use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="3f5bb-125">**Espressioni del flusso di dati** Usano le variabili per specificare valori nelle espressioni usate dalle trasformazioni Colonna derivata e Suddivisione condizionale per popolare le colonne o per indirizzare le righe di dati nell'output di altre trasformazioni.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="3f5bb-126">L'espressione `@varSalutation + LastName`, ad esempio, concatena il valore della variabile `VarSalutation` e della colonna `LastName` .</span><span class="sxs-lookup"><span data-stu-id="3f5bb-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="3f5bb-127">L'espressione `Income < @HighIncome` indirizza in un output le righe di dati in cui il valore della colonna `Income` è minore del valore della variabile `HighIncome`.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="3f5bb-128">Per altre informazioni, vedere [Trasformazione Colonna derivata](data-flow/transformations/derived-column-transformation.md), [Trasformazione Suddivisione condizionale](data-flow/transformations/conditional-split-transformation.md), e [Espressioni di Integration Services &#40;SSIS&#41;](expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="3f5bb-129">**Espressioni di vincoli di precedenza** Forniscono i valori da usare nei vincoli di precedenza per determinare se l'eseguibile soggetto al vincolo verrà eseguito o meno.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="3f5bb-130">Le espressioni possono essere utilizzate insieme al risultato di un'esecuzione (esito positivo, esito negativo, completamento) o in sostituzione di tale risultato.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="3f5bb-131">Se ad esempio l'espressione `@varMax > @varMin` restituisce `true`, l'eseguibile verrà eseguito.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="3f5bb-132">Per altre informazioni, vedere [Aggiunta di espressioni ai vincoli di precedenza](control-flow/precedence-constraints.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="3f5bb-133">**Parametri e codici restituiti** Forniscono i valori ai parametri di input o archiviano i valori dei parametri di output e i codici restituiti.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="3f5bb-134">A tale scopo viene eseguito il mapping delle variabili ai parametri e ai valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="3f5bb-135">Se ad esempio si imposta la variabile `varProductId` su 23 e si esegue l'istruzione SQL `SELECT * from Production.Product WHERE ProductID = ?`, la query recupera il prodotto il cui `ProductID` ha valore 23.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="3f5bb-136">Per altre informazioni, vedere [Attività Esegui SQL](control-flow/execute-sql-task.md) e [Parametri e codici restituiti nell'attività Esegui SQL](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="3f5bb-137">**Espressioni del Ciclo For** Forniscono i valori da usare nell'inizializzazione, la valutazione e l'assegnazione di espressioni del Ciclo For.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="3f5bb-138">Se ad esempio la variabile `varCount` è uguale a 2 e `varMaxCount` è uguale a 10, l'espressione di inizializzazione è `@varCount`, quella di valutazione è  `@varCount < @varMaxCount`e quella di assegnazione è `@varCount =@varCount +1`, pertanto il ciclo si ripete 8 volte.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="3f5bb-139">Per altre informazioni, vedere [Contenitore Ciclo For](control-flow/for-loop-container.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="3f5bb-140">**Configurazioni Variabile pacchetto padre** Passano i valori dai pacchetti padre ai pacchetti figlio.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="3f5bb-141">Queste configurazioni consentono ai pacchetti figlio di accedere alle variabili del pacchetto padre.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="3f5bb-142">Se ad esempio il pacchetto figlio deve utilizzare la stessa data del pacchetto padre, sarà possibile definire un tipo di configurazione Variabile pacchetto padre che specifichi un set di variabili tramite la funzione GETDATE nel pacchetto padre.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="3f5bb-143">Per altre informazioni, vedere [Attività Esegui pacchetto](control-flow/execute-package-task.md) e [Configurazioni di pacchetto](../../2014/integration-services/package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="3f5bb-144">**Attività Script e componente script** Forniscono un elenco di variabili di sola lettura e di lettura/scrittura all'attività Script o al componente script, aggiornano le variabili di lettura/scrittura all'interno dello script, quindi usano i valori aggiornati all'interno o all'esterno dello script.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="3f5bb-145">Ad esempio, nel codice `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`la variabile di script `numberOfCars` viene aggiornata dal valore della variabile `NumberOfCars`.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="3f5bb-146">Per altre informazioni, vedere [Utilizzo di variabili nell'attività Script](control-flow/script-task.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="3f5bb-147">Configurazioni e variabili</span><span class="sxs-lookup"><span data-stu-id="3f5bb-147">Configurations and Variables</span></span>  
 <span data-ttu-id="3f5bb-148">Per aggiornare le variabili in modo dinamico, è possibile creare configurazioni per le variabili, distribuirle insieme al pacchetto e quindi aggiornare i valori delle variabili nel file di configurazione quando si distribuiscono i pacchetti.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="3f5bb-149">In fase di esecuzione il pacchetto utilizza i valori di variabile aggiornati.</span><span class="sxs-lookup"><span data-stu-id="3f5bb-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="3f5bb-150">Per altre informazioni, vedere [Creazione di configurazioni dei pacchetti](../../2014/integration-services/create-package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="3f5bb-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="3f5bb-151">Per aggiungere, modificare ed eliminare variabili definite dall'utente</span><span class="sxs-lookup"><span data-stu-id="3f5bb-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="3f5bb-152">Aggiungere, eliminare o modificare l'ambito di una variabile definita dall'utente in un pacchetto</span><span class="sxs-lookup"><span data-stu-id="3f5bb-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="3f5bb-153">Impostazione delle proprietà di una variabile definita dall'utente</span><span class="sxs-lookup"><span data-stu-id="3f5bb-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
