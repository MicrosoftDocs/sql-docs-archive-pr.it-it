---
title: Sintassi (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- expressions [Integration Services], syntax
- syntax [Integration Services]
ms.assetid: 61c053c5-1182-4ad0-b804-51cbd19aa0ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d7be12ee5e0467e3789fbe2771d881d9ae3f25f3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87716456"
---
# <a name="syntax-ssis"></a><span data-ttu-id="751f2-102">Sintassi (SSIS)</span><span class="sxs-lookup"><span data-stu-id="751f2-102">Syntax (SSIS)</span></span>
  <span data-ttu-id="751f2-103">La sintassi delle espressioni di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] è simile a quella utilizzata nei linguaggi C e C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-103">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] expression syntax is similar to the syntax that the C and C# languages use.</span></span> <span data-ttu-id="751f2-104">Le espressioni includono elementi quali identificatori (colonne e variabili), valori letterali, operatori e funzioni.</span><span class="sxs-lookup"><span data-stu-id="751f2-104">Expressions include elements such as identifiers (columns and variables), literals, operators, and functions.</span></span> <span data-ttu-id="751f2-105">In questo argomento vengono riepilogati i requisiti specifici della sintassi dell'analizzatore di espressioni, in relazione ai diversi elementi delle espressioni.</span><span class="sxs-lookup"><span data-stu-id="751f2-105">This topic summarizes the unique requirements of the expression evaluator syntax as they apply to different expression elements.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="751f2-106">Nella versioni precedenti di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]era presente un limite di 4000 caratteri sul risultato della valutazione di un'espressione quando il tipo di dati [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] del risultato era DT_WSTR o DT_STR.</span><span class="sxs-lookup"><span data-stu-id="751f2-106">In previous releases of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], there was a 4000-character limit on the evaluation result of an expression when the result had the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] data type DT_WSTR or DT_STR.</span></span> <span data-ttu-id="751f2-107">Questo limite è stato eliminato.</span><span class="sxs-lookup"><span data-stu-id="751f2-107">This limit has been removed.</span></span>  
  
 <span data-ttu-id="751f2-108">Per esempi di espressioni che usano operatori e funzioni specifiche, vedere l'argomento relativo a ogni operatore e funzione negli argomenti: [Operatori &#40;espressione SSIS&#41;](operators-ssis-expression.md) e [Funzioni &#40;espressione SSIS&#41;](functions-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-108">For sample expressions that use specific operators and functions, see the topic about each operator and function in the topics: [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md) and [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
 <span data-ttu-id="751f2-109">Per esempi di espressioni che usano più operatori e funzioni, nonché identificatori e valori letterali, vedere [Esempi di espressioni avanzate di Integration Services](examples-of-advanced-integration-services-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-109">For sample expressions that use multiple operators and functions as well as identifiers and literals, see [Examples of Advanced Integration Services Expressions](examples-of-advanced-integration-services-expressions.md).</span></span>  
  
 <span data-ttu-id="751f2-110">Per espressioni di esempio da usare nelle espressioni di proprietà, vedere [Usare le espressioni di proprietà nei pacchetti](use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-110">For sample expressions to use in property expressions, see [Use Property Expressions in Packages](use-property-expressions-in-packages.md).</span></span>  
  
## <a name="identifiers"></a><span data-ttu-id="751f2-111">Identificatori</span><span class="sxs-lookup"><span data-stu-id="751f2-111">Identifiers</span></span>  
 <span data-ttu-id="751f2-112">Le espressioni possono includere identificatori di colonna e di variabile.</span><span class="sxs-lookup"><span data-stu-id="751f2-112">Expressions can include column and variable identifiers.</span></span> <span data-ttu-id="751f2-113">È possibile utilizzare colonne esistenti nell'origine dei dati oppure colonne create da trasformazioni nel flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="751f2-113">The columns can originate in the data source or can be created by transformations in the data flow.</span></span> <span data-ttu-id="751f2-114">Nelle espressioni è possibile utilizzare identificatori di derivazione per fare riferimento alle colonne.</span><span class="sxs-lookup"><span data-stu-id="751f2-114">Expressions can use lineage identifiers to refer to columns.</span></span> <span data-ttu-id="751f2-115">Gli identificatori di derivazione sono numeri che identificano in modo univoco gli elementi di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="751f2-115">Lineage identifiers are numbers that uniquely identify package elements.</span></span> <span data-ttu-id="751f2-116">Per fare riferimento a un identificatore di derivazione nell'ambito di un'espressione, è necessario anteporvi un simbolo di cancelletto (#).</span><span class="sxs-lookup"><span data-stu-id="751f2-116">Lineage identifiers, referenced in an expression, must include the pound (#) prefix.</span></span> <span data-ttu-id="751f2-117">Per fare riferimento all'identificatore di derivazione 138, ad esempio, è necessario specificare #138.</span><span class="sxs-lookup"><span data-stu-id="751f2-117">For example, the lineage identifier 138 is referenced using #138.</span></span>  
  
 <span data-ttu-id="751f2-118">Le espressioni possono includere variabili personalizzate e le variabili di sistema disponibili in [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="751f2-118">Expressions can include the system variables that [!INCLUDE[ssIS](../../includes/ssis-md.md)] provides and custom variables.</span></span> <span data-ttu-id="751f2-119">Quando in un'espressione viene fatto riferimento a una variabile, è necessario anteporre il prefisso \@ al nome della variabile.</span><span class="sxs-lookup"><span data-stu-id="751f2-119">Variables, when referenced in an expression, must include the \@ prefix.</span></span> <span data-ttu-id="751f2-120">Per fare riferimento alla variabile `Counter`, ad esempio, è necessario specificare \@Counter.</span><span class="sxs-lookup"><span data-stu-id="751f2-120">For example, the `Counter` variable is referenced using \@Counter.</span></span> <span data-ttu-id="751f2-121">Il carattere \@ non fa parte del nome della variabile, ma consente all'analizzatore di espressioni di identificarla come tale.</span><span class="sxs-lookup"><span data-stu-id="751f2-121">The \@ character is not part of the variable name; it only indicates to the expression evaluator that the identifier is a variable.</span></span> <span data-ttu-id="751f2-122">Per altre informazioni, vedere [Identificatori &#40;SSIS&#41;](identifiers-ssis.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-122">For more information, see [Identifiers &#40;SSIS&#41;](identifiers-ssis.md).</span></span>  
  
## <a name="literals"></a><span data-ttu-id="751f2-123">Valori letterali</span><span class="sxs-lookup"><span data-stu-id="751f2-123">Literals</span></span>  
 <span data-ttu-id="751f2-124">Le espressioni possono includere valori letterali numerici, stringa e booleani.</span><span class="sxs-lookup"><span data-stu-id="751f2-124">Expressions can include numeric, string, and Boolean literals.</span></span> <span data-ttu-id="751f2-125">I valori letterali stringa utilizzati nelle espressioni devono essere racchiusi tra virgolette.</span><span class="sxs-lookup"><span data-stu-id="751f2-125">String literals used in expressions must be enclosed in quotation marks.</span></span> <span data-ttu-id="751f2-126">Le virgolette non devono essere invece utilizzate per i valori letterali numerici e booleani.</span><span class="sxs-lookup"><span data-stu-id="751f2-126">Numeric and Boolean literals do not take quotation marks.</span></span> <span data-ttu-id="751f2-127">Il linguaggio delle espressioni include sequenze di escape per i caratteri di escape più comuni.</span><span class="sxs-lookup"><span data-stu-id="751f2-127">The expression language includes escape sequences for characters that are frequently escaped.</span></span> <span data-ttu-id="751f2-128">Per altre informazioni, vedere [Valori letterali &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-128">For more information, see [Literals &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span></span>  
  
## <a name="operators"></a><span data-ttu-id="751f2-129">Operatori</span><span class="sxs-lookup"><span data-stu-id="751f2-129">Operators</span></span>  
 <span data-ttu-id="751f2-130">L'analizzatore di espressioni fornisce un set di operatori con funzionalità analoghe a quelle offerte dai set di operatori di linguaggi quali Transact-SQL, C++ e C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-130">The expression evaluator provides a set of operators that provides functionality similar to the set of operators in languages such as Transact-SQL, C++, and C#.</span></span> <span data-ttu-id="751f2-131">Oltre a questi, il linguaggio delle espressioni include anche operatori aggiuntivi e utilizza simboli diversi da quelli abitualmente utilizzati in altri linguaggi.</span><span class="sxs-lookup"><span data-stu-id="751f2-131">However, the expression language includes additional operators and uses different symbols than those you may be familiar with.</span></span> <span data-ttu-id="751f2-132">Per altre informazioni, vedere [Operatori &#40;espressione SSIS&#41;](operators-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-132">For more information, see [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md).</span></span>  
  
### <a name="namespace-resolution-operator"></a><span data-ttu-id="751f2-133">Operatore per la risoluzione degli spazi dei nomi</span><span class="sxs-lookup"><span data-stu-id="751f2-133">Namespace Resolution Operator</span></span>  
 <span data-ttu-id="751f2-134">Nelle espressioni è possibile utilizzare l'operatore per la risoluzione degli spazi dei nomi (::) per eliminare le ambiguità dovute alla presenza di variabili con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="751f2-134">Expressions use the namespace resolution operator (::) to disambiguate variables that have the same name.</span></span> <span data-ttu-id="751f2-135">L'operatore per la risoluzione degli spazi dei nomi consente di qualificare ogni variabile con il relativo spazio dei nomi, permettendo così di utilizzare più variabili con lo stesso nome nell'ambito di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="751f2-135">By using the namespace resolution operator, you can qualify the variable with its namespace, which makes it possible to use multiple variables with the same name in a package.</span></span>  
  
#### <a name="cast-operator"></a><span data-ttu-id="751f2-136">Operatore cast</span><span class="sxs-lookup"><span data-stu-id="751f2-136">Cast Operator</span></span>  
 <span data-ttu-id="751f2-137">L'operatore cast consente di convertire da un tipo di dati all'altro i risultati delle espressioni, i valori delle colonne, i valori delle variabili e le costanti.</span><span class="sxs-lookup"><span data-stu-id="751f2-137">The cast operator converts expression results, column values, variable values, and constants from one data type to another.</span></span> <span data-ttu-id="751f2-138">L'operatore cast del linguaggio delle espressioni è simile a quello disponibile nei linguaggi C e C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-138">The cast operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="751f2-139">In Transact-SQL questa funzionalità è offerta dalle funzioni CAST e CONVERT.</span><span class="sxs-lookup"><span data-stu-id="751f2-139">In Transact-SQL, the CAST and CONVERT functions provide this functionality.</span></span> <span data-ttu-id="751f2-140">La sintassi dell'operatore cast presenta tuttavia le seguenti differenze rispetto a quella delle funzioni CAST e CONVERT:</span><span class="sxs-lookup"><span data-stu-id="751f2-140">The syntax of the cast operator is different from ones used by CAST and CONVERT in the following ways:</span></span>  
  
-   <span data-ttu-id="751f2-141">È possibile utilizzare un'espressione come argomento.</span><span class="sxs-lookup"><span data-stu-id="751f2-141">It can use an expression as an argument.</span></span>  
  
-   <span data-ttu-id="751f2-142">La sintassi non include la parola chiave CAST.</span><span class="sxs-lookup"><span data-stu-id="751f2-142">Its syntax does not include the CAST keyword.</span></span>  
  
-   <span data-ttu-id="751f2-143">La sintassi non include la parola chiave AS.</span><span class="sxs-lookup"><span data-stu-id="751f2-143">Its syntax does not include the AS keyword.</span></span>  
  
##### <a name="conditional-operator"></a><span data-ttu-id="751f2-144">Operatore condizionale</span><span class="sxs-lookup"><span data-stu-id="751f2-144">Conditional Operator</span></span>  
 <span data-ttu-id="751f2-145">L'operatore condizionale restituisce una delle due espressioni specificate, in base al valore restituito da un'espressione booleana.</span><span class="sxs-lookup"><span data-stu-id="751f2-145">The conditional operator returns one of two expressions, based on the evaluation of a Boolean expression.</span></span> <span data-ttu-id="751f2-146">L'operatore condizionale del linguaggio delle espressioni è simile a quello disponibile nei linguaggi C e C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-146">The conditional operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="751f2-147">Nelle espressioni MDX questo tipo di funzionalità è offerto dalla funzione IIF.</span><span class="sxs-lookup"><span data-stu-id="751f2-147">In multidimensional expressions (MDX), the IIF function provides similar functionality.</span></span>  
  
###### <a name="logical-operators"></a><span data-ttu-id="751f2-148">Operatori logici</span><span class="sxs-lookup"><span data-stu-id="751f2-148">Logical Operators</span></span>  
 <span data-ttu-id="751f2-149">Il linguaggio delle espressioni supporta il carattere !</span><span class="sxs-lookup"><span data-stu-id="751f2-149">The expression language supports the !</span></span> <span data-ttu-id="751f2-150">per l'operatore NOT logico.</span><span class="sxs-lookup"><span data-stu-id="751f2-150">character for the logical NOT operator.</span></span> <span data-ttu-id="751f2-151">In Transact-SQL l'operatore !</span><span class="sxs-lookup"><span data-stu-id="751f2-151">In Transact-SQL, the !</span></span> <span data-ttu-id="751f2-152">è incorporato nel set degli operatori relazionali.</span><span class="sxs-lookup"><span data-stu-id="751f2-152">operator is built into the set of relational operators.</span></span> <span data-ttu-id="751f2-153">Transact-SQL offre ad esempio gli operatori > e !>.</span><span class="sxs-lookup"><span data-stu-id="751f2-153">For example, Transact-SQL provides the > and the !> operators.</span></span> <span data-ttu-id="751f2-154">Il linguaggio delle espressioni di [!INCLUDE[ssIS](../../includes/ssis-md.md)] non supporta l'uso dell'operatore !</span><span class="sxs-lookup"><span data-stu-id="751f2-154">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] expression language does not support the combination of the !</span></span> <span data-ttu-id="751f2-155">in combinazione con altri operatori.</span><span class="sxs-lookup"><span data-stu-id="751f2-155">operator and other operators.</span></span> <span data-ttu-id="751f2-156">Non è ad esempio possibile combinare !</span><span class="sxs-lookup"><span data-stu-id="751f2-156">For example, it is not valid to combine !</span></span> <span data-ttu-id="751f2-157">e > per ottenere !>.</span><span class="sxs-lookup"><span data-stu-id="751f2-157">and > into !>.</span></span> <span data-ttu-id="751f2-158">Il linguaggio delle espressioni supporta tuttavia la combinazione predefinita di caratteri !=, che rappresenta l'operatore "diverso da".</span><span class="sxs-lookup"><span data-stu-id="751f2-158">However, the expression language does support a built-in != combination of characters for the not-equal-to comparison.</span></span>  
  
###### <a name="equality-operators"></a><span data-ttu-id="751f2-159">Operatori di uguaglianza</span><span class="sxs-lookup"><span data-stu-id="751f2-159">Equality Operators</span></span>  
 <span data-ttu-id="751f2-160">La grammatica dell'analizzatore di espressioni prevede l'operatore di uguaglianza ==,</span><span class="sxs-lookup"><span data-stu-id="751f2-160">The expression evaluator grammar provides the == equality operator.</span></span> <span data-ttu-id="751f2-161">che equivale all'operatore = di Transact-SQL e all'operatore == di C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-161">This operator is the equivalent of the = operator in Transact-SQL and the == operator in C#.</span></span>  
  
## <a name="functions"></a><span data-ttu-id="751f2-162">Funzioni</span><span class="sxs-lookup"><span data-stu-id="751f2-162">Functions</span></span>  
 <span data-ttu-id="751f2-163">Il linguaggio delle espressioni include funzioni di data e ora e funzioni per i valori stringa simili alle funzioni di Transact-SQL e ai metodi di C#.</span><span class="sxs-lookup"><span data-stu-id="751f2-163">The expression language includes date and time functions, mathematical functions, and string functions that are similar to Transact-SQL functions and C# methods.</span></span>  
  
 <span data-ttu-id="751f2-164">Anche se in alcuni casi i nomi delle funzioni dell'analizzatore sono uguali a quelli delle analoghe funzioni di Transact-SQL, esistono tuttavia alcune differenze funzionali.</span><span class="sxs-lookup"><span data-stu-id="751f2-164">A few functions have the same names as Transact-SQL functions, but have subtly different functionality in the expression evaluator.</span></span>  
  
-   <span data-ttu-id="751f2-165">In Transact-SQL la funzione ISNULL sostituisce i valori Null con un valore specificato, mentre la funzione ISNULL dell'analizzatore di espressioni restituisce un valore booleano che indica se l'espressione restituisce Null o meno.</span><span class="sxs-lookup"><span data-stu-id="751f2-165">In Transact-SQL, the ISNULL function replaces null values with a specified value, whereas the expression evaluator ISNULL function returns a Boolean based on whether an expression is null.</span></span>  
  
-   <span data-ttu-id="751f2-166">In Transact-SQL la funzione ROUND include un'opzione che consente di troncare il set di risultati, ma per la funzione ROUND dell'analizzatore di espressioni tale opzione non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="751f2-166">In Transact-SQL, the ROUND function includes an option to truncate the result set, whereas the expression evaluator ROUND function does not.</span></span>  
  
 <span data-ttu-id="751f2-167">Per altre informazioni, vedere [Funzioni &#40;espressione SSIS&#41;](functions-ssis-expression.md).</span><span class="sxs-lookup"><span data-stu-id="751f2-167">For more information, see [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="751f2-168">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="751f2-168">Related Tasks</span></span>  
 [<span data-ttu-id="751f2-169">Usare un'espressione in un componente flusso di dati</span><span class="sxs-lookup"><span data-stu-id="751f2-169">Use an Expression in a Data Flow Component</span></span>](../use-an-expression-in-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="751f2-170">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="751f2-170">Related Content</span></span>  
  
-   <span data-ttu-id="751f2-171">Articolo tecnico relativo al [foglio d'aiuto per le espressioni SSIS](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet)sul sito Web pragmaticworks.com</span><span class="sxs-lookup"><span data-stu-id="751f2-171">Technical article, [SSIS Expression Cheat Sheet](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet), on pragmaticworks.com</span></span>  
  
-   <span data-ttu-id="751f2-172">Articolo tecnico relativo agli [esempi di espressioni SSIS](https://go.microsoft.com/fwlink/?LinkId=220761)nel sito Web social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="751f2-172">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
  
