---
title: Usare espressioni di proprietà nei pacchetti | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635713"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="bbde6-102">utilizzo delle espressioni di proprietà nei pacchetti</span><span class="sxs-lookup"><span data-stu-id="bbde6-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="bbde6-103">Un'espressione di proprietà è un'espressione assegnata a una proprietà per consentire l'aggiornamento dinamico della proprietà in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="bbde6-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="bbde6-104">Un'espressione di proprietà, ad esempio, consente di aggiornare la riga A utilizzata dall'attività Invia messaggi inserendo un indirizzo di posta elettronica archiviato in una variabile.</span><span class="sxs-lookup"><span data-stu-id="bbde6-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="bbde6-105">È possibile aggiungere un'espressione a pacchetti, attività, cicli Foreach, cicli For, sequenze, enumeratori Foreach, gestori eventi, gestioni connessioni a livello di pacchetto o progetto oppure provider di log.</span><span class="sxs-lookup"><span data-stu-id="bbde6-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="bbde6-106">Qualsiasi proprietà di questi oggetti che sia di lettura/scrittura può implementare un'espressione di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="bbde6-107">supporta l'utilizzo delle espressioni di proprietà in alcune proprietà personalizzate di componenti del flusso di dati.</span><span class="sxs-lookup"><span data-stu-id="bbde6-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="bbde6-108">Le variabili e i vincoli di precedenza non supportano le espressioni di proprietà, ma includono speciali proprietà in cui è possibile utilizzare espressioni.</span><span class="sxs-lookup"><span data-stu-id="bbde6-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="bbde6-109">Le espressioni di proprietà possono essere aggiornate in modi diversi:</span><span class="sxs-lookup"><span data-stu-id="bbde6-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="bbde6-110">È possibile includere variabili definite dall'utente nelle configurazioni di pacchetto e aggiornarle quindi in fase di distribuzione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="bbde6-111">In fase di esecuzione l'espressione di proprietà viene valutata in base al valore aggiornato della variabile.</span><span class="sxs-lookup"><span data-stu-id="bbde6-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="bbde6-112">Le variabili di sistema incluse in espressioni vengono aggiornate in fase di esecuzione. Il risultato della valutazione della proprietà è pertanto diverso.</span><span class="sxs-lookup"><span data-stu-id="bbde6-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="bbde6-113">Le funzioni di data e ora, che vengono valutate in fase di esecuzione, passano i valori aggiornati alle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="bbde6-114">Le variabili incluse in espressioni possono essere aggiornate tramite gli script eseguiti dall'attività Script e dal componente Script.</span><span class="sxs-lookup"><span data-stu-id="bbde6-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="bbde6-115">Le espressioni vengono compilate in base al linguaggio delle espressioni di [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bbde6-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="bbde6-116">Nelle espressioni è possibile includere variabili definite dall'utente o di sistema, insieme agli operatori, alle funzioni e ai cast di tipo del linguaggio delle espressioni.</span><span class="sxs-lookup"><span data-stu-id="bbde6-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="bbde6-117">I nomi delle variabili di sistema e delle variabili definite dall'utente devono essere specificati rispettando la distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="bbde6-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="bbde6-118">Per altre informazioni, vedere [Espressioni di Integration Services &#40;SSIS&#41;](integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="bbde6-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="bbde6-119">Un utilizzo importante delle espressioni di proprietà è la personalizzazione delle configurazioni per ogni istanza di pacchetto distribuita.</span><span class="sxs-lookup"><span data-stu-id="bbde6-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="bbde6-120">Ciò consente l'aggiornamento dinamico delle proprietà del pacchetto in ambienti diversi.</span><span class="sxs-lookup"><span data-stu-id="bbde6-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="bbde6-121">È possibile, ad esempio, creare un'espressione di proprietà che assegna una variabile alla stringa di connessione di una gestione connessione e aggiorna quindi la variabile in fase di distribuzione del pacchetto in modo da garantire la validità della stringa di connessione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="bbde6-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="bbde6-122">Le configurazioni di pacchetto vengono caricate prima della valutazione delle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="bbde6-123">Una proprietà può utilizzare una sola espressione di proprietà e a sua volta un'espressione di proprietà può essere applicata a una sola proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="bbde6-124">È tuttavia possibile compilare più espressioni di proprietà identiche e assegnarle a proprietà diverse.</span><span class="sxs-lookup"><span data-stu-id="bbde6-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="bbde6-125">Alcune proprietà vengono impostate utilizzando valori specificati da enumeratori.</span><span class="sxs-lookup"><span data-stu-id="bbde6-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="bbde6-126">Per fare riferimento a un membro di un enumeratore in un'espressione di proprietà, è necessario utilizzare il valore numerico equivalente al nome descrittivo di tale membro dell'enumeratore.</span><span class="sxs-lookup"><span data-stu-id="bbde6-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="bbde6-127">Se ad esempio un'espressione di proprietà imposta la proprietà `LoggingMode` in cui viene utilizzato un valore dell'enumerazione `DTSLoggingMode`, l'espressione di proprietà dovrà utilizzare 0, 1 o 2, anziché i nomi descrittivi `Enabled`, `Disabled` o `UseParentSetting`.</span><span class="sxs-lookup"><span data-stu-id="bbde6-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="bbde6-128">Per altre informazioni, vedere [Costanti enumerate in espressioni di proprietà](enumerated-constants-in-property-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="bbde6-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="bbde6-129">Interfaccia utente delle espressioni di proprietà</span><span class="sxs-lookup"><span data-stu-id="bbde6-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="bbde6-130">offre un set di strumenti per la compilazione e la gestione delle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="bbde6-131">Pagina **Espressioni** degli editor personalizzati delle attività e dei contenitori Ciclo For e Ciclo Foreach.</span><span class="sxs-lookup"><span data-stu-id="bbde6-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="bbde6-132">In pagina **Espressioni** è possibile modificare espressioni e visualizzare un elenco delle espressioni di proprietà usate da un'attività o da un contenitore Ciclo Foreach o Ciclo For.</span><span class="sxs-lookup"><span data-stu-id="bbde6-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="bbde6-133">Finestra **Proprietà** per la modifica di espressioni e la visualizzazione di un elenco delle espressioni di proprietà usate da un pacchetto o dagli oggetti di pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="bbde6-134">Finestra di dialogo **Editor espressioni di proprietà** per la creazione, l'aggiornamento e l'eliminazione di espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="bbde6-135">Finestra di dialogo **Generatore di espressioni** per la compilazione di espressioni tramite strumenti grafici.</span><span class="sxs-lookup"><span data-stu-id="bbde6-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="bbde6-136">In finestra di dialogo **Generatore di espressioni** le espressioni possono venire valutate senza assegnare il risultato alla proprietà in modo da consentirne prima la revisione.</span><span class="sxs-lookup"><span data-stu-id="bbde6-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="bbde6-137">Nella figura seguente si illustrano i componenti dell'interfaccia utente che consentono di aggiungere, modificare e rimuovere espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="bbde6-138">![Interfaccia utente per espressioni di proprietà](../media/ssis-propertyexpressionui.gif "Interfaccia utente per espressioni di proprietà")</span><span class="sxs-lookup"><span data-stu-id="bbde6-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="bbde6-139">Nella finestra **Proprietà** e nella pagina **Espressioni** fare clic sul pulsante Sfoglia **(...)** al livello della raccolta **Espressioni** per aprire la finestra di dialogo **Editor espressioni di proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bbde6-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="bbde6-140">Nella finestra Editor espressioni di proprietà è possibile eseguire il mapping una proprietà a un'espressione e digitare espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="bbde6-141">Se per creare e convalidare l'espressione si vogliono usare gli strumenti grafici, fare clic sul pulsante Sfoglia **(...)** al livello dell'espressione per aprire la finestra di dialogo **Generatore di espressioni**, quindi creare o modificare e facoltativamente convalidare l'espressione.</span><span class="sxs-lookup"><span data-stu-id="bbde6-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="bbde6-142">È possibile accedere alla finestra di dialogo **Generatore di espressioni** anche dalla finestra di dialogo **Editor espressioni di proprietà** .</span><span class="sxs-lookup"><span data-stu-id="bbde6-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="bbde6-143">Per utilizzare le espressioni di proprietà</span><span class="sxs-lookup"><span data-stu-id="bbde6-143">To work with property expressions</span></span>

-   [<span data-ttu-id="bbde6-144">Aggiungere o modificare un'espressione di proprietà</span><span class="sxs-lookup"><span data-stu-id="bbde6-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="bbde6-145">Impostazione di espressioni di proprietà per i componenti dei flussi di dati</span><span class="sxs-lookup"><span data-stu-id="bbde6-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="bbde6-146">Se si crea un pacchetto in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], le proprietà dei componenti di un flusso di dati che supportano espressioni di proprietà vengono esposte sull'attività Flusso di dati a cui appartengono.</span><span class="sxs-lookup"><span data-stu-id="bbde6-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="bbde6-147">Per aggiungere, modificare e rimuovere le espressioni di proprietà dei componenti di un flusso di dati, è necessario fare clic con il pulsante destro del mouse sull'attività Flusso di dati a cui appartengono tali componenti e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bbde6-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="bbde6-148">Nella finestra Proprietà sono elencate le proprietà dei componenti del flusso di dati per le quali è possibile utilizzare espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="bbde6-149">Per creare o modificare un'espressione di proprietà per la proprietà SamplingValue di una trasformazione Campionamento righe in un flusso di dati di nome SampleCustomer, ad esempio, fare clic con il pulsante destro del mouse sull'attività Flusso di dati a cui appartiene la trasformazione Campionamento righe e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bbde6-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="bbde6-150">La proprietà SamplingValue è elencata nella finestra Proprietà, con il formato [SampleCustomer].[SamplingValue].</span><span class="sxs-lookup"><span data-stu-id="bbde6-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="bbde6-151">Nella finestra Proprietà è possibile aggiungere, modificare e rimuovere espressioni di proprietà per i componenti dei flussi di dati come avviene per le espressioni di proprietà degli altri tipi di oggetti di [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bbde6-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="bbde6-152">La finestra Proprietà consente inoltre di accedere alle altre finestre di dialogo e agli altri generatori necessari per aggiungere, modificare o rimuovere espressioni di proprietà per i componenti dei flussi di dati.</span><span class="sxs-lookup"><span data-stu-id="bbde6-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="bbde6-153">Per altre informazioni sulle proprietà dei componenti dei flussi di dati che è possibile aggiornare tramite espressioni di proprietà, vedere [Proprietà personalizzate delle trasformazioni](../data-flow/transformations/transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="bbde6-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="bbde6-154">Caricamento di espressioni di proprietà</span><span class="sxs-lookup"><span data-stu-id="bbde6-154">Loading Property Expressions</span></span>
 <span data-ttu-id="bbde6-155">Non è possibile specificare o controllare il momento in cui avviene il caricamento delle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="bbde6-156">Le espressioni di proprietà vengono valutate e caricate al momento della convalida del pacchetto e degli oggetti di pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="bbde6-157">La convalida avviene quando si salva il pacchetto, quando si apre il pacchetto in Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] e quando si esegue il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="bbde6-158">I valori aggiornati delle proprietà degli oggetti di pacchetto che utilizzano espressioni di proprietà non saranno pertanto disponibili in Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] finché il pacchetto non verrà salvato, eseguito o riaperto dopo l'aggiunta delle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="bbde6-159">Anche le espressioni di proprietà associate ad altri tipi di oggetti, quali gestioni connessioni, provider di log ed enumeratori, vengono caricate al momento della chiamata di metodi specifici del tipo di oggetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="bbde6-160">Le proprietà delle gestioni connessioni, ad esempio, vengono caricate prima della creazione di un'istanza della connessione da parte di [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bbde6-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="bbde6-161">Le espressioni di proprietà vengono caricate dopo il caricamento delle configurazioni di pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="bbde6-162">Le variabili, ad esempio, vengono innanzitutto aggiornate dalle relative configurazioni e quindi vengono valutate e caricate le espressioni di proprietà che utilizzano tali variabili.</span><span class="sxs-lookup"><span data-stu-id="bbde6-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="bbde6-163">Di conseguenza, le espressioni di proprietà utilizzano sempre i valori delle variabili impostati dalle configurazioni.</span><span class="sxs-lookup"><span data-stu-id="bbde6-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="bbde6-164">Non è possibile usare l' `Set` opzione dell'utilità **dtexec** per popolare un'espressione di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="bbde6-165">Nella tabella seguente è indicato quando vengono valutate e caricate le espressioni di proprietà di [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bbde6-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="bbde6-166">Tipo oggetto</span><span class="sxs-lookup"><span data-stu-id="bbde6-166">Object type</span></span>|<span data-ttu-id="bbde6-167">Caricamento e valutazione</span><span class="sxs-lookup"><span data-stu-id="bbde6-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="bbde6-168">Pacchetto, ciclo Foreach, ciclo For, sequenza, attività e componenti dei flussi di dati</span><span class="sxs-lookup"><span data-stu-id="bbde6-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="bbde6-169">Dopo il caricamento delle configurazioni</span><span class="sxs-lookup"><span data-stu-id="bbde6-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="bbde6-170">Prima della convalida</span><span class="sxs-lookup"><span data-stu-id="bbde6-170">Before validation</span></span><br /><br /> <span data-ttu-id="bbde6-171">Prima dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="bbde6-171">Before execution</span></span>|
|<span data-ttu-id="bbde6-172">Gestioni connessioni</span><span class="sxs-lookup"><span data-stu-id="bbde6-172">Connection managers</span></span>|<span data-ttu-id="bbde6-173">Dopo il caricamento delle configurazioni</span><span class="sxs-lookup"><span data-stu-id="bbde6-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="bbde6-174">Prima della convalida</span><span class="sxs-lookup"><span data-stu-id="bbde6-174">Before validation</span></span><br /><br /> <span data-ttu-id="bbde6-175">Prima dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="bbde6-175">Before execution</span></span><br /><br /> <span data-ttu-id="bbde6-176">Prima della creazione di un'istanza della connessione</span><span class="sxs-lookup"><span data-stu-id="bbde6-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="bbde6-177">Provider di log</span><span class="sxs-lookup"><span data-stu-id="bbde6-177">Log providers</span></span>|<span data-ttu-id="bbde6-178">Dopo il caricamento delle configurazioni</span><span class="sxs-lookup"><span data-stu-id="bbde6-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="bbde6-179">Prima della convalida</span><span class="sxs-lookup"><span data-stu-id="bbde6-179">Before validation</span></span><br /><br /> <span data-ttu-id="bbde6-180">Prima dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="bbde6-180">Before execution</span></span><br /><br /> <span data-ttu-id="bbde6-181">Prima dell'apertura dei log</span><span class="sxs-lookup"><span data-stu-id="bbde6-181">Before opening logs</span></span>|
|<span data-ttu-id="bbde6-182">Enumeratori Foreach</span><span class="sxs-lookup"><span data-stu-id="bbde6-182">Foreach enumerators</span></span>|<span data-ttu-id="bbde6-183">Dopo il caricamento delle configurazioni</span><span class="sxs-lookup"><span data-stu-id="bbde6-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="bbde6-184">Prima della convalida</span><span class="sxs-lookup"><span data-stu-id="bbde6-184">Before validation</span></span><br /><br /> <span data-ttu-id="bbde6-185">Prima dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="bbde6-185">Before execution</span></span><br /><br /> <span data-ttu-id="bbde6-186">Prima di ogni enumerazione del ciclo</span><span class="sxs-lookup"><span data-stu-id="bbde6-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="bbde6-187">Utilizzo di espressioni di proprietà nel ciclo Foreach</span><span class="sxs-lookup"><span data-stu-id="bbde6-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="bbde6-188">È spesso consigliabile implementare un'espressione di proprietà per impostare il valore della proprietà `ConnectionString` delle gestioni connessioni utilizzate nel contenitore Ciclo Foreach.</span><span class="sxs-lookup"><span data-stu-id="bbde6-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="bbde6-189">Dopo che l'enumeratore esegue il mapping tra il relativo valore corrente e una variabile in ogni iterazione del ciclo, l'espressione di proprietà può usare il valore di questa variabile per aggiornare dinamicamente il valore della proprietà `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="bbde6-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="bbde6-190">Se si desidera utilizzare espressioni di proprietà con la proprietà `ConnectionString` delle gestioni connessioni per file, più file, file flat e più file flat utilizzate da un ciclo Foreach, sarà necessario tenere conto di alcuni aspetti.</span><span class="sxs-lookup"><span data-stu-id="bbde6-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="bbde6-191">Un pacchetto può essere configurato in modo da eseguire contemporaneamente più file eseguibili impostando la proprietà `MaxConcurrentExecutables` su un valore maggiore di 1 o al valore -1.</span><span class="sxs-lookup"><span data-stu-id="bbde6-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="bbde6-192">Il valore -1 indica che il numero massimo di file eseguibili che possono essere eseguiti contemporaneamente è uguale al numero di processori più due.</span><span class="sxs-lookup"><span data-stu-id="bbde6-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="bbde6-193">Per evitare conseguenze negative dell'esecuzione parallela di file eseguibili, il valore di `MaxConcurrentExecutables` deve essere impostato su 1.</span><span class="sxs-lookup"><span data-stu-id="bbde6-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="bbde6-194">Se la proprietà `MaxConcurrentExecutables` non è impostata su 1, il valore della proprietà `ConnectionString` non può essere garantito e i risultati sono imprevedibili.</span><span class="sxs-lookup"><span data-stu-id="bbde6-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="bbde6-195">Considerare, ad esempio, un ciclo Foreach che enumera i file in una cartella, recupera i nomi dei file e quindi utilizza l'attività Esegui SQL per inserire ogni nome di file in una tabella.</span><span class="sxs-lookup"><span data-stu-id="bbde6-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="bbde6-196">Se la proprietà `MaxConcurrentExecutables` non è impostata su 1 e due istanze dell'attività Esegui SQL tentano di scrivere contemporaneamente nella tabella, potrebbero verificarsi conflitti di scrittura.</span><span class="sxs-lookup"><span data-stu-id="bbde6-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="bbde6-197">Espressioni di proprietà di esempio</span><span class="sxs-lookup"><span data-stu-id="bbde6-197">Sample Property Expressions</span></span>
 <span data-ttu-id="bbde6-198">Le espressioni di esempio seguenti illustrano l'utilizzo di variabili di sistema, operatori, funzioni e valori letterali stringa nelle espressioni di proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="bbde6-199">Espressione di proprietà per la proprietà LoggingMode di un pacchetto</span><span class="sxs-lookup"><span data-stu-id="bbde6-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="bbde6-200">L'espressione di proprietà seguente consente di impostare la proprietà LoggingMode di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="bbde6-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="bbde6-201">Nell'espressione sono utilizzate le funzioni DAY e GETDATE per ottenere un valore intero che rappresenta la parte del giorno in una data.</span><span class="sxs-lookup"><span data-stu-id="bbde6-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="bbde6-202">Se il numero del giorno è 1 o 15, la registrazione verrà abilitata, altrimenti sarà disabilitata.</span><span class="sxs-lookup"><span data-stu-id="bbde6-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="bbde6-203">Il valore 1 è l'intero equivalente del membro dell'enumeratore LoggingMode `Enabled` e il valore 2 è l'intero equivalente del membro `Disabled` .</span><span class="sxs-lookup"><span data-stu-id="bbde6-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="bbde6-204">Nell'espressione è necessario utilizzare il valore numerico corrispondente al nome del membro desiderato dell'enumeratore.</span><span class="sxs-lookup"><span data-stu-id="bbde6-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="bbde6-205">Espressione di proprietà per la riga Oggetto di un messaggio di posta elettronica</span><span class="sxs-lookup"><span data-stu-id="bbde6-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="bbde6-206">L'espressione di proprietà seguente consente di impostare la proprietà Subject dell'attività Invia messaggi e di inserire un testo appropriato nel messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="bbde6-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="bbde6-207">Nell'espressione vengono utilizzati valori letterali stringa, variabili di sistema, l'operatore di concatenazione (+), l'operatore cast e le funzioni DATEDIFF e GETDATE.</span><span class="sxs-lookup"><span data-stu-id="bbde6-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="bbde6-208">Le variabili di sistema sono `PackageName` e `StartTime` .</span><span class="sxs-lookup"><span data-stu-id="bbde6-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="bbde6-209">Se il nome del pacchetto è EmailRowCountPP, eseguito il 3/4/2005, con durata di esecuzione di 9 secondi, l'espressione viene valutata nella stringa seguente.</span><span class="sxs-lookup"><span data-stu-id="bbde6-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="bbde6-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span><span class="sxs-lookup"><span data-stu-id="bbde6-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="bbde6-211">Espressione di proprietà per il testo di un messaggio di posta elettronica</span><span class="sxs-lookup"><span data-stu-id="bbde6-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="bbde6-212">L'espressione di proprietà seguente consente di impostare la proprietà MessageSource dell'attività Invia messaggi.</span><span class="sxs-lookup"><span data-stu-id="bbde6-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="bbde6-213">Nell'espressione vengono utilizzati valori letterali stringa, variabili definite dall'utente e l'operatore di concatenazione (+).</span><span class="sxs-lookup"><span data-stu-id="bbde6-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="bbde6-214">Le variabili definite dall'utente sono denominate `nasdaqrawrows`, `nyserawrows`e `amexrawrows`.</span><span class="sxs-lookup"><span data-stu-id="bbde6-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="bbde6-215">La stringa "\n" indica un ritorno a capo.</span><span class="sxs-lookup"><span data-stu-id="bbde6-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="bbde6-216">Se `nasdaqrawrows` è 7058, `nyserawrows` è 3528 e `amexrawrows` è 1102, l'espressione restituisce la stringa seguente.</span><span class="sxs-lookup"><span data-stu-id="bbde6-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="bbde6-217">Rows Processed:</span><span class="sxs-lookup"><span data-stu-id="bbde6-217">Rows Processed:</span></span>

 <span data-ttu-id="bbde6-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="bbde6-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="bbde6-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="bbde6-219">NYSE: 3528</span></span>

 <span data-ttu-id="bbde6-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="bbde6-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="bbde6-221">Espressione di proprietà per la proprietà Executable dell'attività Esegui processo</span><span class="sxs-lookup"><span data-stu-id="bbde6-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="bbde6-222">L'espressione di proprietà seguente consente di impostare la proprietà Executable dell'attività Esegui processo.</span><span class="sxs-lookup"><span data-stu-id="bbde6-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="bbde6-223">Nell'espressione viene utilizzata una combinazione di valori letterali stringa, operatori e funzioni,</span><span class="sxs-lookup"><span data-stu-id="bbde6-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="bbde6-224">e precisamente le funzioni DATEPART e GETDATE e l'operatore condizionale.</span><span class="sxs-lookup"><span data-stu-id="bbde6-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="bbde6-225">Se la data odierna corrisponde al secondo giorno della settimana, l'attività Esegui processo esegue notepad.exe. In caso contrario esegue mspaint.exe.</span><span class="sxs-lookup"><span data-stu-id="bbde6-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="bbde6-226">Espressione di proprietà per la proprietà ConnectionString di una gestione connessione file flat</span><span class="sxs-lookup"><span data-stu-id="bbde6-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="bbde6-227">L'espressione di proprietà seguente consente di impostare la proprietà ConnectionString di una gestione connessione file flat.</span><span class="sxs-lookup"><span data-stu-id="bbde6-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="bbde6-228">Nell'espressione viene utilizzata una sola variabile definita dall'utente, ovvero la variabile `myfilenamefull`, che specifica il percorso di un file di testo.</span><span class="sxs-lookup"><span data-stu-id="bbde6-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="bbde6-229">È possibile accedere alle espressioni di proprietà per le gestioni connessioni solo tramite la finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="bbde6-230">Per visualizzare le proprietà di una gestione connessione, è necessario selezionare la gestione connessione nella sezione **Gestioni connessioni** di Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , quando la finestra Proprietà è aperta, oppure fare clic con il pulsante destro del mouse sulla gestione connessione e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bbde6-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="bbde6-231">Espressione di proprietà per la proprietà ConfigString di un provider di log File di testo</span><span class="sxs-lookup"><span data-stu-id="bbde6-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="bbde6-232">L'espressione di proprietà seguente consente di impostare la proprietà ConfigString di un provider di log File di testo.</span><span class="sxs-lookup"><span data-stu-id="bbde6-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="bbde6-233">Nell'espressione viene usata una sola variabile definita dall'utente, ovvero la variabile `varConfigString`, che contiene il nome della gestione connessione file da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="bbde6-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="bbde6-234">La gestione connessione file specifica il percorso del file di testo in cui verranno scritte le voci di log.</span><span class="sxs-lookup"><span data-stu-id="bbde6-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="bbde6-235">È possibile accedere alle espressioni di proprietà per i provider di log solo tramite la finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="bbde6-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="bbde6-236">Per visualizzare le proprietà di un provider di log, è necessario selezionare il provider di log nella scheda **Esplora pacchetti** di Progettazione [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , quando la finestra Proprietà è aperta, oppure fare clic con il pulsante destro del mouse sul provider log in Esplora pacchetti e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bbde6-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="bbde6-237">Risorse esterne</span><span class="sxs-lookup"><span data-stu-id="bbde6-237">External Resources</span></span>

-   [<span data-ttu-id="bbde6-238">Espressione e Highlighter di configurazione (Progetto CodePlex)</span><span class="sxs-lookup"><span data-stu-id="bbde6-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="bbde6-239">Articolo tecnico relativo agli [esempi di espressioni SSIS](https://go.microsoft.com/fwlink/?LinkId=220761)nel sito Web social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="bbde6-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="bbde6-240">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="bbde6-240">See Also</span></span>
 [<span data-ttu-id="bbde6-241">Uso di variabili nei pacchetti</span><span class="sxs-lookup"><span data-stu-id="bbde6-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


