---
title: Compilazione, distribuzione e debug di oggetti personalizzati | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- custom objects [Integration Services]
ms.assetid: b03685bc-5398-4c3f-901a-1219c1098fbe
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 13157fce4e5c7dd8987f4950a6b4250ea0e36094
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721627"
---
# <a name="building-deploying-and-debugging-custom-objects"></a><span data-ttu-id="36aa7-102">Compilazione, distribuzione e debug di oggetti personalizzati</span><span class="sxs-lookup"><span data-stu-id="36aa7-102">Building, Deploying, and Debugging Custom Objects</span></span>
  <span data-ttu-id="36aa7-103">Dopo avere scritto il codice per un oggetto personalizzato per [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], è necessario compilare l'assembly, distribuirlo, integrarlo in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)] per renderlo disponibile per l'utilizzo nei pacchetti, quindi sottoporlo a test e debug.</span><span class="sxs-lookup"><span data-stu-id="36aa7-103">After you have written the code for a custom object for [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], you must build the assembly, deploy it, integrate it into [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer to make it available for use in packages, and test and debug it.</span></span>

##  <a name="steps-in-building-deploying-and-debugging-a-custom-object-for-integration-services"></a><a name="top"></a><span data-ttu-id="36aa7-104">Passaggi per la compilazione, la distribuzione e il debug di un oggetto personalizzato per Integration Services</span><span class="sxs-lookup"><span data-stu-id="36aa7-104">Steps in Building, Deploying, and Debugging a Custom Object for Integration Services</span></span>
 <span data-ttu-id="36aa7-105">La funzionalità personalizzata per l'oggetto è già stata scritta.</span><span class="sxs-lookup"><span data-stu-id="36aa7-105">You have already written the custom functionality for your object.</span></span> <span data-ttu-id="36aa7-106">A questo punto, è necessario testarla e renderla disponibile per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="36aa7-106">Now you have to test it and to make it available to users.</span></span> <span data-ttu-id="36aa7-107">I passaggi sono molto simili per tutti i tipi di oggetti personalizzati che è possibile creare per [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-107">The steps are very similar for all the types of custom objects that you can create for [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span>

 <span data-ttu-id="36aa7-108">Di seguito sono riportati i passaggi da completare per la compilazione, la distribuzione e il debug:</span><span class="sxs-lookup"><span data-stu-id="36aa7-108">Here are the steps that you follow in building, deploying, and debugging it:</span></span>

1.  <span data-ttu-id="36aa7-109">[Firmare](#signing) l'assembly da generare con un nome sicuro.</span><span class="sxs-lookup"><span data-stu-id="36aa7-109">[Sign](#signing) the assembly to be generated with a strong name.</span></span>

2.  <span data-ttu-id="36aa7-110">[Compilare](#building) l'assembly.</span><span class="sxs-lookup"><span data-stu-id="36aa7-110">[Build](#building) the assembly.</span></span>

3.  <span data-ttu-id="36aa7-111">[Distribuire](#deploying) l'assembly spostandolo o copiandolo nella cartella di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] appropriata.</span><span class="sxs-lookup"><span data-stu-id="36aa7-111">[Deploy](#deploying) the assembly by moving or copying it to the appropriate [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] folder.</span></span>

4.  <span data-ttu-id="36aa7-112">[Installare](#installing) l'assembly nella Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="36aa7-112">[Install](#installing) the assembly in the global assembly cache (GAC).</span></span>

     <span data-ttu-id="36aa7-113">L'oggetto viene automaticamente aggiunto alla Casella degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="36aa7-113">The object is automatically added to the Toolbox.</span></span>

5.  <span data-ttu-id="36aa7-114">Se necessario, [risolvere i problemi](#troubleshooting) della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="36aa7-114">[Troubleshoot](#troubleshooting) the deployment, if necessary.</span></span>

6.  <span data-ttu-id="36aa7-115">[Eseguire il test](#testing) e il debug del codice.</span><span class="sxs-lookup"><span data-stu-id="36aa7-115">[Test](#testing) and debug your code.</span></span>

##  <a name="signing-the-assembly"></a><a name="signing"></a> <span data-ttu-id="36aa7-116">Firma dell'assembly</span><span class="sxs-lookup"><span data-stu-id="36aa7-116">Signing the Assembly</span></span>
 <span data-ttu-id="36aa7-117">Quando un assembly deve essere condiviso, è necessario installarlo nella Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="36aa7-117">When an assembly is meant to be shared, it must be installed in the global assembly cache.</span></span> <span data-ttu-id="36aa7-118">Una volta aggiunto alla Global Assembly Cache, l'assembly può essere utilizzato da applicazioni come [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-118">After the assembly has been added to the global assembly cache, the assembly can be used by applications such as [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="36aa7-119">Un requisito della Global Assembly Cache è che l'assembly deve essere firmato con un nome sicuro che garantisca che sia globalmente univoco.</span><span class="sxs-lookup"><span data-stu-id="36aa7-119">A requirement of the global assembly cache is that the assembly must be signed with a strong name, which guarantees that an assembly is globally unique.</span></span> <span data-ttu-id="36aa7-120">Un assembly con nome sicuro dispone di un nome completo che include il nome, la lingua, la chiave pubblica e il numero di versione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="36aa7-120">A strong-named assembly has a fully qualified name that includes the name, culture, public key, and version number of the assembly.</span></span> <span data-ttu-id="36aa7-121">Tali informazioni vengono utilizzate dal runtime per individuare l'assembly e distinguerlo da altri assembly aventi lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="36aa7-121">The runtime uses this information to locate the assembly and to differentiate it from other assemblies with the same name.</span></span>

 <span data-ttu-id="36aa7-122">Per firmare un assembly con un nome sicuro, è innanzitutto necessario avere o creare una coppia di chiavi pubblica/privata.</span><span class="sxs-lookup"><span data-stu-id="36aa7-122">To sign an assembly with a strong name, you must first have or create a public/private key pair.</span></span> <span data-ttu-id="36aa7-123">Questa coppia di chiavi di crittografia, pubblica e privata, viene utilizzata durante la compilazione per creare un assembly con nome sicuro.</span><span class="sxs-lookup"><span data-stu-id="36aa7-123">This public and private cryptographic key pair is used at build time to create a strong-named assembly.</span></span>

 <span data-ttu-id="36aa7-124">Per ulteriori informazioni sui nomi sicuri e sui passaggi che è necessario eseguire per firmare un assembly, vedere gli argomenti seguenti nella documentazione relativa a [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] SDK:</span><span class="sxs-lookup"><span data-stu-id="36aa7-124">For more information about strong names and on the steps that you must followto sign an assembly, see the following topics in the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] SDK documentation:</span></span>

-   <span data-ttu-id="36aa7-125">Assembly con nomi sicuri</span><span class="sxs-lookup"><span data-stu-id="36aa7-125">Strong-Named Assemblies</span></span>

-   <span data-ttu-id="36aa7-126">Creazione di una coppia di chiavi</span><span class="sxs-lookup"><span data-stu-id="36aa7-126">Creating a Key Pair</span></span>

-   <span data-ttu-id="36aa7-127">Firma di un assembly con un nome sicuro</span><span class="sxs-lookup"><span data-stu-id="36aa7-127">Signing an Assembly with a Strong Name</span></span>

 <span data-ttu-id="36aa7-128">È possibile firmare facilmente l'assembly con un nome sicuro in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] durante la compilazione.</span><span class="sxs-lookup"><span data-stu-id="36aa7-128">You can easily sign your assembly with a strong name in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] at build time.</span></span> <span data-ttu-id="36aa7-129">Nella finestra di dialogo **Proprietà progetto** selezionare la scheda **firma** . Selezionare l'opzione per **firmare l'assembly** e quindi specificare il percorso del file di chiave (con estensione snk).</span><span class="sxs-lookup"><span data-stu-id="36aa7-129">In the **Project Properties** dialog box, select the **Signing** tab. Select the option to **Sign the assembly** and then provide the path of the key (.snk) file.</span></span>

##  <a name="building-the-assembly"></a><a name="building"></a> <span data-ttu-id="36aa7-130">Compilazione dell'assembly</span><span class="sxs-lookup"><span data-stu-id="36aa7-130">Building the Assembly</span></span>
 <span data-ttu-id="36aa7-131">Dopo aver firmato il progetto, è necessario compilare o ricompilare il progetto o la soluzione tramite i comandi disponibili nel menu **Compila** di [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-131">After signing the project, you must build or rebuild the project or the solution by using the commands available on the **Build** menu of [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].</span></span> <span data-ttu-id="36aa7-132">La soluzione può contenere un progetto distinto per un'interfaccia utente personalizzata, che deve essere firmato con un nome sicuro e può essere compilato contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-132">Your solution may contain a separate project for a custom user interface, which must also be signed with a strong name, and can be built at the same time.</span></span>

 <span data-ttu-id="36aa7-133">Il metodo più semplice per eseguire i due passaggi successivi, ovvero la distribuzione dell'assembly e l'installazione nella Global Assembly Cache, consiste nel generare script per questi passaggi come evento di post-compilazione in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-133">The most convenient method for performing the next two steps-deploying the assembly and installing it in the global assembly cache-is to script these steps as a post-build event in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="36aa7-134">Gli eventi di compilazione sono disponibili dalla pagina **Compilazione** di Proprietà progetto per un progetto [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] e dalla pagina **Eventi di compilazione** per un progetto C#.</span><span class="sxs-lookup"><span data-stu-id="36aa7-134">Build events are available from the **Compile** page of Project Properties for a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] project, and from the **Build Events** page for a C# project.</span></span> <span data-ttu-id="36aa7-135">Per utilità del prompt dei comandi come **gacutil.exe** è necessario specificare il percorso completo.</span><span class="sxs-lookup"><span data-stu-id="36aa7-135">The full path is required for command prompt utilities such as **gacutil.exe**.</span></span> <span data-ttu-id="36aa7-136">È necessario racchiudere tra virgolette i percorsi che contengono spazi e le macro, ad esempio $(TargetPath), che si espandono in percorsi che contengono spazi.</span><span class="sxs-lookup"><span data-stu-id="36aa7-136">Quotation marks are required both around paths that contain spaces and around macros such as $(TargetPath) that expand to paths that contain spaces.</span></span>

 <span data-ttu-id="36aa7-137">Di seguito è riportato un esempio di una riga di comando per eventi di post-compilazione per un provider di log personalizzato:</span><span class="sxs-lookup"><span data-stu-id="36aa7-137">Here is an example of a post-build event command line for a custom log provider:</span></span>

```
"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\gacutil.exe" -u $(TargetName)
"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\gacutil.exe" -i $(TargetFileName)
copy $(TargetFileName) "C:\Program Files\Microsoft SQL Server\120\DTS\LogProviders "
```

##  <a name="deploying-the-assembly"></a><a name="deploying"></a> <span data-ttu-id="36aa7-138">Distribuzione dell'assembly</span><span class="sxs-lookup"><span data-stu-id="36aa7-138">Deploying the Assembly</span></span>
 <span data-ttu-id="36aa7-139">La [!INCLUDE[ssIS](../../includes/ssis-md.md)] finestra di progettazione individua gli oggetti personalizzati disponibili per l'utilizzo nei pacchetti enumerando i file trovati in una serie di cartelle create durante l' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] installazione di.</span><span class="sxs-lookup"><span data-stu-id="36aa7-139">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer locates the custom objects available for use in packages by enumerating the files found in a series of folders that are created when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] is installed.</span></span> <span data-ttu-id="36aa7-140">Quando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] si utilizzano le impostazioni di installazione predefinite, questo set di cartelle si trova in **C:\Programmi\Microsoft SQL Server\120\DTS**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-140">When the default [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation settings are used, this set of folders is located under **C:\Program Files\Microsoft SQL Server\120\DTS**.</span></span> <span data-ttu-id="36aa7-141">Tuttavia, se si crea un programma di installazione per l'oggetto personalizzato, è necessario controllare il valore della chiave del registro di sistema **\SOFTWARE\MICROSOFT\MICROSOFT SQL Server\120\SSIS\Setup\DtsPath di HKEY_LOCAL_MACHINE** per verificare il percorso della cartella.</span><span class="sxs-lookup"><span data-stu-id="36aa7-141">However if you create a setup program for your custom object, you should check the value of the **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\120\SSIS\Setup\DtsPath** registry key to verify the location of this folder.</span></span>

 <span data-ttu-id="36aa7-142">È possibile inserire l'assembly nella cartella in due modi:</span><span class="sxs-lookup"><span data-stu-id="36aa7-142">You can put the assembly in the folder in two ways:</span></span>

-   <span data-ttu-id="36aa7-143">Spostare o copiare l'assembly compilato nella cartella appropriata dopo averlo compilato.</span><span class="sxs-lookup"><span data-stu-id="36aa7-143">Move or copy the compiled assembly to the appropriate folder after building it.</span></span> <span data-ttu-id="36aa7-144">Per praticità, è possibile includere il comando di copia in un evento di post-compilazione.</span><span class="sxs-lookup"><span data-stu-id="36aa7-144">(For convenience, you can include the copy command in a Post-build Event.)</span></span>

-   <span data-ttu-id="36aa7-145">Compilare l'assembly direttamente nella cartella appropriata.</span><span class="sxs-lookup"><span data-stu-id="36aa7-145">Build the assembly directly in the appropriate folder.</span></span>

 <span data-ttu-id="36aa7-146">Le seguenti cartelle di distribuzione in **C:\Programmi\Microsoft SQL Server\120\DTS** vengono utilizzate per i vari tipi di oggetti personalizzati:</span><span class="sxs-lookup"><span data-stu-id="36aa7-146">The following deployment folders under **C:\Program Files\Microsoft SQL Server\120\DTS** are used for the various types of custom objects:</span></span>

|<span data-ttu-id="36aa7-147">Oggetto personalizzato</span><span class="sxs-lookup"><span data-stu-id="36aa7-147">Custom object</span></span>|<span data-ttu-id="36aa7-148">Cartella di distribuzione</span><span class="sxs-lookup"><span data-stu-id="36aa7-148">Deployment folder</span></span>|
|-------------------|-----------------------|
|<span data-ttu-id="36aa7-149">Attività</span><span class="sxs-lookup"><span data-stu-id="36aa7-149">Task</span></span>|<span data-ttu-id="36aa7-150">Attività</span><span class="sxs-lookup"><span data-stu-id="36aa7-150">Tasks</span></span>|
|<span data-ttu-id="36aa7-151">Gestione connessione</span><span class="sxs-lookup"><span data-stu-id="36aa7-151">Connection manager</span></span>|<span data-ttu-id="36aa7-152">Connessioni</span><span class="sxs-lookup"><span data-stu-id="36aa7-152">Connections</span></span>|
|<span data-ttu-id="36aa7-153">Provider di log</span><span class="sxs-lookup"><span data-stu-id="36aa7-153">Log provider</span></span>|<span data-ttu-id="36aa7-154">LogProviders</span><span class="sxs-lookup"><span data-stu-id="36aa7-154">LogProviders</span></span>|
|<span data-ttu-id="36aa7-155">Componente del flusso di dati</span><span class="sxs-lookup"><span data-stu-id="36aa7-155">Data flow component</span></span>|<span data-ttu-id="36aa7-156">PipelineComponents</span><span class="sxs-lookup"><span data-stu-id="36aa7-156">PipelineComponents</span></span>|

> [!NOTE]
>  <span data-ttu-id="36aa7-157">Gli assembly vengono copiati in queste cartelle per supportare l'enumerazione degli oggetti personalizzati disponibili, quali attività, gestioni connessioni e così via.</span><span class="sxs-lookup"><span data-stu-id="36aa7-157">Assemblies are copied to these folders to support the enumeration of available tasks, connection managers, and so on.</span></span> <span data-ttu-id="36aa7-158">Pertanto, non è necessario distribuire in queste cartelle gli assembly che contengono solo l'interfaccia utente personalizzata per gli oggetti personalizzati.</span><span class="sxs-lookup"><span data-stu-id="36aa7-158">Therefore you do not have to deploy assemblies that contain only the custom user interface for custom objects to these folders.</span></span>

##  <a name="installing-the-assembly-in-the-global-assembly-cache"></a><a name="installing"></a><span data-ttu-id="36aa7-159">Installazione dell'assembly nella Global Assembly Cache</span><span class="sxs-lookup"><span data-stu-id="36aa7-159">Installing the Assembly in the Global Assembly Cache</span></span>
 <span data-ttu-id="36aa7-160">Per installare l'assembly attività nella Global Assembly Cache, usare lo strumento da riga di comando **gacutil.exe** oppure trascinare gli assembly nella directory `%system%\assembly`.</span><span class="sxs-lookup"><span data-stu-id="36aa7-160">To install the task assembly into the global assembly cache (GAC), use the command line tool **gacutil.exe**, or drag the assemblies to the `%system%\assembly` directory.</span></span> <span data-ttu-id="36aa7-161">Per praticità, è anche possibile includere la chiamata a **gacutil.exe** in un evento di post-compilazione.</span><span class="sxs-lookup"><span data-stu-id="36aa7-161">For convenience, you can also include the call to **gacutil.exe** in a Post-build Event.</span></span>

 <span data-ttu-id="36aa7-162">Il comando seguente installa un componente denominato *MyTask.dll* nella Global Assembly Cache tramite **gacutil.exe**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-162">The following command installs a component named *MyTask.dll* into the GAC by using **gacutil.exe**.</span></span>

 `gacutil /iF MyTask.dll`

 <span data-ttu-id="36aa7-163">Dopo l'installazione di una nuova versione dell'oggetto personalizzato, è necessario chiudere e riaprire Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-163">You must close and reopen [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer after you install a new version of your custom object.</span></span> <span data-ttu-id="36aa7-164">Se sono state installate versioni precedenti dell'oggetto personalizzato nella Global Assembly Cache, è necessario rimuoverle prima di installare la nuova versione.</span><span class="sxs-lookup"><span data-stu-id="36aa7-164">If you have installed earlier versions of your custom object in the global assembly cache, you must remove them before installing the new version.</span></span> <span data-ttu-id="36aa7-165">Per disinstallare un assembly, eseguire **gacutil.exe** e specificare il nome dell'assembly con l'opzione `/u`.</span><span class="sxs-lookup"><span data-stu-id="36aa7-165">To uninstall an assembly, run **gacutil.exe** and specify the assembly name with the `/u` option.</span></span>

 <span data-ttu-id="36aa7-166">Per ulteriori informazioni sulla Global Assembly Cache, vedere lo strumento corrispondente (Gactutil.exe) in [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] Tools.</span><span class="sxs-lookup"><span data-stu-id="36aa7-166">For more information about the global assembly cache, see Global Assembly Cache Tool (Gactutil.exe) in the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] Tools.</span></span>

##  <a name="troubleshooting-the-deployment"></a><a name="troubleshooting"></a> <span data-ttu-id="36aa7-167">Risoluzione dei problemi della distribuzione</span><span class="sxs-lookup"><span data-stu-id="36aa7-167">Troubleshooting the Deployment</span></span>
 <span data-ttu-id="36aa7-168">Se l'oggetto personalizzato è visualizzato nella **casella degli strumenti** o nell'elenco di oggetti disponibili ma non è possibile aggiungerlo a un pacchetto, provare a effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="36aa7-168">If your custom object appears in the **Toolbox** or the list of available objects, but you are not able to add it to a package, try the following:</span></span>

1.  <span data-ttu-id="36aa7-169">Verificare se nella Global Assembly Cache sono disponibili più versioni del componente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-169">Look in the global assembly cache for multiple versions of your component.</span></span> <span data-ttu-id="36aa7-170">In caso affermativo, è possibile che la finestra di progettazione non sia in grado di caricare il componente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-170">If there are multiple versions of the component in the global assembly cache, the designer may not be able to load your component.</span></span> <span data-ttu-id="36aa7-171">Eliminare tutte le istanze dell'assembly dalla Global Assembly Cache, quindi aggiungere nuovamente l'assembly.</span><span class="sxs-lookup"><span data-stu-id="36aa7-171">Delete all instances of the assembly from the global assembly cache, and re-add the assembly.</span></span>

2.  <span data-ttu-id="36aa7-172">Verificare che nella cartella di distribuzione esista una singola istanza dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="36aa7-172">Make sure that only a single instance of the assembly exists in the deployment folder.</span></span>

3.  <span data-ttu-id="36aa7-173">Aggiornare la casella degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="36aa7-173">Refresh the Toolbox.</span></span>

4.  <span data-ttu-id="36aa7-174">Connettere [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] a **devenv.exe** e impostare un punto di interruzione per eseguire le istruzioni del codice di inizializzazione e assicurarsi che non si verifichino eccezioni.</span><span class="sxs-lookup"><span data-stu-id="36aa7-174">Attach [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] to **devenv.exe** and set a breakpoint to step through your initialization code to ensure that no exceptions occur.</span></span>

##  <a name="testing-and-debugging-your-code"></a><a name="testing"></a> <span data-ttu-id="36aa7-175">Test e debug del codice</span><span class="sxs-lookup"><span data-stu-id="36aa7-175">Testing and Debugging Your Code</span></span>
 <span data-ttu-id="36aa7-176">L'approccio più semplice per l'esecuzione del debug dei metodi di runtime di un oggetto personalizzato consiste nell'avviare **dtexec.exe** da [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] dopo aver compilato l'oggetto e nell'eseguire quindi un pacchetto che usa il componente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-176">The simplest approach to debugging the run-time methods of a custom object is to start **dtexec.exe** from [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] after building your custom object and run a package that uses the component.</span></span>

 <span data-ttu-id="36aa7-177">Se si desidera eseguire il debug dei metodi della fase di progettazione del componente, ad esempio il `Validate` metodo, aprire un pacchetto che utilizza il componente in una seconda istanza di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] e connettersi al relativo **devenv.exe** processo.</span><span class="sxs-lookup"><span data-stu-id="36aa7-177">If you want to debug the component's design-time methods, such as the `Validate` method, open a package that uses the component in a second instance of [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], and attach to its **devenv.exe** process.</span></span>

 <span data-ttu-id="36aa7-178">Se si vuole eseguire il debug anche dei metodi di runtime del componente quando un pacchetto è aperto e in esecuzione in Progettazione [!INCLUDE[ssIS](../../includes/ssis-md.md)], è necessario forzare una pausa nell'esecuzione del pacchetto in modo che sia possibile connettersi anche al processo **DtsDebugHost.exe**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-178">If you also want to debug the component's run-time methods when a package is open and running in [!INCLUDE[ssIS](../../includes/ssis-md.md)] designer, you must force a pause in the execution of the package so that you can also attach to the **DtsDebugHost.exe** process.</span></span>

#### <a name="to-debug-an-objects-run-time-methods-by-attaching-to-dtexecexe"></a><span data-ttu-id="36aa7-179">Per eseguire il debug dei metodi di runtime di un oggetto tramite connessione a dtexec.exe</span><span class="sxs-lookup"><span data-stu-id="36aa7-179">To debug an object's run-time methods by attaching to dtexec.exe</span></span>

1.  <span data-ttu-id="36aa7-180">Firmare e compilare il progetto nella configurazione di debug, distribuirlo e installarlo nella Global Assembly Cache come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="36aa7-180">Sign and build your project in the Debug configuration, deploy it, and install it in the global assembly cache as described in this topic.</span></span>

2.  <span data-ttu-id="36aa7-181">Nella scheda **debug** di **Proprietà progetto**Selezionare **Avvia programma esterno** come **azione di avvio**e individuare **dtexec.exe**, che viene installato per impostazione predefinita in c:\Programmi\Microsoft SQL Server\120\DTS\Binn.</span><span class="sxs-lookup"><span data-stu-id="36aa7-181">On the **Debug** tab of **Project Properties**, select **Start external program** as the **Start Action**, and locate **dtexec.exe**, which is installed by default in C:\Program Files\Microsoft SQL Server\120\DTS\Binn.</span></span>

3.  <span data-ttu-id="36aa7-182">Nella casella di testo **Opzioni della riga di comando** in **Opzioni di avvio** immettere gli argomenti della riga di comando richiesti per eseguire un pacchetto in cui viene usato il componente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-182">In the **Command line options** text box, under **Start Options**, enter the command line arguments required to run a package that uses your component.</span></span> <span data-ttu-id="36aa7-183">In genere l'argomento della riga di comando sarà costituito dall'opzione /F[ILE] seguita dal percorso e dal nome del file con estensione dtsx.</span><span class="sxs-lookup"><span data-stu-id="36aa7-183">Often the command-line argument will consist of the /F[ILE] switch followed by the path and file name of the .dtsx file.</span></span> <span data-ttu-id="36aa7-184">Per altre informazioni, vedere [dtexec Utility](../packages/dtexec-utility.md).</span><span class="sxs-lookup"><span data-stu-id="36aa7-184">For more information, see [dtexec Utility](../packages/dtexec-utility.md).</span></span>

4.  <span data-ttu-id="36aa7-185">Impostare i punti di interruzione nel codice sorgente, laddove appropriato, nei metodi di runtime del componente.</span><span class="sxs-lookup"><span data-stu-id="36aa7-185">Set breakpoints in the source code where appropriate in the run-time methods of your component.</span></span>

5.  <span data-ttu-id="36aa7-186">Eseguire il progetto.</span><span class="sxs-lookup"><span data-stu-id="36aa7-186">Run your project.</span></span>

#### <a name="to-debug-a-custom-objects-design-time-methods-by-attaching-to-sql-server-data-tools"></a><span data-ttu-id="36aa7-187">Per eseguire il debug dei metodi della fase di progettazione di un oggetto personalizzato tramite connessione a SQL Server Data Tools</span><span class="sxs-lookup"><span data-stu-id="36aa7-187">To debug a custom object's design-time methods by attaching to SQL Server Data Tools</span></span>

1.  <span data-ttu-id="36aa7-188">Firmare e compilare il progetto nella configurazione di debug, distribuirlo e installarlo nella Global Assembly Cache come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="36aa7-188">Sign and build your project in the Debug configuration, deploy it, and install it in the global assembly cache as described in this topic.</span></span>

2.  <span data-ttu-id="36aa7-189">Impostare i punti di interruzione nel codice sorgente, laddove appropriato, nei metodi della fase di progettazione dell'oggetto personalizzato.</span><span class="sxs-lookup"><span data-stu-id="36aa7-189">Set breakpoints in the source code where appropriate in the design-time methods of your custom object.</span></span>

3.  <span data-ttu-id="36aa7-190">Aprire una seconda istanza di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] e caricare un progetto di [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] contenente un pacchetto in cui è utilizzato l'oggetto personalizzato.</span><span class="sxs-lookup"><span data-stu-id="36aa7-190">Open a second instance of [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and load an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] project that contains a package that uses the custom object.</span></span>

4.  <span data-ttu-id="36aa7-191">Dalla prima istanza di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], connettersi alla seconda istanza di **devenv.exe** in cui è caricato il pacchetto scegliendo **Connetti a processo** dal menu **Debug** della prima istanza.</span><span class="sxs-lookup"><span data-stu-id="36aa7-191">From the first instance of [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], attach to the second instance of **devenv.exe** in which the package is loaded by selecting **Attach to Process** from the **Debug** menu of the first instance.</span></span>

5.  <span data-ttu-id="36aa7-192">Eseguire il pacchetto dalla seconda istanza di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36aa7-192">Run the package from the second instance of [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span>

#### <a name="to-debug-a-custom-objects-run-time-methods-by-attaching-to-sql-server-data-tools"></a><span data-ttu-id="36aa7-193">Per eseguire il debug dei metodi di runtime di un oggetto personalizzato tramite connessione a SQL Server Data Tools</span><span class="sxs-lookup"><span data-stu-id="36aa7-193">To debug a custom object's run-time methods by attaching to SQL Server Data Tools</span></span>

1.  <span data-ttu-id="36aa7-194">Dopo avere completato i passaggi descritti nella procedura precedente, forzare una pausa nell'esecuzione del pacchetto in modo che sia possibile connettersi a **DtsDebugHost.exe**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-194">After you have completed the steps listed in the previous procedure, force a pause in the execution of your package so that you can attach to **DtsDebugHost.exe**.</span></span> <span data-ttu-id="36aa7-195">Per forzare questa pausa, è possibile aggiungere un punto di interruzione all'evento `OnPreExecute` oppure aggiungere un'attività Script al progetto e passare allo script che visualizza una finestra di messaggio modale.</span><span class="sxs-lookup"><span data-stu-id="36aa7-195">You can force this pause by adding a breakpoint to the `OnPreExecute` event, or by adding a Script task to your project and entering script that displays a modal message box.</span></span>

2.  <span data-ttu-id="36aa7-196">Eseguire il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="36aa7-196">Run the package.</span></span> <span data-ttu-id="36aa7-197">Quando si verifica la pausa, passare all'istanza di [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] in cui è aperto il progetto di codice e scegliere **Connetti a processo** dal menu **Debug**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-197">When the pause occurs, switch to the instance of [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] in which your code project is open, and select **Attach to Process** from the **Debug** menu.</span></span> <span data-ttu-id="36aa7-198">Assicurarsi di connettersi all'istanza di **DtsDebugHost.exe** riportata come **Gestito, x86** nella colonna **Tipo** e non all'istanza indicata solo come **x86**.</span><span class="sxs-lookup"><span data-stu-id="36aa7-198">Make sure to attach to the instance of **DtsDebugHost.exe** listed as **Managed, x86** in the **Type** column, not to the instance listed as **x86** only.</span></span>

3.  <span data-ttu-id="36aa7-199">Tornare al pacchetto in pausa e continuare oltre il punto di interruzione oppure fare clic su **OK** per annullare la finestra di messaggio generata dall'attività Script, quindi continuare con l'esecuzione e il debug del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="36aa7-199">Return to the paused package and continue past the breakpoint, or click **OK** to dismiss the message box raised by the Script task, and continue package execution and debugging.</span></span>

<span data-ttu-id="36aa7-200">![Integration Services icona (piccola)](../media/dts-16.gif "Icona di Integration Services (piccola)")  **rimane aggiornata con Integration Services**</span><span class="sxs-lookup"><span data-stu-id="36aa7-200">![Integration Services icon (small)](../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="36aa7-201">Per i download, gli articoli, gli esempi e i video Microsoft più recenti, oltre alle soluzioni selezionate dalla community, visitare la pagina [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] sul sito MSDN:</span><span class="sxs-lookup"><span data-stu-id="36aa7-201">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="36aa7-202">Visitare la pagina relativa a Integration Services su MSDN</span><span class="sxs-lookup"><span data-stu-id="36aa7-202">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="36aa7-203">Per ricevere una notifica automatica su questi aggiornamenti, sottoscrivere i feed RSS disponibili nella pagina.</span><span class="sxs-lookup"><span data-stu-id="36aa7-203">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="36aa7-204">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="36aa7-204">See Also</span></span>
 <span data-ttu-id="36aa7-205">[Sviluppo di oggetti personalizzati per Integration Services la](developing-custom-objects-for-integration-services.md) conservazione degli [oggetti personalizzati](persisting-custom-objects.md) [strumenti di risoluzione dei problemi per lo sviluppo di pacchetti](../troubleshooting/troubleshooting-tools-for-package-development.md)</span><span class="sxs-lookup"><span data-stu-id="36aa7-205">[Developing Custom Objects for Integration Services](developing-custom-objects-for-integration-services.md) [Persisting Custom Objects](persisting-custom-objects.md) [Troubleshooting Tools for Package Development](../troubleshooting/troubleshooting-tools-for-package-development.md)</span></span>


