---
title: Gestori eventi di Integration Services (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services packages, events
- run-time [Integration Services]
- SQL Server Integration Services packages, events
- event handlers [Integration Services], about event handlers
- events [Integration Services]
- packages [Integration Services], events
- event handlers [Integration Services]
- SSIS packages, events
- containers [Integration Services], events
- events [Integration Services], about events
ms.assetid: 6f60cf93-35dc-431c-908d-2049c4ab66ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 78bcd6579aa8306c89fd9530fad3557ac57f102a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628873"
---
# <a name="integration-services-ssis-event-handlers"></a><span data-ttu-id="634aa-102">Gestori eventi di Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="634aa-102">Integration Services (SSIS) Event Handlers</span></span>
  <span data-ttu-id="634aa-103">Durante la fase di esecuzione gli eseguibili, costituiti da pacchetti e contenitori Ciclo Foreach, Ciclo For, Sequenza e Host attività, generano eventi.</span><span class="sxs-lookup"><span data-stu-id="634aa-103">At run time, executables (packages and Foreach Loop, For Loop, Sequence, and task host containers) raise events.</span></span> <span data-ttu-id="634aa-104">Quando si verifica un errore, ad esempio, viene generato l'evento OnError.</span><span class="sxs-lookup"><span data-stu-id="634aa-104">For example, an OnError event is raised when an error occurs.</span></span> <span data-ttu-id="634aa-105">È possibile creare gestori di eventi personalizzati per tali eventi, per estendere le funzionalità dei pacchetti e semplificarne la gestione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-105">You can create custom event handlers for these events to extend package functionality and make packages easier to manage at run time.</span></span> <span data-ttu-id="634aa-106">I gestori di eventi possono eseguire varie attività, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="634aa-106">Event handlers can perform tasks such as the following:</span></span>

-   <span data-ttu-id="634aa-107">Cancellare l'archivio dati temporaneo al termine dell'esecuzione di un pacchetto o attività.</span><span class="sxs-lookup"><span data-stu-id="634aa-107">Clean up temporary data storage when a package or task finishes running.</span></span>

-   <span data-ttu-id="634aa-108">Recuperare informazioni di sistema per verificare la disponibilità delle risorse prima dell'esecuzione di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="634aa-108">Retrieve system information to assess resource availability before a package runs.</span></span>

-   <span data-ttu-id="634aa-109">Aggiornare dati in una tabella quando una ricerca in una tabella di riferimento non riesce.</span><span class="sxs-lookup"><span data-stu-id="634aa-109">Refresh data in a table when a lookup in a reference table fails.</span></span>

-   <span data-ttu-id="634aa-110">Inviare un messaggio di posta elettronica quando viene generato un errore o un avviso oppure quando un'attività non riesce.</span><span class="sxs-lookup"><span data-stu-id="634aa-110">Send an e-mail message when an error or a warning occurs or when a task fails.</span></span>

 <span data-ttu-id="634aa-111">Se per un evento non esiste alcun gestore, tale evento verrà passato al contenitore di livello immediatamente superiore nella gerarchia dei contenitori del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="634aa-111">If an event has no event handler, the event is raised to the next container up the container hierarchy in a package.</span></span> <span data-ttu-id="634aa-112">Se il contenitore dispone di un gestore di evento, quest'ultimo verrà eseguito in risposta all'evento,</span><span class="sxs-lookup"><span data-stu-id="634aa-112">If this container has an event handler, the event handler runs in response to the event.</span></span> <span data-ttu-id="634aa-113">in caso contrario l'evento verrà passato al contenitore di livello immediatamente superiore nella gerarchia dei contenitori.</span><span class="sxs-lookup"><span data-stu-id="634aa-113">If not, the event is raised to the next container up the container hierarchy.</span></span>

 <span data-ttu-id="634aa-114">Nella figura seguente viene illustrato un semplice pacchetto che include un contenitore Ciclo For contenente un'attività Esegui SQL.</span><span class="sxs-lookup"><span data-stu-id="634aa-114">The following diagram shows a simple package that has a For Loop container that contains one Execute SQL task.</span></span>

 <span data-ttu-id="634aa-115">![Pacchetto, Ciclo For, host di attività e attività Esegui SQL](media/mw-dts-eventhandlerpkg.gif "Pacchetto, Ciclo For, host di attività e attività Esegui SQL")</span><span class="sxs-lookup"><span data-stu-id="634aa-115">![Package, For Loop, task host, and Execute SQL task](media/mw-dts-eventhandlerpkg.gif "Package, For Loop, task host, and Execute SQL task")</span></span>

 <span data-ttu-id="634aa-116">Solo il pacchetto dispone di un gestore di evento per il proprio evento `OnError`.</span><span class="sxs-lookup"><span data-stu-id="634aa-116">Only the package has an event handler, for its `OnError` event.</span></span> <span data-ttu-id="634aa-117">Se si verifica un errore mentre viene eseguita l'attività Esegui SQL, verrà eseguito il gestore dell'evento `OnError` del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="634aa-117">If an error occurs when the Execute SQL task runs, the `OnError` event handler for the package runs.</span></span> <span data-ttu-id="634aa-118">Nella figura seguente viene illustrata la sequenza di chiamate che provoca l'esecuzione del gestore dell'evento `OnError` per il pacchetto.</span><span class="sxs-lookup"><span data-stu-id="634aa-118">The following diagram shows the sequence of calls that causes the `OnError` event handler for the package to execute.</span></span>

 <span data-ttu-id="634aa-119">![Flusso del gestore dell'evento](media/mw-dts-eventhandlers.gif "Flusso del gestore dell'evento")</span><span class="sxs-lookup"><span data-stu-id="634aa-119">![Event handler flow](media/mw-dts-eventhandlers.gif "Event handler flow")</span></span>

 <span data-ttu-id="634aa-120">I gestori di eventi sono membri di un insieme di gestori di eventi, disponibile in tutti i contenitori.</span><span class="sxs-lookup"><span data-stu-id="634aa-120">Event handlers are members of an event handler collection, and all containers include this collection.</span></span> <span data-ttu-id="634aa-121">Se si crea un pacchetto utilizzando Progettazione [!INCLUDE[ssIS](../includes/ssis-md.md)] , sarà possibile visualizzare i membri dell'insieme dei gestori di eventi nelle cartelle **Gestori eventi** della scheda **Esplora pacchetti** di Progettazione [!INCLUDE[ssIS](../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="634aa-121">If you create the package using [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, you can see the members of the event handler collections in the **Event Handlers** folders on the **Package Explorer** tab of [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer.</span></span>

 <span data-ttu-id="634aa-122">Per configurare il contenitore di un gestore di evento, procedere nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="634aa-122">You can configure the event handler container in the following ways:</span></span>

-   <span data-ttu-id="634aa-123">Specificare un nome e una descrizione per il gestore di evento.</span><span class="sxs-lookup"><span data-stu-id="634aa-123">Specify a name and description for the event handler.</span></span>

-   <span data-ttu-id="634aa-124">Indicare se il gestore di evento viene eseguito, se il pacchetto deve generare un errore in caso di errore del gestore di evento e il numero di errori che possono verificarsi prima che il gestore di evento generi a sua volta un errore.</span><span class="sxs-lookup"><span data-stu-id="634aa-124">Indicate whether the event handler runs, whether the package fails if the event handler fails, and the number of errors that can occur before the event handler fails.</span></span>

-   <span data-ttu-id="634aa-125">Specificare il risultato di esecuzione da restituire al posto di quello effettivamente restituito dal gestore di evento in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-125">Specify an execution result to return instead of the actual execution result that the event handler returns at run time.</span></span>

-   <span data-ttu-id="634aa-126">Specificare l'opzione relativa alle transazioni per il gestore di evento.</span><span class="sxs-lookup"><span data-stu-id="634aa-126">Specify the transaction option for the event handler.</span></span>

-   <span data-ttu-id="634aa-127">Specificare la modalità di registrazione utilizzata dal gestore di evento.</span><span class="sxs-lookup"><span data-stu-id="634aa-127">Specify the logging mode that the event handler uses.</span></span>

## <a name="event-handler-content"></a><span data-ttu-id="634aa-128">Contenuto di un gestore di evento</span><span class="sxs-lookup"><span data-stu-id="634aa-128">Event Handler Content</span></span>
 <span data-ttu-id="634aa-129">La creazione di un gestore di evento è simile alla compilazione di un pacchetto. Un gestore di evento include attività e contenitori, ordinati in sequenza in modo da formare un flusso di controllo, e può includere anche flussi di dati.</span><span class="sxs-lookup"><span data-stu-id="634aa-129">Creating an event handler is similar to building a package; an event handler has tasks and containers, which are sequenced into a control flow, and an event handler can also include data flows.</span></span> <span data-ttu-id="634aa-130">In Progettazione [!INCLUDE[ssIS](../includes/ssis-md.md)] è disponibile la scheda **Gestori eventi** , che consente di creare gestori di eventi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="634aa-130">The [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer includes the **Event Handlers** tab for creating custom event handlers.</span></span> <span data-ttu-id="634aa-131">Per altre informazioni, vedere [gestori eventi del pacchetto SSIS](integration-services-ssis-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="634aa-131">For more information, see [SSIS Package Event Handlers](integration-services-ssis-event-handlers.md).</span></span>

 <span data-ttu-id="634aa-132">È possibile creare gestori di eventi anche a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="634aa-132">You can also create event handlers programmatically.</span></span> <span data-ttu-id="634aa-133">Per altre informazioni, vedere [Gestione degli eventi a livello di programmazione](building-packages-programmatically/handling-events-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="634aa-133">For more information, see [Handling Events Programmatically](building-packages-programmatically/handling-events-programmatically.md).</span></span>

## <a name="run-time-events"></a><span data-ttu-id="634aa-134">Eventi di run-time</span><span class="sxs-lookup"><span data-stu-id="634aa-134">Run-Time Events</span></span>
 <span data-ttu-id="634aa-135">Nella tabella seguente vengono elencati i gestori di eventi disponibili in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] e vengono descritti gli eventi di run-time che ne provocano l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-135">The following table lists the event handlers that [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides, and describes the run-time events that cause the event handler to run.</span></span>

|<span data-ttu-id="634aa-136">Gestore di evento</span><span class="sxs-lookup"><span data-stu-id="634aa-136">Event handler</span></span>|<span data-ttu-id="634aa-137">event</span><span class="sxs-lookup"><span data-stu-id="634aa-137">Event</span></span>|
|-------------------|-----------|
|`OnError`|<span data-ttu-id="634aa-138">Gestore eventi per l'evento `OnError`.</span><span class="sxs-lookup"><span data-stu-id="634aa-138">The event handler for the `OnError` event.</span></span> <span data-ttu-id="634aa-139">Questo evento viene generato da un eseguibile quando si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="634aa-139">This event is raised by an executable when an error occurs.</span></span>|
|<span data-ttu-id="634aa-140">**OnExecStatusChanged**</span><span class="sxs-lookup"><span data-stu-id="634aa-140">**OnExecStatusChanged**</span></span>|<span data-ttu-id="634aa-141">Gestore di evento per l'evento **OnExecStatusChanged** .</span><span class="sxs-lookup"><span data-stu-id="634aa-141">The event handler for the **OnExecStatusChanged** event.</span></span> <span data-ttu-id="634aa-142">Questo evento viene generato da un eseguibile quando cambia il suo stato di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-142">This event is raised by an executable when its execution status changes.</span></span>|
|<span data-ttu-id="634aa-143">**OnInformation**</span><span class="sxs-lookup"><span data-stu-id="634aa-143">**OnInformation**</span></span>|<span data-ttu-id="634aa-144">Gestore di evento per l'evento **OnInformation** .</span><span class="sxs-lookup"><span data-stu-id="634aa-144">The event handler for the **OnInformation** event.</span></span> <span data-ttu-id="634aa-145">Questo evento viene generato durante la convalida e l'esecuzione di un eseguibile, allo scopo di fornire informazioni.</span><span class="sxs-lookup"><span data-stu-id="634aa-145">This event is raised during the validation and execution of an executable to report information.</span></span> <span data-ttu-id="634aa-146">Questo evento fornisce solo informazioni, non errori o avvisi.</span><span class="sxs-lookup"><span data-stu-id="634aa-146">This event conveys information only, no errors or warnings.</span></span>|
|<span data-ttu-id="634aa-147">**OnPostExecute**</span><span class="sxs-lookup"><span data-stu-id="634aa-147">**OnPostExecute**</span></span>|<span data-ttu-id="634aa-148">Gestore di evento per l'evento **OnPostExecute** .</span><span class="sxs-lookup"><span data-stu-id="634aa-148">The event handler for the **OnPostExecute** event.</span></span> <span data-ttu-id="634aa-149">Questo evento viene generato da un eseguibile immediatamente dopo la fine dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-149">This event is raised by an executable immediately after it has finished running.</span></span>|
|<span data-ttu-id="634aa-150">**OnPostValidate**</span><span class="sxs-lookup"><span data-stu-id="634aa-150">**OnPostValidate**</span></span>|<span data-ttu-id="634aa-151">Gestore di evento per l'evento **OnPostValidate** .</span><span class="sxs-lookup"><span data-stu-id="634aa-151">The event handler for the **OnPostValidate** event.</span></span> <span data-ttu-id="634aa-152">Questo evento viene generato da un eseguibile al termine della convalida.</span><span class="sxs-lookup"><span data-stu-id="634aa-152">This event is raised by an executable when its validation is finished.</span></span>|
|<span data-ttu-id="634aa-153">**OnPreExecute**</span><span class="sxs-lookup"><span data-stu-id="634aa-153">**OnPreExecute**</span></span>|<span data-ttu-id="634aa-154">Gestore di evento per l'evento **OnPreExecute** .</span><span class="sxs-lookup"><span data-stu-id="634aa-154">The event handler for the **OnPreExecute** event.</span></span> <span data-ttu-id="634aa-155">Questo evento viene generato da un eseguibile immediatamente prima della sua esecuzione.</span><span class="sxs-lookup"><span data-stu-id="634aa-155">This event is raised by an executable immediately before it runs.</span></span>|
|<span data-ttu-id="634aa-156">**OnPreValidate**</span><span class="sxs-lookup"><span data-stu-id="634aa-156">**OnPreValidate**</span></span>|<span data-ttu-id="634aa-157">Gestore di evento per l'evento **OnPreValidate** .</span><span class="sxs-lookup"><span data-stu-id="634aa-157">The event handler for the **OnPreValidate** event.</span></span> <span data-ttu-id="634aa-158">Questo evento viene generato da un eseguibile all'inizio della sua convalida.</span><span class="sxs-lookup"><span data-stu-id="634aa-158">This event is raised by an executable when its validation starts.</span></span>|
|<span data-ttu-id="634aa-159">**OnProgress**</span><span class="sxs-lookup"><span data-stu-id="634aa-159">**OnProgress**</span></span>|<span data-ttu-id="634aa-160">Gestore di evento per l'evento **OnProgress** .</span><span class="sxs-lookup"><span data-stu-id="634aa-160">The event handler for the **OnProgress** event.</span></span> <span data-ttu-id="634aa-161">Questo evento viene generato da un eseguibile quando compie un avanzamento misurabile.</span><span class="sxs-lookup"><span data-stu-id="634aa-161">This event is raised by an executable when measurable progress is made by the executable.</span></span>|
|<span data-ttu-id="634aa-162">**OnQueryCancel**</span><span class="sxs-lookup"><span data-stu-id="634aa-162">**OnQueryCancel**</span></span>|<span data-ttu-id="634aa-163">Gestore di evento per l'evento **OnQueryCancel** .</span><span class="sxs-lookup"><span data-stu-id="634aa-163">The event handler for the **OnQueryCancel** event.</span></span> <span data-ttu-id="634aa-164">Questo evento viene generato da un eseguibile per determinare se l'esecuzione deve essere arrestata.</span><span class="sxs-lookup"><span data-stu-id="634aa-164">This event is raised by an executable to determine whether it should stop running.</span></span>|
|<span data-ttu-id="634aa-165">**OnTaskFailed**</span><span class="sxs-lookup"><span data-stu-id="634aa-165">**OnTaskFailed**</span></span>|<span data-ttu-id="634aa-166">Gestore di evento per l'evento **OnTaskFailed** .</span><span class="sxs-lookup"><span data-stu-id="634aa-166">The event handler for the **OnTaskFailed** event.</span></span> <span data-ttu-id="634aa-167">Questo evento viene generato da un'attività quando non riesce.</span><span class="sxs-lookup"><span data-stu-id="634aa-167">This event is raised by a task when it fails.</span></span>|
|<span data-ttu-id="634aa-168">**OnVariableValueChanged**</span><span class="sxs-lookup"><span data-stu-id="634aa-168">**OnVariableValueChanged**</span></span>|<span data-ttu-id="634aa-169">Gestore di evento per l'evento **OnVariableValueChanged** .</span><span class="sxs-lookup"><span data-stu-id="634aa-169">The event handler for the **OnVariableValueChanged** event.</span></span> <span data-ttu-id="634aa-170">Questo evento viene generato da un eseguibile quando il valore di una variabile viene modificato.</span><span class="sxs-lookup"><span data-stu-id="634aa-170">This event is raised by an executable when the value of a variable changes.</span></span> <span data-ttu-id="634aa-171">L'evento viene generato dall'eseguibile in cui è definita la variabile.</span><span class="sxs-lookup"><span data-stu-id="634aa-171">The event is raised by the executable on which the variable is defined.</span></span> <span data-ttu-id="634aa-172">Questo evento non viene generato se si imposta la proprietà **RaiseChangeEvent** per la variabile su `False` .</span><span class="sxs-lookup"><span data-stu-id="634aa-172">This event is not raised if you set the **RaiseChangeEvent** property for the variable to `False`.</span></span> <span data-ttu-id="634aa-173">Per altre informazioni, vedere [Variabili di Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="634aa-173">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>|
|<span data-ttu-id="634aa-174">**OnWarning**</span><span class="sxs-lookup"><span data-stu-id="634aa-174">**OnWarning**</span></span>|<span data-ttu-id="634aa-175">Gestore di evento per l'evento **OnWarning** .</span><span class="sxs-lookup"><span data-stu-id="634aa-175">The event handler for the **OnWarning** event.</span></span> <span data-ttu-id="634aa-176">Questo evento viene generato da un eseguibile quando viene generato un avviso.</span><span class="sxs-lookup"><span data-stu-id="634aa-176">This event is raised by an executable when a warning occurs.</span></span>|

## <a name="configuration-of-an-event-handler"></a><span data-ttu-id="634aa-177">Configurazione di un gestore dell'evento</span><span class="sxs-lookup"><span data-stu-id="634aa-177">Configuration of an Event Handler</span></span>
 <span data-ttu-id="634aa-178">È possibile impostare le proprietà a livello di codice o nella finestra **Proprietà** di [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="634aa-178">You can set properties in the **Properties** window of [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] or programmatically.</span></span>

 <span data-ttu-id="634aa-179">Per informazioni su come impostare queste proprietà nella finestra di Progettazione [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], vedere [Impostazione delle proprietà di un'attività o di un contenitore](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span><span class="sxs-lookup"><span data-stu-id="634aa-179">For information about how to set these properties in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], see [Set the Properties of a Task or Container](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span></span>

 <span data-ttu-id="634aa-180">Per informazioni sull'impostazione di queste proprietà a livello di codice, vedere <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="634aa-180">For information about programmatically setting these properties, see <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="634aa-181">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="634aa-181">Related Tasks</span></span>
 <span data-ttu-id="634aa-182">Per informazioni su come aggiungere un gestore eventi a un pacchetto, vedere [Aggiunta di un gestore eventi a un pacchetto](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span><span class="sxs-lookup"><span data-stu-id="634aa-182">For information about how to add an event handler to a package, see [Add an Event Handler to a Package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span></span>


