---
title: SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87715468"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="a54b0-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="a54b0-103">supporta Windows PowerShell, ovvero una potente shell di scripting che consente agli amministratori e agli sviluppatori di automatizzare l'amministrazione del server e la distribuzione delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="a54b0-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="a54b0-104">Il linguaggio di Windows PowerShell supporta una logica più complessa rispetto agli script [!INCLUDE[tsql](../includes/tsql-md.md)] , consentendo agli amministratori di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] di compilare script di amministrazione affidabili.</span><span class="sxs-lookup"><span data-stu-id="a54b0-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="a54b0-105">Gli script di Windows PowerShell possono anche essere utilizzati per amministrare altri prodotti server di [!INCLUDE[msCoName](../includes/msconame-md.md)] ,</span><span class="sxs-lookup"><span data-stu-id="a54b0-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="a54b0-106">Ciò fornisce agli amministratori un linguaggio di scripting comune in tutti i server.</span><span class="sxs-lookup"><span data-stu-id="a54b0-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="a54b0-107">Componenti di PowerShell di SQL Server</span><span class="sxs-lookup"><span data-stu-id="a54b0-107">SQL Server PowerShell Components</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="a54b0-108">fornisce un modulo di Windows PowerShell denominato `sqlps` e utilizzato per importare i componenti di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] in un ambiente o script di Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="a54b0-108">provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="a54b0-109">Il modulo `sqlps` carica due snap-in di Windows PowerShell che implementano:</span><span class="sxs-lookup"><span data-stu-id="a54b0-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="a54b0-110">Un provider di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , che abilita un semplice meccanismo di navigazione simile ai percorsi del file system.</span><span class="sxs-lookup"><span data-stu-id="a54b0-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="a54b0-111">È possibile compilare percorsi simili a quelli del file system, in cui l'unità è associata a un modello a oggetti di gestione di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e i nodi sono basati sulle classi del modello a oggetti.</span><span class="sxs-lookup"><span data-stu-id="a54b0-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="a54b0-112">È quindi possibile usare comandi comuni come **cd** e **dir** per un'esplorazione dei percorsi simile all'esplorazione delle cartelle in una finestra del prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="a54b0-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="a54b0-113">È possibile usare altri comandi, ad esempio **ren** o **del**, per eseguire azioni sui nodi nel percorso.</span><span class="sxs-lookup"><span data-stu-id="a54b0-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="a54b0-114">Un set di cmdlet, ovvero di comandi utilizzati negli script di Windows PowerShell per specificare un'azione di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a54b0-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="a54b0-115">I cmdlet di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] supportano azioni come l'esecuzione di uno script **sqlcmd** che contiene istruzioni [!INCLUDE[tsql](../includes/tsql-md.md)] o XQuery.</span><span class="sxs-lookup"><span data-stu-id="a54b0-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="a54b0-116">Per informazioni su Windows PowerShell, vedere la [Guida introduttiva a Windows PowerShell](https://msdn.microsoft.com/library/hh857337.aspx).</span><span class="sxs-lookup"><span data-stu-id="a54b0-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="a54b0-117">Versioni di SQL Server</span><span class="sxs-lookup"><span data-stu-id="a54b0-117">SQL Server Versions</span></span>  
 <span data-ttu-id="a54b0-118">I componenti di PowerShell [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] possono essere utilizzati per gestire istanze di [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="a54b0-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="a54b0-119">Le istanze di [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] devono eseguire la versione SP2 o successiva.</span><span class="sxs-lookup"><span data-stu-id="a54b0-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="a54b0-120">Le istanze di [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] devono eseguire la versione SP4 o successiva.</span><span class="sxs-lookup"><span data-stu-id="a54b0-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="a54b0-121">Quando i componenti di PowerShell per [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] vengono utilizzati con versioni precedenti di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], sono limitati alla funzionalità disponibile in tali versioni.</span><span class="sxs-lookup"><span data-stu-id="a54b0-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="a54b0-122">Attività di SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="a54b0-123">Descrizione dell'attività</span><span class="sxs-lookup"><span data-stu-id="a54b0-123">Task Description</span></span>|<span data-ttu-id="a54b0-124">Argomento</span><span class="sxs-lookup"><span data-stu-id="a54b0-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="a54b0-125">Descrive il meccanismo preferito per l'esecuzione dei componenti PowerShell per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]; aprire una sessione di PowerShell e caricare il modulo `sqlps`.</span><span class="sxs-lookup"><span data-stu-id="a54b0-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="a54b0-126">Il modulo di `sqlps` viene caricato nel provider PowerShell di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e nei cmdlet e i gruppi SQL Server Management Object (SMO) vengono utilizzati dal provider e dai cmdlets.</span><span class="sxs-lookup"><span data-stu-id="a54b0-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="a54b0-127">Importare il modulo SQLPS</span><span class="sxs-lookup"><span data-stu-id="a54b0-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="a54b0-128">Descrive come caricare solo i gruppi SMO senza il provider o i cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a54b0-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="a54b0-129">Caricare gli assembly SMO in Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="a54b0-130">Descrive la modalità di esecuzione della sessione di Windows PowerShell facendo clic con il pulsante destro del mouse su un nodo in **Esplora oggetti**.</span><span class="sxs-lookup"><span data-stu-id="a54b0-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)]<span data-ttu-id="a54b0-131">avvia una sessione di Windows PowerShell, carica il `sqlps` modulo e imposta il percorso del provider SQL Server sull'oggetto selezionato.</span><span class="sxs-lookup"><span data-stu-id="a54b0-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="a54b0-132">Esecuzione di Windows PowerShell da SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a54b0-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="a54b0-133">Descrive come creare passaggi di processo SQL Server Agent che eseguano uno script di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a54b0-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="a54b0-134">I processi possono quindi essere programmati per l'esecuzione a ore specifiche o al verificarsi di eventi.</span><span class="sxs-lookup"><span data-stu-id="a54b0-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="a54b0-135">Esecuzione di passaggi di Windows PowerShell in SQL Server Agent</span><span class="sxs-lookup"><span data-stu-id="a54b0-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="a54b0-136">Descrive la modalità di utilizzo del provider di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] per spostarsi nella gerarchia degli oggetti di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a54b0-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="a54b0-137">Provider PowerShell per SQL Server</span><span class="sxs-lookup"><span data-stu-id="a54b0-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="a54b0-138">Descrive come utilizzare i cmdlet di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] che specificano le azioni [!INCLUDE[ssDE](../includes/ssde-md.md)] come ad esempio l'esecuzione di uno script [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a54b0-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="a54b0-139">Utilizzo di cmdlet del motore di database</span><span class="sxs-lookup"><span data-stu-id="a54b0-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="a54b0-140">Descrive come specificare identificatori delimitati di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] che contengono caratteri non supportati da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a54b0-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="a54b0-141">Identificatori di SQL Server in PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="a54b0-142">Descrive come effettuare connessioni di autenticazione di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a54b0-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="a54b0-143">Per impostazione predefinita, i componenti PowerShell di SQL Server utilizzano connessioni di autenticazione di Windows mediante le credenziali di Windows del processo che esegue Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a54b0-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="a54b0-144">Gestire l'autenticazione in motore di database PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="a54b0-145">Descrive come utilizzare variabili implementate dal provider PowerShell di SQL Server per controllare quanti oggetti vengono elencati oggetti nel caso di utilizzo del completamento della scheda di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a54b0-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="a54b0-146">Questo è particolarmente utile lavorando su database che contengono grandi numeri di oggetti.</span><span class="sxs-lookup"><span data-stu-id="a54b0-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="a54b0-147">Gestire il completamento alla pressione del tasto TAB &#40;SQL Server PowerShell&#41;</span><span class="sxs-lookup"><span data-stu-id="a54b0-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="a54b0-148">Descrive come utilizzare Get-Help per ottenere informazioni sui componenti di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] nell'ambiente di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a54b0-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="a54b0-149">Get Help SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a54b0-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
