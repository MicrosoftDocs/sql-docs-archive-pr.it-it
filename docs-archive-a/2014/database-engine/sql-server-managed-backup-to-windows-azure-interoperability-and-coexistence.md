---
title: 'SQL Server backup gestito in Azure: interoperabilità e coesistenza | Microsoft Docs'
description: Questo articolo descrive SQL Server backup gestito per Microsoft Azure interoperabilità e coesistenza con diverse funzionalità di SQL Server 2014.
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: 78fb78ed-653f-45fe-a02a-a66519bfee1b
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 2e2839fc4755fe47504e42e5058a5da117888900
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87716572"
---
# <a name="sql-server-managed-backup-to-azure-interoperability-and-coexistence"></a><span data-ttu-id="1298f-103">Backup gestito di SQL Server in Azure: Interoperabilità e coesistenza</span><span class="sxs-lookup"><span data-stu-id="1298f-103">SQL Server Managed Backup to Azure: Interoperability and Coexistence</span></span>
  <span data-ttu-id="1298f-104">In questo argomento vengono descritte l'interoperabilità e la coesistenza di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] con alcune funzionalità di [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)],</span><span class="sxs-lookup"><span data-stu-id="1298f-104">This topic describes [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] interoperability and coexistence with several features in [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="1298f-105">tra cui gruppi di disponibilità AlwaysOn, mirroring del database, piani di manutenzione di backup, log shipping, backup ad hoc, scollegamento del database ed eliminazione del database.</span><span class="sxs-lookup"><span data-stu-id="1298f-105">These features include the following: AlwaysOn Availability Groups, Database Mirroring, Backup Maintenance Plans, Log Shipping, Ad hoc backups, Detach Database, and Drop Database.</span></span>  
  
### <a name="alwayson-availability-groups"></a><span data-ttu-id="1298f-106">Gruppi di disponibilità AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="1298f-106">AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="1298f-107">Gruppi di disponibilità AlwaysOn configurate come una soluzione solo Azure supportata per [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1298f-107">AlwaysOn Availability Groups that are configured as an Azure-only solution supported for [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="1298f-108">Le configurazioni del gruppo di disponibilità AlwaysOn ibride o solo in locale non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="1298f-108">On-premises only, or Hybrid AlwaysOn Availability Group configurations are not supported.</span></span> <span data-ttu-id="1298f-109">Per altre informazioni e altre considerazioni, vedere [configurazione di SQL Server backup gestito in Azure per i gruppi di disponibilità](../../2014/database-engine/setting-up-sql-server-managed-backup-to-windows-azure-for-availability-groups.md)</span><span class="sxs-lookup"><span data-stu-id="1298f-109">For more information and other considerations, see [Setting up SQL Server Managed Backup to Azure for Availability Groups](../../2014/database-engine/setting-up-sql-server-managed-backup-to-windows-azure-for-availability-groups.md)</span></span>  
  
### <a name="database-mirroring"></a><span data-ttu-id="1298f-110">Mirroring del database</span><span class="sxs-lookup"><span data-stu-id="1298f-110">Database Mirroring</span></span>  
 [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="1298f-111">è supportato solo nel database principale.</span><span class="sxs-lookup"><span data-stu-id="1298f-111">is supported only on the principal database.</span></span> <span data-ttu-id="1298f-112">Se sia il server principale che il server mirror sono configurati per l'utilizzo di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], il database con mirroring viene ignorato e non ne verrà eseguito il backup.</span><span class="sxs-lookup"><span data-stu-id="1298f-112">If both the principal and the mirror are configured to use [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], the mirrored database is skipped and will not be backed up.</span></span> <span data-ttu-id="1298f-113">Tuttavia, in caso di failover, tramite [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] verrà avviato il processo di backup dopo il completamento del cambio di ruolo da parte del mirror e quest'ultimo è online.</span><span class="sxs-lookup"><span data-stu-id="1298f-113">However, in the event of a failover, [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will start the backup process after the mirror has completed role switching and is online.</span></span> <span data-ttu-id="1298f-114">I backup verranno archiviati in un nuovo contenitore in questo caso.</span><span class="sxs-lookup"><span data-stu-id="1298f-114">The backups will be stored in a new container in this case.</span></span> <span data-ttu-id="1298f-115">Se il mirror non è configurato per utilizzare [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], in caso di failover non verrà eseguito alcun backup.</span><span class="sxs-lookup"><span data-stu-id="1298f-115">If the mirror is not configured to use [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], in the event of a failover, no backups are taken.</span></span> <span data-ttu-id="1298f-116">È consigliabile configurare [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] sia nel server principale che nel server mirror in modo tale che i backup possano continuare in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="1298f-116">We recommend that you configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] on both the principal and the mirror so backups continue in the event of a failover.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="1298f-117">Se si crea un database con mirroring in un'istanza con le impostazioni predefinite di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], può essere preferibile disabilitare le impostazioni predefinite dell'istanza di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], in modo da non essere applicate al database con mirroring, e quindi riabilitare le impostazioni predefinite dell'istanza dopo aver configurato il server principale e mirror.</span><span class="sxs-lookup"><span data-stu-id="1298f-117">If you are creating a mirrored database on an instance with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] default settings, it may be preferable to disable [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] instance defaults, so they are not applied to the mirrored database, and then re-enable the instance defaults after configuring the Principal and the Mirror.</span></span>  
  
### <a name="maintenance-plan"></a><span data-ttu-id="1298f-118">Piano di manutenzione</span><span class="sxs-lookup"><span data-stu-id="1298f-118">Maintenance Plan</span></span>  
 <span data-ttu-id="1298f-119">L'utilizzo dei piani di manutenzione per la creazione di backup di un database quando [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] è abilitato non è supportato.</span><span class="sxs-lookup"><span data-stu-id="1298f-119">Using Maintenance Plans for creating backups for a database when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is enabled is not supported.</span></span> <span data-ttu-id="1298f-120">I piani di manutenzione comporteranno un'interruzione della catena di log e tramite [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] non sarà possibile supportare una recuperabilità garantita del database durante il ripristino.</span><span class="sxs-lookup"><span data-stu-id="1298f-120">Maintenance plans will cause broken log chain and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] may not be able to support a guaranteed recoverability of the database during restore.</span></span> <span data-ttu-id="1298f-121">Ciò è valido anche se [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] è abilitato a livello di istanza.</span><span class="sxs-lookup"><span data-stu-id="1298f-121">This also applies when [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is enabled at the instance level.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="1298f-122">I piani di manutenzione con backup di sola copia sono supportati con [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configurato per lo stesso database o istanza.</span><span class="sxs-lookup"><span data-stu-id="1298f-122">Maintenance Plans with Copy Only backups is supported with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] configured for the same database or instance.</span></span>  
  
### <a name="log-shipping"></a><span data-ttu-id="1298f-123">Log shipping</span><span class="sxs-lookup"><span data-stu-id="1298f-123">Log Shipping</span></span>  
 <span data-ttu-id="1298f-124">Non è possibile configurare il log shipping e [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] per lo stesso database contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="1298f-124">You cannot configure Log Shipping and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the same database at the same time.</span></span> <span data-ttu-id="1298f-125">Questa operazione avrà effetto sulla recuperabilità del database utilizzando entrambe le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1298f-125">Doing so will affect the recoverability of the database using either functionality.</span></span>  
  
### <a name="ad-hoc-backups-using-transact-sql-and-sql-server-management-studio"></a><span data-ttu-id="1298f-126">Backup ad hoc tramite Transact-SQL e SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="1298f-126">Ad Hoc Backups Using Transact-SQL and SQL Server Management Studio</span></span>  
 <span data-ttu-id="1298f-127">I backup ad hoc o eseguiti una volta creati esternamente a [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] tramite Transact-SQL o SQL Server Management Studio possono influire sul processo di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] a seconda del tipo di backup e dei supporti di archiviazione utilizzati.</span><span class="sxs-lookup"><span data-stu-id="1298f-127">Ad hoc or one time backups created outside [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] using Transact-SQL or SQL Server Management Studio may affect the [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] process depending on the type of backup and the storage media used.</span></span> <span data-ttu-id="1298f-128">I backup del log in un account di archiviazione di Azure diverso rispetto a quello che [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] USA, o qualsiasi altra destinazione rispetto al servizio di archiviazione BLOB di Azure, provocheranno un'interrotta di catena di log.</span><span class="sxs-lookup"><span data-stu-id="1298f-128">Log backups to a different Azure storage account than what [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is using, or any other destination than the Azure Blob storage service, will cause a log chain break.</span></span> <span data-ttu-id="1298f-129">È consigliabile utilizzare il [smart_admin. sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure per avviare un backup nei database [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] abilitati.</span><span class="sxs-lookup"><span data-stu-id="1298f-129">We recommend that you use the [smart_admin.sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure to initiate a backup on databases that have [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled.</span></span> <span data-ttu-id="1298f-130">È possibile avviare un backup completo del database o un backup del log tramite questa stored procedure.</span><span class="sxs-lookup"><span data-stu-id="1298f-130">You can initiate either a full database or log backup using this stored procedure.</span></span>  
  
### <a name="drop-database-and-detach-database"></a><span data-ttu-id="1298f-131">Elimina database e Scollega database</span><span class="sxs-lookup"><span data-stu-id="1298f-131">Drop Database and Detach Database</span></span>  
 <span data-ttu-id="1298f-132">Se un database con [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] abilitato viene scollegato o eliminato, sebbene non siano possibili backup aggiuntivi, i backup precedenti rimangono nella risorsa di archiviazione finché il periodo di memorizzazione non è scaduto, vale a dire quando i backup verranno eliminati.</span><span class="sxs-lookup"><span data-stu-id="1298f-132">If a database that has [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled is detached or dropped, although no additional backups are possible, the previous backups remain in the storage until the retention period has elapsed, at which point the backups will be purged.</span></span>  
  
### <a name="changes-to-recovery-model"></a><span data-ttu-id="1298f-133">Modifiche al modello di recupero</span><span class="sxs-lookup"><span data-stu-id="1298f-133">Changes to Recovery Model</span></span>  
  
-   <span data-ttu-id="1298f-134">Se si modifica il modello di recupero di un database da **semplice** a **completo** o con **registrazione minima delle operazioni bulk**, è possibile scegliere di configurare [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] per il database.</span><span class="sxs-lookup"><span data-stu-id="1298f-134">If you change the recovery model of a database from **Simple** to **Full** or **Bulk-Logged**, you have the option of configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the database.</span></span> <span data-ttu-id="1298f-135">In questo modo verrà considerato come un nuovo database dalla prospettiva di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1298f-135">This will be considered like a new database from [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] perspective.</span></span>  
  
-   <span data-ttu-id="1298f-136">Se si modifica il modello di recupero di un database da **completo** o con **registrazione minima** delle operazioni bulk a **Simple**, che ha [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] abilitato, le operazioni di backup non verranno più pianificate.</span><span class="sxs-lookup"><span data-stu-id="1298f-136">If you change the recovery model of a database from **Full** or **Bulk-Logged** to **Simple**, that has [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled, backup operations will no longer be scheduled.</span></span> <span data-ttu-id="1298f-137">L'impostazione del periodo di memorizzazione rimarrà attiva e i file di backup rimarranno nell'account di archiviazione finché non scade il periodo di memorizzazione.</span><span class="sxs-lookup"><span data-stu-id="1298f-137">The retention period setting will still be active and backup files will remain in the storage account until the retention period has elapsed.</span></span> <span data-ttu-id="1298f-138">Se si desidera mantenere i backup, si consiglia di scaricare i file in un account di archiviazione diverso o in un percorso locale.</span><span class="sxs-lookup"><span data-stu-id="1298f-138">If you want to retain the backups, we recommend that you download the files either to a different storage account or to an on-premises location.</span></span> <span data-ttu-id="1298f-139">Le impostazioni di configurazione vengono mantenute e possono essere riutilizzate se il modello di recupero viene impostato nuovamente su **completo** o con **registrazione minima delle operazioni bulk** .</span><span class="sxs-lookup"><span data-stu-id="1298f-139">The configuration settings are retained and can be reused if the recovery model is set back to **Full** or **Bulk-Logged** again.</span></span>  
  
### <a name="log-backups-using-other-backup-tools-or-custom-scripts"></a><span data-ttu-id="1298f-140">Backup del log tramite altri strumenti di backup o script personalizzati</span><span class="sxs-lookup"><span data-stu-id="1298f-140">Log Backups Using Other Backup Tools or Custom Scripts</span></span>  
 <span data-ttu-id="1298f-141">Due backup configurati per l'esecuzione di backup del log nello stesso database causeranno l'interruzione della catena dei log di backup.</span><span class="sxs-lookup"><span data-stu-id="1298f-141">Any two backups that are configured to perform log backups on the same database will cause break in the backup log chain.</span></span> <span data-ttu-id="1298f-142">Anche se tramite [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] si tenterà di porre rimedio all'interruzione della catena di backup pianificando backup completi al rilevamento di una situazione di questo tipo, ciò significa mantenersi continuamente aggiornati sulle interruzioni periodiche e sui backup del log eseguiti da due strumenti in competizione.</span><span class="sxs-lookup"><span data-stu-id="1298f-142">Although [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] will attempt to remedy the break in the backup chain by scheduling full backups when a break in chain is detected, this means keeping up continuously with periodic breaks and log backups performed by two competing tools.</span></span> <span data-ttu-id="1298f-143">Questa condizione può inoltre influire potenzialmente sulla recuperabilità del database poiché non vi sono strumenti in grado di garantire un set completo di backup in sequenza.</span><span class="sxs-lookup"><span data-stu-id="1298f-143">This can also potentially affect the recoverability of the database since no one tool can be expected to have a full set of backup in sequence.</span></span> <span data-ttu-id="1298f-144">Sebbene questo sia valido per due funzionalità o strumenti con cui si eseguono i backup del log, è utile illustrare esempi specifici come descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="1298f-144">Although this applies to any two features or tools performing log backups,, it is useful to call out specific examples as described below.</span></span> <span data-ttu-id="1298f-145">Si tratta anche della base per i problemi relativi alla configurazione dei piani di manutenzione o del log shipping come descritto nelle sezioni precedenti di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="1298f-145">This is also the basis for the issues with configuring maintenance plans or log shipping as described in earlier sections of this topic.</span></span>  
  
 <span data-ttu-id="1298f-146">**Backup basati su Data Protection Manager (DPM):** Microsoft Data Protection Manager consente di eseguire backup completi e incrementali.</span><span class="sxs-lookup"><span data-stu-id="1298f-146">**Data Protection Manager (DPM) based backups:** Microsoft Data Protection Manager allows you to do full and incremental backups.</span></span> <span data-ttu-id="1298f-147">I backup incrementali sono backup del log tramite cui viene eseguito un troncamento del log dopo la creazione di un backup della parte finale del log.</span><span class="sxs-lookup"><span data-stu-id="1298f-147">The incremental backups are log backups that do perform a log truncation after creating a T-log backup.</span></span> <span data-ttu-id="1298f-148">Pertanto, la configurazione di DPM e di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] per lo stesso database non è supportata.</span><span class="sxs-lookup"><span data-stu-id="1298f-148">So configuring both DPM and [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for the same database is not supported.</span></span>  
  
 <span data-ttu-id="1298f-149">**Strumenti o script di terze parti:** Qualsiasi strumento o script di terze parti che esegue backup del log che causa il troncamento del log non è compatibile con [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] e non è supportato.</span><span class="sxs-lookup"><span data-stu-id="1298f-149">**Third Party Tools or Scripts:** Any third party tool or scripts that perform log backups causing log truncation is incompatible with [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], and is not supported.</span></span>  
  
 <span data-ttu-id="1298f-150">Se è stata [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] abilitata un'istanza di database e si desidera eseguire un backup ad hoc, è possibile utilizzare il [smart_admin. Sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure come descritto nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="1298f-150">If you have [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] enabled for a database instance, and you want to take an ad hoc backup you can either use the [smart_admin.sp_backup_on_demand &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-on-demand-transact-sql) stored procedure as described in the earlier section.</span></span> <span data-ttu-id="1298f-151">Se inoltre si ha l'esigenza di pianificare o eseguire backup periodici all'esterno di [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], è possibile utilizzare Backup di sola copia.</span><span class="sxs-lookup"><span data-stu-id="1298f-151">If you also have a need to schedule or un backups periodically outside of [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)], you can use the Copy Only Backup.</span></span>  <span data-ttu-id="1298f-152">Per altre informazioni, vedere [Backup di sola copia &#40;SQL Server&#41;](../relational-databases/backup-restore/copy-only-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="1298f-152">For more information, see [Copy-Only Backups &#40;SQL Server&#41;](../relational-databases/backup-restore/copy-only-backups-sql-server.md).</span></span>  
  
  
