---
title: Connessione di diagnostica per gli amministratori di database | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- server management [SQL Server], connections
- administrator connections [SQL Server]
- ports [SQL Server], DAC
- DAC
- network connections [SQL Server], dedicated administrator
- diagnostic connections [SQL Server]
- connections [SQL Server], dedicated administrator
- ports [SQL Server]
- dedicated administrator connections [SQL Server]
ms.assetid: 993e0820-17f2-4c43-880c-d38290bf7abc
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0d452ca155a5187136c910e81e8bd073e34cad56
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87629607"
---
# <a name="diagnostic-connection-for-database-administrators"></a><span data-ttu-id="a1f03-102">Connessione di diagnostica per gli amministratori di database</span><span class="sxs-lookup"><span data-stu-id="a1f03-102">Diagnostic Connection for Database Administrators</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a1f03-103">offre una speciale connessione di diagnostica a cui possono ricorrere gli amministratori quando non è possibile usare connessioni standard al server.</span><span class="sxs-lookup"><span data-stu-id="a1f03-103">provides a special diagnostic connection for administrators when standard connections to the server are not possible.</span></span> <span data-ttu-id="a1f03-104">Questa connessione di diagnostica consente a un amministratore di accedere a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] per eseguire query di diagnostica e risolvere problemi anche quando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non risponde alle richieste di connessione standard.</span><span class="sxs-lookup"><span data-stu-id="a1f03-104">This diagnostic connection allows an administrator to access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute diagnostic queries and troubleshoot problems even when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is not responding to standard connection requests.</span></span>  
  
 <span data-ttu-id="a1f03-105">Questa connessione amministrativa dedicata (DAC, Dedicated Administrator Connection) supporta la crittografia e altre caratteristiche di sicurezza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a1f03-105">This dedicated administrator connection (DAC) supports encryption and other security features of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a1f03-106">La connessione DAC consente solo il cambiamento del contesto utente in un altro utente con privilegi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="a1f03-106">The DAC only allows changing the user context to another admin user.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a1f03-107">viene eseguito ogni possibile tentativo per garantire la connessione DAC, tuttavia in alcune situazioni particolari potrebbe verificarsi un errore.</span><span class="sxs-lookup"><span data-stu-id="a1f03-107">makes every attempt to make DAC connect successfully, but under extreme situations it may not be successful.</span></span>  
  
||  
|-|  
|<span data-ttu-id="a1f03-108">**Si applica a: (da alla** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] [versione corrente](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a1f03-108">**Applies to**: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] through [current version](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)].</span></span>|  
  
## <a name="connecting-with-dac"></a><span data-ttu-id="a1f03-109">Connessione DAC</span><span class="sxs-lookup"><span data-stu-id="a1f03-109">Connecting with DAC</span></span>  
 <span data-ttu-id="a1f03-110">Per impostazione predefinita, la connessione è consentita solo da un client in esecuzione sul server.</span><span class="sxs-lookup"><span data-stu-id="a1f03-110">By default, the connection is only allowed from a client running on the server.</span></span> <span data-ttu-id="a1f03-111">Le connessioni di rete non sono consentite, a meno che non siano configurate con la stored procedure sp_configure con l'opzione [remote admin connections](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="a1f03-111">Network connections are not permitted unless they are configured by using the sp_configure stored procedure with the [remote admin connections option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="a1f03-112">Solo i membri del ruolo [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sysadmin possono stabilire la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-112">Only members of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sysadmin role can connect using the DAC.</span></span>  
  
 <span data-ttu-id="a1f03-113">L'applicazione livello dati è disponibile e supportata con l'utilità del prompt dei comandi **sqlcmd** usando un'opzione di amministrazione speciale (**-A**).</span><span class="sxs-lookup"><span data-stu-id="a1f03-113">The DAC is available and supported through the **sqlcmd** command-prompt utility using a special administrator switch (**-A**).</span></span> <span data-ttu-id="a1f03-114">Per altre informazioni sull'uso di **sqlcmd**, vedere [Utilizzo di sqlcmd con variabili di scripting](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span><span class="sxs-lookup"><span data-stu-id="a1f03-114">For more information about using **sqlcmd**, see [Use sqlcmd with Scripting Variables](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span></span> <span data-ttu-id="a1f03-115">È anche possibile connettere il prefisso `admin:` al nome dell'istanza nel formato **sqlcmd-Sadmin:** _<instance_name>._</span><span class="sxs-lookup"><span data-stu-id="a1f03-115">You can also connect prefixing `admin:`to the instance name in the format **sqlcmd -Sadmin:**_<instance_name>._</span></span> <span data-ttu-id="a1f03-116">È inoltre possibile avviare un'applicazione livello dati da un [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] editor di query di connettendosi a `admin:` \<*instance_name*> .</span><span class="sxs-lookup"><span data-stu-id="a1f03-116">You can also initiate a DAC from a [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Query Editor by connecting to `admin:`\<*instance_name*>.</span></span>  
  
## <a name="restrictions"></a><span data-ttu-id="a1f03-117">Restrizioni</span><span class="sxs-lookup"><span data-stu-id="a1f03-117">Restrictions</span></span>  
 <span data-ttu-id="a1f03-118">Dato che l'applicazione livello dati ha il solo scopo di consentire la diagnosi di problemi del server in rare circostanze, vi sono alcune restrizioni nella connessione:</span><span class="sxs-lookup"><span data-stu-id="a1f03-118">Because the DAC exists solely for diagnosing server problems in rare circumstances, there are some restrictions on the connection:</span></span>  
  
-   <span data-ttu-id="a1f03-119">Per garantire che vi siano risorse disponibili per la connessione, per ogni istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]è consentita un'unica connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-119">To guarantee that there are resources available for the connection, only one DAC is allowed per instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a1f03-120">Se è già attiva una connessione DAC, qualsiasi nuova richiesta di connessione attraverso la connessione DAC viene negata e restituisce l'errore 17810.</span><span class="sxs-lookup"><span data-stu-id="a1f03-120">If a DAC connection is already active, any new request to connect through the DAC is denied with error 17810.</span></span>  
  
-   <span data-ttu-id="a1f03-121">Per risparmiare risorse, [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] non rimane in attesa sulla porta DAC, a meno che non sia avviato con un flag di traccia 7806.</span><span class="sxs-lookup"><span data-stu-id="a1f03-121">To conserve resources, [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] does not listen on the DAC port unless started with a trace flag 7806.</span></span>  
  
-   <span data-ttu-id="a1f03-122">La connessione DAC tenta inizialmente di connettersi al database predefinito associato all'account di accesso.</span><span class="sxs-lookup"><span data-stu-id="a1f03-122">The DAC initially attempts to connect to the default database associated with the login.</span></span> <span data-ttu-id="a1f03-123">Quando la connessione è stata stabilita con esito positivo, è possibile connettersi al database master.</span><span class="sxs-lookup"><span data-stu-id="a1f03-123">After it is successfully connected, you can connect to the master database.</span></span> <span data-ttu-id="a1f03-124">Se il database predefinito è offline o altrimenti non disponibile, la connessione restituisce l'errore 4060.</span><span class="sxs-lookup"><span data-stu-id="a1f03-124">If the default database is offline or otherwise not available, the connection will return error 4060.</span></span> <span data-ttu-id="a1f03-125">Essa avrà comunque esito positivo se si stabilisce la connessione al database master invece che al database predefinito utilizzando il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="a1f03-125">However, it will succeed if you override the default database to connect to the master database instead using the following command:</span></span>  
  
     <span data-ttu-id="a1f03-126">**Master sqlcmd-A-d**</span><span class="sxs-lookup"><span data-stu-id="a1f03-126">**sqlcmd -A -d master**</span></span>  
  
     <span data-ttu-id="a1f03-127">È consigliabile connettersi mediante connessione DAC al database master poiché se l'istanza di [!INCLUDE[ssDE](../../includes/ssde-md.md)] è avviata, master sarà certamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="a1f03-127">We recommend that you connect to the master database with the DAC because master is guaranteed to be available if the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is started.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a1f03-128">non consente l'esecuzione di query parallele o comandi con la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-128">prohibits running parallel queries or commands with the DAC.</span></span> <span data-ttu-id="a1f03-129">Se, ad esempio, una delle istruzioni seguenti viene eseguita con la connessione DAC, viene generato l'errore 3637:</span><span class="sxs-lookup"><span data-stu-id="a1f03-129">For example, error 3637 is generated if you execute either of the following statements with the DAC:</span></span>  
  
    -   <span data-ttu-id="a1f03-130">RESTORE</span><span class="sxs-lookup"><span data-stu-id="a1f03-130">RESTORE</span></span>  
  
    -   <span data-ttu-id="a1f03-131">BACKUP</span><span class="sxs-lookup"><span data-stu-id="a1f03-131">BACKUP</span></span>  
  
-   <span data-ttu-id="a1f03-132">Con la connessione DAC è garantita la disponibilità di risorse limitate.</span><span class="sxs-lookup"><span data-stu-id="a1f03-132">Only limited resources are guaranteed to be available with the DAC.</span></span> <span data-ttu-id="a1f03-133">Non utilizzare l'applicazione livello dati per eseguire query che utilizzano un'elevata quantità di risorse (ad esempio</span><span class="sxs-lookup"><span data-stu-id="a1f03-133">Do not use the DAC to run resource-intensive queries (for example.</span></span> <span data-ttu-id="a1f03-134">un join complesso in una grande tabella) o per eseguire query che possono bloccarsi.</span><span class="sxs-lookup"><span data-stu-id="a1f03-134">a complex join on large table) or queries that may block.</span></span> <span data-ttu-id="a1f03-135">Questa misura consente di evitare che la connessione DAC aggravi gli eventuali problemi già esistenti sul server.</span><span class="sxs-lookup"><span data-stu-id="a1f03-135">This helps prevent the DAC from compounding any existing server problems.</span></span> <span data-ttu-id="a1f03-136">Per evitare l'insorgere di potenziali scenari di blocco, quando è necessario eseguire query che potrebbero causare blocchi, eseguire la query in livelli di isolamento dello snapshot, se possibile, in caso contrario impostare il livello di isolamento della transazione su READ UNCOMMITTED, impostare il valore LOCK_TIMEOUT su un intervallo di tempo breve, ad esempio 2000 millisecondi, oppure adottare entrambe le misure.</span><span class="sxs-lookup"><span data-stu-id="a1f03-136">To avoid potential blocking scenarios, if you have to run queries that may block, run the query under snapshot-based isolation levels if possible; otherwise, set the transaction isolation level to READ UNCOMMITTED and set the LOCK_TIMEOUT value to a short value such as 2000 milliseconds, or both.</span></span> <span data-ttu-id="a1f03-137">In questo modo si eviterà il blocco della sessione della connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-137">This will prevent the DAC session from getting blocked.</span></span> <span data-ttu-id="a1f03-138">A seconda dello stato corrente in cui si trova [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , tuttavia, la sessione della connessione DAC potrebbe bloccarsi su un latch.</span><span class="sxs-lookup"><span data-stu-id="a1f03-138">However, depending on the state that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is in, the DAC session might get blocked on a latch.</span></span> <span data-ttu-id="a1f03-139">Potrebbe essere possibile terminare la sessione della connessione DAC utilizzando la combinazione di tasti CTRL-C, ma l'esito dell'operazione non è sicuro.</span><span class="sxs-lookup"><span data-stu-id="a1f03-139">You might be able to terminate the DAC session using CNTRL-C but it is not guaranteed.</span></span> <span data-ttu-id="a1f03-140">Se l'esito non è positivo, l'unica possibilità potrebbe consistere nel riavviare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a1f03-140">In that case, your only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="a1f03-141">Per garantire la connettività e la risoluzione dei problemi con la connessione DAC, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] riserva risorse limitate all'elaborazione dei comandi eseguiti sulla connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-141">To guarantee connectivity and troubleshooting with the DAC, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] reserves limited resources to process commands run on the DAC.</span></span> <span data-ttu-id="a1f03-142">Generalmente queste risorse sono sufficienti solo per semplici funzioni di diagnostica e risoluzione dei problemi, quali ad esempio quelle elencate di seguito.</span><span class="sxs-lookup"><span data-stu-id="a1f03-142">These resources are typically only enough for simple diagnostic and troubleshooting functions, such as those listed below.</span></span>  
  
 <span data-ttu-id="a1f03-143">Sebbene sia teoricamente possibile eseguire qualsiasi istruzione [!INCLUDE[tsql](../../includes/tsql-md.md)] che non richiede l'esecuzione in parallelo sulla connessione DAC, è consigliabile limitare l'utilizzo ai comandi di diagnostica e di risoluzione dei problemi seguenti:</span><span class="sxs-lookup"><span data-stu-id="a1f03-143">Although you can theoretically run any [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that does not have to execute in parallel on the DAC, we strongly recommend that you restrict usage to the following diagnostic and troubleshooting commands:</span></span>  
  
-   <span data-ttu-id="a1f03-144">Query di viste a gestione dinamica per diagnostica di base, quali sys.dm_tran_locks per lo stato di blocco, sys.dm_os_memory_cache_counters per verificare l'integrità delle cache e sys.dm_exec_requests e sys.dm_exec_sessions per richieste e sessioni attive.</span><span class="sxs-lookup"><span data-stu-id="a1f03-144">Querying dynamic management views for basic diagnostics such as sys.dm_tran_locks for the locking status, sys.dm_os_memory_cache_counters to check the health of caches, and sys.dm_exec_requests and sys.dm_exec_sessions for active sessions and requests.</span></span> <span data-ttu-id="a1f03-145">Evitare viste a gestione dinamica che utilizzano una grande quantità di risorse, ad esempio sys.dm_tran_version_store che analizza l'intero archivio delle versioni e può causare un numero elevato di operazioni I/O, oppure join complessi.</span><span class="sxs-lookup"><span data-stu-id="a1f03-145">Avoid dynamic management views that are resource intensive (for example, sys.dm_tran_version_store scans the full version store and can cause extensive I/O) or that use complex joins.</span></span> <span data-ttu-id="a1f03-146">Per informazioni sulle implicazioni a livello di prestazioni, vedere la documentazione relativa alla [vista a gestione dinamica specifica](../../relational-databases/views/views.md).</span><span class="sxs-lookup"><span data-stu-id="a1f03-146">For information about performance implications, see the documentation for the specific [dynamic management view](../../relational-databases/views/views.md).</span></span>  
  
-   <span data-ttu-id="a1f03-147">Query di viste del catalogo.</span><span class="sxs-lookup"><span data-stu-id="a1f03-147">Querying catalog views.</span></span>  
  
-   <span data-ttu-id="a1f03-148">Comandi DBCC di base quali DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` e DBCC SQLPERF.</span><span class="sxs-lookup"><span data-stu-id="a1f03-148">Basic DBCC commands such as DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` and DBCC SQLPERF.</span></span> <span data-ttu-id="a1f03-149">Non eseguire comandi con utilizzo intensivo di risorse, ad esempio **DBCC** CHECKDB, DBCC DBREINDEX o DBCC SHRINKDATABASE.</span><span class="sxs-lookup"><span data-stu-id="a1f03-149">Do not run resource-intensive commands such as **DBCC** CHECKDB, DBCC DBREINDEX, or DBCC SHRINKDATABASE.</span></span>  
  
-   <span data-ttu-id="a1f03-150">Comando [!INCLUDE[tsql](../../includes/tsql-md.md)] KILL *\<spid>* .</span><span class="sxs-lookup"><span data-stu-id="a1f03-150">[!INCLUDE[tsql](../../includes/tsql-md.md)] KILL*\<spid>* command.</span></span> <span data-ttu-id="a1f03-151">In base allo stato di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], il comando KILL potrebbe non avere sempre esito positivo. In questo caso, l'unica possibilità potrebbe consistere nel riavviare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a1f03-151">Depending on the state of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the KILL command might not always succeed; then the only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a1f03-152">Di seguito vengono riportate alcune linee guida generali:</span><span class="sxs-lookup"><span data-stu-id="a1f03-152">The following are some general guidelines:</span></span>  
  
    -   <span data-ttu-id="a1f03-153">Verificare che lo SPID sia stato effettivamente terminato eseguendo la query `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="a1f03-153">Verify that the SPID was actually killed by querying `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span></span> <span data-ttu-id="a1f03-154">Se non viene restituita alcuna riga, la sessione è stata terminata.</span><span class="sxs-lookup"><span data-stu-id="a1f03-154">If it returns no rows, it means the session was killed.</span></span>  
  
    -   <span data-ttu-id="a1f03-155">Se la sessione è ancora attiva, verificare l'eventuale presenza di processi assegnati alla sessione eseguendo la query `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="a1f03-155">If the session is still there, verify whether there are tasks assigned to this session by running the query `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span></span> <span data-ttu-id="a1f03-156">Se viene visualizzato il processo, è molto probabile che sia in corso la terminazione della sessione.</span><span class="sxs-lookup"><span data-stu-id="a1f03-156">If you see the task there, most likely your session is currently being killed.</span></span> <span data-ttu-id="a1f03-157">Si noti che l'operazione potrebbe richiedere una notevole quantità di tempo e non riuscire.</span><span class="sxs-lookup"><span data-stu-id="a1f03-157">Note that this may take considerable amount of time and may not succeed at all.</span></span>  
  
    -   <span data-ttu-id="a1f03-158">Se nella vista sys.dm_os_tasks non vi sono processi associati alla sessione, ma questa è ancora presente nella vista sys.dm_exec_sessions dopo l'esecuzione di un comando KILL, allora non è disponibile un thread di lavoro.</span><span class="sxs-lookup"><span data-stu-id="a1f03-158">If there are no tasks in the sys.dm_os_tasks associated with this session, but the session remains in sys.dm_exec_sessions after executing the KILL command, it means that you do not have a worker available.</span></span> <span data-ttu-id="a1f03-159">Selezionare uno dei processi attualmente in esecuzione (un processo elencato nella vista sys.dm_os_tasks con un `sessions_id <> NULL`) e terminare la sessione ad esso associata per liberare il thread di lavoro.</span><span class="sxs-lookup"><span data-stu-id="a1f03-159">Select one of the currently running tasks (a task listed in the sys.dm_os_tasks view with a `sessions_id <> NULL`), and kill the session associated with it to free up the worker.</span></span> <span data-ttu-id="a1f03-160">Si noti che la terminazione di una singola sessione potrebbe non essere sufficiente e che potrebbe essere necessario terminare più sessioni.</span><span class="sxs-lookup"><span data-stu-id="a1f03-160">Note that it may not be enough to kill a single session: you may have to kill multiple ones.</span></span>  
  
## <a name="dac-port"></a><span data-ttu-id="a1f03-161">Porta della connessione DAC</span><span class="sxs-lookup"><span data-stu-id="a1f03-161">DAC Port</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a1f03-162">è in attesa della connessione DAC sulla porta TCP 1434 se disponibile o una porta TCP assegnata dinamicamente all'avvio di [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a1f03-162">listens for the DAC on TCP port 1434 if available or a TCP port dynamically assigned upon [!INCLUDE[ssDE](../../includes/ssde-md.md)] startup.</span></span> <span data-ttu-id="a1f03-163">Il log degli errori contiene il numero di porta su cui è in attesa la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-163">The error log contains the port number the DAC is listening on.</span></span> <span data-ttu-id="a1f03-164">Per impostazione predefinita, il listener della connessione DAC accetta connessioni solo sulla porta locale.</span><span class="sxs-lookup"><span data-stu-id="a1f03-164">By default the DAC listener accepts connection on only the local port.</span></span> <span data-ttu-id="a1f03-165">Per un esempio di codice che attiva le connessioni amministrative remote, vedere [Opzione di configurazione del server remote admin connections](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="a1f03-165">For a code sample that activates remote administration connections, see [remote admin connections Server Configuration Option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="a1f03-166">Dopo aver configurato la connessione amministrativa remota, il listener della connessione DAC viene abilitato senza richiedere un riavvio di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , pertanto da tale istante un client può stabilire una connessione DAC in remoto.</span><span class="sxs-lookup"><span data-stu-id="a1f03-166">After the remote administration connection is configured, the DAC listener is enabled without requiring a restart of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and a client can now connect to the DAC remotely.</span></span> <span data-ttu-id="a1f03-167">È possibile abilitare il listener della connessione DAC per accettare connessioni in remoto anche se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non risponde effettuando prima una connessione a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilizzando la connessione DAC locale, quindi eseguendo la store procedure sp_configure per accettare la connessione da connessioni remote.</span><span class="sxs-lookup"><span data-stu-id="a1f03-167">You can enable the DAC listener to accept connections remotely even if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive by first connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the DAC locally, and then executing the sp_configure stored procedure to accept connection from remote connections.</span></span>  
  
 <span data-ttu-id="a1f03-168">Nelle configurazioni cluster la connessione DAC è disattivata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a1f03-168">On cluster configurations, the DAC will be off by default.</span></span> <span data-ttu-id="a1f03-169">Gli utenti possono utilizzare l'opzione remote admin connection di sp_configure per abilitare il listener della connessione DAC per l'accesso a una connessione remota.</span><span class="sxs-lookup"><span data-stu-id="a1f03-169">Users can execute the remote admin connection option of sp_configure to enable the DAC listener to access a remote connection.</span></span> <span data-ttu-id="a1f03-170">Se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non risponde e il listener della connessione DAC non è abilitato, potrebbe essere necessario riavviare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] per poter stabilire la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-170">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive and the DAC listener is not enabled, you might have to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to connect with the DAC.</span></span> <span data-ttu-id="a1f03-171">È pertanto consigliabile abilitare l'opzione di configurazione remote admin connections in sistemi cluster.</span><span class="sxs-lookup"><span data-stu-id="a1f03-171">Therefore, we recommend that you enable the remote admin connections configuration option on clustered systems.</span></span>  
  
 <span data-ttu-id="a1f03-172">La porta della connessione DAC viene assegnata dinamicamente da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] durante l'avvio.</span><span class="sxs-lookup"><span data-stu-id="a1f03-172">The DAC port is assigned dynamically by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] during startup.</span></span> <span data-ttu-id="a1f03-173">Durante la connessione all'istanza predefinita, l'applicazione livello dati evita di usare una richiesta SSRP (Resolution Protocol) di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] al servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="a1f03-173">When connecting to the default instance, the DAC avoids using a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resolution Protocol (SSRP) request to the SQL Server Browser Service when connecting.</span></span> <span data-ttu-id="a1f03-174">Essa si connette prima sulla porta TCP 1434.</span><span class="sxs-lookup"><span data-stu-id="a1f03-174">It first connects over TCP port 1434.</span></span> <span data-ttu-id="a1f03-175">Se questo tentativo di connessione termina con esito negativo, la connessione DAC esegue una chiamata SSRP per ottenere la porta.</span><span class="sxs-lookup"><span data-stu-id="a1f03-175">If that fails, it makes an SSRP call to get the port.</span></span> <span data-ttu-id="a1f03-176">Se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser non è in attesa di richieste SSRP, la richiesta di connessione restituisce un errore.</span><span class="sxs-lookup"><span data-stu-id="a1f03-176">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser is not listening for SSRP requests, the connection request returns an error.</span></span> <span data-ttu-id="a1f03-177">Vedere il log degli errori per ottenere il numero di porta su cui è in attesa la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-177">Refer to the error log to find the port number DAC is listening on.</span></span> <span data-ttu-id="a1f03-178">Se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è configurato per accettare connessioni amministrative remote, è necessario inizializzare l'applicazione livello dati con un numero di porta esplicito:</span><span class="sxs-lookup"><span data-stu-id="a1f03-178">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept remote administration connections, the DAC must be initiated with an explicit port number:</span></span>  
  
 <span data-ttu-id="a1f03-179">**SQLCMD-Stcp:** _ \<server> , \<port> _</span><span class="sxs-lookup"><span data-stu-id="a1f03-179">**sqlcmd-Stcp:** _\<server>,\<port>_</span></span>  
  
 <span data-ttu-id="a1f03-180">Il log degli errori di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] elenca il numero di porta relativo all'applicazione livello dati, che per impostazione predefinita è 1434.</span><span class="sxs-lookup"><span data-stu-id="a1f03-180">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error log lists the port number for the DAC, which is 1434 by default.</span></span> <span data-ttu-id="a1f03-181">Se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è configurato per accettare solo applicazioni livello dati locali, eseguire la connessione utilizzando l'adattatore loopback con il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="a1f03-181">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept local DAC connections only, connect using the loopback adapter using the following command:</span></span>  
  
 <span data-ttu-id="a1f03-182">**SQLCMD-s 127.0.0.1**,`1434`</span><span class="sxs-lookup"><span data-stu-id="a1f03-182">**sqlcmd-S127.0.0.1**,`1434`</span></span>  
  
## <a name="example"></a><span data-ttu-id="a1f03-183">Esempio</span><span class="sxs-lookup"><span data-stu-id="a1f03-183">Example</span></span>  
 <span data-ttu-id="a1f03-184">In questo esempio un amministratore si accorge che il server `URAN123` non risponde e desidera diagnosticare il problema.</span><span class="sxs-lookup"><span data-stu-id="a1f03-184">In this example, an administrator notices that server `URAN123` is not responding and wants to diagnose the problem.</span></span> <span data-ttu-id="a1f03-185">A tale scopo, l'utente attiva l'utilità della riga di comando `sqlcmd` e si connette al server `URAN123` utilizzando `-A` per indicare la connessione DAC.</span><span class="sxs-lookup"><span data-stu-id="a1f03-185">To do this, the user activates the `sqlcmd` command prompt utility and connects to server `URAN123` using `-A` to indicate the DAC.</span></span>  
  
 `sqlcmd -S URAN123 -U sa -P <xxx> -A`  
  
 <span data-ttu-id="a1f03-186">L'amministratore può quindi eseguire query per diagnosticare il problema e, se necessario, terminare le sessioni che non rispondono.</span><span class="sxs-lookup"><span data-stu-id="a1f03-186">The administrator can now execute queries to diagnose the problem and possibly terminate the unresponsive sessions.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="a1f03-187">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="a1f03-187">Related Tasks</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="a1f03-188">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="a1f03-188">Related Content</span></span>  
 [<span data-ttu-id="a1f03-189">Utilizzo di sqlcmd con variabili di scripting</span><span class="sxs-lookup"><span data-stu-id="a1f03-189">Use sqlcmd with Scripting Variables</span></span>](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md)  
  
 [<span data-ttu-id="a1f03-190">Utilità sqlcmd</span><span class="sxs-lookup"><span data-stu-id="a1f03-190">sqlcmd Utility</span></span>](../../tools/sqlcmd-utility.md)  
  
 [<span data-ttu-id="a1f03-191">SELECT &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-191">SELECT &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/queries/select-transact-sql)  
  
 [<span data-ttu-id="a1f03-192">sp_who &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-192">sp_who &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql)  
  
 [<span data-ttu-id="a1f03-193">sp_lock &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-193">sp_lock &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-lock-transact-sql)  
  
 [<span data-ttu-id="a1f03-194">KILL &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-194">KILL &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/language-elements/kill-transact-sql)  
  
 [<span data-ttu-id="a1f03-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkalloc-transact-sql)  
  
 [<span data-ttu-id="a1f03-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql)  
  
 [<span data-ttu-id="a1f03-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-opentran-transact-sql)  
  
 [<span data-ttu-id="a1f03-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-inputbuffer-transact-sql)  
  
 [<span data-ttu-id="a1f03-199">Opzioni di configurazione del server &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-199">Server Configuration Options &#40;SQL Server&#41;</span></span>](server-configuration-options-sql-server.md)  
  
 [<span data-ttu-id="a1f03-200">Funzioni e viste a gestione dinamica relative alle transazioni &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-200">Transaction Related Dynamic Management Views and Functions &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/transaction-related-dynamic-management-views-and-functions-transact-sql)  
  
 [<span data-ttu-id="a1f03-201">Flag di traccia &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a1f03-201">Trace Flags &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql)  
  
  
