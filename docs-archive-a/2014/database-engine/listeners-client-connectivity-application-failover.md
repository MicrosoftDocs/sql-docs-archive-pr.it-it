---
title: Listener del gruppo di disponibilità, connettività client e failover dell'applicazione (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], listeners
- read-only routing
- read-intent connections [AlwaysOn Availability Groups]
- Availability Groups [SQL Server], configuring
- Availability Groups [SQL Server], read-only routing
- Availability Groups [SQL Server], client connectivity
ms.assetid: 76fb3eca-6b08-4610-8d79-64019dd56c44
author: rothja
ms.author: jroth
ms.openlocfilehash: f66046625ca0078904e9555d1cf586873b9f697f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714555"
---
# <a name="availability-group-listeners-client-connectivity-and-application-failover-sql-server"></a><span data-ttu-id="2b175-102">Listener del gruppo di disponibilità, connettività client e failover dell'applicazione (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="2b175-102">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>
  <span data-ttu-id="2b175-103">In questo argomento sono contenute informazioni sulla funzionalità di failover delle applicazioni e sulla connettività client di [!INCLUDE[ssHADR](../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2b175-103">This topic contains information about considerations for [!INCLUDE[ssHADR](../includes/sshadr-md.md)] client connectivity and application-failover functionality.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2b175-104">Per la maggior parte delle configurazioni comuni del listener, è possibile creare il listener del primo gruppo di disponibilità tramite cmdlet di PowerShell o istruzioni [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2b175-104">For the majority of the common listener configurations, you can create the first availability group listener simply by using [!INCLUDE[tsql](../includes/tsql-md.md)] statements or PowerShell cmdlets.</span></span> <span data-ttu-id="2b175-105">Per ulteriori informazioni, vedere [Attività correlate](#RelatedTasks)più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="2b175-105">For more information, see [Related Tasks](#RelatedTasks), later in this topic.</span></span>  
  
 
  
##  <a name="availability-group-listeners"></a><a name="AGlisteners"></a> <span data-ttu-id="2b175-106">Listener del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-106">Availability Group Listeners</span></span>  
 <span data-ttu-id="2b175-107">È possibile fornire la connettività client al database di un determinato gruppo di disponibilità creando un listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-107">You can provide client connectivity to the database of a given availability group by creating an availability group listener.</span></span> <span data-ttu-id="2b175-108">Un listener del gruppo di disponibilità è un nome di rete virtuale (VNN, Virtual Network Name) a cui i client possono connettersi per accedere a un database in una replica primaria o secondaria di un gruppo di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="2b175-108">An availability group listener is a virtual network name (VNN) to which clients can connect in order to access a database in a primary or secondary replica of an AlwaysOn availability group.</span></span> <span data-ttu-id="2b175-109">Un listener del gruppo di disponibilità consente a un client di connettersi a una replica di disponibilità senza conoscere il nome dell'istanza fisica di SQL Server a cui il client si deve connettere.</span><span class="sxs-lookup"><span data-stu-id="2b175-109">An availability group listener enables a client to connect to an availability replica without knowing the name of the physical instance of SQL Server to which the client is connecting.</span></span>  <span data-ttu-id="2b175-110">Non è necessario modificare la stringa di connessione client per connettersi al percorso corrente della replica primaria corrente.</span><span class="sxs-lookup"><span data-stu-id="2b175-110">The client connection string does not need to be modified to connect to the current location of the current primary replica.</span></span>  
  
 <span data-ttu-id="2b175-111">Un listener del gruppo di disponibilità è composto da un nome listener DNS, dal numero di porta e da uno o più indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="2b175-111">An availability group listener consists of a Domain Name System (DNS) listener name, listener port designation, and one or more IP addresses.</span></span> <span data-ttu-id="2b175-112">Solo il protocollo TCP è supportato dal listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-112">Only the TCP protocol is supported by availability group listener.</span></span>  <span data-ttu-id="2b175-113">È inoltre necessario che il nome DNS del listener sia univoco nel dominio e in NetBIOS.</span><span class="sxs-lookup"><span data-stu-id="2b175-113">The DNS name of the listener must also be unique in the domain and in NetBIOS.</span></span>  <span data-ttu-id="2b175-114">Alla sua creazione, il listener del gruppo di disponibilità diventa una risorsa di un cluster con un nome di rete virtuale (VNN) e un indirizzo IP virtuale (VIP) associati, oltre alla dipendenza del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-114">When you create a new availability group listener it becomes a resource in a cluster with an associated virtual network name (VNN), virtual IP (VIP), and availability group dependency.</span></span> <span data-ttu-id="2b175-115">Un client utilizza il DNS per risolvere il VNN in più indirizzi IP e quindi tenta di connettersi a ogni indirizzo, fino a che una richiesta di connessione riesce o fino a che le richieste di connessione non scadranno.</span><span class="sxs-lookup"><span data-stu-id="2b175-115">A client uses DNS to resolve the VNN into multiple IP addresses and then tries to connect to each address, until a connection request succeeds or until the connection requests time out.</span></span>  
  
 <span data-ttu-id="2b175-116">Se il routing di sola lettura è configurato per una o più[repliche secondarie leggibili](availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md), le connessioni client con finalità di lettura alla replica primaria vengono reindirizzate a una replica secondaria leggibile.</span><span class="sxs-lookup"><span data-stu-id="2b175-116">If read-only routing is configured for one or more[readable secondary replicas](availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md), read-intent client connections to the primary replica are redirected to a readable secondary replica.</span></span> <span data-ttu-id="2b175-117">Inoltre, se la replica primaria viene portata offline su un'istanza di SQL Server e una nuova replica primaria viene portata online su un'altra, il listener del gruppo di disponibilità abilita i client a connettersi alla nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="2b175-117">Also, if the primary replica goes offline on one instance of SQL Server, and a new primary replica comes online on another instance of SQL Server, the availability group listener enables clients to connect to the new primary replica.</span></span>  
  
 <span data-ttu-id="2b175-118">Per informazioni essenziali sui listener del gruppo di disponibilità, vedere [Creare o configurare un listener del gruppo di disponibilità &#40;SQL Server&#41;](availability-groups/windows/create-or-configure-an-availability-group-listener-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="2b175-118">For essential information about availability group listeners, see [Create or Configure an Availability Group Listener &#40;SQL Server&#41;](availability-groups/windows/create-or-configure-an-availability-group-listener-sql-server.md).</span></span>  
  
 
  
###  <a name="availability-group-listener-configuration"></a><a name="AGlConfig"></a> <span data-ttu-id="2b175-119">Configurazione del listener del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-119">Availability Group Listener Configuration</span></span>  
 <span data-ttu-id="2b175-120">Il listener del gruppo di disponibilità è definito dagli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="2b175-120">An availability group listener is defined by the following:</span></span>  
  
 <span data-ttu-id="2b175-121">Nome DNS univoco</span><span class="sxs-lookup"><span data-stu-id="2b175-121">A unique DNS name</span></span>  
 <span data-ttu-id="2b175-122">È noto anche come nome di rete virtuale (VNN).</span><span class="sxs-lookup"><span data-stu-id="2b175-122">This is also known as a Virtual Network Name (VNN).</span></span> <span data-ttu-id="2b175-123">Si applicano le regole di denominazione di Active Directory per i nomi host DNS.</span><span class="sxs-lookup"><span data-stu-id="2b175-123">Active Directory naming rules for DNS host names apply.</span></span> <span data-ttu-id="2b175-124">Per ulteriori informazioni, vedere l'articolo della Knowledge Base [Convenzioni di denominazione di Active Directory per computer, domini, siti e unità organizzative](https://support.microsoft.com/kb/909264) .</span><span class="sxs-lookup"><span data-stu-id="2b175-124">For more information, see the [Naming conventions in Active Directory for computers, domains, sites, and OUs](https://support.microsoft.com/kb/909264) KB article.</span></span>  
  
 <span data-ttu-id="2b175-125">Uno o più indirizzi IP virtuali (VIP)</span><span class="sxs-lookup"><span data-stu-id="2b175-125">One or more Virtual IP addresses (VIPs)</span></span>  
 <span data-ttu-id="2b175-126">Indirizzi IP virtuali configurati per una o più subnet su cui è possibile eseguire il failover del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-126">VIPs are configured for one or more subnets to which the availability group can failover.</span></span>  
  
 <span data-ttu-id="2b175-127">Configurazione dell'indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="2b175-127">IP address configuration</span></span>  
 <span data-ttu-id="2b175-128">Per un listener del gruppo di disponibilità specifico, nell'indirizzo IP vengono utilizzati il protocollo DHCP (Dynamic Host Configuration Protocol) o uno o più indirizzi IP statici.</span><span class="sxs-lookup"><span data-stu-id="2b175-128">For a given availability group listener, the IP address uses either Dynamic Host Configuration Protocol (DHCP) or one or more static IP addresses.</span></span>  
  
-   <span data-ttu-id="2b175-129">Dynamic Host Configuration Protocol (DHCP)</span><span class="sxs-lookup"><span data-stu-id="2b175-129">Dynamic Host Configuration Protocol (DHCP)</span></span>  
  
     <span data-ttu-id="2b175-130">Se un gruppo di disponibilità risiede in una sola subnet, è possibile configurare tutti gli indirizzi IP del listener del gruppo di disponibilità per l'utilizzo di DHCP.</span><span class="sxs-lookup"><span data-stu-id="2b175-130">If an availability group resides on a single subnet, you can configure all the availability group listener IP addresses to use DHCP.</span></span> <span data-ttu-id="2b175-131">Per gli ambienti di pre-produzione, tramite DHCP viene offerta una semplice installazione per un gruppo di disponibilità per cui non è richiesto il ripristino di emergenza su un sito remoto in una subnet separata.</span><span class="sxs-lookup"><span data-stu-id="2b175-131">For pre-production environments, DHCP offers an easy setup for an availability group that does not require disaster recovery to a remote site on a separate subnet.</span></span> <span data-ttu-id="2b175-132">Tuttavia, non è consigliabile utilizzare DHCP insieme a un listener del gruppo di disponibilità in un ambiente di produzione,</span><span class="sxs-lookup"><span data-stu-id="2b175-132">However, you should not use DHCP in conjunction with an availability group listener in a production environment.</span></span> <span data-ttu-id="2b175-133">poiché in caso di inattività, se il lease IP DHCP scade, per la registrazione del nuovo indirizzo IP DHCP associato al nome DNS del listener viene richiesto tempo aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="2b175-133">This is because, in the event of down time, if the DHCP IP lease expires, extra time is required to re-register the new DHCP IP address associated with the listener DNS name.</span></span> <span data-ttu-id="2b175-134">Il tempo aggiuntivo causerà un errore di connessione del client.</span><span class="sxs-lookup"><span data-stu-id="2b175-134">The extra time will cause client-connection failure.</span></span>  
  
-   <span data-ttu-id="2b175-135">Indirizzi IP statici</span><span class="sxs-lookup"><span data-stu-id="2b175-135">Static IP addresses</span></span>  
  
     <span data-ttu-id="2b175-136">Negli ambienti di produzione è consigliabile che nei listener del gruppo di disponibilità vengano utilizzati indirizzi IP statici.</span><span class="sxs-lookup"><span data-stu-id="2b175-136">In production environments, we recommend that availability group listeners use static IP addresses.</span></span> <span data-ttu-id="2b175-137">Inoltre, nel caso in cui i gruppi di disponibilità si estendano su più subnet di un dominio, nel listener di un gruppo di disponibilità devono essere utilizzati indirizzi IP statici.</span><span class="sxs-lookup"><span data-stu-id="2b175-137">Furthermore, where availability groups extend across subnets in a multi-subnet domain, an availability group listener must use static IP addresses.</span></span>  
  
 <span data-ttu-id="2b175-138">Le configurazioni di rete ibride e DHCP su più subnet non sono supportate per i listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-138">Hybrid network configurations and DHCP across subnets are not supported for availability group listeners.</span></span> <span data-ttu-id="2b175-139">Quando si verifica un failover è di fatto possibile che un indirizzo IP dinamico scada o venga rilasciato, compromettendo la disponibilità elevata complessiva.</span><span class="sxs-lookup"><span data-stu-id="2b175-139">This is because when a failover happens, a dynamic IP might expire or be released, which jeopardizes overall high availability.</span></span>  
  
###  <a name="selecting-an-availability-group-listener-port"></a><a name="SelectListenerPort"></a> <span data-ttu-id="2b175-140">Selezione della porta per il listener del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-140">Selecting an Availability Group Listener Port</span></span>  
 <span data-ttu-id="2b175-141">Quando si configura un listener del gruppo di disponibilità, è necessario specificare una porta.</span><span class="sxs-lookup"><span data-stu-id="2b175-141">When configuring an availability group listener, you must designate a port.</span></span>  <span data-ttu-id="2b175-142">È possibile configurare la porta predefinita su 1433 per non rendere troppo complesse le stringhe di connessione client.</span><span class="sxs-lookup"><span data-stu-id="2b175-142">You can configure the default port to 1433 in order to allow for simplicity of the client connection strings.</span></span> <span data-ttu-id="2b175-143">Se si intende utilizzare la porta 1433, non è necessario specificare un numero di porta in una stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="2b175-143">If using 1433, you do not need to designate a port number in a connection string.</span></span>   <span data-ttu-id="2b175-144">Inoltre, poiché ogni listener del gruppo di disponibilità dispone di un nome di rete virtuale separato, ogni listener del gruppo di disponibilità configurato su un solo cluster WSFC può essere configurato per fare riferimento alla stessa porta predefinita 1433.</span><span class="sxs-lookup"><span data-stu-id="2b175-144">Also, since each availability group listener will have a separate virtual network name, each availability group listener configured on a single WSFC can be configured to reference the same default port of 1433.</span></span>  
  
 <span data-ttu-id="2b175-145">È inoltre possibile specificare una porta del listener non standard. Ciò significa, tuttavia, che è necessario specificare in modo esplicito una porta di destinazione nella stringa di connessione ogni volta che ci si connette al listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-145">You can also designate a non-standard listener port; however this means that you will also need to explicitly specify a target port in your connection string whenever connecting to the availability group listener.</span></span>  <span data-ttu-id="2b175-146">Sarà inoltre necessario aprire un'autorizzazione sul firewall per la porta non standard.</span><span class="sxs-lookup"><span data-stu-id="2b175-146">You will also need to open permission on the firewall for the non-standard port.</span></span>  
  
 <span data-ttu-id="2b175-147">Se si utilizza la porta predefinita 1433 per il nome di rete virtuale del listener del gruppo di disponibilità, è necessario assicurarsi che nessuno altro servizio sul nodo cluster utilizzi questa porta, cosa che provocherebbe un conflitto tra porte.</span><span class="sxs-lookup"><span data-stu-id="2b175-147">If you use the default port of 1433 for availability group listener VNNs, you will still need to ensure that no other services on the cluster node are using this port; otherwise this would cause a port conflict.</span></span>  
  
 <span data-ttu-id="2b175-148">Se una delle istanze di SQL Server è già in attesa sulla porta TCP 1433 attraverso il listener dell'istanza e nessun altro servizio, incluse istanze aggiuntive di SQL Server, nel computer è in attesa sulla porta 1433, non si verificherà alcun conflitto tra porte con il listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-148">If one of the instances of SQL Server is already listening on TCP port 1433 via the instance listener and there are no other services (including additional instances of SQL Server) on the computer listening on port 1433, this will not cause a port conflict with the availability group listener.</span></span>  <span data-ttu-id="2b175-149">Il motivo è dato dal fatto che il listener del gruppo di disponibilità può condividere la stessa porta TCP nello stesso processo del servizio.</span><span class="sxs-lookup"><span data-stu-id="2b175-149">This is because the availability group listener can share the same TCP port inside the same service process.</span></span>  <span data-ttu-id="2b175-150">È tuttavia opportuno non configurare più istanze di SQL Server (side-by-side) per l'attesa sulla stessa porta.</span><span class="sxs-lookup"><span data-stu-id="2b175-150">However multiple instances of SQL Server (side-by-side)should not be configured to listen on the same port.</span></span>  
  
##  <a name="using-a-listener-to-connect-to-the-primary-replica"></a><a name="ConnectToPrimary"></a><span data-ttu-id="2b175-151">Uso di un listener per connettersi alla replica primaria</span><span class="sxs-lookup"><span data-stu-id="2b175-151">Using a Listener to Connect to the Primary Replica</span></span>  
 <span data-ttu-id="2b175-152">Per utilizzare un listener del gruppo di disponibilità per connettersi alla replica primaria per l'accesso in lettura e scrittura, nella stringa di connessione è necessario specificare il nome DNS del listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-152">To use an availability group listener to connect to the primary replica for read-write access, the connection string specifies the availability group listener DNS name.</span></span>  <span data-ttu-id="2b175-153">Se una nuova replica diventa la replica primaria del gruppo di disponibilità, le connessioni esistenti che utilizzano il nome di rete del listener del gruppo di disponibilità vengono interrotte.</span><span class="sxs-lookup"><span data-stu-id="2b175-153">If an availability group primary replica changes to a new replica, existing connections that use an availability group listener's network name are disconnected.</span></span>  <span data-ttu-id="2b175-154">Le nuove connessioni al listener del gruppo di disponibilità vengono quindi indirizzate alla nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="2b175-154">New connections to the availability group listener are then directed to the new primary replica.</span></span> <span data-ttu-id="2b175-155">Di seguito è riportato un esempio di una stringa di connessione di base per il provider ADO.NET (System.Data.SqlClient).</span><span class="sxs-lookup"><span data-stu-id="2b175-155">An example of a basic connection string for the ADO.NET provider (System.Data.SqlClient) is as follows:</span></span>  
  
```  
Server=tcp: AGListener,1433;Database=MyDB;IntegratedSecurity=SSPI  
```  
  
 <span data-ttu-id="2b175-156">È ancora possibile scegliere di fare riferimento direttamente all'istanza del nome SQL Server della replica primaria o delle repliche secondarie anziché utilizzare il nome server del listener del gruppo di disponibilità, tuttavia se si sceglie di procedere in questo modo le nuove connessioni non verranno indirizzate automaticamente alla replica primaria corrente, perdendo così un notevole vantaggio.</span><span class="sxs-lookup"><span data-stu-id="2b175-156">You can still choose to directly reference the instance of SQL Server name of the primary or secondary replicas instead of using the availability group listener server name, however if you choose to do so you will lose the benefit of new connections being directed automatically to the current primary replica.</span></span>  <span data-ttu-id="2b175-157">Verranno meno anche i vantaggi derivanti dal routing in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-157">You will also lose the benefit of read-only routing.</span></span>  
  
##  <a name="using-a-listener-to-connect-to-a-read-only-secondary-replica-read-only-routing"></a><a name="ConnectToSecondary"></a> <span data-ttu-id="2b175-158">Utilizzo di un listener per connettersi a una replica secondaria di sola lettura (routing di sola lettura)</span><span class="sxs-lookup"><span data-stu-id="2b175-158">Using a Listener to Connect to a Read-Only Secondary Replica (Read-Only Routing)</span></span>  
 <span data-ttu-id="2b175-159">Con*routing di sola lettura* si intende la capacità di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] di instradare le connessioni in ingresso dirette a un listener del gruppo di disponibilità a una replica secondaria configurata per consentire carichi di lavoro di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-159">*Read-only routing* refers to the ability of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to route incoming connections to an availability group listener to a secondary replica that is configured to allow read-only workloads.</span></span> <span data-ttu-id="2b175-160">Una connessione in ingresso che fa riferimento a un nome del listener del gruppo di disponibilità può essere automaticamente indirizzata a una replica in sola lettura qualora sussistano le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="2b175-160">An incoming connection referencing an availability group listener name can automatically be routed to a read-only replica if the following are true:</span></span>  
  
-   <span data-ttu-id="2b175-161">Almeno una replica secondaria viene impostata sull'accesso di sola lettura e ogni replica secondaria di sola lettura e la replica primaria vengono configurate per supportare il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-161">At least one secondary replica is set to read-only access, and each read-only secondary replica and the primary replica are configured to support read-only routing.</span></span> <span data-ttu-id="2b175-162">Per altre informazioni, vedere [Per configurare repliche di disponibilità per il routing di sola lettura](#ConfigureARsForROR)più avanti in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="2b175-162">For more information, see [To Configure Availability Replicas for Read-Only Routing](#ConfigureARsForROR), later in this section.</span></span>  
  
-   <span data-ttu-id="2b175-163">La stringa di connessione fa riferimento a un listener del gruppo di disponibilità e la finalità dell'applicazione della connessione in ingresso è impostata su sola lettura, ad esempio con la parola chiave **Application Intent=ReadOnly** nelle proprietà o negli attributi di connessione oppure nelle stringhe di connessione ODBC o OLEDB.</span><span class="sxs-lookup"><span data-stu-id="2b175-163">The connection string references an availability group listener, and the application intent of the incoming connection is set to read-only (for example, by using the **Application Intent=ReadOnly** keyword in the ODBC or OLEDB connection strings or connection attributes or properties).</span></span> <span data-ttu-id="2b175-164">Per altre informazioni, vedere [Finalità dell'applicazione di sola lettura e routing di sola lettura](#ReadOnlyAppIntent)più avanti in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="2b175-164">For more information, see [Read-Only Application Intent and Read-Only Routing](#ReadOnlyAppIntent), later in this section.</span></span>  
  
###  <a name="to-configure-availability-replicas-for-read-only-routing"></a><a name="ConfigureARsForROR"></a> <span data-ttu-id="2b175-165">Per configurare repliche di disponibilità per il routing di sola lettura</span><span class="sxs-lookup"><span data-stu-id="2b175-165">To Configure Availability Replicas for Read-Only Routing</span></span>  
 <span data-ttu-id="2b175-166">Un amministratore del database deve configurare le repliche di disponibilità come segue:</span><span class="sxs-lookup"><span data-stu-id="2b175-166">A database administrator must configure the availability replicas as follows:</span></span>  
  
1.  <span data-ttu-id="2b175-167">Per ogni replica di disponibilità che si desidera configurare come replica secondaria leggibile, un amministratore del database deve configurare le impostazioni seguenti che vengono applicate solo nel ruolo secondario:</span><span class="sxs-lookup"><span data-stu-id="2b175-167">For each availability replica that you want to configure as a readable secondary replica, a database administrator must configure the following settings, which take effect only under the secondary role:</span></span>  
  
    -   <span data-ttu-id="2b175-168">È necessario impostare l'accesso alla connessione su "tutto" o "sola lettura".</span><span class="sxs-lookup"><span data-stu-id="2b175-168">Connection access must be set to "all" or "read only".</span></span>  
  
    -   <span data-ttu-id="2b175-169">È necessario specificare l'URL del routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-169">The read-only routing URL must be specified.</span></span>  
  
2.  <span data-ttu-id="2b175-170">Per ognuna di queste repliche, è necessario specificare un elenco di routing di sola lettura per il ruolo primario.</span><span class="sxs-lookup"><span data-stu-id="2b175-170">For each of these replicas, a read-only routing list must be specified for the primary role.</span></span> <span data-ttu-id="2b175-171">Specificare uno o più nomi di server come destinazioni del routing.</span><span class="sxs-lookup"><span data-stu-id="2b175-171">Specify one or more server names as routing targets.</span></span>  
  
####  <a name="related-tasks"></a><a name="RelatedTasksROR"></a> <span data-ttu-id="2b175-172">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="2b175-172">Related Tasks</span></span>  
  
-   [<span data-ttu-id="2b175-173">Configurare l'accesso in sola lettura in una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-173">Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;</span></span>](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="2b175-174">Configurare il routing di sola lettura per un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-174">Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;</span></span>](availability-groups/windows/configure-read-only-routing-for-an-availability-group-sql-server.md)  
  
###  <a name="read-only-application-intent-and-read-only-routing"></a><a name="ReadOnlyAppIntent"></a><span data-ttu-id="2b175-175">Finalità dell'applicazione di sola lettura e routing di sola lettura</span><span class="sxs-lookup"><span data-stu-id="2b175-175">Read-Only Application Intent and Read-Only Routing</span></span>  
 <span data-ttu-id="2b175-176">La proprietà della stringa di connessione della finalità dell'applicazione esprime la richiesta dell'applicazione client di essere indirizzata a una versione in lettura e scrittura o in sola lettura del database del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-176">The application intent connection string property expresses the client application's request to be directed either to a read-write or read-only version of an availability group database.</span></span> <span data-ttu-id="2b175-177">Per utilizzare un routing di sola lettura, un client deve utilizzare la finalità dell'applicazione di sola lettura nella stringa di connessione per connettersi al listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-177">To use read-only routing, a client must use an application intent of read-only in the connection string when connecting to the availability group listener.</span></span> <span data-ttu-id="2b175-178">Senza la finalità dell'applicazione di sola lettura, le connessioni al listener del gruppo di disponibilità sono indirizzate al database sulla una replica primaria.</span><span class="sxs-lookup"><span data-stu-id="2b175-178">Without the read-only application intent, connections to the availability group listener are directed to the database on the primary replica.</span></span>  
  
 <span data-ttu-id="2b175-179">L'attributo della finalità dell'applicazione viene archiviato nella sessione del client durante l'accesso. L'istanza di SQL Server elaborerà questa finalità e determinerà come procedere in base alla configurazione del gruppo di disponibilità e allo stato in lettura e scrittura corrente del database di destinazione nella replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="2b175-179">The application intent attribute is stored in the client's session during login and the instance of SQL Server will then process this intent and determine what to do according to the configuration of the availability group and the current read-write state of the target database in the secondary replica.</span></span>  
  
 <span data-ttu-id="2b175-180">Di seguito è riportato un esempio di una stringa di connessione per il provider ADO.NET (System.Data.SqlClient) che specifica la finalità dell'applicazione in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-180">An example of a connection string for the ADO.NET provider (System.Data.SqlClient) that designates read-only application intent is as follows:</span></span>  
  
```  
Server=tcp:AGListener,1433;Database=AdventureWorks;IntegratedSecurity=SSPI;ApplicationIntent=ReadOnly  
```  
  
 <span data-ttu-id="2b175-181">In questo esempio, il client tenta di connettersi al listener del gruppo di disponibilità denominato `AGListener` sulla porta 1433. (È possibile omettere la porta se il listener del gruppo di disponibilità è in attesa sulla porta 1433).</span><span class="sxs-lookup"><span data-stu-id="2b175-181">In this connection string example, the client is attempting to connect to an availability group listener named `AGListener` on port 1433 (you may also omit the port if the availability group listener is listening on 1433).</span></span>  <span data-ttu-id="2b175-182">La proprietà della stringa di connessione è `ApplicationIntent` impostata su `ReadOnly` , rendendola una *stringa di connessione con finalità di lettura*.</span><span class="sxs-lookup"><span data-stu-id="2b175-182">The connection string has the `ApplicationIntent` property set to `ReadOnly`, making this a *read-intent connection string*.</span></span>  <span data-ttu-id="2b175-183">Senza questa impostazione, il server non avrebbe tentato di eseguire il routing in sola lettura della connessione.</span><span class="sxs-lookup"><span data-stu-id="2b175-183">Without this setting, the server would not have attempted a read-only routing of the connection.</span></span>  
  
 <span data-ttu-id="2b175-184">Il database primario del gruppo di disponibilità elabora la richiesta di routing in sola lettura in ingresso e tenta di trovare una replica online in sola lettura che sia stata aggiunta alla replica primaria e configurata per il routing in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-184">The primary database of the availability group processes the incoming read-only routing request and attempts to locate an online, read-only replica that is joined to the primary replica and is configured for read-only routing.</span></span>  <span data-ttu-id="2b175-185">Il client riceve nuovamente le informazioni di connessione dal server della replica primaria e si connette alla replica in sola lettura identificata.</span><span class="sxs-lookup"><span data-stu-id="2b175-185">The client receives back connection information from the primary replica server and connects to the identified read-only replica.</span></span>  
  
 <span data-ttu-id="2b175-186">La finalità dell'applicazione può essere inviata da un driver client a un'istanza di livello inferiore di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2b175-186">Note that the application intent can be sent from a client driver to a down-level instance of SQL Server.</span></span>  <span data-ttu-id="2b175-187">In questo caso, la finalità dell'applicazione di sola lettura viene ignorato e la connessione procede normalmente.</span><span class="sxs-lookup"><span data-stu-id="2b175-187">In this case, application intent of read-only is ignored and the connection proceeds as normal.</span></span>  
  
 <span data-ttu-id="2b175-188">È possibile ignorare il routing in sola lettura non impostando la proprietà di connessione della finalità dell'applicazione su `ReadOnly` (se non viene specificata alcuna proprietà, il valore predefinito è `ReadWrite` durante l'accesso) oppure connettendosi direttamente all'istanza della replica primaria di SQL Server anziché utilizzare il nome del listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-188">You can bypass read-only routing by not setting the application intent connection property to `ReadOnly` (when not designated, the default is `ReadWrite` during login) or by connecting directly to the primary replica instance of SQL Server instead of using the availability group listener name.</span></span>  <span data-ttu-id="2b175-189">Il routing in sola lettura non può avvenire se la connessione viene eseguita direttamente a una replica in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-189">Read-only routing will also not occur if you connect directly to a read-only replica.</span></span>  
  
####  <a name="related-tasks"></a><a name="RelatedTasksApps"></a> <span data-ttu-id="2b175-190">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="2b175-190">Related Tasks</span></span>  
  
-   [<span data-ttu-id="2b175-191">Supporto di SQL Server Native Client per il ripristino di emergenza a disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="2b175-191">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>](../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)  
  
-   [<span data-ttu-id="2b175-192">Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2b175-192">Using Connection String Keywords with SQL Server Native Client</span></span>](../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
##  <a name="bypassing-availability-group-listeners"></a><a name="BypassAGl"></a><span data-ttu-id="2b175-193">Ignorare i listener del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-193">Bypassing Availability Group Listeners</span></span>  
 <span data-ttu-id="2b175-194">Se i listener dei gruppi di disponibilità consentono il supporto per il reindirizzamento del failover e il routing in sola lettura, le connessioni client non devono utilizzarli.</span><span class="sxs-lookup"><span data-stu-id="2b175-194">While availability group listeners enable support for failover redirection and read-only routing, client connections are not required to use them.</span></span> <span data-ttu-id="2b175-195">Una connessione client può anche fare riferimento all'istanza di SQL Server anziché stabilire la connessione al listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-195">A client connection can also directly reference the instance of SQL Server instead of connecting to the availability group listener.</span></span>  
  
 <span data-ttu-id="2b175-196">Per l'istanza di SQL Server è irrilevante se una connessione effettua l'accesso tramite il listener del gruppo di disponibilità o un altro endpoint dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="2b175-196">To the instance of SQL Server it is irrelevant whether a connection logs in using the availability group listener or using another instance endpoint.</span></span>  <span data-ttu-id="2b175-197">L'istanza di SQL Server verificherà lo stato del database di destinazione e consentirà o meno la connettività in base alla configurazione del gruppo di disponibilità e lo stato corrente del database sull'istanza.</span><span class="sxs-lookup"><span data-stu-id="2b175-197">The instance of SQL Server will verify the state of the targeted database and either allow or disallow connectivity based on the configuration of the availability group and the current state of the database on the instance.</span></span>  <span data-ttu-id="2b175-198">Ad esempio, se un'applicazione client si connette direttamente a un'istanza della porta di SQL Server e a un database di destinazione ospitato in un gruppo di disponibilità e il database di destinazione si trova nello stato primario ed è online, la connettività ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="2b175-198">For example, if a client application connects directly to a instance of SQL Server port and connects to a target database hosted in an availability group, and the target database is in primary state and online, then connectivity will succeed.</span></span>  <span data-ttu-id="2b175-199">Se il database di destinazione è offline o si trova in uno stato transizionale, la connettività al database ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="2b175-199">If the target database is offline or in a transitional state, connectivity to the database will fail.</span></span>  
  
 <span data-ttu-id="2b175-200">In alternativa, durante la migrazione dal mirroring del database a [!INCLUDE[ssHADR](../includes/sshadr-md.md)], le applicazioni possono specificare la stringa di connessione per il mirroring del database purché esista una sola replica secondaria e non siano consentite le connessioni utente.</span><span class="sxs-lookup"><span data-stu-id="2b175-200">Alternatively, while migrating from database mirroring to [!INCLUDE[ssHADR](../includes/sshadr-md.md)], applications can specify the database mirroring connection string as long as only one secondary replica exists and it disallows user connections.</span></span> <span data-ttu-id="2b175-201">Per altre informazioni, vedere [Uso delle stringhe di connessione per il mirroring del database con gruppi di disponibilità](#DbmConnectionString)più avanti in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="2b175-201">For more information, see [Using Database-Mirroring Connection Strings with Availability Groups](#DbmConnectionString), later in this section.</span></span>  
  
###  <a name="using-database-mirroring-connection-strings-with-availability-groups"></a><a name="DbmConnectionString"></a><span data-ttu-id="2b175-202">Uso di stringhe di connessione per il mirroring del database con gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-202">Using Database-Mirroring Connection Strings with Availability Groups</span></span>  
 <span data-ttu-id="2b175-203">Se un gruppo di disponibilità include solo una replica di disponibilità e non è configurato per consentire l'accesso in lettura alla replica secondaria, i client possono connettersi alla replica primaria tramite una stringa di connessione per il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="2b175-203">If an availability group possesses only one secondary replica and is not configured to allow read-access to the secondary replica, clients can connect to the primary replica by using a database mirroring connection string.</span></span> <span data-ttu-id="2b175-204">Questo approccio può essere utile durante la migrazione di un'applicazione esistente dal mirroring del database a un gruppo di disponibilità, a condizione che il gruppo di disponibilità sia limitato a due repliche di disponibilità (una replica primaria e una replica secondaria).</span><span class="sxs-lookup"><span data-stu-id="2b175-204">This approach can be useful while migrating an existing application from database mirroring to an availability group, as long as you limit the availability group to two availability replicas (a primary replica and one secondary replica).</span></span> <span data-ttu-id="2b175-205">Se si aggiungono altre repliche di disponibilità, è necessario creare un listener per il gruppo di disponibilità e aggiornare le applicazioni affinché utilizzino il nome DNS del listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-205">If you add additional secondary replicas, you will need to create an availability group listener for the availability group and update your applications to use the availability group listener DNS name.</span></span>  
  
 <span data-ttu-id="2b175-206">Quando si utilizzano le stringhe di connessione per il mirroring del database, il client può utilizzare [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client o il provider di dati .NET Framework per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2b175-206">When using database mirroring connection strings, the client can use either [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client or .NET Framework Data Provider for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2b175-207">La stringa di connessione fornita da un client deve specificare almeno il nome di un'istanza del server, ovvero il *nome del partner iniziale*, per identificare l'istanza del server che ospita inizialmente la replica di disponibilità alla quale si desidera connettersi.</span><span class="sxs-lookup"><span data-stu-id="2b175-207">The connection string provided by a client must minimally supply the name of one server instance, the *initial partner name*, to identify the server instance that initially hosts the availability replica to which you intend to connect.</span></span> <span data-ttu-id="2b175-208">Facoltativamente, la stringa di connessione può fornire anche il nome di un'altra istanza del server, il *nome del partner di failover*, per identificare l'istanza del server che ospita inizialmente la replica secondaria come nome del partner di failover.</span><span class="sxs-lookup"><span data-stu-id="2b175-208">Optionally, the connection string can also supply the name of another server instance, the *failover partner name*, to identify the server instance that initially hosts the secondary replica as the failover partner name.</span></span>  
  
 <span data-ttu-id="2b175-209">Per altre informazioni sulle stringhe di connessione per il mirroring del database, vedere [Connettere client a una sessione di mirroring del database &#40;SQL Server&#41;](database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="2b175-209">For more information about database mirroring connection strings, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
##  <a name="behavior-of-client-connections-on-failover"></a><a name="CCBehaviorOnFailover"></a><span data-ttu-id="2b175-210">Comportamento delle connessioni client al failover</span><span class="sxs-lookup"><span data-stu-id="2b175-210">Behavior of Client Connections on Failover</span></span>  
 <span data-ttu-id="2b175-211">Quando si verifica un failover del gruppo di disponibilità, le connessioni persistenti esistenti al gruppo di disponibilità vengono terminate e il client deve stabilire una nuova connessione per poter continuare a utilizzare lo stesso database primario o il database secondario in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2b175-211">When an availability group failover occurs, existing persistent connections to the availability group are terminated and the client must establish a new connection in order to continue working with the same primary database or read-only secondary database.</span></span>  <span data-ttu-id="2b175-212">Nel corso di un failover sul lato server, la connettività al gruppo di disponibilità potrebbe non essere disponibile, di conseguenza l'applicazione client potrebbe tentare di riconnettersi finché il database primario non viene riportato online.</span><span class="sxs-lookup"><span data-stu-id="2b175-212">While a failover is occurring on the server side, connectivity to the availability group may fail, forcing the client application to retry connecting until the primary is brought fully back online.</span></span>  
  
 <span data-ttu-id="2b175-213">Se il gruppo di disponibilità viene riportato online durante un tentativo di connessione dell'applicazione client, ma prima del periodo di timeout della connessione, è possibile che il driver client si connetta correttamente durante uno di questi tentativi interni senza che si verifichi alcun errore.</span><span class="sxs-lookup"><span data-stu-id="2b175-213">If the availability group comes back online during a client application's connection attempt but before the connect timeout period, the client driver may successfully connect during one of its internal retry attempts and no error will be surfaced to the application in this case.</span></span>  
  
##  <a name="supporting-availability-group-multi-subnet-failovers"></a><a name="SupportAgMultiSubnetFailover"></a> <span data-ttu-id="2b175-214">Supporto del failover su più subnet del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="2b175-214">Supporting Availability Group Multi-Subnet Failovers</span></span>  
 <span data-ttu-id="2b175-215">Se si usano librerie client che supportano l'opzione di connessione MultiSubnetFailover nella stringa di connessione, è possibile ottimizzare il failover del gruppo di disponibilità su un'altra subnet impostando MultiSubnetFailover su "True" o "Yes", a seconda della sintassi del provider in uso.</span><span class="sxs-lookup"><span data-stu-id="2b175-215">If you are using client libraries that support the MultiSubnetFailover connection option in the connection string, you can optimize availability group failover to a different subnet by setting MultiSubnetFailover to "True" or "Yes", depending on the syntax of the provider you are using.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2b175-216">È consigliabile utilizzare questa impostazione per le connessioni con una o più subnet a listener di gruppi di disponibilità e a istanze del cluster di failover di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2b175-216">We recommend this setting for both single and multi-subnet connections to availability groups listeners and to SQL Server Failover Cluster Instance names.</span></span>  <span data-ttu-id="2b175-217">Abilitando questa opzione si aggiungono ulteriori ottimizzazioni, anche per scenari con una sola subnet.</span><span class="sxs-lookup"><span data-stu-id="2b175-217">Enabling this option adds additional optimizations, even for single-subnet scenarios.</span></span>  
  
 <span data-ttu-id="2b175-218">L'opzione di connessione `MultiSubnetFailover` funziona unicamente con il protocollo di rete TCP ed è supportata solo in caso di connessione a un listener del gruppo di disponibilità e per qualsiasi nome di rete virtuale che si connette a [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2b175-218">The `MultiSubnetFailover` connection option only works with the TCP network protocol and is only supported when connecting to an availability group listener and for any virtual network name connecting to [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="2b175-219">Di seguito è riportato un esempio di una stringa di connessione per il provider ADO.NET (System.Data.SqlClient) che consente il failover su più subnet.</span><span class="sxs-lookup"><span data-stu-id="2b175-219">An example of a for the ADO.NET provider (System.Data.SqlClient) connection string that enables multi-subnet failover is as follows:</span></span>  
  
```  
Server=tcp:AGListener,1433;Database=AdventureWorks;IntegratedSecurity=SSPI; MultiSubnetFailover=True  
```  
  
 <span data-ttu-id="2b175-220">L'opzione di connessione `MultiSubnetFailover` deve essere impostata su `True` anche se il gruppo di disponibilità si estende su una sola subnet.</span><span class="sxs-lookup"><span data-stu-id="2b175-220">The `MultiSubnetFailover` connection option should be set to `True` even if the availability group only spans a single subnet.</span></span>  <span data-ttu-id="2b175-221">In questo modo è possibile preconfigurare nuovi client affinché supportino l'espansione futura su più subnet senza necessità di modificare la stringa di connessione client, oltre a ottimizzare le prestazioni dei failover su una sola subnet.</span><span class="sxs-lookup"><span data-stu-id="2b175-221">This allows you to preconfigure new clients to support future spanning of subnets without any need for future client connection string changes and also optimizes failover performance for single subnet failovers.</span></span>  <span data-ttu-id="2b175-222">Sebbene l'opzione di connessione `MultiSubnetFailover` non sia obbligatoria, accelera il failover su subnet.</span><span class="sxs-lookup"><span data-stu-id="2b175-222">While the `MultiSubnetFailover` connection option is not required, it does provide the benefit of a faster subnet failover.</span></span>  <span data-ttu-id="2b175-223">Il driver client tenta infatti di aprire un socket TCP per ogni indirizzo IP in parallelo associato al gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-223">This is because the client driver will attempt to open up a TCP socket for each IP address in parallel associated with the availability group.</span></span>  <span data-ttu-id="2b175-224">Il driver client attende che il primo indirizzo IP risponda, quindi utilizza tale risposta per la connessione.</span><span class="sxs-lookup"><span data-stu-id="2b175-224">The client driver will wait for the first IP to respond with success and once it does, will then use it for the connection.</span></span>  
  
##  <a name="availability-group-listeners-and-ssl-certificates"></a><a name="SSLcertificates"></a> <span data-ttu-id="2b175-225">Listener del gruppo di disponibilità e certificati SSL</span><span class="sxs-lookup"><span data-stu-id="2b175-225">Availability Group Listeners and SSL Certificates</span></span>  
 <span data-ttu-id="2b175-226">Quando ci si connette a un listener del gruppo di disponibilità, se le istanze di SQL Server utilizzano i certificati SSL insieme alla crittografia della sessione, il driver client che tenta la connessione deve supportare il Nome soggetto alternativo nel certificato SSL per forzare la crittografia.</span><span class="sxs-lookup"><span data-stu-id="2b175-226">When connecting to an availability group listener, if the participating instances of SQL Server use SSL certificates in conjunction with session encryption, the connecting client driver will need to support the Subject Alternate Name in the SSL certificate in order to force encryption.</span></span>  <span data-ttu-id="2b175-227">Il supporto del driver SQL Server per il Nome soggetto alternativo del certificato è pianificato per ADO.NET (SqlClient), Microsoft JDBC e SQL Native Client (SNAC).</span><span class="sxs-lookup"><span data-stu-id="2b175-227">SQL Server driver support for certificate Subject Alternative Name is planned for ADO.NET (SqlClient), Microsoft JDBC and SQL Native Client (SNAC).</span></span>  
  
 <span data-ttu-id="2b175-228">È necessario configurare un certificato X.509 per ogni nodo server che partecipa nel cluster di failover con un elenco di tutti i listener dei gruppi di disponibilità impostati nel Nome soggetto alternativo del certificato.</span><span class="sxs-lookup"><span data-stu-id="2b175-228">A X.509 certificate must be configured for each participating server node in the failover cluster with a list of all availability group listeners set in the Subject Alternate Name of the certificate.</span></span>  
  
 <span data-ttu-id="2b175-229">Ad esempio, se il cluster WSFC dispone di tre listener con i nomi `AG1_listener.Adventure-Works.com`, `AG2_listener.Adventure-Works.com`e `AG3_listener.Adventure-Works.com`, il Nome soggetto alternativo per il certificato deve essere impostato nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="2b175-229">For example, if the WSFC has three availability group listeners with the names `AG1_listener.Adventure-Works.com`, `AG2_listener.Adventure-Works.com`, and `AG3_listener.Adventure-Works.com`, the Subject Alternative Name for the certificate should be set as follows:</span></span>  
  
```  
CN = ServerFQDN  
SAN = ServerFQDN,AG1_listener.Adventure-Works.com, AG2_listener.Adventure-Works.com, AG3_listener.Adventure-Works.com  
```  
  
##  <a name="availability-group-listeners-and-server-principal-names-spns"></a><a name="SPNs"></a><span data-ttu-id="2b175-230">Listener del gruppo di disponibilità e nomi dell'entità server (SPN)</span><span class="sxs-lookup"><span data-stu-id="2b175-230">Availability Group Listeners and Server Principal Names (SPNs)</span></span>  
 <span data-ttu-id="2b175-231">Un amministratore di dominio deve configurare un nome entità server (SPN) in Active Directory per ogni nome di listener del gruppo di disponibilità per abilitare Kerberos per la connessione client al listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-231">A Server Principal Name (SPN) must be configured in Active Directory by a domain administrator for each availability group listener name in order to enable Kerberos for the client connection to the availability group listener.</span></span> <span data-ttu-id="2b175-232">Per registrare il nome SPN, è necessario usare l'account del servizio dell'istanza del server che ospita la replica di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-232">When registering the SPN, you must use the service account of the server instance that hosts the availability replica .</span></span>  <span data-ttu-id="2b175-233">Per fare in modo che il nome SPN funzioni su tutte le repliche, è necessario riutilizzare lo stesso account del servizio per tutte le istanze nel cluster WSFC che ospita il gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="2b175-233">For the SPN to work across all replicas, the same service account must be used for all instances in the WSFC cluster that hosts the availability group.</span></span>  
  
 <span data-ttu-id="2b175-234">Utilizzare lo strumento della riga di comando di Windows `setspn` per configurare il nome SPN.</span><span class="sxs-lookup"><span data-stu-id="2b175-234">Use the `setspn` Windows command line tool to configure the SPN.</span></span>  <span data-ttu-id="2b175-235">Ad esempio, per configurare un nome SPNr per un gruppo di disponibilità denominato `AG1listener.Adventure-Works.com` ospitato in un set di istanze di SQL Server configurate per essere eseguite nell'account di dominio `corp/svclogin2`:</span><span class="sxs-lookup"><span data-stu-id="2b175-235">For example to configure an SPN for an availability group named `AG1listener.Adventure-Works.com` hosted on a set of instances of SQL Server all configured to run under the domain account `corp/svclogin2`:</span></span>  
  
```cmd
setspn -A MSSQLSvc/AG1listener.Adventure-Works.com:1433 corp/svclogin2  
```  
  
 <span data-ttu-id="2b175-236">Per ulteriori informazioni sulla registrazione manuale di un nome SPN per SQL Server, vedere [Registrazione di un nome dell'entità servizio per le connessioni Kerberos](configure-windows/register-a-service-principal-name-for-kerberos-connections.md).</span><span class="sxs-lookup"><span data-stu-id="2b175-236">For more information about manual registration of a SPN for SQL Server, see [Register a Service Principal Name for Kerberos Connections](configure-windows/register-a-service-principal-name-for-kerberos-connections.md).</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="2b175-237">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="2b175-237">Related Tasks</span></span>  
  
-   [<span data-ttu-id="2b175-238">Connettività client AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-238">AlwaysOn Client Connectivity &#40;SQL Server&#41;</span></span>](availability-groups/windows/always-on-client-connectivity-sql-server.md)
  
-   [<span data-ttu-id="2b175-239">Creare o configurare un listener del gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-239">Create or Configure an Availability Group Listener &#40;SQL Server&#41;</span></span>](availability-groups/windows/create-or-configure-an-availability-group-listener-sql-server.md)  
  
-   [<span data-ttu-id="2b175-240">Visualizzare le proprietà del listener del gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-240">View Availability Group Listener Properties &#40;SQL Server&#41;</span></span>](availability-groups/windows/view-availability-group-listener-properties-sql-server.md)  
  
-   [<span data-ttu-id="2b175-241">Rimuovere un listener del gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-241">Remove an Availability Group Listener &#40;SQL Server&#41;</span></span>](availability-groups/windows/remove-an-availability-group-listener-sql-server.md)  
  
-   [<span data-ttu-id="2b175-242">Configurare l'accesso in sola lettura in una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-242">Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;</span></span>](availability-groups/windows/configure-read-only-access-on-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="2b175-243">Configurare il routing di sola lettura per un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-243">Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;</span></span>](availability-groups/windows/configure-read-only-routing-for-an-availability-group-sql-server.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="2b175-244">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="2b175-244">Related Content</span></span>  
  
-   [<span data-ttu-id="2b175-245">Pagina relativa alla guida alle soluzioni AlwaysOn di Microsoft SQL Server per la disponibilità elevata e il ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="2b175-245">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   <span data-ttu-id="2b175-246">[Introduzione al listener del gruppo di disponibilità](https://blogs.msdn.com/b/sqlalwayson/archive/2012/01/16/introduction-to-the-availability-group-listener.aspx) (blog del team di SQL Server AlwaysOn)</span><span class="sxs-lookup"><span data-stu-id="2b175-246">[Introduction to the Availability Group Listener](https://blogs.msdn.com/b/sqlalwayson/archive/2012/01/16/introduction-to-the-availability-group-listener.aspx) (a SQL Server AlwaysOn team blog)</span></span>  
  
-   [<span data-ttu-id="2b175-247">Blog del team di SQL Server AlwaysOn: Blog del team ufficiale di SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="2b175-247">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="2b175-248">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2b175-248">See Also</span></span>  
 <span data-ttu-id="2b175-249">[Panoramica di Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2b175-249">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 [<span data-ttu-id="2b175-250">Connettività client AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-250">AlwaysOn Client Connectivity &#40;SQL Server&#41;</span></span>](availability-groups/windows/always-on-client-connectivity-sql-server.md)  
 <span data-ttu-id="2b175-251">[Informazioni sull'accesso alla connessione client per le repliche di disponibilità &#40;SQL Server&#41;](availability-groups/windows/about-client-connection-access-to-availability-replicas-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2b175-251">[About Client Connection Access to Availability Replicas &#40;SQL Server&#41;](availability-groups/windows/about-client-connection-access-to-availability-replicas-sql-server.md) </span></span>  
 <span data-ttu-id="2b175-252">[Repliche secondarie attive: repliche secondarie leggibili &#40;Gruppi di disponibilità AlwaysOn&#41;](availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="2b175-252">[Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span></span>  
 [<span data-ttu-id="2b175-253">Connettere client a una sessione di mirroring del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2b175-253">Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;</span></span>](database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md)
