---
title: Mirroring del database e istanze del cluster di failover di SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- failover clustering [SQL Server], database mirroring
- database mirroring [SQL Server], failover
- high-availability mode [SQL Server]
ms.assetid: f1dd6a79-698b-4e31-b923-6bfc3ea0b617
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 378f834b4482f44f6a84abf419f027b353c7771a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721735"
---
# <a name="database-mirroring-and-sql-server-failover-cluster-instances"></a><span data-ttu-id="c4631-102">Mirroring del database e istanze del cluster di failover di SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c4631-102">Database Mirroring and SQL Server Failover Cluster Instances</span></span>
  <span data-ttu-id="c4631-103">Per cluster di failover si intende una combinazione di uno o più dischi fisici inclusi in un gruppo cluster di [!INCLUDE[msCoName](../../includes/msconame-md.md)] Cluster Services (MSCS), noto come gruppo di risorse, che partecipano ai nodi del cluster.</span><span class="sxs-lookup"><span data-stu-id="c4631-103">A failover cluster is a combination of one or more physical disks in a [!INCLUDE[msCoName](../../includes/msconame-md.md)] Cluster Service (MSCS) cluster group, known as a resource group, that are participating nodes of the cluster.</span></span> <span data-ttu-id="c4631-104">Il gruppo di risorse viene configurato come istanza cluster di failover che ospita un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c4631-104">The resource group is configured as a failover clustered instance that hosts an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c4631-105">Un'istanza cluster di failover di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] viene visualizzata nella rete come singolo computer, ma include funzionalità che consentono il failover tra nodi nel caso in cui un nodo non sia più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c4631-105">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover clustered instance appears on the network as if it were a single computer, but has functionality that provides failover from one node to another if one node becomes unavailable.</span></span> <span data-ttu-id="c4631-106">Per altre informazioni, vedere [Istanze del cluster di failover Always On (SQL Server)](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c4631-106">For more information, see [AlwaysOn Failover Cluster Instances (SQL Server)](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span></span>  
  
 <span data-ttu-id="c4631-107">I cluster di failover offrono un supporto a disponibilità elevata per un'intera istanza di [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], mentre il mirroring del database offre un supporto a disponibilità elevata per un database singolo.</span><span class="sxs-lookup"><span data-stu-id="c4631-107">Failover clusters provide high-availability support for an entire [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance, in contrast to database mirroring, which provides high-availability support for a single database.</span></span> <span data-ttu-id="c4631-108">Il mirroring del database viene utilizzato tra cluster di failover, nonché tra un cluster di failover e un host non cluster.</span><span class="sxs-lookup"><span data-stu-id="c4631-108">Database mirroring works between failover clusters and, also, between a failover cluster and a nonclustered host.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c4631-109">Per un'introduzione al mirroring del database, vedere [Mirroring del database &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c4631-109">For an introduction to database mirroring, see [Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span></span>  
  
## <a name="mirroring-and-clustering"></a><span data-ttu-id="c4631-110">Mirroring e clustering</span><span class="sxs-lookup"><span data-stu-id="c4631-110">Mirroring and Clustering</span></span>  
 <span data-ttu-id="c4631-111">In genere, quando il mirroring viene utilizzato in combinazione con il clustering, il server principale e il server mirror risiedono entrambi nei cluster. Il server principale viene eseguito nell'istanza cluster di failover di un cluster mentre il server mirror viene eseguito nell'istanza cluster di failover di un cluster diverso.</span><span class="sxs-lookup"><span data-stu-id="c4631-111">Typically, when mirroring is used with clustering, the principal server and mirror server both reside on clusters, with the principal server running on the failover clustered instance of one cluster and the mirror server running on the failover clustered instance of a different cluster.</span></span> <span data-ttu-id="c4631-112">È tuttavia possibile stabilire una sessione di mirroring in cui un partner risiede nell'istanza cluster di failover di un cluster e l'altro partner risiede in un computer non cluster separato.</span><span class="sxs-lookup"><span data-stu-id="c4631-112">You can establish a mirroring session in which one partner resides on the failover clustered instance of a cluster and the other partner resides on a separate, unclustered computer, however.</span></span>  
  
 <span data-ttu-id="c4631-113">Se il server principale non è temporaneamente disponibile a causa del failover di un cluster, i client vengono disconnessi dal database.</span><span class="sxs-lookup"><span data-stu-id="c4631-113">If a cluster failover makes a principal server temporarily unavailable, client connections are disconnected from the database.</span></span> <span data-ttu-id="c4631-114">Al termine del failover di un cluster, è possibile riconnettere i client al server principale nello stesso cluster, in un cluster diverso o in un computer non cluster, a seconda della [modalità operativa](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="c4631-114">After the cluster failover completes, clients can reconnect to the principal server on the same cluster, or on a different cluster or an unclustered computer, depending on the [operating mode](database-mirroring-operating-modes.md).</span></span> <span data-ttu-id="c4631-115">Pertanto, quando si sceglie la configurazione per il mirroring del database in un ambiente cluster, la modalità operativa utilizzata per il mirroring riveste notevole importanza.</span><span class="sxs-lookup"><span data-stu-id="c4631-115">Therefore, when deciding how to configure database mirroring in a clustered environment, the operating mode you use for mirroring is significant.</span></span>  
  
### <a name="high-safety-mode-session-with-automatic-failover"></a><span data-ttu-id="c4631-116">Sessione in modalità a sicurezza elevata con failover automatico</span><span class="sxs-lookup"><span data-stu-id="c4631-116">High-Safety mode Session with Automatic Failover</span></span>  
 <span data-ttu-id="c4631-117">Se si desidera eseguire il mirroring di un database in modalità a sicurezza elevata con failover automatico, per i partner è consigliabile una configurazione a due cluster.</span><span class="sxs-lookup"><span data-stu-id="c4631-117">If you intend to mirror a database in high-safety mode with automatic failover, a two-cluster configuration is recommended for the partners.</span></span> <span data-ttu-id="c4631-118">Questa configurazione consente di ottenere la disponibilità massima.</span><span class="sxs-lookup"><span data-stu-id="c4631-118">This configuration provides maximum availability.</span></span> <span data-ttu-id="c4631-119">Il server di controllo del mirroring può risiedere in un terzo cluster o in un computer non cluster.</span><span class="sxs-lookup"><span data-stu-id="c4631-119">The witness can reside either on a third cluster or on an unclustered computer.</span></span>  
  
 <span data-ttu-id="c4631-120">Se si verifica un problema nel nodo in cui è in esecuzione il server principale corrente, entro alcuni secondi viene avviato il failover automatico del database, mentre è ancora in corso il failover del cluster a un altro nodo.</span><span class="sxs-lookup"><span data-stu-id="c4631-120">If the node running the current principal server fails, automatic failover of the database begins within a few seconds, while the cluster is still failing over to another node.</span></span> <span data-ttu-id="c4631-121">Viene eseguito il failover della sessione di mirroring del database al server mirror nell'altro cluster o nel computer non cluster, mentre il server mirror precedente diventa il server principale.</span><span class="sxs-lookup"><span data-stu-id="c4631-121">The database mirroring session fails over to the mirror server on the other cluster or unclustered computer, and the former mirror server becomes the principal server.</span></span> <span data-ttu-id="c4631-122">Il nuovo server principale esegue il rollforward della rispettiva copia del database nel modo più rapido possibile e la porta online come database principale.</span><span class="sxs-lookup"><span data-stu-id="c4631-122">The new principal server rolls forward its copy of the database as quickly as possible and brings it online as the principal database.</span></span> <span data-ttu-id="c4631-123">Al termine del failover del cluster, che in genere richiede diversi minuti, l'istanza cluster di failover che in precedenza svolgeva la funzione di server principale diventa il server mirror.</span><span class="sxs-lookup"><span data-stu-id="c4631-123">After the cluster failover completes, which typically takes several minutes, the failover clustered instance that was formerly the principal server becomes the mirror server.</span></span>  
  
 <span data-ttu-id="c4631-124">Nella figura seguente viene illustrato un failover automatico tra cluster in una sessione di mirroring in esecuzione in modalità a sicurezza elevata con un server di controllo del mirroring, che supporta il failover automatico.</span><span class="sxs-lookup"><span data-stu-id="c4631-124">The following illustration shows an automatic failover between clusters in a mirroring session running in high-safety mode with a witness (which supports automatic failover).</span></span>  
  
 <span data-ttu-id="c4631-125">![Failover su un cluster](../media/dbm-and-failover-clustering.gif "Failover su un cluster")</span><span class="sxs-lookup"><span data-stu-id="c4631-125">![A failover on a cluster](../media/dbm-and-failover-clustering.gif "A failover on a cluster")</span></span>  
  
 <span data-ttu-id="c4631-126">Le tre istanze del server nella sessione di mirroring risiedono in tre cluster distinti: **Cluster_A**, **Cluster_B** e **Cluster_C**.</span><span class="sxs-lookup"><span data-stu-id="c4631-126">The three server instances in the mirroring session reside on three distinct clusters: **Cluster_A**, **Cluster_B**, and **Cluster_C**.</span></span> <span data-ttu-id="c4631-127">In ogni cluster è in esecuzione un'istanza predefinita di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] come istanza cluster di failover di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c4631-127">On each cluster, a default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover clustered instance.</span></span> <span data-ttu-id="c4631-128">All'avvio della sessione di mirroring, l'istanza cluster di failover in **Cluster_A** è il server principale, l'istanza cluster di failover in **Cluster_B** è il server mirror e l'istanza cluster di failover in **Cluster_C** è il server di controllo del mirroring nella sessione.</span><span class="sxs-lookup"><span data-stu-id="c4631-128">When the mirroring session starts, the failover clustered instance on **Cluster_A** is the principal server, the failover clustered instance on **Cluster_B** is the mirror server, and the failover clustered instance on **Cluster_C** is the witness in the mirroring session.</span></span> <span data-ttu-id="c4631-129">Nella fase finale, si verifica un problema nel nodo attivo del **Cluster_A** e, di conseguenza, il server principale non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c4631-129">Eventually, the active node on **Cluster_A** fails, which causes the principal server to become unavailable.</span></span>  
  
 <span data-ttu-id="c4631-130">Prima che si verifichi il failover del cluster, il server mirror, con la collaborazione del server di controllo del mirroring, rileva la perdita del server principale.</span><span class="sxs-lookup"><span data-stu-id="c4631-130">Before the cluster has time to fail over, the loss of the principal server is detected by the mirror server, with the help of the witness.</span></span> <span data-ttu-id="c4631-131">Il server mirror esegue il rollforward del rispettivo database, portandolo online come nuovo database principale nel più breve tempo possibile.</span><span class="sxs-lookup"><span data-stu-id="c4631-131">The mirror server rolls forward its database and brings it online as the new principal database as quickly as possible.</span></span> <span data-ttu-id="c4631-132">Al termine del failover nel **Cluster_A** , il server principale precedente è diventato il server mirror, che sincronizza il rispettivo database con il database principale corrente del **Cluster_B**.</span><span class="sxs-lookup"><span data-stu-id="c4631-132">When **Cluster_A** finishes failing over, the former principal server is now the mirror server, and it synchronizes its database with the current principal database on **Cluster_B**.</span></span>  
  
### <a name="high-safety-mode-session-without-automatic-failover"></a><span data-ttu-id="c4631-133">Sessione in modalità a sicurezza elevata senza failover automatico</span><span class="sxs-lookup"><span data-stu-id="c4631-133">High-Safety Mode Session Without Automatic Failover</span></span>  
 <span data-ttu-id="c4631-134">Se si esegue il mirroring di un database in modalità a sicurezza elevata senza failover automatico, un altro nodo del cluster assumerà il ruolo di server principale se nel nodo in cui è eseguito il server principale corrente si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="c4631-134">If you are mirroring a database in high-safety mode without automatic failover, another node in the cluster will act as the principal server if the node running the current principal server fails.</span></span> <span data-ttu-id="c4631-135">Si noti che, quando il cluster non è disponibile, non è disponibile nemmeno il database.</span><span class="sxs-lookup"><span data-stu-id="c4631-135">Note that while the cluster is unavailable, the database is unavailable.</span></span>  
  
### <a name="high-performance-mode-session"></a><span data-ttu-id="c4631-136">Sessione in modalità a prestazioni elevate</span><span class="sxs-lookup"><span data-stu-id="c4631-136">High-Performance Mode Session</span></span>  
 <span data-ttu-id="c4631-137">Se si desidera eseguire il mirroring di un database in modalità a prestazioni elevate, è consigliabile posizionare il server principale nell'istanza cluster di failover di un cluster e il server mirror in un server non cluster in una posizione remota.</span><span class="sxs-lookup"><span data-stu-id="c4631-137">If you intend to mirror a database in high-performance mode, consider placing the principal server on the failover clustered instance of a cluster and placing the mirror server on an unclustered server in a remote location.</span></span> <span data-ttu-id="c4631-138">Se viene eseguito il failover del cluster su un nodo diverso, l'istanza cluster di failover continuerà a svolgere la funzione di server principale nella sessione di mirroring.</span><span class="sxs-lookup"><span data-stu-id="c4631-138">If the cluster fails over to a different node, the failover clustered instance will continue as the principal server in the mirroring session.</span></span> <span data-ttu-id="c4631-139">Se si verificano problemi nell'intero cluster, è possibile forzare il servizio nel server mirror.</span><span class="sxs-lookup"><span data-stu-id="c4631-139">If the entire cluster has problems, you can force service onto the mirror server.</span></span>  
  
 <span data-ttu-id="c4631-140">**Per impostare un nuovo cluster di failover di SQL Server**</span><span class="sxs-lookup"><span data-stu-id="c4631-140">**To set up a new SQL Server failover cluster**</span></span>  
  
-   [<span data-ttu-id="c4631-141">Creare un nuovo cluster di failover di SQL Server &#40;programma di installazione&#41;</span><span class="sxs-lookup"><span data-stu-id="c4631-141">Create a New SQL Server Failover Cluster &#40;Setup&#41;</span></span>](../../sql-server/failover-clusters/install/create-a-new-sql-server-failover-cluster-setup.md)  
  
 <span data-ttu-id="c4631-142">**Per impostare il mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="c4631-142">**To set up database mirroring**</span></span>  
  
-   [<span data-ttu-id="c4631-143">Impostazione del mirroring del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="c4631-143">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="c4631-144">Stabilire una sessione di mirroring del database tramite autenticazione di Windows &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="c4631-144">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="c4631-145">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="c4631-145">See Also</span></span>  
 <span data-ttu-id="c4631-146">[Mirroring del database &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="c4631-146">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 <span data-ttu-id="c4631-147">[Modalità di funzionamento del mirroring del database](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="c4631-147">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="c4631-148">Istanze del cluster di failover AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="c4631-148">AlwaysOn Failover Cluster Instances (SQL Server)</span></span>](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md) 
  
  
