---
title: Cambio di ruolo durante una sessione di mirroring del database (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87716748"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="e3bdc-102">Cambio di ruolo durante una sessione di mirroring del database (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e3bdc-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="e3bdc-103">Nel contesto di una sessione di mirroring del database, in genere i ruoli principale e mirror sono intercambiabili tramite un processo denominato *cambio di ruolo*.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="e3bdc-104">Nel cambio di ruolo, il server mirror funge da *partner di failover* per il server principale, assumendo il ruolo principale e recuperando la propria copia del database e portandola online come nuovo database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="e3bdc-105">Il server principale precedente, quando disponibile, assume il ruolo di mirror, e il suo database diventa il nuovo database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="e3bdc-106">Potenzialmente, i ruoli possono essere scambiati nei due sensi in seguito a più errori o per scopi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e3bdc-107">In questo argomento si parte dal presupposto che l'utente conosca le modalità operative per il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="e3bdc-108">Per altre informazioni, vedere [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="e3bdc-109">La figura seguente illustra i partner di mirroring, **Partner_A** e **Partner_B**, che eseguono lo scambio dei ruoli principale e mirror su una serie di failover automatici o manuali.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="e3bdc-110">![Due scambi di ruoli tra i partner](../media/dbm-roleswitching.gif "Due scambi di ruoli tra i partner")</span><span class="sxs-lookup"><span data-stu-id="e3bdc-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e3bdc-111">Dopo un cambio di ruolo, i processi eseguiti nel precedente database principale devono essere ricreati sul nuovo server principale affinché possano essere eseguiti nella nuova posizione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="e3bdc-112">Per altre informazioni, vedere [Gestione di account di accesso e di processi dopo un cambio di ruolo &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="e3bdc-113">Esistono tre forme di cambio di ruolo: failover automatico, failover manuale e servizio forzato (con possibile perdita di dati).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="e3bdc-114">Il supporto di ogni forma dipende dalla modalità operativa della sessione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e3bdc-115">Se non si ha familiarità con queste modalità operative, vedere [Modalità di funzionamento del mirroring del database](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="e3bdc-116">**Failover manuale**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="e3bdc-117">Con la modalità a sicurezza elevata è supportato il failover manuale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="e3bdc-118">A ogni sincronizzazione del database, il proprietario del database può avviare un failover manuale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="e3bdc-119">Il failover manuale è disponibile a scopo di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="e3bdc-120">Per altre informazioni, vedere [Failover manuale](#ManualFailover)più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="e3bdc-121">**Automatic failover**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="e3bdc-122">In presenza di un server di controllo del mirroring, con la modalità a sicurezza elevata è supportato il failover automatico.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="e3bdc-123">Il failover automatico si verifica solo in caso di perdita del server principale se il server di controllo del mirroring e il server mirror sono ancora connessi tra loro e il database è già sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="e3bdc-124">Per altre informazioni, vedere [Failover automatico](#AutomaticFailover)più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="e3bdc-125">**Servizio forzato (con possibile perdita di dati)**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="e3bdc-126">L'utilizzo forzato del servizio è supportato in modalità a sicurezza elevata quando nessun server di controllo del mirroring è impostato e in modalità a prestazioni elevate.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="e3bdc-127">Quando il server principale viene perso, il proprietario del database può rendere il database disponibile forzando il servizio per il server mirror (con possibile perdita di dati).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-128">È consigliabile impostare la proprietà WITNESS su OFF in modalità a prestazioni elevate.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="e3bdc-129">In caso contrario, per portare il database online, è necessario che il server mirror sia connesso al server di controllo del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="e3bdc-130">Per altre informazioni, vedere [Servizio forzato (con possibile perdita di dati)](#ForcedService)più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="e3bdc-131">Nella tabella seguente viene presentato un riepilogo delle forme di failover supportate in ognuna delle modalità operative.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="e3bdc-132">Prestazioni elevate</span><span class="sxs-lookup"><span data-stu-id="e3bdc-132">High performance</span></span>|<span data-ttu-id="e3bdc-133">Modalità a sicurezza elevata senza un server di controllo del mirroring</span><span class="sxs-lookup"><span data-stu-id="e3bdc-133">High-safety mode without a witness</span></span>|<span data-ttu-id="e3bdc-134">Modalità a sicurezza elevata con un server di controllo del mirroring</span><span class="sxs-lookup"><span data-stu-id="e3bdc-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="e3bdc-135">Failover automatico</span><span class="sxs-lookup"><span data-stu-id="e3bdc-135">Automatic failover</span></span>|<span data-ttu-id="e3bdc-136">No</span><span class="sxs-lookup"><span data-stu-id="e3bdc-136">No</span></span>|<span data-ttu-id="e3bdc-137">No</span><span class="sxs-lookup"><span data-stu-id="e3bdc-137">No</span></span>|<span data-ttu-id="e3bdc-138">Sì</span><span class="sxs-lookup"><span data-stu-id="e3bdc-138">Yes</span></span>|  
|<span data-ttu-id="e3bdc-139">Failover manuale</span><span class="sxs-lookup"><span data-stu-id="e3bdc-139">Manual failover</span></span>|<span data-ttu-id="e3bdc-140">No</span><span class="sxs-lookup"><span data-stu-id="e3bdc-140">No</span></span>|<span data-ttu-id="e3bdc-141">Sì</span><span class="sxs-lookup"><span data-stu-id="e3bdc-141">Yes</span></span>|<span data-ttu-id="e3bdc-142">Sì</span><span class="sxs-lookup"><span data-stu-id="e3bdc-142">Yes</span></span>|  
|<span data-ttu-id="e3bdc-143">Servizio forzato</span><span class="sxs-lookup"><span data-stu-id="e3bdc-143">Forced service</span></span>|<span data-ttu-id="e3bdc-144">Sì</span><span class="sxs-lookup"><span data-stu-id="e3bdc-144">Yes</span></span>|<span data-ttu-id="e3bdc-145">Sì</span><span class="sxs-lookup"><span data-stu-id="e3bdc-145">Yes</span></span>|<span data-ttu-id="e3bdc-146">No</span><span class="sxs-lookup"><span data-stu-id="e3bdc-146">No</span></span>|  
  
 <span data-ttu-id="e3bdc-147">Dopo un cambio di ruolo è necessario che alcuni metadati siano disponibili su entrambi i partner per garantire che tutti gli utenti del database possano accedere al nuovo database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="e3bdc-148">È inoltre necessario che i processi di backup vengano creati sul nuovo server principale per garantire che i backup del database continuino regolarmente in base alla pianificazione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="e3bdc-149">Per altre informazioni, vedere [Gestione di account di accesso e di processi dopo un cambio di ruolo &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="e3bdc-150">Durante un cambio di ruolo, il periodo di tempo durante il quale il mirroring del database non sarà disponibile dipende dal tipo e dalla causa del cambio di ruolo.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="e3bdc-151">Per altre informazioni, vedere [Stimare l'interruzione del servizio durante il cambio di ruolo &#40;mirroring del database&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="e3bdc-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="e3bdc-152">Manual Failover</span></span>  
 <span data-ttu-id="e3bdc-153">Il failover manuale disconnette i client dal database e inverte i ruoli dei partner.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="e3bdc-154">Solo la modalità a sicurezza elevata supporta il failover manuale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="e3bdc-155">Mantenimento della disponibilità durante gli aggiornamenti</span><span class="sxs-lookup"><span data-stu-id="e3bdc-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="e3bdc-156">L'amministratore del database può utilizzare il failover manuale per aggiornare l'hardware o il software senza ridurre la disponibilità.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="e3bdc-157">Per eseguire aggiornamenti del software mediante il mirroring del database, è necessario che il server mirror e/o il sistema ricevano precedentemente gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e3bdc-158">Il mirroring del database dovrebbe consentire l'esecuzione di un aggiornamento in sequenza. Questo non è tuttavia garantito poiché le modifiche future non sono ancora note.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="e3bdc-159">Per altre informazioni, vedere [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="e3bdc-160">Nella figura seguente è illustrato un esempio di utilizzo del failover manuale per mantenere la disponibilità del database mentre si aggiorna un'istanza del server di database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="e3bdc-161">Al termine dell'aggiornamento, un amministratore può eseguire facoltativamente il failover all'istanza del server originale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="e3bdc-162">Questa operazione è utile se l'amministratore desidera arrestare la sessione di mirroring e utilizzare il server mirror in un'altra posizione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="e3bdc-163">In questo modo, è possibile utilizzare ripetutamente una singola istanza del server per aggiornare una serie di istanze del server di database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="e3bdc-164">![Failover manuale pianificato](../media/dbm-failovmanuplanned.gif "Failover manuale pianificato")</span><span class="sxs-lookup"><span data-stu-id="e3bdc-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="e3bdc-165">Condizioni necessarie per un failover manuale</span><span class="sxs-lookup"><span data-stu-id="e3bdc-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="e3bdc-166">Per il failover manuale, è necessario che il livello di protezione delle transazioni sia impostato su FULL (ovvero in modalità a protezione elevata).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="e3bdc-167">Se i partner sono connessi e il database è già sincronizzato, è supportato il failover manuale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="e3bdc-168">Funzionamento del failover manuale</span><span class="sxs-lookup"><span data-stu-id="e3bdc-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="e3bdc-169">Il failover manuale inizia la sequenza di azioni seguente:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="e3bdc-170">Il server principale disconnette i client dal database principale, invia la parte finale del log al server mirror e, in vista del passaggio al ruolo di server mirror, imposta lo stato di mirroring su SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="e3bdc-171">Il server mirror registra il numero di sequenza del file di log (LSN) relativo all'ultimo record del log ricevuto dal server principale come LSN di failover.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-172">Per visualizzare questo LSN, selezionare la colonna **mirroring_failover_lsn** da [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="e3bdc-173">Se un log è in attesa nella coda di rollforward, il server mirror termina il rollforward del database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="e3bdc-174">La quantità di tempo necessaria varia in base alla velocità del sistema, al carico di lavoro recente e alle dimensioni del log nella coda di rollforward.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="e3bdc-175">Per la modalità operativa sincrona, è possibile regolare il tempo di failover limitando le dimensioni della coda di rollforward.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="e3bdc-176">Tale operazione, tuttavia, può causare un rallentamento del server principale a vantaggio della velocità del server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-177">Per visualizzare le dimensioni correnti della coda di rollforward, usare il contatore delle prestazioni **Redo Queue** (Coda di rollforward) nell'oggetto prestazioni del mirroring del database. Per altre informazioni, vedere [Monitoraggio del mirroring del database &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="e3bdc-178">Il server mirror diventa il nuovo server principale, mentre il server principale precedente diventa il nuovo server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="e3bdc-179">Il nuovo server principale esegue il rollback delle eventuali transazioni di cui non è stato eseguito il commit e porta online la copia interna del database come database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="e3bdc-180">Il server principale precedente assume il ruolo di server mirror e il database principale precedente diventa il database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="e3bdc-181">Il nuovo server mirror risincronizza rapidamente il nuovo database mirror con il nuovo database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-182">Nell'istante stesso in cui il nuovo server mirror ha ristabilito la sincronizzazione dei database, il failover è nuovamente possibile, stavolta nella direzione inversa.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="e3bdc-183">Dopo il failover, i client devono riconnettersi al database principale corrente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="e3bdc-184">Per ulteriori informazioni, vedere [Connettere client a una sessione di mirroring del database &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="e3bdc-185">**Per iniziare il failover manuale**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="e3bdc-186">Failover manuale di una sessione di mirroring del database &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="e3bdc-187">[Failover manuale in una sessione di mirroring del database &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="e3bdc-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="e3bdc-188">Automatic Failover</span></span>  
 <span data-ttu-id="e3bdc-189">Il failover automatico è supportato esclusivamente nelle sessioni di mirroring del database in esecuzione con un server di controllo del mirroring in modalità a protezione elevata (*modalità a protezione elevata con failover automatico*).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="e3bdc-190">In modalità a protezione elevata con failover automatico, dopo la sincronizzazione del database, se il database principale risulta non disponibile, si verifica un failover automatico.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="e3bdc-191">In seguito a questo processo, il server mirror assume il ruolo di server principale e attiva la modalità online per la propria copia del database come database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="e3bdc-192">La sincronizzazione del database impedisce la perdita di dati durante il failover, poiché per ogni transazione di cui è stato eseguito il commit nel database principale viene eseguito il commit anche nel database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e3bdc-193">Affinché il failover automatico garantisca una maggiore affidabilità, è necessario che il database mirror e principale si trovino in computer diversi.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="e3bdc-194">Condizioni necessarie per un failover automatico</span><span class="sxs-lookup"><span data-stu-id="e3bdc-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="e3bdc-195">Per l'esecuzione del failover automatico è necessario che si verifichino le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="e3bdc-196">La sessione di mirroring del database deve essere in esecuzione in modalità a protezione elevata e deve disporre di un server di controllo del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="e3bdc-197">Per altre informazioni, vedere [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="e3bdc-198">Il database mirror deve essere già stato sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="e3bdc-199">Questa condizione garantisce che il log inviato al server mirror sia stato interamente scritto su disco.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="e3bdc-200">Le comunicazioni tra il server principale e gli altri componenti della configurazione di mirroring del database sono state interrotte, mentre il server mirror e il server di controllo del mirroring mantengono il quorum.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="e3bdc-201">Tuttavia, se si interrompe la comunicazione tra tutte le istanze del server e in un momento successivo il server di controllo del mirroring e il server mirror tornano a comunicare, il failover automatico non si verifica.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-202">Per altre informazioni, vedere [Quorum: Impatto di un server di controllo del mirroring sulla disponibilità del database &#40;mirroring del database&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="e3bdc-203">Il server mirror ha rilevato la perdita del server principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="e3bdc-204">La modalità in base a cui il server mirror rileva un errore del server principale varia a seconda che si tratti di un errore hardware o software.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="e3bdc-205">Per altre informazioni, vedere [Possibili errori durante il mirroring del database](possible-failures-during-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="e3bdc-206">Funzionamento del failover automatico</span><span class="sxs-lookup"><span data-stu-id="e3bdc-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="e3bdc-207">Se le condizioni riportate sopra sono soddisfatte, il failover automatico avvia la sequenza di azioni seguente:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="e3bdc-208">Se il server principale è ancora in esecuzione, lo stato del database principale cambia in DISCONNECTED e tutti i client vengono disconnessi dal database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="e3bdc-209">Il server di controllo del mirroring e il server mirror rilevano che il server principale non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="e3bdc-210">Se un log è in attesa nella coda di rollforward, il server mirror termina il rollforward del database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-211">La quantità di tempo necessaria per applicare il log varia in base alla velocità del sistema, al carico di lavoro recente e alle dimensioni del log nella coda di rollforward.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="e3bdc-212">Viene attivata la modalità online per il database mirror precedente come nuovo database principale, mentre la procedura di recupero elimina tutte le transazioni di cui non è stato eseguito il commit eseguendone il rollback il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="e3bdc-213">Vengono utilizzati blocchi per isolare tali transazioni.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="e3bdc-214">Quando il server principale precedente partecipa nuovamente alla sessione, esso rileva che ora è il proprio partner di failover a detenere il ruolo di server principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="e3bdc-215">Il server principale precedente assume il ruolo di server mirror, rendendo la propria copia del database il nuovo database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="e3bdc-216">Il nuovo server mirror provvede il più rapidamente possibile a sincronizzare il nuovo database mirror con il database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="e3bdc-217">Nell'istante stesso in cui il nuovo server mirror ha ristabilito la sincronizzazione dei database, il failover è nuovamente possibile, stavolta nella direzione inversa.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="e3bdc-218">Nella figura seguente viene illustrata una singola istanza di failover automatico.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="e3bdc-219">![Automatic failover](../media/dbm-failovauto1round.gif "Failover automatico")</span><span class="sxs-lookup"><span data-stu-id="e3bdc-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="e3bdc-220">La sessione ha inizialmente un quorum completo, ovvero tutti e tre i server sono connessi.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="e3bdc-221">**Partner_A** è il server principale e **Partner_B** il server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="e3bdc-222">**Partner_A** , o il database principale del **Partner_A**, diventa non disponibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="e3bdc-223">Sia il server di controllo del mirroring che **Partner_B** rilevano che il server principale non è più disponibile e la sessione mantiene il quorum.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="e3bdc-224">**Partner_B** diviene il server principale e rende disponibile la propria copia del database come nuovo database principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="e3bdc-225">Quando si riconnette alla sessione, **Partner_A** individua che **Partner_B** detiene ora il ruolo di server principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="e3bdc-226">**Partner_A** assume quindi il ruolo di server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="e3bdc-227">Dopo il failover, i client devono riconnettersi al database principale corrente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="e3bdc-228">Per ulteriori informazioni, vedere [Connettere client a una sessione di mirroring del database &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e3bdc-229">Le transazioni che sono state preparate utilizzando [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator, ma di cui non è stato ancora eseguito il commit nel momento in cui si verifica un failover, vengono considerate interrotte dopo il failover del database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="e3bdc-230">Per disabilitare il failover automatico (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="e3bdc-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="e3bdc-231">Aprire la pagina **Proprietà database - Mirroring** e cambiare la modalità operativa selezionando una delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="e3bdc-232">**Protezione elevata senza failover automatico (sincrona)**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="e3bdc-233">In questa modalità il database continua a essere sincronizzato e il failover manuale rimane possibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="e3bdc-234">**Prestazioni elevate (asincrona)**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="e3bdc-235">In questa modalità il database mirror potrebbe avere un certo ritardo rispetto al database principale e il failover manuale non è più possibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="e3bdc-236">Per disabilitare il failover automatico (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="e3bdc-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="e3bdc-237">In un punto qualsiasi di una sessione di mirroring del database, il proprietario del database può disabilitare il failover automatico disabilitando il server di controllo del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="e3bdc-238">**Per disabilitare il server di controllo del mirroring**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="e3bdc-239">Rimuovere il server di controllo del mirroring da una sessione di mirroring del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="e3bdc-240">Se si disabilita il server di controllo del mirroring mentre resta attiva la protezione completa delle transazioni, la sessione passa in modalità a protezione elevata senza failover automatico.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="e3bdc-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="e3bdc-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="e3bdc-242">Il mirroring del database include l'utilizzo forzato del servizio (con possibile perdita di dati) come metodo di ripristino di emergenza per consentire l'utilizzo di un server mirror come server warm standby.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="e3bdc-243">Il servizio forzato è possibile solo se il server principale è disconnesso dal server mirror in una sessione di mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="e3bdc-244">Dato che l'utilizzo forzato del servizio determina il rischio di possibili perdite di dati, è consigliabile utilizzarlo con cautela e quando strettamente necessario.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="e3bdc-245">Il supporto per l'utilizzo forzato del servizio dipende dalla modalità operativa e dallo stato della sessione, come segue:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="e3bdc-246">In genere, la modalità a prestazioni elevate supporta l'utilizzo forzato del servizio ogniqualvolta il server principale è disconnesso.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="e3bdc-247">Sebbene non sia necessario, è tuttavia possibile che un server di controllo del mirroring sia presente per una sessione in modalità a prestazioni elevate.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="e3bdc-248">In questo caso, l'utilizzo forzato del servizio richiede che il server mirror e il server di controllo del mirroring siano connessi tra loro.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="e3bdc-249">La modalità a protezione elevata senza failover automatico supporta l'utilizzo forzato del servizio ogniqualvolta il server principale è disconnesso.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="e3bdc-250">La modalità a protezione elevata con failover automatico supporta l'utilizzo forzato del servizio ogniqualvolta il server mirror e il server di controllo del mirroring sono connessi tra loro e nessuno dei due è connesso al server principale, a condizione che sul server mirror non sia in corso il rollback del database mirror al momento dell'ultima connessione al server principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="e3bdc-251">È consigliabile forzare il servizio solo se è necessario ripristinare immediatamente il servizio sul database e si è disposti a rischiare la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="e3bdc-252">L'utilizzo forzato del servizio ha un effetto analogo alla rimozione del mirroring, ad eccezione del fatto che semplifica la risincronizzazione dei database quando il mirroring viene ripreso, con rischio di possibile perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="e3bdc-253">L'utilizzo forzato del servizio avvia una transizione uniforme del ruolo principale al database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="e3bdc-254">Il server mirror assume il ruolo di server principale e rende immediatamente disponibile la propria copia del database ai client.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="e3bdc-255">Il nuovo database principale viene eseguito senza un mirror, ovvero senza mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e3bdc-256">Se il server principale è stato semplicemente disconnesso dalla sessione di mirroring del database ed è ancora in esecuzione, è possibile che alcuni client continuino ad accedere al database principale originale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="e3bdc-257">Dopo aver forzato il servizio, è importante impedire ai client l'accesso al server principale originale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="e3bdc-258">In caso contrario, dopo l'utilizzo forzato del servizio, è possibile che il database principale originale e il database principale corrente vengano aggiornati in modo indipendente l'uno dall'altro.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="e3bdc-259">Caso tipico di utilizzo forzato del servizio</span><span class="sxs-lookup"><span data-stu-id="e3bdc-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="e3bdc-260">Nella figura seguente viene illustrato un caso tipico di utilizzo forzato del servizio (con possibile perdita di dati).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="e3bdc-261">![Forzatura del servizio con possibile perdita di dati](../media/dbm-forced-service.gif "Forzatura del servizio con possibile perdita di dati")</span><span class="sxs-lookup"><span data-stu-id="e3bdc-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="e3bdc-262">Come illustrato nella figura, il server principale originale, **Partner_A**, diventa non disponibile per il server mirror, **Partner_B**, causando la disconnessione del database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="e3bdc-263">Dopo aver verificato che **Partner_A** non è disponibile ai client, l'amministratore del database forza il servizio, con possibilità di perdita di dati, su **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="e3bdc-264">**Partner_B** diventa il server principale e viene eseguito con il database *esposto* , ovvero senza mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="e3bdc-265">A questo punto, i client possono riconnettersi a **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="e3bdc-266">Quando **Partner_A** diventa disponibile, riconnette il nuovo server principale, si riconnette alla sessione e assume il ruolo di mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="e3bdc-267">La sessione di mirroring viene sospesa immediatamente, senza sincronizzazione del nuovo database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="e3bdc-268">La sospensione della sessione consente all'amministratore del database di decidere se riprendere la sessione o, in casi estremi, rimuovere il mirroring e tentare di salvare i dati dal database principale precedente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="e3bdc-269">In questo caso, l'amministratore del database sceglie di riprendere il mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="e3bdc-270">A questo punto, **Partner_A** assume il ruolo di server mirror ed esegue il rollback del database principale originale dal momento dell'ultima transazione sincronizzata eseguita correttamente. Eventuali transazioni con commit che non siano state scritte sul disco del server mirror prima dell'utilizzo forzato del servizio vengono perdute.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="e3bdc-271">**Partner_A** esegue quindi il rollforward del nuovo database mirror applicando eventuali modifiche apportate al nuovo database principale dal momento in cui il server mirror precedente è diventato il nuovo server principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e3bdc-272">Sebbene la modalità a prestazioni elevate non ne richieda la presenza, se un server di controllo del mirroring è configurato, è possibile forzare il servizio solo se il server di controllo del mirroring è attualmente connesso al server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="e3bdc-273">Rischi correlati all'utilizzo forzato del servizio</span><span class="sxs-lookup"><span data-stu-id="e3bdc-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="e3bdc-274">È fondamentale comprendere che l'utilizzo forzato del servizio può causare la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="e3bdc-275">La perdita di dati è possibile in quanto il server mirror non è in grado di comunicare con il server principale e pertanto non può garantire che i due database siano sincronizzati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="e3bdc-276">L'utilizzo forzato del servizio comporta l'avvio di un nuovo fork di recupero.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="e3bdc-277">Poiché il database principale originale e il database mirror si trovano su fork di recupero diversi, ogni database includerà i dati che l'altro database non include. Il database principale originale include tutte le modifiche non inviate al database mirror precedente dalla sua coda di invio (il log non inviato). Il database mirror precedente include tutte le modifiche apportate dopo che il servizio è stato forzato.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="e3bdc-278">Se il servizio viene forzato a causa di un errore del server principale, la potenziale perdita di dati dipende dal fatto che uno o più log delle transazioni non siano stati inviati al server mirror prima dell'errore.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="e3bdc-279">In modalità a protezione elevata, questo è possibile solo finché il database mirror viene sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="e3bdc-280">In modalità a prestazioni elevate, è sempre possibile la presenza di log non inviato accumulato.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="e3bdc-281">Le implicazioni dell'utilizzo forzato del servizio dipendono in parte dal fatto che la sessione disponga o meno di un server di controllo del mirroring:</span><span class="sxs-lookup"><span data-stu-id="e3bdc-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="e3bdc-282">In sua assenza, è possibile forzare il servizio se i partner vengono disconnessi, ad esempio, perché la relativa connessione di rete si interrompe.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="e3bdc-283">Se il server principale originale è ancora in esecuzione, entrambi i partner sono proprietari del ruolo principale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="e3bdc-284">I client che si connettono al nuovo server principale avranno accesso alla versione corrente del database, mentre i client che si connettono al server principale originale avranno accesso al database principale originale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="e3bdc-285">Questa situazione aumenta il rischio di perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="e3bdc-286">Se ai partner è consentita la riconnessione, il server principale originale assume il ruolo di mirror e modifica lo stato del proprio database impostandolo su "recupero in corso," prima della sospensione del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="e3bdc-287">Se la sessione viene ripresa, le transazioni sul database principale originale i cui log si trovavano nella coda di invio al momento della disconnessione più recente vanno perdute.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="e3bdc-288">Vanno inoltre perdute eventuali transazioni verificatesi dopo l'utilizzo forzato del servizio.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="e3bdc-289">In presenza di un server di controllo del mirroring, se il server mirror viene disconnesso dal server principale e dal server di controllo del mirroring, finché questi ultimi rimangono connessi tra loro, il server principale è in esecuzione senza mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="e3bdc-290">Se il server principale viene quindi disconnesso dal server di controllo del mirroring, smette di interagire con il database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="e3bdc-291">Se successivamente il server mirror si riconnette al server di controllo del mirroring, diventa possibile l'utilizzo forzato del servizio.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="e3bdc-292">Se il servizio viene forzato, tutte le modifiche apportate mentre il server principale originale era in esecuzione senza mirroring verranno perdute, se il server principale originale viene riconnesso.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="e3bdc-293">Per altre informazioni, vedere [Gestione della potenziale perdita di dati](#ManageDataLoss)più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="e3bdc-294">Gestione della potenziale perdita di dati</span><span class="sxs-lookup"><span data-stu-id="e3bdc-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="e3bdc-295">Dopo l'utilizzo forzato del servizio, quando il server principale precedente è disponibile e supponendo che il relativo database non sia danneggiato, è possibile tentare di gestire la potenziale perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="e3bdc-296">La tecnica disponibile per la gestione della potenziale perdita di dati dipende dal fatto che il server principale originale sia stato riconnesso al relativo partner e si sia ricollegato alla sessione di mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="e3bdc-297">Supponendo che il server principale originale possa accedere alla nuova istanza principale, la riconnessione avviene in modo automatico e trasparente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="e3bdc-298">Il server principale originale si è riconnesso</span><span class="sxs-lookup"><span data-stu-id="e3bdc-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="e3bdc-299">In genere, dopo un errore, al riavvio, il server principale originale si riconnette rapidamente al proprio partner.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="e3bdc-300">Alla riconnessione, il server principale originale diventa il server mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="e3bdc-301">Il relativo database diventa il database mirror e assume lo stato di recupero prima che la sessione venga sospesa.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="e3bdc-302">Per il database mirror non verrà eseguito il rollback a meno che non venga ripreso il mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="e3bdc-303">Il database in fase di recupero è tuttavia inaccessibile, pertanto non è possibile verificarlo per valutare i dati che andrebbero perduti in caso di ripresa del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="e3bdc-304">Pertanto, la decisione relativa alla ripresa o alla rimozione del mirroring dipende dal fatto che sia accettabile o meno l'eventuale perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="e3bdc-305">Se la perdita di dati non è accettabile, rimuovere il mirroring per salvare i dati.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="e3bdc-306">La rimozione del mirroring consentirà all'amministratore del database di recuperare il database principale originale e di tentare di recuperare i dati a rischio di perdita.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="e3bdc-307">Tuttavia, quando il database mirror precedente torna online, i partner precedenti interagiranno con database divergenti con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="e3bdc-308">L'amministratore del database deve rendere uno dei database inaccessibile ai client per evitare ulteriori divergenze del database e per impedire problemi di failover dei client.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="e3bdc-309">Se la perdita di dati è accettabile, è possibile riprendere il mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="e3bdc-310">La ripresa del mirroring determina il rollback del nuovo database mirror come primo passaggio della sincronizzazione del database.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="e3bdc-311">Se nella coda di invio erano in attesa record di log al momento dell'errore, le transazioni corrispondenti vengono perdute, anche se con commit.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="e3bdc-312">Il server principale originale non si è riconnesso</span><span class="sxs-lookup"><span data-stu-id="e3bdc-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="e3bdc-313">Se è possibile impedire temporaneamente la riconnessione sulla rete del server principale originale al nuovo server principale, è possibile esaminare il server principale originale per valutare quali dati andrebbero perduti in caso di ripresa del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="e3bdc-314">Contesti in cui la perdita di dati è accettabile</span><span class="sxs-lookup"><span data-stu-id="e3bdc-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="e3bdc-315">Consentire la riconnessione al partner del server principale originale.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="e3bdc-316">La riconnessione determina la sospensione del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="e3bdc-317">Per procedere con il mirroring, riprendere la sessione.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="e3bdc-318">Il server principale precedente assume il ruolo di mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="e3bdc-319">Il nuovo server mirror elimina il fork di recupero originale, perdendo eventuali transazioni non inviate o ricevute dal server mirror precedente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="e3bdc-320">Contesti in cui la perdita di dati non è ammissibile</span><span class="sxs-lookup"><span data-stu-id="e3bdc-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="e3bdc-321">Se il database principale originale contiene dati critici che andrebbero persi in caso di ripresa della sessione, è possibile preservare tali dati sul server principale originale rimuovendo il mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="e3bdc-322">In tal caso è opportuno tentare di eseguire il backup della parte finale del log del server principale in questo punto.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="e3bdc-323">Successivamente, è possibile aggiornare il database principale corrente (il precedente database mirror) esportando i dati da salvaguardare dal database principale originale e importandoli nel database principale corrente.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="e3bdc-324">È consigliabile eseguire un backup completo del database aggiornato il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="e3bdc-325">Per riattivare il mirroring utilizzando il database aggiornato quale database principale iniziale, utilizzare questo backup (e almeno un backup del log successivo) per creare un nuovo database mirror.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="e3bdc-326">È necessario applicare qualsiasi backup del log eseguito dopo la rimozione del mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="e3bdc-327">È pertanto consigliabile rimandare ulteriori backup del log del database principale fino all'avvio della nuova sessione di mirroring.</span><span class="sxs-lookup"><span data-stu-id="e3bdc-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="e3bdc-328">Attività correlate alla gestione di un forzato Failover</span><span class="sxs-lookup"><span data-stu-id="e3bdc-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="e3bdc-329">**Per forzare il servizio**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-329">**To force service**</span></span>  
  
-   <span data-ttu-id="e3bdc-330">[Utilizzo forzato del servizio in una sessione di mirroring del database &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e3bdc-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="e3bdc-331">**Per riprendere il mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="e3bdc-332">Sospendere o riprendere una sessione di mirroring del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="e3bdc-333">**Per creare un nuovo database mirror**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="e3bdc-334">Preparazione di un database mirror per il mirroring &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="e3bdc-335">**Per avviare il mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="e3bdc-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="e3bdc-336">Impostazione del mirroring del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="e3bdc-337">Stabilire una sessione di mirroring del database tramite autenticazione di Windows &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="e3bdc-338">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e3bdc-338">See Also</span></span>  
 <span data-ttu-id="e3bdc-339">[Stimare l'interruzione del servizio durante il cambio di ruolo &#40;mirroring del database&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="e3bdc-340">[Possibili errori durante il mirroring del database](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="e3bdc-341">[Connettere client a una sessione di mirroring del database &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="e3bdc-342">[Server di controllo del mirroring del database](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="e3bdc-343">[Ripristini di database completi &#40;modello di recupero con registrazione completa&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="e3bdc-344">[Modalità di funzionamento del mirroring del database](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="e3bdc-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="e3bdc-345">Stati di mirroring &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e3bdc-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  
