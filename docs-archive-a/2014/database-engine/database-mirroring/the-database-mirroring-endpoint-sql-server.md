---
title: Endpoint del mirroring del database (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], deployment
- database mirroring [SQL Server], endpoint
- endpoints [SQL Server], AlwaysOn Availability Groups
- endpoints [SQL Server], database mirroring
- Availability Groups [SQL Server], endpoint
ms.assetid: 39332dc5-678e-4650-9217-6aa3cdc41635
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5d9728ad642d978378305a21de4b6a9db068c397
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87638076"
---
# <a name="the-database-mirroring-endpoint-sql-server"></a><span data-ttu-id="88a43-102">Endpoint del mirroring del database (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="88a43-102">The Database Mirroring Endpoint (SQL Server)</span></span>
  <span data-ttu-id="88a43-103">Per fare parte del mirroring del database e di [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] , un'istanza del server richiede un *endpoint del mirroring del database*dedicato.</span><span class="sxs-lookup"><span data-stu-id="88a43-103">To participate in [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] or database mirroring a server instance requires its own, dedicated *database mirroring endpoint*.</span></span> <span data-ttu-id="88a43-104">Si tratta di un endpoint speciale utilizzato solo per ricevere connessioni da altre istanze del server.</span><span class="sxs-lookup"><span data-stu-id="88a43-104">This endpoint is a special-purpose endpoint that is used exclusively to receive connections from other server instances.</span></span> <span data-ttu-id="88a43-105">In un'istanza del server specificata, ogni connessione del mirroring del database o di [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] a qualsiasi altra istanza del server utilizza un solo endpoint del mirroring di database.</span><span class="sxs-lookup"><span data-stu-id="88a43-105">On a given server instance, every [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] or database mirroring connection to any other server instance uses a single database mirroring endpoint.</span></span>  
  
 <span data-ttu-id="88a43-106">Gli endpoint del mirroring del database utilizzano il protocollo TCP (Transmission Control Protocol) per inviare e ricevere messaggi tra istanze del server che fanno parte di sessioni di mirroring del database o ospitano repliche di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="88a43-106">Database mirroring endpoints use Transmission Control Protocol (TCP) to send and receive messages between the server instances participating database mirroring sessions or hosting availability replicas.</span></span> <span data-ttu-id="88a43-107">L'endpoint del mirroring del database è in attesa su un numero di porta TCP univoco.</span><span class="sxs-lookup"><span data-stu-id="88a43-107">The database mirroring endpoint listens on a unique TCP port number.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="88a43-108">Per le connessioni client a un server principale o una replica primaria non viene utilizzato l'endpoint del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="88a43-108">Client connections to a principal server or primary replica do not use the database mirroring endpoint.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="88a43-109">La funzionalità del mirroring di database verrà rimossa in una delle prossime versioni di Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="88a43-109">The database mirroring feature will be removed in a future version of Microsoft SQL Server.</span></span> <span data-ttu-id="88a43-110">Evitare di utilizzare questa funzionalità in un nuovo progetto di sviluppo e prevedere interventi di modifica nelle applicazioni in cui è attualmente implementata in modo da poter utilizzare [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="88a43-110">Avoid using this feature in new development work, and plan to modify applications that currently use database mirroring to use [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] instead.</span></span>  
  
  
##  <a name="server-network-address"></a><a name="ServerNetworkAddress"></a> <span data-ttu-id="88a43-111">Indirizzo di rete del server</span><span class="sxs-lookup"><span data-stu-id="88a43-111">Server Network Address</span></span>  
 <span data-ttu-id="88a43-112">L'indirizzo di rete di un'istanza del server, ovvero l' *indirizzo di rete del server* o l' *URL endpoint*, contiene il numero di porta del relativo endpoint e il nome di sistema e di dominio del relativo computer host.</span><span class="sxs-lookup"><span data-stu-id="88a43-112">The network address of a server instance (its *server network address* or *Endpoint URL*) contains the port number of its endpoint, as well as the system and domain name of its host computer.</span></span> <span data-ttu-id="88a43-113">Il numero di porta identifica in modo univoco un'istanza del server specifica.</span><span class="sxs-lookup"><span data-stu-id="88a43-113">The port number uniquely identifies a specific server instance.</span></span>  
  
 <span data-ttu-id="88a43-114">Nella figura seguente viene illustrato come sia possibile identificare in modo univoco due istanze nello stesso server.</span><span class="sxs-lookup"><span data-stu-id="88a43-114">The following figure illustrates how two server instances on the same server are uniquely identified.</span></span> <span data-ttu-id="88a43-115">L'indirizzo di rete del server di entrambe le istanze contiene lo stesso nome di sistema, `MYSYSTEM`, e lo stesso nome di dominio, `Adventure-Works.MyDomain.com`.</span><span class="sxs-lookup"><span data-stu-id="88a43-115">The server network addresses of both server instances contain the same system name, `MYSYSTEM`, and domain name, `Adventure-Works.MyDomain.com`.</span></span> <span data-ttu-id="88a43-116">Per consentire al sistema di eseguire il routing delle connessioni a un'istanza del server, un indirizzo di rete del server include il numero di porta associato all'endpoint del mirroring di un'istanza del server specifica.</span><span class="sxs-lookup"><span data-stu-id="88a43-116">To enable the system to route connections to a server instance, a server network address includes the port number associated with the mirroring endpoint of a particular server instance.</span></span>  
  
 <span data-ttu-id="88a43-117">![Indirizzi di rete del server per un'istanza predefinita](../media/dbm-2-instances-ports-1-system.gif "Indirizzi di rete del server per un'istanza predefinita")</span><span class="sxs-lookup"><span data-stu-id="88a43-117">![Server network addresses of a default instance](../media/dbm-2-instances-ports-1-system.gif "Server network addresses of a default instance")</span></span>  
  
 <span data-ttu-id="88a43-118">Per impostazione predefinita, un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non contiene endpoint del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="88a43-118">By default, an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not contain a database mirroring endpoint.</span></span> <span data-ttu-id="88a43-119">Tali endpoint devono essere creati manualmente durante l'impostazione di una sessione di mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="88a43-119">These must be created manually as part of setting up a database mirroring session.</span></span> <span data-ttu-id="88a43-120">L'amministratore di sistema dovrà creare un endpoint separato per ogni istanza del server che deve partecipare al mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="88a43-120">The system administrator must create a separate endpoint in each server instance that is to participate in database mirroring.</span></span> <span data-ttu-id="88a43-121">Se in un computer specifico più istanze del server richiedono un endpoint del mirroring di database, specificare un numero di porta diverso per ogni endpoint.</span><span class="sxs-lookup"><span data-stu-id="88a43-121">Note that if more than one server instance on a given computer requires a database mirroring endpoint, specify a different port number for each endpoint.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="88a43-122">Se nel computer in cui è in esecuzione [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è presente un firewall, esso dovrà essere configurato in modo da consentire sia le connessioni in ingresso che quelle in uscita per la porta specificata nell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="88a43-122">If the computer running [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] has a firewall, the firewall configuration must allow both incoming and outgoing connections for the port specified in the endpoint.</span></span>  
  
 <span data-ttu-id="88a43-123">Per il mirroring del database e [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], l'autenticazione e la crittografia devono essere configurate nell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="88a43-123">For database mirroring and [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], authentication and encryption are configured on the endpoint.</span></span> <span data-ttu-id="88a43-124">Per ulteriori informazioni, vedere [sicurezza del trasporto per il mirroring del database e Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](transport-security-database-mirroring-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="88a43-124">For more information, see [Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;](transport-security-database-mirroring-always-on-availability.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="88a43-125">Non riconfigurare un endpoint del mirroring del database in uso.</span><span class="sxs-lookup"><span data-stu-id="88a43-125">Do not reconfigure an in-use database mirroring endpoint.</span></span> <span data-ttu-id="88a43-126">Le istanze del server utilizzano reciprocamente i propri endpoint per apprendere lo stato degli altri sistemi.</span><span class="sxs-lookup"><span data-stu-id="88a43-126">The server instances use each other's endpoints to learn the state of the other systems.</span></span> <span data-ttu-id="88a43-127">La riconfigurazione dell'endpoint potrebbe determinarne il riavvio, situazione che alle altre istanze del server potrebbe apparire come un errore.</span><span class="sxs-lookup"><span data-stu-id="88a43-127">If the endpoint is reconfigured, it might restart, which can appear to be an error to the other server instances.</span></span> <span data-ttu-id="88a43-128">Questa indicazione è particolarmente importante per la modalità con failover automatico, nella quale la riconfigurazione dell'endpoint in un partner potrebbe causare il verificarsi di un failover.</span><span class="sxs-lookup"><span data-stu-id="88a43-128">This is particularly important for automatic failover mode, in which reconfiguring the endpoint on a partner could cause a failover to occur.</span></span>  
  
  
##  <a name="determining-the-authentication-type-for-a-database-mirroring-endpoint"></a><a name="EndpointAuthenticationTypes"></a> <span data-ttu-id="88a43-129">Determinazione del tipo di autenticazione per un endpoint del mirroring del database</span><span class="sxs-lookup"><span data-stu-id="88a43-129">Determining the Authentication Type for a Database Mirroring Endpoint</span></span>  
 <span data-ttu-id="88a43-130">È importante comprendere che gli account del servizio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] delle istanze del server determinano il tipo di autenticazione che è possibile utilizzare per gli endpoint del mirroring del database, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="88a43-130">It is important to understand that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service accounts of your server instances determine what type of authentication you can use for your database mirroring endpoints, as follows:</span></span>  
  
-   <span data-ttu-id="88a43-131">Se ogni istanza del server è in esecuzione con un account di servizio del dominio, è possibile utilizzare l'autenticazione di Windows per gli endpoint del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="88a43-131">If every server instance is running under a domain service account, you can use Windows Authentication for your database mirroring endpoints.</span></span> <span data-ttu-id="88a43-132">Se tutte le istanze del server vengono eseguite con lo stesso account utente di dominio, gli account di accesso utente corretti saranno disponibili automaticamente in entrambi i database **master** .</span><span class="sxs-lookup"><span data-stu-id="88a43-132">If all the server instances run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="88a43-133">Questa scelta semplifica la configurazione della sicurezza per i database di disponibilità ed è quella consigliata.</span><span class="sxs-lookup"><span data-stu-id="88a43-133">This simplifies the security configuration for the availability databases and is recommended.</span></span>  
  
     <span data-ttu-id="88a43-134">Se ogni istanza del server che ospita le repliche di disponibilità per un gruppo di disponibilità viene eseguita con account diversi, è necessario creare l'accesso per ogni account nel database **master** dell'altra istanza del server.</span><span class="sxs-lookup"><span data-stu-id="88a43-134">If any server instances that are hosting the availability replicas for an availability group run as different accounts, the login each account must be created in **master** on the other server instance.</span></span> <span data-ttu-id="88a43-135">È necessario che l'account di accesso disponga dell'autorizzazione CONNECT per connettersi all'endpoint del mirroring del database dell'istanza del server.</span><span class="sxs-lookup"><span data-stu-id="88a43-135">Then, that login must be granted CONNECT permissions to connect to the database mirroring endpoint of that server instance.</span></span> <span data-ttu-id="88a43-136">Per ulteriori informazioni, [configurare gli account di accesso per il mirroring del database o Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](set-up-login-accounts-database-mirroring-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="88a43-136">For more information, [Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](set-up-login-accounts-database-mirroring-always-on-availability.md).</span></span>  
  
     <span data-ttu-id="88a43-137">Se le istanze del server utilizzano l'autenticazione di Windows, è possibile creare gli endpoint del mirroring di database tramite [!INCLUDE[tsql](../../includes/tsql-md.md)], PowerShell o la Creazione guidata Gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="88a43-137">If your server instances use Windows Authentication, you can create database mirroring endpoints by using [!INCLUDE[tsql](../../includes/tsql-md.md)], PowerShell, or the New Availability Group Wizard.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="88a43-138">Se un'istanza del server che deve ospitare una replica di disponibilità non dispone di un endpoint del mirroring del database, è possibile utilizzare la Creazione guidata Gruppo di disponibilità per creare automaticamente un endpoint del mirroring del database che utilizza l'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="88a43-138">If a server instance that is to host an availability replica lacks a database mirroring endpoint, the New Availability Group Wizard can automatically create a database mirroring endpoint that uses Windows Authentication.</span></span> <span data-ttu-id="88a43-139">Per altre informazioni, vedere [Utilizzare la Creazione guidata Gruppo di disponibilità &#40;SQL Server Management Studio&#41;](../availability-groups/windows/use-the-availability-group-wizard-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="88a43-139">For more information, see [Use the Availability Group Wizard &#40;SQL Server Management Studio&#41;](../availability-groups/windows/use-the-availability-group-wizard-sql-server-management-studio.md).</span></span>  
  
-   <span data-ttu-id="88a43-140">Se un'istanza del server viene eseguita con un account predefinito, ad esempio Sistema locale, Servizio locale o Servizio di rete, oppure con un account non di dominio, è necessario utilizzare certificati per l'autenticazione dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="88a43-140">If any server instance is running under a built-in account, such as Local System, Local Service, or Network Service, or a nondomain account, you must use certificates for endpoint authentication.</span></span> <span data-ttu-id="88a43-141">Se si utilizzano certificati per gli endpoint del mirroring del database, l'amministratore di sistema deve configurare ogni istanza del server per l'utilizzo dei certificati sia nelle connessioni in uscita che in quelle in ingresso.</span><span class="sxs-lookup"><span data-stu-id="88a43-141">If you are using certificates for your database mirroring endpoints, your system administrator must configure each server instance to use certificates on both outbound and inbound connections.</span></span>  
  
     <span data-ttu-id="88a43-142">Non è disponibile alcun metodo automatico per la configurazione della sicurezza del mirroring del database tramite certificati.</span><span class="sxs-lookup"><span data-stu-id="88a43-142">There is no automated method for configuring database mirroring security using certificates.</span></span> <span data-ttu-id="88a43-143">È necessario utilizzare l'istruzione di [!INCLUDE[tsql](../../includes/tsql-md.md)] CREATE ENDPOINT o il cmdlet di PowerShell `New-SqlHadrEndpoint`.</span><span class="sxs-lookup"><span data-stu-id="88a43-143">You will need to use either CREATE ENDPOINT [!INCLUDE[tsql](../../includes/tsql-md.md)] statement or the `New-SqlHadrEndpoint` PowerShell cmdlet.</span></span> <span data-ttu-id="88a43-144">Per altre informazioni, vedere [CREATE ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-endpoint-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="88a43-144">For more information, see [CREATE ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-endpoint-transact-sql).</span></span> <span data-ttu-id="88a43-145">Per informazioni sull'abilitazione dell'autenticazione del certificato in un'istanza del server, vedere [usare i certificati per un endpoint del mirroring del Database &#40;&#41;Transact-SQL ](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="88a43-145">For information about enabling certificate authentication on a server instance, see [Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>  
  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="88a43-146">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="88a43-146">Related Tasks</span></span>  

### <a name="to-configure-a-database-mirroring-endpoint"></a><span data-ttu-id="88a43-147">Per configurare un endpoint del mirroring del database</span><span class="sxs-lookup"><span data-stu-id="88a43-147">To Configure a Database Mirroring Endpoint</span></span>
  
-   [<span data-ttu-id="88a43-148">Creare un endpoint del mirroring del database per l'autenticazione Windows &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-148">Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;</span></span>](create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)  
  
-   [<span data-ttu-id="88a43-149">Utilizzare certificati per un endpoint del mirroring del database &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-149">Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;</span></span>](use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)  
  
    -   [<span data-ttu-id="88a43-150">Impostazione dell'endpoint del mirroring del database per l'utilizzo di certificati per le connessioni in uscita &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-150">Allow a Database Mirroring Endpoint to Use Certificates for Outbound Connections &#40;Transact-SQL&#41;</span></span>](database-mirroring-use-certificates-for-outbound-connections.md)  
  
    -   [<span data-ttu-id="88a43-151">Impostazione dell'endpoint del mirroring del database per l'utilizzo di certificati per le connessioni in ingresso &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-151">Allow a Database Mirroring Endpoint to Use Certificates for Inbound Connections &#40;Transact-SQL&#41;</span></span>](database-mirroring-use-certificates-for-inbound-connections.md)  
  
-   [<span data-ttu-id="88a43-152">Specificare un indirizzo di rete del server &#40;Mirroring del database&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-152">Specify a Server Network Address &#40;Database Mirroring&#41;</span></span>](specify-a-server-network-address-database-mirroring.md)  
  
-   [<span data-ttu-id="88a43-153">Specifica dell'URL dell'endpoint quando si aggiunge o si modifica una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-153">Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;</span></span>](../availability-groups/windows/specify-endpoint-url-adding-or-modifying-availability-replica.md)  
  
-   [<span data-ttu-id="88a43-154">Usare la Creazione guidata Gruppo di disponibilità &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-154">Use the Availability Group Wizard &#40;SQL Server Management Studio&#41;</span></span>](../../ssms/sql-server-management-studio-ssms.md)  
  
 <span data-ttu-id="88a43-155">**Per visualizzare informazioni sull'endpoint del mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="88a43-155">**To View Information About the Database Mirroring Endpoint**</span></span>  
  
-   [<span data-ttu-id="88a43-156">sys.database_mirroring_endpoints &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-156">sys.database_mirroring_endpoints &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql)  
  
  
## <a name="see-also"></a><span data-ttu-id="88a43-157">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="88a43-157">See Also</span></span>  
 <span data-ttu-id="88a43-158">[Sicurezza del trasporto per il mirroring del database e Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](transport-security-database-mirroring-always-on-availability.md) </span><span class="sxs-lookup"><span data-stu-id="88a43-158">[Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;](transport-security-database-mirroring-always-on-availability.md) </span></span>  
 <span data-ttu-id="88a43-159">[Risolvere i problemi relativi alla configurazione del mirroring del database &#40;SQL Server&#41;](troubleshoot-database-mirroring-configuration-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="88a43-159">[Troubleshoot Database Mirroring Configuration &#40;SQL Server&#41;](troubleshoot-database-mirroring-configuration-sql-server.md) </span></span>  
 <span data-ttu-id="88a43-160">[sys. dm_hadr_availability_replica_states &#40;&#41;Transact-SQL](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-availability-replica-states-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="88a43-160">[sys.dm_hadr_availability_replica_states &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-availability-replica-states-transact-sql) </span></span>  
 [<span data-ttu-id="88a43-161">sys.dm_db_mirroring_connections &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="88a43-161">sys.dm_db_mirroring_connections &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/database-mirroring-sys-dm-db-mirroring-connections)  
