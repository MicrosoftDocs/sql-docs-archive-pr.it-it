---
title: Mirroring del database e log shipping (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- database mirroring [SQL Server], interoperability
- log shipping [SQL Server], database mirroring
ms.assetid: 53e98134-e274-4dfd-8b72-0cc0fd5c800e
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: fe11f4244eff98923a6f4ee291caca9c094237f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626275"
---
# <a name="database-mirroring-and-log-shipping-sql-server"></a><span data-ttu-id="9b7e3-102">Mirroring del database e log shipping (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="9b7e3-102">Database Mirroring and Log Shipping (SQL Server)</span></span>
  <span data-ttu-id="9b7e3-103">Per un database specifico è possibile eseguire il mirroring o il log shipping oppure eseguire le due operazioni simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-103">A given database can be mirrored or log shipped; it can also be simultaneously mirrored and log shipped.</span></span> <span data-ttu-id="9b7e3-104">Per scegliere l'approccio da utilizzare, considerare gli aspetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="9b7e3-104">To choose what approach to use, consider the following:</span></span>  
  
-   <span data-ttu-id="9b7e3-105">Numero di server di destinazione necessari</span><span class="sxs-lookup"><span data-stu-id="9b7e3-105">How many destination servers do you require?</span></span>  
  
     <span data-ttu-id="9b7e3-106">Se è necessario un solo database di destinazione, il mirroring del database rappresenta la soluzione consigliata.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-106">If you require only a single destination database, database mirroring is the recommended solution.</span></span>  
  
     <span data-ttu-id="9b7e3-107">Se è necessario più di un database di destinazione, utilizzare il log shipping con o senza il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-107">If you require more than one destination database, you need to use log shipping, either alone or with database mirroring.</span></span> <span data-ttu-id="9b7e3-108">La combinazione di questi approcci offre i vantaggi del mirroring del database insieme al supporto per più destinazioni garantito dal log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-108">Combining these approaches gives you the benefits of database mirroring along with the support for multiple destinations provided by log shipping.</span></span>  
  
-   <span data-ttu-id="9b7e3-109">Se è necessario posticipare il ripristino del log nel database di destinazione, in genere ai fini della protezione da errori logici, utilizzare il log shipping dei log con o senza mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-109">If you need to delay restoring log on the destination database (typically, to protect against logical errors), use log shipping, alone or with database mirroring.</span></span>  
  
 <span data-ttu-id="9b7e3-110">In questo argomento vengono fornite alcune considerazioni utili per la combinazione del log shipping e del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-110">This topic discusses considerations for combining log shipping and database mirroring.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7e3-111">Per informazioni introduttive su queste tecnologie, vedere [Mirroring del database &#40;SQL Server&#41;](database-mirroring-sql-server.md) e [Informazioni sul log shipping &#40;SQL Server&#41;](../log-shipping/about-log-shipping-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-111">For introductions to these technologies, see [Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) and [About Log Shipping &#40;SQL Server&#41;](../log-shipping/about-log-shipping-sql-server.md).</span></span>  
  
## <a name="combining-log-shipping-and-database-mirroring"></a><span data-ttu-id="9b7e3-112">Combinazione del log shipping e del mirroring del database</span><span class="sxs-lookup"><span data-stu-id="9b7e3-112">Combining Log Shipping and Database Mirroring</span></span>  
 <span data-ttu-id="9b7e3-113">Il database principale in una sessione di mirroring può anche fungere da database primario in una configurazione per il log shipping o viceversa, se la condivisione di backup per il log shipping è integra.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-113">The principal database in a mirroring session can also act as the primary database in a log shipping configuration, or vice versa, as the log shipping backup share is intact.</span></span> <span data-ttu-id="9b7e3-114">La sessione di mirroring del database viene eseguita in qualsiasi modalità operativa, sia sincrona (con la protezione delle transazioni impostata su FULL) che asincrona (con la protezione delle transazioni impostata su OFF).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-114">The database mirroring session run in any operating mode, whether synchronous (with transaction safety set to FULL) or asynchronous (with transaction safety set to OFF).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7e3-115">Per utilizzare il mirroring del database su un database è sempre necessario il modello di recupero con registrazione completa.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-115">To use database mirroring on a database, the full recovery model is always required.</span></span>  
  
 <span data-ttu-id="9b7e3-116">Quando si combinano il log shipping e il mirroring del database, benché non sia necessario, la sessione di mirroring viene in genere stabilita prima del log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-116">Typically, when combining log shipping and database mirroring, the mirroring session is established before log shipping, although this is not required.</span></span> <span data-ttu-id="9b7e3-117">Il database principale corrente viene quindi configurato come database primario per il log shipping ( *database principale/primario*), insieme a uno o più database secondari remoti.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-117">Then the current principal database is configured as the log shipping primary (the *principal/primary database*), along with one or more remote secondary databases.</span></span> <span data-ttu-id="9b7e3-118">Il database mirror, inoltre, deve essere configurato come database primario per il log shipping ( *database mirror/primario*).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-118">Also, the mirror database must be configured as a log shipping primary (the *mirror/primary database*).</span></span> <span data-ttu-id="9b7e3-119">È consigliabile che i database secondari per il log shipping siano presenti in istanze del server diverse rispetto al server principale/primario o al server mirror/primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-119">The log shipping secondary databases should be on different server instances than either the principal/primary server or mirror/primary server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7e3-120">Le impostazioni relative alla distinzione tra maiuscole e minuscole dei server implicati nel log shipping devono corrispondere.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-120">The case sensitivity settings of the servers involved in log shipping should match.</span></span>  
  
 <span data-ttu-id="9b7e3-121">Durante una sessione di log shipping, i processi di backup nel database primario comportano la creazione di backup del log in una cartella di backup.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-121">During a log shipping session, backup jobs on the primary database create log backups in a backup folder.</span></span> <span data-ttu-id="9b7e3-122">Da questa cartella i backup vengono copiati tramite i processi di copia dei server secondari.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-122">From there, the backups are copied by the copy jobs of the secondary servers.</span></span> <span data-ttu-id="9b7e3-123">Ai fini della corretta esecuzione, è necessario che i processi di backup e di copia possano accedere alla cartella di backup per il log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-123">For the backup jobs and copy jobs to succeed, they must have access to the log shipping backup folder.</span></span> <span data-ttu-id="9b7e3-124">Per ottimizzare la disponibilità del server primario, è consigliabile definire la cartella di backup in un percorso di backup condiviso in un computer host distinto.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-124">To maximize availability of the primary server, we recommend that you establish the backup folder in a shared backup location on a separate host computer.</span></span> <span data-ttu-id="9b7e3-125">Assicurarsi che tutti i server per il log shipping, incluso il server mirror/primario, possano accedere al percorso di backup condiviso, noto come *condivisione di backup*.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-125">Ensure that all the log shipping servers, including the mirror/primary server, can access the shared backup location (known as a *backup share*).</span></span>  
  
 <span data-ttu-id="9b7e3-126">Per consentire il proseguimento del log shipping in seguito a un errore di mirroring del database, è inoltre necessario configurare il server mirror come server primario utilizzando la stessa configurazione del database primario nel database principale.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-126">To allow log shipping to continue after database mirroring fails over, you must also configure the mirror server as a primary server, using the same configuration you use for the primary on the principal database.</span></span> <span data-ttu-id="9b7e3-127">Il database mirror è in stato di ripristino, che impedisce ai processi di backup di eseguire il backup del log nel database mirror.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-127">The mirror database is in the restoring state, which prevents the backup jobs from backing up the log on the mirror database.</span></span> <span data-ttu-id="9b7e3-128">Questo comportamento garantisce che il database mirror/primario non interferisca con il database principale/primario i cui backup del log vengono copiati dai server secondari.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-128">This ensures that the mirror/primary database does not interfere with the principal/primary database whose log backups are currently being copied by secondary servers.</span></span> <span data-ttu-id="9b7e3-129">Per evitare avvisi non corretti, in seguito all'esecuzione del processo di backup nel database mirror/primario, il log del processo di backup registra un messaggio nella tabella**log_shipping_monitor_history_detail** e il processo agente restituisce uno stato con esito positivo.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-129">To prevent spurious alerts, after the backup job executes on the mirror/primary database, the backup job logs a message to the l**og_shipping_monitor_history_detail** table, and the agent job returns a status of success.</span></span>  
  
 <span data-ttu-id="9b7e3-130">Il database mirror/primario è inattivo durante la sessione di log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-130">The mirror/primary database is inactive in the log shipping session.</span></span> <span data-ttu-id="9b7e3-131">Se, tuttavia, il mirroring ha esito negativo, il database mirror precedente viene portato online come database principale.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-131">However, if mirroring fails over, the former mirror database comes online as the principal database.</span></span> <span data-ttu-id="9b7e3-132">A questo punto, il database viene inoltre attivato come database primario per il log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-132">At that point, that database also becomes active as the log shipping primary database.</span></span> <span data-ttu-id="9b7e3-133">I processi di backup per il log shipping precedentemente non disponibili per distribuire il log nel database avviano la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-133">The log shipping backup jobs that were previously unable to ship log on that database, begin shipping log.</span></span> <span data-ttu-id="9b7e3-134">Al contrario, un failover fa sì che il database principale/primario precedente venga impostato come nuovo database mirror/primario e sia in stato di ripristino e che i processi di backup nel database non eseguano più il backup del log.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-134">Conversely, a failover causes the former principal/primary database to become the new mirror/primary database and enter the restoring state, and backup jobs on that database cease to backup log.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9b7e3-135">Nel caso di un failover automatico, il passaggio al ruolo mirror si verifica quando il database principale/primario si riconnette alla sessione di mirroring.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-135">In the event of an automatic failover, the switch to the mirror role occurs when the former principal/primary database rejoins the mirroring session.</span></span>  
  
 <span data-ttu-id="9b7e3-136">Per essere eseguita in modalità a sicurezza elevata con failover automatico, la sessione di mirroring viene configurata con un'istanza del server aggiuntiva, nota come *server di controllo del mirroring*.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-136">To run in high-safety mode with automatic failover the mirroring session is configured with an additional server instance known as the *witness*.</span></span> <span data-ttu-id="9b7e3-137">In caso di perdita del database principale per qualsiasi motivo in seguito alla sincronizzazione del database e se il server mirror e il server di controllo del mirroring continuano a comunicare, si verifica il failover automatico.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-137">If the principal database is lost for any reason after the database is synchronized and if the mirror server and witness can still communicate with each other, automatic failover occurs.</span></span> <span data-ttu-id="9b7e3-138">Un failover automatico fa sì che il server assuma il ruolo principale e porti online il proprio database come database principale.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-138">An automatic failover causes mirror server to assume the principal role and bring its database online as the principal database.</span></span> <span data-ttu-id="9b7e3-139">Se il percorso di backup per il log shipping è accessibile da parte del nuovo server principale/primario, tramite i relativi processi di backup viene avviata la distribuzione dei backup del log in tale percorso.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-139">If the log shipping backup location is accessible to the new principal/primary server, its backup jobs begin to ship log backups to that location.</span></span> <span data-ttu-id="9b7e3-140">La modalità sincrona del mirroring del database garantisce che la catena di log non sia interessata da un failover del mirroring e che venga ripristinato solo il log valido.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-140">The database mirroring synchronous mode guarantees that the log chain is unaffected by a mirroring failover and that only valid log is restored.</span></span> <span data-ttu-id="9b7e3-141">I server secondari continuano a copiare i backup del log senza rilevare che un'istanza del server diversa è stata impostata come server primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-141">The secondary servers continue to copy log backups without knowing that a different server instance has become the primary server.</span></span>  
  
 <span data-ttu-id="9b7e3-142">Quando si utilizza un server di monitoraggio log shipping locale, non è necessaria alcuna considerazione specifica ai fini di questo scenario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-142">When using a local log shipping monitor, no special considerations are necessary to accommodate this scenario.</span></span> <span data-ttu-id="9b7e3-143">Per informazioni sull'utilizzo di un'istanza di monitoraggio remota con questo scenario, vedere "Impatto del mirroring del database su un'istanza di monitoraggio remota" più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-143">For information about using a remote monitoring instance with this scenario, see, "The Impact of Database Mirroring on a Remote Monitoring Instance," later in this topic.</span></span>  
  
## <a name="failing-over-from-the-principal-to-the-mirror-database"></a><span data-ttu-id="9b7e3-144">Failover dal database principale al database mirror</span><span class="sxs-lookup"><span data-stu-id="9b7e3-144">Failing over from the Principal to the Mirror database</span></span>  
 <span data-ttu-id="9b7e3-145">Nella figura seguente viene illustrata la combinazione del log shipping e del mirroring del database quando il mirroring viene eseguito in modalità a sicurezza elevata con failover automatico.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-145">The following figure shows how log shipping and database mirroring work together when mirroring is running in high-safety mode with automatic failover.</span></span> <span data-ttu-id="9b7e3-146">Inizialmente il **Server_A** rappresenta sia il server principale per il mirroring, sia il server primario per il log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-146">Initially, **Server_A** is both the principal server for mirroring and the primary server for log shipping.</span></span> <span data-ttu-id="9b7e3-147">Il**Server_B** rappresenta il server mirror ed è inoltre configurato come server primario, attualmente non attivo.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-147">**Server_B** is the mirror server and is also configured as a primary server, which is currently inactive.</span></span> <span data-ttu-id="9b7e3-148">I**Server_C** e **Server_D** rappresentano i server secondari per il log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-148">**Server_C** and **Server_D** are log shipping secondary servers.</span></span> <span data-ttu-id="9b7e3-149">Per ottimizzare la disponibilità della sessione di log shipping, il percorso di backup è incluso in una directory condivisa di un computer host distinto.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-149">To maximize availability of the log shipping session, the backup location is on a share directory on a separate host computer.</span></span>  
  
 <span data-ttu-id="9b7e3-150">![Log shipping e mirroring del database](../media/logshipping-and-dbm-automatic-failover.gif "Log shipping e mirroring del database")</span><span class="sxs-lookup"><span data-stu-id="9b7e3-150">![Log shipping and database mirroring](../media/logshipping-and-dbm-automatic-failover.gif "Log shipping and database mirroring")</span></span>  
  
 <span data-ttu-id="9b7e3-151">In seguito a un failover del mirroring, il nome del server primario definito nel server secondario risulta inalterato</span><span class="sxs-lookup"><span data-stu-id="9b7e3-151">After a mirroring failover, the primary server name defined on the secondary server is unchanged.</span></span> <span data-ttu-id="9b7e3-152">.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-152">.</span></span>  
  
## <a name="the-impact-of-database-mirroring-on-a-remote-monitoring-instance"></a><span data-ttu-id="9b7e3-153">Impatto del mirroring del database su un'istanza di monitoraggio remota</span><span class="sxs-lookup"><span data-stu-id="9b7e3-153">The Impact of Database Mirroring on a Remote Monitoring Instance</span></span>  
 <span data-ttu-id="9b7e3-154">Quando il log shipping viene utilizzato con un'istanza di monitoraggio remota, la combinazione della sessione di log shipping e del mirroring del database influisce sulle informazioni incluse nelle tabelle di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-154">When log shipping uses with a remote monitoring instance, combining the log shipping session and database mirroring affects the information in the monitor tables.</span></span> <span data-ttu-id="9b7e3-155">Le informazioni sul server primario rappresentano una combinazione di quelle configurate nel server principale/primario e del server di monitoraggio configurato in ogni server secondario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-155">The information about the primary is a combination of the one configured at the principal/primary and the monitor configured on each secondary.</span></span>  
  
 <span data-ttu-id="9b7e3-156">Per mantenere il monitoraggio il più semplice possibile, quando si utilizza un server di monitoraggio remoto è consigliabile specificare il nome del server primario originale durante la configurazione del server primario nel server secondario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-156">To keep monitoring as seamless as possible, when you use a remote monitor, we recommend that you specify the original primary name when configuring the primary at the secondary.</span></span> <span data-ttu-id="9b7e3-157">Questo approccio semplifica la modifica della configurazione per il log shipping tramite Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-157">This approach also facilitates changing the log shipping configuration from Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span></span> <span data-ttu-id="9b7e3-158">Per altre informazioni sul monitoraggio, vedere [Monitorare il log shipping &#40;Transact-SQL&#41;](../log-shipping/monitor-log-shipping-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-158">For more information about monitoring, see [Monitor Log Shipping &#40;Transact-SQL&#41;](../log-shipping/monitor-log-shipping-transact-sql.md).</span></span>  
  
## <a name="setting-up-mirroring-and-log-shipping-together"></a><span data-ttu-id="9b7e3-159">Impostazione della combinazione di mirroring e log shipping</span><span class="sxs-lookup"><span data-stu-id="9b7e3-159">Setting Up Mirroring and Log Shipping Together</span></span>  
 <span data-ttu-id="9b7e3-160">Per impostare insieme il mirroring del database e il log shipping, è necessario attenersi alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="9b7e3-160">To set up database mirroring and log shipping together, the following steps are required:</span></span>  
  
1.  <span data-ttu-id="9b7e3-161">Ripristinare i backup del database principale/primario con NORECOVERY in un'altra istanza del server per utilizzarli in seguito come database mirror per il mirroring del database principale/primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-161">Restore backups of the principal/primary database with NORECOVERY onto another server instance to be later used as database mirroring mirror database for the principal/primary database.</span></span> <span data-ttu-id="9b7e3-162">Per altre informazioni, vedere [Preparazione di un database mirror per il mirroring &#40;SQL Server&#41;](prepare-a-mirror-database-for-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-162">For more information, see [Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;](prepare-a-mirror-database-for-mirroring-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="9b7e3-163">Impostare il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-163">Set up database mirroring.</span></span> <span data-ttu-id="9b7e3-164">Per altre informazioni, vedere [Stabilire una sessione di mirroring del database tramite autenticazione di Windows &#40;SQL Server Management Studio&#41;](establish-database-mirroring-session-windows-authentication.md) o [Impostazione del mirroring del database &#40;SQL Server&#41;](setting-up-database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-164">For more information, see [Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;](establish-database-mirroring-session-windows-authentication.md) or [Setting Up Database Mirroring &#40;SQL Server&#41;](setting-up-database-mirroring-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="9b7e3-165">Ripristinare i backup del database principale/primario in altre istanze del server per utilizzarli in seguito come database secondari del log shipping per il database primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-165">Restore backups of the principal/primary database to other server instances to be later used as log shipping secondary databases for the primary database.</span></span>  
  
4.  <span data-ttu-id="9b7e3-166">Impostare il log shipping nel database principale come database primario per uno o più database secondari.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-166">Set up log shipping on the principal database as the primary database for one or more secondary databases.</span></span>  
  
     <span data-ttu-id="9b7e3-167">È consigliabile impostare una singola condivisione come directory di backup (condivisione di backup).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-167">You should set up a single share as the backup directory (a backup share).</span></span> <span data-ttu-id="9b7e3-168">In questo modo si assicura che in seguito allo scambio tra server principale e mirror, i processi di backup continuino a scrivere nella stessa directory utilizzata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-168">This ensures that after role switching between the principal and mirror servers, backup jobs continue to write to the same directory as before.</span></span> <span data-ttu-id="9b7e3-169">Una procedura consigliata consiste nel fare in modo che la condivisione sia in un server fisico diverso dai server in cui è presente il database implicato nel mirroring e nel log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-169">A best practice is to ensure that this share is located on a different physical server from the servers hosting the databases involved in mirroring and log shipping.</span></span>  
  
     <span data-ttu-id="9b7e3-170">Per altre informazioni, vedere [Configurare il log shipping &#40;SQL Server&#41;](../log-shipping/configure-log-shipping-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="9b7e3-170">For more information, see [Configure Log Shipping &#40;SQL Server&#41;](../log-shipping/configure-log-shipping-sql-server.md).</span></span>  
  
5.  <span data-ttu-id="9b7e3-171">Eseguire manualemnte il failover dal database principale al database mirror</span><span class="sxs-lookup"><span data-stu-id="9b7e3-171">Manually failover from the principal to the mirror.</span></span>  
  
     <span data-ttu-id="9b7e3-172">Per eseguire un failover manuale:</span><span class="sxs-lookup"><span data-stu-id="9b7e3-172">To perform a manual failover:</span></span>  
  
    -   [<span data-ttu-id="9b7e3-173">Failover manuale di una sessione di mirroring del database &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="9b7e3-173">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
    -   [<span data-ttu-id="9b7e3-174">Eseguire il failover manuale di una sessione di mirroring del database &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9b7e3-174">Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;</span></span>](manually-fail-over-a-database-mirroring-session-transact-sql.md)  
  
6.  <span data-ttu-id="9b7e3-175">Impostare il log shipping nel nuovo database principale (in precedenza database mirror) come database primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-175">Set up log shipping on the new principal (previously mirror) as the primary database.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="9b7e3-176">Non eseguire alcuna installazione da un database secondario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-176">Do not perform any setup from a secondary.</span></span>  
  
     <span data-ttu-id="9b7e3-177">È necessario utilizzare la stessa condivisione di backup utilizzata nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-177">You must use the same backup share that you used in step 4.</span></span>  
  
     <span data-ttu-id="9b7e3-178">L'interfaccia **Log shipping delle transazioni** di [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supporta solo un database primario per ogni configurazione di log shipping.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-178">The **Transaction Log Shipping** interface in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports only one primary database per log shipping configuration.</span></span> <span data-ttu-id="9b7e3-179">È pertanto necessario utilizzare stored procedure per impostare il nuovo database principale come primario.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-179">Therefore, you must use stored procedures to set up the new principal as primary.</span></span>  
  
7.  <span data-ttu-id="9b7e3-180">Eseguire un altro failover manuale per eseguire nuovamente il failback al database principale originale.</span><span class="sxs-lookup"><span data-stu-id="9b7e3-180">Perform another manual failover to fail back to the original principal.</span></span>  
  
  
