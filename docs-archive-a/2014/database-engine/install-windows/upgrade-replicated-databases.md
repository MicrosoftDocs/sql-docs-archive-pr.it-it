---
title: Aggiornare database replicati | Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- merge replication database upgrades [SQL Server replication]
- replication [SQL Server], upgrading
- transactional replication, upgrading databases
- snapshot replication [SQL Server], upgrading databases
- upgrading replicated databases
ms.assetid: 9926a4f7-bcd8-4b9b-9dcf-5426a5857116
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 326a94820876b40128428aac58e47c650ce122b8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626851"
---
# <a name="upgrade-replicated-databases"></a><span data-ttu-id="1f3f9-102">Aggiornare database replicati</span><span class="sxs-lookup"><span data-stu-id="1f3f9-102">Upgrade Replicated Databases</span></span>
  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="1f3f9-103">supporta l'aggiornamento di database replicati da versioni precedenti di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] senza che sia necessario, durante l'aggiornamento di un nodo, arrestare le attività negli altri nodi.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-103">supports upgrading replicated databases from previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]; it is not required to stop activity at other nodes while a node is being upgraded.</span></span> <span data-ttu-id="1f3f9-104">Verificare che vengano osservate le regole relative alle versioni supportate in una topologia:</span><span class="sxs-lookup"><span data-stu-id="1f3f9-104">Ensure that you adhere to the rules regarding which versions are supported in a topology:</span></span>  
  
-   <span data-ttu-id="1f3f9-105">La versione del server di distribuzione è indifferente, purché superiore o uguale alla versione del server di pubblicazione (in molti casi l'istanza del server di distribuzione è la stessa del server di pubblicazione).</span><span class="sxs-lookup"><span data-stu-id="1f3f9-105">A Distributor can be any version as long as it is greater than or equal to the Publisher version (in many cases the Distributor is the same instance as the Publisher).</span></span>  
  
-   <span data-ttu-id="1f3f9-106">La versione del server di pubblicazione è indifferente, purché inferiore o uguale alla versione del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-106">A Publisher can be any version as long as it less than or equal to the Distributor version.</span></span>  
  
-   <span data-ttu-id="1f3f9-107">La versione del Sottoscrittore dipende dal tipo di pubblicazione:</span><span class="sxs-lookup"><span data-stu-id="1f3f9-107">Subscriber version depends on the type of publication:</span></span>  
  
    -   <span data-ttu-id="1f3f9-108">La versione di un Sottoscrittore per una pubblicazione transazionale può essere una versione qualsiasi all'interno di un intervallo di due versioni, in base alla versione del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-108">A Subscriber to a transactional publication can be any version within two versions of the Publisher version.</span></span> <span data-ttu-id="1f3f9-109">Un server di pubblicazione [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], ad esempio, può disporre di Sottoscrittori [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], mentre un server di pubblicazione [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] può disporre di Sottoscrittori [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1f3f9-109">For example: a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] Publisher running can have [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Subscribers; and a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Publisher can have [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] Subscribers.</span></span>  
  
    -   <span data-ttu-id="1f3f9-110">Un Sottoscrittore a una pubblicazione di tipo merge può essere qualsiasi versione inferiore o uguale alla versione del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-110">A Subscriber to a merge publication can be any version less than or equal to the Publisher version.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1f3f9-111">Questo argomento è disponibile nella Guida del programma di installazione e nella documentazione online di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="1f3f9-111">This topic is available in the Setup Help documentation and in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online.</span></span> <span data-ttu-id="1f3f9-112">I collegamenti visualizzati in grassetto nella Guida del programma di installazione si riferiscono ad argomenti disponibili solo nella documentazione online.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-112">Topic links that appear as bold text in the Setup Help documentation refer to topics that are only available in Books Online.</span></span>  
  
## <a name="run-the-log-reader-agent-for-transactional-replication-before-upgrade"></a><span data-ttu-id="1f3f9-113">Esecuzione dell'agente di lettura log per la replica transazionale prima dell'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="1f3f9-113">Run the Log Reader Agent for Transactional Replication Before Upgrade</span></span>  
 <span data-ttu-id="1f3f9-114">Prima di eseguire l'aggiornamento a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], è necessario assicurarsi che tutte le transazioni completate dalle tabelle pubblicate siano state elaborate dall'agente di lettura log.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-114">Before you upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you must make sure that all committed transactions from published tables have been processed by the Log Reader Agent.</span></span> <span data-ttu-id="1f3f9-115">Per assicurarsi che tutte le transazioni siano state elaborate, eseguire i passaggi seguenti per ogni database che contiene pubblicazioni transazionali:</span><span class="sxs-lookup"><span data-stu-id="1f3f9-115">To make sure that all transactions have been processed, perform the following steps for each database that contains transactional publications:</span></span>  
  
1.  <span data-ttu-id="1f3f9-116">Verificare che l'agente di lettura log sia in esecuzione per il database.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-116">Make sure that the Log Reader Agent is running for the database.</span></span> <span data-ttu-id="1f3f9-117">Per impostazione predefinita, l'agente viene eseguito in modo continuativo.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-117">By default, the agent runs continuously.</span></span>  
  
2.  <span data-ttu-id="1f3f9-118">Arrestare l'attività dell'utente nelle tabelle pubblicate.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-118">Stop user activity on published tables.</span></span>  
  
3.  <span data-ttu-id="1f3f9-119">Concedere tempo all'agente di lettura log per copiare transazioni nel database di distribuzione, quindi arrestare l'agente.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-119">Allow time for the Log Reader Agent to copy transactions to the distribution database, and then stop the agent.</span></span>  
  
4.  <span data-ttu-id="1f3f9-120">Eseguire [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql) per verificare che siano state elaborate tutte le transazioni.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-120">Execute [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql) to verify that all transactions have been processed.</span></span> <span data-ttu-id="1f3f9-121">Il set di risultati restituito da questa procedura deve essere vuoto.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-121">The result set from this procedure should be empty.</span></span>  
  
5.  <span data-ttu-id="1f3f9-122">Eseguire [sp_replflush](/sql/relational-databases/system-stored-procedures/sp-replflush-transact-sql) per chiudere la connessione da sp_replcmds.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-122">Execute [sp_replflush](/sql/relational-databases/system-stored-procedures/sp-replflush-transact-sql) to close the connection from sp_replcmds.</span></span>  
  
6.  <span data-ttu-id="1f3f9-123">Eseguire l'aggiornamento del server a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1f3f9-123">Perform the server upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
7.  <span data-ttu-id="1f3f9-124">Riavviare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent e l'agente di lettura log se non vengono avviati automaticamente dopo l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-124">Restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent and the Log Reader Agent if they do not start automatically after the upgrade.</span></span>  
  
## <a name="run-agents-for-merge-replication-after-upgrade"></a><span data-ttu-id="1f3f9-125">Esecuzione degli agenti per una replica di tipo merge dopo l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="1f3f9-125">Run Agents for Merge Replication After Upgrade</span></span>  
 <span data-ttu-id="1f3f9-126">Al termine dell'aggiornamento, eseguire l'agente snapshot per ogni pubblicazione di tipo merge e l'agente di merge per ogni sottoscrizione in modo da aggiornare i metadati della replica.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-126">After upgrade, run the Snapshot Agent for each merge publication and the Merge Agent for each subscription to update replication metadata.</span></span> <span data-ttu-id="1f3f9-127">Non occorre applicare il nuovo snapshot in quanto non è necessario reinizializzare le sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-127">You do not have to apply the new snapshot, because it is not necessary to reinitialize subscriptions.</span></span> <span data-ttu-id="1f3f9-128">I metadati delle sottoscrizioni vengono aggiornati alla prima esecuzione dell'agente di merge successiva all'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-128">Subscription metadata is updated the first time the Merge Agent is run after upgrade.</span></span> <span data-ttu-id="1f3f9-129">Ciò significa che il database di sottoscrizione può rimanere online e attivo durante l'aggiornamento del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-129">This means that the subscription database can remain online and active during the Publisher upgrade.</span></span>  
  
 <span data-ttu-id="1f3f9-130">La replica di tipo merge archivia i metadati delle pubblicazioni e delle sottoscrizioni in alcune tabelle di sistema nei database di pubblicazione e sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-130">Merge replication stores publication and subscription metadata in a number of system tables in the publication and subscription databases.</span></span> <span data-ttu-id="1f3f9-131">L'esecuzione dell'agente snapshot aggiorna i metadati delle pubblicazioni e l'esecuzione dell'agente di merge aggiorna i metadati delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-131">Running the Snapshot Agent updates publication metadata and running the Merge Agent updates subscription metadata.</span></span> <span data-ttu-id="1f3f9-132">È semplicemente richiesta la generazione di uno snapshot di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-132">It is only required to generate a publication snapshot.</span></span> <span data-ttu-id="1f3f9-133">Se una pubblicazione di tipo merge utilizza filtri con parametri, ogni partizione includerà uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-133">If a merge publication uses parameterized filters, each partition also has a snapshot.</span></span> <span data-ttu-id="1f3f9-134">Non è necessario aggiornare gli snapshot partizionati.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-134">It is not necessary to update these partitioned snapshots.</span></span>  
  
 <span data-ttu-id="1f3f9-135">Eseguire gli agenti da [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], da Monitoraggio replica o dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-135">Run the agents from [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], Replication Monitor, or from the command line.</span></span> <span data-ttu-id="1f3f9-136">Per ulteriori informazioni sull'esecuzione dell'agente snapshot, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="1f3f9-136">For more information about running the Snapshot Agent, see the following topics:</span></span>  
  
-   [<span data-ttu-id="1f3f9-137">Creazione e applicazione dello snapshot iniziale</span><span class="sxs-lookup"><span data-stu-id="1f3f9-137">Create and Apply the Initial Snapshot</span></span>](../../../2014/relational-databases/replication/create-and-apply-the-initial-snapshot.md)  
  
-   [<span data-ttu-id="1f3f9-138">Avviare e arrestare un agente di replica &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="1f3f9-138">Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;</span></span>](../../relational-databases/replication/agents/start-and-stop-a-replication-agent-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="1f3f9-139">Creazione e applicazione dello snapshot iniziale</span><span class="sxs-lookup"><span data-stu-id="1f3f9-139">Create and Apply the Initial Snapshot</span></span>](../../../2014/relational-databases/replication/create-and-apply-the-initial-snapshot.md)  
  
-   [<span data-ttu-id="1f3f9-140">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="1f3f9-140">Replication Agent Executables Concepts</span></span>](../../../2014/relational-databases/replication/concepts/replication-agent-executables-concepts.md)  
  
 <span data-ttu-id="1f3f9-141">Per ulteriori informazioni sull'esecuzione dell'agente di merge, vedere gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="1f3f9-141">For more information about running the Merge Agent, see the following topics:</span></span>  
  
-   [<span data-ttu-id="1f3f9-142">Sincronizzazione di una sottoscrizione pull</span><span class="sxs-lookup"><span data-stu-id="1f3f9-142">Synchronize a Pull Subscription</span></span>](../../../2014/relational-databases/replication/synchronize-a-pull-subscription.md)  
  
-   [<span data-ttu-id="1f3f9-143">Sincronizzazione di una sottoscrizione push</span><span class="sxs-lookup"><span data-stu-id="1f3f9-143">Synchronize a Push Subscription</span></span>](../../../2014/relational-databases/replication/synchronize-a-push-subscription.md)  
  
 <span data-ttu-id="1f3f9-144">Al termine dell'aggiornamento di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in una topologia in cui viene utilizzata una replica di tipo merge, modificare il livello di compatibilità di tutte le pubblicazioni se si desidera utilizzare le nuove funzionalità.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-144">After upgrading [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in a topology that uses merge replication, change the publication compatibility level of any publications if you want to use new features.</span></span>  
  
## <a name="upgrading-to-standard-workgroup-or-express-editions"></a><span data-ttu-id="1f3f9-145">Aggiornamento alle versioni Standard, Workgroup o Express</span><span class="sxs-lookup"><span data-stu-id="1f3f9-145">Upgrading to Standard, Workgroup, or Express Editions</span></span>  
 <span data-ttu-id="1f3f9-146">Prima di eseguire l'aggiornamento da un'edizione all'altra di [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , verificare che le funzionalità utilizzate siano supportate nell'edizione a cui si esegue l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-146">Before upgrading from one edition of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] to another, verify that the functionality you are currently using is supported in the edition to which you are upgrading.</span></span> <span data-ttu-id="1f3f9-147">Per ulteriori informazioni, vedere la sezione sulla replica in [funzionalità supportate dalle edizioni di SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="1f3f9-147">For more information, see the section on Replication in [Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="web-synchronization-for-merge-replication"></a><span data-ttu-id="1f3f9-148">Sincronizzazione Web per la replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="1f3f9-148">Web Synchronization for Merge Replication</span></span>  
 <span data-ttu-id="1f3f9-149">L'opzione di sincronizzazione Web per la replica di tipo merge richiede che il listener per la replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (replisapi.dll) venga copiato nella directory virtuale nel server Internet Information Services (IIS) utilizzato per la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-149">The Web synchronization option for merge replication requires that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener (replisapi.dll) be copied to the virtual directory on the Internet Information Services (IIS) server used for synchronization.</span></span> <span data-ttu-id="1f3f9-150">Quando si configura la sincronizzazione Web, il file viene copiato nella directory virtuale dalla procedura di configurazione guidata della sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-150">When you configure Web synchronization, the file is copied to the virtual directory by the Configure Web Synchronization Wizard.</span></span> <span data-ttu-id="1f3f9-151">Se si aggiornano i componenti di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installati nel server IIS, è necessario copiare manualmente replisapi.dll dalla directory COM alla directory virtuale nel server IIS.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-151">If you upgrade the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] components installed on the IIS server, you must manually copy replisapi.dll from the COM directory to the virtual directory on the IIS server.</span></span> <span data-ttu-id="1f3f9-152">Per altre informazioni sulla configurazione della sincronizzazione Web, vedere [Configurazione della sincronizzazione Web](../../../2014/relational-databases/replication/configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="1f3f9-152">For more information about configuring Web synchronization, see [Configure Web Synchronization](../../../2014/relational-databases/replication/configure-web-synchronization.md).</span></span>  
  
## <a name="restoring-a-replicated-database-from-an-earlier-version"></a><span data-ttu-id="1f3f9-153">Ripristino di un database replicato da una versione precedente</span><span class="sxs-lookup"><span data-stu-id="1f3f9-153">Restoring a Replicated Database from an Earlier Version</span></span>  
 <span data-ttu-id="1f3f9-154">Per verificare che in seguito al ripristino del backup di un database replicato vengano mantenute le impostazioni di replica di una versione precedente, eseguire il ripristino in un server e un database con gli stessi nomi del server e del database utilizzati per la creazione della copia di backup.</span><span class="sxs-lookup"><span data-stu-id="1f3f9-154">To ensure replication settings are retained when restoring a backup of a replicated database from a previous version: restore to a server and database with the same names as the server and database at which the backup was taken.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1f3f9-155">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1f3f9-155">See Also</span></span>  
 <span data-ttu-id="1f3f9-156">[Domande frequenti sull'amministrazione della replica](../../relational-databases/replication/administration/frequently-asked-questions-for-replication-administrators.md) </span><span class="sxs-lookup"><span data-stu-id="1f3f9-156">[Replication Administration FAQ](../../relational-databases/replication/administration/frequently-asked-questions-for-replication-administrators.md) </span></span>  
 <span data-ttu-id="1f3f9-157">[Compatibilità con le versioni precedenti della replica](../../../2014/relational-databases/replication/replication-backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="1f3f9-157">[Replication Backward Compatibility](../../../2014/relational-databases/replication/replication-backward-compatibility.md) </span></span>  
 <span data-ttu-id="1f3f9-158">[Aggiornamenti di versione ed edizione supportati](../../database-engine/install-windows/supported-version-and-edition-upgrades.md) </span><span class="sxs-lookup"><span data-stu-id="1f3f9-158">[Supported Version and Edition Upgrades](../../database-engine/install-windows/supported-version-and-edition-upgrades.md) </span></span>  
 [<span data-ttu-id="1f3f9-159">Aggiornamento a SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="1f3f9-159">Upgrade to SQL Server 2014</span></span>](upgrade-sql-server.md)  
  
  
