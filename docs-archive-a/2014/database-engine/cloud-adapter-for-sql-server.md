---
title: adattatore del cloud per SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- Cloud adapter
- Deploy to Azure
ms.assetid: 82ed0d0f-952d-4d49-aa36-3855a3ca9877
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: d5716435bb1db494bdabeb45ed366c1783926989
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87630069"
---
# <a name="cloud-adapter-for-sql-server"></a><span data-ttu-id="d6490-102">Adattatore cloud per SQL Server</span><span class="sxs-lookup"><span data-stu-id="d6490-102">Cloud Adapter for SQL Server</span></span>
  <span data-ttu-id="d6490-103">Il servizio adattatore del cloud viene creato come parte del [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provisioning in una macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="d6490-103">The Cloud Adapter service is created as part of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provisioning on an Azure VM.</span></span> <span data-ttu-id="d6490-104">Il servizio Adattatore del cloud genera un certificato SSL autofirmato quando viene eseguito per la prima volta, quindi viene eseguito come account di **sistema locale** .</span><span class="sxs-lookup"><span data-stu-id="d6490-104">The Cloud Adapter service generates a self-signed SSL certificate as part of its first run, and then runs as a **Local System** account.</span></span> <span data-ttu-id="d6490-105">Genera un file di configurazione utilizzato per autoconfigurarsi.</span><span class="sxs-lookup"><span data-stu-id="d6490-105">It generates a configuration file that is used to configure itself.</span></span> <span data-ttu-id="d6490-106">L’adattatore cloud crea inoltre una regola di Windows Firewall per consentire le connessioni TCP in entrata alla porta 11435 predefinita.</span><span class="sxs-lookup"><span data-stu-id="d6490-106">The Cloud Adapter also creates a Windows Firewall rule to allow its incoming TCP connections at default port 11435.</span></span>  
  
 <span data-ttu-id="d6490-107">L'adattatore cloud è un servizio senza stato e sincrono tramite cui si ricevono i messaggi da un'istanza locale di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d6490-107">The Cloud Adapter is a stateless, synchronous service that receives messages from the on-premise instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d6490-108">Quando il servizio adattatore cloud viene arrestato, l'adattatore cloud con accesso remoto viene arrestato, l'associazione del certificato SSL viene annullata e la regola di Windows Firewall viene disabilitata.</span><span class="sxs-lookup"><span data-stu-id="d6490-108">When the Cloud Adapter service is stopped, it stops the remote access Cloud Adapter, unbinds the SSL certificate, and disables the Windows Firewall rule.</span></span>  
  
## <a name="cloud-adapter-requirements"></a><span data-ttu-id="d6490-109">Requisiti dell'adattatore cloud</span><span class="sxs-lookup"><span data-stu-id="d6490-109">Cloud Adapter Requirements</span></span>  
 <span data-ttu-id="d6490-110">Per installare, abilitare ed eseguire l'adattatore cloud per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], è necessario tenere in considerazione i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="d6490-110">Note the following requirements to install, enable, and run the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="d6490-111">L'adattatore cloud è supportato con [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="d6490-111">Cloud Adapter is supported with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 and higher.</span></span> <span data-ttu-id="d6490-112">In [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012, per l'adattatore cloud per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] è necessario SMO (SQL Management Objects) per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="d6490-112">On [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012, the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] requires SQL Management Objects for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.</span></span>  
  
-   <span data-ttu-id="d6490-113">Il servizio Web Adattatore del cloud viene eseguito come account di **sistema locale** e verifica le credenziali del client prima dell'esecuzione di qualsiasi attività.</span><span class="sxs-lookup"><span data-stu-id="d6490-113">Cloud Adapter web service runs as a **Local System** account and verifies client credentials before executing any task.</span></span> <span data-ttu-id="d6490-114">Le credenziali fornite dal client devono appartenere all'account use membro del gruppo **Administrators** locale nel computer remoto.</span><span class="sxs-lookup"><span data-stu-id="d6490-114">Credentials supplied by the client must belong to the use account that is a member of the local **Administrators** group on the remote machine.</span></span>  
  
-   <span data-ttu-id="d6490-115">L'adattatore cloud supporta solo l'autenticazione di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d6490-115">Cloud Adapter supports only [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication.</span></span>  
  
-   <span data-ttu-id="d6490-116">L'adattatore cloud utilizza l'account amministratore locale della macchina virtuale per eseguire i comandi nel computer locale e non un account amministratore di sistema.</span><span class="sxs-lookup"><span data-stu-id="d6490-116">Cloud Adapter uses VM local administrator account to execute commands on the local machine, not an sa account.</span></span>  
  
-   <span data-ttu-id="d6490-117">L'adattatore cloud è in attesa su TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="d6490-117">Cloud Adapter listens on TCP/IP.</span></span> <span data-ttu-id="d6490-118">Il numero di porta predefinito è 11435.</span><span class="sxs-lookup"><span data-stu-id="d6490-118">The default port is 11435.</span></span>  
  
-   <span data-ttu-id="d6490-119">L'adattatore cloud deve disporre delle autorizzazioni per creare e modificare le regole di Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="d6490-119">Cloud Adapter must have permissions to create and modify Windows Firewall rules.</span></span>  
  
## <a name="cloud-adapter-configuration-settings"></a><span data-ttu-id="d6490-120">Impostazioni di configurazione dell'adattatore cloud</span><span class="sxs-lookup"><span data-stu-id="d6490-120">Cloud Adapter Configuration Settings</span></span>  
 <span data-ttu-id="d6490-121">Per modificare le impostazioni di un adattatore cloud, utilizzare le informazioni sulla configurazione dell'adattatore cloud riportate di seguito.</span><span class="sxs-lookup"><span data-stu-id="d6490-121">Use the following Cloud Adapter configuration details to modify settings for a Cloud Adapter.</span></span>  
  
-   <span data-ttu-id="d6490-122">**Percorso predefinito del file di configurazione** : C:\Programmi\Microsoft SQL Server\120\Tools\CloudAdapter</span><span class="sxs-lookup"><span data-stu-id="d6490-122">**Default path for the configuration file** - C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter</span></span>\  
  
-   <span data-ttu-id="d6490-123">**Parametri del file di configurazione** -</span><span class="sxs-lookup"><span data-stu-id="d6490-123">**Configuration file parameters** -</span></span>  
  
    -   \<configuration>  
  
        -   \<appSettings>  
  
            -   \<add key="WebServicePort" value="" />  
  
            -   \<add key="WebServiceCertificate" value="GUID" />  
  
            -   \<add key="ExposeExceptionDetails" value="true" />  
  
        -   \</appSettings>  
  
    -   \</configuration>  
  
-   <span data-ttu-id="d6490-124">**Dettagli del certificato** : il certificato presenta i valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="d6490-124">**Certificate details** - The certificate has the following values:</span></span>  
  
    -   <span data-ttu-id="d6490-125">Subject-"CN = CloudAdapter \<VMName> , DC = SQL Server, DC = Microsoft"</span><span class="sxs-lookup"><span data-stu-id="d6490-125">Subject - "CN=CloudAdapter\<VMName>, DC=SQL Server, DC=Microsoft"</span></span>  
  
    -   <span data-ttu-id="d6490-126">Il certificato deve disporre di un solo utilizzo chiavi avanzato (EKU) nell'attributo Autenticazione server.</span><span class="sxs-lookup"><span data-stu-id="d6490-126">The certificate should have only Server Authentication EKU enabled.</span></span>  
  
    -   <span data-ttu-id="d6490-127">La lunghezza della chiave del certificato è 2048.</span><span class="sxs-lookup"><span data-stu-id="d6490-127">The certificate key length is 2048.</span></span>  
  
 <span data-ttu-id="d6490-128">**Valori del file di configurazione**:</span><span class="sxs-lookup"><span data-stu-id="d6490-128">**Configuration file values**:</span></span>  
  
|<span data-ttu-id="d6490-129">Impostazione</span><span class="sxs-lookup"><span data-stu-id="d6490-129">Setting</span></span>|<span data-ttu-id="d6490-130">Valori</span><span class="sxs-lookup"><span data-stu-id="d6490-130">Values</span></span>|<span data-ttu-id="d6490-131">Predefinito</span><span class="sxs-lookup"><span data-stu-id="d6490-131">Default</span></span>|<span data-ttu-id="d6490-132">Commenti</span><span class="sxs-lookup"><span data-stu-id="d6490-132">Comments</span></span>|  
|-------------|------------|-------------|--------------|  
|<span data-ttu-id="d6490-133">WebServicePort</span><span class="sxs-lookup"><span data-stu-id="d6490-133">WebServicePort</span></span>|<span data-ttu-id="d6490-134">1-65535</span><span class="sxs-lookup"><span data-stu-id="d6490-134">1-65535</span></span>|<span data-ttu-id="d6490-135">11435</span><span class="sxs-lookup"><span data-stu-id="d6490-135">11435</span></span>|<span data-ttu-id="d6490-136">Se omesso, viene utilizzato 11435.</span><span class="sxs-lookup"><span data-stu-id="d6490-136">If not specified, use 11435.</span></span>|  
|<span data-ttu-id="d6490-137">WebServiceCertificate</span><span class="sxs-lookup"><span data-stu-id="d6490-137">WebServiceCertificate</span></span>|<span data-ttu-id="d6490-138">Identificazione personale</span><span class="sxs-lookup"><span data-stu-id="d6490-138">Thumbprint</span></span>|<span data-ttu-id="d6490-139">Empty</span><span class="sxs-lookup"><span data-stu-id="d6490-139">Empty</span></span>|<span data-ttu-id="d6490-140">Se vuoto, viene generato un nuovo certificato autofirmato.</span><span class="sxs-lookup"><span data-stu-id="d6490-140">If empty, a new self-signed certificate is generated.</span></span>|  
|<span data-ttu-id="d6490-141">ExposeExceptionDetails</span><span class="sxs-lookup"><span data-stu-id="d6490-141">ExposeExceptionDetails</span></span>|<span data-ttu-id="d6490-142">True/False</span><span class="sxs-lookup"><span data-stu-id="d6490-142">True/False</span></span>|<span data-ttu-id="d6490-143">Falso</span><span class="sxs-lookup"><span data-stu-id="d6490-143">False</span></span>||  
  
## <a name="cloud-adapter-troubleshooting"></a><span data-ttu-id="d6490-144">Risoluzione dei problemi dell'adattatore cloud</span><span class="sxs-lookup"><span data-stu-id="d6490-144">Cloud Adapter Troubleshooting</span></span>  
 <span data-ttu-id="d6490-145">Per risolvere i problemi relativi all'adattatore cloud per [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], fare riferimento alle informazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="d6490-145">Use the following information to troubleshoot the Cloud Adapter for [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="d6490-146">**Gestione degli errori e registrazione** : gli errori e i messaggi di stato vengono scritti nel registro eventi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d6490-146">**Error handling and logging** - Errors and status messages are written to the Application Event Log.</span></span>  
  
-   <span data-ttu-id="d6490-147">**Traccia, eventi** : tutti gli eventi vengono scritti nel registro eventi dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d6490-147">**Tracing, Events** - All events are written to the Application Event Log.</span></span>  
  
-   <span data-ttu-id="d6490-148">**Controllo, configurazione** : usare il file di configurazione che si trova in: C:\Programmi\Microsoft SQL Server\120\Tools\CloudAdapter \\ .</span><span class="sxs-lookup"><span data-stu-id="d6490-148">**Control, configuration** - Use the configuration file located in:  C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter\\.</span></span>  
  
|<span data-ttu-id="d6490-149">Errore</span><span class="sxs-lookup"><span data-stu-id="d6490-149">Error</span></span>|<span data-ttu-id="d6490-150">ID errore</span><span class="sxs-lookup"><span data-stu-id="d6490-150">Error ID</span></span>|<span data-ttu-id="d6490-151">Causa</span><span class="sxs-lookup"><span data-stu-id="d6490-151">Cause</span></span>|<span data-ttu-id="d6490-152">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="d6490-152">Resolution</span></span>|  
|-----------|--------------|-----------|----------------|  
|<span data-ttu-id="d6490-153">Si è verificata un'eccezione durante l'aggiunta del certificato all'archivio certificati.</span><span class="sxs-lookup"><span data-stu-id="d6490-153">There was an exception while adding the certificate to the certificate store.</span></span> <span data-ttu-id="d6490-154">{Testo dell'eccezione}.</span><span class="sxs-lookup"><span data-stu-id="d6490-154">{Exception text}.</span></span>|<span data-ttu-id="d6490-155">45560</span><span class="sxs-lookup"><span data-stu-id="d6490-155">45560</span></span>|<span data-ttu-id="d6490-156">Autorizzazioni per l'archiviazione dei certificati del computer</span><span class="sxs-lookup"><span data-stu-id="d6490-156">Machine certificate store permissions</span></span>|<span data-ttu-id="d6490-157">Verificare che il servizio adattatore cloud disponga delle autorizzazioni per aggiungere i certificati all'archivio certificati del computer.</span><span class="sxs-lookup"><span data-stu-id="d6490-157">Ensure that the Cloud Adapter service has permissions to add certificates to the machine certificate store.</span></span>|  
|<span data-ttu-id="d6490-158">Si è verificata un'eccezione durante il tentativo di configurare l'associazione SSL per la porta {numero di porta} e il certificato {Identificazione digitale}.</span><span class="sxs-lookup"><span data-stu-id="d6490-158">There was an exception while trying to configure the SSL binding for port {Port number} and certificate {Thumbprint}.</span></span> <span data-ttu-id="d6490-159">{Eccezione}.</span><span class="sxs-lookup"><span data-stu-id="d6490-159">{Exception}.</span></span>|<span data-ttu-id="d6490-160">45561</span><span class="sxs-lookup"><span data-stu-id="d6490-160">45561</span></span>|<span data-ttu-id="d6490-161">Un'altra applicazione ha già utilizzato la porta o vi ha già associato un certificato.</span><span class="sxs-lookup"><span data-stu-id="d6490-161">Another application has already used the port or bound a certificate to it.</span></span>|<span data-ttu-id="d6490-162">Rimuovere le associazioni esistenti o modificare la porta dell'adattatore cloud nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d6490-162">Remove existing bindings or change Cloud Adapter port in the configuration file.</span></span>|  
|<span data-ttu-id="d6490-163">Impossibile trovare il certificato SSL [{Identificazione digitale}] nell'archivio certificati.</span><span class="sxs-lookup"><span data-stu-id="d6490-163">Failed to find SSL certificate [{Thumbprint}] in the certificate store.</span></span>|<span data-ttu-id="d6490-164">45564</span><span class="sxs-lookup"><span data-stu-id="d6490-164">45564</span></span>|<span data-ttu-id="d6490-165">L'identificazione digitale del certificato è nel file di configurazione, ma l'archivio certificati personale per il servizio non contiene il certificato.</span><span class="sxs-lookup"><span data-stu-id="d6490-165">Certificate thumbprint is in the configuration file, but personal certificate store for the service does not contain certificate.</span></span><br /><br /> <span data-ttu-id="d6490-166">Autorizzazioni insufficienti.</span><span class="sxs-lookup"><span data-stu-id="d6490-166">Insufficient permissions.</span></span>|<span data-ttu-id="d6490-167">Verificare che il certificato sia nell'archivio certificati personale per il servizio.</span><span class="sxs-lookup"><span data-stu-id="d6490-167">Make sure the certificate is in the personal certificate store for the service.</span></span><br /><br /> <span data-ttu-id="d6490-168">Verificare che il servizio disponga delle autorizzazioni corrette per l'archivio.</span><span class="sxs-lookup"><span data-stu-id="d6490-168">Make sure the service has correct permissions for the store.</span></span>|  
|<span data-ttu-id="d6490-169">Impossibile avviare il servizio Web.</span><span class="sxs-lookup"><span data-stu-id="d6490-169">Failed to start the web service.</span></span> <span data-ttu-id="d6490-170">{Testo dell'eccezione}.</span><span class="sxs-lookup"><span data-stu-id="d6490-170">{Exception text}.</span></span>|<span data-ttu-id="d6490-171">45570</span><span class="sxs-lookup"><span data-stu-id="d6490-171">45570</span></span>|<span data-ttu-id="d6490-172">Descritto nell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="d6490-172">Described in the exception.</span></span>|<span data-ttu-id="d6490-173">Abilitare ExposeExceptionDetails e utilizzare le informazioni estese dell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="d6490-173">Enable ExposeExceptionDetails and use extended information from the exception.</span></span>|  
|<span data-ttu-id="d6490-174">Il certificato [{Identificazione digitale}] è scaduto.</span><span class="sxs-lookup"><span data-stu-id="d6490-174">Certificate [{Thumbprint}] has expired.</span></span>|<span data-ttu-id="d6490-175">45565</span><span class="sxs-lookup"><span data-stu-id="d6490-175">45565</span></span>|<span data-ttu-id="d6490-176">Si fa riferimento a un certificato scaduto nel file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d6490-176">Expired certificate referenced from the configuration file.</span></span>|<span data-ttu-id="d6490-177">Aggiungere un certificato valido e aggiornare il file di configurazione con la relativa identificazione digitale.</span><span class="sxs-lookup"><span data-stu-id="d6490-177">Add a valid certificate and update the configuration file with its thumbprint.</span></span>|  
|<span data-ttu-id="d6490-178">Errore del servizio Web: {0} .</span><span class="sxs-lookup"><span data-stu-id="d6490-178">Web service error: {0}.</span></span>|<span data-ttu-id="d6490-179">45571</span><span class="sxs-lookup"><span data-stu-id="d6490-179">45571</span></span>|<span data-ttu-id="d6490-180">Descritto nell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="d6490-180">Described in the exception.</span></span>|<span data-ttu-id="d6490-181">Abilitare ExposeExceptionDetails e utilizzare le informazioni estese dell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="d6490-181">Enable ExposeExceptionDetails and use extended information from the exception.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="d6490-182">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="d6490-182">See Also</span></span>  
 [<span data-ttu-id="d6490-183">Distribuire un database di SQL Server a una macchina virtuale di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="d6490-183">Deploy a SQL Server Database to a Microsoft Azure Virtual Machine</span></span>](../relational-databases/databases/deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine.md)  
  
  
