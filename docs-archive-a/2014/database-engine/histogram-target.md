---
title: Destinazione istogramma | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- bucketing target [SQL Server extended events]
- event bucketing target
- targets [SQL Server extended events], bucketing
ms.assetid: 2ea39141-7eb0-4c74-abf8-114c2c106a19
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: acb124ef949849561a6bca0ba4016b40c1343384
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87715691"
---
# <a name="histogram-target"></a><span data-ttu-id="ba68a-102">Destinazione dell'istogramma</span><span class="sxs-lookup"><span data-stu-id="ba68a-102">Histogram Target</span></span>
  <span data-ttu-id="ba68a-103">La destinazione dell'istogramma raggruppa le occorrenze di un tipo di evento specifico in base ai dati relativi all'evento.</span><span class="sxs-lookup"><span data-stu-id="ba68a-103">The histogram target groups occurrences of a specific event type based on event data.</span></span> <span data-ttu-id="ba68a-104">I raggruppamenti di eventi sono conteggiati in base a una colonna di evento oppure a un'azione specificata.</span><span class="sxs-lookup"><span data-stu-id="ba68a-104">The groupings of events are counted based on a specified event column or action.</span></span> <span data-ttu-id="ba68a-105">È possibile utilizzare la destinazione dell'istogramma dell'evento per risolvere i problemi relativi alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="ba68a-105">You can use the histogram target to troubleshoot performance issues.</span></span> <span data-ttu-id="ba68a-106">Grazie all'identificazione degli eventi che si verificano più di frequente, è infatti possibile individuare elementi specifici che indicano la causa potenziale di un problema relativo alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="ba68a-106">By identifying which events are occurring most frequently, you can find "hotspots" that indicate a potential cause of a performance problem.</span></span>  
  
 <span data-ttu-id="ba68a-107">Nella tabella seguente vengono descritte le opzioni che consentono di configurare la destinazione dell'istogramma.</span><span class="sxs-lookup"><span data-stu-id="ba68a-107">The following table describes the options that can be used to configure the histogram target.</span></span>  
  
|<span data-ttu-id="ba68a-108">Opzione</span><span class="sxs-lookup"><span data-stu-id="ba68a-108">Option</span></span>|<span data-ttu-id="ba68a-109">Valori consentiti</span><span class="sxs-lookup"><span data-stu-id="ba68a-109">Allowed values</span></span>|<span data-ttu-id="ba68a-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="ba68a-110">Description</span></span>|  
|------------|--------------------|-----------------|  
|<span data-ttu-id="ba68a-111">slot</span><span class="sxs-lookup"><span data-stu-id="ba68a-111">slots</span></span>|<span data-ttu-id="ba68a-112">Qualsiasi valore intero.</span><span class="sxs-lookup"><span data-stu-id="ba68a-112">Any integer value.</span></span> <span data-ttu-id="ba68a-113">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="ba68a-113">This value is optional.</span></span>|<span data-ttu-id="ba68a-114">Valore specificato dall'utente che indica il numero massimo di raggruppamenti da mantenere.</span><span class="sxs-lookup"><span data-stu-id="ba68a-114">A user-specified value indicating the maximum number of groupings to retain.</span></span> <span data-ttu-id="ba68a-115">Quando questo valore viene raggiunto, i nuovi eventi che non appartengono ai gruppi esistenti vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="ba68a-115">When this value is reached, new events that do not belong to the existing groups are ignored.</span></span><br /><br /> <span data-ttu-id="ba68a-116">Si noti che per migliorare le prestazioni, il numero di slot viene arrotondato alla potenza di 2 più vicina.</span><span class="sxs-lookup"><span data-stu-id="ba68a-116">Note that to improve performance, the slot number is rounded up to the next power of 2.</span></span>|  
|<span data-ttu-id="ba68a-117">filtering_event_name</span><span class="sxs-lookup"><span data-stu-id="ba68a-117">filtering_event_name</span></span>|<span data-ttu-id="ba68a-118">Qualsiasi evento presente nella sessione degli eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="ba68a-118">Any event present in the Extended Events session.</span></span> <span data-ttu-id="ba68a-119">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="ba68a-119">This value is optional.</span></span>|<span data-ttu-id="ba68a-120">Valore specificato dall'utente utilizzato per identificare una classe di eventi.</span><span class="sxs-lookup"><span data-stu-id="ba68a-120">A user-specified value that is used to identify a class of events.</span></span> <span data-ttu-id="ba68a-121">Nel bucket vengono inserite solo le istanze dell'evento specificato.</span><span class="sxs-lookup"><span data-stu-id="ba68a-121">Only instances of the specified event are bucketed.</span></span> <span data-ttu-id="ba68a-122">Tutti gli altri eventi vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="ba68a-122">All other events are ignored.</span></span><br /><br /> <span data-ttu-id="ba68a-123">Se si specifica questo valore, è necessario usare il formato *nome_pacchetto*.*nome_evento*, ad esempio `'sqlserver.checkpoint_end'`.</span><span class="sxs-lookup"><span data-stu-id="ba68a-123">If you specify this value, you must use the format: *package_name*.*event_name*, for example `'sqlserver.checkpoint_end'`.</span></span> <span data-ttu-id="ba68a-124">Per identificare il nome del pacchetto, è possibile utilizzare la query seguente:</span><span class="sxs-lookup"><span data-stu-id="ba68a-124">You can identify the package name by using the following query:</span></span><br /><br /> <span data-ttu-id="ba68a-125">SELEZIONARE p.name, se. event_name</span><span class="sxs-lookup"><span data-stu-id="ba68a-125">SELECT p.name, se.event_name</span></span><br /><span data-ttu-id="ba68a-126">DA sys. dm_xe_session_events se</span><span class="sxs-lookup"><span data-stu-id="ba68a-126">FROM sys.dm_xe_session_events se</span></span><br /><span data-ttu-id="ba68a-127">JOIN sys. dm_xe_packages p</span><span class="sxs-lookup"><span data-stu-id="ba68a-127">JOIN sys.dm_xe_packages p</span></span><br /><span data-ttu-id="ba68a-128">IN se_event_package_guid = p. Guid</span><span class="sxs-lookup"><span data-stu-id="ba68a-128">ON se_event_package_guid = p.guid</span></span><br /><span data-ttu-id="ba68a-129">ORDER BY p.name, se. event_name</span><span class="sxs-lookup"><span data-stu-id="ba68a-129">ORDER BY p.name, se.event_name</span></span><br /><br /> <br /><br /> <span data-ttu-id="ba68a-130">Se non si specifica il valore filtering_event_name, l'opzione source_type deve essere impostata su 1 (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="ba68a-130">If you do not specify the filtering_event_name value, source_type must be set to 1 (the default).</span></span>|  
|<span data-ttu-id="ba68a-131">source_type</span><span class="sxs-lookup"><span data-stu-id="ba68a-131">source_type</span></span>|<span data-ttu-id="ba68a-132">Tipo di oggetto su cui è basato il bucket.</span><span class="sxs-lookup"><span data-stu-id="ba68a-132">The type of object that the bucket is based on.</span></span> <span data-ttu-id="ba68a-133">Si tratta di un valore facoltativo che, se non è specificato, assumerà il valore predefinito 1.</span><span class="sxs-lookup"><span data-stu-id="ba68a-133">This value is optional and if not specified has a default value of 1.</span></span>|<span data-ttu-id="ba68a-134">I valori consentiti sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba68a-134">Can have one of the following values:</span></span><br /><br /> <span data-ttu-id="ba68a-135">0 per un evento</span><span class="sxs-lookup"><span data-stu-id="ba68a-135">0 for an event</span></span><br /><br /> <span data-ttu-id="ba68a-136">1 per un'azione</span><span class="sxs-lookup"><span data-stu-id="ba68a-136">1 for an action</span></span>|  
|<span data-ttu-id="ba68a-137">source</span><span class="sxs-lookup"><span data-stu-id="ba68a-137">source</span></span>|<span data-ttu-id="ba68a-138">Colonna di evento o nome dell'azione.</span><span class="sxs-lookup"><span data-stu-id="ba68a-138">Event column or action name.</span></span>|<span data-ttu-id="ba68a-139">Colonna di evento o nome dell'azione utilizzato come origine dati.</span><span class="sxs-lookup"><span data-stu-id="ba68a-139">The event column or action name that is used as the data source.</span></span><br /><br /> <span data-ttu-id="ba68a-140">Quando si specifica una colonna di evento per origine, è necessario specificare una colonna dall'evento utilizzato per il valore filtering_event_name.</span><span class="sxs-lookup"><span data-stu-id="ba68a-140">When you specify an event column for source, you must specify a column from the event that is used for the filtering_event_name value.</span></span> <span data-ttu-id="ba68a-141">Per identificare le possibili colonne, utilizzare la query seguente:</span><span class="sxs-lookup"><span data-stu-id="ba68a-141">You can identify the potential columns by using the following query:</span></span><br /><br /> <span data-ttu-id="ba68a-142">Selezionare il nome da sys. dm_xe_object_columns</span><span class="sxs-lookup"><span data-stu-id="ba68a-142">SELECT name FROM sys.dm_xe_object_columns</span></span><br /><span data-ttu-id="ba68a-143">DOVE object_name =' \<eventname> '</span><span class="sxs-lookup"><span data-stu-id="ba68a-143">WHERE object_name = '\<eventname>'</span></span><br /><span data-ttu-id="ba68a-144">E column_type! =' ReadOnly '</span><span class="sxs-lookup"><span data-stu-id="ba68a-144">AND column_type != 'readonly'</span></span><br /><br /> <span data-ttu-id="ba68a-145">Quando si specifica una colonna di evento per origine, non è necessario includere il nome del pacchetto nel valore dell'origine.</span><span class="sxs-lookup"><span data-stu-id="ba68a-145">When you specify an event column for source, you do not have to include the package name in the source value.</span></span><br /><br /> <span data-ttu-id="ba68a-146">Quando si specifica un nome di azione per origine, è necessario utilizzare una delle azioni configurate per la raccolta nella sessione eventi per cui viene utilizzata la destinazione specifica.</span><span class="sxs-lookup"><span data-stu-id="ba68a-146">When you specify an action name for source, you must use one of the actions that is configured for collection in the event session for which this target is being used.</span></span> <span data-ttu-id="ba68a-147">Per individuare valori potenziali per il nome di azione, è possibile eseguire una query sulla colonna action_name della vista sys.dm_xe_sesssion_event_actions.</span><span class="sxs-lookup"><span data-stu-id="ba68a-147">To find potential values for the action name, you can query the action_name column of the sys.dm_xe_sesssion_event_actions view.</span></span><br /><br /> <span data-ttu-id="ba68a-148">Se si usa un nome di azione come origine dati, è necessario specificare il valore dell'origine nel formato *nome_pacchetto*.*nome_azione*.</span><span class="sxs-lookup"><span data-stu-id="ba68a-148">If you are using an action name as the data source, you must specify the source value by using the format: *package_name*.*action_name*.</span></span>|  
  
 <span data-ttu-id="ba68a-149">Nell'esempio seguente viene illustrato, a un livello elevato, il modo in cui i dati vengono raccolti nella destinazione dell'istogramma.</span><span class="sxs-lookup"><span data-stu-id="ba68a-149">The following example illustrates at a high level how the histogram target collects data.</span></span> <span data-ttu-id="ba68a-150">Nell'esempio la destinazione dell'istogramma viene utilizzata per contare il numero di volte in cui si verifica ogni tipo di attesa.</span><span class="sxs-lookup"><span data-stu-id="ba68a-150">In this example, you want to use the histogram target to count how many waits of each wait type occurred.</span></span> <span data-ttu-id="ba68a-151">A tale scopo, è necessario specificare le opzioni seguenti quando si definisce la destinazione dell'istogramma:</span><span class="sxs-lookup"><span data-stu-id="ba68a-151">To do this, you would specify the following options when you define the histogram target:</span></span>  
  
-   <span data-ttu-id="ba68a-152">filtering_event_name = 'wait_info'</span><span class="sxs-lookup"><span data-stu-id="ba68a-152">filtering_event_name = 'wait_info'</span></span>  
  
-   <span data-ttu-id="ba68a-153">source = 'wait_type'</span><span class="sxs-lookup"><span data-stu-id="ba68a-153">source = 'wait_type'</span></span>  
  
-   <span data-ttu-id="ba68a-154">source_type = 0 (poiché wait_type è una colonna di evento)</span><span class="sxs-lookup"><span data-stu-id="ba68a-154">source_type = 0 (because wait_type is an event column)</span></span>  
  
 <span data-ttu-id="ba68a-155">Nello scenario di esempio per l'origine wait_type vengono registrati i dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba68a-155">In the example scenario, the following data is recorded for the wait_type source.</span></span>  
  
|<span data-ttu-id="ba68a-156">Nome evento di filtro</span><span class="sxs-lookup"><span data-stu-id="ba68a-156">Filtering event name</span></span>|<span data-ttu-id="ba68a-157">Valore colonna di origine</span><span class="sxs-lookup"><span data-stu-id="ba68a-157">Source column value</span></span>|  
|--------------------------|-------------------------|  
|<span data-ttu-id="ba68a-158">wait_info</span><span class="sxs-lookup"><span data-stu-id="ba68a-158">wait_info</span></span>|<span data-ttu-id="ba68a-159">file_io</span><span class="sxs-lookup"><span data-stu-id="ba68a-159">file_io</span></span>|  
|<span data-ttu-id="ba68a-160">wait_info</span><span class="sxs-lookup"><span data-stu-id="ba68a-160">wait_info</span></span>|<span data-ttu-id="ba68a-161">file_io</span><span class="sxs-lookup"><span data-stu-id="ba68a-161">file_io</span></span>|  
|<span data-ttu-id="ba68a-162">wait_info</span><span class="sxs-lookup"><span data-stu-id="ba68a-162">wait_info</span></span>|<span data-ttu-id="ba68a-163">network</span><span class="sxs-lookup"><span data-stu-id="ba68a-163">network</span></span>|  
|<span data-ttu-id="ba68a-164">wait_info</span><span class="sxs-lookup"><span data-stu-id="ba68a-164">wait_info</span></span>|<span data-ttu-id="ba68a-165">network</span><span class="sxs-lookup"><span data-stu-id="ba68a-165">network</span></span>|  
|<span data-ttu-id="ba68a-166">wait_info</span><span class="sxs-lookup"><span data-stu-id="ba68a-166">wait_info</span></span>|<span data-ttu-id="ba68a-167">sleep</span><span class="sxs-lookup"><span data-stu-id="ba68a-167">sleep</span></span>|  
  
 <span data-ttu-id="ba68a-168">I valori relativi al tipo di attesa verranno suddivisi in tre slot, cui sono associati i valori e i conteggi di slot seguenti:</span><span class="sxs-lookup"><span data-stu-id="ba68a-168">The wait type values would be categorized into three slots, with the following values and slot counts:</span></span>  
  
|<span data-ttu-id="ba68a-169">Valore</span><span class="sxs-lookup"><span data-stu-id="ba68a-169">Value</span></span>|<span data-ttu-id="ba68a-170">Conteggio di slot</span><span class="sxs-lookup"><span data-stu-id="ba68a-170">Slot count</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="ba68a-171">file_io</span><span class="sxs-lookup"><span data-stu-id="ba68a-171">file_io</span></span>|<span data-ttu-id="ba68a-172">2</span><span class="sxs-lookup"><span data-stu-id="ba68a-172">2</span></span>|  
|<span data-ttu-id="ba68a-173">network</span><span class="sxs-lookup"><span data-stu-id="ba68a-173">network</span></span>|<span data-ttu-id="ba68a-174">2</span><span class="sxs-lookup"><span data-stu-id="ba68a-174">2</span></span>|  
|<span data-ttu-id="ba68a-175">sleep</span><span class="sxs-lookup"><span data-stu-id="ba68a-175">sleep</span></span>|<span data-ttu-id="ba68a-176">1</span><span class="sxs-lookup"><span data-stu-id="ba68a-176">1</span></span>|  
  
 <span data-ttu-id="ba68a-177">Nella destinazione dell'istogramma vengono mantenuti solo i dati degli eventi per l'origine specificata.</span><span class="sxs-lookup"><span data-stu-id="ba68a-177">The histogram target only retains event data for the specified source.</span></span> <span data-ttu-id="ba68a-178">Nel caso in cui le dimensioni dei dati degli eventi siano troppo elevate per mantenere completamente i dati, questi ultimi vengono troncati.</span><span class="sxs-lookup"><span data-stu-id="ba68a-178">In some cases the event data may be too large to retain completely, in which case the data is truncated.</span></span> <span data-ttu-id="ba68a-179">Quando i dati degli eventi sono troncati, il numero di byte è registrato e visualizzato come output XML.</span><span class="sxs-lookup"><span data-stu-id="ba68a-179">When event data is truncated, the number of bytes is recorded and displayed as XML output.</span></span>  
  
## <a name="adding-the-target-to-a-session"></a><span data-ttu-id="ba68a-180">Aggiunta della destinazione a una sessione</span><span class="sxs-lookup"><span data-stu-id="ba68a-180">Adding the Target to a Session</span></span>  
 <span data-ttu-id="ba68a-181">Per aggiungere la destinazione dell'istogramma a una sessione di eventi estesi, è necessario includere una delle istruzioni seguenti quando si crea o modifica una sessione eventi, a seconda del tipo di destinazione desiderato:</span><span class="sxs-lookup"><span data-stu-id="ba68a-181">To add the histogram target to an Extended Events session, you must include either of the following statements when you create or alter an event session, depending on the desired target type:</span></span>  
  
```  
ADD TARGET package0.histogram  
```  
  
 <span data-ttu-id="ba68a-182">È possibile utilizzare l'istruzione SET per impostare le varie opzioni.</span><span class="sxs-lookup"><span data-stu-id="ba68a-182">You can use the SET statement to set the various options.</span></span> <span data-ttu-id="ba68a-183">Nell'esempio seguente viene illustrata l'aggiunta della destinazione dell'istogramma, in cui vengono raccolti dati per l'evento sqlserver.checkpoint_end.</span><span class="sxs-lookup"><span data-stu-id="ba68a-183">The following example shows the addition of the histogram target, where data for the sqlserver.checkpoint_end event is collected.</span></span>  
  
```  
ADD TARGET package0.histogram  
(SET slots = 32, filtering_event_name = 'sqlserver.checkpoint_end', source_type = 0, source = 'database_id')  
```  
  
 <span data-ttu-id="ba68a-184">Per altre informazioni, vedere [Cercare gli oggetti con il maggior numero di blocchi acquisiti](../relational-databases/extended-events/find-the-objects-that-have-the-most-locks-taken-on-them.md)e [Monitorare l'attività del sistema mediante gli eventi estesi](../relational-databases/extended-events/monitor-system-activity-using-extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="ba68a-184">For more information, see [Find the Objects That Have the Most Locks Taken on Them](../relational-databases/extended-events/find-the-objects-that-have-the-most-locks-taken-on-them.md), and [Monitor System Activity Using Extended Events](../relational-databases/extended-events/monitor-system-activity-using-extended-events.md).</span></span>  
  
## <a name="reviewing-the-target-output"></a><span data-ttu-id="ba68a-185">Analisi dell'output di destinazione</span><span class="sxs-lookup"><span data-stu-id="ba68a-185">Reviewing the Target Output</span></span>  
 <span data-ttu-id="ba68a-186">La destinazione dell'istogramma serializza i dati in un programma o una procedura chiamante in formato XML.</span><span class="sxs-lookup"><span data-stu-id="ba68a-186">The histogram target serializes data to a calling program or procedure in XML format.</span></span> <span data-ttu-id="ba68a-187">L'output della destinazione non è conforme ad alcuno schema.</span><span class="sxs-lookup"><span data-stu-id="ba68a-187">The target output does not conform to any schema.</span></span>  
  
 <span data-ttu-id="ba68a-188">Per esaminare l'output dalla destinazione istogramma, è possibile usare la query seguente, sostituendo *nome_sessione* con il nome della sessione eventi.</span><span class="sxs-lookup"><span data-stu-id="ba68a-188">To review the output from the histogram target, you can use the following query, replacing *session_name* with the name of the event session.</span></span>  
  
```  
SELECT name, target_name, CAST(xet.target_data AS xml)  
FROM sys.dm_xe_session_targets AS xet  
JOIN sys.dm_xe_sessions AS xe  
   ON (xe.address = xet.event_session_address)  
WHERE xe.name = 'session_name'  
```  
  
 <span data-ttu-id="ba68a-189">Nell'esempio seguente viene illustrato il formato di output della destinazione dell'istogramma.</span><span class="sxs-lookup"><span data-stu-id="ba68a-189">The following example illustrates histogram target output format.</span></span>  
  
```  
<Slots truncated = "0" buckets=[count]>  
    <Slot count=[count] trunc=[truncated bytes]>  
        <value>  
        </value>  
    </Slot>  
</Slots>  
```  
  
## <a name="see-also"></a><span data-ttu-id="ba68a-190">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ba68a-190">See Also</span></span>  
 <span data-ttu-id="ba68a-191">[Destinazioni degli eventi estesi di SQL Server](../../2014/database-engine/sql-server-extended-events-targets.md) </span><span class="sxs-lookup"><span data-stu-id="ba68a-191">[SQL Server Extended Events Targets](../../2014/database-engine/sql-server-extended-events-targets.md) </span></span>  
 <span data-ttu-id="ba68a-192">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ba68a-192">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span></span>  
 <span data-ttu-id="ba68a-193">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ba68a-193">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span></span>  
 [<span data-ttu-id="ba68a-194">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="ba68a-194">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-event-session-transact-sql)  
  
  
