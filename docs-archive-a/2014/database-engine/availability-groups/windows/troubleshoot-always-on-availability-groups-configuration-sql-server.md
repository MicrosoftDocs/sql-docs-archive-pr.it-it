---
title: Risolvere i problemi di configurazione Gruppi di disponibilità AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 01/31/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- troubleshooting [SQL Server], deploying
- Availability Groups [SQL Server], troubleshooting
- Availability Groups [SQL Server], configuring
ms.assetid: 8c222f98-7392-4faf-b7ad-5fb60ffa237e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 165036ba539c3392b1944282bd9d6126eb471a97
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87724960"
---
# <a name="troubleshoot-alwayson-availability-groups-configuration-sql-server"></a><span data-ttu-id="a5242-102">Risolvere i problemi relativi alla configurazione di Gruppi di disponibilità AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="a5242-102">Troubleshoot AlwaysOn Availability Groups Configuration (SQL Server)</span></span>
  <span data-ttu-id="a5242-103">In questo argomento vengono fornite informazioni per la risoluzione dei problemi tipici relativi alla configurazione delle istanze del server per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a5242-103">This topic provides information to help you troubleshoot typical problems with configuring server instances for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="a5242-104">Tra i problemi di configurazione tipici sono inclusi la disabilitazione di [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , la configurazione errata degli account, l'endpoint del mirroring del database inesistente, l'endpoint inaccessibile (errore di SQL Server 1418), l'accesso alla rete inesistente e l'esito negativo di un comando di creazione di join del database (errore di SQL Server 35250).</span><span class="sxs-lookup"><span data-stu-id="a5242-104">Typical configuration problems include [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is disabled, accounts are incorrectly configured, the database mirroring endpoint does not exist, the endpoint is inaccessible (SQL Server Error 1418), network access does not exist, and a join database command fails (SQL Server Error 35250).</span></span>

> [!NOTE]
>  <span data-ttu-id="a5242-105">Verificare che vengano soddisfatti i prerequisiti [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a5242-105">Ensure that you are meeting the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] prerequisites.</span></span> <span data-ttu-id="a5242-106">Per altre informazioni, vedere [Prerequisiti, restrizioni e consigli per i gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-106">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>

 <span data-ttu-id="a5242-107">**Contenuto dell'argomento:**</span><span class="sxs-lookup"><span data-stu-id="a5242-107">**In This Topic:**</span></span>

|<span data-ttu-id="a5242-108">Sezione</span><span class="sxs-lookup"><span data-stu-id="a5242-108">Section</span></span>|<span data-ttu-id="a5242-109">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a5242-109">Description</span></span>|
|-------------|-----------------|
|[<span data-ttu-id="a5242-110">Funzionalità Gruppi di disponibilità AlwaysOn non abilitata</span><span class="sxs-lookup"><span data-stu-id="a5242-110">AlwaysOn Availability Groups Is Not Enabled</span></span>](#IsHadrEnabled)|<span data-ttu-id="a5242-111">Se un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] non è abilitata per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], l'istanza non supporta la creazione del gruppo di disponibilità e non è in grado di ospitare alcuna replica di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="a5242-111">If an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is not enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], the instance does not support availability group creation and cannot host any availability replicas.</span></span>|
|[<span data-ttu-id="a5242-112">Accounts</span><span class="sxs-lookup"><span data-stu-id="a5242-112">Accounts</span></span>](#Accounts)|<span data-ttu-id="a5242-113">Illustra i requisiti per la corretta configurazione degli account in cui viene eseguito [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a5242-113">Discusses requirements for correctly configuring the accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running.</span></span>|
|[<span data-ttu-id="a5242-114">Endpoints</span><span class="sxs-lookup"><span data-stu-id="a5242-114">Endpoints</span></span>](#Endpoints)|<span data-ttu-id="a5242-115">Illustra come diagnosticare problemi relativi all'endpoint del mirroring del database di un'istanza del server.</span><span class="sxs-lookup"><span data-stu-id="a5242-115">Discusses how to diagnose issues with the database mirroring endpoint of a server instance.</span></span>|
|[<span data-ttu-id="a5242-116">Nome di sistema</span><span class="sxs-lookup"><span data-stu-id="a5242-116">System name</span></span>](#SystemName)|<span data-ttu-id="a5242-117">Riepiloga le alternative per la specifica del nome di sistema di un'istanza del server in un URL endpoint.</span><span class="sxs-lookup"><span data-stu-id="a5242-117">Summarizes the alternatives for specifying the system name of a server instance in an endpoint URL.</span></span>|
|[<span data-ttu-id="a5242-118">Accesso alla rete</span><span class="sxs-lookup"><span data-stu-id="a5242-118">Network access</span></span>](#NetworkAccess)|<span data-ttu-id="a5242-119">Documenta il requisito in base a cui ogni istanza del server che ospita una replica di disponibilità deve essere in grado di accedere alla porta di ciascuna altra istanza del server su TCP.</span><span class="sxs-lookup"><span data-stu-id="a5242-119">Documents the requirement that each server instance that is hosting an availability replica must be able to access the port of each of the other server instances over TCP.</span></span>|
|[<span data-ttu-id="a5242-120">Accesso all'endpoint (errore di SQL Server 1418)</span><span class="sxs-lookup"><span data-stu-id="a5242-120">Endpoint Access (SQL Server Error 1418)</span></span>](#Msg1418)|<span data-ttu-id="a5242-121">Contiene informazioni su questo messaggio di errore di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a5242-121">Contains information about this [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error message.</span></span>|
|[<span data-ttu-id="a5242-122">Errore nella creazione del join del database (errore di SQL Server 35250)</span><span class="sxs-lookup"><span data-stu-id="a5242-122">Join Database Fails (SQL Server Error 35250)</span></span>](#JoinDbFails)|<span data-ttu-id="a5242-123">Illustra le possibili cause e la risoluzione di un errore nella creazione di join dei database secondari a un gruppo di disponibilità perché la connessione alla replica primaria non è attiva.</span><span class="sxs-lookup"><span data-stu-id="a5242-123">Discusses the possible causes and resolution of a failure to join secondary databases to an availability group because the connection to the primary replica is not active.</span></span>|
|[<span data-ttu-id="a5242-124">Il routing di sola lettura non funziona correttamente</span><span class="sxs-lookup"><span data-stu-id="a5242-124">Read-Only Routing is Not Working Correctly</span></span>](#ROR)||
|[<span data-ttu-id="a5242-125">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="a5242-125">Related Tasks</span></span>](#RelatedTasks)|<span data-ttu-id="a5242-126">Contiene un elenco di argomenti orientati alle attività nella documentazione online di [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] particolarmente rilevanti per risolvere i problemi relativi a una configurazione del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="a5242-126">Contains a list of task-oriented topics in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] Books Online that are particularly relevant to troubleshooting an availability group configuration.</span></span>|
|[<span data-ttu-id="a5242-127">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="a5242-127">Related Content</span></span>](#RelatedContent)|<span data-ttu-id="a5242-128">Contiene un elenco di risorse rilevanti esterne alla documentazione online di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a5242-128">Contains a list of relevant resources that are external to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Books Online.</span></span>|

##  <a name="alwayson-availability-groups-is-not-enabled"></a><a name="IsHadrEnabled"></a><span data-ttu-id="a5242-129">Gruppi di disponibilità AlwaysOn non è abilitato</span><span class="sxs-lookup"><span data-stu-id="a5242-129">AlwaysOn Availability Groups Is Not Enabled</span></span>
 <span data-ttu-id="a5242-130">La funzionalità [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] deve essere abilitata su ognuna delle istanze di [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a5242-130">The [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature must be enabled on each of the instances of [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="a5242-131">Per altre informazioni, vedere [Abilitare e disabilitare la funzionalità Gruppi di disponibilità Always On &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-131">For more information, see [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span></span>

##  <a name="accounts"></a><a name="Accounts"></a> <span data-ttu-id="a5242-132">Accounts</span><span class="sxs-lookup"><span data-stu-id="a5242-132">Accounts</span></span>
 <span data-ttu-id="a5242-133">È necessario configurare correttamente gli account utilizzati per l'esecuzione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a5242-133">The accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running must be correctly configured.</span></span>

1.  <span data-ttu-id="a5242-134">Autorizzazioni corrette per gli account</span><span class="sxs-lookup"><span data-stu-id="a5242-134">Do the accounts have the correct permissions?</span></span>

    1.  <span data-ttu-id="a5242-135">Se i partner vengono eseguiti con lo stesso account utente di dominio, gli account di accesso corretti saranno disponibili automaticamente in ambedue i database **master** .</span><span class="sxs-lookup"><span data-stu-id="a5242-135">If the partners run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="a5242-136">Questa scelta semplifica la configurazione della sicurezza del database ed è quella consigliata.</span><span class="sxs-lookup"><span data-stu-id="a5242-136">This simplifies the security configuration the database and is recommended.</span></span>

    2.  <span data-ttu-id="a5242-137">Se due istanze del server vengono eseguite con account diversi, è necessario creare l'accesso per ogni account nel database **master** nell'istanza del server remoto e a tale account di accesso è necessario concedere le autorizzazioni CONNECT per la connessione all'endpoint del mirroring del database di tale istanza del server.</span><span class="sxs-lookup"><span data-stu-id="a5242-137">If two server instances run as different accounts, the login each account must be created in **master** on the remote server instance, and that login must be granted CONNECT permissions to connect to the database mirroring endpoint of that server instance.</span></span> <span data-ttu-id="a5242-138">Per ulteriori informazioni, vedere la pagina relativa alla[configurazione degli account di accesso per il mirroring del database o Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-138">For more information, see[Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span></span>

2.  <span data-ttu-id="a5242-139">Se [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] viene eseguito come account predefinito, ad esempio Sistema locale, Servizio locale o Servizio di rete, oppure come account non di dominio, è necessario utilizzare certificati per l'autenticazione dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="a5242-139">If [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running as a built-in account, such as Local System, Local Service, or Network Service, or a nondomain account, you must use certificates for endpoint authentication.</span></span> <span data-ttu-id="a5242-140">Se gli account del servizio utilizzano account di dominio nello stesso dominio, è possibile scegliere di concedere l'accesso CONNECT per ogni account del servizio su tutti i percorsi di replica oppure utilizzare certificati.</span><span class="sxs-lookup"><span data-stu-id="a5242-140">If your service accounts are using domain accounts in the same domain, you can choose to grant CONNECT access for each service account on all the replica locations or you can use certificates.</span></span> <span data-ttu-id="a5242-141">Per altre informazioni, vedere [Usare certificati per un endpoint del mirroring del database &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-141">For more information, see[Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>

##  <a name="endpoints"></a><a name="Endpoints"></a> <span data-ttu-id="a5242-142">Endpoints</span><span class="sxs-lookup"><span data-stu-id="a5242-142">Endpoints</span></span>
 <span data-ttu-id="a5242-143">È necessario configurare correttamente gli endpoint.</span><span class="sxs-lookup"><span data-stu-id="a5242-143">Endpoints must be correctly configured.</span></span>

1.  <span data-ttu-id="a5242-144">Verificare che ogni istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] che ospiterà una replica di disponibilità (ogni *percorso di replica*) disponga di un endpoint del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="a5242-144">Make sure that each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that is going to host an availability replica (each *replica location*) has a database mirroring endpoint.</span></span> <span data-ttu-id="a5242-145">Per determinare se in una determinata istanza del server è presente un endpoint del mirroring del database, usare la vista del catalogo [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a5242-145">To determine whether a database mirroring endpoint exists on a given server instance, use the [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql) catalog view.</span></span> <span data-ttu-id="a5242-146">Per altre informazioni, vedere [Creare un endpoint del mirroring del database per l'autenticazione Windows &#40;Transact-SQL&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) oppure [Impostare l'endpoint del mirroring del database per l'uso di certificati per le connessioni in uscita &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-146">For more information, see either [Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) or [Allow a Database Mirroring Endpoint to Use Certificates for Outbound Connections &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span></span>

2.  <span data-ttu-id="a5242-147">Verificare che i numeri di porta siano corretti.</span><span class="sxs-lookup"><span data-stu-id="a5242-147">Check that the port numbers are correct.</span></span>

     <span data-ttu-id="a5242-148">Per individuare la porta attualmente associata all'endpoint di mirroring del database per un'istanza del server, utilizzare l'istruzione [!INCLUDE[tsql](../../../includes/tsql-md.md)] seguente:</span><span class="sxs-lookup"><span data-stu-id="a5242-148">To identify the port currently associated with database mirroring endpoint of a server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT type_desc, port FROM sys.tcp_endpoints;
    GO
    ```

3.  <span data-ttu-id="a5242-149">Per i problemi di impostazione di [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] che sono difficili da diagnosticare, è consigliabile controllare ogni istanza del server per verificare che sia in attesa sulle porte corrette.</span><span class="sxs-lookup"><span data-stu-id="a5242-149">For [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] setup issues that are difficult to explain, we recommend that you inspect each server instance to determine whether it is listening on the correct ports.</span></span> <span data-ttu-id="a5242-150">Per informazioni sulla verifica della disponibilità delle porte, vedere [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-150">For information about verifying port availability, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

4.  <span data-ttu-id="a5242-151">Verificare che gli endpoint siano stati avviati (STATE=STARTED).</span><span class="sxs-lookup"><span data-stu-id="a5242-151">Make sure that the endpoints are started (STATE=STARTED).</span></span> <span data-ttu-id="a5242-152">Utilizzare l'istruzione [!INCLUDE[tsql](../../../includes/tsql-md.md)] seguente su ogni istanza del server:</span><span class="sxs-lookup"><span data-stu-id="a5242-152">On each server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT state_desc FROM sys.database_mirroring_endpoints
    ```

     <span data-ttu-id="a5242-153">Per altre informazioni sulla colonna **state_desc**, vedere [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a5242-153">For more information about the **state_desc** column, see [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span></span>

     <span data-ttu-id="a5242-154">Per avviare un endpoint, utilizzare l'istruzione [!INCLUDE[tsql](../../../includes/tsql-md.md)] seguente:</span><span class="sxs-lookup"><span data-stu-id="a5242-154">To start an endpoint, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    ALTER ENDPOINT Endpoint_Mirroring 
    STATE = STARTED 
    AS TCP (LISTENER_PORT = <port_number>)
    FOR database_mirroring (ROLE = ALL);
    GO
    ```

     <span data-ttu-id="a5242-155">Per altre informazioni, vedere [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a5242-155">For more information, see [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span></span>

5.  <span data-ttu-id="a5242-156">Verificare che l'account di accesso dell'altro server disponga dell'autorizzazione CONNECT.</span><span class="sxs-lookup"><span data-stu-id="a5242-156">Make sure that the login from the other server has CONNECT permission.</span></span> <span data-ttu-id="a5242-157">Per individuare gli account che dispongono dell'autorizzazione CONNECT per un endpoint, utilizzare l'istruzione [!INCLUDE[tsql](../../../includes/tsql-md.md)] seguente su ogni istanza del server:</span><span class="sxs-lookup"><span data-stu-id="a5242-157">To determine who has CONNECT permission for an endpoint, on each server instance use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT 'Metadata Check';
    SELECT EP.name, SP.STATE, 
       CONVERT(nvarchar(38), suser_name(SP.grantor_principal_id)) 
          AS GRANTOR, 
       SP.TYPE AS PERMISSION,
       CONVERT(nvarchar(46),suser_name(SP.grantee_principal_id)) 
          AS GRANTEE 
       FROM sys.server_permissions SP , sys.endpoints EP
       WHERE SP.major_id = EP.endpoint_id
       ORDER BY Permission,grantor, grantee; 
    GO

    ```

##  <a name="system-name"></a><a name="SystemName"></a> <span data-ttu-id="a5242-158">System Name</span><span class="sxs-lookup"><span data-stu-id="a5242-158">System Name</span></span>
 <span data-ttu-id="a5242-159">Quale nome di sistema di un'istanza del server in un URL endpoint, è possibile utilizzare qualsiasi nome che identifichi univocamente il sistema.</span><span class="sxs-lookup"><span data-stu-id="a5242-159">For the system name of a server instance in an endpoint URL, you can use any name that unambiguously identifies the system.</span></span> <span data-ttu-id="a5242-160">L'indirizzo del server può essere un nome di sistema (se i sistemi si trovano nello stesso dominio), un nome di dominio completo o un indirizzo IP (preferibilmente un indirizzo IP statico).</span><span class="sxs-lookup"><span data-stu-id="a5242-160">The server address can be a system name (if the systems are in the same domain), a fully qualified domain name, or an IP address (preferably, a static IP address).</span></span> <span data-ttu-id="a5242-161">L'utilizzo del nome di dominio completo è una soluzione efficace.</span><span class="sxs-lookup"><span data-stu-id="a5242-161">Using the fully qualified domain name is guaranteed to work.</span></span> <span data-ttu-id="a5242-162">Per altre informazioni, vedere [Specificare l'URL dell'endpoint quando si aggiunge o si modifica una replica di disponibilità &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-162">For more information, see [Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span></span>

##  <a name="network-access"></a><a name="NetworkAccess"></a> <span data-ttu-id="a5242-163">Network Access</span><span class="sxs-lookup"><span data-stu-id="a5242-163">Network Access</span></span>
 <span data-ttu-id="a5242-164">Ogni istanza del server che ospita una replica di disponibilità deve essere in grado di accedere alla porta di ciascuna altra istanza del server su TCP.</span><span class="sxs-lookup"><span data-stu-id="a5242-164">Each server instance that is hosting an availability replica must be able to access the port of each of the other server instance over TCP.</span></span> <span data-ttu-id="a5242-165">Questo requisito è particolarmente importante quando le istanze del server appartengono a domini diversi non trusted.</span><span class="sxs-lookup"><span data-stu-id="a5242-165">This is especially important if the server instances are in different domains that do not trust each other (untrusted domains).</span></span>

##  <a name="endpoint-access-sql-server-error-1418"></a><a name="Msg1418"></a> <span data-ttu-id="a5242-166">Accesso all'endpoint (errore di SQL Server 1418)</span><span class="sxs-lookup"><span data-stu-id="a5242-166">Endpoint Access (SQL Server Error 1418)</span></span>
 <span data-ttu-id="a5242-167">Questo messaggio di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] indica che l'indirizzo di rete del server specificato nell'URL endpoint non è raggiungibile o non esiste, pertanto si consiglia di controllare il nome dell'indirizzo di rete e quindi eseguire nuovamente il comando.</span><span class="sxs-lookup"><span data-stu-id="a5242-167">This [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] message indicates that the server network address specified in the endpoint URL cannot be reached or does not exist, and it suggests that you verify the network address name and reissue the command.</span></span> <span data-ttu-id="a5242-168">Per altre informazioni, vedere [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="a5242-168">For more information, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

##  <a name="join-database-fails-sql-server-error-35250"></a><a name="JoinDbFails"></a> <span data-ttu-id="a5242-169">Errore nella creazione del join del database (errore di SQL Server 35250)</span><span class="sxs-lookup"><span data-stu-id="a5242-169">Join Database Fails (SQL Server Error 35250)</span></span>
 <span data-ttu-id="a5242-170">In questa sezione vengono illustrate le possibili cause e la risoluzione di un errore nella creazione di join dei database secondari al gruppo di disponibilità perché la connessione alla replica primaria non è attiva.</span><span class="sxs-lookup"><span data-stu-id="a5242-170">This section discusses the possible causes and resolution of a failure to join secondary databases to the availability group because the connection to the primary replica is not active.</span></span>

 <span data-ttu-id="a5242-171">**Risoluzione:**</span><span class="sxs-lookup"><span data-stu-id="a5242-171">**Resolution:**</span></span>

1.  <span data-ttu-id="a5242-172">Controllare l'impostazione del firewall per verificare se è consentita la comunicazione della porta dell'endpoint tra le istanze del server che ospitano la replica primaria e la replica secondaria (porta 5022 per impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="a5242-172">Check the firewall setting to see if whether allows the endpoint port communication between the server instances that host primary replica and the secondary replica (port 5022 by default).</span></span>

2.  <span data-ttu-id="a5242-173">Controllare se l'account del servizio di rete dispone di autorizzazione CONNECT all'endpoint.</span><span class="sxs-lookup"><span data-stu-id="a5242-173">Check whether the network service account has connect permission to the endpoint.</span></span>

##  <a name="read-only-routing-is-not-working-correctly"></a><a name="ROR"></a> <span data-ttu-id="a5242-174">Il routing di sola lettura non funziona correttamente</span><span class="sxs-lookup"><span data-stu-id="a5242-174">Read-Only Routing is Not Working Correctly</span></span>
 <span data-ttu-id="a5242-175">Verificare le seguenti impostazioni relative ai valori di configurazione e correggerle se necessario.</span><span class="sxs-lookup"><span data-stu-id="a5242-175">Verify the following configuration values settings and correct them if necessary.</span></span>

||<span data-ttu-id="a5242-176">In...</span><span class="sxs-lookup"><span data-stu-id="a5242-176">On...</span></span>|<span data-ttu-id="a5242-177">Azione</span><span class="sxs-lookup"><span data-stu-id="a5242-177">Action</span></span>|<span data-ttu-id="a5242-178">Commenti</span><span class="sxs-lookup"><span data-stu-id="a5242-178">Comments</span></span>|<span data-ttu-id="a5242-179">Collegamento</span><span class="sxs-lookup"><span data-stu-id="a5242-179">Link</span></span>|
|------|---------|------------|--------------|----------|
|<span data-ttu-id="a5242-180">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-180">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-181">Replica primaria corrente</span><span class="sxs-lookup"><span data-stu-id="a5242-181">Current primary replica</span></span>|<span data-ttu-id="a5242-182">Assicurarsi che il listener del gruppo di disponibilità sia online.</span><span class="sxs-lookup"><span data-stu-id="a5242-182">Ensure that the availability group listener is online.</span></span>|<span data-ttu-id="a5242-183">**Per verificare se il listener è online:**</span><span class="sxs-lookup"><span data-stu-id="a5242-183">**To verify whether the listener is online:**</span></span><br /><br /> `SELECT * FROM sys.dm_tcp_listener_states;`<br /><br /> <span data-ttu-id="a5242-184">**Per riavviare un listener offline:**</span><span class="sxs-lookup"><span data-stu-id="a5242-184">**To restart an offline listener:**</span></span><br /><br /> `ALTER AVAILABILITY GROUP myAG RESTART LISTENER 'myAG_Listener';`|[<span data-ttu-id="a5242-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-tcp-listener-states-transact-sql)<br /><br /> [<span data-ttu-id="a5242-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="a5242-187">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-187">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-188">Replica primaria corrente</span><span class="sxs-lookup"><span data-stu-id="a5242-188">Current primary replica</span></span>|<span data-ttu-id="a5242-189">Verificare che READ_ONLY_ROUTING_LIST contenga solo le istanze del server che ospitano una replica secondaria leggibile.</span><span class="sxs-lookup"><span data-stu-id="a5242-189">Ensure that the READ_ONLY_ROUTING_LIST contains only server instances that are hosting a readable secondary replica.</span></span>|<span data-ttu-id="a5242-190">**Per identificare repliche secondarie leggibili:** sys.availability_replicas (colonna**secondary_role_allow_connections_desc** )</span><span class="sxs-lookup"><span data-stu-id="a5242-190">**To identify readable secondary replicas:** sys.availability_replicas  (**secondary_role_allow_connections_desc** column)</span></span><br /><br /> <span data-ttu-id="a5242-191">**Per visualizzare un elenco di routing di sola lettura:** sys.availability_read_only_routing_lists</span><span class="sxs-lookup"><span data-stu-id="a5242-191">**To view a read-only routing list:** sys.availability_read_only_routing_lists</span></span><br /><br /> <span data-ttu-id="a5242-192">**Per modificare un elenco di routing di sola lettura:** ALTER AVAILABILITY GROUP</span><span class="sxs-lookup"><span data-stu-id="a5242-192">**To change a read-only routing list:** ALTER AVAILABILITY GROUP</span></span>|[<span data-ttu-id="a5242-193">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-193">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="a5242-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-read-only-routing-lists-transact-sql)<br /><br /> [<span data-ttu-id="a5242-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="a5242-196">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-196">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-197">Ogni replica in read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="a5242-197">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="a5242-198">Verificare che Windows Firewall non blocchi la porta READ_ONLY_ROUTING_URL.</span><span class="sxs-lookup"><span data-stu-id="a5242-198">Ensure that the Windows firewall is not blocking the READ_ONLY_ROUTING_URL port.</span></span>|-|[<span data-ttu-id="a5242-199">Configurare Windows Firewall per l'accesso al motore di database</span><span class="sxs-lookup"><span data-stu-id="a5242-199">Configure a Windows Firewall for Database Engine Access</span></span>](../../configure-windows/configure-a-windows-firewall-for-database-engine-access.md)|
|<span data-ttu-id="a5242-200">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-200">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-201">Ogni replica in read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="a5242-201">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="a5242-202">In Gestione configurazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] verificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="a5242-202">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager, verify that:</span></span><br /><br /> <span data-ttu-id="a5242-203">La connettività remota di SQL Server è abilitata.</span><span class="sxs-lookup"><span data-stu-id="a5242-203">SQL Server remote connectivity is enabled.</span></span><br /><br /> <span data-ttu-id="a5242-204">TCP/IP è abilitato.</span><span class="sxs-lookup"><span data-stu-id="a5242-204">TCP/IP is enabled.</span></span><br /><br /> <span data-ttu-id="a5242-205">Gli indirizzi IP sono configurati correttamente.</span><span class="sxs-lookup"><span data-stu-id="a5242-205">The IP addresses are configured correctly.</span></span>|-|[<span data-ttu-id="a5242-206">Visualizzare o modificare le proprietà del server &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-206">View or Change Server Properties &#40;SQL Server&#41;</span></span>](../../configure-windows/view-or-change-server-properties-sql-server.md)<br /><br /> [<span data-ttu-id="a5242-207">Configurare un server per l'attesa su una porta TCP specifica &#40;Gestione configurazione SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-207">Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;</span></span>](../../configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md)|
|<span data-ttu-id="a5242-208">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-208">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-209">Ogni replica in read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="a5242-209">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="a5242-210">Verificare che il READ_ONLY_ROUTING_URL (TCP<strong>:// *`system-address`* :</strong>*porta*) contenga il nome di dominio completo (FQDN) e il numero di porta corretti.</span><span class="sxs-lookup"><span data-stu-id="a5242-210">Ensure that the READ_ONLY_ROUTING_URL (TCP<strong>://*`system-address`*:</strong>*port*) contains the correct fully-qualified domain name (FQDN) and port number.</span></span>|-|[<span data-ttu-id="a5242-211">Calcolo di read_only_routing_url per AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="a5242-211">Calculating read_only_routing_url for AlwaysOn</span></span>](https://docs.microsoft.com/archive/blogs/mattn/calculating-read_only_routing_url-for-alwayson)<br /><br /> [<span data-ttu-id="a5242-212">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-212">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="a5242-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="a5242-214">![Casella di controllo](../../media/checkboxemptycenterxtraspacetopandright.gif "Casella di controllo")</span><span class="sxs-lookup"><span data-stu-id="a5242-214">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="a5242-215">Sistema client</span><span class="sxs-lookup"><span data-stu-id="a5242-215">Client system</span></span>|<span data-ttu-id="a5242-216">Verificare che il driver client supporti il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="a5242-216">Verify that the client driver supports read-only routing.</span></span>|-|[<span data-ttu-id="a5242-217">Connettività client AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="a5242-217">AlwaysOn Client Connectivity (SQL Server)</span></span>](always-on-client-connectivity-sql-server.md)|

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="a5242-218">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="a5242-218">Related Tasks</span></span>

-   [<span data-ttu-id="a5242-219">Creazione e configurazione di gruppi di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-219">Creation and Configuration of Availability Groups &#40;SQL Server&#41;</span></span>](creation-and-configuration-of-availability-groups-sql-server.md)

-   [<span data-ttu-id="a5242-220">Creare un endpoint del mirroring del database per l'autenticazione Windows &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-220">Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;</span></span>](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)

-   [<span data-ttu-id="a5242-221">Specifica dell'URL dell'endpoint quando si aggiunge o si modifica una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-221">Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;</span></span>](specify-endpoint-url-adding-or-modifying-availability-replica.md)

-   [<span data-ttu-id="a5242-222">Preparare manualmente un database secondario per un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-222">Manually Prepare a Secondary Database for an Availability Group &#40;SQL Server&#41;</span></span>](manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md)

-   [<span data-ttu-id="a5242-223">Risolvere i problemi relativi a un'operazione di aggiunta file non riuscita &#40;Gruppi di disponibilità AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-223">Troubleshoot a Failed Add-File Operation &#40;AlwaysOn Availability Groups&#41;</span></span>](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md)

-   [<span data-ttu-id="a5242-224">Gestione di account di accesso e processi per i database di un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-224">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)

-   [<span data-ttu-id="a5242-225">Gestire i metadati quando si rende disponibile un database in un'altra istanza del server &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="a5242-225">Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;</span></span>](../../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="a5242-226">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="a5242-226">Related Content</span></span>

-   <span data-ttu-id="a5242-227">[Visualizzare eventi e log per un cluster di failover](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="a5242-227">[View Events and Logs for a Failover Cluster](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span></span>

-   [<span data-ttu-id="a5242-228">Pagina relativa al cluster di failover Get-ClusterLog</span><span class="sxs-lookup"><span data-stu-id="a5242-228">Get-ClusterLog Failover Cluster Cmdlet</span></span>](https://technet.microsoft.com/library/ee461045.aspx)

-   [<span data-ttu-id="a5242-229">Blog del team di SQL Server AlwaysOn: Blog del team ufficiale di SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="a5242-229">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

## <a name="see-also"></a><span data-ttu-id="a5242-230">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a5242-230">See Also</span></span>
 <span data-ttu-id="a5242-231">[Sicurezza del trasporto per il mirroring del database e Gruppi di disponibilità AlwaysOn &#40;SQL Server](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) [Client Network Configuration](../../configure-windows/client-network-configuration.md) [prerequisiti, restrizioni e consigli per la configurazione di rete del](prereqs-restrictions-recommendations-always-on-availability.md) client&#41;gruppi di disponibilità AlwaysOn &#40;SQL Server</span><span class="sxs-lookup"><span data-stu-id="a5242-231">[Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) [Client Network Configuration](../../configure-windows/client-network-configuration.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md)</span></span>


