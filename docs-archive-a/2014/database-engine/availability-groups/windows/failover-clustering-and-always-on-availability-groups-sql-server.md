---
title: Clustering di failover e Gruppi di disponibilità AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- clustering [SQL Server]
- Availability Groups [SQL Server], WSFC clusters
- Failover Cluster Instances [SQL Server], see failover clustering [SQL Server]
- quorum [SQL Server]
- failover clustering [SQL Server], AlwaysOn Availability Groups
- Availability Groups [SQL Server], Failover Cluster Instances
ms.assetid: 613bfbf1-9958-477b-a6be-c6d4f18785c3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 64ee815c2b852849d9506ca6c3fc114d3d0e4935
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87627983"
---
# <a name="failover-clustering-and-alwayson-availability-groups-sql-server"></a><span data-ttu-id="6726a-102">Clustering di failover e gruppi di disponibilità AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6726a-102">Failover Clustering and AlwaysOn Availability Groups (SQL Server)</span></span>
  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]<span data-ttu-id="6726a-103">, la soluzione di ripristino di emergenza a disponibilità elevata introdotta in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], richiede WSFC (Windows Server Failover Clustering).</span><span class="sxs-lookup"><span data-stu-id="6726a-103">, the high availability and disaster recovery solution introduced in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], requires Windows Server Failover Clustering (WSFC).</span></span> <span data-ttu-id="6726a-104">Sebbene inoltre [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] non dipenda dal clustering di failover di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , è possibile utilizzare un'istanza di clustering di failover per ospitare una replica di disponibilità per un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-104">Also, though [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is not dependent upon [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Clustering, you can use a failover clustering instance (FCI) to host an availability replica for an availability group.</span></span> <span data-ttu-id="6726a-105">È importante conoscere la funzione di ogni tecnologia di clustering e sapere quali sono le considerazioni necessarie per la progettazione di un ambiente di [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6726a-105">It is important to know the role of each clustering technology, and to know what considerations are necessary as you design your [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] environment.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6726a-106">Per informazioni sui concetti di [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], vedere [Panoramica di Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6726a-106">For information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span></span>  
  

  
##  <a name="windows-server-failover-clustering-and-availability-groups"></a><a name="WSFC"></a><span data-ttu-id="6726a-107">Windows Server failover clustering e gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-107">Windows Server Failover Clustering and Availability Groups</span></span>  
 <span data-ttu-id="6726a-108">La distribuzione dei [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] richiede un cluster WSCF (Windows Server Failover Clustering).</span><span class="sxs-lookup"><span data-stu-id="6726a-108">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="6726a-109">Per essere abilitata per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] deve trovarsi in un nodo WSFC e il nodo e il cluster WSFC devono essere online.</span><span class="sxs-lookup"><span data-stu-id="6726a-109">To be enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must reside on a WSFC node, and the WSFC cluster and node must be online.</span></span> <span data-ttu-id="6726a-110">Inoltre, ogni replica di disponibilità di un gruppo di disponibilità deve risiedere in un nodo diverso dello stesso cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="6726a-110">Furthermore, each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="6726a-111">L'unica eccezione è che quando viene eseguita la migrazione a un altro cluster WSFC, un gruppo di disponibilità può risiedere temporaneamente in due cluster.</span><span class="sxs-lookup"><span data-stu-id="6726a-111">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="6726a-112">si basa sul cluster WSFC (Windows Server Failover Clustering) per monitorare e gestire i ruoli correnti delle repliche di disponibilità che appartengono a un determinato gruppo di disponibilità e per determinare in che modo un evento di failover influisca sulle repliche di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-112">relies on the Windows Failover Clustering (WSFC) cluster to monitor and manage the current roles of the availability replicas that belong to a given availability group and to determine how a failover event affects the availability replicas.</span></span> <span data-ttu-id="6726a-113">Il gruppo di risorse WSFC viene creato per ogni gruppo di disponibilità che viene creato.</span><span class="sxs-lookup"><span data-stu-id="6726a-113">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="6726a-114">Con il cluster WSFC è possibile eseguire il monitoraggio del gruppo di risorse per valutare lo stato di integrità della replica primaria.</span><span class="sxs-lookup"><span data-stu-id="6726a-114">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span>  
  
 <span data-ttu-id="6726a-115">Il quorum di [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] si basa su tutti i nodi del cluster WSFC, indipendentemente dal fatto che un nodo del cluster ospiti una replica di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-115">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="6726a-116">A differenza del mirroring del database, non esiste alcun ruolo del server di controllo in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6726a-116">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>  
  
 <span data-ttu-id="6726a-117">L'integrità complessiva di un cluster WSFC è determinata dai voti di un quorum di nodi nel cluster.</span><span class="sxs-lookup"><span data-stu-id="6726a-117">The overall health of a WSFC cluster is determined by the votes of quorum of nodes in the cluster.</span></span> <span data-ttu-id="6726a-118">Se il cluster WSFC viene portato offline a causa di un'emergenza non pianificata o di un errore persistente dell'hardware o di comunicazione, è necessario un intervento amministrativo manuale.</span><span class="sxs-lookup"><span data-stu-id="6726a-118">If the WSFC cluster goes offline because of an unplanned disaster, or due to a persistent hardware or communications failure, manual administrative intervention is required.</span></span> <span data-ttu-id="6726a-119">Un amministratore di cluster Windows Server or WSFC dovrà forzare un quorum e, successivamente, riportare online i nodi del cluster ancora esistenti in una configurazione non a tolleranza d'errore.</span><span class="sxs-lookup"><span data-stu-id="6726a-119">A Windows Server or WSFC cluster administrator will need to force a quorum and then bring the surviving cluster nodes back online in a non-fault-tolerant configuration.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="6726a-120">sono sottochiavi del cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="6726a-120">registry keys are subkeys of the WSFC cluster.</span></span> <span data-ttu-id="6726a-121">Se si elimina e si ricrea un cluster WSFC, è necessario disabilitare e riabilitare la funzionalità [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in ogni istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in cui è ospitata una replica di disponibilità nel cluster WSFC originale.</span><span class="sxs-lookup"><span data-stu-id="6726a-121">If you delete and re-create a WSFC cluster, you must disable and re-enable the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature on each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosted an availability replica on the original WSFC cluster.</span></span>  
  
 <span data-ttu-id="6726a-122">Per informazioni sull'esecuzione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] nei nodi WSFC (Windows Server Failover Clustering) e sul quorum WSFC, vedere [WSFC &#40;Windows Server Failover Clustering&#41; con SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6726a-122">For information about running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on Windows Server Failover Clustering (WSFC) nodes and about WSFC quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
### <a name="cross-cluster-migration-of-alwayson-availability-groups-for-os-upgrade"></a><span data-ttu-id="6726a-123">Migrazione tra cluster di gruppi di disponibilità AlwaysOn per l'aggiornamento del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="6726a-123">Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade</span></span>  
 <span data-ttu-id="6726a-124">A partire da [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] è supportata migrazione tra cluster di gruppi di disponibilità per distribuzioni in un nuovo cluster WSFC (Windows Server Failover Clustering).</span><span class="sxs-lookup"><span data-stu-id="6726a-124">Beginning with [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] supports cross-cluster migration of availability groups for deployments to a new Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="6726a-125">In una migrazione tra cluster un gruppo o un batch di gruppi di disponibilità viene spostato nel nuovo cluster WSFC di destinazione con tempi di inattività minimi.</span><span class="sxs-lookup"><span data-stu-id="6726a-125">A cross-cluster migration moves one availability group or a batch of availability groups to the new, destination WSFC cluster with minimal downtime.</span></span> <span data-ttu-id="6726a-126">Il processo di migrazione tra cluster consente di gestire i contratti di servizio (SLA, Service Level Agreement) durante l'aggiornamento a un cluster [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6726a-126">The cross-cluster migration process enables you to maintain your service level agreements (SLAs) when upgrading to a [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] cluster.</span></span> [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] <span data-ttu-id="6726a-127">(o versioni successive) deve essere installato e abilitato per AlwaysOn nel cluster WSFC di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6726a-127">(or a later version) must be installed and enabled for AlwaysOn on the destination WSFC cluster.</span></span> <span data-ttu-id="6726a-128">L'esito positivo della migrazione tra cluster dipende da una pianificazione e una preparazione dettagliate del cluster WSFC di destinazione.</span><span class="sxs-lookup"><span data-stu-id="6726a-128">The success of a cross-cluster migration depends on thorough planning and preparation of the destination WSFC cluster.</span></span>  
  
 <span data-ttu-id="6726a-129">Per ulteriori informazioni, vedere [Migrazione tra cluster di gruppi di disponibilità AlwaysOn per l'aggiornamento del sistema operativo](https://msdn.microsoft.com/library/jj873730.aspx).</span><span class="sxs-lookup"><span data-stu-id="6726a-129">For more information, see [Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade](https://msdn.microsoft.com/library/jj873730.aspx).</span></span>  
  
##  <a name="ssnoversion-failover-cluster-instances-fcis-and-availability-groups"></a><a name="SQLServerFC"></a><span data-ttu-id="6726a-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Istanze del cluster di failover (failover) e gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster Instances (FCIs) and Availability Groups</span></span>  
 <span data-ttu-id="6726a-131">È possibile configurare un secondo livello di failover a livello di istanza del server implementando il clustering di failover di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] insieme al cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="6726a-131">You can set up a second layer of failover at the server-instance level by implementing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering together with the WSFC cluster.</span></span> <span data-ttu-id="6726a-132">Una replica di disponibilità può essere ospitata da un'istanza autonoma di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o da un'istanza FCI.</span><span class="sxs-lookup"><span data-stu-id="6726a-132">An availability replica can be hosted by either a standalone instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or an FCI instance.</span></span> <span data-ttu-id="6726a-133">Solo un partner di un'istanza del cluster di failover può ospitare una replica per un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-133">Only one FCI partner can host a replica for a given availability group.</span></span> <span data-ttu-id="6726a-134">Quando una replica di disponibilità viene eseguita in un'istanza del cluster di failover, l'elenco dei possibili proprietari per il gruppo di disponibilità conterrà solo il nodo FCI attivo.</span><span class="sxs-lookup"><span data-stu-id="6726a-134">When an availability replica is running on an FCI, the possible owners list for the availability group will contain only the active FCI node.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="6726a-135">non dipende da alcun mezzo di archiviazione condivisa.</span><span class="sxs-lookup"><span data-stu-id="6726a-135">does not depend on any form of shared storage.</span></span> <span data-ttu-id="6726a-136">Tuttavia, se si utilizza un'istanza del cluster di failover (FCI) di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per ospitare una o più repliche di disponibilità, per ognuna di queste FCI sarà richiesta l'archiviazione condivisa in base all'installazione dell'istanza del cluster di failover di SQL Server standard.</span><span class="sxs-lookup"><span data-stu-id="6726a-136">However, if you use a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI) to host one or more availability replicas, each of those FCIs will require shared storage as per standard SQL Server failover cluster instance installation.</span></span>  
  
 <span data-ttu-id="6726a-137">Per altre informazioni sui prerequisiti aggiuntivi, vedere la sezione "Prerequisiti e restrizioni per l'uso di un'istanza del cluster di failover di SQL Server per ospitare una replica di disponibilità" di [Prerequisiti, restrizioni e consigli per i gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="6726a-137">For more information about additional prerequisites, see the "Prerequisites and Restrictions for Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica" section of [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
### <a name="comparison-of-failover-cluster-instances-and-availability-groups"></a><span data-ttu-id="6726a-138">Confronto tra le istanze del cluster di failover e i gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-138">Comparison of Failover Cluster Instances and Availability Groups</span></span>  
 <span data-ttu-id="6726a-139">Indipendentemente dal numero di nodi nell'istanza FCI, in un'intera FCI viene ospitata una sola replica all'interno di un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-139">Regardless of the number of nodes in the FCI, an entire FCI hosts a single replica within an availability group.</span></span> <span data-ttu-id="6726a-140">Nella tabella seguente sono descritte le differenze dei concetti tra i nodi di un'istanza FCI e le repliche all'interno di un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-140">The following table describes the distinctions in concepts between nodes in an FCI and replicas within an availability group.</span></span>  
  
||<span data-ttu-id="6726a-141">Nodi all'interno di un'istanza FCI</span><span class="sxs-lookup"><span data-stu-id="6726a-141">Nodes within an FCI</span></span>|<span data-ttu-id="6726a-142">Repliche all'interno di un gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-142">Replicas within an availability group</span></span>|  
|-|-------------------------|-------------------------------------------|  
|<span data-ttu-id="6726a-143">**Utilizzo di cluster WSFC**</span><span class="sxs-lookup"><span data-stu-id="6726a-143">**Uses WSFC cluster**</span></span>|<span data-ttu-id="6726a-144">Sì</span><span class="sxs-lookup"><span data-stu-id="6726a-144">Yes</span></span>|<span data-ttu-id="6726a-145">Sì</span><span class="sxs-lookup"><span data-stu-id="6726a-145">Yes</span></span>|  
|<span data-ttu-id="6726a-146">**Livello di protezione**</span><span class="sxs-lookup"><span data-stu-id="6726a-146">**Protection level**</span></span>|<span data-ttu-id="6726a-147">Istanza</span><span class="sxs-lookup"><span data-stu-id="6726a-147">Instance</span></span>|<span data-ttu-id="6726a-148">Database</span><span class="sxs-lookup"><span data-stu-id="6726a-148">Database</span></span>|  
|<span data-ttu-id="6726a-149">**Tipo di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="6726a-149">**Storage type**</span></span>|<span data-ttu-id="6726a-150">Condiviso</span><span class="sxs-lookup"><span data-stu-id="6726a-150">Shared</span></span>|<span data-ttu-id="6726a-151">Non condivisi</span><span class="sxs-lookup"><span data-stu-id="6726a-151">Non-shared</span></span><br /><br /> <span data-ttu-id="6726a-152">Si noti che, mentre le repliche di un gruppo di disponibilità non condividono le risorse di archiviazione, una replica ospitata da un'istanza del cluster di failover usa una soluzione di archiviazione condivisa come richiesto da tale istanza.</span><span class="sxs-lookup"><span data-stu-id="6726a-152">Note that while the replicas in an availability group do not share storage, a replica that is hosted by an FCI uses a shared storage solution as required by that FCI.</span></span> <span data-ttu-id="6726a-153">La soluzione di archiviazione è condivisa solo dai nodi all'interno dell'istanza FCI e non tra le repliche del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-153">The storage solution is shared only by nodes within the FCI and not between replicas of the availability group.</span></span>|  
|<span data-ttu-id="6726a-154">**Soluzioni di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="6726a-154">**Storage solutions**</span></span>|<span data-ttu-id="6726a-155">Collegamento diretto, rete SAN, punti di montaggio, SMB</span><span class="sxs-lookup"><span data-stu-id="6726a-155">Direct attached, SAN, mount points, SMB</span></span>|<span data-ttu-id="6726a-156">Dipende dal tipo di nodo</span><span class="sxs-lookup"><span data-stu-id="6726a-156">Depends on node type</span></span>|  
|<span data-ttu-id="6726a-157">**Secondarie leggibili**</span><span class="sxs-lookup"><span data-stu-id="6726a-157">**Readable secondaries**</span></span>|<span data-ttu-id="6726a-158">No\*</span><span class="sxs-lookup"><span data-stu-id="6726a-158">No\*</span></span>|<span data-ttu-id="6726a-159">Sì</span><span class="sxs-lookup"><span data-stu-id="6726a-159">Yes</span></span>|  
|<span data-ttu-id="6726a-160">**Impostazioni dei criteri di failover applicabili**</span><span class="sxs-lookup"><span data-stu-id="6726a-160">**Applicable failover policy settings**</span></span>|<span data-ttu-id="6726a-161">Quorum WSFC</span><span class="sxs-lookup"><span data-stu-id="6726a-161">WSFC quorum</span></span><br /><br /> <span data-ttu-id="6726a-162">Specifiche per FCI</span><span class="sxs-lookup"><span data-stu-id="6726a-162">FCI-specific</span></span><br /><br /> <span data-ttu-id="6726a-163">Impostazioni dei gruppi di disponibilità\*\*</span><span class="sxs-lookup"><span data-stu-id="6726a-163">Availability group settings\*\*</span></span>|<span data-ttu-id="6726a-164">Quorum WSFC</span><span class="sxs-lookup"><span data-stu-id="6726a-164">WSFC quorum</span></span><br /><br /> <span data-ttu-id="6726a-165">Impostazioni gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-165">Availability group settings</span></span>|  
|<span data-ttu-id="6726a-166">**Risorse di cui è stato eseguito il failover**</span><span class="sxs-lookup"><span data-stu-id="6726a-166">**Failed-over resources**</span></span>|<span data-ttu-id="6726a-167">Server, istanza e database</span><span class="sxs-lookup"><span data-stu-id="6726a-167">Server, instance, and database</span></span>|<span data-ttu-id="6726a-168">Solo database</span><span class="sxs-lookup"><span data-stu-id="6726a-168">Database only</span></span>|  
  
 <span data-ttu-id="6726a-169">\* Mentre le repliche secondarie sincrone di un gruppo di disponibilità sono sempre in esecuzione nelle rispettive istanze di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , i nodi secondari in un'istanza del cluster di failover non hanno avviato le rispettive istanze di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e quindi non sono leggibili.</span><span class="sxs-lookup"><span data-stu-id="6726a-169">\*Whereas synchronous secondary replicas in an availability group are always running on their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances, secondary nodes in an FCI actually have not started their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances and are therefore not readable.</span></span> <span data-ttu-id="6726a-170">In un'istanza FCI, un nodo secondario consente di avviare l'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] solo quando la proprietà del gruppo di risorse viene trasferita a questo nodo durante un failover dell'istanza FCI.</span><span class="sxs-lookup"><span data-stu-id="6726a-170">In an FCI, a secondary node starts its [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance only when the resource group ownership is transferred to it during an FCI failover.</span></span> <span data-ttu-id="6726a-171">Tuttavia, nel nodo FCI attivo, se un database ospitato da FCI appartiene a un gruppo di disponibilità e la replica di disponibilità locale è in esecuzione come replica secondaria leggibile, il database è leggibile.</span><span class="sxs-lookup"><span data-stu-id="6726a-171">However, on the active FCI node, when an FCI-hosted database belongs to an availability group, if the local availability replica is running as a readable secondary replica, the database is readable.</span></span>  
  
 <span data-ttu-id="6726a-172">\*\* Le impostazioni dei criteri di failover per il gruppo di disponibilità si applicano a tutte le repliche, indipendentemente dal fatto che siano ospitate in un'istanza autonoma o in un'istanza del cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="6726a-172">\*\*Failover policy settings for the availability group apply to all replicas, whether it is hosted in a standalone instance or an FCI instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6726a-173">Per ulteriori informazioni sul **numero di nodi** all'interno del clustering di Failover e **gruppi di disponibilità AlwaysOn** per edizioni diverse di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , vedere [funzionalità supportate dalle edizioni di SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) ( https://go.microsoft.com/fwlink/?linkid=232473) .</span><span class="sxs-lookup"><span data-stu-id="6726a-173">For more information about **Number of nodes** within Failover Clustering and **AlwaysOn Availability Groups** for different editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) (https://go.microsoft.com/fwlink/?linkid=232473).</span></span>  
  
### <a name="considerations-for-hosting-an-availability-replica-on-an-fci"></a><span data-ttu-id="6726a-174">Considerazioni sull'hosting di una replica di disponibilità in un'istanza FCI</span><span class="sxs-lookup"><span data-stu-id="6726a-174">Considerations for hosting an Availability Replica on an FCI</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6726a-175">Se si intende ospitare una replica di disponibilità in un'istanza del cluster di failover di SQL Server (FCI), assicurarsi che i nodi host di Windows Server 2008 soddisfino i prerequisiti e le restrizioni di AlwaysOn per le istanze del cluster di failover (FCI).</span><span class="sxs-lookup"><span data-stu-id="6726a-175">If you plan to host an availability replica on a SQL Server Failover Cluster Instance (FCI), ensure that the Windows Server 2008 host nodes meet the AlwaysOn prerequisites and restrictions for Failover Cluster Instances (FCIs).</span></span> <span data-ttu-id="6726a-176">Per altre informazioni, vedere [Prerequisiti, restrizioni e consigli per i gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="6726a-176">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="6726a-177">ha istanze del cluster di failover che non supportano il failover automatico da gruppi di disponibilità, quindi le repliche di disponibilità ospitate da un'istanza del cluster di failover possono essere configurate solo per il failover manuale.</span><span class="sxs-lookup"><span data-stu-id="6726a-177">Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>  
  
 <span data-ttu-id="6726a-178">Potrebbe essere necessario configurare un cluster WSCF (Windows Server Failover Clustering) per includere i dischi condivisi che non sono disponibili in tutti i nodi.</span><span class="sxs-lookup"><span data-stu-id="6726a-178">You might need to configure a Windows Server Failover Clustering (WSFC) cluster to include shared disks that are not available on all nodes.</span></span> <span data-ttu-id="6726a-179">Ad esempio, si consideri un cluster WSFC in due data center con tre nodi.</span><span class="sxs-lookup"><span data-stu-id="6726a-179">For example, consider a WSFC cluster across two data centers with three nodes.</span></span> <span data-ttu-id="6726a-180">A due dei nodi è consentito ospitare un'istanza del clustering di failover di SQL Server (FCI) nel data center principale, nonché accedere agli stessi dischi condivisi.</span><span class="sxs-lookup"><span data-stu-id="6726a-180">Two of the nodes host a SQL Server failover clustering instance (FCI) in the primary data center and have access to the same shared disks.</span></span> <span data-ttu-id="6726a-181">Al terzo nodo è permesso ospitare un'istanza autonoma di SQL Server in un data center diverso, ma non è consentito accedere ai dischi condivisi dal data center principale.</span><span class="sxs-lookup"><span data-stu-id="6726a-181">The third node hosts a stand-alone instance of SQL Server in a different data center and does not have access to the shared disks from the primary data center.</span></span> <span data-ttu-id="6726a-182">Questa configurazione del cluster WSFC supporta la distribuzione di un gruppo di disponibilità se nell'istanza FCI è ospitata la replica primaria e in quella autonoma la replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="6726a-182">This WSFC cluster configuration supports the deployment of an availability group if the FCI hosts the primary replica and the stand-alone instance hosts the secondary replica.</span></span>  
  
 <span data-ttu-id="6726a-183">Se si decide che in un'istanza FCI venga ospitata una replica di disponibilità per un determinato gruppo di disponibilità, assicurarsi che un failover dell'istanza FCI non possa comportare il tentativo da parte di un unico nodo WSFC di ospitare due repliche di disponibilità per lo stesso gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-183">When choosing an FCI to host an availability replica for a given availability group, ensure that an FCI failover could not potentially cause a single WSFC node to attempt to host two availability replicas for the same availability group.</span></span>  
  
 <span data-ttu-id="6726a-184">Nello scenario di esempio seguente si descrivono i potenziali problemi causati da questa configurazione:</span><span class="sxs-lookup"><span data-stu-id="6726a-184">The following example scenario illustrates how this configuration could lead to problems:</span></span>  
  
 <span data-ttu-id="6726a-185">Marcel configura un cluster WSFC con due nodi, `NODE01` e `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="6726a-185">Marcel configures two a WSFC cluster with two nodes, `NODE01` and `NODE02`.</span></span> <span data-ttu-id="6726a-186">Installa un'istanza del cluster di failover di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , `fciInstance1`, sia in `NODE01` sia in `NODE02` dove `NODE01` è il proprietario corrente di `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="6726a-186">He installs a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance, `fciInstance1`, on both `NODE01` and `NODE02` where `NODE01` is the current owner for `fciInstance1`.</span></span>  
 <span data-ttu-id="6726a-187">In `NODE02`Marcel installa un'altra istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, che è un'istanza autonoma.</span><span class="sxs-lookup"><span data-stu-id="6726a-187">On `NODE02`, Marcel installs another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, which is a stand-alone instance.</span></span>  
 <span data-ttu-id="6726a-188">In `NODE01`Marcel abilita fciInstance1 per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6726a-188">On `NODE01`, Marcel enables fciInstance1 for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="6726a-189">In `NODE02`abilita `Instance3` per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6726a-189">On `NODE02`, he enables `Instance3` for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="6726a-190">Successivamente configura un gruppo di disponibilità per il quale in `fciInstance1` è ospitata la replica primaria e in `Instance3` quella secondaria.</span><span class="sxs-lookup"><span data-stu-id="6726a-190">Then he sets up an availability group for which `fciInstance1` hosts the primary replica, and `Instance3` hosts the secondary replica.</span></span>  
 <span data-ttu-id="6726a-191">A un certo punto `fciInstance1` non è più disponibile in `NODE01`e il cluster WSFC comporta il failover di `fciInstance1` in `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="6726a-191">At some point `fciInstance1` becomes unavailable on `NODE01`, and the WSFC cluster causes a failover of `fciInstance1` to `NODE02`.</span></span> <span data-ttu-id="6726a-192">Dopo il failover, `fciInstance1` è un'istanza abilitata per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]in esecuzione nel ruolo primario di `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="6726a-192">After the failover, `fciInstance1` is a [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]-enabled instance running under the primary role on `NODE02`.</span></span> <span data-ttu-id="6726a-193">Tuttavia, `Instance3` si trova ora nello stesso nodo WSFC di `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="6726a-193">However, `Instance3` now resides on the same WSFC node as `fciInstance1`.</span></span> <span data-ttu-id="6726a-194">Viene pertanto violato il vincolo [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6726a-194">This violates the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] constraint.</span></span>  
 <span data-ttu-id="6726a-195">Per risolvere il problema presentato in questo scenario, l'istanza autonoma, `Instance3`, deve trovarsi in un altro nodo dello stesso cluster WSFC come per `NODE01` e `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="6726a-195">To correct the problem that this scenario presents, the stand-alone instance, `Instance3`, must reside on another node in the same WSFC cluster as `NODE01` and `NODE02`.</span></span>  
  
 <span data-ttu-id="6726a-196">Per altre informazioni sul clustering di failover di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], vedere [Istanze del cluster di failover AlwaysOn &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6726a-196">For more information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering, see [AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span></span>  
  
##  <a name="restrictions-on-using-the-wsfc-failover-cluster-manager-with-availability-groups"></a><a name="FCMrestrictions"></a><span data-ttu-id="6726a-197">Restrizioni sull'utilizzo del Gestione cluster di failover WSFC con i gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-197">Restrictions on Using The WSFC Failover Cluster Manager with Availability Groups</span></span>  
 <span data-ttu-id="6726a-198">Non utilizzare Gestione cluster di failover per modificare i gruppi di disponibilità, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6726a-198">Do not use the Failover Cluster Manager to manipulate availability groups, for example:</span></span>  
  
-   <span data-ttu-id="6726a-199">Non aggiungere o rimuovere risorse nel servizio del cluster (gruppo di risorse) per il gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-199">Do not add or remove resources in the clustered service (resource group) for the availability group.</span></span>  
  
-   <span data-ttu-id="6726a-200">Non modificare le proprietà del gruppo di disponibilità, ad esempio i possibili proprietari e i proprietari preferiti.</span><span class="sxs-lookup"><span data-stu-id="6726a-200">Do not change any availability group properties, such as the possible owners and preferred owners.</span></span> <span data-ttu-id="6726a-201">Queste proprietà vengono impostate automaticamente dal gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6726a-201">These properties are set automatically by the availability group.</span></span>  
  
-   <span data-ttu-id="6726a-202">Non utilizzare Gestione cluster di failover per spostare i gruppi di disponibilità in altri nodi o per effettuarne il failover.</span><span class="sxs-lookup"><span data-stu-id="6726a-202">Do not use the Failover Cluster Manager to move availability groups to different nodes or to fail over availability groups.</span></span> <span data-ttu-id="6726a-203">Gestione cluster di failover non è in grado di rilevare lo stato di sincronizzazione delle repliche di disponibilità, pertanto possono verificarsi tempi di inattività prolungati.</span><span class="sxs-lookup"><span data-stu-id="6726a-203">The Failover Cluster Manager is not aware of the synchronization status of the availability replicas, and doing so can lead to extended downtime.</span></span> <span data-ttu-id="6726a-204">È necessario utilizzare [!INCLUDE[tsql](../../../includes/tsql-md.md)] o [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6726a-204">You must use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="6726a-205">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="6726a-205">Related Content</span></span>  
  
-   <span data-ttu-id="6726a-206">**Blog:**</span><span class="sxs-lookup"><span data-stu-id="6726a-206">**Blogs:**</span></span>  
  
     [<span data-ttu-id="6726a-207">Pagina relativa alla configurazione del clustering di failover di Windows per SQL Server (gruppo di disponibilità o FCI) con sicurezza limitata</span><span class="sxs-lookup"><span data-stu-id="6726a-207">Configure Windows Failover Clustering for SQL Server (Availability Group or FCI) with Limited Security</span></span>](https://blogs.msdn.com/b/sqlalwayson/archive/2012/06/05/configure-windows-failover-clustering-for-sql-server-availability-group-or-fci-with-limited-security.aspx)  
  
     [<span data-ttu-id="6726a-208">Blog del team di SQL Server AlwaysOn: Blog ufficiale del team di SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="6726a-208">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
     [<span data-ttu-id="6726a-209">Pagina relativa ai blog del Servizio Supporto Tecnico Clienti per gli ingegneri di SQL Server</span><span class="sxs-lookup"><span data-stu-id="6726a-209">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)  
  
-   <span data-ttu-id="6726a-210">**White paper:**</span><span class="sxs-lookup"><span data-stu-id="6726a-210">**Whitepapers:**</span></span>  
  
     [<span data-ttu-id="6726a-211">Pagina relativa alla guida all'architettura di AlwaysOn in cui viene illustrata la compilazione di una soluzione a disponibilità elevata e di ripristino di emergenza utilizzando istanze del cluster di failover e gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="6726a-211">AlwaysOn Architecture Guide: Building a High Availability and Disaster Recovery Solution by Using Failover Cluster Instances and Availability Groups</span></span>](https://msdn.microsoft.com/library/jj215886.aspx)  
  
     [<span data-ttu-id="6726a-212">Pagina relativa alla guida alle soluzioni AlwaysOn di Microsoft SQL Server per la disponibilità elevata e il ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="6726a-212">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
     [<span data-ttu-id="6726a-213">Pagina relativa ai white paper Microsoft per SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="6726a-213">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)  
  
     [<span data-ttu-id="6726a-214">Pagina relativa ai white paper del team di consulenza clienti di SQL Server</span><span class="sxs-lookup"><span data-stu-id="6726a-214">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)  
  
## <a name="see-also"></a><span data-ttu-id="6726a-215">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6726a-215">See Also</span></span>  
 <span data-ttu-id="6726a-216">[Panoramica di Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [abilitare e disabilitare gruppi di disponibilità AlwaysOn](enable-and-disable-always-on-availability-groups-sql-server.md) &#40;SQL Server&#41;&#40;di [monitoraggio dei gruppi di disponibilità&#41;Transact-SQL](monitor-availability-groups-transact-sql.md)</span><span class="sxs-lookup"><span data-stu-id="6726a-216">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md) [Monitor Availability Groups &#40;Transact-SQL&#41;](monitor-availability-groups-transact-sql.md)</span></span>  
 [<span data-ttu-id="6726a-217">Istanze del cluster di failover AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="6726a-217">AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;</span></span>](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md) 
  
  
