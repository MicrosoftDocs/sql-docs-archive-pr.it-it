---
title: Failover e modalità di failover (Gruppi di disponibilità AlwaysOn) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], failover
- Availability Groups [SQL Server], failover modes
- failover [SQL Server], AlwaysOn Availability Groups
ms.assetid: 378d2d63-50b9-420b-bafb-d375543fda17
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: eb904cd0f0649c43553b5d6c8b031c5f284901f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87627991"
---
# <a name="failover-and-failover-modes-alwayson-availability-groups"></a><span data-ttu-id="73ea8-102">Failover e modalità di failover (gruppi di disponibilità AlwaysOn)</span><span class="sxs-lookup"><span data-stu-id="73ea8-102">Failover and Failover Modes (AlwaysOn Availability Groups)</span></span>
  <span data-ttu-id="73ea8-103">Nel contesto di un gruppo di disponibilità, il ruolo primario e il ruolo secondario delle repliche di disponibilità sono generalmente intercambiabili in un processo noto come *failover*.</span><span class="sxs-lookup"><span data-stu-id="73ea8-103">Within the context of an availability group, the primary role and secondary role of availability replicas are typically interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="73ea8-104">Sono disponibili tre tipi di failover: failover automatico (senza perdita di dati), failover manuale pianificato (senza perdita di dati) e failover manuale forzato (con possibile perdita di dati), in genere chiamato *failover forzato*.</span><span class="sxs-lookup"><span data-stu-id="73ea8-104">Three forms of failover exist: automatic failover (without data loss), planned manual failover (without data loss), and forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="73ea8-105">Con il failover automatico e il failover manuale pianificato vengono conservati tutti i dati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-105">Automatic and planned manual failover preserve all your data.</span></span> <span data-ttu-id="73ea8-106">Per un gruppo di disponibilità il failover si verifica a livello di replica di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-106">An availability group fails over at the availability-replica level.</span></span> <span data-ttu-id="73ea8-107">In pratica, il failover di un gruppo di disponibilità viene eseguito in una delle relative repliche secondarie, la *destinazione di failover*corrente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-107">That is, an availability group fails over to one of its secondary replicas (the current *failover target*).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="73ea8-108">Gli errori a livello di database, ad esempio un database ritenuto sospetto in seguito alla perdita di un file di dati, all'eliminazione di un database o al danneggiamento di un log delle transazioni, non causano il failover di un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-108">Issues at the database level, such as a database becoming suspect due to the loss of a data file, deletion of a database, or corruption of a transaction log, do not cause an availability group to failover.</span></span>  
  
 <span data-ttu-id="73ea8-109">Durante il failover, la destinazione del failover subentra al ruolo primario, recupera i database e li porta online come nuovi database primari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-109">During the failover, the failover target takes over the primary role, recovers its databases, and brings them online as the new primary databases.</span></span> <span data-ttu-id="73ea8-110">La replica primaria precedente, se disponibile, assume il ruolo secondario e i relativi database diventano database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-110">The former primary replica, when available, switches to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="73ea8-111">Potenzialmente, questi ruoli possono essere scambiati vicendevolmente o destinati a una destinazione del failover differente, in seguito a più errori o per scopi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-111">Potentially, these roles can switch back and forth (or to a different failover target) in response to multiple failures or for administrative purposes.</span></span>  
  
 <span data-ttu-id="73ea8-112">Le forme di failover supportate da una replica di disponibilità sono specificate dalla proprietà della *modalità di failover* .</span><span class="sxs-lookup"><span data-stu-id="73ea8-112">The form(s) of failover that a given availability replica supports is specified by the *failover mode* property.</span></span> <span data-ttu-id="73ea8-113">Per una replica di disponibilità specificata le modalità di failover possibili dipendono dalla [modalità di disponibilità](availability-modes-always-on-availability-groups.md) della replica, come segue:</span><span class="sxs-lookup"><span data-stu-id="73ea8-113">For a given availability replica, the possible failover modes depends on the [availability mode](availability-modes-always-on-availability-groups.md) of the replica, as follows:</span></span>  
  
-   <span data-ttu-id="73ea8-114">Le **repliche con commit sincrono** supportano due impostazioni: automatica e manuale.</span><span class="sxs-lookup"><span data-stu-id="73ea8-114">**Synchronous-commit replicas** support two settings-automatic or manual.</span></span> <span data-ttu-id="73ea8-115">L'impostazione automatica supporta sia il failover automatico sia quello manuale.</span><span class="sxs-lookup"><span data-stu-id="73ea8-115">The "automatic" setting supports both automatic failover and manual failover.</span></span> <span data-ttu-id="73ea8-116">Per impedire la perdita di dati, il failover automatico e il failover pianificato richiedono che la destinazione del failover sia una replica secondaria con commit sincrono con uno stato di sincronizzazione integro ad indicare che ogni database secondario sulla destinazione del failover è sincronizzato con il database primario corrispondente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-116">To prevent data loss, automatic failover and planned failover require that the failover target be a synchronous-commit secondary replica with a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span> <span data-ttu-id="73ea8-117">Quando una replica secondaria non soddisfa entrambe queste condizioni, supporta solo il failover forzato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-117">Whenever a secondary replica does not meet both of these conditions, it supports only forced failover.</span></span> <span data-ttu-id="73ea8-118">Si noti che il failover forzato è anche supportato da una replica il cui ruolo si trova nello stato RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="73ea8-118">Note that forced failover is also supported a replicas whose role is in the RESOLVING state.</span></span>  
  
-   <span data-ttu-id="73ea8-119">Le**repliche con commit asincrono** supportano solo la modalità di failover manuale.</span><span class="sxs-lookup"><span data-stu-id="73ea8-119">**Asynchronous-commit replicas** support only the manual failover mode.</span></span> <span data-ttu-id="73ea8-120">Inoltre, poiché non sono mai sincronizzate, supportano solo il failover forzato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-120">Moreover, because they are never synchronized, they support only forced failover.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="73ea8-121">Dopo un failover, le applicazioni client che devono accedere ai database primari devono connettersi alla nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-121">After a failover, client applications that need to access the primary databases must connect to the new primary replica.</span></span> <span data-ttu-id="73ea8-122">Inoltre, se la nuova replica secondaria è configurata per consentire l'accesso in sola lettura, le applicazioni client in sola lettura possono connettersi ad essa.</span><span class="sxs-lookup"><span data-stu-id="73ea8-122">Also, if the new secondary replica is configured to allow read-only access, read-only client applications can connect to it.</span></span> <span data-ttu-id="73ea8-123">Per informazioni sulla connessione dei client a un gruppo di disponibilità, vedere [Listener del gruppo di disponibilità, connettività client e failover dell'applicazione &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-123">For information about how clients connect to an availability group, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="73ea8-124">Termini e definizioni</span><span class="sxs-lookup"><span data-stu-id="73ea8-124">Terms and Definitions</span></span>  
 <span data-ttu-id="73ea8-125">Failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-125">Automatic failover</span></span>  
 <span data-ttu-id="73ea8-126">Failover che si verifica automaticamente alla perdita della replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-126">A failover that occurs automatically on the loss of the primary replica.</span></span> <span data-ttu-id="73ea8-127">Il failover automatico è supportato solo quando la replica primaria corrente e una replica secondaria sono entrambe configurate con la modalità di failover impostata su AUTOMATIC e la replica secondaria è attualmente sincronizzata.</span><span class="sxs-lookup"><span data-stu-id="73ea8-127">Automatic failover is supported only when the current primary and one secondary replica are both configured with failover mode set to AUTOMATIC and the secondary replica currently synchronized.</span></span>  <span data-ttu-id="73ea8-128">Se la modalità di failover della replica primaria o di quella secondaria è MANUAL, il failover automatico non è supportato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-128">If the failover mode of either the primary or secondary replica is MANUAL, automatic failover cannot occur.</span></span>  
  
 <span data-ttu-id="73ea8-129">Failover manuale pianificato (senza perdita di dati)</span><span class="sxs-lookup"><span data-stu-id="73ea8-129">Planned manual failover (without data loss)</span></span>  
 <span data-ttu-id="73ea8-130">Il failover manuale pianificato o *failover manuale*è un failover avviato da un amministratore del database, in genere per scopi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-130">Planned manual failover, or *manual failover*, is a failover that is initiated by a database administrator, typically, for administrative purposes.</span></span> <span data-ttu-id="73ea8-131">Un failover manuale pianificato è supportato solo se la replica primaria e la replica secondaria sono entrambe configurate per la modalità commit sincrono e la replica secondaria è attualmente sincronizzata (nello stato SYNCHRONIZED).</span><span class="sxs-lookup"><span data-stu-id="73ea8-131">A planned manual failover is supported only if both the primary replica and secondary replica are configured for synchronous-commit mode and the secondary replica is currently synchronized (in the SYNCHRONIZED state).</span></span> <span data-ttu-id="73ea8-132">Quando la replica secondaria di destinazione è sincronizzata, il failover manuale (senza perdita di dati) è possibile anche se la replica primaria è stata arrestata in modo anomalo perché i database secondari sono pronti per il failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-132">When the target secondary replica is synchronized, manual failover (without data loss) is possible even if the primary replica has crashed because the secondary databases are ready for failover.</span></span> <span data-ttu-id="73ea8-133">Un amministratore di database avvia manualmente un failover manuale.</span><span class="sxs-lookup"><span data-stu-id="73ea8-133">A database administrator manually initiates a manual failover.</span></span>  
  
 <span data-ttu-id="73ea8-134">Failover forzato (con possibile perdita di dati)</span><span class="sxs-lookup"><span data-stu-id="73ea8-134">Forced failover (with possible data loss)</span></span>  
 <span data-ttu-id="73ea8-135">Failover che può essere avviato da un amministratore del database quando nessuna replica secondaria è sincronizzata (SYNCHRONIZED) con la replica primaria o la replica primaria non è in esecuzione e nessuna replica secondaria è pronta per il failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-135">A failover that can be initiated by a database administrator when no secondary replica is SYNCHRONIZED with the primary replica or the primary replica is not running and no secondary replica is failover ready.</span></span> <span data-ttu-id="73ea8-136">Il failover forzato implica il rischio della perdita di dati ed è rigorosamente consigliato per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="73ea8-136">Forced failover risks possible data loss and is recommended strictly for disaster recovery.</span></span> <span data-ttu-id="73ea8-137">Il failover forzato è anche noto come failover manuale forzato, in quanto può essere avviato solo manualmente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-137">Forced failover is also known as forced manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="73ea8-138">Si tratta dell'unica forma di failover supportata nella modalità di disponibilità commit asincrono.</span><span class="sxs-lookup"><span data-stu-id="73ea8-138">This is the only form of failover supported by in asynchronous-commit availability mode.</span></span>  
  
 [!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)]  
 <span data-ttu-id="73ea8-139">In un determinato gruppo di disponibilità, coppia di repliche di disponibilità, inclusa la replica primaria corrente, configurata per la modalità commit sincrono con failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-139">Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="73ea8-140">An[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]diventa effettivo solo se la replica secondaria si trova attualmente nello stato SINCRONIZZATO con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-140">An[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)]  
 <span data-ttu-id="73ea8-141">In un determinato gruppo di disponibilità, set di due o tre repliche di disponibilità, inclusa la replica primaria corrente, configurato per la modalità commit sincrono, se presente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-141">Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="73ea8-142">Un [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]diventa effettivo solo se le repliche secondarie sono configurate per la modalità di failover manuale e almeno una replica secondaria si trova attualmente nello stato SINCRONIZZATO con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-142">A [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]  
 <span data-ttu-id="73ea8-143">In un determinato gruppo di disponibilità, il set di tutte le repliche di disponibilità il cui stato operativo è attualmente ONLINE, indipendentemente dalle modalità di disponibilità e di failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-143">Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="73ea8-144">Un [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]diventa rilevante quando nessuna replica secondaria si trova attualmente nello stato SINCRONIZZATO con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-144">The [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
##  <a name="overview-of-failover"></a><a name="Overview"></a> <span data-ttu-id="73ea8-145">Panoramica del failover</span><span class="sxs-lookup"><span data-stu-id="73ea8-145">Overview of Failover</span></span>  
 <span data-ttu-id="73ea8-146">Nella tabella seguente sono riportate le forme di failover supportate nelle diverse modalità di disponibilità e di failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-146">The following table summarizes which forms of failover are supported under different availability and failover modes.</span></span> <span data-ttu-id="73ea8-147">Per ogni associazione, la modalità di disponibilità e la modalità di failover effettive vengono determinate dall'intersezione delle modalità della replica primaria in aggiunta alle modalità di una o più repliche secondarie.</span><span class="sxs-lookup"><span data-stu-id="73ea8-147">For each pairing, the effective availability mode and failover mode is determined by the intersection of the modes of the primary replica plus the modes of one or more secondary replicas.</span></span>  
  
||<span data-ttu-id="73ea8-148">Modalità commit asincrono</span><span class="sxs-lookup"><span data-stu-id="73ea8-148">Asynchronous-commit mode</span></span>|<span data-ttu-id="73ea8-149">Modalità commit sincrono con modalità di failover manuale</span><span class="sxs-lookup"><span data-stu-id="73ea8-149">Synchronous-commit mode with manual-failover mode</span></span>|<span data-ttu-id="73ea8-150">Modalità commit sincrono con modalità di failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-150">Synchronous-commit mode with automatic-failover mode</span></span>|  
|-|-------------------------------|---------------------------------------------------------|------------------------------------------------------------|  
|<span data-ttu-id="73ea8-151">Failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-151">Automatic failover</span></span>|<span data-ttu-id="73ea8-152">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-152">No</span></span>|<span data-ttu-id="73ea8-153">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-153">No</span></span>|<span data-ttu-id="73ea8-154">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-154">Yes</span></span>|  
|<span data-ttu-id="73ea8-155">Failover manuale pianificato</span><span class="sxs-lookup"><span data-stu-id="73ea8-155">Planned manual failover</span></span>|<span data-ttu-id="73ea8-156">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-156">No</span></span>|<span data-ttu-id="73ea8-157">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-157">Yes</span></span>|<span data-ttu-id="73ea8-158">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-158">Yes</span></span>|  
|<span data-ttu-id="73ea8-159">failover forzato</span><span class="sxs-lookup"><span data-stu-id="73ea8-159">Forced failover</span></span>|<span data-ttu-id="73ea8-160">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-160">Yes</span></span>|<span data-ttu-id="73ea8-161">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-161">Yes</span></span>|<span data-ttu-id="73ea8-162">Sì**<sup>\*</sup>**</span><span class="sxs-lookup"><span data-stu-id="73ea8-162">Yes**<sup>\*</sup>**</span></span>|  
  
 <span data-ttu-id="73ea8-163">**<sup>\*</sup>** Se si esegue un comando di failover forzato su una replica secondaria sincronizzata, la replica secondaria si comporta come per un failover manuale.</span><span class="sxs-lookup"><span data-stu-id="73ea8-163">**<sup>\*</sup>**  If you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a manual failover.</span></span>  
  
 <span data-ttu-id="73ea8-164">Il periodo di tempo di non disponibilità del database durante un failover dipende dal tipo di failover e da ciò che lo ha causato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-164">The amount of time that the database is unavailable during a failover depends on the type of failover and its cause.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="73ea8-165">Per supportare le connessioni client dopo il failover, a eccezione dei database indipendenti, è necessario ricreare manualmente sul nuovo database primario gli account di accesso e i processi definiti sui database primari precedenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-165">To support client connections after failover, except for contained databases, logins and jobs defined on any of the former primary databases must be manually recreated on the new primary database.</span></span> <span data-ttu-id="73ea8-166">Per altre informazioni, vedere [Gestione di account di accesso e processi per i database di un gruppo di disponibilità &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-166">For more information, see [Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span></span>  
  
### <a name="failover-sets"></a><span data-ttu-id="73ea8-167">Set di failover</span><span class="sxs-lookup"><span data-stu-id="73ea8-167">Failover Sets</span></span>  
 <span data-ttu-id="73ea8-168">Le forme di failover possibili per un gruppo di disponibilità specificato possono essere comprese in termini di set di failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-168">The forms of failover that are possible for a given availability group can be understood in terms of failover sets.</span></span> <span data-ttu-id="73ea8-169">Un set di failover è composto dalla replica primaria e dalle repliche secondarie che supportano una forma specificata di failover, come riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="73ea8-169">A failover set consists of the primary replica and secondary replicas that support a given form of failover, as follows:</span></span>  
  
-   <span data-ttu-id="73ea8-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (facoltativo):**  In un determinato gruppo di disponibilità, coppia di repliche di disponibilità, inclusa la replica primaria corrente, configurata per la modalità commit sincrono con failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (optional):**  Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="73ea8-171">Un failover automatico impostato diventa effettivo solo se la replica secondaria si trova attualmente nello stato SYNCHRONIZED con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-171">An automatic failover set takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="73ea8-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (facoltativo):**  In un determinato gruppo di disponibilità, set di due o tre repliche di disponibilità, inclusa la replica primaria corrente, configurato per la modalità commit sincrono, se presente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (optional):**  Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="73ea8-173">Un failover con commit sincrono impostato diventa effettivo solo se le repliche secondarie sono configurate per la modalità di failover manuale e almeno una replica secondaria si trova nello stato SYNCHRONIZED con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-173">A synchronous-commit failover set takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="73ea8-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  In un determinato gruppo di disponibilità, il set di tutte le repliche di disponibilità il cui stato operativo è attualmente ONLINE, indipendentemente dalle modalità di disponibilità e di failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="73ea8-175">L'intero set di failover diventa rilevante quando nessuna replica secondaria si trova attualmente nello stato SYNCHRONIZED con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-175">The entire failover set becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 <span data-ttu-id="73ea8-176">Quando si configura una replica di disponibilità come commit sincrono con failover automatico, la replica di disponibilità diventa parte del [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span><span class="sxs-lookup"><span data-stu-id="73ea8-176">When you configure an availability replica as synchronous commit with automatic failover, the availability replica becomes part of the [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span></span> <span data-ttu-id="73ea8-177">Il fatto che un set diventi effettivo o meno dipende tuttavia dal database primario corrente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-177">However whether the set takes effect depends the current primary.</span></span> <span data-ttu-id="73ea8-178">Le forme di failover effettivamente possibili in un determinato momento dipendono dai set di failover attualmente effettivi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-178">The forms of failover that are actually possible at a given time depends on what failover sets are currently in effect.</span></span>  
  
 <span data-ttu-id="73ea8-179">Si consideri ad esempio un gruppo di disponibilità con quattro repliche di disponibilità:</span><span class="sxs-lookup"><span data-stu-id="73ea8-179">For example, consider an availability group that has four availability replicas, as follows:</span></span>  
  
|<span data-ttu-id="73ea8-180">Replica</span><span class="sxs-lookup"><span data-stu-id="73ea8-180">Replica</span></span>|<span data-ttu-id="73ea8-181">Impostazioni delle modalità di disponibilità e di failover</span><span class="sxs-lookup"><span data-stu-id="73ea8-181">Availability Mode and Failover Mode Settings</span></span>|  
|-------------|--------------------------------------------------|  
|<span data-ttu-id="73ea8-182">Una</span><span class="sxs-lookup"><span data-stu-id="73ea8-182">A</span></span>|<span data-ttu-id="73ea8-183">Commit sincrono con failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-183">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="73ea8-184">b</span><span class="sxs-lookup"><span data-stu-id="73ea8-184">B</span></span>|<span data-ttu-id="73ea8-185">Commit sincrono con failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-185">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="73ea8-186">C</span><span class="sxs-lookup"><span data-stu-id="73ea8-186">C</span></span>|<span data-ttu-id="73ea8-187">Commit sincrono solo con failover manuale pianificato</span><span class="sxs-lookup"><span data-stu-id="73ea8-187">Synchronous commit with planned manual failover only</span></span>|  
|<span data-ttu-id="73ea8-188">D</span><span class="sxs-lookup"><span data-stu-id="73ea8-188">D</span></span>|<span data-ttu-id="73ea8-189">Commit asincrono (solo con failover forzato)</span><span class="sxs-lookup"><span data-stu-id="73ea8-189">Asynchronous commit (with only forced failover)</span></span>|  
  
 <span data-ttu-id="73ea8-190">Il comportamento di failover di ogni replica secondaria dipende dalla replica di disponibilità che è attualmente la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-190">The failover behavior for each secondary replica depends on which availability replica is currently the primary replica.</span></span> <span data-ttu-id="73ea8-191">Fondamentalmente, per una determinata replica secondaria, il comportamento di failover è il caso peggiore data la replica primaria corrente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-191">Basically, for a given secondary replica, the failover behavior is the worst case given the current primary replica.</span></span> <span data-ttu-id="73ea8-192">Nell'illustrazione seguente viene descritto come il comportamento del failover di repliche secondarie varia a seconda della replica primaria corrente e se è configurato per la modalità con commit asincrono (solo con failover forzato) o la modalità con commit sincrono (con o senza failover automatico).</span><span class="sxs-lookup"><span data-stu-id="73ea8-192">The following figure illustrates how the failover behavior of secondary replicas varies depending on the current primary replica, and whether it is configured for asynchronous-commit mode (with only forced failover) or synchronous-commit mode (with or without automatic failover).</span></span>  
  
 <span data-ttu-id="73ea8-193">![Effetto del failover sulla configurazione della replica primaria](../../media/aoag-failoversetexample.gif "Effetto del failover sulla configurazione della replica primaria")</span><span class="sxs-lookup"><span data-stu-id="73ea8-193">![How primary replica configuration affects failover](../../media/aoag-failoversetexample.gif "How primary replica configuration affects failover")</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="73ea8-194">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="73ea8-194">Automatic Failover</span></span>  
 <span data-ttu-id="73ea8-195">In seguito a un failover automatico, una replica secondaria qualificata assume automaticamente il ruolo primario quando la replica primaria non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="73ea8-195">An automatic failover causes a qualified secondary replica to automatically transition to the primary role after the primary replica becomes unavailable.</span></span> <span data-ttu-id="73ea8-196">Il failover automatico è particolarmente appropriato quando il nodo WSFC che ospita la replica primaria è locale rispetto al nodo che ospita la replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-196">Automatic failover is best suited when the WSFC node that hosts the primary replica is local to the node that hosts the secondary replica.</span></span> <span data-ttu-id="73ea8-197">Ciò dipende dal fatto che la sincronizzazione dei dati funziona meglio con una latenza del messaggio bassa tra i computer e le connessioni client possono rimanere locali.</span><span class="sxs-lookup"><span data-stu-id="73ea8-197">This is because data synchronization works best with low message latency between computers and because client connections can remain local.</span></span>  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="RequiredConditions"></a> <span data-ttu-id="73ea8-198">Condizioni necessarie per un failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-198">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="73ea8-199">Il failover automatico si verifica solo se sussistono le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="73ea8-199">Automatic failover occurs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="73ea8-200">Presenza di un set di failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-200">An automatic failover set exists.</span></span> <span data-ttu-id="73ea8-201">Questo set è composto da una replica primaria e da una secondaria (la *destinazione del failover automatico*) entrambe configurate per la modalità con commit sincrono e impostate su AUTOMATIC per il failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-201">This set consists of a primary replica and a secondary replica (the *automatic failover target*) that are both configured for synchronous-commit mode and set to AUTOMATIC failover.</span></span> <span data-ttu-id="73ea8-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920" Se la replica primaria è impostata su MANUAL per il failover, il failover automatico non è supportato, anche se una replica secondaria è impostata su AUTOMATIC per il failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  If the primary replica is set MANUAL failover, automatic failover cannot occur, even if a secondary replica is set to AUTOMATIC failover.</span></span>  
  
     <span data-ttu-id="73ea8-203">Per altre informazioni, vedere [Modalità di disponibilità &#40;gruppi di disponibilità AlwaysOn&#41;](availability-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-203">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>  
  
-   <span data-ttu-id="73ea8-204">La destinazione del failover automatico deve avere uno stato di sincronizzazione integro ad indicare che ogni database secondario sulla destinazione del failover è sincronizzato con il database primario corrispondente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-204">The automatic failover target has a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span>  
  
    > [!TIP]  
    >  <span data-ttu-id="73ea8-205">Tramite i gruppi di disponibilità AlwaysOn viene monitorata l'integrità di entrambe le repliche in un set di failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-205">AlwaysOn Availability Groups monitors the health of both replicas in an automatic failover set.</span></span> <span data-ttu-id="73ea8-206">In caso di errore di una delle repliche, lo stato di integrità del gruppo di disponibilità è impostato su CRITICAL.</span><span class="sxs-lookup"><span data-stu-id="73ea8-206">If either replica fails, the availability group's health state is set to CRITICAL.</span></span> <span data-ttu-id="73ea8-207">In caso di errore della replica secondaria, il failover automatico non è possibile dal momento che la relativa destinazione non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="73ea8-207">If the secondary replica fails, automatic failover is not possible because the automatic failover target is unavailable.</span></span> <span data-ttu-id="73ea8-208">In caso di errore della replica primaria, verrà eseguito il failover del gruppo di disponibilità sulla replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-208">If the primary replica fails, the availability group will fail over to the secondary replica.</span></span> <span data-ttu-id="73ea8-209">Fino a quando la replica primaria precedente non torna online, non sarà disponibile alcuna destinazione di failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-209">Until the former primary replica comes online, no automatic failover target exists.</span></span> <span data-ttu-id="73ea8-210">In entrambi i casi, per garantire la disponibilità in caso di un errore sequenziale, è consigliabile configurare una replica secondaria diversa come destinazione del failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-210">In either case, to ensure availability in the unlikely case of a sequential failure, we recommend that you configure a different secondary replica as the automatic failover target.</span></span>  
    >   
    >  <span data-ttu-id="73ea8-211">Per altre informazioni, vedere [Usare i criteri AlwaysOn per visualizzare l'integrità di un gruppo di disponibilità &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) e [Modificare la modalità di failover di una replica di disponibilità &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-211">For more information, see [Use AlwaysOn Policies to View the Health of an Availability Group &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) and [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
-   <span data-ttu-id="73ea8-212">Il cluster WSFC (Windows Server Failover Clustering) dispone del quorum.</span><span class="sxs-lookup"><span data-stu-id="73ea8-212">The Windows Server Failover Clustering (WSFC) cluster has quorum.</span></span> <span data-ttu-id="73ea8-213">Per altre informazioni, vedere [Modalità quorum WSFC e configurazione del voto &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-213">For more information, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
-   <span data-ttu-id="73ea8-214">La replica primaria non è più disponibile e i livelli delle condizioni di failover definiti dai criteri di failover flessibili sono stati soddisfatti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-214">The primary replica has become unavailable, and the failover-condition levels defined by your the flexible failover policy have been met.</span></span> <span data-ttu-id="73ea8-215">Per informazioni sui livelli di condizione del failover, vedere [Criteri di failover flessibili per failover automatico di un gruppo di disponibilità &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-215">For information about failover-condition levels, see [Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="73ea8-216">Funzionamento del failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-216">How Automatic Failover Works</span></span>  
 <span data-ttu-id="73ea8-217">Un failover automatico dà inizio alla sequenza di azioni seguente:</span><span class="sxs-lookup"><span data-stu-id="73ea8-217">An automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="73ea8-218">Se l'istanza del server che ospita la replica primaria corrente è ancora in esecuzione, lo stato dei database primari diventa DISCONNECTED e tutti i client vengono disconnessi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-218">If the server instance that is hosting the current primary replica is still running, it changes the state of the primary databases to DISCONNECTED and disconnects all clients.</span></span>  
  
2.  <span data-ttu-id="73ea8-219">Se alcuni record del log sono in attesa in code di recupero sulla replica secondaria di destinazione, la replica secondaria applica i rimanenti record del log per completare il rollforward dei database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-219">If any log records are waiting in recovery queues on the target secondary replica, the secondary replica applies the remaining log records to finish rolling forward the secondary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73ea8-220">La quantità di tempo necessaria per applicare il log a un determinato database dipende dalla velocità del sistema, dal carico di lavoro recente e dal numero di record del log presenti nella coda di recupero.</span><span class="sxs-lookup"><span data-stu-id="73ea8-220">The amount of time required to apply the log to a given database depends on the speed of the system, the recent work load, and the amount of log in the recovery queue.</span></span>  
  
3.  <span data-ttu-id="73ea8-221">Le replica secondaria precedente assume il ruolo primario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-221">The former secondary replica transitions to the primary role.</span></span> <span data-ttu-id="73ea8-222">I relativi database diventano i database primari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-222">Its databases become the primary databases.</span></span> <span data-ttu-id="73ea8-223">La nuova replica primaria esegue il più rapidamente possibile il rollback di eventuali transazioni di cui non è ancora stato eseguito il commit (fase di rollback del recupero).</span><span class="sxs-lookup"><span data-stu-id="73ea8-223">The new primary replica rolls back any uncommitted transactions (the undo phase of recovery) as quickly as possible.</span></span> <span data-ttu-id="73ea8-224">I blocchi isolano queste transazioni in modo che il rollback venga eseguito in background mentre i client utilizzano il database.</span><span class="sxs-lookup"><span data-stu-id="73ea8-224">Locks isolate these uncommitted transactions, allowing roll back to occur in the background while clients use the database.</span></span> <span data-ttu-id="73ea8-225">Questo processo non prevede il rollback delle transazioni di cui è già stato eseguito il commit.</span><span class="sxs-lookup"><span data-stu-id="73ea8-225">This process does not roll back any committed transactions.</span></span>  
  
     <span data-ttu-id="73ea8-226">Un database secondario finché non viene connesso viene brevemente contrassegnato come NOT_SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-226">Until a given secondary database is connected, it is briefly marked as NOT_SYNCHRONIZED.</span></span> <span data-ttu-id="73ea8-227">Prima dell'avvio del recupero di rollback, i database secondari si possono connettere ai nuovi database primari e rapidamente passare allo stato SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-227">Before the rollback recovery starts, secondary databases can connect to the new primary databases and quickly transition to the SYNCHRONIZED state.</span></span> <span data-ttu-id="73ea8-228">La situazione migliore generalmente è per una terza replica con commit sincrono che rimane nel ruolo secondario dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="73ea8-228">The best case is usually for a third synchronous-commit replica that remains in the secondary role after the failover.</span></span>  
  
4.  <span data-ttu-id="73ea8-229">Al riavvio, l'istanza del server che ospita la replica primaria precedente riconosce che il ruolo primario è stato assunto da un'altra replica di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-229">Later, when the server instance that is hosting the former primary replica restarts, it recognizes that another availability replica now owns the primary role.</span></span> <span data-ttu-id="73ea8-230">La replica primaria precedente passa quindi al ruolo secondario e i relativi database diventano database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-230">The former primary replica transitions to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="73ea8-231">La nuova replica secondaria si connette alla replica primaria corrente e intercetta il più rapidamente possibile il relativo database fino ai database primari correnti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-231">The new secondary replica connects to the current primary replica and catches its database up to the current primary databases as quickly as possible.</span></span> <span data-ttu-id="73ea8-232">Non appena la nuova replica secondaria completa la risincronizzazione dei relativi database, il failover è nuovamente possibile nella direzione inversa.</span><span class="sxs-lookup"><span data-stu-id="73ea8-232">As soon as the new secondary replica has resynchronized its databases, failover is again possible, in the reverse direction.</span></span>  
  
###  <a name="to-configure-automatic-failover"></a><a name="EnableAutoFo"></a> <span data-ttu-id="73ea8-233">Per configurare il failover automatico</span><span class="sxs-lookup"><span data-stu-id="73ea8-233">To Configure Automatic Failover</span></span>  
 <span data-ttu-id="73ea8-234">Una replica di disponibilità può essere configurata per il supporto del failover automatico in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="73ea8-234">An availability replica can be configured to support automatic failover at any point.</span></span>  
  
 <span data-ttu-id="73ea8-235">**To configure automatic failover**</span><span class="sxs-lookup"><span data-stu-id="73ea8-235">**To configure automatic failover**</span></span>  
  
1.  <span data-ttu-id="73ea8-236">Assicurarsi che la replica secondaria sia configurata per l'utilizzo della modalità di disponibilità commit sincrono.</span><span class="sxs-lookup"><span data-stu-id="73ea8-236">Ensure that the secondary replica is configured to use the synchronous-commit availability mode.</span></span> <span data-ttu-id="73ea8-237">Per altre informazioni, vedere [Modificare la modalità di disponibilità di una replica di disponibilità &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-237">For more information, see [Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="73ea8-238">Impostare la modalità di failover su automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-238">Set the failover mode to automatic.</span></span> <span data-ttu-id="73ea8-239">Per altre informazioni, vedere [Modificare la modalità di failover di una replica di disponibilità &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-239">For more information, see [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="73ea8-240">Facoltativamente, modificare i criteri di failover flessibili del gruppo di disponibilità per specificare gli ordinamenti di errori che possono fare in modo che si verifichi un failover automatico.</span><span class="sxs-lookup"><span data-stu-id="73ea8-240">Optionally, change the flexible failover policy of the availability group to specify the sorts of failures that can cause an automatic failover to occur.</span></span> <span data-ttu-id="73ea8-241">Per altre informazioni, vedere [Configurare i criteri di failover flessibili per controllare le condizioni per il failover automatico &#40;Gruppi di disponibilità AlwaysOn&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  e [Criteri di failover per istanze del cluster di failover](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-241">For more information, see [Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span></span>  
  
##  <a name="planned-manual-failover-without-data-loss"></a><a name="ManualFailover"></a> <span data-ttu-id="73ea8-242">Failover manuale pianificato (senza perdita di dati)</span><span class="sxs-lookup"><span data-stu-id="73ea8-242">Planned Manual Failover (Without Data Loss)</span></span>  
 <span data-ttu-id="73ea8-243">Il failover manuale comporta il passaggio al ruolo primario di una replica secondaria sincronizzata dopo che un amministratore di database esegue un comando di failover manuale sull'istanza del server che ospita la replica secondaria di destinazione.</span><span class="sxs-lookup"><span data-stu-id="73ea8-243">A manual failover causes a synchronized secondary replica to transition to the primary role after a database administrator issues a manual-failover command on the server instance that hosts the target secondary replica.</span></span> <span data-ttu-id="73ea8-244">Per supportare il failover manuale, la replica secondaria e la replica primaria corrente devono essere entrambe configurate per la modalità commit sincrono, se presente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-244">To support manual failover, the secondary replica and the current primary replica must both be configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="73ea8-245">Di ogni database secondario sulla replica di disponibilità deve essere creato un join al gruppo di disponibilità e sincronizzato con il database primario corrispondente, vale a dire la replica secondaria deve essere sincronizzata.</span><span class="sxs-lookup"><span data-stu-id="73ea8-245">Every secondary database on the availability replica must be joined to the availability group and synchronized with its corresponding primary database (that is, the secondary replica must be synchronized).</span></span> <span data-ttu-id="73ea8-246">In questo modo si assicura che ogni transazione sottoposta a commit sul database primario precedente lo sia anche sul nuovo database primario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-246">This guarantees that every transaction that was committed on a former primary database has also been committed on the new primary database.</span></span> <span data-ttu-id="73ea8-247">I nuovi database primari risulteranno pertanto identici ai database primari precedenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-247">Therefore, the new primary databases are identical to the old primary databases.</span></span>  
  
 <span data-ttu-id="73ea8-248">Nella figura seguente vengono illustrate le fasi di un failover pianificato:</span><span class="sxs-lookup"><span data-stu-id="73ea8-248">The following figure illustrates the stages of a planned failover:</span></span>  
  
1.  <span data-ttu-id="73ea8-249">Prima del failover, la replica primaria è ospitata dall'istanza del server in `Node01`.</span><span class="sxs-lookup"><span data-stu-id="73ea8-249">Before the failover, the primary replica is hosted by the server instance on `Node01`.</span></span>  
  
2.  <span data-ttu-id="73ea8-250">Un amministratore di database avvia un failover pianificato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-250">A database administrator initiates a planned failover.</span></span> <span data-ttu-id="73ea8-251">La destinazione del failover è la replica di disponibilità ospitata dall'istanza del server in `Node02`.</span><span class="sxs-lookup"><span data-stu-id="73ea8-251">The failover target is the availability replica hosted by the server instance on `Node02`.</span></span>  
  
3.  <span data-ttu-id="73ea8-252">La destinazione del failover (in `Node02`) diventa la nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-252">The failover target (on `Node02`) becomes the new primary replica.</span></span> <span data-ttu-id="73ea8-253">Poiché questo è un failover pianificato, la prima replica primaria passa al ruolo secondario durante il failover e porta immediatamente i database online come database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-253">Because this is a planned failover, the former primary replica switches to the secondary role during the failover and brings its databases online as secondary databases immediately.</span></span>  
  
 <span data-ttu-id="73ea8-254">![Illustrazione di un failover manuale pianificato](../../media/aoag-plannedmanualfailover.gif "Illustrazione di un failover manuale pianificato")</span><span class="sxs-lookup"><span data-stu-id="73ea8-254">![Illustation of a planned manual failover](../../media/aoag-plannedmanualfailover.gif "Illustation of a planned manual failover")</span></span>  
  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ManualFailoverConditions"></a> <span data-ttu-id="73ea8-255">Condizioni necessarie per un failover manuale</span><span class="sxs-lookup"><span data-stu-id="73ea8-255">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="73ea8-256">Per supportare un failover manuale, la replica primaria corrente deve essere impostata sulla modalità commit sincrono e una replica secondaria deve essere:</span><span class="sxs-lookup"><span data-stu-id="73ea8-256">To support a manual failover, the current primary replica must be set to synchronous-commit mode and a secondary replica must be:</span></span>  
  
-   <span data-ttu-id="73ea8-257">Configurata per la modalità commit sincrono.</span><span class="sxs-lookup"><span data-stu-id="73ea8-257">Configured for synchronous-commit mode.</span></span>  
  
-   <span data-ttu-id="73ea8-258">Attualmente sincronizzata con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-258">Currently synchronized with the primary replica.</span></span>  
  
 <span data-ttu-id="73ea8-259">Per eseguire manualmente il failover su un gruppo di disponibilità, è necessario connettersi alla replica secondaria che deve diventare la nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-259">To manually fail over an availability group, you must be connected to the secondary replica that is to become the new primary replica.</span></span>  
  
###  <a name="how-a-planned-manual-failover-works"></a><a name="ManualFailoverHowWorks"></a> <span data-ttu-id="73ea8-260">Funzionamento del failover manuale pianificato</span><span class="sxs-lookup"><span data-stu-id="73ea8-260">How a Planned Manual Failover Works</span></span>  
 <span data-ttu-id="73ea8-261">Il failover manuale pianificato, che deve essere avviato sulla replica secondaria di destinazione, dà inizio alla sequenza di azioni seguente:</span><span class="sxs-lookup"><span data-stu-id="73ea8-261">A planned manual failover, which must be initiated on the target secondary replica, initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="73ea8-262">Per assicurarsi che nessuna nuova transazione utente si verifichi sui database primari originali, il cluster WSFC invia una richiesta alla replica primaria per passare alla modalità offline.</span><span class="sxs-lookup"><span data-stu-id="73ea8-262">To ensure that no new user transactions occur on the original primary databases, the WSFC cluster sends a request to the primary replica to go offline.</span></span>  
  
2.  <span data-ttu-id="73ea8-263">Se alcuni log sono in attesa nella coda di recupero di un database secondario qualsiasi, la replica secondaria completa il rollforward di quel database secondario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-263">If any log is waiting in the recovery queue of any secondary database, the secondary replica finishes rolling forward that secondary database.</span></span> <span data-ttu-id="73ea8-264">La quantità di tempo necessaria dipende dalla velocità del sistema, dal carico di lavoro recente e dal numero di record del log nella coda di recupero.</span><span class="sxs-lookup"><span data-stu-id="73ea8-264">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the recovery queue.</span></span> <span data-ttu-id="73ea8-265">Per conoscere le dimensioni correnti della coda di recupero, usare il contatore delle prestazioni **Coda di recupero** .</span><span class="sxs-lookup"><span data-stu-id="73ea8-265">To learn the current size of the recovery queue, use the **Recovery Queue** performance counter.</span></span> <span data-ttu-id="73ea8-266">Per altre informazioni, vedere [SQL Server, replica di database](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-266">For more information, see [SQL Server, Database Replica](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73ea8-267">Il tempo di failover può essere regolato limitando le dimensioni della coda di recupero.</span><span class="sxs-lookup"><span data-stu-id="73ea8-267">The failover time can be regulated by limiting the size of the recovery queue.</span></span> <span data-ttu-id="73ea8-268">Questa operazione, tuttavia, può causare un rallentamento della replica primaria a vantaggio della replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-268">However, this can cause the primary replica to slow down to allow the secondary replica to keep up.</span></span>  
  
3.  <span data-ttu-id="73ea8-269">La replica secondaria diventa la nuova replica primaria e la replica primaria precedente diventa la nuova replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-269">The secondary replica becomes the new primary replica, and the former primary replica becomes the new secondary replica.</span></span>  
  
4.  <span data-ttu-id="73ea8-270">La nuova replica primaria esegue il rollback di eventuali transazioni di cui non è stato eseguito il commit e porta online i database come database primari. Tutti i database secondari vengono brevemente contrassegnati come NOT_SYNCHRONIZED finché non vengono connessi e risincronizzati con i nuovi database primari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-270">The new primary replica rolls back any uncommitted transactions and brings its databases online as the primary databases.All secondary databases are briefly marked as NOT SYNCHRONIZED until they connect and resynchronize to the new primary databases.</span></span> <span data-ttu-id="73ea8-271">Questo processo non prevede il rollback delle transazioni di cui è già stato eseguito il commit.</span><span class="sxs-lookup"><span data-stu-id="73ea8-271">This process does not roll back any committed transactions.</span></span>  
  
5.  <span data-ttu-id="73ea8-272">Quando la replica primaria precedente viene riportata online, assume il ruolo secondario e il database primario diventa il database secondario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-272">When the former primary replica comes back online, it takes on the secondary role, and the former primary database becomes the secondary database.</span></span> <span data-ttu-id="73ea8-273">La nuova replica secondaria risincronizza rapidamente i nuovi database secondari con i database primari corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-273">The new secondary replica quickly resynchronizes the new secondary databases with the corresponding primary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="73ea8-274">Non appena la nuova replica secondaria completa la risincronizzazione dei database, il failover è nuovamente possibile nella direzione inversa.</span><span class="sxs-lookup"><span data-stu-id="73ea8-274">As soon as the new secondary replica has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="73ea8-275">Dopo il failover, è necessario riconnettere i client al database primario corrente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-275">After failover, clients must reconnect to the current primary database.</span></span> <span data-ttu-id="73ea8-276">Per altre informazioni, vedere [Listener del gruppo di disponibilità, connettività client e failover dell'applicazione &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-276">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="ManualFailoverDuringUpgrades"></a> <span data-ttu-id="73ea8-277">Mantenimento della disponibilità durante gli aggiornamenti</span><span class="sxs-lookup"><span data-stu-id="73ea8-277">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="73ea8-278">L'amministratore di database per i gruppi di disponibilità può utilizzare i failover manuali per gestire la disponibilità dei database durante aggiornamenti hardware o software.</span><span class="sxs-lookup"><span data-stu-id="73ea8-278">The database administrator for your availability groups can use manual failovers to maintain database availability when you upgrade hardware or software.</span></span> <span data-ttu-id="73ea8-279">Per utilizzare un gruppo di disponibilità per aggiornamenti software, l'istanza del server e/o il nodo computer che ospita la replica secondaria di destinazione deve avere già ricevuto gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-279">To use an availability group for software upgrades, the server instance and/or computer node that hosts the target secondary replica must have already received the upgrades.</span></span> <span data-ttu-id="73ea8-280">Per altre informazioni, vedere [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-280">For more information, see [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span></span>  
  
##  <a name="forced-failover-with-possible-data-loss"></a><a name="ForcedFailover"></a> <span data-ttu-id="73ea8-281">Failover forzato (con possibile perdita di dati)</span><span class="sxs-lookup"><span data-stu-id="73ea8-281">Forced Failover (with Possible Data Loss)</span></span>  
 <span data-ttu-id="73ea8-282">Il failover forzato di un gruppo di disponibilità (con possibile perdita di dati) è un metodo di ripristino di emergenza che consente di usare una replica secondaria come server warm standby. Dal momento che il failover forzato implica il rischio di possibili perdite di dati, è consigliabile usarlo con cautela e quando strettamente necessario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-282">Forcing failover of an availability group (with possible data loss) is a disaster recovery method that allows you to use a secondary replica as a warm standby server.Because forcing failover risks possible data loss, it should be used cautiously and sparingly.</span></span> <span data-ttu-id="73ea8-283">È consigliabile forzare il failover solo se è necessario ripristinare immediatamente il servizio sui database di disponibilità e si è disposti a rischiare la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-283">We recommend forcing failover only if you must restore service to your availability databases immediately and are willing to risk losing data.</span></span> <span data-ttu-id="73ea8-284">Per altre informazioni sui prerequisiti, consigli per il failover forzato e uno scenario di esempio che usa il failover forzato per il ripristino da un errore irreversibile, vedere [Eseguire un failover manuale forzato di un gruppo di disponibilità &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-284">For more information about the prerequisites and recommendations for forcing failover and for an example scenario that uses a forced failover to recover from a catastrophic failure, see [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="73ea8-285">Il failover forzato richiede che il cluster WSFC disponga di quorum.</span><span class="sxs-lookup"><span data-stu-id="73ea8-285">Forcing failover requires that the WSFC cluster have quorum.</span></span> <span data-ttu-id="73ea8-286">Per informazioni sulla configurazione e la forzatura del quorum, vedere [WSFC &#40;Windows Server Failover Clustering&#41; con SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-286">For information about configuring quorum and forcing quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
  
###  <a name="how-forced-failover-works"></a><a name="ForcedFailoverHowWorks"></a> <span data-ttu-id="73ea8-287">Funzionamento del failover forzato</span><span class="sxs-lookup"><span data-stu-id="73ea8-287">How Forced Failover Works</span></span>  
 <span data-ttu-id="73ea8-288">Tramite il failover forzato viene avviata una transizione del ruolo primario a una replica di destinazione il cui ruolo si trova nello stato SECONDARY o RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="73ea8-288">Forcing failover initiates a transition of the primary role to a target replica whose role is in the SECONDARY or RESOLVING state.</span></span> <span data-ttu-id="73ea8-289">La destinazione del failover diventa la nuova replica primaria e tramite essa le copie dei database diventano immediatamente disponibili ai client.</span><span class="sxs-lookup"><span data-stu-id="73ea8-289">The failover target becomes the new primary replica and immediately serves its copies of the databases to clients.</span></span> <span data-ttu-id="73ea8-290">Quando la replica primaria precedente diventa disponibile, assume il ruolo secondario e i relativi database diventano database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-290">When the former primary replica becomes available, it will transition to the secondary role and its databases will become secondary databases.</span></span>  
  
 <span data-ttu-id="73ea8-291">Tutti i database secondari (compresi i database primari precedenti, una volta diventati disponibili) si trovano nello stato SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-291">All secondary databases (including the former primary databases, when they become available) are SUSPENDED.</span></span> <span data-ttu-id="73ea8-292">A seconda dello stato della sincronizzazione dei dati precedente di un database secondario sospeso, potrebbe essere adatto per recuperare i dati mancanti di cui è stato eseguito il commit per il database primario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-292">Depending on the previous data synchronization state of a suspended secondary database, it might be suitable for salvaging missing committed data for that primary database.</span></span> <span data-ttu-id="73ea8-293">Su una replica secondaria configurata per l'accesso in sola lettura, è possibile eseguire query sui database secondari per individuare manualmente i dati mancanti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-293">On a secondary replica that is configured for read-only access, you can query the secondary databases to manually discover missing data.</span></span> <span data-ttu-id="73ea8-294">È quindi possibile eseguire istruzioni [!INCLUDE[tsql](../../../includes/tsql-md.md)] per apportare le modifiche necessarie sui nuovi database primari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-294">Then you can issue [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements on the new primary databases to make any necessary changes.</span></span>  
  
###  <a name="risks-of-forcing-failover"></a><a name="ForcedFailoverRisks"></a> <span data-ttu-id="73ea8-295">Rischi correlati al failover forzato</span><span class="sxs-lookup"><span data-stu-id="73ea8-295">Risks of Forcing Failover</span></span>  
 <span data-ttu-id="73ea8-296">È fondamentale comprendere che il failover forzato può causare la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-296">It is essential to understand that forcing failover can cause data loss.</span></span> <span data-ttu-id="73ea8-297">La perdita di dati è possibile in quanto tramite la replica di destinazione non è possibile comunicare con la replica primaria e pertanto non è possibile garantire che i database siano sincronizzati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-297">Data loss is possible because the target replica cannot communicate with the primary replica and, therefore, cannot guarantee that the databases are synchronized.</span></span> <span data-ttu-id="73ea8-298">Il failover forzato comporta l'avvio di un nuovo fork di recupero.</span><span class="sxs-lookup"><span data-stu-id="73ea8-298">Forcing failover starts a new recovery fork.</span></span> <span data-ttu-id="73ea8-299">Poiché i database primari originali e i database secondari si trovano su fork di recupero diversi, ognuno di essi contiene dati che l'altro database non contiene: ogni database primario originale contiene tutte le modifiche non inviate al database secondario precedente dalla sua coda di invio (log non inviato). I database secondari precedenti contengono tutte le modifiche apportate dopo il failover forzato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-299">Because the original primary databases and secondary databases are on different recovery forks, each of them now contains data that the other database does not contain: each original primary database contains whatever changes were not yet sent from its send queue to the former secondary database (the unsent log); the former secondary databases contain whatever changes occur after failover was forced.</span></span>  
  
 <span data-ttu-id="73ea8-300">Se il failover viene forzato a causa di un errore della replica primaria, la potenziale perdita di dati dipende dal fatto che uno o più log delle transazioni non siano stati inviati alla replica secondaria prima dell'errore.</span><span class="sxs-lookup"><span data-stu-id="73ea8-300">If failover is forced because the primary replica has failed, potential data loss is depends on whether any transaction logs had not been sent to the secondary replica before the failure.</span></span> <span data-ttu-id="73ea8-301">Nella modalità commit asincrono, la presenza di log non inviati accumulati è sempre una possibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-301">Under the asynchronous-commit mode, accumulated unsent log is always a possibility.</span></span> <span data-ttu-id="73ea8-302">Nella modalità commit sincrono, questo è possibile solo fino a quando i database secondari non diventano sincronizzati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-302">Under synchronous-commit mode, this is possible only until the secondary databases becomes synchronized.</span></span>  
  
 <span data-ttu-id="73ea8-303">Nella tabella seguente è riepilogata la possibilità di perdita di dati per un particolare database sulla replica a cui viene applicato un failover forzato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-303">The following table summarizes the possibility of data loss for a particular database on the replica to which you force failover.</span></span>  
  
|<span data-ttu-id="73ea8-304">Modalità di disponibilità della replica secondaria</span><span class="sxs-lookup"><span data-stu-id="73ea8-304">Availability mode of Secondary Replica</span></span>|<span data-ttu-id="73ea8-305">Il database è sincronizzato?</span><span class="sxs-lookup"><span data-stu-id="73ea8-305">Is database synchronized?</span></span>|<span data-ttu-id="73ea8-306">È possibile che si verifichi una perdita dei dati?</span><span class="sxs-lookup"><span data-stu-id="73ea8-306">Is data loss possible?</span></span>|  
|--------------------------------------------|-------------------------------|----------------------------|  
|<span data-ttu-id="73ea8-307">Synchronous-commit</span><span class="sxs-lookup"><span data-stu-id="73ea8-307">Synchronous-commit</span></span>|<span data-ttu-id="73ea8-308">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-308">Yes</span></span>|<span data-ttu-id="73ea8-309">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-309">No</span></span>|  
|<span data-ttu-id="73ea8-310">Synchronous-commit</span><span class="sxs-lookup"><span data-stu-id="73ea8-310">Synchronous-commit</span></span>|<span data-ttu-id="73ea8-311">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-311">No</span></span>|<span data-ttu-id="73ea8-312">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-312">Yes</span></span>|  
|<span data-ttu-id="73ea8-313">Asynchronous-commit</span><span class="sxs-lookup"><span data-stu-id="73ea8-313">Asynchronous-commit</span></span>|<span data-ttu-id="73ea8-314">No</span><span class="sxs-lookup"><span data-stu-id="73ea8-314">No</span></span>|<span data-ttu-id="73ea8-315">Sì</span><span class="sxs-lookup"><span data-stu-id="73ea8-315">Yes</span></span>|  
||||  
  
 <span data-ttu-id="73ea8-316">I database secondari registrano solo due fork di recupero, pertanto se si eseguono più failover forzati, qualsiasi database secondario che abbia dato inizio alla sincronizzazione dati con il failover forzato precedente non potrà essere ripreso.</span><span class="sxs-lookup"><span data-stu-id="73ea8-316">Secondary databases track only two recovery forks, so if you perform multiple forced failovers, any secondary database that did start data synchronization with the previous force failover might not be able to resume.</span></span> <span data-ttu-id="73ea8-317">In questo caso, i database secondari che non possono essere ripresi dovranno essere rimossi dal gruppo di disponibilità, ripristinati fino al momento corretto e nuovamente aggiunti al gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-317">If this occurs, any secondary databases that cannot be resumed will need to be removed from the availability group, restored to the correct point in time, and rejoined to the availability group.</span></span> <span data-ttu-id="73ea8-318">Un ripristino non funziona tra più fork di recupero, pertanto, assicurarsi di eseguire un backup del log dopo avere eseguito più failover forzati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-318">A restore will not work across multiple recovery forks, therefore, be sure to perform a log backup after performing more than one forced failover.</span></span>  
  
###  <a name="why-forced-failover-is-required-after-forcing-quorum"></a><a name="WhyFFoPostForcedQuorum"></a> <span data-ttu-id="73ea8-319">Motivi per cui è necessario il failover forzato dopo aver forzato il quorum</span><span class="sxs-lookup"><span data-stu-id="73ea8-319">Why Forced Failover is Required After Forcing Quorum</span></span>  
 <span data-ttu-id="73ea8-320">Dopo aver forzato il quorum sul cluster WSFC (*quorum forzato*), sarà necessario effettuare un failover forzato (con possibile perdita di dati) su ogni gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-320">After quorum is forced on the WSFC cluster (*forced quorum*) you need to perform a forced failover (with possible data loss) on each availability group.</span></span> <span data-ttu-id="73ea8-321">Il failover forzato è necessario poiché lo stato effettivo dei valori del cluster WSFC potrebbe essere andato perso.</span><span class="sxs-lookup"><span data-stu-id="73ea8-321">The forced failover is required because the real state of the WSFC cluster values might have been lost.</span></span> <span data-ttu-id="73ea8-322">Dopo un quorum forzato è necessario evitare i failover normali poiché una replica secondaria non sincronizzata potrebbe essere visualizzata come sincronizzata nel cluster WSFC riconfigurato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-322">Preventing normal failovers after a forced quorum is required because of the possibility than an unsynchronized secondary replica would appear to be synchronized on the reconfigured WSFC cluster.</span></span>  
  
 <span data-ttu-id="73ea8-323">Si consideri ad esempio un cluster WSFC che ospita un gruppo di disponibilità in tre nodi:  il nodo A ospita la replica primaria e sia il nodo B che il nodo C ospitano una replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-323">For example, consider a WSFC cluster that hosts an availability group on three nodes:  Node A hosts the primary replica and Node B and Node C each hosts a secondary replica.</span></span> <span data-ttu-id="73ea8-324">Il nodo C viene disconnesso dal cluster WSFC mentre la replica secondaria locale è sincronizzata (SYNCHRONIZED).</span><span class="sxs-lookup"><span data-stu-id="73ea8-324">Node C gets disconnected from the WSFC cluster while the local secondary replica is SYNCHRONIZED.</span></span>  <span data-ttu-id="73ea8-325">Tuttavia, nei nodi A e B viene mantenuto un quorum integro e il gruppo di disponibilità rimane online.</span><span class="sxs-lookup"><span data-stu-id="73ea8-325">But Node A and Node B retain a healthy quorum and the availability group remains online.</span></span> <span data-ttu-id="73ea8-326">Nel nodo A gli aggiornamenti continuano ad essere accettati dalla replica primaria, mentre nel nodo B prosegue la sincronizzazione della replica secondaria con quella primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-326">On Node A, the primary replica continues to accept updates, and on Node B, the secondary replica continues to synchronize with the primary replica.</span></span> <span data-ttu-id="73ea8-327">La replica secondaria nel nodo C diventa non sincronizzata e viene persa la sincronizzazione con la replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-327">The secondary replica on Node C becomes unsynchronized and falls increasingly behind the primary replica.</span></span> <span data-ttu-id="73ea8-328">Tuttavia, poiché il nodo C è disconnesso, la replica rimane, in modo non corretto, nello stato SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-328">However, because Node C is disconnected, the replica remains, incorrectly, in the SYNCHRONIZED state.</span></span>  
  
 <span data-ttu-id="73ea8-329">Se il quorum viene perso e, successivamente, viene forzato nel nodo A, lo stato di sincronizzazione del gruppo di disponibilità nel cluster WSFC deve essere corretto, con la replica secondaria nel nodo C visualizzata come UNSYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-329">If quorum is lost and is then forced on Node A, the synchronization state of the availability group on the WSFC cluster should be correct-with the secondary replica on Node C shown as UNSYNCHRONIZED.</span></span> <span data-ttu-id="73ea8-330">Tuttavia, se il quorum viene forzato nel nodo C, la sincronizzazione del gruppo di disponibilità non sarà corretta.</span><span class="sxs-lookup"><span data-stu-id="73ea8-330">However, if quorum is forced on Node C, the synchronization of the availability group will be incorrect.</span></span> <span data-ttu-id="73ea8-331">Nel cluster verrà ripristinato lo stato di sincronizzazione attivo quando il nodo C era disconnesso, con la replica secondaria nel nodo C visualizzata *erroneamente* come SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-331">The synchronization state on the cluster will have reverted back to when Node C was disconnected-with the secondary replica on Node C *incorrectly* shown as SYNCHRONIZED.</span></span> <span data-ttu-id="73ea8-332">Poiché tramite i failover manuali pianificati viene garantita la sicurezza dei dati, una volta forzato il quorum non è consentito riportare un gruppo di disponibilità online.</span><span class="sxs-lookup"><span data-stu-id="73ea8-332">Since planned manual failovers guarantee the safety of the data, they are disallowed for bring an availability group back online after quorum is forced.</span></span>  
  
###  <a name="tracking-potential-data-loss"></a><a name="TrackPotentialDataLoss"></a> <span data-ttu-id="73ea8-333">Come tenere traccia della potenziale perdita di dati</span><span class="sxs-lookup"><span data-stu-id="73ea8-333">Tracking Potential Data Loss</span></span>  
 <span data-ttu-id="73ea8-334">Quando nel cluster WSFC è disponibile un quorum integro, è possibile stimare il potenziale rischio corrente di perdita di dati nei database.</span><span class="sxs-lookup"><span data-stu-id="73ea8-334">When the WSFC cluster has a healthy quorum, you can estimate the current potential for data loss on databases.</span></span> <span data-ttu-id="73ea8-335">Per una replica secondaria specifica, il potenziale rischio corrente di perdita di dati dipende dal ritardo dei database secondari locali rispetto ai database primari corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-335">For a given secondary replica, the current potential for data loss depends on how far the local secondary databases are lagging behind the corresponding primary databases.</span></span> <span data-ttu-id="73ea8-336">Poiché la quantità di ritardo varia nel tempo, è consigliabile tenere traccia periodicamente della perdita di dati potenziale per i database secondari non sincronizzati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-336">Because the amount of lag varies over time, we recommend that you periodically track potential data loss for your unsynchronized secondary databases.</span></span> <span data-ttu-id="73ea8-337">Ai fini del rilevamento del ritardo è necessario eseguire il confronto tra LSN ultimo commit e Ora ultimo commit per ogni database primario e i relativi database secondari, come riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="73ea8-337">Tracking lag involves comparing the Last Commit LSN and Last Commit Time for each primary database and its secondary databases, as follows:</span></span>  
  
1.  <span data-ttu-id="73ea8-338">Connettersi alla replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-338">Connect to the primary replica.</span></span>  
  
2.  <span data-ttu-id="73ea8-339">Eseguire una query sull' `last_commit_lsn` (LSN dell'ultima transazione di cui è stato eseguito il commit) e `last_commit_time` (ora dell'ultimo commit) colonne della vista a gestione dinamica [sys. dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="73ea8-339">Query the `last_commit_lsn` (LSN of the last committed transaction) and `last_commit_time` (time of the last commit) columns of the [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) dynamic management view.</span></span>  
  
3.  <span data-ttu-id="73ea8-340">Confrontare i valori restituiti per ogni database primario e tutti i relativi database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-340">Compare the values returned for each primary database and each of its secondary databases.</span></span> <span data-ttu-id="73ea8-341">La differenza tra gli LSN ultimo commit indica la quantità di ritardo.</span><span class="sxs-lookup"><span data-stu-id="73ea8-341">The difference between their Last Commit LSNs indicate the amount of lag.</span></span>  
  
4.  <span data-ttu-id="73ea8-342">È possibile attivare un avviso quando la quantità di ritardo in un database o set di database supera il ritardo massimo desiderato per un periodo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="73ea8-342">You can trigger an alert when the amount of lag on a database or set of databases exceeds your desired maximum lag for a given period of time.</span></span> <span data-ttu-id="73ea8-343">Ad esempio, la query può essere eseguita da un processo che viene eseguito ogni minuto in ciascun database primario.</span><span class="sxs-lookup"><span data-stu-id="73ea8-343">For example, the query can be run by a job that executes every minute on each primary database.</span></span> <span data-ttu-id="73ea8-344">Se la differenza tra `last_commit_time` di un database primario e uno dei relativi database secondari ha superato l'obiettivo del punto di recupero (RPO, recovery point objective), ad esempio 5 minuti, in seguito all'ultima esecuzione del processo, tramite quest'ultimo potrebbe essere generato un avviso.</span><span class="sxs-lookup"><span data-stu-id="73ea8-344">If the difference between the `last_commit_time` of a primary database and any of its secondary databases has exceeded the recovery point objective (RPO) (for example, 5 minutes) since the last time the job executed, the job can raise an alert.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="73ea8-345">Quando nel cluster WSFC manca il quorum o quest'ultimo è stato forzato, `last_commit_lsn` e `last_commit_time` sono NULL.</span><span class="sxs-lookup"><span data-stu-id="73ea8-345">When the WSFC cluster lacks quorum or quorum has been forced, `last_commit_lsn` and `last_commit_time` are NULL.</span></span> <span data-ttu-id="73ea8-346">Per informazioni su come evitare la perdita di dati dopo aver forzato un quorum, vedere "Metodi possibili per evitare la perdita di dati dopo aver forzato il quorum" in [Eseguire un failover manuale forzato di un gruppo di disponibilità &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="73ea8-346">For information about how you might be able to avoid data loss after you forced quorum, see "Potential Ways to Avoid Data Loss After Quorum is Forced" in [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ForcedFailoverManagingDataLoss"></a> <span data-ttu-id="73ea8-347">Gestione della potenziale perdita di dati</span><span class="sxs-lookup"><span data-stu-id="73ea8-347">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="73ea8-348">Dopo aver forzato il failover, tutti i database secondari vengono sospesi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-348">After failover is forced, all secondary databases are suspended.</span></span> <span data-ttu-id="73ea8-349">compresi i database primari precedenti. Ciò avviene dopo che la replica primaria precedente torna online e viene ora individuata come replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-349">This includes the former primary databases, after the former primary replica comes back online and discovers that it is now a secondary replica.</span></span> <span data-ttu-id="73ea8-350">È necessario riprendere manualmente ogni database sospeso singolarmente in ogni replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-350">You must manually resume each suspended database individually on each secondary replica.</span></span>  
  
 <span data-ttu-id="73ea8-351">Quando la replica primaria precedente diventa disponibile, supponendo che i relativi database non siano danneggiati, è possibile tentare di gestire la potenziale perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="73ea8-351">Once the former primary replica is available, assuming that its databases are undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="73ea8-352">L'approccio disponibile per la gestione della potenziale perdita di dati dipende dal fatto che la replica primaria originale sia connessa o meno alla nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-352">The available approach for managing potential data loss depends on whether the original primary replica has connected to the new primary replica.</span></span> <span data-ttu-id="73ea8-353">Supponendo che la replica primaria originale possa accedere alla nuova istanza primaria, la riconnessione avviene in modo automatico e trasparente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-353">Assuming that the original primary replica can access the new primary instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-primary-replica-has-reconnected"></a><span data-ttu-id="73ea8-354">La replica primaria originale è stata riconnessa</span><span class="sxs-lookup"><span data-stu-id="73ea8-354">The Original Primary Replica Has Reconnected</span></span>  
 <span data-ttu-id="73ea8-355">In genere, dopo un errore, al riavvio la replica primaria originale si riconnette rapidamente al proprio partner.</span><span class="sxs-lookup"><span data-stu-id="73ea8-355">Typically, after a failure, when the original primary replica restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="73ea8-356">Alla riconnessione, la replica primaria originale diventa la replica secondaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-356">On reconnecting, the original primary replica becomes the secondary replica.</span></span> <span data-ttu-id="73ea8-357">I relativi database diventano i database secondari e vengono impostati sullo stato SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="73ea8-357">Its databases becomes the secondary databases and enter the SUSPENDED state.</span></span> <span data-ttu-id="73ea8-358">Per i nuovi database secondari non verrà eseguito il rollback a meno che non vengano ripresi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-358">The new secondary databases will not be not rolled back unless you resume them.</span></span>  
  
 <span data-ttu-id="73ea8-359">I database sospesi, tuttavia, sono inaccessibili, pertanto non è possibile verificarli per capire quali dati andrebbero persi in caso di ripresa di un determinato database.</span><span class="sxs-lookup"><span data-stu-id="73ea8-359">However, the suspended databases are inaccessible, so you cannot inspect them to evaluate what data would be lost if you were to resume a given database.</span></span> <span data-ttu-id="73ea8-360">Pertanto, la decisione relativa alla ripresa o alla rimozione di un database secondario dipende dal fatto che si sia disposti o meno ad accettare eventuali perdite di dati:</span><span class="sxs-lookup"><span data-stu-id="73ea8-360">Therefore, the decision on whether to resume or remove a secondary database depends on whether you are willing to accept any data loss, as follows:</span></span>  
  
-   <span data-ttu-id="73ea8-361">Se la perdita di dati non è accettabile, rimuovere i database dal gruppo di disponibilità per recuperarli.</span><span class="sxs-lookup"><span data-stu-id="73ea8-361">If losing any data would be unacceptable, you should remove the databases from the availability group to salvage them.</span></span>  
  
     <span data-ttu-id="73ea8-362">L'amministratore di database potrà recuperare i database primari precedenti e tentare di recuperare i dati che sarebbero andati persi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-362">The database administrator can now recover the former primary databases and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="73ea8-363">Tuttavia, quando un database primario precedente viene portato online, è diverso dal database primario corrente, pertanto l'amministratore di database deve rendere inaccessibile ai client il database rimosso o il database primario corrente in modo da evitare ulteriori divergenze tra i database e impedire problemi di failover al livello dei client.</span><span class="sxs-lookup"><span data-stu-id="73ea8-363">However, when a former primary database comes online, it is divergent from the current primary database, so the database administrator needs to make either the removed database or the current primary database inaccessible to clients to avoid further divergence of the databases and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="73ea8-364">Se la perdita di dati fosse accettabile, è possibile riprendere i database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-364">If losing data would be acceptable to your business goals, you can resume the secondary databases.</span></span>  
  
     <span data-ttu-id="73ea8-365">Se si riprende un nuovo database secondario, il rollback diventa il primo passaggio della sincronizzazione del database.</span><span class="sxs-lookup"><span data-stu-id="73ea8-365">Resuming a new secondary database causes it to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="73ea8-366">Se nella coda di invio erano in attesa record di log al momento dell'errore, le transazioni corrispondenti vengono perdute, anche se con commit.</span><span class="sxs-lookup"><span data-stu-id="73ea8-366">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-primary-replica-has-not-reconnected"></a><span data-ttu-id="73ea8-367">La replica primaria originale non è stata riconnessa</span><span class="sxs-lookup"><span data-stu-id="73ea8-367">The Original Primary Replica Has Not Reconnected</span></span>  
 <span data-ttu-id="73ea8-368">Se è possibile impedire temporaneamente alla replica primaria originale di riconnettersi in rete alla nuova replica primaria, è possibile esaminare i database primari originali per capire quali dati andrebbero persi se venissero ripresi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-368">If you can temporarily prevent the original primary replica from reconnecting over the network to the new primary replica, you can inspect the original primary databases to evaluate what data would be lost if they were resumed.</span></span>  
  
-   <span data-ttu-id="73ea8-369">Contesti in cui la perdita di dati è accettabile</span><span class="sxs-lookup"><span data-stu-id="73ea8-369">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="73ea8-370">Consentire alla replica primaria originale di riconnettersi alla nuova replica primaria.</span><span class="sxs-lookup"><span data-stu-id="73ea8-370">Allow the original primary replica to reconnect to the new primary replica.</span></span> <span data-ttu-id="73ea8-371">La riconnessione comporta la sospensione dei nuovi database secondari.</span><span class="sxs-lookup"><span data-stu-id="73ea8-371">Reconnecting causes the new secondary databases to be suspended.</span></span> <span data-ttu-id="73ea8-372">Per avviare la sincronizzazione dati su un database, riprenderlo.</span><span class="sxs-lookup"><span data-stu-id="73ea8-372">To start data synchronization on a database, simply resume it.</span></span> <span data-ttu-id="73ea8-373">La nuova replica secondaria elimina il fork di recupero originale per quel database, perdendo eventuali transazioni mai inviate o ricevute dalla replica secondaria precedente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-373">The new secondary replica drops the original recovery fork for that database, losing any transactions that were never sent to or received by the former secondary replica.</span></span>  
  
-   <span data-ttu-id="73ea8-374">Contesti in cui la perdita di dati non è ammissibile</span><span class="sxs-lookup"><span data-stu-id="73ea8-374">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="73ea8-375">Se il database primario originale contiene dati critici che andrebbero persi in caso di ripresa del database sospeso, è possibile conservare i dati sul database primario originale rimuovendolo dal gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="73ea8-375">If the original primary database contains critical data that would be lost if you resumed the suspended database, you can preserve the data on the original primary database by removing it from the availability group.</span></span> <span data-ttu-id="73ea8-376">In seguito a questa operazione il database viene impostato sullo stato RESTORING.</span><span class="sxs-lookup"><span data-stu-id="73ea8-376">This causes the database to enter the RESTORING state.</span></span> <span data-ttu-id="73ea8-377">A questo punto, è consigliabile tentare di eseguire il backup della parte finale del log del database rimosso.</span><span class="sxs-lookup"><span data-stu-id="73ea8-377">At this point, we recommend that you attempt to back up the tail of the removed database's log.</span></span> <span data-ttu-id="73ea8-378">È quindi possibile aggiornare il database primario corrente (il database secondario precedente) esportando i dati che si desidera recuperare dal database primario originale e importandoli nel database primario corrente.</span><span class="sxs-lookup"><span data-stu-id="73ea8-378">Then, you can update the current primary (the former secondary database) by exporting the data you want to salvage from the original primary database and importing it into the current primary database.</span></span> <span data-ttu-id="73ea8-379">È consigliabile eseguire un backup completo del database primario aggiornato il più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="73ea8-379">We recommend taking a full database backup of the updated primary database as quickly as possible.</span></span>  
  
     <span data-ttu-id="73ea8-380">Nell'istanza del server che ospita la nuova replica secondaria, è possibile eliminare il database secondario sospeso e creare un nuovo database secondario ripristinando questo backup (e almeno un backup del log successivo) utilizzando RESTORE WITH NORECOVERY.</span><span class="sxs-lookup"><span data-stu-id="73ea8-380">Then, on the server instance that hosts the new secondary replica, you can delete the suspended secondary database and create a new secondary database by restoring this backup (and least one subsequent log backup) using RESTORE WITH NORECOVERY.</span></span> <span data-ttu-id="73ea8-381">È consigliabile rimandare backup del log aggiuntivi dei database primari correnti finché non vengono ripresi i database secondari corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="73ea8-381">We recommend delaying additional log backups of the current primary databases until the corresponding secondary databases are resumed.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="73ea8-382">Il troncamento del log delle transazioni viene ritardato nel database primario, mentre gli eventuali database secondari vengono sospesi.</span><span class="sxs-lookup"><span data-stu-id="73ea8-382">Transaction log truncation is delayed on a primary database while any of its secondary databases is suspended.</span></span> <span data-ttu-id="73ea8-383">Inoltre, l'integrità di sincronizzazione di una replica secondaria con commit sincrono non potrà passare allo stato HEALTHY finché un database locale qualsiasi rimane sospeso.</span><span class="sxs-lookup"><span data-stu-id="73ea8-383">Also the synchronization health of a synchronous-commit secondary replica cannot transition to HEALTHY as long as any local database remains suspended.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="73ea8-384">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="73ea8-384">Related Tasks</span></span>  
 <span data-ttu-id="73ea8-385">**Per configurare il comportamento del failover**</span><span class="sxs-lookup"><span data-stu-id="73ea8-385">**To configure failover behavior**</span></span>  
  
-   [<span data-ttu-id="73ea8-386">Modificare la modalità di disponibilità di una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-386">Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-availability-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="73ea8-387">Modificare la modalità di failover di una replica di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-387">Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-failover-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="73ea8-388">Configurare i criteri di failover flessibili per controllare le condizioni per il failover automatico &#40;Gruppi di disponibilità AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-388">Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;</span></span>](configure-flexible-automatic-failover-policy.md)  
  
 <span data-ttu-id="73ea8-389">**Per eseguire un failover manuale**</span><span class="sxs-lookup"><span data-stu-id="73ea8-389">**To perform a manual fail over**</span></span>  
  
-   [<span data-ttu-id="73ea8-390">Eseguire un failover manuale pianificato di un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-390">Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="73ea8-391">Eseguire un failover manuale forzato di un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-391">Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="73ea8-392">Usare la Procedura guidata Failover del gruppo di disponibilità &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-392">Use the Fail Over Availability Group Wizard &#40;SQL Server Management Studio&#41;</span></span>](use-the-fail-over-availability-group-wizard-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="73ea8-393">Gestione di account di accesso e processi per i database di un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-393">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)  
  
 <span data-ttu-id="73ea8-394">**Per configurare la configurazione del quorum WSFC**</span><span class="sxs-lookup"><span data-stu-id="73ea8-394">**To configure WSFC Quorum Configuration**</span></span>  
  
-   [<span data-ttu-id="73ea8-395">Configurare le impostazioni NodeWeight per il quorum del cluster</span><span class="sxs-lookup"><span data-stu-id="73ea8-395">Configure Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/configure-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="73ea8-396">Visualizzare le impostazioni NodeWeight per il quorum del cluster</span><span class="sxs-lookup"><span data-stu-id="73ea8-396">View Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/view-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="73ea8-397">Forzare l'avvio di un cluster WSFC senza un quorum</span><span class="sxs-lookup"><span data-stu-id="73ea8-397">Force a WSFC Cluster to Start Without a Quorum</span></span>](../../../sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="73ea8-398">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="73ea8-398">Related Content</span></span>  
  
-   [<span data-ttu-id="73ea8-399">Pagina relativa alla guida alle soluzioni AlwaysOn di Microsoft SQL Server per la disponibilità elevata e il ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="73ea8-399">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="73ea8-400">Blog del team di SQL Server AlwaysOn: Blog del team ufficiale di SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="73ea8-400">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="73ea8-401">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="73ea8-401">See Also</span></span>  
 <span data-ttu-id="73ea8-402">[Panoramica di Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="73ea8-402">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="73ea8-403">[Modalità di disponibilità &#40;Gruppi di disponibilità AlwaysOn&#41;](availability-modes-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="73ea8-403">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="73ea8-404">[Windows Server Failover Clustering &#40;WSFC&#41; con SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="73ea8-404">[Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span></span>  
 <span data-ttu-id="73ea8-405">[Transazioni tra database non supportate per il mirroring del database o Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="73ea8-405">[Cross-Database Transactions Not Supported For Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span></span>  
 <span data-ttu-id="73ea8-406">[Criteri di failover per istanze del cluster di failover](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span><span class="sxs-lookup"><span data-stu-id="73ea8-406">[Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span></span>  
 [<span data-ttu-id="73ea8-407">Criteri di failover flessibili per failover automatico di un gruppo di disponibilità &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="73ea8-407">Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;</span></span>](flexible-automatic-failover-policy-availability-group.md)  
  
  
