---
title: Risolvere i problemi relativi alla Utilità SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: f5f47c2a-38ea-40f8-9767-9bc138d14453
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 3c139f9f084374aeb711e905ac0c315acc25c6ac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720339"
---
# <a name="troubleshoot-the-sql-server-utility"></a><span data-ttu-id="47a11-102">Risoluzione dei problemi relativi a Utilità SQL Server</span><span class="sxs-lookup"><span data-stu-id="47a11-102">Troubleshoot the SQL Server Utility</span></span>
  <span data-ttu-id="47a11-103">La risoluzione dei problemi relativi a Utilità [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] potrebbe includere la risoluzione di un'operazione non riuscita di registrazione di un'istanza di SQL Server con un punto di controllo dell'utilità, la risoluzione dei problemi relativi a raccolte dati con errori che generano icone grigie nella visualizzazione elenco dell'istanza gestita in un punto di controllo dell'utilità, la riduzione dei colli di bottiglia delle prestazioni o la risoluzione dei problemi di integrità delle risorse.</span><span class="sxs-lookup"><span data-stu-id="47a11-103">Troubleshooting [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility issues might include resolving a failed operation to enroll an instance of SQL Server with a UCP, troubleshooting failed data collection resulting in gray icons in the managed instance list view on a UCP, mitigating performance bottlenecks, or resolving resource health issues.</span></span> <span data-ttu-id="47a11-104">Per ulteriori informazioni sulla riduzione dei problemi di integrità delle risorse identificati da un punto di controllo dell' [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utilità, vedere [Troubleshoot SQL Server Integrità risorse &#40;utilità SQL Server&#41;](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md).</span><span class="sxs-lookup"><span data-stu-id="47a11-104">For more information about mitigating resource health issues identified by a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] UCP, see [Troubleshoot SQL Server Resource Health &#40;SQL Server Utility&#41;](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md).</span></span>  
  
## <a name="failed-operation-to-enroll-an-instance-of-sql-server-into-a-sql-server-utility"></a><span data-ttu-id="47a11-105">Operazione di registrazione di un'istanza di SQL Server in Utilità SQL Server non riuscita</span><span class="sxs-lookup"><span data-stu-id="47a11-105">Failed Operation to Enroll an Instance of SQL Server into a SQL Server Utility</span></span>  
 <span data-ttu-id="47a11-106">Se ci si connette all'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] per eseguire la registrazione utilizzando l'Autenticazione di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e si specifica un account proxy che appartiene a un dominio Active Directory diverso dal dominio in cui si trova il punto di controllo dell'utilità, la convalida dell'istanza riesce, ma l'operazione di registrazione non riesce con il messaggio di errore seguente:</span><span class="sxs-lookup"><span data-stu-id="47a11-106">If you connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll using [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication, and you specify a proxy account that belongs to a different Active Directory domain than the domain where the UCP is located, instance validation succeeds, but the enrollment operation fails with the following error message:</span></span>  
  
 <span data-ttu-id="47a11-107">Eccezione durante l'esecuzione di un'istruzione o un batch Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="47a11-107">An exception occurred while executing a Transact-SQL statement or batch.</span></span> <span data-ttu-id="47a11-108">(Microsoft.SqlServer.ConnectionInfo)</span><span class="sxs-lookup"><span data-stu-id="47a11-108">(Microsoft.SqlServer.ConnectionInfo)</span></span>  
  
 <span data-ttu-id="47a11-109">Ulteriori informazioni:  Impossibile ottenere informazioni relative al gruppo/utente di Windows NT '\<DomainName\AccountName>', codice di errore 0x5.</span><span class="sxs-lookup"><span data-stu-id="47a11-109">Additional information:  Could not obtain information about Windows NT group/user '\<DomainName\AccountName>', error code 0x5.</span></span> <span data-ttu-id="47a11-110">(Microsoft SQL Server, Errore: 15404)</span><span class="sxs-lookup"><span data-stu-id="47a11-110">(Microsoft SQL Server, Error: 15404)</span></span>  
  
 <span data-ttu-id="47a11-111">Questo problema si verifica nello scenario di esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="47a11-111">This issue occurs in the following example scenario:</span></span>  
  
1.  <span data-ttu-id="47a11-112">Il punto di controllo dell'utilità è un membro di "Domain_1".</span><span class="sxs-lookup"><span data-stu-id="47a11-112">The UCP is a member of "Domain_1."</span></span>  
  
2.  <span data-ttu-id="47a11-113">Esiste una relazione di trust di dominio unidirezionale, ovvero, "Domain_1" non è considerato attendibile da "Domain_2" ma "Domain_2" è considerato attendibile da "Domain_1".</span><span class="sxs-lookup"><span data-stu-id="47a11-113">A one-way domain trust relationship is in place: that is, "Domain_1" is not trusted by "Domain_2" but "Domain_2" is trusted by "Domain_1."</span></span>  
  
3.  <span data-ttu-id="47a11-114">L'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] da registrare in Utilità [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] è anche un membro di "Domain_1".</span><span class="sxs-lookup"><span data-stu-id="47a11-114">The instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll into the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility is also a member of "Domain_1."</span></span>  
  
4.  <span data-ttu-id="47a11-115">Durante l'operazione di registrazione, connettersi all'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] per eseguire la registrazione utilizzando "sa".</span><span class="sxs-lookup"><span data-stu-id="47a11-115">During the enroll operation, connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll using "sa".</span></span> <span data-ttu-id="47a11-116">Specificare un account proxy da "Domain_2".</span><span class="sxs-lookup"><span data-stu-id="47a11-116">Specify a proxy account from "Domain_2."</span></span>  
  
5.  <span data-ttu-id="47a11-117">La convalida riesce, ma la registrazione no.</span><span class="sxs-lookup"><span data-stu-id="47a11-117">Validation succeeds but enrollment fails.</span></span>  
  
 <span data-ttu-id="47a11-118">La soluzione alternativa per questo problema, utilizzando l'esempio precedente, consiste nel connettersi all'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] per eseguire la registrazione all' [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] utilità utilizzando "sa" e fornire un account proxy da "Domain_1".</span><span class="sxs-lookup"><span data-stu-id="47a11-118">The workaround for this issue, using the example above, is to connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll into the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility using "sa" and provide a proxy account from "Domain_1."</span></span>  
  
## <a name="failed-wmi-validation"></a><span data-ttu-id="47a11-119">Convalida WMI non riuscita</span><span class="sxs-lookup"><span data-stu-id="47a11-119">Failed WMI Validation</span></span>  
 <span data-ttu-id="47a11-120">Se WMI non è configurato correttamente in un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], le operazioni di creazione del punto di controllo dell'utilità e di registrazione dell'istanza gestita visualizzano un avviso, ma l'operazione non viene bloccata.</span><span class="sxs-lookup"><span data-stu-id="47a11-120">If WMI is not properly configured on an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the Create UCP and Enroll Managed Instance operations display a warning, but the operation is not blocked.</span></span> <span data-ttu-id="47a11-121">Inoltre, se si modifica la configurazione dell'account di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent in modo che [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent non disponga delle autorizzazioni per le classi WMI obbligatorie, la raccolta dati nell'istanza gestita interessata di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] non viene caricata nel punto di controllo dell'utilità.</span><span class="sxs-lookup"><span data-stu-id="47a11-121">Additionally, if you change the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent account configuration so that [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent does not have permission to required WMI classes, data collection on the affected managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] fails to upload to the UCP.</span></span> <span data-ttu-id="47a11-122">Ciò comporta la visualizzazione di icone grigie nel punto di controllo dell'utilità.</span><span class="sxs-lookup"><span data-stu-id="47a11-122">This results in gray icons in the UCP.</span></span>  
  
 <span data-ttu-id="47a11-123">La raccolta dati con errori genera icone di stato grigie nella visualizzazione elenco del punto di controllo dell'utilità per le istanze gestite interessate di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-123">Failed data collection results in gray status icons in the UCP list view for affected managed instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="47a11-124">La cronologia processo nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] mostra errori di sysutility_mi_collect_and_upload nel passaggio 2 (dati fase raccolti dallo script di PowerShell).</span><span class="sxs-lookup"><span data-stu-id="47a11-124">The job history on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] shows that sysutility_mi_collect_and_upload fails on step 2 (Stage Data Collected from PowerShell Script).</span></span>  
  
 <span data-ttu-id="47a11-125">I messaggi di errore semplificati sono:</span><span class="sxs-lookup"><span data-stu-id="47a11-125">The simplified error messages are:</span></span>  
  
 <span data-ttu-id="47a11-126">L'esecuzione del comando è stata arrestata perché la variabile della shell "ErrorActionPreference" è impostata sull'arresto: accesso negato.</span><span class="sxs-lookup"><span data-stu-id="47a11-126">Command execution stopped because the shell variable "ErrorActionPreference" is set to Stop: Access denied.</span></span>  
  
 <span data-ttu-id="47a11-127">ERRORE: \<Date-time (MM/DD/YYYY HH:MM:SS)> : è stata rilevata un'eccezione durante la raccolta delle proprietà CPU.</span><span class="sxs-lookup"><span data-stu-id="47a11-127">ERROR: \<Date-time (MM/DD/YYYY HH:MM:SS)>: Caught exception while collecting cpu properties.</span></span>  <span data-ttu-id="47a11-128">È probabile che una query WMI non sia riuscita.</span><span class="sxs-lookup"><span data-stu-id="47a11-128">A WMI query might have failed.</span></span>  <span data-ttu-id="47a11-129">AVVISO.</span><span class="sxs-lookup"><span data-stu-id="47a11-129">WARNING.</span></span>  
  
 <span data-ttu-id="47a11-130">Per risolvere questo problema, verificare le impostazioni di configurazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="47a11-130">To resolve this issue, verify the following configuration settings:</span></span>  
  
-   <span data-ttu-id="47a11-131">In Windows Server 2003, il servizio SQL Server Agent deve appartenere al gruppo di monitoraggio delle prestazioni di Windows nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-131">On Windows Server 2003, the SQL Server Agent service must be part of the Windows Performance Monitoring group on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="47a11-132">Il servizio WMI deve essere abilitato e configurato nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-132">The WMI service must be enabled and configured on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="47a11-133">Il repository WMI potrebbe essere danneggiato nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-133">The WMI repository might be corrupt on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="47a11-134">La libreria delle prestazioni potrebbe essere mancante o danneggiata nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-134">The performance library might be missing or corrupt on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="47a11-135">Per verificare che l'istanza specificata di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] sia configurata correttamente per la segnalazione dei dati al punto di controllo dell'utilità, verificare che le classi seguenti siano disponibili nell'istanza specificata di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]e che siano accessibili da parte dell'account del servizio di SQL Server Agent:</span><span class="sxs-lookup"><span data-stu-id="47a11-135">To verify that the specified instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is configured properly to report data to the UCP, verify that the following classes are available on the specified instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], and that they are accessible to SQL Server Agent service account:</span></span>  
  
-   <span data-ttu-id="47a11-136">Win32_MountPoint</span><span class="sxs-lookup"><span data-stu-id="47a11-136">Win32_MountPoint</span></span>  
  
-   <span data-ttu-id="47a11-137">Win32_PerfRawData_PerfProc_Process</span><span class="sxs-lookup"><span data-stu-id="47a11-137">Win32_PerfRawData_PerfProc_Process</span></span>  
  
-   <span data-ttu-id="47a11-138">Win32_PerfRawData_PerfOS_Processor</span><span class="sxs-lookup"><span data-stu-id="47a11-138">Win32_PerfRawData_PerfOS_Processor</span></span>  
  
-   <span data-ttu-id="47a11-139">Win32_Processor</span><span class="sxs-lookup"><span data-stu-id="47a11-139">Win32_Processor</span></span>  
  
-   <span data-ttu-id="47a11-140">Win32_Volume</span><span class="sxs-lookup"><span data-stu-id="47a11-140">Win32_Volume</span></span>  
  
-   <span data-ttu-id="47a11-141">Win32_LogicalDisk</span><span class="sxs-lookup"><span data-stu-id="47a11-141">Win32_LogicalDisk</span></span>  
  
 <span data-ttu-id="47a11-142">È possibile utilizzare il cmdlet Get-WmiObject di PowerShell in ognuna delle classi per verificare che ogni classe sia accessibile.</span><span class="sxs-lookup"><span data-stu-id="47a11-142">You can use the Get-WmiObject PowerShell cmdlet on each of the classes to verify that each class is accessible.</span></span> <span data-ttu-id="47a11-143">Eseguire i cmdlet seguenti nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="47a11-143">Run the following cmdlets on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
```  
Get-WmiObject Win32_MountPoint -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_PerfRawData_PerfProc_Process -ErrorAction Stop| Out-Null  
Get-WmiObject Win32_PerfRawData_PerfOS_Processor -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_Processor -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_Volume -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_LogicalDisk -ErrorAction Stop | Out-Null  
```  
  
 <span data-ttu-id="47a11-144">Per altre informazioni sulla risoluzione dei problemi relativi a WMI, vedere l'articolo relativo alla [risoluzione dei problemi WMI](https://go.microsoft.com/fwlink/?LinkId=178250).</span><span class="sxs-lookup"><span data-stu-id="47a11-144">For more information about troubleshooting WMI, see [Troubleshooting WMI](https://go.microsoft.com/fwlink/?LinkId=178250).</span></span> <span data-ttu-id="47a11-145">Si noti che le query in queste operazioni dell'Utilità SQL Server vengono eseguite localmente, pertanto il contenuto relativo alla risoluzione dei problemi DCOM e remoti non si applica.</span><span class="sxs-lookup"><span data-stu-id="47a11-145">Note that queries in these SQL Server Utility operations are running locally, so the DCOM and remote troubleshooting content does not apply.</span></span>  
  
## <a name="failed-data-collection"></a><span data-ttu-id="47a11-146">Raccolta dati con errori</span><span class="sxs-lookup"><span data-stu-id="47a11-146">Failed Data Collection</span></span>  
 <span data-ttu-id="47a11-147">Se alcuni eventi di raccolta dati di Utilità [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] non vengono eseguiti correttamente, considerare le possibilità seguenti:</span><span class="sxs-lookup"><span data-stu-id="47a11-147">If [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility data collection events fail, consider the following possibilities:</span></span>  
  
-   <span data-ttu-id="47a11-148">Non modificare le proprietà del set di raccolta "Informazioni utilità" in un'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e non abilitare/disabilitare manualmente la raccolta dati, in quanto viene controllata da un processo dell'agente Utilità.</span><span class="sxs-lookup"><span data-stu-id="47a11-148">Do not change any properties of the "Utility Information" collection set on a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], and do not turn data collection on/off manually, as data collection is controlled by a Utility agent job.</span></span>  
  
-   <span data-ttu-id="47a11-149">Convalida WMI non riuscita o non supportata.</span><span class="sxs-lookup"><span data-stu-id="47a11-149">Failed or unsupported WMI validation.</span></span> <span data-ttu-id="47a11-150">Per ulteriori informazioni, vedere la sezione Convalida WMI non riuscita in precedenza in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="47a11-150">For more information, see the Failed WMI Validation section earlier in this topic.</span></span>  
  
-   <span data-ttu-id="47a11-151">Aggiornare i dati nella visualizzazione elenco dell'istanza gestita, in quanto i dati nei punti di visualizzazione dell'Utilità [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] non vengono aggiornati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="47a11-151">Refresh data in the managed instance list view, as data in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility viewpoints does not refresh automatically.</span></span> <span data-ttu-id="47a11-152">Per aggiornare i dati, fare clic con il pulsante destro del mouse sul nodo **Istanze gestite** nel riquadro di navigazione di **Esplora utilità** , scegliere quindi **Aggiorna**o fare clic con il pulsante destro del mouse sul nome dell'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] nella visualizzazione elenco, quindi scegliere **Aggiorna**.</span><span class="sxs-lookup"><span data-stu-id="47a11-152">To refresh data, right-click the **Managed Instances** node in the **Utility Explorer Navigation** pane, then select **Refresh**, or right-click on the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance name in the list view, then select **Refresh**.</span></span> <span data-ttu-id="47a11-153">Si tenga presente che, dopo la registrazione di un'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] con un punto di controllo dell'utilità, possono essere necessari fino a 30 minuti affinché i dati vengano visualizzati nel dashboard e i punti di visualizzazione nel riquadro del contenuto Esplora utilità.</span><span class="sxs-lookup"><span data-stu-id="47a11-153">Note that after an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] has been enrolled with a UCP, it can take up to 30 minutes for data to first appear in the dashboard and viewpoints in the Utility Explorer content pane.</span></span>  
  
-   <span data-ttu-id="47a11-154">Utilizzare Gestione configurazione SQL Server per verificare che l'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] sia in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="47a11-154">Use SQL Server Configuration Manager to verify that the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is running.</span></span>  
  
-   <span data-ttu-id="47a11-155">Se la raccolta o il caricamento dei dati non riesce a causa di problemi di timeout, aggiornare la funzione dbo.fn_sysutility_mi_get_collect_script() nel database MSDB.</span><span class="sxs-lookup"><span data-stu-id="47a11-155">If data collection or data upload fail due to timeout issues, update the function dbo.fn_sysutility_mi_get_collect_script() in the MSDB database.</span></span> <span data-ttu-id="47a11-156">In particolare, nella funzione "Invoke-BulkCopyCommand()" aggiungere la riga:</span><span class="sxs-lookup"><span data-stu-id="47a11-156">Specifically, in the function "Invoke-BulkCopyCommand()" add line:</span></span>  
  
    ```
    $bulkCopy.BulkCopyTimeout=180  
    ```  
  
     <span data-ttu-id="47a11-157">Il valore di timeout predefinito è di 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="47a11-157">The default timeout value is 30 seconds.</span></span>  
  
-   <span data-ttu-id="47a11-158">Se l'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] non è di tipo cluster, verificare che il servizio [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent sia in esecuzione e che sia configurato per essere avviato automaticamente nel punto di controllo dell'utilità e nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-158">If the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is not clustered, verify that the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service is running and that the service is set to start automatically on the UCP and on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="47a11-159">Verificare che venga utilizzato un account valido per eseguire la raccolta dati sull'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-159">Verify that a valid account is being used to run data collection on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="47a11-160">È possibile, ad esempio, che la password sia scaduta.</span><span class="sxs-lookup"><span data-stu-id="47a11-160">For example, the password may have expired.</span></span> <span data-ttu-id="47a11-161">Se la password del proxy è scaduta, aggiornare le credenziali della password in SSMS, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="47a11-161">If the proxy password has expired, update password credentials in SSMS, as follows:</span></span>  
  
    1.  <span data-ttu-id="47a11-162">In **Esplora oggetti**di SSMS espandere il nodo **Sicurezza** , quindi espandere il nodo **Credenziali** .</span><span class="sxs-lookup"><span data-stu-id="47a11-162">In SSMS **Object Explorer**, expand the **Security** node, then expand the **Credentials** node.</span></span>  
  
    2.  <span data-ttu-id="47a11-163">Fare clic con il pulsante destro del mouse su \*\*UtilityAgentProxyCredential_ \<GUID> \*\* e scegliere **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="47a11-163">Right-click on **UtilityAgentProxyCredential_\<GUID>** and select **Properties**.</span></span>  
  
    3.  <span data-ttu-id="47a11-164">Nella finestra di dialogo Proprietà credenziali aggiornare le credenziali necessarie per le **credenziali \<GUID> UtilityAgentProxyCredential_** .</span><span class="sxs-lookup"><span data-stu-id="47a11-164">On the Credential Properties dialog, update credentials as necessary for the **UtilityAgentProxyCredential_\<GUID>** credential.</span></span>  
  
    4.  <span data-ttu-id="47a11-165">Fare clic su **OK** per confermare la modifica.</span><span class="sxs-lookup"><span data-stu-id="47a11-165">Click **OK** to confirm the change.</span></span>  
  
-   <span data-ttu-id="47a11-166">TCP/IP deve essere abilitato nel punto di controllo dell'utilità e nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="47a11-166">TCP/IP should be enabled on the UCP and on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="47a11-167">Abilitare TCP/IP tramite Gestione configurazione [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="47a11-167">Enable TCP/IP through [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   <span data-ttu-id="47a11-168">È necessario avviare e configurare per l'avvio automatico il servizio SQL Server Browser nel punto di controllo dell'utilità.</span><span class="sxs-lookup"><span data-stu-id="47a11-168">The SQL Server Browser service on the UCP should be started and configured to start automatically.</span></span> <span data-ttu-id="47a11-169">Se l'organizzazione non consente l'utilizzo del servizio SQL Server Browser, utilizzare i passaggi seguenti per consentire a un'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] di connettersi al punto di controllo dell'utilità:</span><span class="sxs-lookup"><span data-stu-id="47a11-169">If your organization prevents use of the SQL Server Browser service, use the following steps to allow a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to connect to the UCP:</span></span>  
  
    1.  <span data-ttu-id="47a11-170">Sulla barra delle applicazioni di Windows nell'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , fare clic su **Start**, quindi su **Esegui...**.</span><span class="sxs-lookup"><span data-stu-id="47a11-170">On the Windows taskbar on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], click **Start**, then click **Run...**.</span></span>  
  
    2.  <span data-ttu-id="47a11-171">Digitare "cliconfg.exe" nella casella, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="47a11-171">Type "cliconfg.exe" in the space provided, then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="47a11-172">Se viene richiesto di consentire l'avvio di SQL Client Configuration Utility EXE, fare clic su**Continua**.</span><span class="sxs-lookup"><span data-stu-id="47a11-172">If prompted to allow "SQL Client Configuration Utility EXE" to start, click "**Continue**."</span></span>  
  
    4.  <span data-ttu-id="47a11-173">Nella finestra di dialogo **utilità di SQL Server rete client** selezionare la scheda **alias** , quindi fare clic su **Aggiungi.**</span><span class="sxs-lookup"><span data-stu-id="47a11-173">On the **SQL Server Client Network Utility** dialog box, select the **Alias** tab, then click **Add...**.</span></span>  
  
    5.  <span data-ttu-id="47a11-174">Nella finestra di dialogo **Aggiungi configurazione libreria di rete** effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="47a11-174">On the **Add Network Library Configuration** dialog box:</span></span>  
  
    6.  <span data-ttu-id="47a11-175">Specificare TCP/IP nell'elenco delle librerie di rete.</span><span class="sxs-lookup"><span data-stu-id="47a11-175">Specify TCP/IP from the list of network libraries.</span></span>  
  
    7.  <span data-ttu-id="47a11-176">Specificare NomeComputer\NomeIstanza per il punto di controllo dell'utilità nella casella di testo **Alias server** .</span><span class="sxs-lookup"><span data-stu-id="47a11-176">Specify the ComputerName\InstanceName of the UCP in the **Server Alias** text box.</span></span>  
  
    8.  <span data-ttu-id="47a11-177">Specificare NomeComputer per il punto di controllo dell'utilità nella casella di testo **Nome server** .</span><span class="sxs-lookup"><span data-stu-id="47a11-177">Specify the ComputerName of the UCP in the **Server Name** text box.</span></span>  
  
    9. <span data-ttu-id="47a11-178">Deselezionare la casella di controllo **Determina porta in modo dinamico** .</span><span class="sxs-lookup"><span data-stu-id="47a11-178">Uncheck the **Dynamically determine port** checkbox.</span></span>  
  
    10. <span data-ttu-id="47a11-179">Specificare il numero della porta su cui il punto di controllo dell'utilità è in attesa nella casella di testo **Numero porta** .</span><span class="sxs-lookup"><span data-stu-id="47a11-179">Specify the port number that the UCP is listening on in the **Port number** text box.</span></span>  
  
    11. <span data-ttu-id="47a11-180">Fare clic su **OK** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="47a11-180">Click **OK** to save your changes.</span></span>  
  
    12. <span data-ttu-id="47a11-181">Ripetere questi passaggi per ogni istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] che si connette a un punto di controllo dell'utilità in cui il servizio SQL Server Browser non è abilitato.</span><span class="sxs-lookup"><span data-stu-id="47a11-181">Repeat these steps for each managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that connects to a UCP where the SQL Server Browser service is not enabled.</span></span>  
  
-   <span data-ttu-id="47a11-182">Assicurarsi che le istanze gestite di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] siano connesse alla rete.</span><span class="sxs-lookup"><span data-stu-id="47a11-182">Ensure that managed instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] are connected to the network.</span></span>  
  
-   <span data-ttu-id="47a11-183">Se sono presenti database con lo stesso nome ma con impostazioni diverse per la distinzione tra maiuscole e minuscole su un'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], l'identificazione tra il database e i relativi punti di visualizzazione può risultare errata, causando errori nella raccolta dati.</span><span class="sxs-lookup"><span data-stu-id="47a11-183">If there are databases with the same name but different case-sensitivity settings on a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the identification between the database and its viewpoints can be incorrect, resulting in failed data collection.</span></span> <span data-ttu-id="47a11-184">Ad esempio, in un database denominato "MYDATABASE" potrebbero essere visualizzati stati di integrità per un database denominato "MyDatabase".</span><span class="sxs-lookup"><span data-stu-id="47a11-184">For example, a database named "MYDATABASE" might show health states for a database named "MyDatabase".</span></span> <span data-ttu-id="47a11-185">In questo scenario non viene generato alcun errore.</span><span class="sxs-lookup"><span data-stu-id="47a11-185">No error is generated in this scenario.</span></span> <span data-ttu-id="47a11-186">La raccolta dati con errori può essere anche il risultato di mancate corrispondenze tra maiuscole e minuscole in altri oggetti visualizzati nel punto di controllo dell'utilità, ad esempio tra i nomi dei file di database e i nomi dei gruppi di file.</span><span class="sxs-lookup"><span data-stu-id="47a11-186">Failed data collection can also result from case-sensitivity mismatches in other objects displayed in the UCP, like database file and file group names.</span></span>  
  
-   <span data-ttu-id="47a11-187">Se un'istanza gestita di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] è ospitata in un computer Windows Server 2003, l'account del servizio [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent deve appartenere al gruppo di sicurezza Performance Monitor Users o Administrators.</span><span class="sxs-lookup"><span data-stu-id="47a11-187">If a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is hosted on a Windows Server 2003 computer, then the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service account must belong to the Performance Monitor Users security group or the local Administrators group.</span></span> <span data-ttu-id="47a11-188">In caso contrario, la raccolta dati non riuscirà e restituirà un errore di accesso negato.</span><span class="sxs-lookup"><span data-stu-id="47a11-188">Otherwise, data collection will fail with an access denied error.</span></span> <span data-ttu-id="47a11-189">Per aggiungere un account del servizio [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent al gruppo di sicurezza Performance Monitor Users, utilizzare i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="47a11-189">To add a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service account to the Performance Monitor Users security group, use the following steps:</span></span>  
  
    1.  <span data-ttu-id="47a11-190">Aprire **Gestione computer**, quindi **Utenti e gruppi locali**, quindi fare clic su **Gruppi**.</span><span class="sxs-lookup"><span data-stu-id="47a11-190">Open **Computer Management**, then **Local Users and Groups**, then **Groups**.</span></span>  
  
    2.  <span data-ttu-id="47a11-191">Fare clic con il pulsante destro del mouse su **Performance Monitor Users** e scegliere **Aggiungi a gruppo**.</span><span class="sxs-lookup"><span data-stu-id="47a11-191">Right-click **Performance Monitor Users** and select **Add to Group**.</span></span>  
  
    3.  <span data-ttu-id="47a11-192">Scegliere **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="47a11-192">Click **Add**.</span></span>  
  
    4.  <span data-ttu-id="47a11-193">Immettere l'account che il servizio SQL Server Agent sta utilizzando, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="47a11-193">Enter the account that the SQL Server Agent service is running under, then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="47a11-194">Se l'istanza di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] è già registrata con il punto di controllo dell'utilità prima di aggiungere l'utente a questo gruppo, riavviare il servizio [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="47a11-194">If the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] was already enrolled with the UCP before adding the user to this group, restart the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="47a11-195">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="47a11-195">See Also</span></span>  
 <span data-ttu-id="47a11-196">[Attività e funzionalità di Utilità SQL Server](../relational-databases/manage/sql-server-utility-features-and-tasks.md) </span><span class="sxs-lookup"><span data-stu-id="47a11-196">[SQL Server Utility Features and Tasks](../relational-databases/manage/sql-server-utility-features-and-tasks.md) </span></span>  
 [<span data-ttu-id="47a11-197">Risolvere i problemi relativi all'integrità delle risorse di SQL Server &#40;Utilità SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="47a11-197">Troubleshoot SQL Server Resource Health &#40;SQL Server Utility&#41;</span></span>](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md)
