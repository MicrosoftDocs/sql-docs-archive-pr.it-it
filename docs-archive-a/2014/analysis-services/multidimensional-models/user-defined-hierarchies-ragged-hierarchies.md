---
title: Gerarchie incomplete | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ragged hierarchies [Analysis Services]
ms.assetid: e40a5788-7ede-4b0f-93ab-46ca33d0cace
author: minewiskan
ms.author: owend
ms.openlocfilehash: 02cbb24b7ae80facf0ddbb1495fccc8f848df377
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87724248"
---
# <a name="ragged-hierarchies"></a><span data-ttu-id="abd22-102">Gerarchie incomplete</span><span class="sxs-lookup"><span data-stu-id="abd22-102">Ragged Hierarchies</span></span>
  <span data-ttu-id="abd22-103">Una gerarchia incompleta è una gerarchia definita dall'utente contenente un numero di livelli ineguale.</span><span class="sxs-lookup"><span data-stu-id="abd22-103">A ragged hierarchy is a user-defined hierarchy that has an uneven number of levels.</span></span> <span data-ttu-id="abd22-104">Sono esempi comuni un organigramma in cui un responsabile di alto livello ha sia responsabili di reparto sia non responsabili come subalterni oppure le gerarchie geografiche composte da Paese-Regione-Città, in cui alcune città non presentano un elemento padre Stato o Provincia, ad esempio Washington D.C., Città del Vaticano o Nuova Delhi.</span><span class="sxs-lookup"><span data-stu-id="abd22-104">Common examples include an organizational chart where a high-level manager has both departmental managers and non-managers as direct reports, or geographic hierarchies composed of Country-Region-City, where some cities lack a parent State or Province, such as Washington D.C., Vatican City, or New Delhi.</span></span>  
  
 <span data-ttu-id="abd22-105">Nella maggior parte delle gerarchie di una dimensione, ciascun livello presenta lo stesso numero di membri di livello superiore di tutti gli altri membri allo stesso livello.</span><span class="sxs-lookup"><span data-stu-id="abd22-105">For most hierarchies in a dimension, each level has the same number of members above it as any other member at the same level.</span></span> <span data-ttu-id="abd22-106">In una gerarchia incompleta, invece, il membro padre logico di almeno un membro non si trova nel livello immediatamente superiore rispetto al membro.</span><span class="sxs-lookup"><span data-stu-id="abd22-106">A ragged hierarchy is different in that the logical parent of at least one member is not in the level immediately above the member.</span></span> <span data-ttu-id="abd22-107">Quando si verifica questa situazione, il numero di livelli di nidificazione della gerarchia varia in base ai percorsi di drill-down.</span><span class="sxs-lookup"><span data-stu-id="abd22-107">When this occurs, the hierarchy descends to different levels for different drilldown paths.</span></span> <span data-ttu-id="abd22-108">In un'applicazione client, questo può rendere i percorsi di drill-down inutilmente complicati.</span><span class="sxs-lookup"><span data-stu-id="abd22-108">In a client application, this can make drilldown paths unnecessarily complicated.</span></span>  
  
 <span data-ttu-id="abd22-109">Le applicazioni client variano in base alla modalità con cui, tramite esse, viene gestita una gerarchia incompleta.</span><span class="sxs-lookup"><span data-stu-id="abd22-109">Client applications vary in how well they handle a ragged hierarchy.</span></span> <span data-ttu-id="abd22-110">Se nel modello in uso sono presenti gerarchie incomplete, è necessario eseguire un lavoro supplementare per ottenere il comportamento di rendering previsto.</span><span class="sxs-lookup"><span data-stu-id="abd22-110">If ragged hierarchies exist in your model, be prepared to do a little extra work to get the rendering behavior you expect.</span></span>  
  
 <span data-ttu-id="abd22-111">Innanzitutto, controllare il modo in cui l'applicazione client gestisce il percorso di drill-down.</span><span class="sxs-lookup"><span data-stu-id="abd22-111">As a first step, check the client application to see how it handles the drilldown path.</span></span> <span data-ttu-id="abd22-112">Ad esempio, tramite Excel i nomi padre vengono ripetuti come segnaposto per i valori mancanti.</span><span class="sxs-lookup"><span data-stu-id="abd22-112">For example, Excel repeats the parent names as placeholders for missing values.</span></span> <span data-ttu-id="abd22-113">Per visualizzare questo comportamento, creare una tabella pivot utilizzando la dimensione Territorio vendita nel modello multidimensionale Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="abd22-113">To see this behavior yourself, build a PivotTable using the Sales Territory dimension in the Adventure Works multidimensional model.</span></span> <span data-ttu-id="abd22-114">In una tabella pivot che contiene gli attributi Gruppo, Paese e Regione per Territorio vendita, ai paesi che non presentano un valore relativo alla regione verrà assegnato un segnaposto, in questo caso una ripetizione dell'elemento padre al livello superiore (il nome del paese).</span><span class="sxs-lookup"><span data-stu-id="abd22-114">In a PivotTable having the Sales Territory attributes Group, Country, and Region, you will see that countries missing a region value will get a placeholder, in this case a repeat of the parent above it (Country name).</span></span> <span data-ttu-id="abd22-115">Questo comportamento deriva dalla proprietà della stringa di connessione MDX Compatibility=1 che è fissa in Excel.</span><span class="sxs-lookup"><span data-stu-id="abd22-115">This behavior derives from the MDX Compatibility=1 connection string property that is fixed within Excel.</span></span> <span data-ttu-id="abd22-116">Se il client non fornisce naturalmente i comportamenti di drill-down desiderati, è possibile impostare le proprietà nel modello, in modo da modificare almeno alcuni di questi comportamenti.</span><span class="sxs-lookup"><span data-stu-id="abd22-116">If the client does not naturally provide the drill-down behaviors you are looking for, you can set properties in the model to change at least some of those behaviors.</span></span>  
  
 <span data-ttu-id="abd22-117">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="abd22-117">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="abd22-118">Approcci per la modifica della navigazione drill-down in una gerarchia incompleta</span><span class="sxs-lookup"><span data-stu-id="abd22-118">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>](#bkmk_approach)  
  
-   [<span data-ttu-id="abd22-119">Impostare HideMemberIf per nascondere i membri in una gerarchia regolare</span><span class="sxs-lookup"><span data-stu-id="abd22-119">Set HideMemberIf to hide members in a regular hierarchy</span></span>](#bkmk_Hide)  
  
-   [<span data-ttu-id="abd22-120">Impostare la compatibilità MDX per determinare la rappresentazione dei segnaposto nelle applicazioni client</span><span class="sxs-lookup"><span data-stu-id="abd22-120">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>](#bkmk_Mdx)  
  
##  <a name="approaches-for-modifying-drilldown-navigation-in-a-ragged-hierarchy"></a><a name="bkmk_approach"></a> <span data-ttu-id="abd22-121">Approcci per la modifica della navigazione drill-down in una gerarchia incompleta</span><span class="sxs-lookup"><span data-stu-id="abd22-121">Approaches for modifying drilldown navigation in a ragged hierarchy</span></span>  
 <span data-ttu-id="abd22-122">La presenza di una gerarchia incompleta diventa un problema quando dalla navigazione drill-down non vengono restituiti i valori previsti o viene percepita come difficile da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="abd22-122">The presence of a ragged hierarchy becomes a problem when drilldown navigation does not return expected values or is perceived as awkward to use.</span></span> <span data-ttu-id="abd22-123">Per risolvere i problemi di navigazione causati da gerarchie incomplete, possono essere considerate le seguenti opzioni:</span><span class="sxs-lookup"><span data-stu-id="abd22-123">To fix navigation problems that result from ragged hierarchies, consider these options:</span></span>  
  
-   <span data-ttu-id="abd22-124">Utilizzare una gerarchia regolare ma impostare la proprietà `HideMemberIf` in ciascun livello, per specificare se un livello mancante viene visualizzato all'utente.</span><span class="sxs-lookup"><span data-stu-id="abd22-124">Use a regular hierarchy but set the `HideMemberIf` property on each level to specify whether a missing level is visualized to the user.</span></span> <span data-ttu-id="abd22-125">Se si imposta la proprietà `HideMemberIf`, è necessario impostare anche la proprietà `MDXCompatibility` nella stringa di connessione, per sostituire i comportamenti di navigazione predefiniti.</span><span class="sxs-lookup"><span data-stu-id="abd22-125">When setting `HideMemberIf`, you should also set `MDXCompatibility` on the connection string to override default navigation behaviors.</span></span> <span data-ttu-id="abd22-126">Le istruzioni per l'impostazione di queste proprietà sono fornite in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="abd22-126">Instructions for setting these properties are in this topic.</span></span>  
  
-   <span data-ttu-id="abd22-127">Creare una gerarchia padre-figlio che gestisca esplicitamente i membri dei livelli.</span><span class="sxs-lookup"><span data-stu-id="abd22-127">Create a parent-child hierarchy that explicitly manages the level members.</span></span> <span data-ttu-id="abd22-128">Per un'illustrazione della tecnica, vedere il post di blog [Ragged Hierarchy in SSAS](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/)(Gerarchia incompleta in SSAS).</span><span class="sxs-lookup"><span data-stu-id="abd22-128">For an illustration of the technique, see [Ragged Hierarchy in SSAS (blog post)](http://dwbi1.wordpress.com/2011/03/30/ragged-hierarchy-in-ssas/).</span></span> <span data-ttu-id="abd22-129">Per ulteriori informazioni nella documentazione online di, vedere [gerarchia padre-figlio](parent-child-dimension.md).</span><span class="sxs-lookup"><span data-stu-id="abd22-129">For more information in Books Online, see [Parent-Child Hierarchy](parent-child-dimension.md).</span></span> <span data-ttu-id="abd22-130">L'aspetto negativo relativo alla creazione di una gerarchia padre-figlio è che si può disporre solo di una per ogni dimensione e che in genere si verifica una riduzione delle prestazioni durante il calcolo delle aggregazioni per i membri intermedi.</span><span class="sxs-lookup"><span data-stu-id="abd22-130">Downsides to creating a parent-child hierarchy are that you can only have one per dimension, and you typically incur a performance penalty when calculating aggregations for intermediate members.</span></span>  
  
 <span data-ttu-id="abd22-131">Se la dimensione contiene più di una gerarchia incompleta, è necessario utilizzare il primo approccio, impostando la proprietà `HideMemberIf`.</span><span class="sxs-lookup"><span data-stu-id="abd22-131">If your dimension contains more than one ragged hierarchy, you should use the first approach, setting `HideMemberIf`.</span></span> <span data-ttu-id="abd22-132">Gli sviluppatori BI con esperienza pratica nella gestione di gerarchie incomplete vanno oltre, promuovendo modifiche aggiuntive nelle tabelle dati fisiche, mediante la creazione di tabelle separate per ciascun livello.</span><span class="sxs-lookup"><span data-stu-id="abd22-132">BI Developers with practical experience in working with ragged hierarchies go further in advocating for additional changes in the physical data tables, creating separate tables for each level.</span></span> <span data-ttu-id="abd22-133">Per informazioni dettagliate su questa tecnica, vedere [la sezione relativa alle gerarchie finanziarie SSAS di Martin Mason-parte 1a-incomplete (Blog)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) .</span><span class="sxs-lookup"><span data-stu-id="abd22-133">See [Martin Mason's the SSAS Financial Cube-Part 1a-Ragged Hierarchies (blog)](http://martinmason.wordpress.com/2012/03/03/the-ssas-financial-cubepart-1aragged-hierarchies-cont/) for details about this technique.</span></span>  
  
##  <a name="set-hidememberif-to-hide-members-in-a-regular-hierarchy"></a><a name="bkmk_Hide"></a> <span data-ttu-id="abd22-134">Impostazione della proprietà HideMemberIf per nascondere i membri in una gerarchia regolare</span><span class="sxs-lookup"><span data-stu-id="abd22-134">Set HideMemberIf to hide members in a regular hierarchy</span></span>  
 <span data-ttu-id="abd22-135">Nella tabella di una dimensione incompleta, i membri mancanti da un punto di vista logico possono essere rappresentati in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="abd22-135">In a ragged dimension's table, the logically missing members can be represented in different ways.</span></span> <span data-ttu-id="abd22-136">Le celle della tabella possono contenere valori Null o stringhe vuote oppure possono contenere lo stesso valore del membro padre come segnaposto.</span><span class="sxs-lookup"><span data-stu-id="abd22-136">The table cells can contain nulls or empty strings, or they can contain the same value as their parent to serve as a placeholder.</span></span> <span data-ttu-id="abd22-137">La rappresentazione dei segnaposti è determinata dallo stato del segnaposto dei membri figlio, come determinato dalla proprietà `HideMemberIf` e dalla proprietà della stringa di connessione `MDX Compatibility` per l'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="abd22-137">The representation of placeholders is determined by the placeholder status of child members, as determined by the `HideMemberIf` property, and the `MDX Compatibility` connection string property for the client application.</span></span>  
  
 <span data-ttu-id="abd22-138">Per le applicazioni client che supportano la visualizzazione di gerarchie incomplete, è possibile utilizzare queste proprietà per nascondere i membri mancanti da un punto di vista logico.</span><span class="sxs-lookup"><span data-stu-id="abd22-138">For client applications that support the display of ragged hierarchies, you can use these properties to hide logically missing members.</span></span>  
  
1.  <span data-ttu-id="abd22-139">In SSDT, fare doppio clic su una dimensione per aprirla in Progettazione dimensioni.</span><span class="sxs-lookup"><span data-stu-id="abd22-139">In SSDT, double-click a dimension to open it in Dimension Designer.</span></span> <span data-ttu-id="abd22-140">Nella prima scheda, Struttura dimensione, vengono visualizzate le gerarchie di attributi nel riquadro Gerarchie.</span><span class="sxs-lookup"><span data-stu-id="abd22-140">The first tab, Dimension Structure, shows attribute hierarchies in the Hierarchies pane.</span></span>  
  
2.  <span data-ttu-id="abd22-141">Fare clic con il pulsante destro del mouse su un membro all'interno della gerarchia e scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="abd22-141">Right-click a member within the hierarchy and select **Properties**.</span></span> <span data-ttu-id="abd22-142">Impostare la proprietà `HideMemberIf` su uno dei valori descritti in basso.</span><span class="sxs-lookup"><span data-stu-id="abd22-142">Set `HideMemberIf` to one of the values described below.</span></span>  
  
    |<span data-ttu-id="abd22-143">Impostazione di HideMemberIf</span><span class="sxs-lookup"><span data-stu-id="abd22-143">HideMemberIf Setting</span></span>|<span data-ttu-id="abd22-144">Descrizione</span><span class="sxs-lookup"><span data-stu-id="abd22-144">Description</span></span>|  
    |--------------------------|-----------------|  
    |`Never`|<span data-ttu-id="abd22-145">I membri del livello non vengono mai nascosti.</span><span class="sxs-lookup"><span data-stu-id="abd22-145">Level members are never hidden.</span></span> <span data-ttu-id="abd22-146">Rappresenta il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="abd22-146">This is the default value.</span></span>|  
    |<span data-ttu-id="abd22-147">**OnlyChildWithNoName**</span><span class="sxs-lookup"><span data-stu-id="abd22-147">**OnlyChildWithNoName**</span></span>|<span data-ttu-id="abd22-148">Un membro del livello viene nascosto quando è l'unico elemento figlio del relativo padre e il nome è un valore Null o una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="abd22-148">A level member is hidden when it is the only child of its parent and its name is null or an empty string.</span></span>|  
    |<span data-ttu-id="abd22-149">**OnlyChildWithParentName**</span><span class="sxs-lookup"><span data-stu-id="abd22-149">**OnlyChildWithParentName**</span></span>|<span data-ttu-id="abd22-150">Un membro del livello viene nascosto quando è l'unico elemento figlio del relativo padre e il nome corrisponde a quello del padre.</span><span class="sxs-lookup"><span data-stu-id="abd22-150">A level member is hidden when it is the only child of its parent and its name is the same as the name of its parent.</span></span>|  
    |<span data-ttu-id="abd22-151">**NoName**</span><span class="sxs-lookup"><span data-stu-id="abd22-151">**NoName**</span></span>|<span data-ttu-id="abd22-152">Un membro del livello viene nascosto quando il nome è vuoto.</span><span class="sxs-lookup"><span data-stu-id="abd22-152">A level member is hidden when its name is empty.</span></span>|  
    |<span data-ttu-id="abd22-153">**ParentName**</span><span class="sxs-lookup"><span data-stu-id="abd22-153">**ParentName**</span></span>|<span data-ttu-id="abd22-154">Un membro del livello viene nascosto quando il nome è identico a quello del padre.</span><span class="sxs-lookup"><span data-stu-id="abd22-154">A level member is hidden when its name is identical to that of its parent.</span></span>|  
  
##  <a name="set-mdx-compatibility-to-determine-how-placeholders-are-represented-in-client-applications"></a><a name="bkmk_Mdx"></a><span data-ttu-id="abd22-155">Impostare la compatibilità MDX per determinare come vengono rappresentati i segnaposto nelle applicazioni client</span><span class="sxs-lookup"><span data-stu-id="abd22-155">Set MDX Compatibility to determine how placeholders are represented in client applications</span></span>  
 <span data-ttu-id="abd22-156">Dopo aver impostato la proprietà `HideMemberIf` in un livello della gerarchia, è necessario impostare anche la proprietà `MDX Compatibility` nella stringa di connessione inviata dall'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="abd22-156">After setting `HideMemberIf` on a hierarchy level, you should also set the `MDX Compatibility` property in the connection string sent from the client application.</span></span> <span data-ttu-id="abd22-157">L'impostazione di `MDX Compatibility` determina se viene utilizzata la proprietà `HideMemberIf`.</span><span class="sxs-lookup"><span data-stu-id="abd22-157">The `MDX Compatibility` setting determines whether the `HideMemberIf` is used.</span></span>  
  
|<span data-ttu-id="abd22-158">Impostazione di MDX Compatibility</span><span class="sxs-lookup"><span data-stu-id="abd22-158">MDX Compatibility Setting</span></span>|<span data-ttu-id="abd22-159">Descrizione</span><span class="sxs-lookup"><span data-stu-id="abd22-159">Description</span></span>|<span data-ttu-id="abd22-160">Uso</span><span class="sxs-lookup"><span data-stu-id="abd22-160">Usage</span></span>|  
|-------------------------------|-----------------|-----------|  
|<span data-ttu-id="abd22-161">**1**</span><span class="sxs-lookup"><span data-stu-id="abd22-161">**1**</span></span>|<span data-ttu-id="abd22-162">Viene visualizzato un valore di segnaposto.</span><span class="sxs-lookup"><span data-stu-id="abd22-162">Show a placeholder value.</span></span>|<span data-ttu-id="abd22-163">Questo è il valore predefinito utilizzato da Excel, SSDT e SSMS.</span><span class="sxs-lookup"><span data-stu-id="abd22-163">This is the default used by Excel, SSDT, and SSMS.</span></span> <span data-ttu-id="abd22-164">Indica al server di restituire i valori di segnaposto quando la navigazione drill-down svuota i livelli in una gerarchia incompleta.</span><span class="sxs-lookup"><span data-stu-id="abd22-164">It instructs the server to return placeholder values when drilling down empty levels in a ragged hierarchy.</span></span> <span data-ttu-id="abd22-165">Se si fa clic sul valore di segnaposto, è possibile continuare la navigazione verso il basso per ottenere i nodi figlio (foglia).</span><span class="sxs-lookup"><span data-stu-id="abd22-165">If you click the placeholder value, you can continue down to get to the child (leaf) nodes.</span></span><br /><br /> <span data-ttu-id="abd22-166">Excel contiene la stringa di connessione utilizzata per connettersi ad Analysis Services e imposta sempre la proprietà `MDX Compatibility` su 1 per ciascuna nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="abd22-166">Excel owns the connection string used to connect to Analysis Services, and it always sets `MDX Compatibility` to 1 on each new connection.</span></span> <span data-ttu-id="abd22-167">Questo comportamento preserva la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="abd22-167">This behavior preserves backward compatibility.</span></span>|  
|<span data-ttu-id="abd22-168">**2**</span><span class="sxs-lookup"><span data-stu-id="abd22-168">**2**</span></span>|<span data-ttu-id="abd22-169">Viene nascosto un valore di segnaposto (un valore Null o un duplicato del livello padre) ma vengono visualizzati altri livelli e nodi che hanno valori pertinenti.</span><span class="sxs-lookup"><span data-stu-id="abd22-169">Hide a placeholder value (either a null value or a duplicate of the parent level), but show other levels and nodes having relevant values.</span></span>|<span data-ttu-id="abd22-170">`MDX Compatibility`=2 viene in genere visualizzato come impostazione preferita in termini di gerarchie incomplete</span><span class="sxs-lookup"><span data-stu-id="abd22-170">`MDX Compatibility`=2 is typically viewed as the preferred setting in terms of ragged hierarchies.</span></span> <span data-ttu-id="abd22-171">Un report [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] e alcune applicazioni client di terze parti possono mantenere questa impostazione.</span><span class="sxs-lookup"><span data-stu-id="abd22-171">A [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report and some third-party client applications can persist this setting.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="abd22-172">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="abd22-172">See Also</span></span>  
 <span data-ttu-id="abd22-173">[Creazione di gerarchie definite dall'utente](user-defined-hierarchies-create.md) </span><span class="sxs-lookup"><span data-stu-id="abd22-173">[Create User-Defined Hierarchies](user-defined-hierarchies-create.md) </span></span>  
 <span data-ttu-id="abd22-174">[Gerarchie utente](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span><span class="sxs-lookup"><span data-stu-id="abd22-174">[User Hierarchies](../multidimensional-models-olap-logical-dimension-objects/user-hierarchies.md) </span></span>  
 <span data-ttu-id="abd22-175">[Gerarchia padre-figlio](parent-child-dimension.md) </span><span class="sxs-lookup"><span data-stu-id="abd22-175">[Parent-Child Hierarchy](parent-child-dimension.md) </span></span>  
 [<span data-ttu-id="abd22-176">Proprietà delle stringhe di connessione &#40;Analysis Services&#41;</span><span class="sxs-lookup"><span data-stu-id="abd22-176">Connection String Properties &#40;Analysis Services&#41;</span></span>](https://docs.microsoft.com/analysis-services/instances/connection-string-properties-analysis-services)  
  
  
