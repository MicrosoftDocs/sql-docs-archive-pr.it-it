---
title: Pianificare un aggiornamento dati (PowerPivot per SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9d6078cf59c27c15ead8f22047ba9add20757be7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625627"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="632ee-102">Pianificare un aggiornamento dati (PowerPivot per SharePoint)</span><span class="sxs-lookup"><span data-stu-id="632ee-102">Schedule a Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="632ee-103">È possibile pianificare aggiornamenti automatici dei dati PowerPivot in una cartella di lavoro di Excel pubblicata in un sito di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="632ee-103">You can schedule data refresh to get automatic updates to PowerPivot data inside an Excel workbook that you published to a SharePoint site.</span></span>  
  
 <span data-ttu-id="632ee-104">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="632ee-104">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="632ee-105">**Contenuto dell'argomento:**</span><span class="sxs-lookup"><span data-stu-id="632ee-105">**In this topic:**</span></span>  
  
 [<span data-ttu-id="632ee-106">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="632ee-106">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="632ee-107">Panoramica dell'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-107">Data Refresh Overview</span></span>](#intro)  
  
 [<span data-ttu-id="632ee-108">Abilitare e pianificare l'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-108">Enable and schedule data refresh</span></span>](#drenablesched)  
  
 [<span data-ttu-id="632ee-109">Verificare l'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-109">Verify Data Refresh</span></span>](#drverify)  
  
> [!NOTE]  
>  <span data-ttu-id="632ee-110">L'aggiornamento dati PowerPivot viene eseguito dalle istanze del server Analysis Services nella farm di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="632ee-110">PowerPivot data refresh is performed by Analysis Services server instances in the SharePoint farm.</span></span> <span data-ttu-id="632ee-111">Non è correlato alla funzionalità di aggiornamento dati fornita in Excel Services.</span><span class="sxs-lookup"><span data-stu-id="632ee-111">It is not related to the data refresh feature that is provided in Excel Services.</span></span> <span data-ttu-id="632ee-112">La funzionalità Pianificazione dell'aggiornamento dati non aggiornerà i dati non PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-112">The PowePivot Schedule data refresh feature will not refresh non PowerPivot data.</span></span>  
  
##  <a name="prerequisites"></a><a name="prereq"></a> <span data-ttu-id="632ee-113">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="632ee-113">Prerequisites</span></span>  
 <span data-ttu-id="632ee-114">Per creare una pianificazione dell'aggiornamento dati è necessario disporre almeno del livello di autorizzazione di collaborazione relativamente alla cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-114">You must have Contribute level of permission or greater on the workbook to create a data refresh schedule.</span></span>  
  
 <span data-ttu-id="632ee-115">Devono essere disponibili le origini dati esterne a cui si accede durante l'aggiornamento dati e le credenziali specificate nella pianificazione devono consentire di accedere a tali origini dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-115">External data sources that are accessed during data refresh must be available and the credentials you specify in the schedule must have permission to access those data sources.</span></span> <span data-ttu-id="632ee-116">L'aggiornamento dati pianificato richiede l'accesso a un percorso origine dati tramite una connessione di rete (ad esempio da una condivisione file di rete piuttosto che da una cartella locale nella workstation).</span><span class="sxs-lookup"><span data-stu-id="632ee-116">Scheduled data refresh requires a data source location that is accessible over a network connection (for example, from a network file share rather than a local folder on your workstation).</span></span>  
  
 <span data-ttu-id="632ee-117">L'origine dati non può essere un documento di Office o un database di Access.</span><span class="sxs-lookup"><span data-stu-id="632ee-117">The data source cannot be an Office document or Access database.</span></span> <span data-ttu-id="632ee-118">Office non supporta l'utilizzo dei componenti per la connettività dei dati di Office in un ambiente server.</span><span class="sxs-lookup"><span data-stu-id="632ee-118">Office does not support the use of the Office data connectivity components in a server environment.</span></span> <span data-ttu-id="632ee-119">Se nella cartella di lavoro sono contenuti dati da queste origini, assicurarsi di rimuovere tali origini dall'elenco dell'origine dati nella pianificazione dell'aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-119">If your workbook contains data from these sources, be sure to remove those sources from the data source list in your data refresh schedule.</span></span>  
  
 <span data-ttu-id="632ee-120">La cartella di lavoro deve essere la versione [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="632ee-120">The workbook must be a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version.</span></span> <span data-ttu-id="632ee-121">Se si usano cartelle di lavoro create nella versione precedente di PowerPivot per Excel, la pianificazione dell'aggiornamento dati non funzionerà a meno che non si aggiorni il database alla versione più recente.</span><span class="sxs-lookup"><span data-stu-id="632ee-121">If you use workbooks that were created in the previous release of PowerPivot for Excel, schedule data refresh will not work unless you upgrade the database to the most recent version.</span></span>  
  
 <span data-ttu-id="632ee-122">La cartella di lavoro deve essere archiviata al termine dell'operazione di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="632ee-122">The workbook must be checked in at the time the refresh operation is finished.</span></span> <span data-ttu-id="632ee-123">Un blocco nella cartella di lavoro viene posizionato sul file alla fine dell'aggiornamento dei dati, quando il file viene salvato, anziché quando l'aggiornamento viene avviato.</span><span class="sxs-lookup"><span data-stu-id="632ee-123">A lock on the workbook is placed on the file at the end of data refresh, when the file is saved, rather than when refresh starts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="632ee-124">Il server non consente di bloccare la cartella di lavoro mentre l'aggiornamento dei dati è in corso.</span><span class="sxs-lookup"><span data-stu-id="632ee-124">The server does not lock the workbook while the data refresh is in progress.</span></span> <span data-ttu-id="632ee-125">Tuttavia, consente di bloccare il file alla fine dell'aggiornamento allo scopo di archiviare il file aggiornato.</span><span class="sxs-lookup"><span data-stu-id="632ee-125">However, it does lock the file at the end of data refresh for the purpose of checking in the updated file.</span></span> <span data-ttu-id="632ee-126">Se al momento il file viene Estratto da un altro utente, i dati aggiornati verranno eliminati. Analogamente, se il file viene archiviato, ma è significativamente diverso dalla copia recuperata dal server all'inizio dell'aggiornamento dati, i dati aggiornati verranno rimossi.</span><span class="sxs-lookup"><span data-stu-id="632ee-126">If at this time, the file is checked out to another user, the refreshed data will be thrown out. Similarly, if the file is checked in, but it is significantly different from the copy retrieved by the server at the start of data refresh, the refreshed data will be discarded.</span></span>  
  
##  <a name="data-refresh-overview"></a><a name="intro"></a><span data-ttu-id="632ee-127">Panoramica dell'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-127">Data Refresh Overview</span></span>  
 <span data-ttu-id="632ee-128">I dati PowerPivot in una cartella di lavoro di Excel possono provenire da più origini dati esterne, inclusi database esterni o file di dati ai quali si accede da server remoti o da condivisioni file di rete.</span><span class="sxs-lookup"><span data-stu-id="632ee-128">PowerPivot data in an Excel workbook can originate from multiple external data sources, including external databases or data files that you access from remote servers or network file shares.</span></span> <span data-ttu-id="632ee-129">Per le cartelle di lavoro di PowerPivot in cui sono contenuti i dati importati da origini dati connesse o esterne, è possibile configurare l'aggiornamento dei dati per pianificare un'importazione automatica di dati aggiornati da tali origini iniziali.</span><span class="sxs-lookup"><span data-stu-id="632ee-129">For PowerPivot workbooks that contain imported data from connected or external data sources, you can configure data refresh to schedule an automatic import of updated data from those original sources.</span></span>  
  
 <span data-ttu-id="632ee-130">L'accesso a un'origine dati esterna viene eseguito tramite una stringa di connessione incorporata, un URL o un percorso UNC specificati quando i dati originali sono stati importati nella cartella di lavoro tramite l'applicazione client di PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-130">An external data source is accessed through an embedded connection string, URL, or UNC path that you specified when you imported the original data into the workbook using the PowerPivot client application.</span></span> <span data-ttu-id="632ee-131">Le informazioni di connessione originali archiviate nella cartella di lavoro di PowerPivot vengono riutilizzate per le successive operazioni di aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-131">Original connection information that is stored in the PowerPivot workbook is reused for subsequent data refresh operations.</span></span> <span data-ttu-id="632ee-132">Sebbene sia possibile sovrascrivere le credenziali usate per connettersi alle origini dati, non è possibile sovrascrivere le stringhe di connessione per ragioni di aggiornamento dati; vengono usate solo le informazioni di connessione esistenti.</span><span class="sxs-lookup"><span data-stu-id="632ee-132">Although you can overwrite credentials used to connect to data sources, you cannot overwrite connection strings for data refresh purposes; only existing connection information is used.</span></span>  
  
 <span data-ttu-id="632ee-133">È disponibile una sola pagina della pianificazione di aggiornamento dei dati per ogni cartella di lavoro e tutte le informazioni sulla pianificazione vengono specificate in quella pagina.</span><span class="sxs-lookup"><span data-stu-id="632ee-133">There is only one data refresh schedule page for each workbook, and all schedule information is specified on that page.</span></span> <span data-ttu-id="632ee-134">In genere, l'utente che ha creato la cartella di lavoro definisce la pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-134">Typically, the person who authored the workbook defines the schedule.</span></span>  
  
 <span data-ttu-id="632ee-135">In qualità di proprietario della pianificazione è possibile effettuare le attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="632ee-135">As the schedule owner, you perform the following tasks:</span></span>  
  
-   <span data-ttu-id="632ee-136">Definire la pianificazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="632ee-136">Define the default schedule.</span></span> <span data-ttu-id="632ee-137">È la pianificazione usata se è nessuna programmazione è definita a livello di origine dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-137">This is the schedule that is used if there are no scheduled defined at the data source level.</span></span>  
  
-   <span data-ttu-id="632ee-138">Specificare le credenziali usate per eseguire l'aggiornamento dei dati</span><span class="sxs-lookup"><span data-stu-id="632ee-138">Specify the credentials used to run data refresh</span></span>  
  
-   <span data-ttu-id="632ee-139">Scegliere le origini dati da includere nell'operazione di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="632ee-139">Choose which data sources to include in the refresh operation.</span></span>  
  
-   <span data-ttu-id="632ee-140">Facoltativamente, specificare pianificazioni e credenziali singole inline per ogni origine dati su cui vengono eseguite le query durante l'aggiornamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-140">Optionally, specify in-line, individual schedules and credentials for each data source that is queried during data refresh.</span></span> <span data-ttu-id="632ee-141">Ogni origine dati può essere aggiornata indipendentemente.</span><span class="sxs-lookup"><span data-stu-id="632ee-141">Each data source can be refreshed independently.</span></span> <span data-ttu-id="632ee-142">Se si creano pianificazioni personalizzate per ogni origine dati, la pianificazione predefinita viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="632ee-142">If you create custom schedules for every data source, the default schedule is ignored.</span></span>  
  
 <span data-ttu-id="632ee-143">La creazione di pianificazioni granulari per singole origini dati consente di associare la pianificazione dell'aggiornamento alle fluttuazioni nelle origini dati esterne.</span><span class="sxs-lookup"><span data-stu-id="632ee-143">Creating granular schedules for individual data sources enables you to match the refresh schedule to fluctuations in the external data sources.</span></span> <span data-ttu-id="632ee-144">Ad esempio, se in un'origine dati esterna sono contenuti dati transazionali generati durante il giorno, è possibile creare una singola pianificazione dell'aggiornamento dei dati per tale origine dati per ottenere le informazioni aggiornate di notte.</span><span class="sxs-lookup"><span data-stu-id="632ee-144">For example, if an external data source contains transactional data that is generated throughout the day, you can create an individual data refresh schedule for that data source to get its updated information nightly.</span></span>  
  
##  <a name="enable-and-schedule-data-refresh"></a><a name="drenablesched"></a><span data-ttu-id="632ee-145">Abilitare e pianificare l'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-145">Enable and schedule data refresh</span></span>  
 <span data-ttu-id="632ee-146">Usare le istruzioni seguenti per pianificare l'aggiornamento dei dati PowerPivot in una cartella di lavoro di Excel pubblicata in una raccolta di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="632ee-146">Use the following instructions to schedule data refresh for PowerPivot data in an Excel workbook that is published to a SharePoint library.</span></span>  
  
1.  <span data-ttu-id="632ee-147">Nella raccolta in cui è contenuta la cartella di lavoro, selezionare la cartella di lavoro, quindi fare clic sulla freccia GIÙ per visualizzare un elenco di comandi.</span><span class="sxs-lookup"><span data-stu-id="632ee-147">In the library that contains the workbook, select the workbook and then click the down arrow to display a list of commands.</span></span>  
  
2.  <span data-ttu-id="632ee-148">Fare clic su **Gestire l'aggiornamento dati PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="632ee-148">Click **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="632ee-149">Se è già stata definita una pianificazione dell'aggiornamento dei dati, verrà invece visualizzata la pagina della cronologia di visualizzazione dell'aggiornamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-149">If a data refresh schedule is already defined, you will see the View Data Refresh history page instead.</span></span> <span data-ttu-id="632ee-150">È possibile scegliere l'opzione di configurazione dell'aggiornamento dei dati per aprire la pagina di definizione della pianificazione. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="632ee-150">You can click **Configure data refresh** to open the schedule definition page.</span></span>  
  
3.  <span data-ttu-id="632ee-151">Nella pagina di definizione della pianificazione, selezionare la casella di controllo **Abilita** .</span><span class="sxs-lookup"><span data-stu-id="632ee-151">In the schedule definition page, select the **Enable** checkbox.</span></span>  
  
4.  <span data-ttu-id="632ee-152">In Dettagli pianificazione specificare il tipo di pianificazione e specificare i relativi dettagli.</span><span class="sxs-lookup"><span data-stu-id="632ee-152">In Schedule Details, specify the type of schedule and specify its details.</span></span> <span data-ttu-id="632ee-153">Con questo passaggio viene creata la pianificazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="632ee-153">This step creates the default schedule.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="632ee-154">Assicurarsi di selezionare la casella di controllo **Aggiorna anche appena possibile** .</span><span class="sxs-lookup"><span data-stu-id="632ee-154">Be sure to select the **Also refresh as soon as possible** checkbox.</span></span> <span data-ttu-id="632ee-155">In questo modo è possibile verificare che l'aggiornamento dati sia operativo per questa cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-155">Doing so lets you verify that data refresh is operational for this workbook.</span></span> <span data-ttu-id="632ee-156">Dopo avere salvato la pianificazione, l'avvio dell'aggiornamento dati potrebbe richiedere fino a un minuto.</span><span class="sxs-lookup"><span data-stu-id="632ee-156">Note that after you save schedule, it can take up to a minute for data refresh to start.</span></span>  
  
5.  <span data-ttu-id="632ee-157">In Prima ora di inizio scegliere uno degli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="632ee-157">In Earliest Start Time, choose one of the following:</span></span>  
  
    1.  <span data-ttu-id="632ee-158">Tramite l'opzione**Dopo l'orario di ufficio** viene specificato un periodo di elaborazione dopo le ore di lavoro stabilite quando è più probabile che i server di database dispongano dei dati correnti generati durante tutto il giorno lavorativo.</span><span class="sxs-lookup"><span data-stu-id="632ee-158">**After business hours** specifies an off-hours processing period when database servers are more likely to have current data that was generated throughout the business day.</span></span>  
  
    2.  <span data-ttu-id="632ee-159">**Prima ora di inizio specifica** rappresenta l'ora e i minuti esatti della prima ora del giorno in cui la richiesta di aggiornamento dei dati viene aggiunta a una coda dei processi.</span><span class="sxs-lookup"><span data-stu-id="632ee-159">**Specific earliest start time** is the hour and minutes of the earliest time of day the data refresh request is added to a process queue.</span></span> <span data-ttu-id="632ee-160">I minuti possono essere specificati in intervalli di 15 minuti.</span><span class="sxs-lookup"><span data-stu-id="632ee-160">You can specify minutes in 15-minute intervals.</span></span> <span data-ttu-id="632ee-161">L'impostazione si applica al giorno corrente e alle date future.</span><span class="sxs-lookup"><span data-stu-id="632ee-161">The setting applies to the current day as well as future dates.</span></span> <span data-ttu-id="632ee-162">Ad esempio, se si specifica un valore pari alle 6.30</span><span class="sxs-lookup"><span data-stu-id="632ee-162">For example, if you specify a value of 6:30 A.M.</span></span> <span data-ttu-id="632ee-163">e l'ora corrente è 16.30, la richiesta di aggiornamento verrà aggiunta alla coda del giorno corrente in quanto le 16.30</span><span class="sxs-lookup"><span data-stu-id="632ee-163">and the current time is 4:30 P.M., the refresh request will be added to the queue in the current day because 4:30 P.M.</span></span> <span data-ttu-id="632ee-164">sono successive alle 6.30.</span><span class="sxs-lookup"><span data-stu-id="632ee-164">is after 6:30 A.M.</span></span>  
  
     <span data-ttu-id="632ee-165">Tramite la prima ora di inizio viene definito il momento in cui una richiesta viene aggiunta alla coda dei processi.</span><span class="sxs-lookup"><span data-stu-id="632ee-165">Earliest start time defines when a request is added to the process queue.</span></span> <span data-ttu-id="632ee-166">L'elaborazione effettiva si verifica quando il server dispone di risorse adatte per iniziare l'elaborazione dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-166">Actual processing occurs when the server has adequate resources to begin data processing.</span></span> <span data-ttu-id="632ee-167">Il tempo dell'elaborazione effettiva sarà registrato nella cronologia dell'aggiornamento dati dopo il completamento dell'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-167">Actual processing time will be recorded in data refresh history after processing is complete.</span></span>  
  
6.  <span data-ttu-id="632ee-168">Selezionare la casella di controllo **Aggiorna anche appena possibile** per eseguire l'aggiornamento dati appena questa operazione potrà essere elaborata dal server.</span><span class="sxs-lookup"><span data-stu-id="632ee-168">Select the checkbox **Also refresh as soon as possible** to run data refresh as soon as the server can process it.</span></span> <span data-ttu-id="632ee-169">Un risultato positivo di un processo di aggiornamento dati dimostra che le origini dati sono disponibili e che le autorizzazioni e la configurazione del server sono state impostate correttamente.</span><span class="sxs-lookup"><span data-stu-id="632ee-169">A successful outcome of a data refresh job verifies that the data sources are available and that permissions and server configuration are set correctly.</span></span>  
  
7.  <span data-ttu-id="632ee-170">In Notifiche tramite posta elettronica immettere l'indirizzo di posta elettronica della persona che deve essere notificata in caso di errore di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-170">In E-mail notifications, enter the e-mail address of the person who should be notified in the event of a processing error.</span></span>  
  
8.  <span data-ttu-id="632ee-171">In Credenziali specificare un account usato per eseguire il processo di aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-171">In Credentials, specify an account used to run the data refresh job.</span></span> <span data-ttu-id="632ee-172">L'account deve disporre delle autorizzazioni di collaborazione sulla cartella di lavoro, affinché tale cartella possa essere aperta per l'aggiornamento dei relativi dati,</span><span class="sxs-lookup"><span data-stu-id="632ee-172">The account must have Contribute permissions on the workbook so that it can open the workbook to refresh its data.</span></span> <span data-ttu-id="632ee-173">e deve essere un account utente di dominio Windows.</span><span class="sxs-lookup"><span data-stu-id="632ee-173">It must be a Windows domain user account.</span></span> <span data-ttu-id="632ee-174">In molti casi, questo account deve disporre anche delle autorizzazioni di lettura sulle origini dati esterne usate durante l'aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-174">In many cases, this account must also have read permissions on the external data sources used during data refresh.</span></span> <span data-ttu-id="632ee-175">In particolare, se sono stati importati originalmente i dati usando l'opzione Usa autenticazione di Windows, la stringa di connessione è compilata per usare le credenziali di Windows dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="632ee-175">Specifically, if you originally imported the data using the Use Windows Authentication option, then the connection string is built to use the Windows credentials of the current user.</span></span> <span data-ttu-id="632ee-176">Se l'utente corrente è l'account di aggiornamento dati, tale account deve disporre delle autorizzazioni di lettura sull'origine dati esterna affinché l'aggiornamento dati venga completato correttamente.</span><span class="sxs-lookup"><span data-stu-id="632ee-176">If the current user is the data refresh account, that account must have read permissions on the external data source in order for data refresh to succeed.</span></span> <span data-ttu-id="632ee-177">Scegliere una delle seguenti opzioni:</span><span class="sxs-lookup"><span data-stu-id="632ee-177">Choose one of the following options:</span></span>  
  
    1.  <span data-ttu-id="632ee-178">Scegliere **Utilizza l'account di aggiornamento dati configurato dall'amministratore** per elaborare l'operazione di aggiornamento dati usando l'account di aggiornamento dati automatico PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-178">Choose **Use the data refresh account configured by the administrator** to process the data refresh operation using the PowerPivot unattended data refresh account.</span></span>  
  
    2.  <span data-ttu-id="632ee-179">Scegliere **Effettua la connessione con le seguenti credenziali utente di Windows** se si desidera immettere un nome utente e una password.</span><span class="sxs-lookup"><span data-stu-id="632ee-179">Choose **Connect using the following Windows user credentials** if you want to enter a user name and password.</span></span> <span data-ttu-id="632ee-180">Immettere le informazioni dell'account nel formato dominio\utente.</span><span class="sxs-lookup"><span data-stu-id="632ee-180">Enter the account information in domain\user format.</span></span>  
  
    3.  <span data-ttu-id="632ee-181">Scegliere **Effettua la connessione usando le credenziali salvate nel servizio di archiviazione sicura** se si conosce l'ID di un'applicazione di destinazione in cui sono contenute le credenziali precedentemente archiviate che si desidera usare.</span><span class="sxs-lookup"><span data-stu-id="632ee-181">Choose **Connect using the credentials saved in Secure Store Service** if you know the ID of a target application that contains previously stored credentials you want to use.</span></span>  
  
     <span data-ttu-id="632ee-182">Per ulteriori informazioni su queste opzioni, vedere [configurare le credenziali archiviate per l'aggiornamento dati powerpivot &#40;PowerPivot per SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) e [configurare l'account di aggiornamento dati automatico PowerPivot &#40;PowerPivot per SharePoint ](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="632ee-182">For more information about these options, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
9. <span data-ttu-id="632ee-183">In Origini dati selezionare la casella di controllo **Tutte le origini dati** se si desidera che tramite l'aggiornamento dati venga di nuovo eseguita una query su tutte le origini dati iniziali.</span><span class="sxs-lookup"><span data-stu-id="632ee-183">In Data Sources, select the **All data sources** checkbox if you want data refresh to re-query all of the original data sources.</span></span>  
  
     <span data-ttu-id="632ee-184">Se si seleziona questa opzione, qualsiasi origine dati esterna che fornisce dati PowerPivot viene inclusa automaticamente nell'aggiornamento, anche se l'elenco di origini dati viene modificato nel tempo quando si aggiungono o rimuovono le origini dati che forniscono dati alla cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-184">If you select this option, any external data source that provides PowerPivot data is automatically included in the refresh, even if the list of data sources changes over time as you add or remove data sources that provide data to the workbook.</span></span>  
  
     <span data-ttu-id="632ee-185">Deselezionare la casella di controllo **Tutte le origini dati** se si desidera selezionare manualmente le origini dati da includere.</span><span class="sxs-lookup"><span data-stu-id="632ee-185">Clear the **All data sources** checkbox if you want to manually select which data sources to include.</span></span> <span data-ttu-id="632ee-186">Se successivamente si modifica la cartella di lavoro aggiungendo una nuova origine dati, assicurarsi di aggiornare l'elenco delle origini dati nella pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-186">If you later modify the workbook by adding a new data source, be sure to update the data source list in the schedule.</span></span> <span data-ttu-id="632ee-187">In caso contrario, le origini dati più recenti non saranno incluse nell'operazione di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="632ee-187">Otherwise, newer data sources will not be included in the refresh operation.</span></span>  
  
     <span data-ttu-id="632ee-188">L'elenco di origini dati da cui è possibile scegliere viene recuperato dalla cartella di lavoro di PowerPivot quando viene aperta la pagina Gestisci aggiornamento dati PowerPivot per la cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-188">The list of data sources that you can choose from is retrieved from the PowerPivot workbook when you open the Manage PowerPivot Data Refresh page for the workbook.</span></span>  
  
     <span data-ttu-id="632ee-189">Assicurarsi di selezionare solo le origini dati che soddisfano i criteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="632ee-189">Be sure to select only those data sources that meet the following criteria:</span></span>  
  
    -   <span data-ttu-id="632ee-190">L'origine dati deve essere disponibile quando si verifica l'aggiornamento dei dati e nel percorso dichiarato.</span><span class="sxs-lookup"><span data-stu-id="632ee-190">The data source must be available at the time that data refresh occurs and at the stated location.</span></span> <span data-ttu-id="632ee-191">Se l'origine dati iniziale si trova in un'unità disco locale della persona che ha creato la cartella di lavoro, è necessario escludere tale origine dati dall'operazione di aggiornamento dei dati o individuare un modo per pubblicare tale origine dati in un percorso accessibile tramite una connessione di rete.</span><span class="sxs-lookup"><span data-stu-id="632ee-191">If the original data source is on a local disk drive of the person who authored the workbook, you must either exclude that data source from the data refresh operation, or find a way to publish that data source to a location that is accessible through a network connection.</span></span> <span data-ttu-id="632ee-192">Se si sposta un'origine dati in un percorso di rete, assicurarsi di aprire la cartella di lavoro in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] e di aggiornare le informazioni di connessione all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-192">If you move a data source to a network location, be sure to open the workbook in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] and update the data source connection information.</span></span> <span data-ttu-id="632ee-193">Questa operazione è necessaria per riattivare le informazioni di connessione archiviate nella cartella di lavoro di PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-193">This is necessary to re-establish the connection information that is stored in the PowerPivot workbook.</span></span>  
  
    -   <span data-ttu-id="632ee-194">L'accesso all'origine dati deve essere eseguito usando le informazioni sulle credenziali incorporate nella cartella di lavoro di PowerPivot o specificate nella pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-194">The data source must be accessed using the credential information that is embedded in the PowerPivot workbook or that is specified in the schedule.</span></span> <span data-ttu-id="632ee-195">Le informazioni sulle credenziali incorporate vengono archiviate nella cartella di lavoro di PowerPivot quando si importano dati usando PowerPivot per Excel.</span><span class="sxs-lookup"><span data-stu-id="632ee-195">Embedded credential information is stored in the PowerPivot workbook when you import data using PowerPivot for Excel.</span></span> <span data-ttu-id="632ee-196">Tali informazioni sono spesso SSPI=IntegratedSecurity o SSPI=TrustedConnection, pertanto la connessione all'origine dati viene eseguita usando le credenziali dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="632ee-196">Embedded credential information is often SSPI=IntegratedSecurity or SSPI=TrustedConnection, which means use the credentials of the current user to connect to the data source.</span></span> <span data-ttu-id="632ee-197">Se si desidera eseguire l'override delle informazioni sulle credenziali nella pianificazione dell'aggiornamento dati, è possibile specificare le credenziali archiviate predefinite.</span><span class="sxs-lookup"><span data-stu-id="632ee-197">If you want to override the credential information in your data refresh schedule, you can specify predefined, stored credentials.</span></span> <span data-ttu-id="632ee-198">Per ulteriori informazioni, vedere [configurare le credenziali archiviate per l'aggiornamento dati PowerPivot &#40;PowerPivot per SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="632ee-198">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
    -   <span data-ttu-id="632ee-199">L'aggiornamento dei dati deve avere un esito positivo per tutte le origini dati specificate.</span><span class="sxs-lookup"><span data-stu-id="632ee-199">Data refresh must succeed for all of the data sources that you specify.</span></span> <span data-ttu-id="632ee-200">In caso contrario, i dati aggiornati vengono rimossi e viene mantenuta l'ultima versione salvata della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-200">Otherwise, the refreshed data is discarded, leaving you with the last saved version of the workbook.</span></span> <span data-ttu-id="632ee-201">Escludere tutte le origini dati di cui non si è sicuri.</span><span class="sxs-lookup"><span data-stu-id="632ee-201">Exclude any data sources that you are not sure about.</span></span>  
  
    -   <span data-ttu-id="632ee-202">L'aggiornamento dei dati non deve invalidare altri dati della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-202">Data refresh must not invalidate other data in your workbook.</span></span> <span data-ttu-id="632ee-203">Quando si aggiorna un subset di dati, è importante capire se la cartella di lavoro è ancora valida una volta che i dati più recenti vengono aggregati con i dati statici che non derivano dallo stesso periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="632ee-203">When you refresh a subset of your data, it is important that you understand whether the workbook is still valid once newer data is aggregated with static data that is not from the same time period.</span></span> <span data-ttu-id="632ee-204">In qualità di autore della cartella di lavoro, l'utente deve conoscere le dipendenze dei propri dati e assicurarsi che l'aggiornamento dei dati sia adatto per la cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-204">As a workbook author, it is up to you to know your data dependencies and ensure that data refresh is appropriate for the workbook itself.</span></span>  
  
10. <span data-ttu-id="632ee-205">Facoltativamente, è possibile definire singole pianificazioni per le origini dati specifiche.</span><span class="sxs-lookup"><span data-stu-id="632ee-205">Optionally, you can define individual schedules for specific data sources.</span></span> <span data-ttu-id="632ee-206">Questa operazione è utile se si dispone di origini dati iniziali che vengono anch'esse aggiornate in una pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-206">This is useful if you have original data sources that are themselves updated on a schedule.</span></span> <span data-ttu-id="632ee-207">Ad esempio, se in un'origine dati PowerPivot vengono usati dati di un data mart aggiornato ogni lunedì alle 02.00, è possibile definire una pianificazione inline affinché il data mart consenta di recuperare i dati aggiornati ogni lunedì alle 04.00.</span><span class="sxs-lookup"><span data-stu-id="632ee-207">For example, if a PowerPivot data source uses data from a data mart that is refreshed every Monday at 02:00 hours, you can define an inline schedule for the data mart to retrieve its refreshed data every Monday at 04:00 hours.</span></span>  
  
11. <span data-ttu-id="632ee-208">Scegliere **OK** per salvare la pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-208">Click **OK** to save your schedule.</span></span>  
  
##  <a name="verify-data-refresh"></a><a name="drverify"></a><span data-ttu-id="632ee-209">Verifica aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="632ee-209">Verify Data Refresh</span></span>  
 <span data-ttu-id="632ee-210">Il modo migliore per verificare l'aggiornamento dati consiste nell'eseguire subito questa operazione e di esaminare la pagina della cronologia per controllare se l'aggiornamento è stato completato correttamente.</span><span class="sxs-lookup"><span data-stu-id="632ee-210">The best way to verify data refresh is to execute data refresh right away and then review the history page to see whether it completed successfully.</span></span> <span data-ttu-id="632ee-211">Selezionare la casella di controllo **Aggiorna anche appena possibile** per verificare che l'aggiornamento dati è operativo.</span><span class="sxs-lookup"><span data-stu-id="632ee-211">Selecting the **Also refresh as soon as possible** checkbox on your schedule will provide the verification that data refresh is operational.</span></span>  
  
 <span data-ttu-id="632ee-212">È possibile visualizzare il record corrente e passato delle operazioni di aggiornamento dati nella pagina Cronologia aggiornamento dati per la cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-212">You can view the current and past record of data refresh operations in the Data Refresh History page for the workbook.</span></span> <span data-ttu-id="632ee-213">Questa pagina viene visualizzata solo se l'aggiornamento dei dati è stato pianificato per una cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="632ee-213">This page only appears if data refresh has been scheduled for a workbook.</span></span> <span data-ttu-id="632ee-214">Se non esiste nessuna pianificazione dell'aggiornamento dei dati, viene visualizzata la pagina di definizione della pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-214">If there is no data refresh schedule, the schedule definition page appears instead.</span></span>  
  
 <span data-ttu-id="632ee-215">È necessario disporre di autorizzazioni di collaborazione o superiori per visualizzare la cronologia dell'aggiornamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="632ee-215">You must have Contribute permissions or greater to view data refresh history.</span></span>  
  
1.  <span data-ttu-id="632ee-216">In un sito di SharePoint aprire la raccolta in cui è inclusa una cartella di lavoro di PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-216">On a SharePoint site, open the library that contains a PowerPivot workbook.</span></span>  
  
     <span data-ttu-id="632ee-217">Non viene visualizzato alcun indicatore che consenta di identificare le cartelle di lavoro di una raccolta di SharePoint contenenti dati PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="632ee-217">There is no visual indicator that identifies which workbooks in a SharePoint library contain PowerPivot data.</span></span> <span data-ttu-id="632ee-218">È necessario sapere in anticipo in quali cartelle di lavoro sono inclusi dati PowerPivot aggiornabili.</span><span class="sxs-lookup"><span data-stu-id="632ee-218">You must know in advance which workbooks contain refreshable PowerPivot data.</span></span>  
  
2.  <span data-ttu-id="632ee-219">Selezionare il documento, quindi fare clic sulla freccia GIÙ visualizzata a destra.</span><span class="sxs-lookup"><span data-stu-id="632ee-219">Select the document, and then click the down arrow that appears to the right.</span></span>  
  
3.  <span data-ttu-id="632ee-220">Selezionare **Gestisci aggiornamento dati PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="632ee-220">Select **Manage PowerPivot Data Refresh**.</span></span>  
  
 <span data-ttu-id="632ee-221">Viene visualizzata la pagina della cronologia in cui viene mostrato un record completo per ogni attività di aggiornamento per i dati PowerPivot nella cartella di lavoro di Excel corrente, incluso lo stato dell'operazione di aggiornamento dei dati più recente.</span><span class="sxs-lookup"><span data-stu-id="632ee-221">The history page appears, showing a complete record for all refresh activity for PowerPivot data in the current Excel workbook, including the status of the most recent data refresh operation.</span></span>  
  
 <span data-ttu-id="632ee-222">In alcuni casi, è possibile visualizzare tempi di elaborazione effettivi diversi da quelli specificati.</span><span class="sxs-lookup"><span data-stu-id="632ee-222">In some cases, you might see actual processing times that differ from the time you specified.</span></span> <span data-ttu-id="632ee-223">Questa situazione si verifica se il carico di elaborazione nel server è pesante.</span><span class="sxs-lookup"><span data-stu-id="632ee-223">This will occur if there is a heavy processing load on the server.</span></span> <span data-ttu-id="632ee-224">In tal caso, prima di avviare un aggiornamento dei dati, l'istanza del servizio [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] rimarrà in ascolto finché non sono disponibili risorse di sistema sufficienti.</span><span class="sxs-lookup"><span data-stu-id="632ee-224">Under heavy load, the [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] service instance will wait until enough system resources are free before it begins a data refresh.</span></span>  
  
 <span data-ttu-id="632ee-225">La cartella di lavoro deve essere archiviata al termine dell'operazione di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="632ee-225">The workbook must be checked in when the refresh operation is finished.</span></span> <span data-ttu-id="632ee-226">durante la quale sarà anche salvata con i dati aggiornati.</span><span class="sxs-lookup"><span data-stu-id="632ee-226">The workbook will be saved with the refreshed data at that time.</span></span> <span data-ttu-id="632ee-227">Se il file viene estratto, l'aggiornamento dei dati viene ignorato fino alla successiva pianificazione.</span><span class="sxs-lookup"><span data-stu-id="632ee-227">If the file is checked out, data refresh is skipped until the next scheduled time.</span></span>  
  
 <span data-ttu-id="632ee-228">Se viene visualizzato un messaggio di stato imprevisto (ad esempio l'esito negativo o l'annullamento di un'operazione di aggiornamento), è possibile esaminare il problema controllando le autorizzazioni e la disponibilità dei server.</span><span class="sxs-lookup"><span data-stu-id="632ee-228">If you see a status message that is unexpected (for example, a refresh operation failed or was cancelled), you can investigate the problem by checking permissions and server availability.</span></span>  
  
 <span data-ttu-id="632ee-229">Controllare la pagina sulla risoluzione dei problemi relativi all'aggiornamento dati PowerPivot in TechNet WIKI per un supporto sulla risoluzione di problemi di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="632ee-229">Review the PowerPivot data refresh troubleshooting page on the TechNet WIKI for help on resolving data refresh problems.</span></span> <span data-ttu-id="632ee-230">Per altre informazioni, vedere l'articolo sulla [risoluzione dei problemi relativi all'aggiornamento dati PowerPivot](https://go.microsoft.com/fwlink/?LinkId=251594).</span><span class="sxs-lookup"><span data-stu-id="632ee-230">For more information see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkId=251594).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="632ee-231">Gli amministratori di SharePoint possono assistere nella risoluzione dei problemi relativi all'aggiornamento dei dati visualizzando i report consolidati sull'aggiornamento dei dati nel Dashboard di gestione PowerPivot in Amministrazione centrale.</span><span class="sxs-lookup"><span data-stu-id="632ee-231">SharePoint administrators can help you troubleshoot data refresh problems by viewing the consolidated data refresh reports in the PowerPivot Management Dashboard in Central Administration.</span></span> <span data-ttu-id="632ee-232">Per ulteriori informazioni, vedere [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="632ee-232">For more information, see [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="632ee-233">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="632ee-233">See Also</span></span>  
 <span data-ttu-id="632ee-234">[Aggiornamento dati PowerPivot con SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="632ee-234">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="632ee-235">[Visualizzare la cronologia dell'aggiornamento dati &#40;PowerPivot per SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="632ee-235">[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="632ee-236">Configurare le credenziali archiviate per l'aggiornamento dati PowerPivot &#40;PowerPivot per SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="632ee-236">Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;</span></span>](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
