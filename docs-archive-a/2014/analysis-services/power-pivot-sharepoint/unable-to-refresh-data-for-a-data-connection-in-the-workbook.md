---
title: "Impossibile aggiornare i dati per una connessione dati della cartella di lavoro. Riprovare o contattare l'amministratore di sistema. Impossibile aggiornare le connessioni seguenti: dati PowerPivot | Microsoft Docs"
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87721852"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="9eba0-104">Impossibile aggiornare i dati per una connessione dati della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9eba0-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="9eba0-105">Riprovare o contattare l'amministratore di sistema.</span><span class="sxs-lookup"><span data-stu-id="9eba0-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="9eba0-106">Impossibile aggiornare le connessioni seguenti: Dati di PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9eba0-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="9eba0-107">Per cartelle di lavoro di Excel contenenti dati PowerPivot, in Excel Services viene restituito questo errore se viene inviata una richiesta di connessione a un server PowerPivot che non verrà completata.</span><span class="sxs-lookup"><span data-stu-id="9eba0-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="9eba0-108">Dettagli</span><span class="sxs-lookup"><span data-stu-id="9eba0-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eba0-109">Si applica a:</span><span class="sxs-lookup"><span data-stu-id="9eba0-109">Applies to:</span></span>|<span data-ttu-id="9eba0-110">Installazione di PowerPivot per SharePoint</span><span class="sxs-lookup"><span data-stu-id="9eba0-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="9eba0-111">Versione prodotto</span><span class="sxs-lookup"><span data-stu-id="9eba0-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="9eba0-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="9eba0-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="9eba0-113">Causa</span><span class="sxs-lookup"><span data-stu-id="9eba0-113">Cause</span></span>|<span data-ttu-id="9eba0-114">Vedere qui di seguito.</span><span class="sxs-lookup"><span data-stu-id="9eba0-114">See below.</span></span>|  
|<span data-ttu-id="9eba0-115">Testo del messaggio</span><span class="sxs-lookup"><span data-stu-id="9eba0-115">Message Text</span></span>|<span data-ttu-id="9eba0-116">Impossibile aggiornare i dati per una connessione dati della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9eba0-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="9eba0-117">Riprovare o contattare l'amministratore di sistema.</span><span class="sxs-lookup"><span data-stu-id="9eba0-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="9eba0-118">Impossibile aggiornare le connessioni seguenti: Dati di PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9eba0-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="9eba0-119">Spiegazione e risoluzione</span><span class="sxs-lookup"><span data-stu-id="9eba0-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="9eba0-120">Impossibile connettersi o caricare i dati PowerPivot in Excel Services.</span><span class="sxs-lookup"><span data-stu-id="9eba0-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="9eba0-121">Di seguito sono riportate le condizioni che causano l'errore:</span><span class="sxs-lookup"><span data-stu-id="9eba0-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="9eba0-122">**Scenario 1: il servizio non è stato avviato**</span><span class="sxs-lookup"><span data-stu-id="9eba0-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="9eba0-123">L'istanza di SQL Server Analysis Services (PowerPivot) non è stata avviata.</span><span class="sxs-lookup"><span data-stu-id="9eba0-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="9eba0-124">Una password scaduta determinerà l'arresto del servizio in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="9eba0-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="9eba0-125">Per ulteriori informazioni sulla modifica della password, vedere [configurare gli account del servizio PowerPivot](configure-power-pivot-service-accounts.md) e [avviare o arrestare un server PowerPivot per SharePoint](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span><span class="sxs-lookup"><span data-stu-id="9eba0-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="9eba0-126">**Scenario 2a: apertura di una versione precedente della cartella di lavoro nel server**</span><span class="sxs-lookup"><span data-stu-id="9eba0-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="9eba0-127">La cartella di lavoro che si sta tentando di aprire potrebbe essere stata creata con la versione SQL Server 2008 R2 di PowerPivot per Excel.</span><span class="sxs-lookup"><span data-stu-id="9eba0-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="9eba0-128">Molto probabilmente, il provider di dati di Analysis Services specificato nella stringa di connessione dati non è presente sul computer che sta gestendo la richiesta.</span><span class="sxs-lookup"><span data-stu-id="9eba0-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="9eba0-129">In tal caso, il messaggio verrà trovato nel log ULS: "aggiornamento non riuscito per ' dati PowerPivot ' nella cartella di lavoro ' \<URL to workbook> '", seguito da "Impossibile ottenere una connessione".</span><span class="sxs-lookup"><span data-stu-id="9eba0-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="9eba0-130">Per determinare la versione della cartella di lavoro, aprirla in Excel e controllare il provider di dati specificato nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="9eba0-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="9eba0-131">In una cartella di lavoro SQL Server 2008 R2 viene utilizzato MSOLAP.4 come provider di dati.</span><span class="sxs-lookup"><span data-stu-id="9eba0-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="9eba0-132">Una soluzione alternativa al problema è l'aggiornamento della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9eba0-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="9eba0-133">In alternativa, è possibile installare librerie client della versione SQL Server 2008 R2 di Analysis Services nei computer fisici che eseguono PowerPivot per SharePoint o Excel Services:</span><span class="sxs-lookup"><span data-stu-id="9eba0-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="9eba0-134">Installazione del provider OLE DB Analysis Services nei server di SharePoint</span><span class="sxs-lookup"><span data-stu-id="9eba0-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="9eba0-135">**Scenario 2b: Excel Services è in esecuzione su un server applicazioni che dispone della versione errata delle librerie client**</span><span class="sxs-lookup"><span data-stu-id="9eba0-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="9eba0-136">Per impostazione predefinita, SharePoint Server 2010 installa la versione SQL Server 2008 del provider OLE DB per Analysis Services nei server applicazioni su cui è in esecuzione Excel Services.</span><span class="sxs-lookup"><span data-stu-id="9eba0-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="9eba0-137">In una farm che supporta l'accesso ai dati PowerPivot, tutti i server fisici che eseguono applicazioni che richiedono dati PowerPivot, ad esempio Excel Services e PowerPivot per SharePoint, devono utilizzare una versione successiva del provider di dati.</span><span class="sxs-lookup"><span data-stu-id="9eba0-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="9eba0-138">Server che eseguono PowerPivot per SharePoint ottengono automaticamente il provider di dati OLE DB aggiornato.</span><span class="sxs-lookup"><span data-stu-id="9eba0-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="9eba0-139">Ad altri server, quali quelli che eseguono un'istanza autonoma di Excel Services senza PowerPivot per SharePoint sullo stesso computer, è necessario applicare una patch perché utilizzino le librerie client più recenti.</span><span class="sxs-lookup"><span data-stu-id="9eba0-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="9eba0-140">Per altre informazioni, vedere [Installazione del provider OLE DB di Analysis Services nei server di SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="9eba0-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="9eba0-141">**Scenario 3: il controller di dominio non è disponibile**</span><span class="sxs-lookup"><span data-stu-id="9eba0-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="9eba0-142">Il problema può essere dovuto al fatto che non è disponibile alcun controller di dominio per la convalida dell'identità utente.</span><span class="sxs-lookup"><span data-stu-id="9eba0-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="9eba0-143">Il controller di dominio viene richiesto da Claims nel Servizio token Windows per autenticare l'utente di SharePoint in ogni connessione.</span><span class="sxs-lookup"><span data-stu-id="9eba0-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="9eba0-144">Claims nel Servizio token Windows non utilizza le credenziali memorizzate nella cache.</span><span class="sxs-lookup"><span data-stu-id="9eba0-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="9eba0-145">Convalida l'identità utente per ogni connessione.</span><span class="sxs-lookup"><span data-stu-id="9eba0-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="9eba0-146">È possibile confermare la causa di questo errore visualizzando il file registro di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9eba0-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="9eba0-147">Se nei registri di SharePoint è incluso il messaggio "Impossibile recuperare WindowsIdentity da IClaimsIdentity", l'identità utente non può essere autenticata.</span><span class="sxs-lookup"><span data-stu-id="9eba0-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="9eba0-148">Per risolvere questo problema, unire in join il computer allo stesso dominio del server PowerPivot o installare un controller di dominio nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="9eba0-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="9eba0-149">La seconda soluzione, cioè l'installazione del controller di dominio, richiederà la creazione di account di dominio locali per tutti i servizi e gli utenti.</span><span class="sxs-lookup"><span data-stu-id="9eba0-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="9eba0-150">Sarà necessario configurare gli account di servizio e le autorizzazioni di SharePoint per gli account definiti.</span><span class="sxs-lookup"><span data-stu-id="9eba0-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="9eba0-151">L'installazione di un controller di dominio nel computer è utile se si intende utilizzare PowerPivot per SharePoint in uno stato offline.</span><span class="sxs-lookup"><span data-stu-id="9eba0-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="9eba0-152">Per istruzioni dettagliate su come utilizzare PowerPivot offline, vedere il post di Blog relativo alla disconnessione del server PowerPivot in rete [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) .</span><span class="sxs-lookup"><span data-stu-id="9eba0-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="9eba0-153">**Scenario 4: server instabile**</span><span class="sxs-lookup"><span data-stu-id="9eba0-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="9eba0-154">Uno o più servizi possono trovarsi in uno stato incoerente.</span><span class="sxs-lookup"><span data-stu-id="9eba0-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="9eba0-155">In alcuni casi, l'esecuzione di IISRESET consentirà di risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="9eba0-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
