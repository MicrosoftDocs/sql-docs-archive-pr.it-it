---
title: Aggiornamento dati PowerPivot con SharePoint 2013 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87629037"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="9cd13-102">Aggiornamento dati PowerPivot con SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="9cd13-103">La progettazione per l'aggiornamento dei [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] modelli di dati in SharePoint 2013 utilizza Excel Services come componente principale per caricare e aggiornare i modelli di dati in un'istanza di in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] esecuzione in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="9cd13-104">Il server [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] viene eseguito esternamente alla farm di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="9cd13-105">L'architettura di aggiornamento dati utilizzata in precedenza era basata esclusivamente sul servizio di sistema PowerPivot per il caricamento e l'aggiornamento dei modelli di dati in un'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="9cd13-106">L'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] veniva eseguita localmente nel server applicazioni PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="9cd13-107">Con la nuova architettura, inoltre, è stato introdotto un nuovo metodo per gestire le informazioni di pianificazione, ad esempio i metadati dell'elemento della cartella di lavoro nella raccolta documenti.</span><span class="sxs-lookup"><span data-stu-id="9cd13-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="9cd13-108">L'architettura in SharePoint 2013 Excel Services supporta sia l' **aggiornamento dati interattivo** che l' **aggiornamento dati pianificato**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="9cd13-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="9cd13-110">**Contenuto dell'argomento:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="9cd13-111">Aggiornamento dati interattivo</span><span class="sxs-lookup"><span data-stu-id="9cd13-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="9cd13-112">Autenticazione di Windows con connessioni dati della cartella di lavoro e aggiornamento dati interattivo</span><span class="sxs-lookup"><span data-stu-id="9cd13-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="9cd13-113">Aggiornamento dati pianificato</span><span class="sxs-lookup"><span data-stu-id="9cd13-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="9cd13-114">Architettura dell'aggiornamento dati pianificato in SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="9cd13-115">Considerazioni aggiuntive sull'autenticazione</span><span class="sxs-lookup"><span data-stu-id="9cd13-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="9cd13-116">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="9cd13-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="9cd13-117">Background</span><span class="sxs-lookup"><span data-stu-id="9cd13-117">Background</span></span>  
 <span data-ttu-id="9cd13-118">SharePoint Server 2013 Excel Services gestisce l'aggiornamento dei dati per le cartelle di lavoro di Excel 2013 e attiva l'elaborazione del modello di dati in un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in esecuzione in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="9cd13-119">In caso di cartelle di lavoro di Excel 2010, tramite Excel Services è inoltre possibile gestire il caricamento e il salvataggio delle cartelle di lavoro e dei modelli di dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="9cd13-120">Tuttavia, Excel Services si basa sul servizio di sistema PowerPivot per inviare i comandi di elaborazione al modello di dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="9cd13-121">Nella tabella seguente sono riepilogati i componenti mediante i quali vengono inviati i comandi di elaborazione per l'aggiornamento dati in base alla versione della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="9cd13-122">L'ambiente considerato è una farm di SharePoint 2013 configurata per usare un server [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Services in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="9cd13-123">Cartelle di lavoro di Excel 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="9cd13-124">Cartelle di lavoro di Excel 2010</span><span class="sxs-lookup"><span data-stu-id="9cd13-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="9cd13-125">Attivazione dell'aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="9cd13-125">Trigger Data Refresh</span></span>|<span data-ttu-id="9cd13-126">**Interattiva:** utente autenticato</span><span class="sxs-lookup"><span data-stu-id="9cd13-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="9cd13-127">**Pianificata:** servizio di sistema PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9cd13-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="9cd13-128">servizio di sistema PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9cd13-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="9cd13-129">Caricamento della cartella di lavoro da database di contenuto</span><span class="sxs-lookup"><span data-stu-id="9cd13-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="9cd13-130">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="9cd13-131">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="9cd13-132">Caricamento del modello di dati in un'istanza di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="9cd13-133">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="9cd13-134">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="9cd13-135">Invio dei comandi di elaborazione all'istanza di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="9cd13-136">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="9cd13-137">servizio di sistema PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9cd13-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="9cd13-138">Aggiornamento dei dati della cartella di lavoro</span><span class="sxs-lookup"><span data-stu-id="9cd13-138">Update Workbook Data</span></span>|<span data-ttu-id="9cd13-139">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="9cd13-140">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="9cd13-141">Salvataggio della cartella di lavoro e del modello di dati nel database di contenuto</span><span class="sxs-lookup"><span data-stu-id="9cd13-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="9cd13-142">**Interattivo:** N/D</span><span class="sxs-lookup"><span data-stu-id="9cd13-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="9cd13-143">**Pianificato:** SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="9cd13-144">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="9cd13-145">Nella tabella seguente sono riepilogate le funzionalità di aggiornamento supportate in una farm di SharePoint 2013 configurata per usare un server [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Services in modalità SharePoint:</span><span class="sxs-lookup"><span data-stu-id="9cd13-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="9cd13-146">Cartella di lavoro creata in</span><span class="sxs-lookup"><span data-stu-id="9cd13-146">Workbook created in</span></span>|<span data-ttu-id="9cd13-147">Aggiornamento dati pianificato</span><span class="sxs-lookup"><span data-stu-id="9cd13-147">Scheduled data refresh</span></span>|<span data-ttu-id="9cd13-148">Aggiornamento interattivo</span><span class="sxs-lookup"><span data-stu-id="9cd13-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="9cd13-149">SQL Server 2008 R2 PowerPivot per Excel</span><span class="sxs-lookup"><span data-stu-id="9cd13-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="9cd13-150">Non supportata.</span><span class="sxs-lookup"><span data-stu-id="9cd13-150">Not supported.</span></span> <span data-ttu-id="9cd13-151">Aggiornare la cartella di lavoro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="9cd13-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="9cd13-152">Non supportata.</span><span class="sxs-lookup"><span data-stu-id="9cd13-152">Not supported.</span></span> <span data-ttu-id="9cd13-153">Aggiornare la cartella di lavoro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="9cd13-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="9cd13-154">2012 PowerPivot per Excel</span><span class="sxs-lookup"><span data-stu-id="9cd13-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="9cd13-155">Supportato</span><span class="sxs-lookup"><span data-stu-id="9cd13-155">Supported</span></span>|<span data-ttu-id="9cd13-156">Non supportata.</span><span class="sxs-lookup"><span data-stu-id="9cd13-156">Not supported.</span></span> <span data-ttu-id="9cd13-157">Aggiornare la cartella di lavoro **( \* )**</span><span class="sxs-lookup"><span data-stu-id="9cd13-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="9cd13-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-158">Excel 2013</span></span>|<span data-ttu-id="9cd13-159">Supportato</span><span class="sxs-lookup"><span data-stu-id="9cd13-159">Supported</span></span>|<span data-ttu-id="9cd13-160">Supportato</span><span class="sxs-lookup"><span data-stu-id="9cd13-160">Supported</span></span>|  
  
 <span data-ttu-id="9cd13-161">**( \* )** Per altre informazioni sugli aggiornamenti delle cartelle di lavoro, vedere [aggiornare le cartelle di lavoro e l'aggiornamento dati pianificato &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="9cd13-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="9cd13-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="9cd13-163">L'aggiornamento dati interattivo o manuale in SharePoint Server Excel Services 2013 consente di aggiornare i modelli di dati con dati dell'origine dati originale.</span><span class="sxs-lookup"><span data-stu-id="9cd13-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="9cd13-164">L'aggiornamento dati interattivo è disponibile dopo la configurazione di un'applicazione Excel Services registrando un server [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in esecuzione in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="9cd13-165">Per altre informazioni, vedere [Gestire le impostazioni del modello di dati di Excel Services (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span><span class="sxs-lookup"><span data-stu-id="9cd13-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9cd13-166">L'aggiornamento dati interattivo è disponibile solo per cartelle di lavoro create in Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="9cd13-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="9cd13-167">Se si tenta di aggiornare una cartella di lavoro di Excel 2010, in Excel Services viene visualizzato un messaggio di errore simile a "operazione PowerPivot non riuscita: la cartella di lavoro è stata creata in una versione precedente di Excel e PowerPivot non può essere aggiornato finché il file non viene aggiornato".</span><span class="sxs-lookup"><span data-stu-id="9cd13-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="9cd13-168">Per altre informazioni sull'aggiornamento delle cartelle di lavoro, vedere [Aggiornare le cartelle di lavoro e l'aggiornamento dati pianificato &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="9cd13-169">**Punto chiave di interesse dell'aggiornamento interattivo:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="9cd13-170">L'aggiornamento dati interattivo viene eseguito solo per i dati nella sessione utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9cd13-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="9cd13-171">I dati non vengono salvati di nuovo automaticamente nell'elemento della cartella di lavoro nel database del contenuto di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="9cd13-172">**Credenziali** : per l'aggiornamento dati interattivo è possibile usare l'identità dell'utente attualmente connesso come credenziali o credenziali archiviate per connettersi all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="9cd13-173">Le credenziali utilizzate dipendono dalle impostazioni di autenticazione di Excel Services definite per la connessione della cartella di lavoro all'origine dati esterna.</span><span class="sxs-lookup"><span data-stu-id="9cd13-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="9cd13-174">**Cartelle di lavoro supportate:**  cartelle di lavoro create in Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="9cd13-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="9cd13-175">**Per aggiornare i dati:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="9cd13-176">Vedere i passaggi nell'illustrazione riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="9cd13-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="9cd13-177">In una raccolta documenti di SharePoint aprire la cartella di lavoro di PowerPivot nel browser.</span><span class="sxs-lookup"><span data-stu-id="9cd13-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="9cd13-178">Nella finestra del browser fare clic sul menu **Dati** , quindi scegliere **Aggiorna connessione selezionata** o **Aggiorna tutte le connessioni**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="9cd13-179">Tramite Excel Services il database PowerPivot viene caricato, elaborato e successivamente sottoposto a query per aggiornare la cache della cartella di lavoro di Excel.</span><span class="sxs-lookup"><span data-stu-id="9cd13-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="9cd13-180">**Nota:** la cartella di lavoro aggiornata non viene salvata di nuovo automaticamente nella raccolta documenti.</span><span class="sxs-lookup"><span data-stu-id="9cd13-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="9cd13-181">![aggiornamento dati interattivo](../media/as-interactive-datarefresh-sharepoint2013.gif "aggiornamento dati interattivo")</span><span class="sxs-lookup"><span data-stu-id="9cd13-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="9cd13-182">Autenticazione di Windows con connessioni dati della cartella di lavoro e aggiornamento dati interattivo</span><span class="sxs-lookup"><span data-stu-id="9cd13-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="9cd13-183">Tramite Excel Services viene inviato al server Analysis Services un comando di elaborazione per fare in modo che il server rappresenti un account utente.</span><span class="sxs-lookup"><span data-stu-id="9cd13-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="9cd13-184">Per ottenere diritti di sistema sufficienti per eseguire il processo di delega di rappresentazione utente, è necessario il privilegio **Agire come parte del sistema operativo** nel server locale per l'account del servizio Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="9cd13-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="9cd13-185">Tramite il server Analysis Services deve inoltre essere possibile delegare le credenziali dell'utente alle origini dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="9cd13-186">Il risultato della query viene inviato a Excel Services.</span><span class="sxs-lookup"><span data-stu-id="9cd13-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="9cd13-187">Esperienza utente tipica: quando un cliente seleziona "Aggiorna tutte le connessioni" in una cartella di lavoro di Excel 2013 che contiene un modello PowerPivot, viene visualizzato un messaggio di errore simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="9cd13-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="9cd13-188">**Aggiornamento dei dati esterni non riuscito:** si è verificato un errore durante l'uso del modello di dati nella cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="9cd13-189">Riprova.</span><span class="sxs-lookup"><span data-stu-id="9cd13-189">Please try again.</span></span> <span data-ttu-id="9cd13-190">Non è possibile aggiornare i dati per una o più connessioni dati nella cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="9cd13-191">A seconda del provider di dati utilizzato, è possibile che vengano visualizzati messaggi simili ai seguenti nel log ULS.</span><span class="sxs-lookup"><span data-stu-id="9cd13-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="9cd13-192">**Con SQL Native Client:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="9cd13-193">Non è possibile creare una connessione esterna o eseguire una query.</span><span class="sxs-lookup"><span data-stu-id="9cd13-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="9cd13-194">Messaggio provider - L'oggetto out-of-line "DataSource", che fa riferimento all'ID "20102481-39c8-4d21-bf63-68f583ad22bb", è stato specificato ma non è stato utilizzato. Errore OLE DB o ODBC:</span><span class="sxs-lookup"><span data-stu-id="9cd13-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="9cd13-195">Errore OLE DB oppure ODBC - Si è verificato un errore specifico dell'istanza o relativo alla rete durante il tentativo di stabilire una connessione a SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9cd13-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="9cd13-196">Server non trovato o non accessibile.</span><span class="sxs-lookup"><span data-stu-id="9cd13-196">Server is not found or not accessible.</span></span> <span data-ttu-id="9cd13-197">Verificare che il nome dell'istanza sia corretto e che il server sia configurato in modo da consentire connessioni remote.</span><span class="sxs-lookup"><span data-stu-id="9cd13-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="9cd13-198">Per ulteriori informazioni, vedere la documentazione online di SQL Server; 08001; Provider SSL - Il pacchetto di sicurezza richiesto non esiste; 08001; Il client non è in grado di effettuare la connessione; 08001; Crittografia non supportata dal client; 08001.</span><span class="sxs-lookup"><span data-stu-id="9cd13-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="9cd13-199">, ConnectionName: ThisWorkbookDataModel, cartella di lavoro: book1.xlsx.</span><span class="sxs-lookup"><span data-stu-id="9cd13-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="9cd13-200">**Con il provider Microsoft OLE DB per SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="9cd13-201">Non è possibile creare una connessione esterna o eseguire una query.</span><span class="sxs-lookup"><span data-stu-id="9cd13-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="9cd13-202">Messaggio provider: l'oggetto out-of-line "DataSource", che fa riferimento all'ID "6e711bfa-b62f-4879-a177-c5dd61d9c242", è stato specificato ma non è stato utilizzato.</span><span class="sxs-lookup"><span data-stu-id="9cd13-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="9cd13-203">Errore OLE DB o ODBC,</span><span class="sxs-lookup"><span data-stu-id="9cd13-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="9cd13-204">, ConnectionName: ThisWorkbookDataModel, cartella di lavoro: OLEDB Provider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="9cd13-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="9cd13-205">**Con il provider di dati .NET Framework per SQL Server:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="9cd13-206">Non è possibile creare una connessione esterna o eseguire una query.</span><span class="sxs-lookup"><span data-stu-id="9cd13-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="9cd13-207">Messaggio provider - L'oggetto out-of-line "DataSource", che fa riferimento all'ID "f5fb916c-3eac-4d07-a542-531524c0d44a", è stato specificato ma non è stato utilizzato.</span><span class="sxs-lookup"><span data-stu-id="9cd13-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="9cd13-208">Errori nel motore relazionale di alto livello.</span><span class="sxs-lookup"><span data-stu-id="9cd13-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="9cd13-209">Durante l'utilizzo dell'interfaccia gestita IDbConnection si è verificata l'eccezione seguente: impossibile caricare il file o l'assembly "System.Transactions, Version=4.0.0.0, Culture=neutral PublicKeyToken=b77a5c561934e089" o una delle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="9cd13-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="9cd13-210">Non è stato fornito il livello richiesto di rappresentazione di client oppure il livello di rappresentazione fornito non è valido.</span><span class="sxs-lookup"><span data-stu-id="9cd13-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="9cd13-211">Eccezione da HRESULT: 0x80070542.</span><span class="sxs-lookup"><span data-stu-id="9cd13-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="9cd13-212">, ConnectionName: ThisWorkbookDataModel, cartella di lavoro: NETProvider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="9cd13-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="9cd13-213">**Riepilogo dei passaggi di configurazione** Per configurare il privilegio **Agire come parte del sistema operativo** nel server locale:</span><span class="sxs-lookup"><span data-stu-id="9cd13-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="9cd13-214">In Analysis Services server in esecuzione in modalità SharePoint aggiungere l'account del servizio Analysis Services al privilegio "**Agisci come parte del sistema operativo**":</span><span class="sxs-lookup"><span data-stu-id="9cd13-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="9cd13-215">Eseguire " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="9cd13-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="9cd13-216">Fare clic su **Criteri di sicurezza locali**, selezionare **Criteri locali**, quindi scegliere **Assegnazione diritti utente**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="9cd13-217">Aggiungere l'account del servizio.</span><span class="sxs-lookup"><span data-stu-id="9cd13-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="9cd13-218">Riavviare Excel Services e il server Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="9cd13-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="9cd13-219">La delega dall'account del servizio Excel Services o da Attestazioni del servizio token Windows (C2WTS) all'istanza di Analysis Services non è richiesta.</span><span class="sxs-lookup"><span data-stu-id="9cd13-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="9cd13-220">Pertanto, non è necessaria alcuna configurazione per KCD da Excel Services o C2WTS al servizio Analysis Services per PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="9cd13-221">Se l'origine dati back-end si trova nello stesso server di un'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , la delega vincolata Kerberos non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="9cd13-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="9cd13-222">Tuttavia, l'account del servizio [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] deve disporre del privilegio Agisci come parte del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="9cd13-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="9cd13-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="9cd13-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="9cd13-224">Per altre informazioni, vedere [agire come parte del sistema operativo](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="9cd13-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="9cd13-225">Aggiornamento dati pianificato</span><span class="sxs-lookup"><span data-stu-id="9cd13-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="9cd13-226">**Punti chiave di interesse dell'aggiornamento dati pianificato:**</span><span class="sxs-lookup"><span data-stu-id="9cd13-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="9cd13-227">È richiesta la distribuzione del componente aggiuntivo PowerPivot per SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="9cd13-228">Per ulteriori informazioni, vedere [installare o disinstallare il componente aggiuntivo PowerPivot per SharePoint &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="9cd13-229">Un utente configura una pianificazione dell'aggiornamento per una cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="9cd13-230">All'ora pianificata, tramite il servizio di sistema PowerPivot viene inviata una richiesta a Excel Services per:</span><span class="sxs-lookup"><span data-stu-id="9cd13-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="9cd13-231">Caricare ed elaborare il database PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="9cd13-232">Aggiornare la cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="9cd13-233">Salvare di nuovo la cartella di lavoro nel database di contenuto.</span><span class="sxs-lookup"><span data-stu-id="9cd13-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="9cd13-234">**Credenziali:** vengono utilizzate le credenziali archiviate.</span><span class="sxs-lookup"><span data-stu-id="9cd13-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="9cd13-235">Non usare l'identità dell'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="9cd13-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="9cd13-236">**Cartelle di lavoro supportate:** cartelle di lavoro create tramite il componente aggiuntivo [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot per Excel 2010 o tramite Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="9cd13-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="9cd13-237">Le cartelle di lavoro create in Excel 2010 con il componente aggiuntivo [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="9cd13-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="9cd13-238">Aggiornare la cartella di lavoro almeno al formato [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="9cd13-239">Per altre informazioni sugli aggiornamenti delle cartelle di lavoro, vedere [Aggiornare le cartelle di lavoro e l'aggiornamento dati pianificato &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="9cd13-240">Per visualizzare la pagina **Gestisci aggiornamento dati** :</span><span class="sxs-lookup"><span data-stu-id="9cd13-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="9cd13-241">Vedere i passaggi nell'illustrazione riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="9cd13-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="9cd13-242">In una raccolta documenti di SharePoint fare clic su **Menu Apri** (**...**) per una cartella di lavoro di PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="9cd13-243">Fare clic sul secondo **Menu Apri** , quindi scegliere **Gestisci aggiornamento dati PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="9cd13-244">Nella pagina **Gestisci aggiornamento dati** fare clic su **Abilita** , quindi configurare la pianificazione dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9cd13-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="9cd13-245">All'ora specificata, tramite il servizio di sistema PowerPivot viene inviata una richiesta a Excel Services per:</span><span class="sxs-lookup"><span data-stu-id="9cd13-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="9cd13-246">Caricare ed elaborare il modello di dati PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="9cd13-247">Aggiornare la cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="9cd13-248">Salvare di nuovo la cartella di lavoro nel database di contenuto.</span><span class="sxs-lookup"><span data-stu-id="9cd13-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="9cd13-249">![menu di scelta rapida Gestisci aggiornamento dati](../media/as-manage-datarefresh-sharepoint2013.gif "menu di scelta rapida Gestisci aggiornamento dati")</span><span class="sxs-lookup"><span data-stu-id="9cd13-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="9cd13-250">Per informazioni sull'aggiornamento delle cartelle di lavoro da SharePoint Online, vedere [aggiornamento delle cartelle di lavoro di Excel con modelli PowerPivot incorporati da SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) ( https://technet.microsoft.com/library/jj992650.aspx) .</span><span class="sxs-lookup"><span data-stu-id="9cd13-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="9cd13-251">Architettura dell'aggiornamento dati pianificato in SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="9cd13-252">Nell'illustrazione seguente è riepilogata l'architettura dell'aggiornamento dati in SharePoint 2013 e SQL Server 2012 SP1.</span><span class="sxs-lookup"><span data-stu-id="9cd13-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="9cd13-253">![architettura dell'aggiornamento dati di SQL Server 2012 SP1](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architettura dell'aggiornamento dati di SQL Server 2012 SP1")</span><span class="sxs-lookup"><span data-stu-id="9cd13-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="9cd13-254">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9cd13-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="9cd13-255">**1**</span><span class="sxs-lookup"><span data-stu-id="9cd13-255">**(1)**</span></span>|<span data-ttu-id="9cd13-256">Motore Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9cd13-256">Analysis Services Engine</span></span>|<span data-ttu-id="9cd13-257">Server [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in esecuzione in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="9cd13-258">Il server viene eseguito esternamente alla farm di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="9cd13-259">**2**</span><span class="sxs-lookup"><span data-stu-id="9cd13-259">**(2)**</span></span>|<span data-ttu-id="9cd13-260">Interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="9cd13-260">User Interface</span></span>|<span data-ttu-id="9cd13-261">L'interfaccia utente è costituita da due pagine:</span><span class="sxs-lookup"><span data-stu-id="9cd13-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="9cd13-262">una per definire la pianificazione, l'altra per visualizzare la cronologia aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9cd13-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="9cd13-263">L'accesso ai database dell'applicazione del servizio PowerPivot non viene effettuato direttamente dalle pagine ma tramite il servizio di sistema PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="9cd13-264">**3**</span><span class="sxs-lookup"><span data-stu-id="9cd13-264">**(3)**</span></span>|<span data-ttu-id="9cd13-265">servizio di sistema PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9cd13-265">PowerPivot System Service</span></span>|<span data-ttu-id="9cd13-266">Il servizio viene installato durante la distribuzione del componente aggiuntivo PowerPivot per SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="9cd13-267">Viene utilizzato per le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="9cd13-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="9cd13-268">Hosting del motore di pianificazione dell'aggiornamento mediante il quale vengono chiamate le API Excel Services per l'aggiornamento dati delle cartelle di lavoro di Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="9cd13-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="9cd13-269">In caso di cartelle di lavoro di Excel 2010, l'elaborazione del modello di dati viene effettuata direttamente dal servizio mediante il quale si continua però a rispondere in Excel Services per il caricamento del modello di dati e l'aggiornamento della cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9cd13-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="9cd13-270">Fornitura di metodi per componenti come le pagine dell'interfaccia utente per la comunicazione con il servizio di sistema.</span><span class="sxs-lookup"><span data-stu-id="9cd13-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="9cd13-271">Gestione delle richieste per l'accesso esterno a cartelle di lavoro come origine dati, ricevute tramite il servizio Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="9cd13-272">Gestione delle richieste di aggiornamento dati pianificato per i processi timer e le pagine di configurazione.</span><span class="sxs-lookup"><span data-stu-id="9cd13-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="9cd13-273">Tramite il servizio vengono gestite le richieste per leggere i dati in ingresso e in uscita dal database dell'applicazione di servizio e per attivare l'aggiornamento dati con Excel Services.</span><span class="sxs-lookup"><span data-stu-id="9cd13-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="9cd13-274">Utilizzo dell'elaborazione e processo timer correlato.</span><span class="sxs-lookup"><span data-stu-id="9cd13-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="9cd13-275">**4**</span><span class="sxs-lookup"><span data-stu-id="9cd13-275">**(4)**</span></span>|<span data-ttu-id="9cd13-276">Servizi di calcolo Excel</span><span class="sxs-lookup"><span data-stu-id="9cd13-276">Excel Calculation Services</span></span>|<span data-ttu-id="9cd13-277">Utilizzati per il caricamento dei modelli di dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="9cd13-278">**5**</span><span class="sxs-lookup"><span data-stu-id="9cd13-278">**(5)**</span></span>|<span data-ttu-id="9cd13-279">Servizio di archiviazione sicura</span><span class="sxs-lookup"><span data-stu-id="9cd13-279">Secure Store Service</span></span>|<span data-ttu-id="9cd13-280">Se le impostazioni di autenticazione nella cartella di lavoro sono configurate per **l'utilizzo dell'account utente autenticato** o **Nessuna**, per l'aggiornamento dati vengono utilizzate le credenziali archiviate nell'ID dell'applicazione di destinazione di archiviazione sicura.</span><span class="sxs-lookup"><span data-stu-id="9cd13-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="9cd13-281">Per altre informazioni, vedere la sezione [Considerazioni aggiuntive sull'autenticazione](#datarefresh_additional_authentication) contenuta in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="9cd13-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="9cd13-282">**6**</span><span class="sxs-lookup"><span data-stu-id="9cd13-282">**(6)**</span></span>|<span data-ttu-id="9cd13-283">Processo timer di aggiornamento dati PowerPivot</span><span class="sxs-lookup"><span data-stu-id="9cd13-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="9cd13-284">Imposta la connessione del servizio di sistema PowerPivot con Excel Services per l'aggiornamento dei modelli di dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="9cd13-285">sono necessari librerie client e provider di dati appropriati affinché sia possibile accedere alle origini dati tramite il server [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in modalità SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9cd13-286">Dal momento che tramite il servizio di sistema PowerPivot non viene più eseguito il caricamento o il salvataggio dei modelli PowerPivot, a una farm di SharePoint 2013 non viene applicata la maggior parte delle impostazioni per memorizzare i modelli nella cache di un server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9cd13-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="9cd13-287">Dati del log di aggiornamento dati</span><span class="sxs-lookup"><span data-stu-id="9cd13-287">Data refresh log data</span></span>  
 <span data-ttu-id="9cd13-288">**Dati di utilizzo:** è possibile visualizzare i dati di utilizzo per l'aggiornamento dati nel dashboard di gestione PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="9cd13-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="9cd13-289">Per visualizzare i dati di utilizzo:</span><span class="sxs-lookup"><span data-stu-id="9cd13-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="9cd13-290">Nel gruppo **Impostazioni generali applicazione** di Amministrazione centrale SharePoint fare clic su **Dashboard di gestione PowerPivot** .</span><span class="sxs-lookup"><span data-stu-id="9cd13-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="9cd13-291">Nella parte inferiore del dashboard, vedere **aggiornamento dati-attività recente** e **aggiornamento dati-errori recenti**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="9cd13-292">Per altre informazioni sui dati di utilizzo e sulla relativa abilitazione, vedere [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="9cd13-293">**Dati del log di diagnostica:** è possibile visualizzare i dati del log di diagnostica di SharePoint correlati all'aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="9cd13-294">Innanzitutto, verificare la configurazione della registrazione dei dati di diagnostica per il **servizio PowerPivot** nella pagina **Monitoraggio** di Amministrazione centrale SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9cd13-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="9cd13-295">Potrebbe essere necessario aumentare il livello di registrazione per l'evento meno critico da registrare.</span><span class="sxs-lookup"><span data-stu-id="9cd13-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="9cd13-296">Impostare, ad esempio, temporaneamente il valore su **Dettagliato** , quindi eseguire di nuovo le operazioni di aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="9cd13-297">Tra le voci di log sono incluse:</span><span class="sxs-lookup"><span data-stu-id="9cd13-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="9cd13-298">L' **area** del **servizio PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="9cd13-299">La categoria **Aggiornamento dati**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="9cd13-300">Controllare **Configura registrazione diagnostica**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="9cd13-301">Per ulteriori informazioni, vedere [configurare e visualizzare i file di log di SharePoint e la registrazione diagnostica &#40;PowerPivot per SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span><span class="sxs-lookup"><span data-stu-id="9cd13-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="9cd13-302">Considerazioni aggiuntive sull'autenticazione</span><span class="sxs-lookup"><span data-stu-id="9cd13-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="9cd13-303">Tramite le impostazioni della finestra di dialogo **Impostazioni autenticazione Excel Services** in Excel 2013 è possibile stabilire l'identità Windows utilizzata da Excel Services e [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] per l'aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="9cd13-304">**Usa l'account utente autenticato**: Excel Services esegue l'aggiornamento dei dati con l'identità dell'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="9cd13-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="9cd13-305">**Usa account archiviato**: si presuppone un ID dell'applicazione del servizio di archiviazione sicura di SharePoint, utilizzato da Excel Services per recuperare il nome utente e la password e consentire l'autenticazione dell'aggiornamento dati.</span><span class="sxs-lookup"><span data-stu-id="9cd13-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="9cd13-306">**Nessuno**: viene utilizzato **Account servizio automatico** di Excel Services.</span><span class="sxs-lookup"><span data-stu-id="9cd13-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="9cd13-307">L'account del servizio è associato a un proxy dell'archiviazione sicura.</span><span class="sxs-lookup"><span data-stu-id="9cd13-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="9cd13-308">Configurare le impostazioni nella sezione **Dati esterni** della pagina **Impostazioni applicazioni Excel Services** .</span><span class="sxs-lookup"><span data-stu-id="9cd13-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="9cd13-309">Per aprire la finestra di dialogo delle impostazioni di autenticazione:</span><span class="sxs-lookup"><span data-stu-id="9cd13-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="9cd13-310">Fare clic sulla scheda **Dati** in Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="9cd13-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="9cd13-311">Fare clic su **Connessioni** nella barra multifunzione.</span><span class="sxs-lookup"><span data-stu-id="9cd13-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="9cd13-312">Nella finestra di dialogo **Connessioni cartella di lavoro**selezionare la connessione e fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="9cd13-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="9cd13-313">Nella finestra di dialogo **Proprietà connessione** fare clic su **definizione**, quindi fare clic sul pulsante **impostazioni di autenticazione** .</span><span class="sxs-lookup"><span data-stu-id="9cd13-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="9cd13-314">![Impostazioni autenticazione Excel Services](../media/as-authentication-settings-4-ecs-in-excel2013.gif "Impostazioni autenticazione Excel Services")</span><span class="sxs-lookup"><span data-stu-id="9cd13-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="9cd13-315">Per altre informazioni sull'autenticazione dell'aggiornamento dati e sull'utilizzo di credenziali, vedere il post del blog sull' [aggiornamento dei dati PowerPivot in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="9cd13-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="9cd13-316">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="9cd13-316">More Information</span></span>  
 <span data-ttu-id="9cd13-317">[Risoluzione dei problemi relativi all'aggiornamento dati PowerPivot](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span><span class="sxs-lookup"><span data-stu-id="9cd13-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="9cd13-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span><span class="sxs-lookup"><span data-stu-id="9cd13-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="9cd13-319">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9cd13-319">See Also</span></span>  
 <span data-ttu-id="9cd13-320">[Aggiornare le cartelle di lavoro e l'aggiornamento dati pianificato &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="9cd13-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="9cd13-321">Installazione di PowerPivot per SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="9cd13-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
