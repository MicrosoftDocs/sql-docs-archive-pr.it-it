---
title: Calcoli | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87723215"
---
# <a name="calculations"></a><span data-ttu-id="0a0f1-102">Calcoli</span><span class="sxs-lookup"><span data-stu-id="0a0f1-102">Calculations</span></span>
  <span data-ttu-id="0a0f1-103">Un calcolo è un'espressione MDX (Multidimensional Expressions) o uno script utilizzato per definire un membro calcolato, un set denominato o un'assegnazione con ambito in un cubo in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0a0f1-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="0a0f1-104">I calcoli consentono di aggiungere oggetti definiti non dai dati del cubo, ma da espressioni che possono fare riferimento ad altre parti del cubo, ad altri cubi o persino a informazioni esterne al database di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0a0f1-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="0a0f1-105">I calcoli consentono di estendere le funzionalità di un cubo, aggiungendo flessibilità e potenza alle applicazioni di Business Intelligence.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="0a0f1-106">Per ulteriori informazioni sui calcoli di scripting, vedere [Introduzione allo scripting MDX in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span><span class="sxs-lookup"><span data-stu-id="0a0f1-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="0a0f1-107">Per ulteriori informazioni sui problemi di prestazioni relativi a query e calcoli MDX, vedere la [Guida alle prestazioni SQL Server 2005 Analysis Services](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span><span class="sxs-lookup"><span data-stu-id="0a0f1-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="0a0f1-108">Membri calcolati</span><span class="sxs-lookup"><span data-stu-id="0a0f1-108">Calculated Members</span></span>  
 <span data-ttu-id="0a0f1-109">Un membro calcolato è un membro il cui valore viene calcolato in fase di esecuzione utilizzando un'espressione MDX (Multidimensional Expressions) specificata dall'utente durante la definizione del membro stesso.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="0a0f1-110">Un membro calcolato è disponibile per le applicazioni di Business Intelligence come qualsiasi altro membro.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="0a0f1-111">I membri calcolati non aumentano le dimensioni del cubo dato che solo le definizioni vengono archiviate nel cubo, mentre il calcolo dei valori, necessario per rispondere alle query, viene eseguito in memoria.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="0a0f1-112">È possibile definire membri calcolati per qualsiasi dimensione, inclusa la dimensione delle misure.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="0a0f1-113">I membri calcolati creati per la dimensione Measures vengono denominati "misure calcolate".</span><span class="sxs-lookup"><span data-stu-id="0a0f1-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="0a0f1-114">Sebbene i membri calcolati siano generalmente basati su dati già esistenti nel cubo, è possibile creare espressioni complesse combinando questi dati con operatori aritmetici, numeri e funzioni.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="0a0f1-115">È possibile utilizzare anche funzioni MDX, ad esempio LookupCube per accedere in altri cubi nel database [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0a0f1-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="0a0f1-116">include librerie di funzione Visual Studio standardizzate ed è possibile utilizzare stored procedure per recuperare dati da origini diverse dal database [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] corrente.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="0a0f1-117">Per ulteriori informazioni sulle stored procedure, vedere [definizione di stored procedure](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="0a0f1-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="0a0f1-118">Si supponga, ad esempio, che i dirigenti di una società di spedizioni desiderino determinare i tipi di merci più vantaggiosi da trasportare in base al profitto per unità di volume.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="0a0f1-119">A tale scopo, utilizzano un cubo Shipments contenente le dimensioni Cargo, Fleet e Time e le misure Price_to_Ship, Cost_to_Ship e Volume_in_Cubic_Meters. Il cubo, tuttavia, non contiene una misura per la redditività.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="0a0f1-120">In tal caso, è possibile creare nel cubo un membro calcolato come misura denominata Profit_per_Cubic_Meter combinando le misure esistenti nell'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="0a0f1-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="0a0f1-121">Dopo aver creato il membro calcolato, la misura Profit_per_Cubic_Meter verrà visualizzata insieme alle altre alla successiva esplorazione del cubo Shipments.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="0a0f1-122">Per creare membri calcolati, utilizzare la scheda **calcoli**in Progettazione cubi.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="0a0f1-123">Per altre informazioni, vedere [creare membri calcolati](../multidimensional-models/create-calculated-members.md)</span><span class="sxs-lookup"><span data-stu-id="0a0f1-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="0a0f1-124">Set denominati</span><span class="sxs-lookup"><span data-stu-id="0a0f1-124">Named Sets</span></span>  
 <span data-ttu-id="0a0f1-125">Un set denominato è un'istruzione CREATE SET MDX che restituisce un set.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="0a0f1-126">L'espressione MDX viene salvata come parte della definizione di un cubo in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0a0f1-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="0a0f1-127">Un set denominato viene creato per il riutilizzo in query MDX</span><span class="sxs-lookup"><span data-stu-id="0a0f1-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="0a0f1-128">e consente agli utenti aziendali di semplificare le query e utilizzare un nome di set anziché un'espressione set per le espressioni set complesse utilizzate di frequente.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="0a0f1-129">**Argomento correlato:** [creare set denominati](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="0a0f1-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="0a0f1-130">Comandi script</span><span class="sxs-lookup"><span data-stu-id="0a0f1-130">Script Commands</span></span>  
 <span data-ttu-id="0a0f1-131">Un comando script è uno script MDX incluso nella definizione del cubo.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="0a0f1-132">I comandi script consentono di eseguire quasi tutte le operazioni supportate da MDX in un cubo, ad esempio la definizione dell'ambito di un calcolo da applicare solo a parte del cubo.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="0a0f1-133">In gli [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] script MDX possono essere applicati all'intero cubo o a sezioni specifiche del cubo, in punti specifici durante l'esecuzione dello script.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="0a0f1-134">L'istruzione CALCULATE, che è il comando script predefinito, popola le celle del cubo con dati aggregati in base all'ambito predefinito.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="0a0f1-135">L'ambito predefinito è l'intero cubo, ma è possibile definire un ambito più limitato, noto come sottocubo, e quindi applicare uno script MDX solo a tale area del cubo.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="0a0f1-136">L'istruzione SCOPE definisce l'ambito di tutte le successive espressioni e istruzioni MDX nello script di calcolo fino a quando l'ambito non viene terminato o ridefinito.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="0a0f1-137">Viene quindi utilizzata l'istruzione THIS per applicare un'espressione MDX all'ambito corrente.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="0a0f1-138">È possibile utilizzare l'istruzione BACK_COLOR per applicare alle celle nell'ambito corrente un colore di sfondo che agevoli le operazioni di debug.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="0a0f1-139">È ad esempio possibile utilizzare un comando script per allocare obiettivi di vendita ai dipendenti, suddivisi per periodo di tempo e territorio di vendita, in base ai valori ponderati delle vendite in un periodo di tempo precedente.</span><span class="sxs-lookup"><span data-stu-id="0a0f1-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0a0f1-140">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0a0f1-140">See Also</span></span>  
 [<span data-ttu-id="0a0f1-141">Calcoli nei modelli multidimensionali</span><span class="sxs-lookup"><span data-stu-id="0a0f1-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
