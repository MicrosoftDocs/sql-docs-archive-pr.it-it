---
title: Configurare la Windows Firewall per consentire l'accesso Analysis Services | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714791"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="ab87d-102">Configurare Windows Firewall per consentire l'accesso ad Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="ab87d-103">Un primo passaggio importante per rendere [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] o [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] disponibile nella rete consiste nel determinare se è necessario sbloccare le porte in un firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="ab87d-104">Per la maggior parte delle installazioni è necessario creare almeno una regola del firewall in entrata per consentire le connessioni a [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab87d-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="ab87d-105">I requisiti di configurazione del firewall variano in base alla modalità di installazione di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="ab87d-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="ab87d-106">Aprire la porta TCP 2383 quando si installa un'istanza predefinita o si crea un cluster di failover di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ab87d-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="ab87d-107">Aprire la porta TCP 2382 quando si installa un'istanza denominata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="ab87d-108">Per le istanze denominate vengono utilizzate assegnazioni di porte dinamiche.</span><span class="sxs-lookup"><span data-stu-id="ab87d-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="ab87d-109">Come servizio di individuazione per Analysis Services, il servizio SQL Server Browser rimane in ascolto sulla porta TCP 2382 e reindirizza la richiesta di connessione alla porta attualmente utilizzata da [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab87d-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="ab87d-110">Aprire la porta TCP 2382 quando si installa [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in modalità SharePoint per supportare [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span><span class="sxs-lookup"><span data-stu-id="ab87d-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="ab87d-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013 l'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] è esterna a SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ab87d-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="ab87d-112">Le richieste in ingresso all'istanza denominata "PowerPivot" provengono da applicazioni Web di SharePoint su una connessione di rete e richiedono una porta aperta.</span><span class="sxs-lookup"><span data-stu-id="ab87d-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="ab87d-113">Come per altre istanze denominate di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , creare una regola in ingresso per il servizio SQL Server Browser sulla porta TCP 2382 per consentire l'accesso a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab87d-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="ab87d-114">Per [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010 non aprire porte in Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="ab87d-115">Come componente aggiuntivo per SharePoint, il servizio utilizza porte configurate per SharePoint e stabilisce solo connessioni locali all'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] che carica ed esegue query sui modelli di dati di [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ab87d-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="ab87d-116">Per [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] le istanze in esecuzione in macchine virtuali di Azure, utilizzare istruzioni alternative per la configurazione dell'accesso al server.</span><span class="sxs-lookup"><span data-stu-id="ab87d-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="ab87d-117">Vedere [SQL Server Business Intelligence in macchine virtuali di Azure](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span><span class="sxs-lookup"><span data-stu-id="ab87d-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="ab87d-118">Anche se l'istanza predefinita di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] è in ascolto sulla porta TCP 2383, è possibile configurare il server in modo che sia in ascolto su una porta fissa diversa, connettendosi al server nel formato seguente: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="ab87d-119">È possibile utilizzare una sola porta TCP per un'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ab87d-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="ab87d-120">In computer che dispongono di più schede di rete o più indirizzi IP, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] è in ascolto su una porta TCP per tutti gli indirizzi IP assegnati o con alias al computer.</span><span class="sxs-lookup"><span data-stu-id="ab87d-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="ab87d-121">In caso di requisiti specifici per più porte, provare a configurare [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] per l'accesso HTTP.</span><span class="sxs-lookup"><span data-stu-id="ab87d-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="ab87d-122">In questo modo è possibile configurare più endpoint HTTP su qualsiasi porta si desideri.</span><span class="sxs-lookup"><span data-stu-id="ab87d-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="ab87d-123">Vedere [Configurare l'accesso HTTP ad Analysis Services in Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="ab87d-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="ab87d-124">In questo argomento sono incluse le sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab87d-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="ab87d-125">Controllare le impostazioni del firewall e delle porte per Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="ab87d-126">Configurare Windows Firewall per un'istanza predefinita di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="ab87d-127">Configurare l'accesso a Windows Firewall per un'istanza denominata di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="ab87d-128">Configurazione delle porte per un cluster di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="ab87d-129">Configurazione porta per PowerPivot per SharePoint</span><span class="sxs-lookup"><span data-stu-id="ab87d-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="ab87d-130">Utilizzare una porta fissa per un'istanza predefinita o denominata di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="ab87d-131">Per altre informazioni sulle impostazioni predefinite di Windows Firewall e per una descrizione delle porte TCP che interessano il motore di database, Analysis Services, Reporting Services e Integration Services, vedere [Configurare Windows Firewall per consentire l'accesso a SQL Server](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span><span class="sxs-lookup"><span data-stu-id="ab87d-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="ab87d-132">Controllare le impostazioni del firewall e della porta per Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="ab87d-133">Nei sistemi operativi Microsoft Windows supportati da [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall è attivato per impostazione predefinita e blocca le connessioni remote.</span><span class="sxs-lookup"><span data-stu-id="ab87d-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="ab87d-134">È necessario aprire manualmente una porta nel firewall per consentire le richieste in entrata per Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ab87d-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="ab87d-135">Questo passaggio non viene eseguito dal programma di installazione di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ab87d-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="ab87d-136">Le impostazioni delle porte sono specificate nel file msmdsrv.ini e nella pagina delle Proprietà generali di un'istanza di Analysis Services in SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="ab87d-137">Se il valore di `Port` è impostato su un numero intero positivo, il servizio è in ascolto su una porta fissa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="ab87d-138">Se il valore di `Port` è impostato su 0, il servizio è in ascolto sulla porta 2383 se si tratta dell'istanza predefinita o su una porta assegnata dinamicamente se si tratta di un'istanza denominata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="ab87d-139">Le assegnazioni di porte dinamiche vengono utilizzate solo per le istanze denominate.</span><span class="sxs-lookup"><span data-stu-id="ab87d-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="ab87d-140">Il servizio `MSOLAP$InstanceName` è in grado di determinare la porta da utilizzare all'avvio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="ab87d-141">Per determinare il numero effettivo della porta in uso da un'istanza denominata, effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab87d-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="ab87d-142">Avviare Gestione attività e fare clic su **Servizi** per ottenere il PID del `MSOLAP$InstanceName` .</span><span class="sxs-lookup"><span data-stu-id="ab87d-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="ab87d-143">Eseguire `netstat -ao -p TCP` dalla riga di comando per visualizzare le informazioni sulla porta TCP per tale PID.</span><span class="sxs-lookup"><span data-stu-id="ab87d-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="ab87d-144">Verificare la porta utilizzando SQL Server Management Studio e connettersi a un server Analysis Services nel formato seguente: \<IPAddress> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="ab87d-145">Sebbene un'applicazione possa essere in ascolto su una porta specifica, le connessioni non riescono se l'accesso è bloccato da un firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="ab87d-146">Per consentire alle connessioni di raggiungere un'istanza denominata di Analysis Services, è necessario sbloccare nel firewall l'accesso a msmdsrv.exe o alla porta fissa su cui è in ascolto.</span><span class="sxs-lookup"><span data-stu-id="ab87d-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="ab87d-147">Nelle restanti sezioni di questo argomento vengono fornite le istruzioni necessarie per questa operazione.</span><span class="sxs-lookup"><span data-stu-id="ab87d-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="ab87d-148">Per controllare se le impostazioni del firewall sono già definite per Analysis Services, utilizzare Windows Firewall con sicurezza avanzata nel Pannello di controllo.</span><span class="sxs-lookup"><span data-stu-id="ab87d-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="ab87d-149">Nella pagina Firewall della cartella Monitoraggio è visualizzato un elenco completo delle regole definite per il server locale.</span><span class="sxs-lookup"><span data-stu-id="ab87d-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="ab87d-150">Si noti che per [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]tutte le regole del firewall devono essere definite manualmente.</span><span class="sxs-lookup"><span data-stu-id="ab87d-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="ab87d-151">Anche se in [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] e SQL Server Browser vengono riservate le porte 2382 e 2383, tramite il programma di installazione di SQL Server o gli strumenti di configurazione non è possibile definire regole del firewall per consentire l'accesso alle porte o ai file eseguibili dei programmi.</span><span class="sxs-lookup"><span data-stu-id="ab87d-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a> <span data-ttu-id="ab87d-152">Configurare Windows Firewall per un'istanza predefinita di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="ab87d-153">L'istanza predefinita di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] è in ascolto sulla porta TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="ab87d-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="ab87d-154">Se è stata installata l'istanza predefinita e si desidera utilizzare questa porta, è sufficiente sbloccare l'accesso in ingresso alla porta TCP 2383 in Windows Firewall per abilitare l'accesso remoto per l'istanza predefinita di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab87d-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="ab87d-155">Se è stata installata l'istanza predefinita, ma si desidera configurare il servizio in modo che sia in attesa su una porta fissa, vedere [Utilizzare una porta fissa per un'istanza predefinita o denominata di Analysis Services](#bkmk_fixed) di seguito in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="ab87d-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="ab87d-156">Per verificare se il servizio è in esecuzione come istanza predefinita (MSSQLServerOLAPService), controllare il relativo nome in Gestione configurazione SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ab87d-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="ab87d-157">Un'istanza predefinita di Analysis Services è sempre elencata come **SQL Server Analysis Services (MSSQLSERVER)**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ab87d-158">Nei vari sistemi operativi Windows sono disponibili strumenti diversi per la configurazione di Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="ab87d-159">La maggior parte di questi strumenti consente di scegliere tra l'apertura di una porta specifica o di un eseguibile di un programma.</span><span class="sxs-lookup"><span data-stu-id="ab87d-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="ab87d-160">A meno che non vi sia un motivo per specificare l'eseguibile di un programma, è consigliabile specificare la porta.</span><span class="sxs-lookup"><span data-stu-id="ab87d-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="ab87d-161">Quando si specifica una regola in ingresso, adottare una convenzione di denominazione che consenta di individuare in modo semplice le regole in un secondo momento, ad esempio **SQL Server Analysis Services (TCP-in) 2383**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="ab87d-162">Windows Firewall con sicurezza avanzata</span><span class="sxs-lookup"><span data-stu-id="ab87d-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="ab87d-163">Nel Pannello di controllo di Windows 7 o Windows Vista fare clic su **Sistema e sicurezza**, selezionare **Windows Firewall**, quindi fare clic su **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="ab87d-164">In Windows Server 2008 o 2008 R2 aprire Strumenti di amministrazione e fare clic su **Windows Firewall con protezione avanzata**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="ab87d-165">In Windows Server 2012 aprire la pagina Applicazioni e digitare **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="ab87d-166">Fare clic con il pulsante destro del mouse su **Regole connessioni in entrata** e scegliere **Nuova regola**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="ab87d-167">In tipo di regola fare clic su `Port` Avanti e quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="ab87d-168">In protocollo e porte selezionare **TCP** e quindi digitare `2383` **porte locali specifiche**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="ab87d-169">In Azione fare clic su **Consenti la connessione** , quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="ab87d-170">In Profilo deselezionare tutti i percorsi di rete non applicabili, quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="ab87d-171">In nome digitare un nome descrittivo per questa regola (ad esempio, `SQL Server Analysis Services (tcp-in) 2383` ) e quindi fare clic su **fine**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="ab87d-172">Per verificare che le connessioni remote siano abilitate, aprire SQL Server Management Studio o Excel in un computer diverso e connettersi a [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] specificando il nome di rete del server in **Nome server**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="ab87d-173">Gli altri utenti non potranno accedere a questo server fino a quando non riceveranno le autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="ab87d-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="ab87d-174">Per altre informazioni, vedere [Autorizzazione dell'accesso a oggetti e operazioni &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="ab87d-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="ab87d-175">Sintassi di netsh advfirewall</span><span class="sxs-lookup"><span data-stu-id="ab87d-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="ab87d-176">Tramite il comando seguente è possibile creare una regola per le connessioni in ingresso che consente le richieste in ingresso sulla porta TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="ab87d-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="ab87d-177">Configurare l'accesso Windows Firewall per un'istanza denominata di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="ab87d-178">Le istanze denominate di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] possono essere in ascolto su una porta fissa o su una porta assegnata dinamicamente, dove il servizio SQL Server Browser fornisce le informazioni di connessione valide per il servizio al momento della connessione.</span><span class="sxs-lookup"><span data-stu-id="ab87d-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="ab87d-179">Il servizio SQL Server Browser è in ascolto sulla porta TCP 2382.</span><span class="sxs-lookup"><span data-stu-id="ab87d-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="ab87d-180">UDP non viene utilizzato.</span><span class="sxs-lookup"><span data-stu-id="ab87d-180">UDP is not used.</span></span> <span data-ttu-id="ab87d-181">TCP è l'unico protocollo di trasmissione utilizzato da [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab87d-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="ab87d-182">Scegliere uno degli approcci seguenti per abilitare l'accesso remoto a un'istanza denominata di Analysis Services:</span><span class="sxs-lookup"><span data-stu-id="ab87d-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="ab87d-183">Utilizzare assegnazioni di porta dinamiche e il servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="ab87d-184">Sbloccare la porta utilizzata dal servizio SQL Server Browser in Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="ab87d-185">Connettersi al server nel formato seguente: \<servername> \\<NomeIstanza \> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="ab87d-186">Utilizzare insieme una porta fissa e il servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="ab87d-187">Questo approccio consente di connettersi utilizzando questo formato: \<servername> \\<NomeIstanza \> , identico all'approccio di assegnazione porta dinamica, con la differenza che in questo caso il server è in ascolto su una porta fissa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="ab87d-188">In questo scenario, il servizio SQL Server Browser fornisce la risoluzione dei nomi all'istanza di Analysis Services che è in attesa sulla porta fissa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="ab87d-189">Per utilizzare questo approccio, configurare il server in modo che sia in attesa su una porta fissa, sbloccare l'accesso a tale porta e sbloccare l'accesso alla porta utilizzata dal servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="ab87d-190">Il servizio SQL Server Browser viene utilizzato solo con istanze denominate, mai con l'istanza predefinita.</span><span class="sxs-lookup"><span data-stu-id="ab87d-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="ab87d-191">Il servizio viene installato automaticamente ed è abilitato quando si installa una qualsiasi funzionalità di SQL Server come istanza denominata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="ab87d-192">Se si sceglie un approccio che richiede il servizio SQL Server Browser, accertarsi che rimanga abilitato e avviato nel server.</span><span class="sxs-lookup"><span data-stu-id="ab87d-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="ab87d-193">Se non è possibile utilizzare il servizio SQL Server Browser, è necessario assegnare una porta fissa nella stringa di connessione ignorando la risoluzione dei nomi di dominio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="ab87d-194">Senza il servizio SQL Server Browser, in tutte le connessioni client deve essere incluso il numero di porta nella stringa di connessione (ad esempio, AW-SRV01: 54321).</span><span class="sxs-lookup"><span data-stu-id="ab87d-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="ab87d-195">**Opzione 1: Utilizzare assegnazioni di porta dinamiche e sbloccare l'accesso al servizio SQL Server Browser**</span><span class="sxs-lookup"><span data-stu-id="ab87d-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="ab87d-196">Le assegnazioni di porta dinamiche per le istanze denominate di Analysis Services vengono stabilite da `MSOLAP$InstanceName` all'avvio del servizio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="ab87d-197">Per impostazione predefinita, il servizio richiede il primo numero di porta disponibile trovato, utilizzando un numero di porta diverso ogni volta che viene riavviato.</span><span class="sxs-lookup"><span data-stu-id="ab87d-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="ab87d-198">La risoluzione dei nomi di istanza viene gestita dal servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="ab87d-199">Se si utilizzano assegnazioni di porta dinamiche con un'istanza denominata, è sempre necessario sbloccare la porta TCP 2382 per il servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ab87d-200">Il servizio SQL Server Browser è in ascolto su entrambe le porte UDP 1434 e TCP 2382, rispettivamente per il Motore di database e per Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ab87d-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="ab87d-201">Anche se è già stata sbloccata la porta UDP 1434 per il servizio SQL Server Browser, è comunque necessario sbloccare anche la porta TCP 2382 per Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ab87d-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="ab87d-202">Windows Firewall con sicurezza avanzata</span><span class="sxs-lookup"><span data-stu-id="ab87d-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="ab87d-203">Nel Pannello di controllo di Windows 7 o Windows Vista fare clic su **Sistema e sicurezza**, selezionare **Windows Firewall**, quindi fare clic su **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="ab87d-204">In Windows Server 2008 o 2008 R2 aprire Strumenti di amministrazione e fare clic su **Windows Firewall con protezione avanzata**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="ab87d-205">In Windows Server 2012 aprire la pagina Applicazioni e digitare **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="ab87d-206">Per sbloccare l'accesso al servizio SQL Server Browser, fare clic con il pulsante destro del mouse su **Regole connessioni in entrata** , quindi scegliere **Nuova regola**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="ab87d-207">In tipo di regola fare clic su `Port` Avanti e quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="ab87d-208">In protocollo e porte selezionare **TCP** e quindi digitare `2382` **porte locali specifiche**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="ab87d-209">In Azione fare clic su **Consenti la connessione** , quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="ab87d-210">In Profilo deselezionare tutti i percorsi di rete non applicabili, quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="ab87d-211">In nome digitare un nome descrittivo per questa regola (ad esempio, `SQL Server Browser Service (tcp-in) 2382` ) e quindi fare clic su **fine**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="ab87d-212">Per verificare che le connessioni remote siano abilitate, aprire SQL Server Management Studio o Excel in un computer diverso e connettersi al Analysis Services specificando il nome di rete del server e il nome dell'istanza nel formato seguente: \<servername> \\<NomeIstanza \> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="ab87d-213">Ad esempio, su un server denominato **AW-SRV01** con un'istanza denominata **Finance**, il nome server è **AW-SRV01\Finance**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="ab87d-214">**Opzione 2: Utilizzare una porta fissa per un'istanza denominata**</span><span class="sxs-lookup"><span data-stu-id="ab87d-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="ab87d-215">In alternativa, è possibile assegnare una porta fissa e quindi sbloccare l'accesso a tale porta.</span><span class="sxs-lookup"><span data-stu-id="ab87d-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="ab87d-216">Questo approccio offre capacità di controllo migliori rispetto a consentire l'accesso al file eseguibile di un programma.</span><span class="sxs-lookup"><span data-stu-id="ab87d-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="ab87d-217">Per questo motivo, per accedere a una qualsiasi istanza di Analysis Services è consigliabile utilizzare una porta fissa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="ab87d-218">Per assegnare una porta fissa, seguire le istruzioni in [Utilizzare una porta fissa per un'istanza predefinita o denominata di Analysis Services](#bkmk_fixed) in questo argomento, quindi tornare a questa sezione per sbloccare la porta.</span><span class="sxs-lookup"><span data-stu-id="ab87d-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="ab87d-219">Windows Firewall con sicurezza avanzata</span><span class="sxs-lookup"><span data-stu-id="ab87d-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="ab87d-220">Nel Pannello di controllo di Windows 7 o Windows Vista fare clic su **Sistema e sicurezza**, selezionare **Windows Firewall**, quindi fare clic su **Impostazioni avanzate**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="ab87d-221">In Windows Server 2008 o 2008 R2 aprire Strumenti di amministrazione e fare clic su **Windows Firewall con protezione avanzata**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="ab87d-222">In Windows Server 2012 aprire la pagina Applicazioni e digitare **Windows Firewall**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="ab87d-223">Per sbloccare l'accesso ad Analysis Services, fare clic con il pulsante destro del mouse su **Regole connessioni in entrata** , quindi scegliere **Nuova regola**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="ab87d-224">In tipo di regola fare clic su `Port` Avanti e quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="ab87d-225">In Protocollo e porte selezionare **TCP** , quindi digitare la porta fissa in **Porte locali specifiche**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="ab87d-226">In Azione fare clic su **Consenti la connessione** , quindi su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="ab87d-227">In Profilo deselezionare tutti i percorsi di rete non applicabili, quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="ab87d-228">In nome digitare un nome descrittivo per questa regola (ad esempio, `SQL Server Analysis Services on port 54321` ) e quindi fare clic su **fine**.</span><span class="sxs-lookup"><span data-stu-id="ab87d-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="ab87d-229">Per verificare che le connessioni remote siano abilitate, aprire SQL Server Management Studio o Excel in un computer diverso e connettersi al Analysis Services specificando il nome di rete del server e il numero di porta nel formato seguente: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="ab87d-230">Sintassi di netsh advfirewall</span><span class="sxs-lookup"><span data-stu-id="ab87d-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="ab87d-231">I comandi seguenti consentono di creare regole per le connessioni in entrata per sbloccare la porta TCP 2382 per il servizio SQL Server Browser e la porta fissa specificata per l'istanza di Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ab87d-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="ab87d-232">È possibile eseguire uno qualsiasi dei due comandi per consentire l'accesso a un'istanza denominata di Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="ab87d-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="ab87d-233">In questo comando di esempio, la porta fissa è la porta 54321.</span><span class="sxs-lookup"><span data-stu-id="ab87d-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="ab87d-234">Sostituire il numero di porta con quello della porta effettivamente in uso nel sistema.</span><span class="sxs-lookup"><span data-stu-id="ab87d-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="ab87d-235">Utilizzare una porta fissa per un'istanza predefinita o denominata di Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="ab87d-236">In questa sezione viene illustrato come configurare Analysis Services per l'ascolto su una porta fissa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="ab87d-237">L'utilizzo di una porta fissa è comune se Analysis Services è stato installato come istanza denominata, ma è inoltre possibile utilizzare questo approccio se i requisiti aziendali o di sicurezza specificano di utilizzare assegnazioni di porta non predefinite.</span><span class="sxs-lookup"><span data-stu-id="ab87d-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="ab87d-238">Si noti che l'utilizzo di una porta fissa implica la modifica della sintassi di connessione per l'istanza predefinita, in quanto è necessario aggiungere il numero di porta al nome del server.</span><span class="sxs-lookup"><span data-stu-id="ab87d-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="ab87d-239">Per la connessione a un'istanza locale predefinita di Analysis Services in attesa sulla porta 54321 in SQL Server Management Studio, sarebbe ad esempio necessario digitare localhost:54321 come nome del server nella finestra di dialogo Connetti al server di Management Studio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="ab87d-240">Se si utilizza un'istanza denominata, è possibile assegnare una porta fissa senza modificare la modalità di impostazione del nome del server (in particolare, è possibile utilizzare \<servername\instancename> per connettersi a un'istanza denominata in ascolto su una porta fissa).</span><span class="sxs-lookup"><span data-stu-id="ab87d-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="ab87d-241">Tale operazione funziona solo se il servizio SQL Server Browser è in esecuzione ed è stata sbloccata la porta sulla quale è in attesa.</span><span class="sxs-lookup"><span data-stu-id="ab87d-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="ab87d-242">SQL Server Browser servizio fornirà il reindirizzamento alla porta fissa basata su \<servername\instancename> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="ab87d-243">Se si aprono le porte sia per il servizio SQL Server Browser che per l'istanza denominata di Analysis Services in ascolto sulla porta fissa, tramite il servizio SQL Server Browser la connessione viene risolta in un'istanza denominata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="ab87d-244">Determinare una porta TCP/IP disponibile da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="ab87d-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="ab87d-245">Per visualizzare un elenco di porte riservate e registrate che è necessario evitare di usare, vedere la pagina relativa ai [numeri di porta (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span><span class="sxs-lookup"><span data-stu-id="ab87d-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="ab87d-246">Per visualizzare un elenco di porte già in uso nel sistema, aprire una finestra del prompt dei comandi e digitare `netstat -a -p TCP` per visualizzare un elenco delle porte TCP aperte nel sistema.</span><span class="sxs-lookup"><span data-stu-id="ab87d-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="ab87d-247">Dopo aver determinato la porta da utilizzare, specificarla modificando l'impostazione di configurazione `Port` nel file msmdsrv.ini o nella pagina delle proprietà Generale di un'istanza di Analysis Services in SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="ab87d-248">Riavviare il servizio.</span><span class="sxs-lookup"><span data-stu-id="ab87d-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="ab87d-249">Configurare Windows Firewall per sbloccare la porta TCP specificata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="ab87d-250">In alternativa, se si sta utilizzando una porta fissa per un'istanza denominata, sbloccare sia la porta TCP specificata per tale istanza sia la porta TCP 2382 per il servizio SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="ab87d-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="ab87d-251">Effettuare una verifica connettendosi localmente (in Management Studio) e, successivamente, in remoto da un'applicazione client in un altro computer.</span><span class="sxs-lookup"><span data-stu-id="ab87d-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="ab87d-252">Per utilizzare Management Studio, connettersi a un'istanza predefinita di Analysis Services specificando il nome di un server nel formato: \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="ab87d-253">Per un'istanza denominata, specificare il nome del server come \<servername> \\<NomeIstanza \> .</span><span class="sxs-lookup"><span data-stu-id="ab87d-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="ab87d-254">Configurazione delle porte per un cluster Analysis Services</span><span class="sxs-lookup"><span data-stu-id="ab87d-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="ab87d-255">Un cluster di failover di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] è sempre in ascolto sulla porta TCP 2383, indipendentemente da come è stato installato, istanza predefinita o denominata.</span><span class="sxs-lookup"><span data-stu-id="ab87d-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="ab87d-256">Le assegnazioni di porta dinamiche non vengono utilizzate da [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] se è installato in un cluster di failover Windows.</span><span class="sxs-lookup"><span data-stu-id="ab87d-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="ab87d-257">Aprire TCP 2383 in ogni nodo con [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in esecuzione nel cluster.</span><span class="sxs-lookup"><span data-stu-id="ab87d-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="ab87d-258">Per ulteriori informazioni sul clustering di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], vedere [Come eseguire il clustering di SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span><span class="sxs-lookup"><span data-stu-id="ab87d-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="ab87d-259">Configurazione porta per PowerPivot per SharePoint</span><span class="sxs-lookup"><span data-stu-id="ab87d-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="ab87d-260">L'architettura server per [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] è fondamentalmente diversa a seconda della versione di SharePoint in uso.</span><span class="sxs-lookup"><span data-stu-id="ab87d-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="ab87d-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="ab87d-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="ab87d-262">In SharePoint 2013, Excel Services reindirizza le richieste per i modelli di dati di PowerPivot, che vengono successivamente caricati in un'istanza di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] all'esterno dell'ambiente SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ab87d-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="ab87d-263">Le connessioni seguono il modello tipico, secondo cui da una libreria client di Analysis Services in un computer locale viene inviata una richiesta di connessione a un'istanza remota di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] nella stessa rete.</span><span class="sxs-lookup"><span data-stu-id="ab87d-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="ab87d-264">Poiché con [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] viene sempre installato [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] come istanza denominata, considerare il servizio SQL Server Browser e le assegnazioni di porta dinamiche.</span><span class="sxs-lookup"><span data-stu-id="ab87d-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="ab87d-265">Come già evidenziato, il servizio SQL Server Browser rimane in ascolto sulla porta TCP 2382 per le richieste di connessione inviate a istanze denominate di [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , reindirizzando la richiesta alla porta corrente.</span><span class="sxs-lookup"><span data-stu-id="ab87d-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="ab87d-266">Si noti che in Excel Services in SharePoint 2013 non è supportata la sintassi di connessione alla porta fissa, quindi è opportuno assicurarsi che il servizio SQL Server Browser sia accessibile.</span><span class="sxs-lookup"><span data-stu-id="ab87d-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="ab87d-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="ab87d-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="ab87d-268">Se si utilizza SharePoint 2010, non è necessario aprire le porte in Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="ab87d-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="ab87d-269">In SharePoint vengono aperte le porte necessarie e i componenti aggiuntivi, ad esempio PowerPivot per SharePoint, vengono eseguiti nell'ambiente SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ab87d-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="ab87d-270">In un'installazione di PowerPivot per SharePoint 2010, il Servizio di sistema PowerPivot dispone dell'utilizzo esclusivo dell'istanza locale del servizio SQL Server Analysis Services (PowerPivot) installata nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="ab87d-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="ab87d-271">Per l'accesso al servizio del motore Analysis Services locale, che consente operazioni di caricamento, esecuzione di query ed elaborazione di dati PowerPivot nel server SharePoint, vengono utilizzate connessioni locali e non di rete.</span><span class="sxs-lookup"><span data-stu-id="ab87d-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="ab87d-272">Per richiedere dati PowerPivot dalle applicazioni client, le richieste vengono instradate tramite porte aperte dal programma di installazione di SharePoint. in particolare, vengono definite regole in ingresso per consentire l'accesso a SharePoint-80, amministrazione centrale SharePoint V4, servizi Web di SharePoint e SPUserCodeV4.</span><span class="sxs-lookup"><span data-stu-id="ab87d-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="ab87d-273">Poiché i servizi Web PowerPivot vengono eseguiti in una farm di SharePoint, le regole del firewall di SharePoint sono sufficienti per l'accesso remoto ai dati PowerPivot in una farm di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="ab87d-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ab87d-274">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ab87d-274">See Also</span></span>  
 <span data-ttu-id="ab87d-275">[Motore di database &#40;del servizio SQL Server Browser e SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="ab87d-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="ab87d-276">[Avviare, arrestare, sospendere, riprendere, riavviare il motore di database, SQL Server Agent o SQL Server Browser](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="ab87d-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="ab87d-277">Configurare Windows Firewall per l'accesso al motore di database</span><span class="sxs-lookup"><span data-stu-id="ab87d-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
