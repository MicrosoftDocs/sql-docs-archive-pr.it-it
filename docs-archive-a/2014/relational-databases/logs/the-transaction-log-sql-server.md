---
title: Log delle transazioni (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 01/04/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- transaction logs [SQL Server], about
- databases [SQL Server], transaction logs
- logs [SQL Server], transaction logs
ms.assetid: d7be5ac5-4c8e-4d0a-b114-939eb97dac4d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 025ef22e6dee1fcfaa1225a4709fa01b6c326b12
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87627238"
---
# <a name="the-transaction-log-sql-server"></a><span data-ttu-id="e050c-102">Log delle transazioni (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="e050c-102">The Transaction Log (SQL Server)</span></span>
  <span data-ttu-id="e050c-103">Ogni database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] include un log delle transazioni in cui vengono registrate tutte le transazioni e le modifiche apportate dalle transazioni stesse al database.</span><span class="sxs-lookup"><span data-stu-id="e050c-103">Every [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database has a transaction log that records all transactions and the database modifications made by each transaction.</span></span> <span data-ttu-id="e050c-104">Per evitarne il riempimento, il log delle transazioni deve essere troncato regolarmente.</span><span class="sxs-lookup"><span data-stu-id="e050c-104">The transaction log must be truncated on a regular basis to keep it from filling up.</span></span> <span data-ttu-id="e050c-105">Tuttavia, alcuni fattori possono posticipare il troncamento del log, pertanto è importante monitorare le dimensioni del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-105">However, some factors can delay log truncation, so monitoring log size is important.</span></span> <span data-ttu-id="e050c-106">Ad alcune operazioni può essere applicata la registrazione minima per ridurre l'impatto sulle dimensioni del log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-106">Some operations can be minimally logged to reduce their impact on transaction log size.</span></span>  
  
 <span data-ttu-id="e050c-107">Il log delle transazioni è un componente fondamentale del database e, in caso di errore di sistema, può essere necessario per ripristinare la coerenza del database.</span><span class="sxs-lookup"><span data-stu-id="e050c-107">The transaction log is a critical component of the database and, if there is a system failure, the transaction log might be required to bring your database back to a consistent state.</span></span> <span data-ttu-id="e050c-108">Il log delle transazioni non deve mai essere eliminato o spostato, a meno che non vi sia la piena consapevolezza delle conseguenze di tale operazione.</span><span class="sxs-lookup"><span data-stu-id="e050c-108">The transaction log should never be deleted or moved unless you fully understand the ramifications of doing this.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e050c-109">I checkpoint rappresentano i punti ottimali noti da cui avviare l'applicazione dei log delle transazioni durante il ripristino del database.</span><span class="sxs-lookup"><span data-stu-id="e050c-109">Known good points from which to begin applying transaction logs during database recovery are created by checkpoints.</span></span> <span data-ttu-id="e050c-110">Per altre informazioni, vedere [Checkpoint di database &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-110">For more information, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>  
  
 <span data-ttu-id="e050c-111">**Contenuto dell'argomento**</span><span class="sxs-lookup"><span data-stu-id="e050c-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="e050c-112">Vantaggi: operazioni supportate dal log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-112">Benefits: Operations Supported by the Transaction Log</span></span>](#Benefits)  
  
-   [<span data-ttu-id="e050c-113">Troncamento del log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-113">Transaction Log Truncation</span></span>](#Truncation)  
  
-   [<span data-ttu-id="e050c-114">Fattori che possono ritardare il troncamento del log</span><span class="sxs-lookup"><span data-stu-id="e050c-114">Factors That Can Delay Log Truncation</span></span>](#FactorsThatDelayTruncation)  
  
-   [<span data-ttu-id="e050c-115">Operazioni che possono essere registrate con registrazione minima</span><span class="sxs-lookup"><span data-stu-id="e050c-115">Operations That Can Be Minimally Logged</span></span>](#MinimallyLogged)  
  
-   [<span data-ttu-id="e050c-116">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="e050c-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="benefits-operations-supported-by-the-transaction-log"></a><a name="Benefits"></a><span data-ttu-id="e050c-117">Vantaggi: operazioni supportate dal log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-117">Benefits: Operations Supported by the Transaction Log</span></span>  
 <span data-ttu-id="e050c-118">Il log delle transazioni supporta le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e050c-118">The transaction log supports the following operations:</span></span>  
  
-   <span data-ttu-id="e050c-119">Recupero di singole transazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-119">Recovery of individual transactions.</span></span>  
  
-   <span data-ttu-id="e050c-120">Recupero di tutte le transazioni incomplete all'avvio di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e050c-120">Recovery of all incomplete transactions when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is started.</span></span>  
  
-   <span data-ttu-id="e050c-121">Rollforward di una pagina, file, filegroup o database ripristinato fino al punto in cui si è verificato l'errore.</span><span class="sxs-lookup"><span data-stu-id="e050c-121">Rolling a restored database, file, filegroup, or page forward to the point of failure.</span></span>  
  
-   <span data-ttu-id="e050c-122">Supporto della replica transazionale.</span><span class="sxs-lookup"><span data-stu-id="e050c-122">Supporting transactional replication.</span></span>  
  
-   <span data-ttu-id="e050c-123">Supporto delle soluzioni di ripristino di emergenza e disponibilità elevata: [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], mirroring del database e log shipping.</span><span class="sxs-lookup"><span data-stu-id="e050c-123">Supporting high availability and disaster recovery solutions: [!INCLUDE[ssHADR](../../includes/sshadr-md.md)], database mirroring, and log shipping.</span></span>  
  
##  <a name="transaction-log-truncation"></a><a name="Truncation"></a> <span data-ttu-id="e050c-124">Troncamento del log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-124">Transaction Log Truncation</span></span>  
 <span data-ttu-id="e050c-125">Il troncamento del log libera spazio nel file di log per consentirne il riutilizzo da parte del log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-125">Log truncation frees space in the log file for reuse by the transaction log.</span></span> <span data-ttu-id="e050c-126">Il troncamento del log è essenziale per evitare il riempimento del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-126">Log truncation is essential to keep the log from filling.</span></span> <span data-ttu-id="e050c-127">Il troncamento del log elimina i file di log virtuali inattivi dal log delle transazioni logico di un database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , liberando spazio nel log logico per il riutilizzo da parte del log delle transazioni fisico.</span><span class="sxs-lookup"><span data-stu-id="e050c-127">Log truncation deletes inactive virtual log files from the logical transaction log of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, freeing space in the logical log for reuse by the Physical transaction log.</span></span> <span data-ttu-id="e050c-128">Se un log delle transazioni non viene mai troncato, è possibile che le sue dimensioni aumentino fino a occupare tutto lo spazio su disco allocato ai file di log fisici.</span><span class="sxs-lookup"><span data-stu-id="e050c-128">If a transaction log were never truncated, it would eventually fill all the disk space that is allocated to its physical log files.</span></span>  
  
 <span data-ttu-id="e050c-129">Per evitare questo problema, il troncamento si verifica automaticamente dopo gli eventi riportati di seguito, a meno che tale operazione non sia stata posticipata per qualche motivo:</span><span class="sxs-lookup"><span data-stu-id="e050c-129">To avoid this problem, unless log truncation is being delayed for some reason, truncation occurs automatically after the following events:</span></span>  
  
-   <span data-ttu-id="e050c-130">Nel modello di recupero con registrazione minima, dopo un checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e050c-130">Under the simple recovery model, after a checkpoint.</span></span>  
  
-   <span data-ttu-id="e050c-131">Nel modello di recupero con registrazione completa o nel modello di recupero con registrazione minima delle operazioni bulk, se si è verificato un checkpoint dal backup precedente, il troncamento si verifica dopo un backup del log (a meno che non si tratti di un backup del log di sola copia).</span><span class="sxs-lookup"><span data-stu-id="e050c-131">Under the full recovery model or bulk-logged recovery model, if a checkpoint has occurred since the previous backup, truncation occurs after a log backup (unless it is a copy-only log backup).</span></span>  
  
 <span data-ttu-id="e050c-132">Per ulteriori informazioni, vedere [fattori che possono ritardare il troncamento del log](#FactorsThatDelayTruncation), più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="e050c-132">For more information, see [Factors That Can Delay Log Truncation](#FactorsThatDelayTruncation), later in this topic.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e050c-133">Il troncamento del log non riduce le dimensioni del file di log fisico.</span><span class="sxs-lookup"><span data-stu-id="e050c-133">Log truncation does not reduce the size of the physical log file.</span></span> <span data-ttu-id="e050c-134">Per ridurre le dimensioni fisiche di un file di log fisico, è necessario compattare il file di log.</span><span class="sxs-lookup"><span data-stu-id="e050c-134">To reduce the physical size of a physical log file, you need to shrink the log file.</span></span> <span data-ttu-id="e050c-135">Per informazioni sulla compattazione del file di log fisico, vedere [Gestire le dimensioni del file di log delle transazioni](manage-the-size-of-the-transaction-log-file.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-135">For information about shrinking the size of the physical log file, see [Manage the Size of the Transaction Log File](manage-the-size-of-the-transaction-log-file.md).</span></span>  
  
##  <a name="factors-that-can-delay-log-truncation"></a><a name="FactorsThatDelayTruncation"></a><span data-ttu-id="e050c-136">Fattori che possono ritardare il troncamento del log</span><span class="sxs-lookup"><span data-stu-id="e050c-136">Factors That Can Delay Log Truncation</span></span>  
 <span data-ttu-id="e050c-137">Quando i record del log rimangono attivi per molto tempo il troncamento viene posticipato e il log delle transazioni potrebbe riempirsi.</span><span class="sxs-lookup"><span data-stu-id="e050c-137">When log records remain active for a long time transaction log truncation is delayed, and potentially the transaction log can fill up.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e050c-138">Per informazioni su come agire quando il log delle transazioni è completo, vedere [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-138">For information about how to respond to a full transaction log, see [Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;](troubleshoot-a-full-transaction-log-sql-server-error-9002.md).</span></span>  
  
 <span data-ttu-id="e050c-139">Il troncamento del log può essere posticipato da diversi fattori.</span><span class="sxs-lookup"><span data-stu-id="e050c-139">Log truncation can be delayed by a variety of factors.</span></span> <span data-ttu-id="e050c-140">Per individuare l'eventuale condizione che impedisce il troncamento del log, eseguire una query sulle colonne **log_reuse_wait** e **log_reuse_wait_desc** della vista del catalogo [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="e050c-140">You can discover what, if anything, is preventing log truncation by querying the **log_reuse_wait** and **log_reuse_wait_desc** columns of the [sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) catalog view.</span></span> <span data-ttu-id="e050c-141">Nella tabella seguente vengono descritti i valori di queste colonne.</span><span class="sxs-lookup"><span data-stu-id="e050c-141">The following table describes the values of these columns.</span></span>  
  
|<span data-ttu-id="e050c-142">Valore di log_reuse_wait</span><span class="sxs-lookup"><span data-stu-id="e050c-142">log_reuse_wait value</span></span>|<span data-ttu-id="e050c-143">Valore di log_reuse_wait_desc</span><span class="sxs-lookup"><span data-stu-id="e050c-143">log_reuse_wait_desc value</span></span>|<span data-ttu-id="e050c-144">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e050c-144">Description</span></span>|  
|----------------------------|----------------------------------|-----------------|  
|<span data-ttu-id="e050c-145">0</span><span class="sxs-lookup"><span data-stu-id="e050c-145">0</span></span>|<span data-ttu-id="e050c-146">NOTHING</span><span class="sxs-lookup"><span data-stu-id="e050c-146">NOTHING</span></span>|<span data-ttu-id="e050c-147">Attualmente vi sono uno o più file di log virtuali riutilizzabili.</span><span class="sxs-lookup"><span data-stu-id="e050c-147">Currently there are one or more reusable virtual log files.</span></span>|  
|<span data-ttu-id="e050c-148">1</span><span class="sxs-lookup"><span data-stu-id="e050c-148">1</span></span>|<span data-ttu-id="e050c-149">CHECKPOINT</span><span class="sxs-lookup"><span data-stu-id="e050c-149">CHECKPOINT</span></span>|<span data-ttu-id="e050c-150">Non si è verificato alcun checkpoint dall'ultimo troncamento del log oppure l'inizio del log non è stato ancora spostato oltre un file di log virtuale.</span><span class="sxs-lookup"><span data-stu-id="e050c-150">No checkpoint has occurred since the last log truncation, or the head of the log has not yet moved beyond a virtual log file.</span></span> <span data-ttu-id="e050c-151">(Tutti i modelli di recupero)</span><span class="sxs-lookup"><span data-stu-id="e050c-151">(All recovery models)</span></span><br /><br /> <span data-ttu-id="e050c-152">Si tratta di una motivazione comune per il posticipo del troncamento del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-152">This is a routine reason for delaying log truncation.</span></span> <span data-ttu-id="e050c-153">Per altre informazioni, vedere [Checkpoint di database &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-153">For more information, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>|  
|<span data-ttu-id="e050c-154">2</span><span class="sxs-lookup"><span data-stu-id="e050c-154">2</span></span>|<span data-ttu-id="e050c-155">LOG_BACKUP</span><span class="sxs-lookup"><span data-stu-id="e050c-155">LOG_BACKUP</span></span>|<span data-ttu-id="e050c-156">È necessario eseguire un backup del log prima del troncamento del log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-156">A log backup is required before the transaction log can be truncated.</span></span> <span data-ttu-id="e050c-157">(Solo modelli di recupero con registrazione completa e con registrazione minima delle operazioni bulk)</span><span class="sxs-lookup"><span data-stu-id="e050c-157">(Full or bulk-logged recovery models only)</span></span><br /><br /> <span data-ttu-id="e050c-158">Quando il backup del log successivo viene completato, parte dello spazio del log potrebbe divenire riutilizzabile.</span><span class="sxs-lookup"><span data-stu-id="e050c-158">When the next log backup is completed, some log space might become reusable.</span></span>|  
|<span data-ttu-id="e050c-159">3</span><span class="sxs-lookup"><span data-stu-id="e050c-159">3</span></span>|<span data-ttu-id="e050c-160">ACTIVE_BACKUP_OR_RESTORE</span><span class="sxs-lookup"><span data-stu-id="e050c-160">ACTIVE_BACKUP_OR_RESTORE</span></span>|<span data-ttu-id="e050c-161">È in esecuzione un processo di backup o ripristino dei dati (tutti i modelli di recupero).</span><span class="sxs-lookup"><span data-stu-id="e050c-161">A data backup or a restore is in progress (all recovery models).</span></span><br /><br /> <span data-ttu-id="e050c-162">Se il troncamento del log è impedito da un backup dei dati, l'annullamento del backup può risolvere il problema immediato.</span><span class="sxs-lookup"><span data-stu-id="e050c-162">If a data backup is preventing log truncation, canceling the backup operation might help the immediate problem.</span></span>|  
|<span data-ttu-id="e050c-163">4</span><span class="sxs-lookup"><span data-stu-id="e050c-163">4</span></span>|<span data-ttu-id="e050c-164">ACTIVE_TRANSACTION</span><span class="sxs-lookup"><span data-stu-id="e050c-164">ACTIVE_TRANSACTION</span></span>|<span data-ttu-id="e050c-165">Una transazione è attiva (tutti i modelli di recupero).</span><span class="sxs-lookup"><span data-stu-id="e050c-165">A transaction is active (all recovery models).</span></span><br /><br /> <span data-ttu-id="e050c-166">Una transazione con esecuzione prolungata potrebbe esistere all'inizio del backup del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-166">A long-running transaction might exist at the start of the log backup.</span></span> <span data-ttu-id="e050c-167">In questo caso, per liberare lo spazio potrebbe essere necessario un altro backup del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-167">In this case, freeing the space might require another log backup.</span></span> <span data-ttu-id="e050c-168">Si noti che le transazioni con esecuzione prolungata impediscono il troncamento del log in tutti i modelli di recupero, incluso il modello di recupero con registrazione minima, in cui il log delle transazioni viene in genere troncato in ogni checkpoint automatico.</span><span class="sxs-lookup"><span data-stu-id="e050c-168">Note that a long-running transactions prevent log truncation under all recovery models, including the simple recovery model, under which the transaction log is generally truncated on each automatic checkpoint.</span></span><br /><br /> <span data-ttu-id="e050c-169">Viene posticipata una transazione.</span><span class="sxs-lookup"><span data-stu-id="e050c-169">A transaction is deferred.</span></span> <span data-ttu-id="e050c-170">Una *transazione posticipata* è una transazione attiva ed efficace il cui ritorno allo stato precedente è bloccato a causa di alcune risorse non disponibili.</span><span class="sxs-lookup"><span data-stu-id="e050c-170">A *deferred transaction* is effectively an active transaction whose rollback is blocked because of some unavailable resource.</span></span> <span data-ttu-id="e050c-171">Per informazioni sulle cause delle transazioni posticipate e su come modificarne lo stato, vedere [Transazioni posticipate &#40;SQL Server&#41;](../backup-restore/deferred-transactions-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-171">For information about the causes of deferred transactions and how to move them out of the deferred state, see [Deferred Transactions &#40;SQL Server&#41;](../backup-restore/deferred-transactions-sql-server.md).</span></span> <br /><br /><span data-ttu-id="e050c-172">Anche le transazioni con esecuzione prolungata potrebbero riempire il log delle transazioni di tempdb.</span><span class="sxs-lookup"><span data-stu-id="e050c-172">Long-running transactions might also fill up tempdb's transaction log.</span></span> <span data-ttu-id="e050c-173">Tempdb viene usato in modo implicito dalle transazioni utente per gli oggetti interni, ad esempio tabelle di lavoro per l'ordinamento, file di lavoro per l'hashing, tabelle di lavoro di cursori e controllo delle versioni delle righe.</span><span class="sxs-lookup"><span data-stu-id="e050c-173">Tempdb is used implicitly by user transactions for internal objects such as work tables for sorting, work files for hashing, cursor work tables, and row versioning.</span></span> <span data-ttu-id="e050c-174">Anche se la transazione utente include solo la lettura di dati (SELECT Querys), è possibile creare oggetti interni e utilizzarli nelle transazioni utente.</span><span class="sxs-lookup"><span data-stu-id="e050c-174">Even if the user transaction includes only reading data (SELECT queries), internal objects may be created and used under user transactions.</span></span> <span data-ttu-id="e050c-175">In questo modo, il log delle transazioni di tempdb potrebbe riempirsi.</span><span class="sxs-lookup"><span data-stu-id="e050c-175">Then the tempdb transaction log can be filled.</span></span>|  
|<span data-ttu-id="e050c-176">5</span><span class="sxs-lookup"><span data-stu-id="e050c-176">5</span></span>|<span data-ttu-id="e050c-177">DATABASE_MIRRORING</span><span class="sxs-lookup"><span data-stu-id="e050c-177">DATABASE_MIRRORING</span></span>|<span data-ttu-id="e050c-178">Il mirroring del database è sospeso o in modalità a prestazioni elevate, il database mirror è notevolmente in ritardo rispetto al database principale.</span><span class="sxs-lookup"><span data-stu-id="e050c-178">Database mirroring is paused, or under high-performance mode, the mirror database is significantly behind the principal database.</span></span> <span data-ttu-id="e050c-179">(Solo modello di recupero con registrazione completa)</span><span class="sxs-lookup"><span data-stu-id="e050c-179">(Full recovery model only)</span></span><br /><br /> <span data-ttu-id="e050c-180">Per altre informazioni, vedere [Mirroring del database &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-180">For more information, see [Database Mirroring &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>|  
|<span data-ttu-id="e050c-181">6</span><span class="sxs-lookup"><span data-stu-id="e050c-181">6</span></span>|<span data-ttu-id="e050c-182">REPLICA</span><span class="sxs-lookup"><span data-stu-id="e050c-182">REPLICATION</span></span>|<span data-ttu-id="e050c-183">Durante le repliche transazionali, le transazioni significative per le pubblicazioni non sono ancora state recapitate al database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e050c-183">During transactional replications, transactions relevant to the publications are still undelivered to the distribution database.</span></span> <span data-ttu-id="e050c-184">(Solo modello di recupero con registrazione completa)</span><span class="sxs-lookup"><span data-stu-id="e050c-184">(Full recovery model only)</span></span><br /><br /> <span data-ttu-id="e050c-185">Per informazioni sulla replica transazionale, vedere [SQL Server Replication](../../relational-databases/replication/sql-server-replication.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-185">For information about transactional replication, see [SQL Server Replication](../../relational-databases/replication/sql-server-replication.md).</span></span>|  
|<span data-ttu-id="e050c-186">7</span><span class="sxs-lookup"><span data-stu-id="e050c-186">7</span></span>|<span data-ttu-id="e050c-187">DATABASE_SNAPSHOT_CREATION</span><span class="sxs-lookup"><span data-stu-id="e050c-187">DATABASE_SNAPSHOT_CREATION</span></span>|<span data-ttu-id="e050c-188">Viene creato uno snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="e050c-188">A database snapshot is being created.</span></span> <span data-ttu-id="e050c-189">(Tutti i modelli di recupero)</span><span class="sxs-lookup"><span data-stu-id="e050c-189">(All recovery models)</span></span><br /><br /> <span data-ttu-id="e050c-190">Si tratta di una motivazione comune, e generalmente di breve durata, per il posticipo del troncamento del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-190">This is a routine, and typically brief, cause of delayed log truncation.</span></span>|  
|<span data-ttu-id="e050c-191">8</span><span class="sxs-lookup"><span data-stu-id="e050c-191">8</span></span>|<span data-ttu-id="e050c-192">LOG_SCAN</span><span class="sxs-lookup"><span data-stu-id="e050c-192">LOG_SCAN</span></span>|<span data-ttu-id="e050c-193">È in corso un'analisi del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-193">A log scan is occurring.</span></span> <span data-ttu-id="e050c-194">(Tutti i modelli di recupero)</span><span class="sxs-lookup"><span data-stu-id="e050c-194">(All recovery models)</span></span><br /><br /> <span data-ttu-id="e050c-195">Si tratta di una motivazione comune, e generalmente di breve durata, per il posticipo del troncamento del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-195">This is a routine, and typically brief, cause of delayed log truncation.</span></span>|  
|<span data-ttu-id="e050c-196">9</span><span class="sxs-lookup"><span data-stu-id="e050c-196">9</span></span>|<span data-ttu-id="e050c-197">AVAILABILITY_REPLICA</span><span class="sxs-lookup"><span data-stu-id="e050c-197">AVAILABILITY_REPLICA</span></span>|<span data-ttu-id="e050c-198">Una replica secondaria di un gruppo di disponibilità applica i record del log delle transazioni del database a un database secondario corrispondente.</span><span class="sxs-lookup"><span data-stu-id="e050c-198">A secondary replica of an availability group is applying transaction log records of this database to a corresponding secondary database.</span></span> <span data-ttu-id="e050c-199">(Modello di recupero con registrazione completa)</span><span class="sxs-lookup"><span data-stu-id="e050c-199">(Full recovery model)</span></span><br /><br /> <span data-ttu-id="e050c-200">Per ulteriori informazioni, vedere [Panoramica di Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-200">For more information, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md).</span></span>|  
|<span data-ttu-id="e050c-201">10</span><span class="sxs-lookup"><span data-stu-id="e050c-201">10</span></span>|-|<span data-ttu-id="e050c-202">Solo per uso interno</span><span class="sxs-lookup"><span data-stu-id="e050c-202">For internal use only</span></span>|  
|<span data-ttu-id="e050c-203">11</span><span class="sxs-lookup"><span data-stu-id="e050c-203">11</span></span>|-|<span data-ttu-id="e050c-204">Solo per uso interno</span><span class="sxs-lookup"><span data-stu-id="e050c-204">For internal use only</span></span>|  
|<span data-ttu-id="e050c-205">12</span><span class="sxs-lookup"><span data-stu-id="e050c-205">12</span></span>|-|<span data-ttu-id="e050c-206">Solo per uso interno</span><span class="sxs-lookup"><span data-stu-id="e050c-206">For internal use only</span></span>|  
|<span data-ttu-id="e050c-207">13</span><span class="sxs-lookup"><span data-stu-id="e050c-207">13</span></span>|<span data-ttu-id="e050c-208">OLDEST_PAGE</span><span class="sxs-lookup"><span data-stu-id="e050c-208">OLDEST_PAGE</span></span>|<span data-ttu-id="e050c-209">Se un database è configurato per l'utilizzo dei checkpoint indiretti, la pagina meno recente del database potrebbe essere meno recente dell'LSN checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e050c-209">If a database is configured to use indirect checkpoints, the oldest page on the database might be older than the checkpoint LSN.</span></span> <span data-ttu-id="e050c-210">In questo caso, la pagina meno recente può causare il posticipo del troncamento del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-210">In this case, the oldest page can delay log truncation.</span></span> <span data-ttu-id="e050c-211">(Tutti i modelli di recupero)</span><span class="sxs-lookup"><span data-stu-id="e050c-211">(All recovery models)</span></span><br /><br /> <span data-ttu-id="e050c-212">Per informazioni sui checkpoint indiretti, vedere [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-212">For information about indirect checkpoints, see [Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md).</span></span>|  
|<span data-ttu-id="e050c-213">14</span><span class="sxs-lookup"><span data-stu-id="e050c-213">14</span></span>|<span data-ttu-id="e050c-214">OTHER_TRANSIENT</span><span class="sxs-lookup"><span data-stu-id="e050c-214">OTHER_TRANSIENT</span></span>|<span data-ttu-id="e050c-215">Questo valore non è attualmente utilizzato.</span><span class="sxs-lookup"><span data-stu-id="e050c-215">This value is currently not used.</span></span>|  
|<span data-ttu-id="e050c-216">16</span><span class="sxs-lookup"><span data-stu-id="e050c-216">16</span></span>|<span data-ttu-id="e050c-217">XTP_CHECKPOINT</span><span class="sxs-lookup"><span data-stu-id="e050c-217">XTP_CHECKPOINT</span></span>|<span data-ttu-id="e050c-218">Quando un database ha un filegroup ottimizzato per la memoria, il log delle transazioni potrebbe non essere troncato finché non viene attivato il checkpoint automatico [!INCLUDE[hek_2](../../includes/hek-2-md.md)], che si verifica a ogni 512 MB di aumento della dimensioni del log.</span><span class="sxs-lookup"><span data-stu-id="e050c-218">When a database has a memory-optimized filegroup, the transaction log may not truncate until automatic [!INCLUDE[hek_2](../../includes/hek-2-md.md)] checkpoint is triggered (which happens at every 512 MB of log growth).</span></span><br /><br /> <span data-ttu-id="e050c-219">Nota: per troncare il log delle transazioni prima della dimensione di 512 MB, attivare manualmente il comando checkpoint nel database in questione.</span><span class="sxs-lookup"><span data-stu-id="e050c-219">Note: To truncate transaction log before 512 MB size, fire the Checkpoint command manually against the database in question.</span></span>|  
  
##  <a name="operations-that-can-be-minimally-logged"></a><a name="MinimallyLogged"></a><span data-ttu-id="e050c-220">Operazioni che possono essere registrate con registrazione minima</span><span class="sxs-lookup"><span data-stu-id="e050c-220">Operations That Can Be Minimally Logged</span></span>  
 <span data-ttu-id="e050c-221">La*registrazione minima* implica la registrazione nel log delle transazioni delle sole informazioni necessarie per il recupero della transazione stesse senza il supporto del recupero temporizzato.</span><span class="sxs-lookup"><span data-stu-id="e050c-221">*Minimal logging* involves logging only the information that is required to recover the transaction without supporting point-in-time recovery.</span></span> <span data-ttu-id="e050c-222">In questo argomento vengono identificate le operazioni con registrazione minima nel modello di recupero con registrazione minima delle operazioni bulk nonché nel modello di recupero con registrazione minima, ad eccezione dei momenti in cui è in esecuzione un backup.</span><span class="sxs-lookup"><span data-stu-id="e050c-222">This topic identifies the operations that are minimally logged under the bulk-logged recovery model (as well as under the simple recovery model, except when a backup is running).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e050c-223">La registrazione minima non è supportata dalle tabelle ottimizzate per la memoria.</span><span class="sxs-lookup"><span data-stu-id="e050c-223">Minimal logging is not supported for memory-optimized tables.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e050c-224">In base al modello di recupero con registrazione completa tutte le operazioni bulk vengono registrate per intero.</span><span class="sxs-lookup"><span data-stu-id="e050c-224">Under the full recovery model, all bulk operations are fully logged.</span></span> <span data-ttu-id="e050c-225">È tuttavia possibile ridurre al minimo la registrazione per un set di operazioni bulk passando temporaneamente il database al modello di recupero con registrazione minima delle operazioni bulk per le operazioni bulk.</span><span class="sxs-lookup"><span data-stu-id="e050c-225">However, you can minimize logging for a set of bulk operations by switching the database to the bulk-logged recovery model temporarily for bulk operations.</span></span> <span data-ttu-id="e050c-226">La registrazione minima è più efficiente della registrazione completa e riduce la possibilità che un'operazione bulk su larga scala esaurisca lo spazio disponibile per il log delle transazioni durante una transazione bulk.</span><span class="sxs-lookup"><span data-stu-id="e050c-226">Minimal logging is more efficient than full logging, and it reduces the possibility of a large-scale bulk operation filling the available transaction log space during a bulk transaction.</span></span> <span data-ttu-id="e050c-227">Se tuttavia il database viene danneggiato o perso durante la registrazione minima, non è possibile recuperarlo fino al punto di errore.</span><span class="sxs-lookup"><span data-stu-id="e050c-227">However, if the database is damaged or lost when minimal logging is in effect, you cannot recover the database to the point of failure.</span></span>  
  
 <span data-ttu-id="e050c-228">Per le operazioni seguenti, con registrazione completa nel modello di recupero con registrazione completa, è prevista la registrazione minima nel modello di recupero con registrazione minima e in quello con registrazione minima delle operazioni bulk:</span><span class="sxs-lookup"><span data-stu-id="e050c-228">The following operations, which are fully logged under the full recovery model, are minimally logged under the simple and bulk-logged recovery model:</span></span>  
  
-   <span data-ttu-id="e050c-229">Operazioni di importazione in blocco ([bcp](../../tools/bcp-utility.md), [BULK INSERT](/sql/t-sql/statements/bulk-insert-transact-sql) e [INSERT... SELECT](/sql/t-sql/statements/insert-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="e050c-229">Bulk import operations ([bcp](../../tools/bcp-utility.md), [BULK INSERT](/sql/t-sql/statements/bulk-insert-transact-sql), and [INSERT... SELECT](/sql/t-sql/statements/insert-transact-sql)).</span></span> <span data-ttu-id="e050c-230">Per ulteriori informazioni sui casi in cui viene eseguita la registrazione minima di un'importazione bulk in una tabella, vedere [Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md).</span><span class="sxs-lookup"><span data-stu-id="e050c-230">For more information about when bulk import into a table is minimally logged, see [Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e050c-231">Quando la replica transazionale è abilitata, le operazioni BULK INSERT vengono registrate completamente persino nel modello di recupero con registrazione minima delle operazioni bulk.</span><span class="sxs-lookup"><span data-stu-id="e050c-231">When transactional replication is enabled, BULK INSERT operations are fully logged even under the Bulk Logged recovery model.</span></span>  
  
-   <span data-ttu-id="e050c-232">Operazioni SELECT [into](/sql/t-sql/queries/select-into-clause-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="e050c-232">SELECT [INTO](/sql/t-sql/queries/select-into-clause-transact-sql) operations.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e050c-233">Quando la replica transazionale è abilitata, le operazioni SELECT INTO vengono registrate completamente persino nel modello di recupero con registrazione minima delle operazioni bulk.</span><span class="sxs-lookup"><span data-stu-id="e050c-233">When transactional replication is enabled, SELECT INTO operations are fully logged even under the Bulk Logged recovery model.</span></span>  
  
-   <span data-ttu-id="e050c-234">Aggiornamenti parziali a tipi di dati di valori di grandi dimensioni eseguiti mediante la clausola .WRITE nell'istruzione [UPDATE](/sql/t-sql/queries/update-transact-sql) quando si inseriscono o si aggiungono nuovi dati.</span><span class="sxs-lookup"><span data-stu-id="e050c-234">Partial updates to large value data types, using the .WRITE clause in the [UPDATE](/sql/t-sql/queries/update-transact-sql) statement when inserting or appending new data.</span></span> <span data-ttu-id="e050c-235">Si noti che la registrazione minima non viene utilizzata per l'aggiornamento di valori esistenti.</span><span class="sxs-lookup"><span data-stu-id="e050c-235">Note that minimal logging is not used when existing values are updated.</span></span> <span data-ttu-id="e050c-236">Per altre informazioni sui tipi di dati per valori di grandi dimensioni, vedere [Tipi di dati &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e050c-236">For more information about large value data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql).</span></span>  
  
-   <span data-ttu-id="e050c-237">Istruzioni [WRITETEXT](/sql/t-sql/queries/writetext-transact-sql) e [UPDATETEXT](/sql/t-sql/queries/updatetext-transact-sql) quando si inseriscono o accodano nuovi dati nelle colonne del `text` tipo di dati, `ntext` e `image` .</span><span class="sxs-lookup"><span data-stu-id="e050c-237">[WRITETEXT](/sql/t-sql/queries/writetext-transact-sql) and [UPDATETEXT](/sql/t-sql/queries/updatetext-transact-sql) statements when inserting or appending new data into the `text`, `ntext`, and `image` data type columns.</span></span> <span data-ttu-id="e050c-238">Si noti che la registrazione minima non viene utilizzata per l'aggiornamento di valori esistenti.</span><span class="sxs-lookup"><span data-stu-id="e050c-238">Note that minimal logging is not used when existing values are updated.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e050c-239">Poiché le istruzioni WRITETEXT e UPDATETEXT sono deprecate, è consigliabile evitare di utilizzarle nelle nuove applicazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-239">The WRITETEXT and UPDATETEXT statements are deprecated, so you should avoid using them in new applications.</span></span>  
  
-   <span data-ttu-id="e050c-240">Se il database viene impostato sul modello di recupero con registrazione minima o con registrazione delle operazioni bulk, verrà eseguita la registrazione minima di alcune operazioni DDL sugli indici indipendentemente dal fatto che l'operazione venga eseguita online o offline.</span><span class="sxs-lookup"><span data-stu-id="e050c-240">If the database is set to the simple or bulk-logged recovery model, some index DDL operations are minimally logged whether the operation is executed offline or online.</span></span> <span data-ttu-id="e050c-241">Le operazioni sugli indici con registrazione minima sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="e050c-241">The minimally logged index operations are as follows:</span></span>  
  
    -   <span data-ttu-id="e050c-242">Operazioni[CREATE INDEX](/sql/t-sql/statements/create-index-transact-sql) (incluse le viste indicizzate).</span><span class="sxs-lookup"><span data-stu-id="e050c-242">[CREATE INDEX](/sql/t-sql/statements/create-index-transact-sql) operations (including indexed views).</span></span>  
  
    -   <span data-ttu-id="e050c-243">Operazioni[ALTER INDEX](/sql/t-sql/statements/alter-index-transact-sql) REBUILD o DBCC DBREINDEX.</span><span class="sxs-lookup"><span data-stu-id="e050c-243">[ALTER INDEX](/sql/t-sql/statements/alter-index-transact-sql) REBUILD or DBCC DBREINDEX operations.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e050c-244">Poiché l'istruzione DBCC DBREINDEX è deprecata, è consigliabile evitare di utilizzarla nelle nuove applicazioni.</span><span class="sxs-lookup"><span data-stu-id="e050c-244">The DBCC DBREINDEX statement is deprecated so you should avoid using it in new applications.</span></span>  
  
    -   <span data-ttu-id="e050c-245">Ricompilazione del nuovo heap DROP INDEX (se pertinente).</span><span class="sxs-lookup"><span data-stu-id="e050c-245">DROP INDEX new heap rebuild (if applicable).</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="e050c-246"> Durante un'operazione [DROP INDEX](/sql/t-sql/statements/drop-index-transact-sql) per la deallocazione delle pagine di un indice viene eseguita sempre la registrazione completa.</span><span class="sxs-lookup"><span data-stu-id="e050c-246">Index page deallocation during a [DROP INDEX](/sql/t-sql/statements/drop-index-transact-sql) operation is always fully logged.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="e050c-247">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="e050c-247">Related Tasks</span></span>  
 `Managing the transaction log`  
  
-   [<span data-ttu-id="e050c-248">Gestione delle dimensioni del file di log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-248">Manage the Size of the Transaction Log File</span></span>](manage-the-size-of-the-transaction-log-file.md)  
  
-   [<span data-ttu-id="e050c-249">Risolvere i problemi relativi a un log delle transazioni completo &#40;Errore di SQL Server 9002&#41;</span><span class="sxs-lookup"><span data-stu-id="e050c-249">Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;</span></span>](troubleshoot-a-full-transaction-log-sql-server-error-9002.md)  
  
 <span data-ttu-id="e050c-250">**Backup del log delle transazioni (modello di recupero con registrazione completa)**</span><span class="sxs-lookup"><span data-stu-id="e050c-250">**Backing Up the Transaction Log (Full Recovery Model)**</span></span>  
  
-   [<span data-ttu-id="e050c-251">Eseguire il backup di un log delle transazioni &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e050c-251">Back Up a Transaction Log &#40;SQL Server&#41;</span></span>](../backup-restore/back-up-a-transaction-log-sql-server.md)  
  
 <span data-ttu-id="e050c-252">**Ripristino del log delle transazioni (modello di recupero con registrazione completa)**</span><span class="sxs-lookup"><span data-stu-id="e050c-252">**Restoring the Transaction Log (Full Recovery Model)**</span></span>  
  
-  [<span data-ttu-id="e050c-253">Ripristinare un backup del log delle transazioni</span><span class="sxs-lookup"><span data-stu-id="e050c-253">Restore a Transaction Log Backup</span></span>](../backup-restore/restore-a-transaction-log-backup-sql-server.md)   
  
## <a name="see-also"></a><span data-ttu-id="e050c-254">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e050c-254">See Also</span></span>  
 <span data-ttu-id="e050c-255">[Controllo della durabilità delle transazioni](control-transaction-durability.md) </span><span class="sxs-lookup"><span data-stu-id="e050c-255">[Control Transaction Durability](control-transaction-durability.md) </span></span>  
 <span data-ttu-id="e050c-256">[Prerequisiti per la registrazione minima nell'importazione bulk](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md) </span><span class="sxs-lookup"><span data-stu-id="e050c-256">[Prerequisites for Minimal Logging in Bulk Import](../import-export/prerequisites-for-minimal-logging-in-bulk-import.md) </span></span>  
 <span data-ttu-id="e050c-257">[Backup e ripristino di database SQL Server](../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="e050c-257">[Back Up and Restore of SQL Server Databases](../backup-restore/back-up-and-restore-of-sql-server-databases.md) </span></span>  
 <span data-ttu-id="e050c-258">[Checkpoint di database &#40;SQL Server&#41;](database-checkpoints-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e050c-258">[Database Checkpoints &#40;SQL Server&#41;](database-checkpoints-sql-server.md) </span></span>  
 <span data-ttu-id="e050c-259">[Visualizzare o modificare le proprietà di un database](../databases/view-or-change-the-properties-of-a-database.md) </span><span class="sxs-lookup"><span data-stu-id="e050c-259">[View or Change the Properties of a Database](../databases/view-or-change-the-properties-of-a-database.md) </span></span>  
 [<span data-ttu-id="e050c-260">Modelli di recupero &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e050c-260">Recovery Models &#40;SQL Server&#41;</span></span>](../backup-restore/recovery-models-sql-server.md)  
  
  
