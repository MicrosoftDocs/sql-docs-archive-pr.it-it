---
title: Destinazione di Event Tracing for Windows| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xevents
ms.topic: conceptual
helpviewer_keywords:
- event tracing for windows target
- ETW target
- targets [SQL Server extended events], event tracing for windows target
ms.assetid: ca2bb295-b7f6-49c3-91ed-0ad4c39f89d5
author: rothja
ms.author: jroth
ms.openlocfilehash: 55f247af30b5278f614b6505a94266cc07ec6c54
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624728"
---
# <a name="event-tracing-for-windows-target"></a><span data-ttu-id="8b07f-102">destinazione di Event Tracing for Windows</span><span class="sxs-lookup"><span data-stu-id="8b07f-102">Event Tracing for Windows Target</span></span>
  <span data-ttu-id="8b07f-103">Prima di utilizzare Event Tracing for Windows (ETW) come destinazione, è consigliabile acquisire familiarità con tale funzionalità.</span><span class="sxs-lookup"><span data-stu-id="8b07f-103">Before you use Event Tracing for Windows (ETW) as a target, we recommend that you have a working knowledge of ETW.</span></span> <span data-ttu-id="8b07f-104">L'analisi ETW è utilizzata in abbinamento a Eventi estesi o come un consumer di eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-104">ETW tracing is either used together with Extended Events or as an Extended Events event consumer.</span></span> <span data-ttu-id="8b07f-105">I collegamenti esterni seguenti rappresentano un punto iniziale per ottenere informazioni di base su ETW:</span><span class="sxs-lookup"><span data-stu-id="8b07f-105">The following external links provide a starting point for obtaining background information about ETW:</span></span>  
  
-   [<span data-ttu-id="8b07f-106">Eventi di Windows</span><span class="sxs-lookup"><span data-stu-id="8b07f-106">Windows Events</span></span>](https://go.microsoft.com/fwlink/?LinkId=92380)  
  
-   [<span data-ttu-id="8b07f-107">Migliorare il debug e la regolazione delle prestazioni con ETW</span><span class="sxs-lookup"><span data-stu-id="8b07f-107">Improve Debugging And Performance Tuning With ETW</span></span>](https://go.microsoft.com/fwlink/?LinkId=92381)  
  
 <span data-ttu-id="8b07f-108">Sebbene possa essere aggiunta a numerose sessioni, la destinazione ETW è una destinazione singleton.</span><span class="sxs-lookup"><span data-stu-id="8b07f-108">The ETW target is a singleton target, although the target can be added to many sessions.</span></span> <span data-ttu-id="8b07f-109">Se un evento viene generato in più sessioni, verrà propagato alla destinazione ETW solo una volta per ogni occorrenza.</span><span class="sxs-lookup"><span data-stu-id="8b07f-109">If an event is raised on many sessions, the event will only be propagated to the ETW target one time per event occurrence.</span></span> <span data-ttu-id="8b07f-110">Il motore di Eventi estesi è limitato a un'unica istanza per processo.</span><span class="sxs-lookup"><span data-stu-id="8b07f-110">The Extended Events engine is limited to a single instance per process.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8b07f-111">Affinché la destinazione ETW funzioni, l'account di avvio del servizio [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] deve essere membro del gruppo Performance Log Users.</span><span class="sxs-lookup"><span data-stu-id="8b07f-111">For the ETW target to work, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Service startup account must be a member of the Performance Log Users group.</span></span>  
  
 <span data-ttu-id="8b07f-112">La configurazione degli eventi presente in una sessione ETW è controllata dal processo che ospita il motore di Eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-112">The configuration of the events present in an ETW session is controlled by the process that hosts the Extended Events engine.</span></span> <span data-ttu-id="8b07f-113">Il motore controlla gli eventi da generare e le condizioni che devono essere soddisfatte perché l'evento si verifichi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-113">The engine controls which events to raise and what conditions must be met for an event to occur.</span></span>  
  
 <span data-ttu-id="8b07f-114">Dopo avere eseguito un'associazione a una sessione di Eventi estesi, il che allega per la prima volta la destinazione ETW per la durata di un processo, la destinazione ETW apre una sola sessione ETW sul provider [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="8b07f-114">After binding to an Extended Events session, which attaches the ETW target for the first time during the lifetime of a process, the ETW target opens a single ETW session on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="8b07f-115">Se una sessione ETW esiste già, la destinazione ETW ottiene un riferimento alla sessione esistente.</span><span class="sxs-lookup"><span data-stu-id="8b07f-115">If an ETW session already exists, the ETW target obtains a reference to the existing session.</span></span> <span data-ttu-id="8b07f-116">Questa sessione ETW è condivisa in tutte le istanze [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] su un dato computer.</span><span class="sxs-lookup"><span data-stu-id="8b07f-116">This ETW session is shared across all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instances on a given computer.</span></span> <span data-ttu-id="8b07f-117">Questa sessione ETW riceve tutti gli eventi da sessioni che possiedono la destinazione ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-117">This ETW session receives all the events from sessions that have the ETW target.</span></span>  
  
 <span data-ttu-id="8b07f-118">Poiché ETW ha bisogno che i provider siano abilitati per utilizzare gli eventi e trasmetterli verso il basso a ETW, tutti i pacchetti di Eventi estesi sono attivati nella sessione.</span><span class="sxs-lookup"><span data-stu-id="8b07f-118">Because ETW needs providers to be enabled to consume events and flow them down to the ETW, all Extended Events packages are enabled on the session.</span></span> <span data-ttu-id="8b07f-119">Quando un evento è generato, la destinazione ETW invia l'evento alla sessione sulla quale è abilitato il provider per l'evento.</span><span class="sxs-lookup"><span data-stu-id="8b07f-119">When an event is fired, the ETW target sends the event to the session on which the provider for the event is enabled.</span></span>  
  
 <span data-ttu-id="8b07f-120">La destinazione ETW supporta la pubblicazione sincrona di eventi sul thread che genera l'evento.</span><span class="sxs-lookup"><span data-stu-id="8b07f-120">The ETW target supports synchronous publishing of events on the thread that raises the event.</span></span> <span data-ttu-id="8b07f-121">Tale destinazione tuttavia non supporta la pubblicazione asincrona di eventi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-121">However, the ETW target does not support asynchronous event publishing.</span></span>  
  
 <span data-ttu-id="8b07f-122">La destinazione ETW non supporta il controllo da controller ETW esterni, ad esempio Logman.exe.</span><span class="sxs-lookup"><span data-stu-id="8b07f-122">The ETW target does not support control from external ETW controllers such as Logman.exe.</span></span> <span data-ttu-id="8b07f-123">Per produrre tracce di ETW, una sessione dell'evento deve essere creata con la destinazione ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-123">To produce ETW traces, an event session must be created with the ETW target.</span></span> <span data-ttu-id="8b07f-124">Per altre informazioni, vedere [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8b07f-124">For more information, see [CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8b07f-125">Abilitando la destinazione ETW, viene creata una sessione ETW denominata XE_DEFAULT_ETW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="8b07f-125">Enabling the ETW target creates an ETW session that is named XE_DEFAULT_ETW_SESSION.</span></span> <span data-ttu-id="8b07f-126">Se esiste già una sessione con il nome XE_DEFAULT_ETW_SESSION, viene utilizzata senza la modifica di alcuna proprietà della sessione esistente.</span><span class="sxs-lookup"><span data-stu-id="8b07f-126">If a session with the name XE_DEFAULT_ETW_SESSION already exists, it is used without modifying any properties of the existing session.</span></span> <span data-ttu-id="8b07f-127">La sessione XE_DEFAULT_ETW_SESSION viene condivisa tra tutte le istanze di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8b07f-127">The XE_DEFAULT_ETW_SESSION is shared between all instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8b07f-128">Dopo aver avviato XE_DEFAULT_ETW_SESSION, è necessario arrestarla tramite un controller ETW, quale lo strumento Logman.</span><span class="sxs-lookup"><span data-stu-id="8b07f-128">After you start the XE_DEFAULT_ETW_SESSION, you must stop it by using an ETW controller, such as the Logman tool.</span></span> <span data-ttu-id="8b07f-129">Ad esempio, è possibile eseguire il comando seguente al prompt dei comandi: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span><span class="sxs-lookup"><span data-stu-id="8b07f-129">For example, you can run the following command at the command prompt: `logman stop XE_DEFAULT_ETW_SESSION -ets`.</span></span>  
  
 <span data-ttu-id="8b07f-130">Nella tabella seguente vengono descritte le opzioni disponibili per la configurazione della destinazione ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-130">The following table describes the available options for configuring the ETW target.</span></span>  
  
|<span data-ttu-id="8b07f-131">Opzione</span><span class="sxs-lookup"><span data-stu-id="8b07f-131">Option</span></span>|<span data-ttu-id="8b07f-132">Valori consentiti</span><span class="sxs-lookup"><span data-stu-id="8b07f-132">Allowed values</span></span>|<span data-ttu-id="8b07f-133">Descrizione</span><span class="sxs-lookup"><span data-stu-id="8b07f-133">Description</span></span>|  
|------------|--------------------|-----------------|  
|<span data-ttu-id="8b07f-134">default_xe_session_name</span><span class="sxs-lookup"><span data-stu-id="8b07f-134">default_xe_session_name</span></span>|<span data-ttu-id="8b07f-135">Qualsiasi stringa contenente fino a 256 caratteri.</span><span class="sxs-lookup"><span data-stu-id="8b07f-135">Any string up to 256 characters.</span></span> <span data-ttu-id="8b07f-136">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="8b07f-136">This value is optional.</span></span>|<span data-ttu-id="8b07f-137">Nome della sessione di Eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-137">The Extended Events session name.</span></span> <span data-ttu-id="8b07f-138">Per impostazione predefinita è XE_DEFAULT_ETW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="8b07f-138">By default, this is XE_DEFAULT_ETW_SESSION.</span></span>|  
|<span data-ttu-id="8b07f-139">default_etw_session_logfile_path</span><span class="sxs-lookup"><span data-stu-id="8b07f-139">default_etw_session_logfile_path</span></span>|<span data-ttu-id="8b07f-140">Qualsiasi stringa contenente fino a 256 caratteri.</span><span class="sxs-lookup"><span data-stu-id="8b07f-140">Any string up to 256 characters.</span></span> <span data-ttu-id="8b07f-141">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="8b07f-141">This value is optional.</span></span>|<span data-ttu-id="8b07f-142">Percorso del file di log per la sessione di Eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-142">The path of the log file for the Extended Events session.</span></span> <span data-ttu-id="8b07f-143">Per impostazione predefinita è %TEMP%\ XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="8b07f-143">By default, this is %TEMP%\ XEEtw.etl.</span></span>|  
|<span data-ttu-id="8b07f-144">default_etw_session_logfile_size_mb</span><span class="sxs-lookup"><span data-stu-id="8b07f-144">default_etw_session_logfile_size_mb</span></span>|<span data-ttu-id="8b07f-145">Qualsiasi valore intero senza segno.</span><span class="sxs-lookup"><span data-stu-id="8b07f-145">Any unsigned integer.</span></span> <span data-ttu-id="8b07f-146">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="8b07f-146">This value is optional.</span></span>|<span data-ttu-id="8b07f-147">Dimensioni del file di log, in megabyte (MB), per la sessione di Eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-147">The log file size, in megabytes (MB), for the Extended Events session.</span></span> <span data-ttu-id="8b07f-148">Il valore predefinito è 20 MB.</span><span class="sxs-lookup"><span data-stu-id="8b07f-148">The default is 20 MB.</span></span>|  
|<span data-ttu-id="8b07f-149">default_etw_session_buffer_size_kb</span><span class="sxs-lookup"><span data-stu-id="8b07f-149">default_etw_session_buffer_size_kb</span></span>|<span data-ttu-id="8b07f-150">Qualsiasi valore intero senza segno.</span><span class="sxs-lookup"><span data-stu-id="8b07f-150">Any unsigned integer.</span></span> <span data-ttu-id="8b07f-151">Questo valore è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="8b07f-151">This value is optional.</span></span>|<span data-ttu-id="8b07f-152">Dimensioni del buffer in memoria, in kilobyte (MB), per la sessione di Eventi estesi.</span><span class="sxs-lookup"><span data-stu-id="8b07f-152">The in-memory buffer size, in kilobytes (KB), for the Extended Events session.</span></span> <span data-ttu-id="8b07f-153">Il valore predefinito è 128 MB.</span><span class="sxs-lookup"><span data-stu-id="8b07f-153">The default is 128 KB.</span></span>|  
|<span data-ttu-id="8b07f-154">retries</span><span class="sxs-lookup"><span data-stu-id="8b07f-154">retries</span></span>|<span data-ttu-id="8b07f-155">Qualsiasi valore intero senza segno.</span><span class="sxs-lookup"><span data-stu-id="8b07f-155">Any unsigned integer.</span></span>|<span data-ttu-id="8b07f-156">Numero di tentativi di pubblicazione dell'evento al sottosistema ETW prima di eliminare l'evento.</span><span class="sxs-lookup"><span data-stu-id="8b07f-156">The number of times to retry publishing the event to the ETW subsystem before dropping the event.</span></span> <span data-ttu-id="8b07f-157">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="8b07f-157">The default is 0.</span></span>|  
  
 <span data-ttu-id="8b07f-158">La configurazione di queste impostazioni è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="8b07f-158">Configuring these settings is optional.</span></span> <span data-ttu-id="8b07f-159">La destinazione ETW utilizza valori predefiniti per queste impostazioni.</span><span class="sxs-lookup"><span data-stu-id="8b07f-159">The ETW target uses default values for these settings.</span></span>  
  
 <span data-ttu-id="8b07f-160">La destinazione ETW è responsabile per:</span><span class="sxs-lookup"><span data-stu-id="8b07f-160">The ETW target is responsible for:</span></span>  
  
-   <span data-ttu-id="8b07f-161">Creazione della sessione ETW predefinita.</span><span class="sxs-lookup"><span data-stu-id="8b07f-161">Creating the default ETW session.</span></span>  
  
-   <span data-ttu-id="8b07f-162">Registrazione di tutti i pacchetti di Eventi estesi con ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-162">Registering all Extended Events packages with ETW.</span></span> <span data-ttu-id="8b07f-163">Ciò assicura che gli eventi non siano eliminati da ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-163">This ensures that events are not dropped by ETW.</span></span>  
  
-   <span data-ttu-id="8b07f-164">Gestione dell'invio del flusso di eventi a ETW.</span><span class="sxs-lookup"><span data-stu-id="8b07f-164">Managing the flow of events to ETW.</span></span> <span data-ttu-id="8b07f-165">La destinazione ETW crea un evento ETW con i dati di Eventi estesi e lo invia alla sessione ETW appropriata.</span><span class="sxs-lookup"><span data-stu-id="8b07f-165">The ETW target creates an ETW event with Extended Events data and sends it to the appropriate ETW session.</span></span> <span data-ttu-id="8b07f-166">Se l'evento è più grande della dimensione del buffer o se i dati non possono adattarsi a un evento ETW, ETW suddivide l'evento in frammenti.</span><span class="sxs-lookup"><span data-stu-id="8b07f-166">If the event is larger than the buffer size, or data cannot fit in one ETW event, ETW splits the event into fragments.</span></span>  
  
-   <span data-ttu-id="8b07f-167">Conservazione dei pacchetti di Eventi estesi sempre abilitata.</span><span class="sxs-lookup"><span data-stu-id="8b07f-167">Keeping Extended Events packages enabled at all times.</span></span>  
  
 <span data-ttu-id="8b07f-168">I seguenti percorsi predefiniti dei file sono utilizzati da ETW:</span><span class="sxs-lookup"><span data-stu-id="8b07f-168">The following default file locations are used by ETW:</span></span>  
  
-   <span data-ttu-id="8b07f-169">Il percorso del file di output per ETW è %TEMP%\XEEtw.etl.</span><span class="sxs-lookup"><span data-stu-id="8b07f-169">The ETW output file is in %TEMP%\XEEtw.etl.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="8b07f-170">Impossibile modificare il percorso del file dopo l'inizio della prima sessione.</span><span class="sxs-lookup"><span data-stu-id="8b07f-170">The file path cannot be changed after the first session starts.</span></span>  
  
-   <span data-ttu-id="8b07f-171">I file Managed Object Format (MOF) si trovano in *\<your install path>* \Microsoft SQL Server\Shared.</span><span class="sxs-lookup"><span data-stu-id="8b07f-171">Managed Object Format (MOF) files are in *\<your install path>* \Microsoft SQL Server\Shared.</span></span> <span data-ttu-id="8b07f-172">Per altre informazioni, vedere [Managed Object Format (MOF)](https://go.microsoft.com/fwlink/?LinkId=92851) su MSDN.</span><span class="sxs-lookup"><span data-stu-id="8b07f-172">For more information, see [Managed Object Format](https://go.microsoft.com/fwlink/?LinkId=92851) on MSDN.</span></span>  
  
## <a name="adding-the-target-to-a-session"></a><span data-ttu-id="8b07f-173">Aggiunta della destinazione a una sessione</span><span class="sxs-lookup"><span data-stu-id="8b07f-173">Adding the Target to a Session</span></span>  
 <span data-ttu-id="8b07f-174">Per aggiungere la destinazione ETW a una sessione di Eventi estesi, è necessario includere l'istruzione seguente quando si crea o modifica una sessione eventi:</span><span class="sxs-lookup"><span data-stu-id="8b07f-174">To add the ETW target to an Extended Events session, you must include the following statement when you create or alter an event session:</span></span>  
  
```  
ADD TARGET package0.etw_classic_sync_target  
```  
  
 <span data-ttu-id="8b07f-175">Per altre informazioni su un esempio completo che mostra come usare la destinazione ETW e come visualizzare i dati, vedere [Monitorare l'attività del sistema mediante gli eventi estesi](monitor-system-activity-using-extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="8b07f-175">For more information about a full example that shows how to use the ETW target, including how to view the data, see [Monitor System Activity Using Extended Events](monitor-system-activity-using-extended-events.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8b07f-176">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="8b07f-176">See Also</span></span>  
 <span data-ttu-id="8b07f-177">[Destinazioni degli eventi estesi di SQL Server](../../database-engine/sql-server-extended-events-targets.md) </span><span class="sxs-lookup"><span data-stu-id="8b07f-177">[SQL Server Extended Events Targets](../../database-engine/sql-server-extended-events-targets.md) </span></span>  
 <span data-ttu-id="8b07f-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8b07f-178">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span></span>  
 <span data-ttu-id="8b07f-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8b07f-179">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span></span>  
 [<span data-ttu-id="8b07f-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8b07f-180">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-event-session-transact-sql)  
  
  
