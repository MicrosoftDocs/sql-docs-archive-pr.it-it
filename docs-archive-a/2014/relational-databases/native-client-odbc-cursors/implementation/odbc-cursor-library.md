---
title: Libreria di cursori ODBC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626773"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="15ae7-102">Libreria di cursori ODBC</span><span class="sxs-lookup"><span data-stu-id="15ae7-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="15ae7-103">Alcuni driver ODBC supportano solo le impostazioni predefinite del cursore. questi driver non supportano anche le operazioni di cursore posizionate, ad esempio **SQLSetPos**.</span><span class="sxs-lookup"><span data-stu-id="15ae7-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="15ae7-104">La libreria di cursori ODBC è un componente di Microsoft Data Access Components (MDAC) utilizzato per implementare cursori a blocchi o statici in un driver che generalmente non li supporta.</span><span class="sxs-lookup"><span data-stu-id="15ae7-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="15ae7-105">La libreria di cursori implementa anche le istruzioni UPDATE e DELETE posizionate e **SQLSetPos** per i cursori creati.</span><span class="sxs-lookup"><span data-stu-id="15ae7-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="15ae7-106">La libreria di cursori ODBC viene implementata come livello tra Gestione driver ODBC e il driver ODBC.</span><span class="sxs-lookup"><span data-stu-id="15ae7-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="15ae7-107">Se la libreria viene caricata, a questa, e non al driver, vengono indirizzati tutti i comandi correlati al cursore.</span><span class="sxs-lookup"><span data-stu-id="15ae7-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="15ae7-108">La libreria di cursori implementa un cursore mediante il recupero dell'intero set di risultati dal driver sottostante e la memorizzazione nella cache del client del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15ae7-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="15ae7-109">Quando si utilizza la libreria di cursori ODBC, nell'applicazione sono disponibili solo le funzionalità di cursore della libreria di cursori e non funzionalità di cursore aggiuntive del driver sottostante.</span><span class="sxs-lookup"><span data-stu-id="15ae7-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="15ae7-110">Con il driver ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client non esiste l'esigenza di utilizzare la libreria di cursori ODBC, in quanto il driver supporta un numero maggiore di funzionalità di cursore rispetto alla libreria.</span><span class="sxs-lookup"><span data-stu-id="15ae7-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="15ae7-111">L'unico motivo per utilizzare la libreria di cursori ODBC con il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client è dato dal fatto che il driver implementa il supporto dei cursori tramite i cursori del server e i cursori del server non supportano tutte le istruzioni SQL.</span><span class="sxs-lookup"><span data-stu-id="15ae7-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="15ae7-112">È pertanto consigliabile utilizzare la libreria di cursori ODBC ogni volta che si richiede un cursore statico con stored procedure, batch o istruzioni SQL contenenti COMPUTE, COMPUTE BY, FOR BROWSE o INTO.</span><span class="sxs-lookup"><span data-stu-id="15ae7-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="15ae7-113">È tuttavia necessario prestare attenzione nell'utilizzo della libreria in quanto memorizza nella cache del client l'intero set di risultati con conseguente impiego di grandi quantità di memoria e rallentamento delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="15ae7-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="15ae7-114">Un'applicazione richiama la libreria di cursori in base alla connessione utilizzando [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) per impostare l'attributo di connessione SQL_ATTR_ODBC_CURSORS prima della connessione a un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="15ae7-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="15ae7-115">L'attributo SQL_ATTR_ODBC_CURSORS può essere impostato su uno di tre valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="15ae7-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="15ae7-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="15ae7-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="15ae7-117">Quando questa opzione è impostata con il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native client, la libreria di cursori ODBC sostituisce il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supporto del cursore nativo del driver ODBC di Native Client.</span><span class="sxs-lookup"><span data-stu-id="15ae7-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="15ae7-118">Solo i tipi di cursore supportati dalla libreria di cursori possono essere utilizzati per la connessione. Non è invece possibile utilizzare i cursori server a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="15ae7-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="15ae7-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="15ae7-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="15ae7-120">Quando questa opzione è impostata, per la connessione è possibile utilizzare tutto il supporto del cursore nativo del [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client.</span><span class="sxs-lookup"><span data-stu-id="15ae7-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="15ae7-121">Non è possibile utilizzare la libreria di cursori ODBC.</span><span class="sxs-lookup"><span data-stu-id="15ae7-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="15ae7-122">Tutti i cursori vengono implementati come cursori server.</span><span class="sxs-lookup"><span data-stu-id="15ae7-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="15ae7-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="15ae7-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="15ae7-124">Quando questa opzione è impostata, l'effetto è identico a quello SQL_CUR_USE_DRIVER se utilizzato con il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client.</span><span class="sxs-lookup"><span data-stu-id="15ae7-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="15ae7-125">Al momento della connessione, gestione driver ODBC verifica se il driver ODBC a cui si è connessi supporta l'opzione SQL_FETCH_PRIOR di [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span><span class="sxs-lookup"><span data-stu-id="15ae7-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="15ae7-126">Se il driver non supporta l'opzione, Gestione driver ODBC carica la libreria di cursori ODBC.</span><span class="sxs-lookup"><span data-stu-id="15ae7-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="15ae7-127">In caso contrario, Gestione driver ODBC non carica la libreria in questione e l'applicazione utilizza il supporto nativo del driver.</span><span class="sxs-lookup"><span data-stu-id="15ae7-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="15ae7-128">Poiché il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client supporta SQL_FETCH_PRIOR, gestione driver ODBC non carica la libreria di cursori ODBC.</span><span class="sxs-lookup"><span data-stu-id="15ae7-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="15ae7-129">La libreria di cursori consente alle applicazioni di utilizzare più istruzioni attive in una connessione, nonché cursori scorrevoli aggiornabili.</span><span class="sxs-lookup"><span data-stu-id="15ae7-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="15ae7-130">Per il supporto di tale funzionalità è necessario caricare la libreria di cursori.</span><span class="sxs-lookup"><span data-stu-id="15ae7-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="15ae7-131">Utilizzare [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) per specificare la modalità di utilizzo della libreria di cursori e [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) per specificare le dimensioni del tipo di cursore, della concorrenza e del set di righe.</span><span class="sxs-lookup"><span data-stu-id="15ae7-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15ae7-132">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="15ae7-132">See Also</span></span>  
 [<span data-ttu-id="15ae7-133">Modalità di implementazione dei cursori</span><span class="sxs-lookup"><span data-stu-id="15ae7-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
