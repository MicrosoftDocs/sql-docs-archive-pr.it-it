---
title: Conversioni da SQL a C | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635541"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="a94d7-102">Conversioni dai tipi di dati SQL ai tipi di dati C</span><span class="sxs-lookup"><span data-stu-id="a94d7-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="a94d7-103">Nella tabella seguente sono elencati i problemi da prendere in considerazione durante le conversioni dai tipi date/time di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ai tipi C.</span><span class="sxs-lookup"><span data-stu-id="a94d7-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="a94d7-104">Conversioni</span><span class="sxs-lookup"><span data-stu-id="a94d7-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="a94d7-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="a94d7-105">SQL_C_DATE</span></span>|<span data-ttu-id="a94d7-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="a94d7-106">SQL_C_TIME</span></span>|<span data-ttu-id="a94d7-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="a94d7-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="a94d7-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="a94d7-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="a94d7-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="a94d7-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="a94d7-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="a94d7-110">SQL_C_BINARY</span></span>|<span data-ttu-id="a94d7-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="a94d7-111">SQL_C_CHAR</span></span>|<span data-ttu-id="a94d7-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="a94d7-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="a94d7-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="a94d7-113">SQL_CHAR</span></span>|<span data-ttu-id="a94d7-114">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="a94d7-114">2,3,4,5</span></span>|<span data-ttu-id="a94d7-115">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="a94d7-115">2,3,6,7,8</span></span>|<span data-ttu-id="a94d7-116">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="a94d7-116">2,3,9,10,11</span></span>|<span data-ttu-id="a94d7-117">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="a94d7-117">2,3,6,7</span></span>|<span data-ttu-id="a94d7-118">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="a94d7-118">2,3,9,10,11</span></span>|<span data-ttu-id="a94d7-119">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-119">1</span></span>|<span data-ttu-id="a94d7-120">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-120">1</span></span>|<span data-ttu-id="a94d7-121">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-121">1</span></span>|  
|<span data-ttu-id="a94d7-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="a94d7-122">SQL_WCHAR</span></span>|<span data-ttu-id="a94d7-123">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="a94d7-123">2,3,4,5</span></span>|<span data-ttu-id="a94d7-124">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="a94d7-124">2,3,6,7,8</span></span>|<span data-ttu-id="a94d7-125">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="a94d7-125">2,3,9,10,11</span></span>|<span data-ttu-id="a94d7-126">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="a94d7-126">2,3,6,7</span></span>|<span data-ttu-id="a94d7-127">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="a94d7-127">2,3,9,10,11</span></span>|<span data-ttu-id="a94d7-128">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-128">1</span></span>|<span data-ttu-id="a94d7-129">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-129">1</span></span>|<span data-ttu-id="a94d7-130">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-130">1</span></span>|  
|<span data-ttu-id="a94d7-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="a94d7-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="a94d7-132">OK</span><span class="sxs-lookup"><span data-stu-id="a94d7-132">OK</span></span>|<span data-ttu-id="a94d7-133">12</span><span class="sxs-lookup"><span data-stu-id="a94d7-133">12</span></span>|<span data-ttu-id="a94d7-134">13</span><span class="sxs-lookup"><span data-stu-id="a94d7-134">13</span></span>|<span data-ttu-id="a94d7-135">12</span><span class="sxs-lookup"><span data-stu-id="a94d7-135">12</span></span>|<span data-ttu-id="a94d7-136">13, 23</span><span class="sxs-lookup"><span data-stu-id="a94d7-136">13,23</span></span>|<span data-ttu-id="a94d7-137">14</span><span class="sxs-lookup"><span data-stu-id="a94d7-137">14</span></span>|<span data-ttu-id="a94d7-138">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-138">16</span></span>|<span data-ttu-id="a94d7-139">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-139">16</span></span>|  
|<span data-ttu-id="a94d7-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="a94d7-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="a94d7-141">12</span><span class="sxs-lookup"><span data-stu-id="a94d7-141">12</span></span>|<span data-ttu-id="a94d7-142">8</span><span class="sxs-lookup"><span data-stu-id="a94d7-142">8</span></span>|<span data-ttu-id="a94d7-143">15</span><span class="sxs-lookup"><span data-stu-id="a94d7-143">15</span></span>|<span data-ttu-id="a94d7-144">OK</span><span class="sxs-lookup"><span data-stu-id="a94d7-144">OK</span></span>|<span data-ttu-id="a94d7-145">10, 23</span><span class="sxs-lookup"><span data-stu-id="a94d7-145">10,23</span></span>|<span data-ttu-id="a94d7-146">17</span><span class="sxs-lookup"><span data-stu-id="a94d7-146">17</span></span>|<span data-ttu-id="a94d7-147">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-147">16</span></span>|<span data-ttu-id="a94d7-148">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-148">16</span></span>|  
|<span data-ttu-id="a94d7-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="a94d7-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="a94d7-150">18</span><span class="sxs-lookup"><span data-stu-id="a94d7-150">18</span></span>|<span data-ttu-id="a94d7-151">7, 8</span><span class="sxs-lookup"><span data-stu-id="a94d7-151">7,8</span></span>|<span data-ttu-id="a94d7-152">OK</span><span class="sxs-lookup"><span data-stu-id="a94d7-152">OK</span></span>|<span data-ttu-id="a94d7-153">7</span><span class="sxs-lookup"><span data-stu-id="a94d7-153">7</span></span>|<span data-ttu-id="a94d7-154">23</span><span class="sxs-lookup"><span data-stu-id="a94d7-154">23</span></span>|<span data-ttu-id="a94d7-155">19</span><span class="sxs-lookup"><span data-stu-id="a94d7-155">19</span></span>|<span data-ttu-id="a94d7-156">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-156">16</span></span>|<span data-ttu-id="a94d7-157">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-157">16</span></span>|  
|<span data-ttu-id="a94d7-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="a94d7-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="a94d7-159">18, 22</span><span class="sxs-lookup"><span data-stu-id="a94d7-159">18,22</span></span>|<span data-ttu-id="a94d7-160">7, 8, 20</span><span class="sxs-lookup"><span data-stu-id="a94d7-160">7,8,20</span></span>|<span data-ttu-id="a94d7-161">20</span><span class="sxs-lookup"><span data-stu-id="a94d7-161">20</span></span>|<span data-ttu-id="a94d7-162">7, 20</span><span class="sxs-lookup"><span data-stu-id="a94d7-162">7,20</span></span>|<span data-ttu-id="a94d7-163">OK</span><span class="sxs-lookup"><span data-stu-id="a94d7-163">OK</span></span>|<span data-ttu-id="a94d7-164">21</span><span class="sxs-lookup"><span data-stu-id="a94d7-164">21</span></span>|<span data-ttu-id="a94d7-165">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-165">16</span></span>|<span data-ttu-id="a94d7-166">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="a94d7-167">Descrizione dei simboli</span><span class="sxs-lookup"><span data-stu-id="a94d7-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="a94d7-168">Simbolo</span><span class="sxs-lookup"><span data-stu-id="a94d7-168">Symbol</span></span>|<span data-ttu-id="a94d7-169">Significato</span><span class="sxs-lookup"><span data-stu-id="a94d7-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="a94d7-170">OK</span><span class="sxs-lookup"><span data-stu-id="a94d7-170">OK</span></span>|<span data-ttu-id="a94d7-171">Nessun problema di conversione.</span><span class="sxs-lookup"><span data-stu-id="a94d7-171">No conversion issues.</span></span>|  
|<span data-ttu-id="a94d7-172">1</span><span class="sxs-lookup"><span data-stu-id="a94d7-172">1</span></span>|<span data-ttu-id="a94d7-173">Si applicano le regole precedenti a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a94d7-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="a94d7-174">2</span><span class="sxs-lookup"><span data-stu-id="a94d7-174">2</span></span>|<span data-ttu-id="a94d7-175">Gli spazi iniziali e finali vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="a94d7-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="a94d7-176">3</span><span class="sxs-lookup"><span data-stu-id="a94d7-176">3</span></span>|<span data-ttu-id="a94d7-177">Il valore stringa viene analizzato in un tipo date, time, timezone o timezoneoffset e consente un massimo di 9 cifre per i secondi frazionari.</span><span class="sxs-lookup"><span data-stu-id="a94d7-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="a94d7-178">Se viene analizzato un tipo di dati timezoneoffset, il tipo time viene convertito al tipo timezone del client.</span><span class="sxs-lookup"><span data-stu-id="a94d7-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="a94d7-179">Se si verifica un errore durante la conversione, viene generato un record di diagnostica con SQLSTATE 22018 e il messaggio "overflow del campo DateTime".</span><span class="sxs-lookup"><span data-stu-id="a94d7-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="a94d7-180">4</span><span class="sxs-lookup"><span data-stu-id="a94d7-180">4</span></span>|<span data-ttu-id="a94d7-181">Se il valore non è di un tipo date, timestamp o timestampoffset valido, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22018 e il messaggio "Carattere non valido per la specifica del cast".</span><span class="sxs-lookup"><span data-stu-id="a94d7-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="a94d7-182">5</span><span class="sxs-lookup"><span data-stu-id="a94d7-182">5</span></span>|<span data-ttu-id="a94d7-183">Se il valore time è diverso da zero, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 01S07 e il messaggio "Troncamento frazionario".</span><span class="sxs-lookup"><span data-stu-id="a94d7-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="a94d7-184">6</span><span class="sxs-lookup"><span data-stu-id="a94d7-184">6</span></span>|<span data-ttu-id="a94d7-185">Se il valore non è un tipo time, timestamp o timestampoffset valido, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22018 e il messaggio "Carattere non valido per la specifica del cast".</span><span class="sxs-lookup"><span data-stu-id="a94d7-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="a94d7-186">7</span><span class="sxs-lookup"><span data-stu-id="a94d7-186">7</span></span>|<span data-ttu-id="a94d7-187">Il componente relativo alla data viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="a94d7-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="a94d7-188">8</span><span class="sxs-lookup"><span data-stu-id="a94d7-188">8</span></span>|<span data-ttu-id="a94d7-189">Se i secondi frazionari sono diversi da zero, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 01S07 e il messaggio "Troncamento frazionario".</span><span class="sxs-lookup"><span data-stu-id="a94d7-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="a94d7-190">9</span><span class="sxs-lookup"><span data-stu-id="a94d7-190">9</span></span>|<span data-ttu-id="a94d7-191">Se il valore non è un tipo date, time, timestamp o timestampoffset valido, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22018 e il messaggio "Carattere non valido per la specifica del cast".</span><span class="sxs-lookup"><span data-stu-id="a94d7-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="a94d7-192">10</span><span class="sxs-lookup"><span data-stu-id="a94d7-192">10</span></span>|<span data-ttu-id="a94d7-193">Se il valore è un tipo time valido, il componente date viene impostato sul valore date del client corrente.</span><span class="sxs-lookup"><span data-stu-id="a94d7-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="a94d7-194">11</span><span class="sxs-lookup"><span data-stu-id="a94d7-194">11</span></span>|<span data-ttu-id="a94d7-195">Se il valore è un tipo date valido, il componente time viene impostato su zero.</span><span class="sxs-lookup"><span data-stu-id="a94d7-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="a94d7-196">12</span><span class="sxs-lookup"><span data-stu-id="a94d7-196">12</span></span>|<span data-ttu-id="a94d7-197">Viene generato un record di diagnostica con SQLSTATE 07006 e il messaggio "Violazione dell'attributo del tipo di dati".</span><span class="sxs-lookup"><span data-stu-id="a94d7-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="a94d7-198">13</span><span class="sxs-lookup"><span data-stu-id="a94d7-198">13</span></span>|<span data-ttu-id="a94d7-199">L'ora è impostata su zero.</span><span class="sxs-lookup"><span data-stu-id="a94d7-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="a94d7-200">14</span><span class="sxs-lookup"><span data-stu-id="a94d7-200">14</span></span>|<span data-ttu-id="a94d7-201">Se il buffer non è grande abbastanza da contenere un valore SQL_DATE_STRUCT, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="a94d7-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="a94d7-202">15</span><span class="sxs-lookup"><span data-stu-id="a94d7-202">15</span></span>|<span data-ttu-id="a94d7-203">Il valore date viene impostato sul valore date del client corrente.</span><span class="sxs-lookup"><span data-stu-id="a94d7-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="a94d7-204">16</span><span class="sxs-lookup"><span data-stu-id="a94d7-204">16</span></span>|<span data-ttu-id="a94d7-205">Se il buffer non è grande abbastanza da contenere il valore stringa convertito, ma solo i secondi frazionari, si verifica il troncamento, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 01004 e il messaggio "Troncamento a destra della stringa di dati".</span><span class="sxs-lookup"><span data-stu-id="a94d7-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="a94d7-206">Se il buffer non presenta dimensioni sufficienti a contenere il valore stringa senza troncamento dei componenti date, time o offset, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="a94d7-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="a94d7-207">Si noti che per i tipi date e timestampoffset, non è possibile che si verifichi l'errore con identificativo SQLSTATE 01004 perché la parte all'estrema destra della stringa convertita non contiene secondi frazionari.</span><span class="sxs-lookup"><span data-stu-id="a94d7-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="a94d7-208">Un eventuale troncamento determinerà pertanto una perdita dei dati.</span><span class="sxs-lookup"><span data-stu-id="a94d7-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="a94d7-209">17</span><span class="sxs-lookup"><span data-stu-id="a94d7-209">17</span></span>|<span data-ttu-id="a94d7-210">Se il buffer non presenta dimensioni sufficienti a contenere un valore SQL_SS_TIME2_STRUCT, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="a94d7-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="a94d7-211">18</span><span class="sxs-lookup"><span data-stu-id="a94d7-211">18</span></span>|<span data-ttu-id="a94d7-212">Se il valore time è diverso da zero, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 01S07 e il messaggio "Troncamento frazionario".</span><span class="sxs-lookup"><span data-stu-id="a94d7-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="a94d7-213">19</span><span class="sxs-lookup"><span data-stu-id="a94d7-213">19</span></span>|<span data-ttu-id="a94d7-214">Se il tipo di dati del server è datetime o smalldatetime, il valore corrisponde al formato wire TDS sotto forma di valore a 4 byte per smalldatetime e a 8 byte per datetime.</span><span class="sxs-lookup"><span data-stu-id="a94d7-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="a94d7-215">Se il tipo di dati del server è datetime2, il valore viene restituito come SQL_TIMESTAMP_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="a94d7-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="a94d7-216">Se il buffer non è di dimensioni sufficienti a contenere il valore restituito, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="a94d7-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="a94d7-217">20</span><span class="sxs-lookup"><span data-stu-id="a94d7-217">20</span></span>|<span data-ttu-id="a94d7-218">Viene effettuata la conversione dell'ora nel fuso orario del client.</span><span class="sxs-lookup"><span data-stu-id="a94d7-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="a94d7-219">Se si verifica un errore durante questa conversione, viene generato un record di diagnostica con l'identificativo SQLSTATE 22008 e il messaggio "Overflow del campo Datetime".</span><span class="sxs-lookup"><span data-stu-id="a94d7-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="a94d7-220">21</span><span class="sxs-lookup"><span data-stu-id="a94d7-220">21</span></span>|<span data-ttu-id="a94d7-221">Se il buffer è grande abbastanza da contenere un valore SQL_SS_TIMESTAMPOFFSET_STRUCT, il valore viene restituito come tale.</span><span class="sxs-lookup"><span data-stu-id="a94d7-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="a94d7-222">In caso contrario, viene generato un record di diagnostica con l'identificativo di errore SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="a94d7-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="a94d7-223">22</span><span class="sxs-lookup"><span data-stu-id="a94d7-223">22</span></span>|<span data-ttu-id="a94d7-224">Il valore viene convertito al tipo timezone del client prima che il tipo date venga estratto.</span><span class="sxs-lookup"><span data-stu-id="a94d7-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="a94d7-225">Ciò garantisce coerenza con le altre conversioni con tipi di dati timestampoffset.</span><span class="sxs-lookup"><span data-stu-id="a94d7-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="a94d7-226">Se si verifica un errore durante questa conversione, viene generato un record di diagnostica con l'identificativo SQLSTATE 22008 e il messaggio "Overflow del campo Datetime".</span><span class="sxs-lookup"><span data-stu-id="a94d7-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="a94d7-227">Ciò potrebbe avere come conseguenza un valore date diverso da quello ottenuto dal semplice troncamento.</span><span class="sxs-lookup"><span data-stu-id="a94d7-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="a94d7-228">Nella tabella riportata in questo argomento sono descritte le conversioni tra il tipo restituito al client e il tipo presente nell'associazione.</span><span class="sxs-lookup"><span data-stu-id="a94d7-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="a94d7-229">Per i parametri di output, se il tipo di server specificato in SQLBindParameter non corrisponde al tipo effettivo sul server, viene eseguita una conversione implicita da parte del server e il tipo restituito al client corrisponderà al tipo specificato tramite SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="a94d7-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="a94d7-230">Questo può causare risultati di conversione imprevisti quando le regole di conversione del server sono diverse da quelle elencate nella tabella precedente.</span><span class="sxs-lookup"><span data-stu-id="a94d7-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="a94d7-231">Quando è ad esempio necessario specificare un valore date predefinito, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilizza 1900-1-1, anziché il valore date corrente.</span><span class="sxs-lookup"><span data-stu-id="a94d7-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a94d7-232">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a94d7-232">See Also</span></span>  
 [<span data-ttu-id="a94d7-233">Miglioramenti di data e ora &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="a94d7-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
