---
title: Modifiche della copia bulk per i tipi di data e ora avanzati (OLE DB e ODBC) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC, bulk copy operations
- bulk copy [ODBC], changes for date/time improvements
ms.assetid: c29e0f5e-9b3c-42b3-9856-755f4510832f
author: rothja
ms.author: jroth
ms.openlocfilehash: cbb9a03a5ef7a85be279d5b3a210fa24af61622f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628648"
---
# <a name="bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc"></a><span data-ttu-id="351a1-102">Modifiche della copia bulk per i tipi di data e ora migliorati (OLE DB e ODBC)</span><span class="sxs-lookup"><span data-stu-id="351a1-102">Bulk Copy Changes for Enhanced Date and Time Types (OLE DB and ODBC)</span></span>
  <span data-ttu-id="351a1-103">In questo argomento vengono descritti i miglioramenti apportati ai tipi di data/ora per supportare la funzionalità di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="351a1-103">This topic describes the date/time enhancements to support bulk copy functionality.</span></span> <span data-ttu-id="351a1-104">Le informazioni incluse in questo argomento sono valide sia per OLE DB sia per ODBC in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="351a1-104">The information in this topic is valid for both OLE DB and ODBC in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="format-files"></a><span data-ttu-id="351a1-105">File di formato</span><span class="sxs-lookup"><span data-stu-id="351a1-105">Format Files</span></span>  
 <span data-ttu-id="351a1-106">Nella tabella seguente viene descritto l'input utilizzato per specificare i tipi di data/ora e i nomi dei tipi di dati del file host corrispondenti quando si compilano file di formato in modo interattivo.</span><span class="sxs-lookup"><span data-stu-id="351a1-106">When building format files interactively, the following table describes the input used to specify date/time types and the corresponding host-file data type names.</span></span>  
  
|<span data-ttu-id="351a1-107">tipo di archiviazione di file</span><span class="sxs-lookup"><span data-stu-id="351a1-107">File storage type</span></span>|<span data-ttu-id="351a1-108">Tipo di dati del file host</span><span class="sxs-lookup"><span data-stu-id="351a1-108">Host file data type</span></span>|<span data-ttu-id="351a1-109">Risposta al messaggio di richiesta: "immettere il tipo di archiviazione di file del campo <field_name> [ \<default> ]:"</span><span class="sxs-lookup"><span data-stu-id="351a1-109">Response to the prompt: "Enter the file storage type of field <field_name> [\<default>]:"</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="351a1-110">Datetime</span><span class="sxs-lookup"><span data-stu-id="351a1-110">Datetime</span></span>|<span data-ttu-id="351a1-111">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="351a1-111">SQLDATETIME</span></span>|<span data-ttu-id="351a1-112">d</span><span class="sxs-lookup"><span data-stu-id="351a1-112">d</span></span>|  
|<span data-ttu-id="351a1-113">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="351a1-113">Smalldatetime</span></span>|<span data-ttu-id="351a1-114">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="351a1-114">SQLDATETIM4</span></span>|<span data-ttu-id="351a1-115">D</span><span class="sxs-lookup"><span data-stu-id="351a1-115">D</span></span>|  
|<span data-ttu-id="351a1-116">Data</span><span class="sxs-lookup"><span data-stu-id="351a1-116">Date</span></span>|<span data-ttu-id="351a1-117">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="351a1-117">SQLDATE</span></span>|<span data-ttu-id="351a1-118">de</span><span class="sxs-lookup"><span data-stu-id="351a1-118">de</span></span>|  
|<span data-ttu-id="351a1-119">Tempo</span><span class="sxs-lookup"><span data-stu-id="351a1-119">Time</span></span>|<span data-ttu-id="351a1-120">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="351a1-120">SQLTIME</span></span>|<span data-ttu-id="351a1-121">te</span><span class="sxs-lookup"><span data-stu-id="351a1-121">te</span></span>|  
|<span data-ttu-id="351a1-122">Datetime2</span><span class="sxs-lookup"><span data-stu-id="351a1-122">Datetime2</span></span>|<span data-ttu-id="351a1-123">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="351a1-123">SQLDATETIME2</span></span>|<span data-ttu-id="351a1-124">d2</span><span class="sxs-lookup"><span data-stu-id="351a1-124">d2</span></span>|  
|<span data-ttu-id="351a1-125">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="351a1-125">Datetimeoffset</span></span>|<span data-ttu-id="351a1-126">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="351a1-126">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="351a1-127">do</span><span class="sxs-lookup"><span data-stu-id="351a1-127">do</span></span>|  
  
 <span data-ttu-id="351a1-128">Il file XSD per i file di formato XML includerà le aggiunte seguenti:</span><span class="sxs-lookup"><span data-stu-id="351a1-128">The XML format file XSD will have the following additions:</span></span>  
  
```  
<xs:complexType name="SQLDATETIME2">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATETIMEOFFSET">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATE">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLTIME">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
```  
  
## <a name="character-data-files"></a><span data-ttu-id="351a1-129">File di dati di tipo carattere</span><span class="sxs-lookup"><span data-stu-id="351a1-129">Character Data Files</span></span>  
 <span data-ttu-id="351a1-130">Nei file di dati di tipo carattere i valori di data e ora vengono rappresentati come descritto nella sezione "formati di dati: stringhe e valori letterali" del [supporto dei tipi di dati](data-type-support-for-odbc-date-and-time-improvements.md) per i miglioramenti di data e ora ODBC per ODBC oppure del supporto dei tipi di [dati per OLE DB miglioramenti di data e ora](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md) per OLE DB.</span><span class="sxs-lookup"><span data-stu-id="351a1-130">In character data files, date and time values are represented as described in the "Data Formats: Strings and Literals" section of [Data Type Support for ODBC Date and Time Improvements](data-type-support-for-odbc-date-and-time-improvements.md) for ODBC, or of [Data Type Support for OLE DB Date and Time Improvements](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md) for OLE DB.</span></span>  
  
 <span data-ttu-id="351a1-131">Nei dati nativi nativi, i valori di data e ora per i quattro nuovi tipi sono rappresentati come rappresentazioni TDS con scala 7 (poiché si tratta del valore massimo supportato da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e i file di dati bcp non archiviano la scala di queste colonne).</span><span class="sxs-lookup"><span data-stu-id="351a1-131">In native data fles, date and time values for the four new types are represented as their TDS representations with a scale of 7 (because this is the maximum supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and bcp data files do not store the scale of these columns).</span></span> <span data-ttu-id="351a1-132">Non viene apportata alcuna modifica all'archiviazione del `datetime` tipo esistente e `smalldatetime` o delle relative rappresentazioni TDS (Tabular Data Stream).</span><span class="sxs-lookup"><span data-stu-id="351a1-132">There is no change to the storage of the existing `datetime` and `smalldatetime` type or their tabular data stream (TDS) representations.</span></span>  
  
 <span data-ttu-id="351a1-133">Di seguito vengono indicate le dimensioni dello spazio di archiviazione per i diversi tipi di archiviazione per OLE DB:</span><span class="sxs-lookup"><span data-stu-id="351a1-133">The storage sizes for the different storage types are as follows for OLE DB:</span></span>  
  
|<span data-ttu-id="351a1-134">tipo di archiviazione di file</span><span class="sxs-lookup"><span data-stu-id="351a1-134">File storage type</span></span>|<span data-ttu-id="351a1-135">Dimensioni dello spazio di archiviazione in byte</span><span class="sxs-lookup"><span data-stu-id="351a1-135">Storage size in bytes</span></span>|  
|-----------------------|---------------------------|  
|<span data-ttu-id="351a1-136">Datetime</span><span class="sxs-lookup"><span data-stu-id="351a1-136">datetime</span></span>|<span data-ttu-id="351a1-137">8</span><span class="sxs-lookup"><span data-stu-id="351a1-137">8</span></span>|  
|<span data-ttu-id="351a1-138">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="351a1-138">smalldatetime</span></span>|<span data-ttu-id="351a1-139">4</span><span class="sxs-lookup"><span data-stu-id="351a1-139">4</span></span>|  
|<span data-ttu-id="351a1-140">date</span><span class="sxs-lookup"><span data-stu-id="351a1-140">date</span></span>|<span data-ttu-id="351a1-141">3</span><span class="sxs-lookup"><span data-stu-id="351a1-141">3</span></span>|  
|<span data-ttu-id="351a1-142">time</span><span class="sxs-lookup"><span data-stu-id="351a1-142">time</span></span>|<span data-ttu-id="351a1-143">6</span><span class="sxs-lookup"><span data-stu-id="351a1-143">6</span></span>|  
|<span data-ttu-id="351a1-144">datetime2</span><span class="sxs-lookup"><span data-stu-id="351a1-144">datetime2</span></span>|<span data-ttu-id="351a1-145">9</span><span class="sxs-lookup"><span data-stu-id="351a1-145">9</span></span>|  
|<span data-ttu-id="351a1-146">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="351a1-146">datetimeoffset</span></span>|<span data-ttu-id="351a1-147">11</span><span class="sxs-lookup"><span data-stu-id="351a1-147">11</span></span>|  
  
 <span data-ttu-id="351a1-148">Di seguito vengono indicate le dimensioni per ODBC:</span><span class="sxs-lookup"><span data-stu-id="351a1-148">The sizes are as follows for ODBC.</span></span> <span data-ttu-id="351a1-149">Si noti che non è necessario archiviare la precisione in alcun file di formato o di dati, in quanto il file BCP.exe recupera sempre la precisione dal server.</span><span class="sxs-lookup"><span data-stu-id="351a1-149">Note that it is not necessary to store precision in either format or data files, because BCP.exe will always retrieve precision from the server.</span></span>  
  
|<span data-ttu-id="351a1-150">tipo di archiviazione di file</span><span class="sxs-lookup"><span data-stu-id="351a1-150">File storage type</span></span>|<span data-ttu-id="351a1-151">Dimensioni dello spazio di archiviazione in byte</span><span class="sxs-lookup"><span data-stu-id="351a1-151">Storage size in bytes</span></span>|<span data-ttu-id="351a1-152">Formato di archiviazione</span><span class="sxs-lookup"><span data-stu-id="351a1-152">Storage format</span></span>|  
|-----------------------|---------------------------|--------------------|  
|<span data-ttu-id="351a1-153">datetime (d)</span><span class="sxs-lookup"><span data-stu-id="351a1-153">datetime (d)</span></span>|<span data-ttu-id="351a1-154">8</span><span class="sxs-lookup"><span data-stu-id="351a1-154">8</span></span>|<span data-ttu-id="351a1-155">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-155">TDS</span></span>|  
|<span data-ttu-id="351a1-156">smalldatetime (D)</span><span class="sxs-lookup"><span data-stu-id="351a1-156">smalldatetime (D)</span></span>|<span data-ttu-id="351a1-157">4</span><span class="sxs-lookup"><span data-stu-id="351a1-157">4</span></span>|<span data-ttu-id="351a1-158">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-158">TDS</span></span>|  
|<span data-ttu-id="351a1-159">date (de)</span><span class="sxs-lookup"><span data-stu-id="351a1-159">date (de)</span></span>|<span data-ttu-id="351a1-160">3</span><span class="sxs-lookup"><span data-stu-id="351a1-160">3</span></span>|<span data-ttu-id="351a1-161">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-161">TDS</span></span>|  
|<span data-ttu-id="351a1-162">time (te)</span><span class="sxs-lookup"><span data-stu-id="351a1-162">time (te)</span></span>|<span data-ttu-id="351a1-163">6</span><span class="sxs-lookup"><span data-stu-id="351a1-163">6</span></span>|<span data-ttu-id="351a1-164">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-164">TDS</span></span>|  
|<span data-ttu-id="351a1-165">datetime2 (d2)</span><span class="sxs-lookup"><span data-stu-id="351a1-165">datetime2 (d2)</span></span>|<span data-ttu-id="351a1-166">9</span><span class="sxs-lookup"><span data-stu-id="351a1-166">9</span></span>|<span data-ttu-id="351a1-167">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-167">TDS</span></span>|  
|<span data-ttu-id="351a1-168">datetimeoffset (do)</span><span class="sxs-lookup"><span data-stu-id="351a1-168">datetimeoffset (do)</span></span>|<span data-ttu-id="351a1-169">11</span><span class="sxs-lookup"><span data-stu-id="351a1-169">11</span></span>|<span data-ttu-id="351a1-170">TDS</span><span class="sxs-lookup"><span data-stu-id="351a1-170">TDS</span></span>|  
  
## <a name="bcp-types-in-sqlnclih"></a><span data-ttu-id="351a1-171">Tipi BCP in sqlncli.h</span><span class="sxs-lookup"><span data-stu-id="351a1-171">BCP Types in sqlncli.h</span></span>  
 <span data-ttu-id="351a1-172">Di seguito vengono indicati i tipi definiti in sqlncli.h per l'utilizzo con le estensioni API BCP in ODBC.</span><span class="sxs-lookup"><span data-stu-id="351a1-172">The following types are defined in sqlncli.h to be used with the BCP API extensions to ODBC.</span></span> <span data-ttu-id="351a1-173">Questi tipi vengono passati con il parametro *eUserDataType* di IBCPSession::BCPColFmt in OLE DB.</span><span class="sxs-lookup"><span data-stu-id="351a1-173">These types are passed with the *eUserDataType* parameter of IBCPSession::BCPColFmt in OLE DB.</span></span>  
  
|<span data-ttu-id="351a1-174">tipo di archiviazione di file</span><span class="sxs-lookup"><span data-stu-id="351a1-174">File storage type</span></span>|<span data-ttu-id="351a1-175">Tipo di dati del file host</span><span class="sxs-lookup"><span data-stu-id="351a1-175">Host file data type</span></span>|<span data-ttu-id="351a1-176">Digitare sqlncli. h per l'utilizzo con IBCPSession:: BCPColFmt</span><span class="sxs-lookup"><span data-stu-id="351a1-176">Type in sqlncli.h for use with IBCPSession::BCPColFmt</span></span>|<span data-ttu-id="351a1-177">Valore</span><span class="sxs-lookup"><span data-stu-id="351a1-177">Value</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------|-----------|  
|<span data-ttu-id="351a1-178">Datetime</span><span class="sxs-lookup"><span data-stu-id="351a1-178">Datetime</span></span>|<span data-ttu-id="351a1-179">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="351a1-179">SQLDATETIME</span></span>|<span data-ttu-id="351a1-180">BCP_TYPE_SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="351a1-180">BCP_TYPE_SQLDATETIME</span></span>|<span data-ttu-id="351a1-181">0x3d</span><span class="sxs-lookup"><span data-stu-id="351a1-181">0x3d</span></span>|  
|<span data-ttu-id="351a1-182">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="351a1-182">Smalldatetime</span></span>|<span data-ttu-id="351a1-183">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="351a1-183">SQLDATETIM4</span></span>|<span data-ttu-id="351a1-184">BCP_TYPE_SQLDATETIME4</span><span class="sxs-lookup"><span data-stu-id="351a1-184">BCP_TYPE_SQLDATETIME4</span></span>|<span data-ttu-id="351a1-185">0x3a</span><span class="sxs-lookup"><span data-stu-id="351a1-185">0x3a</span></span>|  
|<span data-ttu-id="351a1-186">Data</span><span class="sxs-lookup"><span data-stu-id="351a1-186">Date</span></span>|<span data-ttu-id="351a1-187">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="351a1-187">SQLDATE</span></span>|<span data-ttu-id="351a1-188">BCP_TYPE_SQLDATE</span><span class="sxs-lookup"><span data-stu-id="351a1-188">BCP_TYPE_SQLDATE</span></span>|<span data-ttu-id="351a1-189">0x28</span><span class="sxs-lookup"><span data-stu-id="351a1-189">0x28</span></span>|  
|<span data-ttu-id="351a1-190">Tempo</span><span class="sxs-lookup"><span data-stu-id="351a1-190">Time</span></span>|<span data-ttu-id="351a1-191">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="351a1-191">SQLTIME</span></span>|<span data-ttu-id="351a1-192">BCP_TYPE_SQLTIME</span><span class="sxs-lookup"><span data-stu-id="351a1-192">BCP_TYPE_SQLTIME</span></span>|<span data-ttu-id="351a1-193">0x29</span><span class="sxs-lookup"><span data-stu-id="351a1-193">0x29</span></span>|  
|<span data-ttu-id="351a1-194">Datetime2</span><span class="sxs-lookup"><span data-stu-id="351a1-194">Datetime2</span></span>|<span data-ttu-id="351a1-195">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="351a1-195">SQLDATETIME2</span></span>|<span data-ttu-id="351a1-196">BCP_TYPE_SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="351a1-196">BCP_TYPE_SQLDATETIME2</span></span>|<span data-ttu-id="351a1-197">0x2a</span><span class="sxs-lookup"><span data-stu-id="351a1-197">0x2a</span></span>|  
|<span data-ttu-id="351a1-198">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="351a1-198">Datetimeoffset</span></span>|<span data-ttu-id="351a1-199">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="351a1-199">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="351a1-200">BCP_TYPE_SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="351a1-200">BCP_TYPE_SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="351a1-201">0x2b</span><span class="sxs-lookup"><span data-stu-id="351a1-201">0x2b</span></span>|  
  
## <a name="bcp-data-type-conversions"></a><span data-ttu-id="351a1-202">Conversioni dei tipi di dati BCP</span><span class="sxs-lookup"><span data-stu-id="351a1-202">BCP Data Type Conversions</span></span>  
 <span data-ttu-id="351a1-203">Nelle tabelle seguenti vengono fornite informazioni sulla conversione.</span><span class="sxs-lookup"><span data-stu-id="351a1-203">The following tables provide conversion information.</span></span>  
  
 <span data-ttu-id="351a1-204">**Nota per OLE DB** Le conversioni seguenti vengono eseguite da IBCPSession.</span><span class="sxs-lookup"><span data-stu-id="351a1-204">**OLE DB Note** The following conversions are performed by IBCPSession.</span></span> <span data-ttu-id="351a1-205">IRowsetFastLoad usa le conversioni OLE DB come definito in [Conversioni eseguite da client a server](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md).</span><span class="sxs-lookup"><span data-stu-id="351a1-205">IRowsetFastLoad uses OLE DB conversions as defined in [Conversions Performed from Client to Server](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md).</span></span> <span data-ttu-id="351a1-206">Si noti che i valori datetime vengono arrotondati a 1/300 di secondo, mentre per i valori smalldatetime i secondi vengono impostati su zero in seguito all'esecuzione delle conversioni client descritte di seguito.</span><span class="sxs-lookup"><span data-stu-id="351a1-206">Note that datetime values are rounded to 1/300th of a second and smalldatetime values have seconds set to zero after client conversions described below have been performed.</span></span> <span data-ttu-id="351a1-207">L'arrotondamento dei valori datetime viene applicato a ore e minuti, ma non alla data.</span><span class="sxs-lookup"><span data-stu-id="351a1-207">Datetime rounding propagates through hours and minutes, but not the date.</span></span>  
  
|<span data-ttu-id="351a1-208">A -></span><span class="sxs-lookup"><span data-stu-id="351a1-208">To --></span></span><br /><br /> <span data-ttu-id="351a1-209">Da</span><span class="sxs-lookup"><span data-stu-id="351a1-209">From</span></span>|<span data-ttu-id="351a1-210">Data</span><span class="sxs-lookup"><span data-stu-id="351a1-210">date</span></span>|<span data-ttu-id="351a1-211">time</span><span class="sxs-lookup"><span data-stu-id="351a1-211">time</span></span>|<span data-ttu-id="351a1-212">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="351a1-212">smalldatetime</span></span>|<span data-ttu-id="351a1-213">Datetime</span><span class="sxs-lookup"><span data-stu-id="351a1-213">datetime</span></span>|<span data-ttu-id="351a1-214">datetime2</span><span class="sxs-lookup"><span data-stu-id="351a1-214">datetime2</span></span>|<span data-ttu-id="351a1-215">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="351a1-215">datetimeoffset</span></span>|<span data-ttu-id="351a1-216">char</span><span class="sxs-lookup"><span data-stu-id="351a1-216">char</span></span>|<span data-ttu-id="351a1-217">wchar</span><span class="sxs-lookup"><span data-stu-id="351a1-217">wchar</span></span>|  
|------------------------|----------|----------|-------------------|--------------|---------------|--------------------|----------|-----------|  
|<span data-ttu-id="351a1-218">Data</span><span class="sxs-lookup"><span data-stu-id="351a1-218">Date</span></span>|<span data-ttu-id="351a1-219">1</span><span class="sxs-lookup"><span data-stu-id="351a1-219">1</span></span>|-|<span data-ttu-id="351a1-220">1,6</span><span class="sxs-lookup"><span data-stu-id="351a1-220">1,6</span></span>|<span data-ttu-id="351a1-221">1,6</span><span class="sxs-lookup"><span data-stu-id="351a1-221">1,6</span></span>|<span data-ttu-id="351a1-222">1,6</span><span class="sxs-lookup"><span data-stu-id="351a1-222">1,6</span></span>|<span data-ttu-id="351a1-223">1,5,6</span><span class="sxs-lookup"><span data-stu-id="351a1-223">1,5,6</span></span>|<span data-ttu-id="351a1-224">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-224">1,3</span></span>|<span data-ttu-id="351a1-225">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-225">1,3</span></span>|  
|<span data-ttu-id="351a1-226">Tempo</span><span class="sxs-lookup"><span data-stu-id="351a1-226">Time</span></span>|<span data-ttu-id="351a1-227">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-227">N/A</span></span>|<span data-ttu-id="351a1-228">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-228">1,10</span></span>|<span data-ttu-id="351a1-229">1,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-229">1,7,10</span></span>|<span data-ttu-id="351a1-230">1,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-230">1,7,10</span></span>|<span data-ttu-id="351a1-231">1,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-231">1,7,10</span></span>|<span data-ttu-id="351a1-232">1,5,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-232">1,5,7,10</span></span>|<span data-ttu-id="351a1-233">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-233">1,3</span></span>|<span data-ttu-id="351a1-234">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-234">1,3</span></span>|  
|<span data-ttu-id="351a1-235">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="351a1-235">Smalldatetime</span></span>|<span data-ttu-id="351a1-236">1,2</span><span class="sxs-lookup"><span data-stu-id="351a1-236">1,2</span></span>|<span data-ttu-id="351a1-237">1,4,10</span><span class="sxs-lookup"><span data-stu-id="351a1-237">1,4,10</span></span>|<span data-ttu-id="351a1-238">1</span><span class="sxs-lookup"><span data-stu-id="351a1-238">1</span></span>|<span data-ttu-id="351a1-239">1</span><span class="sxs-lookup"><span data-stu-id="351a1-239">1</span></span>|<span data-ttu-id="351a1-240">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-240">1,10</span></span>|<span data-ttu-id="351a1-241">1,5,10</span><span class="sxs-lookup"><span data-stu-id="351a1-241">1,5,10</span></span>|<span data-ttu-id="351a1-242">1,11</span><span class="sxs-lookup"><span data-stu-id="351a1-242">1,11</span></span>|<span data-ttu-id="351a1-243">1,11</span><span class="sxs-lookup"><span data-stu-id="351a1-243">1,11</span></span>|  
|<span data-ttu-id="351a1-244">Datetime</span><span class="sxs-lookup"><span data-stu-id="351a1-244">Datetime</span></span>|<span data-ttu-id="351a1-245">1,2</span><span class="sxs-lookup"><span data-stu-id="351a1-245">1,2</span></span>|<span data-ttu-id="351a1-246">1,4,10</span><span class="sxs-lookup"><span data-stu-id="351a1-246">1,4,10</span></span>|<span data-ttu-id="351a1-247">1,12</span><span class="sxs-lookup"><span data-stu-id="351a1-247">1,12</span></span>|<span data-ttu-id="351a1-248">1</span><span class="sxs-lookup"><span data-stu-id="351a1-248">1</span></span>|<span data-ttu-id="351a1-249">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-249">1,10</span></span>|<span data-ttu-id="351a1-250">1,5,10</span><span class="sxs-lookup"><span data-stu-id="351a1-250">1,5,10</span></span>|<span data-ttu-id="351a1-251">1,11</span><span class="sxs-lookup"><span data-stu-id="351a1-251">1,11</span></span>|<span data-ttu-id="351a1-252">1,11</span><span class="sxs-lookup"><span data-stu-id="351a1-252">1,11</span></span>|  
|<span data-ttu-id="351a1-253">Datetime2</span><span class="sxs-lookup"><span data-stu-id="351a1-253">Datetime2</span></span>|<span data-ttu-id="351a1-254">1,2</span><span class="sxs-lookup"><span data-stu-id="351a1-254">1,2</span></span>|<span data-ttu-id="351a1-255">1,4,10</span><span class="sxs-lookup"><span data-stu-id="351a1-255">1,4,10</span></span>|<span data-ttu-id="351a1-256">1, 10 (ODBC) 1, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-256">1,10 (ODBC)1,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-257">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-257">1,10</span></span>|<span data-ttu-id="351a1-258">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-258">1,10</span></span>|<span data-ttu-id="351a1-259">1,5,10</span><span class="sxs-lookup"><span data-stu-id="351a1-259">1,5,10</span></span>|<span data-ttu-id="351a1-260">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-260">1,3</span></span>|<span data-ttu-id="351a1-261">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-261">1,3</span></span>|  
|<span data-ttu-id="351a1-262">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="351a1-262">Datetimeoffset</span></span>|<span data-ttu-id="351a1-263">1,2,8</span><span class="sxs-lookup"><span data-stu-id="351a1-263">1,2,8</span></span>|<span data-ttu-id="351a1-264">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-264">1,4,8,10</span></span>|<span data-ttu-id="351a1-265">1,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-265">1,8,10</span></span>|<span data-ttu-id="351a1-266">1,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-266">1,8,10</span></span>|<span data-ttu-id="351a1-267">1,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-267">1,8,10</span></span>|<span data-ttu-id="351a1-268">1,10</span><span class="sxs-lookup"><span data-stu-id="351a1-268">1,10</span></span>|<span data-ttu-id="351a1-269">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-269">1,3</span></span>|<span data-ttu-id="351a1-270">1,3</span><span class="sxs-lookup"><span data-stu-id="351a1-270">1,3</span></span>|  
|<span data-ttu-id="351a1-271">char/wchar (date)</span><span class="sxs-lookup"><span data-stu-id="351a1-271">Char/wchar (date)</span></span>|<span data-ttu-id="351a1-272">9</span><span class="sxs-lookup"><span data-stu-id="351a1-272">9</span></span>|-|<span data-ttu-id="351a1-273">9, 6 (ODBC) 9, 6, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-273">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-274">9, 6 (ODBC) 9, 6, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-274">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-275">9,6</span><span class="sxs-lookup"><span data-stu-id="351a1-275">9,6</span></span>|<span data-ttu-id="351a1-276">9,5,6</span><span class="sxs-lookup"><span data-stu-id="351a1-276">9,5,6</span></span>|<span data-ttu-id="351a1-277">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-277">N/A</span></span>|<span data-ttu-id="351a1-278">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-278">N/A</span></span>|  
|<span data-ttu-id="351a1-279">char/wchar (time)</span><span class="sxs-lookup"><span data-stu-id="351a1-279">Char/wchar (time)</span></span>|-|<span data-ttu-id="351a1-280">9,10</span><span class="sxs-lookup"><span data-stu-id="351a1-280">9,10</span></span>|<span data-ttu-id="351a1-281">9, 7, 10 (ODBC) 9, 7, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-282">9, 7, 10 (ODBC) 9, 7, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span></span>|<span data-ttu-id="351a1-283">9,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-283">9,7,10</span></span>|<span data-ttu-id="351a1-284">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="351a1-284">9,5,7,10</span></span>|<span data-ttu-id="351a1-285">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-285">N/A</span></span>|<span data-ttu-id="351a1-286">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-286">N/A</span></span>|  
|<span data-ttu-id="351a1-287">char/wchar (datetime)</span><span class="sxs-lookup"><span data-stu-id="351a1-287">Char/wchar (datetime)</span></span>|<span data-ttu-id="351a1-288">9,2</span><span class="sxs-lookup"><span data-stu-id="351a1-288">9,2</span></span>|<span data-ttu-id="351a1-289">9,4,10</span><span class="sxs-lookup"><span data-stu-id="351a1-289">9,4,10</span></span>|<span data-ttu-id="351a1-290">9, 10 (ODBC) 9, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-290">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-291">9, 10 (ODBC) 9, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-291">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-292">9,10</span><span class="sxs-lookup"><span data-stu-id="351a1-292">9,10</span></span>|<span data-ttu-id="351a1-293">9,5,10</span><span class="sxs-lookup"><span data-stu-id="351a1-293">9,5,10</span></span>|<span data-ttu-id="351a1-294">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-294">N/A</span></span>|<span data-ttu-id="351a1-295">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-295">N/A</span></span>|  
|<span data-ttu-id="351a1-296">char/wchar (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="351a1-296">Char/wchar (datetimeoffset)</span></span>|<span data-ttu-id="351a1-297">9,2,8</span><span class="sxs-lookup"><span data-stu-id="351a1-297">9,2,8</span></span>|<span data-ttu-id="351a1-298">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-298">9,4,8,10</span></span>|<span data-ttu-id="351a1-299">9, 8, 10 (ODBC) 9, 8, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-300">9, 8, 10 (ODBC) 9, 8, 10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="351a1-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="351a1-301">9,8,10</span><span class="sxs-lookup"><span data-stu-id="351a1-301">9,8,10</span></span>|<span data-ttu-id="351a1-302">9,10</span><span class="sxs-lookup"><span data-stu-id="351a1-302">9,10</span></span>|<span data-ttu-id="351a1-303">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-303">N/A</span></span>|<span data-ttu-id="351a1-304">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-304">N/A</span></span>|  
  
#### <a name="key-to-symbols"></a><span data-ttu-id="351a1-305">Descrizione dei simboli</span><span class="sxs-lookup"><span data-stu-id="351a1-305">Key to Symbols</span></span>  
  
|<span data-ttu-id="351a1-306">Simbolo</span><span class="sxs-lookup"><span data-stu-id="351a1-306">Symbol</span></span>|<span data-ttu-id="351a1-307">Significato</span><span class="sxs-lookup"><span data-stu-id="351a1-307">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="351a1-308">Non viene supportata alcuna conversione.</span><span class="sxs-lookup"><span data-stu-id="351a1-308">No conversion is supported.</span></span><br /><br /> <span data-ttu-id="351a1-309">Viene generato un record di diagnostica ODBC con SQLSTATE 07006 e il messaggio "Violazione dell'attributo del tipo di dati".</span><span class="sxs-lookup"><span data-stu-id="351a1-309">An ODBC diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="351a1-310">1</span><span class="sxs-lookup"><span data-stu-id="351a1-310">1</span></span>|<span data-ttu-id="351a1-311">Se i dati specificati non sono validi, viene generato un record di diagnostica ODBC con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="351a1-311">If the data supplied is not valid, an ODBC  diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span> <span data-ttu-id="351a1-312">Per i valori datetimeoffset, la parte relativa all'ora deve essere compresa nell'intervallo supportato in seguito alla conversione in UTC, anche se non è necessaria alcuna conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="351a1-312">For datetimeoffset values, the time portion must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="351a1-313">Ciò è dovuto al fatto che TDS e il server in genere normalizzano l'ora nei valori datetimeoffset per UTC.</span><span class="sxs-lookup"><span data-stu-id="351a1-313">This is because TDS and the server always normalize the time in datetimeoffset values for UTC.</span></span> <span data-ttu-id="351a1-314">Di conseguenza, il client deve verificare che i componenti relativi all'ora siano compresi nell'intervallo supportato in seguito alla conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="351a1-314">So the client must check that time components are within the range supported after conversion to UTC.</span></span>|  
|<span data-ttu-id="351a1-315">2</span><span class="sxs-lookup"><span data-stu-id="351a1-315">2</span></span>|<span data-ttu-id="351a1-316">Il componente relativo all'ora viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="351a1-316">The time component is ignored.</span></span>|  
|<span data-ttu-id="351a1-317">3</span><span class="sxs-lookup"><span data-stu-id="351a1-317">3</span></span>|<span data-ttu-id="351a1-318">Per ODBC, se si verifica un troncamento con perdita di dati, viene generato un record di diagnostica con SQLSTATE 22001 e il messaggio "dati stringa, troncato a destra" il numero di cifre dei secondi frazionari (la scala) è determinato dalla dimensione della colonna di destinazione in base alla tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="351a1-318">For ODBC, If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and message 'String data, right truncated' The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="351a1-319">Per dimensioni di colonna maggiori dell'intervallo specificato nella tabella, si presuppone una scala di 7.</span><span class="sxs-lookup"><span data-stu-id="351a1-319">For column sizes larger than the range in the table, a scale of 7 is implied.</span></span> <span data-ttu-id="351a1-320">Questa conversione deve consentire fino a nove cifre per i secondi frazionari, il massimo consentito in ODBC.</span><span class="sxs-lookup"><span data-stu-id="351a1-320">This conversion should allow for up to nine fractional second digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="351a1-321">**Tipo:** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="351a1-321">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="351a1-322">**Scala prevista 0** 8</span><span class="sxs-lookup"><span data-stu-id="351a1-322">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="351a1-323">**Scala implicita 1.. 7** 10, 16</span><span class="sxs-lookup"><span data-stu-id="351a1-323">**Implied scale 1..7** 10,16</span></span><br /><br /> <br /><br /> <span data-ttu-id="351a1-324">**Tipo:** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="351a1-324">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="351a1-325">**Scala prevista 0:** 19</span><span class="sxs-lookup"><span data-stu-id="351a1-325">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="351a1-326">**Scala implicita 1.. 7:** 21.. 27</span><span class="sxs-lookup"><span data-stu-id="351a1-326">**Implied scale 1..7:** 21..27</span></span><br /><br /> <br /><br /> <span data-ttu-id="351a1-327">**Tipo:** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="351a1-327">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="351a1-328">**Scala prevista 0:** 26</span><span class="sxs-lookup"><span data-stu-id="351a1-328">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="351a1-329">**Scala implicita 1.. 7:** 28.. 34</span><span class="sxs-lookup"><span data-stu-id="351a1-329">**Implied scale 1..7:** 28..34</span></span><br /><br /> <span data-ttu-id="351a1-330">Per OLE DB, se si verifica un troncamento con perdita di dati, viene inserito un errore.</span><span class="sxs-lookup"><span data-stu-id="351a1-330">For OLE DB, if truncation with data loss occurs, an error is posted.</span></span> <span data-ttu-id="351a1-331">Per datetime2 il numero di cifre per i secondi frazionari, ovvero la scala, è determinato dalle dimensioni della colonna di destinazione in base alla tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="351a1-331">For datetime2, the number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="351a1-332">Per dimensioni di colonna maggiori dell'intervallo specificato nella tabella, si presuppone una scala 9.</span><span class="sxs-lookup"><span data-stu-id="351a1-332">For column sizes larger than the range in the table a scale of 9 is implied.</span></span> <span data-ttu-id="351a1-333">Questa conversione deve consentire fino a nove cifre per i secondi frazionari, il massimo consentito da OLE DB.</span><span class="sxs-lookup"><span data-stu-id="351a1-333">This conversion should allow for up to nine fractional second digits, the maximum allowed by OLE DB.</span></span><br /><br /> <span data-ttu-id="351a1-334">**Tipo:** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="351a1-334">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="351a1-335">**Scala prevista 0** 8</span><span class="sxs-lookup"><span data-stu-id="351a1-335">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="351a1-336">**Scala prevista 1..9** 1..9</span><span class="sxs-lookup"><span data-stu-id="351a1-336">**Implied scale 1..9** 1..9</span></span><br /><br /> <br /><br /> <span data-ttu-id="351a1-337">**Tipo:** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="351a1-337">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="351a1-338">**Scala prevista 0:** 19</span><span class="sxs-lookup"><span data-stu-id="351a1-338">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="351a1-339">**Scala prevista 1..9:** 21..29</span><span class="sxs-lookup"><span data-stu-id="351a1-339">**Implied scale 1..9:** 21..29</span></span><br /><br /> <br /><br /> <span data-ttu-id="351a1-340">**Tipo:** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="351a1-340">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="351a1-341">**Scala prevista 0:** 26</span><span class="sxs-lookup"><span data-stu-id="351a1-341">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="351a1-342">**Scala prevista 1..9:** 28..36</span><span class="sxs-lookup"><span data-stu-id="351a1-342">**Implied scale 1..9:** 28..36</span></span>|  
|<span data-ttu-id="351a1-343">4</span><span class="sxs-lookup"><span data-stu-id="351a1-343">4</span></span>|<span data-ttu-id="351a1-344">Il componente relativo alla data viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="351a1-344">The date component is ignored.</span></span>|  
|<span data-ttu-id="351a1-345">5</span><span class="sxs-lookup"><span data-stu-id="351a1-345">5</span></span>|<span data-ttu-id="351a1-346">Il fuso orario è impostato su UTC, ad esempio 00:00.</span><span class="sxs-lookup"><span data-stu-id="351a1-346">The timezone is set to UTC (for example, 00:00).</span></span>|  
|<span data-ttu-id="351a1-347">6</span><span class="sxs-lookup"><span data-stu-id="351a1-347">6</span></span>|<span data-ttu-id="351a1-348">L'ora è impostata su zero.</span><span class="sxs-lookup"><span data-stu-id="351a1-348">The time is set to zero.</span></span>|  
|<span data-ttu-id="351a1-349">7</span><span class="sxs-lookup"><span data-stu-id="351a1-349">7</span></span>|<span data-ttu-id="351a1-350">La data è impostata su 1900-01-01.</span><span class="sxs-lookup"><span data-stu-id="351a1-350">The date is set to 1900-01-01.</span></span>|  
|<span data-ttu-id="351a1-351">8</span><span class="sxs-lookup"><span data-stu-id="351a1-351">8</span></span>|<span data-ttu-id="351a1-352">La differenza di fuso orario viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="351a1-352">The timezone offset is ignored.</span></span>|  
|<span data-ttu-id="351a1-353">9</span><span class="sxs-lookup"><span data-stu-id="351a1-353">9</span></span>|<span data-ttu-id="351a1-354">La stringa viene analizzata e convertita in un valore date, datetime, datetimeoffset o time a seconda del primo carattere di punteggiatura rilevato e della presenza degli altri componenti.</span><span class="sxs-lookup"><span data-stu-id="351a1-354">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and presence of remaining components.</span></span> <span data-ttu-id="351a1-355">La stringa viene quindi convertita nel tipo di destinazione, in base alle regole indicate nella tabella alla fine di questo argomento per il tipo di origine individuato dal processo.</span><span class="sxs-lookup"><span data-stu-id="351a1-355">The string is then converted to the target type, following the rules in the table at the end of this topic for the source type discovered by this process.</span></span> <span data-ttu-id="351a1-356">Se i dati forniti non possono essere analizzati senza errore o se qualsiasi componente è al di fuori dell'intervallo consentito o non vi è conversione dal tipo del valore letterale al tipo di destinazione, viene inserito un errore (OLE DB) o viene generato un record di diagnostica ODBC con SQLSTATE 22018 e il messaggio "Carattere non valido per la specifica del cast".</span><span class="sxs-lookup"><span data-stu-id="351a1-356">If the data supplied cannot be parsed without error, or if any component part is outside the range allowed, or if there is no conversion from the literal type to target type, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="351a1-357">Per i parametri datetime e smalldatetime, se l'anno non è compreso nell'intervallo supportato da questi tipi, viene inserito un errore (OLE DB) o viene generato un record di diagnostica con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="351a1-357">For datetime and smalldatetime parameters, if the year is outside the range these types support, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="351a1-358">Per datetimeoffset, il valore deve essere compreso nell'intervallo supportato in seguito alla conversione in UTC, anche se non è necessaria alcuna conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="351a1-358">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="351a1-359">Ciò è dovuto al fatto che TDS e il server normalizzano sempre l'ora in valori datetimeoffset per UTC. Il client deve pertanto verificare che i componenti relativi all'ora siano compresi nell'intervallo supportato in seguito alla conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="351a1-359">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="351a1-360">Se il valore non è compreso nell'intervallo UTC supportato, viene inserito un errore (OLE DB) o viene generato un record di diagnostica con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="351a1-360">If the value is not within the supported UTC range, an error is posted (OLE DB), or an ODBC diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="351a1-361">10</span><span class="sxs-lookup"><span data-stu-id="351a1-361">10</span></span>|<span data-ttu-id="351a1-362">Se si verifica un troncamento con perdita di dati in una conversione da client a server, viene inserito un errore (OLE DB) o viene generato un record di diagnostica ODBC con SQLSTATE 22008 e il messaggio "Overflow del campo Datetime".</span><span class="sxs-lookup"><span data-stu-id="351a1-362">If truncation with data loss occurs on a client to server conversion, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="351a1-363">Questo errore si verifica anche se il valore non è incluso nell'intervallo che può essere rappresentato dall'intervallo UTC utilizzato dal server.</span><span class="sxs-lookup"><span data-stu-id="351a1-363">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span> <span data-ttu-id="351a1-364">Se si verifica un troncamento dei secondi o dei secondi frazionari in una conversione da server a client, viene generato solo un avviso.</span><span class="sxs-lookup"><span data-stu-id="351a1-364">If seconds or fractional seconds truncation occurs in a server to client conversion, there is only a warning.</span></span>|  
|<span data-ttu-id="351a1-365">11</span><span class="sxs-lookup"><span data-stu-id="351a1-365">11</span></span>|<span data-ttu-id="351a1-366">Se si verifica un troncamento con perdita di dati, viene generato un record di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="351a1-366">If truncation with data loss occurs, a diagnostic record is generated.</span></span><br /><br /> <span data-ttu-id="351a1-367">In una conversione da server a client, il record è un avviso (ODBC SQLSTATE S1000).</span><span class="sxs-lookup"><span data-stu-id="351a1-367">On a server-to-client conversion, this is a warning (ODBC SQLSTATE S1000).</span></span><br /><br /> <span data-ttu-id="351a1-368">In una conversione da client a server, il record è un errore (ODBC SQLSTATE 22001).</span><span class="sxs-lookup"><span data-stu-id="351a1-368">On a client-to-server conversion, this is an error (ODBC SQLSTATE 22001).</span></span>|  
|<span data-ttu-id="351a1-369">12</span><span class="sxs-lookup"><span data-stu-id="351a1-369">12</span></span>|<span data-ttu-id="351a1-370">I secondi vengono impostati su zero e i secondi frazionari vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="351a1-370">Seconds are set to zero and fractional seconds are discarded.</span></span> <span data-ttu-id="351a1-371">Non è possibile alcun errore di troncamento.</span><span class="sxs-lookup"><span data-stu-id="351a1-371">No truncation error is possible.</span></span>|  
|<span data-ttu-id="351a1-372">N/D</span><span class="sxs-lookup"><span data-stu-id="351a1-372">N/A</span></span>|<span data-ttu-id="351a1-373">Viene mantenuto il comportamento di [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="351a1-373">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="351a1-374">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="351a1-374">See Also</span></span>  
 <span data-ttu-id="351a1-375">[Miglioramenti di data e ora &#40;ODBC&#41;](date-and-time-improvements-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="351a1-375">[Date and Time Improvements &#40;ODBC&#41;](date-and-time-improvements-odbc.md) </span></span>  
 [<span data-ttu-id="351a1-376">Miglioramenti relativi a data e ora &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="351a1-376">Date and Time Improvements &#40;OLE DB&#41;</span></span>](../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)  
  
  
