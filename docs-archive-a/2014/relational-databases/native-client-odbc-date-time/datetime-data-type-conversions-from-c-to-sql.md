---
title: Conversioni da C a SQL | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], C to SQL
ms.assetid: 7ac098db-9147-4883-8da9-a58ab24a0d31
author: rothja
ms.author: jroth
ms.openlocfilehash: 2ec8856b9c516ff3693da2ebf1077289d414e589
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635544"
---
# <a name="conversions-from-c-to-sql"></a><span data-ttu-id="91239-102">Conversioni da tipi di dati C a tipi di dati SQL</span><span class="sxs-lookup"><span data-stu-id="91239-102">Conversions from C to SQL</span></span>
  <span data-ttu-id="91239-103">Questo argomento elenca i problemi da considerare quando si esegue la conversione da tipi C a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tipi di data/ora.</span><span class="sxs-lookup"><span data-stu-id="91239-103">This topic lists issues to consider when you convert from C types to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types.</span></span>  
  
 <span data-ttu-id="91239-104">Le conversioni descritte nella tabella seguente sono valide se effettuate sul client.</span><span class="sxs-lookup"><span data-stu-id="91239-104">The conversions described in the following table apply to conversions made on the client.</span></span> <span data-ttu-id="91239-105">Nei casi in cui il client specifica la precisione in secondi frazionari per un parametro che differisce da quello definito sul server, la conversione client potrebbe riuscire ma il server restituirà un errore durante la chiamata di `SQLExecute` o `SQLExecuteDirect`.</span><span class="sxs-lookup"><span data-stu-id="91239-105">In cases where the client specifies fractional second precision for a parameter that differs from that defined on the server, the client conversion might succeed but the server will return an error when `SQLExecute` or `SQLExecuteDirect` is called.</span></span> <span data-ttu-id="91239-106">In particolare, ODBC considera errore qualsiasi troncamento dei secondi frazionari, mentre il comportamento di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] prevede l'arrotondamento, utilizzato, ad esempio, quando si va da `datetime2(6)` a `datetime2(2)`.</span><span class="sxs-lookup"><span data-stu-id="91239-106">In particular, ODBC treats any truncation of fractional seconds as an error, whereas the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] behavior is to round; for example, rounding occurs when you go from `datetime2(6)` to `datetime2(2)`.</span></span> <span data-ttu-id="91239-107">I valori della colonna di tipo datetime vengono arrotondati a 1/300° di un secondo e le colonne smalldatetime contengono secondi impostati su zero dal server.</span><span class="sxs-lookup"><span data-stu-id="91239-107">Datetime column values are rounded to 1/300th of a second and smalldatetime columns have seconds set to zero by the server.</span></span>  
  
|||||||||  
|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="91239-108">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="91239-108">SQL_TYPE_DATE</span></span>|<span data-ttu-id="91239-109">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="91239-109">SQL_TYPE_TIME</span></span>|<span data-ttu-id="91239-110">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="91239-110">SQL_SS_TIME2</span></span>|<span data-ttu-id="91239-111">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="91239-111">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="91239-112">SQL_SS_TIMSTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="91239-112">SQL_SS_TIMSTAMPOFFSET</span></span>|<span data-ttu-id="91239-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="91239-113">SQL_CHAR</span></span>|<span data-ttu-id="91239-114">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="91239-114">SQL_WCHAR</span></span>|  
|<span data-ttu-id="91239-115">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="91239-115">SQL_C_DATE</span></span>|<span data-ttu-id="91239-116">1</span><span class="sxs-lookup"><span data-stu-id="91239-116">1</span></span>|-|-|<span data-ttu-id="91239-117">1,6</span><span class="sxs-lookup"><span data-stu-id="91239-117">1,6</span></span>|<span data-ttu-id="91239-118">1,5,6</span><span class="sxs-lookup"><span data-stu-id="91239-118">1,5,6</span></span>|<span data-ttu-id="91239-119">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-119">1,13</span></span>|<span data-ttu-id="91239-120">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-120">1,13</span></span>|  
|<span data-ttu-id="91239-121">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="91239-121">SQL_C_TIME</span></span>|-|<span data-ttu-id="91239-122">1</span><span class="sxs-lookup"><span data-stu-id="91239-122">1</span></span>|<span data-ttu-id="91239-123">1</span><span class="sxs-lookup"><span data-stu-id="91239-123">1</span></span>|<span data-ttu-id="91239-124">1,7</span><span class="sxs-lookup"><span data-stu-id="91239-124">1,7</span></span>|<span data-ttu-id="91239-125">1, 5, 7</span><span class="sxs-lookup"><span data-stu-id="91239-125">1,5,7</span></span>|<span data-ttu-id="91239-126">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-126">1,13</span></span>|<span data-ttu-id="91239-127">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-127">1,13</span></span>|  
|<span data-ttu-id="91239-128">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="91239-128">SQL_C_SS_TIME2</span></span>|-|<span data-ttu-id="91239-129">1,3</span><span class="sxs-lookup"><span data-stu-id="91239-129">1,3</span></span>|<span data-ttu-id="91239-130">1,10</span><span class="sxs-lookup"><span data-stu-id="91239-130">1,10</span></span>|<span data-ttu-id="91239-131">1,7</span><span class="sxs-lookup"><span data-stu-id="91239-131">1,7</span></span>|<span data-ttu-id="91239-132">1, 5, 7</span><span class="sxs-lookup"><span data-stu-id="91239-132">1,5,7</span></span>|<span data-ttu-id="91239-133">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-133">1,13</span></span>|<span data-ttu-id="91239-134">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-134">1,13</span></span>|  
|<span data-ttu-id="91239-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="91239-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span></span>|<span data-ttu-id="91239-136">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-136">N/A</span></span>|<span data-ttu-id="91239-137">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-137">N/A</span></span>|<span data-ttu-id="91239-138">1,10,11</span><span class="sxs-lookup"><span data-stu-id="91239-138">1,10,11</span></span>|<span data-ttu-id="91239-139">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-139">N/A</span></span>|<span data-ttu-id="91239-140">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-140">N/A</span></span>|<span data-ttu-id="91239-141">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-141">N/A</span></span>|<span data-ttu-id="91239-142">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-142">N/A</span></span>|  
|<span data-ttu-id="91239-143">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="91239-143">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="91239-144">1,2</span><span class="sxs-lookup"><span data-stu-id="91239-144">1,2</span></span>|<span data-ttu-id="91239-145">1,3,4</span><span class="sxs-lookup"><span data-stu-id="91239-145">1,3,4</span></span>|<span data-ttu-id="91239-146">1,4,10</span><span class="sxs-lookup"><span data-stu-id="91239-146">1,4,10</span></span>|<span data-ttu-id="91239-147">1,10</span><span class="sxs-lookup"><span data-stu-id="91239-147">1,10</span></span>|<span data-ttu-id="91239-148">1,5,10</span><span class="sxs-lookup"><span data-stu-id="91239-148">1,5,10</span></span>|<span data-ttu-id="91239-149">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-149">1,13</span></span>|<span data-ttu-id="91239-150">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-150">1,13</span></span>|  
|<span data-ttu-id="91239-151">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="91239-151">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="91239-152">1,2,8</span><span class="sxs-lookup"><span data-stu-id="91239-152">1,2,8</span></span>|<span data-ttu-id="91239-153">1,3,4,8</span><span class="sxs-lookup"><span data-stu-id="91239-153">1,3,4,8</span></span>|<span data-ttu-id="91239-154">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="91239-154">1,4,8,10</span></span>|<span data-ttu-id="91239-155">1,8,10</span><span class="sxs-lookup"><span data-stu-id="91239-155">1,8,10</span></span>|<span data-ttu-id="91239-156">1,10</span><span class="sxs-lookup"><span data-stu-id="91239-156">1,10</span></span>|<span data-ttu-id="91239-157">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-157">1,13</span></span>|<span data-ttu-id="91239-158">1,13</span><span class="sxs-lookup"><span data-stu-id="91239-158">1,13</span></span>|  
|<span data-ttu-id="91239-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="91239-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span></span>|<span data-ttu-id="91239-160">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-160">N/A</span></span>|<span data-ttu-id="91239-161">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-161">N/A</span></span>|<span data-ttu-id="91239-162">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-162">N/A</span></span>|<span data-ttu-id="91239-163">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-163">N/A</span></span>|<span data-ttu-id="91239-164">1,10,11</span><span class="sxs-lookup"><span data-stu-id="91239-164">1,10,11</span></span>|<span data-ttu-id="91239-165">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-165">N/A</span></span>|<span data-ttu-id="91239-166">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-166">N/A</span></span>|  
|<span data-ttu-id="91239-167">SQL_C_CHAR/SQL_WCHAR (date)</span><span class="sxs-lookup"><span data-stu-id="91239-167">SQL_C_CHAR/SQL_WCHAR (date)</span></span>|<span data-ttu-id="91239-168">9</span><span class="sxs-lookup"><span data-stu-id="91239-168">9</span></span>|<span data-ttu-id="91239-169">9</span><span class="sxs-lookup"><span data-stu-id="91239-169">9</span></span>|<span data-ttu-id="91239-170">9</span><span class="sxs-lookup"><span data-stu-id="91239-170">9</span></span>|<span data-ttu-id="91239-171">9,6</span><span class="sxs-lookup"><span data-stu-id="91239-171">9,6</span></span>|<span data-ttu-id="91239-172">9,5,6</span><span class="sxs-lookup"><span data-stu-id="91239-172">9,5,6</span></span>|<span data-ttu-id="91239-173">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-173">N/A</span></span>|<span data-ttu-id="91239-174">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-174">N/A</span></span>|  
|<span data-ttu-id="91239-175">SQL_C_CHAR/SQL_WCHAR (time2)</span><span class="sxs-lookup"><span data-stu-id="91239-175">SQL_C_CHAR/SQL_WCHAR (time2)</span></span>|<span data-ttu-id="91239-176">9</span><span class="sxs-lookup"><span data-stu-id="91239-176">9</span></span>|<span data-ttu-id="91239-177">9, 3</span><span class="sxs-lookup"><span data-stu-id="91239-177">9,3</span></span>|<span data-ttu-id="91239-178">9,10</span><span class="sxs-lookup"><span data-stu-id="91239-178">9,10</span></span>|<span data-ttu-id="91239-179">9,7,10</span><span class="sxs-lookup"><span data-stu-id="91239-179">9,7,10</span></span>|<span data-ttu-id="91239-180">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="91239-180">9,5,7,10</span></span>|<span data-ttu-id="91239-181">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-181">N/A</span></span>|<span data-ttu-id="91239-182">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-182">N/A</span></span>|  
|<span data-ttu-id="91239-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span><span class="sxs-lookup"><span data-stu-id="91239-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span></span>|<span data-ttu-id="91239-184">9,2</span><span class="sxs-lookup"><span data-stu-id="91239-184">9,2</span></span>|<span data-ttu-id="91239-185">9, 3, 4</span><span class="sxs-lookup"><span data-stu-id="91239-185">9,3,4</span></span>|<span data-ttu-id="91239-186">9,4,10</span><span class="sxs-lookup"><span data-stu-id="91239-186">9,4,10</span></span>|<span data-ttu-id="91239-187">9,10</span><span class="sxs-lookup"><span data-stu-id="91239-187">9,10</span></span>|<span data-ttu-id="91239-188">9,5,10</span><span class="sxs-lookup"><span data-stu-id="91239-188">9,5,10</span></span>|<span data-ttu-id="91239-189">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-189">N/A</span></span>|<span data-ttu-id="91239-190">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-190">N/A</span></span>|  
|<span data-ttu-id="91239-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="91239-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span></span>|<span data-ttu-id="91239-192">9,2,8</span><span class="sxs-lookup"><span data-stu-id="91239-192">9,2,8</span></span>|<span data-ttu-id="91239-193">9, 3, 4, 8</span><span class="sxs-lookup"><span data-stu-id="91239-193">9,3,4,8</span></span>|<span data-ttu-id="91239-194">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="91239-194">9,4,8,10</span></span>|<span data-ttu-id="91239-195">9,8,10</span><span class="sxs-lookup"><span data-stu-id="91239-195">9,8,10</span></span>|<span data-ttu-id="91239-196">9,10</span><span class="sxs-lookup"><span data-stu-id="91239-196">9,10</span></span>|<span data-ttu-id="91239-197">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-197">N/A</span></span>|<span data-ttu-id="91239-198">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-198">N/A</span></span>|  
|<span data-ttu-id="91239-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="91239-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span></span>|<span data-ttu-id="91239-200">1,11</span><span class="sxs-lookup"><span data-stu-id="91239-200">1,11</span></span>|<span data-ttu-id="91239-201">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-201">N/A</span></span>|<span data-ttu-id="91239-202">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-202">N/A</span></span>|<span data-ttu-id="91239-203">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-203">N/A</span></span>|<span data-ttu-id="91239-204">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-204">N/A</span></span>|<span data-ttu-id="91239-205">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-205">N/A</span></span>|<span data-ttu-id="91239-206">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-206">N/A</span></span>|  
|<span data-ttu-id="91239-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="91239-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span></span>|<span data-ttu-id="91239-208">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-208">N/A</span></span>|<span data-ttu-id="91239-209">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-209">N/A</span></span>|<span data-ttu-id="91239-210">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-210">N/A</span></span>|<span data-ttu-id="91239-211">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-211">N/A</span></span>|<span data-ttu-id="91239-212">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-212">N/A</span></span>|<span data-ttu-id="91239-213">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-213">N/A</span></span>|<span data-ttu-id="91239-214">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-214">N/A</span></span>|  
|<span data-ttu-id="91239-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="91239-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span></span>|<span data-ttu-id="91239-216">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-216">N/A</span></span>|<span data-ttu-id="91239-217">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-217">N/A</span></span>|<span data-ttu-id="91239-218">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-218">N/A</span></span>|<span data-ttu-id="91239-219">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-219">N/A</span></span>|<span data-ttu-id="91239-220">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-220">N/A</span></span>|<span data-ttu-id="91239-221">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-221">N/A</span></span>|<span data-ttu-id="91239-222">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-222">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="91239-223">Descrizione dei simboli</span><span class="sxs-lookup"><span data-stu-id="91239-223">Key to Symbols</span></span>  
  
|<span data-ttu-id="91239-224">Simbolo</span><span class="sxs-lookup"><span data-stu-id="91239-224">Symbol</span></span>|<span data-ttu-id="91239-225">Significato</span><span class="sxs-lookup"><span data-stu-id="91239-225">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="91239-226">Non viene supportata alcuna conversione.</span><span class="sxs-lookup"><span data-stu-id="91239-226">No conversion is supported.</span></span> <span data-ttu-id="91239-227">Viene generato un record di diagnostica con SQLSTATE 07006 e il messaggio "Violazione dell'attributo del tipo di dati".</span><span class="sxs-lookup"><span data-stu-id="91239-227">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="91239-228">1</span><span class="sxs-lookup"><span data-stu-id="91239-228">1</span></span>|<span data-ttu-id="91239-229">Se i dati forniti non sono validi, viene generato un record di diagnostica con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="91239-229">If the data supplied is not valid, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="91239-230">2</span><span class="sxs-lookup"><span data-stu-id="91239-230">2</span></span>|<span data-ttu-id="91239-231">I campi dell'ora devono essere zero o viene generato un record di diagnostica con SQLSTATE 22008 e il messaggio "Troncamento frazionario".</span><span class="sxs-lookup"><span data-stu-id="91239-231">Time fields must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="91239-232">3</span><span class="sxs-lookup"><span data-stu-id="91239-232">3</span></span>|<span data-ttu-id="91239-233">I secondi frazionari devono essere zero o viene generato un record di diagnostica con SQLSTATE 22008 e il messaggio "Troncamento frazionario".</span><span class="sxs-lookup"><span data-stu-id="91239-233">Fractional seconds must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="91239-234">4</span><span class="sxs-lookup"><span data-stu-id="91239-234">4</span></span>|<span data-ttu-id="91239-235">Il componente relativo alla data viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="91239-235">The date component is ignored.</span></span>|  
|<span data-ttu-id="91239-236">5</span><span class="sxs-lookup"><span data-stu-id="91239-236">5</span></span>|<span data-ttu-id="91239-237">Il fuso orario viene impostato sul fuso orario del client.</span><span class="sxs-lookup"><span data-stu-id="91239-237">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="91239-238">6</span><span class="sxs-lookup"><span data-stu-id="91239-238">6</span></span>|<span data-ttu-id="91239-239">L'ora è impostata su zero.</span><span class="sxs-lookup"><span data-stu-id="91239-239">The time is set to zero.</span></span>|  
|<span data-ttu-id="91239-240">7</span><span class="sxs-lookup"><span data-stu-id="91239-240">7</span></span>|<span data-ttu-id="91239-241">La data viene impostata sulla data corrente.</span><span class="sxs-lookup"><span data-stu-id="91239-241">The date is set to the current date.</span></span>|  
|<span data-ttu-id="91239-242">8</span><span class="sxs-lookup"><span data-stu-id="91239-242">8</span></span>|<span data-ttu-id="91239-243">L'ora viene convertita dal fuso orario del client all'ora UTC.</span><span class="sxs-lookup"><span data-stu-id="91239-243">The time is converted from the client's timezone to UTC.</span></span> <span data-ttu-id="91239-244">Se si verifica un errore durante questa conversione, viene generato un record di diagnostica con l'identificativo SQLSTATE 22008 e il messaggio "Overflow del campo Datetime".</span><span class="sxs-lookup"><span data-stu-id="91239-244">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="91239-245">9</span><span class="sxs-lookup"><span data-stu-id="91239-245">9</span></span>|<span data-ttu-id="91239-246">La stringa viene analizzata e convertita in un valore date, datetime, datetimeoffset o time, in base al primo carattere di punteggiatura rilevato e alla presenza di componenti rimanenti.</span><span class="sxs-lookup"><span data-stu-id="91239-246">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and the presence of remaining components.</span></span> <span data-ttu-id="91239-247">La stringa viene quindi convertita nel tipo di destinazione, seguendo le regole nella tabella precedente per il tipo di origine individuato da questo processo.</span><span class="sxs-lookup"><span data-stu-id="91239-247">The string is then converted to the target type, following the rules in the preceding table for the source type discovered by this process.</span></span> <span data-ttu-id="91239-248">Se durante l'analisi dei dati viene rilevato un errore, viene generato un record di diagnostica con SQLSTATE 22018 e il messaggio "Carattere non valido per la specifica del cast".</span><span class="sxs-lookup"><span data-stu-id="91239-248">If an error is detected while parsing the data, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="91239-249">Per i parametri datetime e smalldatetime, se l'anno non è compreso nell'intervallo supportato da questi tipi, viene generato un record di diagnostica con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="91239-249">For datetime and smalldatetime parameters, if the year is outside the range supported by these types, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="91239-250">Per datetimeoffset, il valore deve essere compreso nell'intervallo supportato in seguito alla conversione in UTC, anche se non è necessaria alcuna conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="91239-250">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="91239-251">Ciò è dovuto al fatto che TDS e il server normalizzano sempre l'ora in valori datetimeoffset per UTC. Il client deve pertanto verificare che i componenti relativi all'ora siano compresi nell'intervallo supportato in seguito alla conversione in UTC.</span><span class="sxs-lookup"><span data-stu-id="91239-251">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="91239-252">Se il valore non è compreso nell'intervallo UTC supportato, viene generato un record di diagnostica con SQLSTATE 22007 e il messaggio "Formato di datetime non valido".</span><span class="sxs-lookup"><span data-stu-id="91239-252">If the value is not within the supported UTC range, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="91239-253">10</span><span class="sxs-lookup"><span data-stu-id="91239-253">10</span></span>|<span data-ttu-id="91239-254">Se si verifica un troncamento con perdita di dati, viene generato un record di diagnostica con SQLSTATE 22008 e il messaggio "Formato ora non valido".</span><span class="sxs-lookup"><span data-stu-id="91239-254">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22008 and the message "Invalid time format".</span></span> <span data-ttu-id="91239-255">Questo errore si verifica anche se il valore non è incluso nell'intervallo che può essere rappresentato dall'intervallo UTC utilizzato dal server.</span><span class="sxs-lookup"><span data-stu-id="91239-255">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span>|  
|<span data-ttu-id="91239-256">11</span><span class="sxs-lookup"><span data-stu-id="91239-256">11</span></span>|<span data-ttu-id="91239-257">Se la lunghezza in byte dei dati non equivale alla dimensione della struttura richiesta dal tipo SQL, viene generato un record di diagnostica con SQLSTATE 22003 e il messaggio "Valore numerico non compreso nell'intervallo".</span><span class="sxs-lookup"><span data-stu-id="91239-257">If the byte length of the data does not equal the size of the struct required by the SQL type, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="91239-258">12</span><span class="sxs-lookup"><span data-stu-id="91239-258">12</span></span>|<span data-ttu-id="91239-259">Se la lunghezza in byte dei dati è 4 o 8, i dati vengono inviati al server in formato smalldatetime o datetime TDS non elaborato.</span><span class="sxs-lookup"><span data-stu-id="91239-259">If the byte length of the data is 4 or 8, the data is sent to the server in raw TDS smalldatetime or datetime format.</span></span> <span data-ttu-id="91239-260">Se la lunghezza in byte dei dati corrisponde esattamente alla dimensione di SQL_TIMESTAMP_STRUCT, i dati vengono convertiti nel formato TDS per datetime2.</span><span class="sxs-lookup"><span data-stu-id="91239-260">If the byte length of the data exactly matches the size of SQL_TIMESTAMP_STRUCT, the data is converted to the TDS format for datetime2.</span></span>|  
|<span data-ttu-id="91239-261">13</span><span class="sxs-lookup"><span data-stu-id="91239-261">13</span></span>|<span data-ttu-id="91239-262">Se si verifica un troncamento con perdita di dati, viene generato un record di diagnostica con SQLSTATE 22001 e il messaggio "Troncamento a destra della stringa di dati".</span><span class="sxs-lookup"><span data-stu-id="91239-262">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and the message "String data, right truncated".</span></span><br /><br /> <span data-ttu-id="91239-263">Il numero di cifre per i secondi frazionari (scala) è determinato dalla dimensione della colonna di destinazione in base a quanto segue:</span><span class="sxs-lookup"><span data-stu-id="91239-263">The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following:</span></span><br /><br /> <span data-ttu-id="91239-264">**Tipo:** SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="91239-264">**Type:** SQL_C_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="91239-265">Scala implicita</span><span class="sxs-lookup"><span data-stu-id="91239-265">Implied Scale</span></span><br /><br /> <span data-ttu-id="91239-266">0</span><span class="sxs-lookup"><span data-stu-id="91239-266">0</span></span><br /><br /> <span data-ttu-id="91239-267">19</span><span class="sxs-lookup"><span data-stu-id="91239-267">19</span></span><br /><br /> <span data-ttu-id="91239-268">Scala implicita</span><span class="sxs-lookup"><span data-stu-id="91239-268">Implied Scale</span></span><br /><br /> <span data-ttu-id="91239-269">1.. 9</span><span class="sxs-lookup"><span data-stu-id="91239-269">1..9</span></span><br /><br /> <span data-ttu-id="91239-270">21..29</span><span class="sxs-lookup"><span data-stu-id="91239-270">21..29</span></span><br /><br /> <span data-ttu-id="91239-271">Per SQL_C_TYPE_TIMESTAMP, tuttavia, se i secondi frazionari possono essere rappresentati con tre cifre senza perdita di dati e la dimensione della colonna è almeno 23, vengono generate esattamente tre cifre di secondi frazionari.</span><span class="sxs-lookup"><span data-stu-id="91239-271">However, for SQL_C_TYPE_TIMESTAMP, if the fractional seconds can be represented with three digits without data loss and the column size is 23 or larger, then exactly three fractional seconds' digits are generated.</span></span> <span data-ttu-id="91239-272">Questo comportamento assicura la compatibilità con le versioni precedenti per le applicazioni sviluppate utilizzando driver ODBC meno recenti.</span><span class="sxs-lookup"><span data-stu-id="91239-272">This behavior ensures backwards compatibility for applications developed using older ODBC drivers.</span></span><br /><br /> <span data-ttu-id="91239-273">Per dimensioni di colonna maggiori dell'intervallo specificato nella tabella, si presuppone una scala 9.</span><span class="sxs-lookup"><span data-stu-id="91239-273">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="91239-274">Questa conversione deve consentire fino a nove cifre per i secondi frazionari, il massimo consentito da ODBC.</span><span class="sxs-lookup"><span data-stu-id="91239-274">This conversion should allow for up to nine fractional seconds digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="91239-275">Una dimensione della colonna pari a zero implica una dimensione illimitata per i tipi di carattere a lunghezza variabile in ODBC (9 cifre, a meno che non si applichi la regola delle 3 cifre per SQL_C_TYPE_TIMESTAMP).</span><span class="sxs-lookup"><span data-stu-id="91239-275">A column size of zero implies unlimited size for variable length character types in ODBC (9 digits, unless the 3-digit rule for SQL_C_TYPE_TIMESTAMP applies).</span></span> <span data-ttu-id="91239-276">La specifica di una dimensione della colonna pari a zero con un tipo di carattere a lunghezza fissa è un errore.</span><span class="sxs-lookup"><span data-stu-id="91239-276">Specifying a column size of zero with a fixed length character type is an error.</span></span>|  
|<span data-ttu-id="91239-277">N/D</span><span class="sxs-lookup"><span data-stu-id="91239-277">N/A</span></span>|<span data-ttu-id="91239-278">Viene mantenuto il comportamento di [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="91239-278">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="91239-279">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="91239-279">See Also</span></span>  
 [<span data-ttu-id="91239-280">Miglioramenti di data e ora &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="91239-280">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
