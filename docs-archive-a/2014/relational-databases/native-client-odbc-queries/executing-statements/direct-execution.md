---
title: Esecuzione diretta | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, statements
- direct execution [ODBC]
- SQLExecDirect function
- statements [ODBC], direct execution
ms.assetid: fa36e1af-ed98-4abc-97c1-c4cc5d227b29
author: rothja
ms.author: jroth
ms.openlocfilehash: 29153f3e4e9265e87feb0e23ba9ae97118691e95
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624117"
---
# <a name="direct-execution"></a><span data-ttu-id="40e83-102">Esecuzione diretta</span><span class="sxs-lookup"><span data-stu-id="40e83-102">Direct Execution</span></span>
  <span data-ttu-id="40e83-103">L'esecuzione diretta rappresenta la modalità più semplice di esecuzione di un'istruzione.</span><span class="sxs-lookup"><span data-stu-id="40e83-103">Direct execution is the most basic way to execute a statement.</span></span> <span data-ttu-id="40e83-104">Un'applicazione compila una stringa di caratteri contenente un' [!INCLUDE[tsql](../../../includes/tsql-md.md)] istruzione e la invia per l'esecuzione mediante la funzione **SQLExecDirect** .</span><span class="sxs-lookup"><span data-stu-id="40e83-104">An application builds a character string containing a [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement and submits it for execution using the **SQLExecDirect** function.</span></span> <span data-ttu-id="40e83-105">Dopo avere raggiunto il server, l'istruzione viene compilata da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in un piano di esecuzione, che viene quindi immediatamente eseguito.</span><span class="sxs-lookup"><span data-stu-id="40e83-105">When the statement reaches the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] compiles it into an execution plan and then immediately runs the execution plan.</span></span>  
  
 <span data-ttu-id="40e83-106">L'esecuzione diretta viene in genere utilizzata dalle applicazioni che compilano ed eseguono istruzioni in fase di esecuzione e rappresenta il metodo più efficiente per le istruzioni eseguite una sola volta.</span><span class="sxs-lookup"><span data-stu-id="40e83-106">Direct execution is commonly used by applications that build and execute statements at run time and is the most efficient method for statements that will be executed a single time.</span></span> <span data-ttu-id="40e83-107">Lo svantaggio con molti database consiste nel fatto che l'istruzione SQL deve essere analizzata e compilata ogni volta che viene eseguita determinando un aumento dell'overhead se l'istruzione viene eseguita più volte.</span><span class="sxs-lookup"><span data-stu-id="40e83-107">Its drawback with many databases is that the SQL statement must be parsed and compiled each time it is executed, which adds overhead if the statement is executed multiple times.</span></span>  
  
 <span data-ttu-id="40e83-108">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vengono notevolmente migliorate le prestazioni dell'esecuzione diretta delle istruzioni utilizzate più di frequente negli ambienti multiutente e l'utilizzo di SQLExecDirect con gi marcatori di parametro per le istruzioni SQL utilizzate più di frequente si avvicina all'efficienza dell'esecuzione preparata.</span><span class="sxs-lookup"><span data-stu-id="40e83-108">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] significantly improves the performance of direct execution of commonly executed statements in multiuser environments and using SQLExecDirect with parameter markers for commonly executed SQL statements can approach the efficiency of prepared execution.</span></span>  
  
 <span data-ttu-id="40e83-109">Quando si è connessi a un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client utilizza [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) per trasmettere l'istruzione SQL o il batch specificato in **SQLExecDirect**.</span><span class="sxs-lookup"><span data-stu-id="40e83-109">When connected to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver uses [sp_executesql](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql) to transmit the SQL statement or batch specified on **SQLExecDirect**.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="40e83-110">dispone della logica per determinare rapidamente se un'istruzione SQL o un batch eseguito con **sp_executesql** corrisponde all'istruzione o al batch che ha generato un piano di esecuzione già esistente in memoria.</span><span class="sxs-lookup"><span data-stu-id="40e83-110">has logic to quickly determine if an SQL statement or batch executed with **sp_executesql** matches the statement or batch that generated an execution plan that already exists in memory.</span></span> <span data-ttu-id="40e83-111">Se esiste una corrispondenza, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] riutilizza semplicemente il piano esistente anziché compilarne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="40e83-111">If a match is made, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] simply reuses the existing plan rather than compile a new plan.</span></span> <span data-ttu-id="40e83-112">Ciò significa che le istruzioni SQL comunemente eseguite eseguite con **SQLExecDirect** in un sistema con molti utenti trarranno vantaggio da molti dei vantaggi del riutilizzo del piano disponibili solo per le stored procedure nelle versioni precedenti di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="40e83-112">This means that commonly executed SQL statements executed with **SQLExecDirect** in a system with many users will benefit from many of the plan-reuse benefits that were only available to stored procedures in earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="40e83-113">Il vantaggio di riutilizzare i piani di esecuzione è valido solo quando più utenti eseguono lo stesso batch o la stessa istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="40e83-113">This benefit of reusing execution plans only works when several users are executing the same SQL statement or batch.</span></span> <span data-ttu-id="40e83-114">Rispettare le seguenti convenzioni di scrittura del codice per aumentare la probabilità che le istruzioni SQL eseguite da client diversi siano simili abbastanza per potere riutilizzare i piani di esecuzione:</span><span class="sxs-lookup"><span data-stu-id="40e83-114">Follow these coding conventions to increase the probability that the SQL statements executed by different clients are similar enough to be able to reuse execution plans:</span></span>  
  
-   <span data-ttu-id="40e83-115">Non includere costanti di dati nelle istruzioni SQL; utilizzare invece i marcatori di parametro associati alle variabili di programma.</span><span class="sxs-lookup"><span data-stu-id="40e83-115">Do not include data constants in the SQL statements; instead use parameter markers bound to program variables.</span></span> <span data-ttu-id="40e83-116">Per ulteriori informazioni, vedere [utilizzo dei parametri dell'istruzione](../using-statement-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="40e83-116">For more information, see [Using Statement Parameters](../using-statement-parameters.md).</span></span>  
  
-   <span data-ttu-id="40e83-117">Utilizzare nomi di oggetto completi.</span><span class="sxs-lookup"><span data-stu-id="40e83-117">Use fully qualified object names.</span></span> <span data-ttu-id="40e83-118">I piani di esecuzione non vengono riutilizzati se i nomi di oggetto non sono completi.</span><span class="sxs-lookup"><span data-stu-id="40e83-118">Execution plans are not reused if object names are not qualified.</span></span>  
  
-   <span data-ttu-id="40e83-119">Se possibile, utilizzare per le connessioni dell'applicazione un set comune di opzioni dell'istruzione e di connessione.</span><span class="sxs-lookup"><span data-stu-id="40e83-119">Have application connections as possible use a common set of connection and statement options.</span></span> <span data-ttu-id="40e83-120">I piani di esecuzione generati per una connessione con un set di opzioni, ad esempio ANSI_NULLS, non vengono riutilizzati per una connessione con un altro set di opzioni.</span><span class="sxs-lookup"><span data-stu-id="40e83-120">Execution plans generated for a connection with one set of options (such as ANSI_NULLS) are not reused for a connection having another set of options.</span></span> <span data-ttu-id="40e83-121">Il driver ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e il provider ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client hanno le stesse impostazioni predefinite per queste opzioni.</span><span class="sxs-lookup"><span data-stu-id="40e83-121">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider both have the same default settings for these options.</span></span>  
  
 <span data-ttu-id="40e83-122">Se tutte le istruzioni eseguite con **SQLExecDirect** vengono codificate utilizzando queste convenzioni, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] può riutilizzare i piani di esecuzione quando si verifica l'opportunità.</span><span class="sxs-lookup"><span data-stu-id="40e83-122">If all statements executed with **SQLExecDirect** are coded using these conventions, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can reuse execution plans when the opportunity arises.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40e83-123">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="40e83-123">See Also</span></span>  
 [<span data-ttu-id="40e83-124">Esecuzione di istruzioni &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="40e83-124">Executing Statements &#40;ODBC&#41;</span></span>](executing-statements-odbc.md)  
  
  
