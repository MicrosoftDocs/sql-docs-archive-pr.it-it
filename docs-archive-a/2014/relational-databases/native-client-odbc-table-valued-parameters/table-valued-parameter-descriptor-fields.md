---
title: Campi di descrizione del parametro con valori di tabella | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714319"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="77694-102">Campi di descrizione dei parametri con valori di tabella</span><span class="sxs-lookup"><span data-stu-id="77694-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="77694-103">Il supporto per i parametri con valori di tabella include nuovi campi specifici di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nei descrittori di parametri delle applicazioni (APD, Application Parameter Descriptor) e nei descrittori di parametri di implementazione (IPD, Implementation Parameter Descriptor) ODBC.</span><span class="sxs-lookup"><span data-stu-id="77694-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="77694-104">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="77694-104">Remarks</span></span>  
  
|<span data-ttu-id="77694-105">Nome</span><span class="sxs-lookup"><span data-stu-id="77694-105">Name</span></span>|<span data-ttu-id="77694-106">Location</span><span class="sxs-lookup"><span data-stu-id="77694-106">Location</span></span>|<span data-ttu-id="77694-107">Type</span><span class="sxs-lookup"><span data-stu-id="77694-107">Type</span></span>|<span data-ttu-id="77694-108">Descrizione</span><span class="sxs-lookup"><span data-stu-id="77694-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="77694-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="77694-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="77694-110">IPD</span><span class="sxs-lookup"><span data-stu-id="77694-110">IPD</span></span>|<span data-ttu-id="77694-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="77694-111">SQLTCHAR\*</span></span>|<span data-ttu-id="77694-112">Nome del tipo di server del parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="77694-113">Quando un nome di tipo di parametro con valori di tabella viene specificato in una chiamata a SQLBindParameter, deve sempre essere specificato come valore Unicode, anche nelle applicazioni compilate come applicazioni ANSI.</span><span class="sxs-lookup"><span data-stu-id="77694-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="77694-114">Il valore utilizzato per il parametro *StrLen_or_IndPtr* deve essere SQL_NTS o la lunghezza della stringa del nome moltiplicato per sizeof (WCHAR).</span><span class="sxs-lookup"><span data-stu-id="77694-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="77694-115">Quando un nome di tipo di parametro con valori di tabella viene specificato tramite SQLSetDescField, può essere specificato usando un valore letterale conforme al modo in cui viene compilata l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="77694-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="77694-116">In Gestione driver ODBC verrà eseguita la conversione Unicode necessaria.</span><span class="sxs-lookup"><span data-stu-id="77694-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="77694-117">SQL_CA_SS_TYPE_CATALOG_NAME (di sola lettura)</span><span class="sxs-lookup"><span data-stu-id="77694-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="77694-118">IPD</span><span class="sxs-lookup"><span data-stu-id="77694-118">IPD</span></span>|<span data-ttu-id="77694-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="77694-119">SQLTCHAR\*</span></span>|<span data-ttu-id="77694-120">Il catalogo in cui è definito il tipo.</span><span class="sxs-lookup"><span data-stu-id="77694-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="77694-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="77694-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="77694-122">IPD</span><span class="sxs-lookup"><span data-stu-id="77694-122">IPD</span></span>|<span data-ttu-id="77694-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="77694-123">SQLTCHAR\*</span></span>|<span data-ttu-id="77694-124">Lo schema in cui è definito il tipo.</span><span class="sxs-lookup"><span data-stu-id="77694-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="77694-125">Nelle applicazioni non deve essere impostato SQL_CA_SS_TYPE_CATALOG_NAME per i parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="77694-126">In questo modo verrà restituito un errore SQL_ERROR, verrà registrato un record di diagnostica con SQLSTATE = HY091 e verrà visualizzato il messaggio "Identificatore del campo di descrizione non valido".</span><span class="sxs-lookup"><span data-stu-id="77694-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="77694-127">Di seguito sono indicati gli attributi di istruzione e i campi di intestazione di descrizione che si applicano ai parametri con valori di tabella quando lo stato attivo del parametro è impostato su un parametro con valori di tabella:</span><span class="sxs-lookup"><span data-stu-id="77694-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="77694-128">Nome</span><span class="sxs-lookup"><span data-stu-id="77694-128">Name</span></span>|<span data-ttu-id="77694-129">Location</span><span class="sxs-lookup"><span data-stu-id="77694-129">Location</span></span>|<span data-ttu-id="77694-130">Type</span><span class="sxs-lookup"><span data-stu-id="77694-130">Type</span></span>|<span data-ttu-id="77694-131">Descrizione</span><span class="sxs-lookup"><span data-stu-id="77694-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="77694-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="77694-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="77694-133">(equivale a SQL_DESC_ARRAY_SIZE in APD)</span><span class="sxs-lookup"><span data-stu-id="77694-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="77694-134">APD</span><span class="sxs-lookup"><span data-stu-id="77694-134">APD</span></span>|<span data-ttu-id="77694-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="77694-135">SQLUINTEGER</span></span>|<span data-ttu-id="77694-136">Dimensione delle matrici di buffer per un parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="77694-137">Si tratta del numero massimo di righe che può essere adattato dai buffer o della dimensione dei buffer in righe. Nel valore del parametro con valori di tabella stesso potrebbe essere presente un numero maggiore o minore di righe rispetto a quello che può essere contenuto nel buffer.</span><span class="sxs-lookup"><span data-stu-id="77694-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="77694-138">Il valore predefinito è 1.</span><span class="sxs-lookup"><span data-stu-id="77694-138">Default is 1.</span></span> <span data-ttu-id="77694-139">**Nota:**  Se SQL_SOPT_SS_PARAM_FOCUS è impostato sul valore predefinito 0, SQL_ATTR_PARAMSET_SIZE fa riferimento all'istruzione e specifica il numero di set di parametri.</span><span class="sxs-lookup"><span data-stu-id="77694-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="77694-140">Se SQL_SOPT_SS_PARAM_FOCUS è impostato sul numero ordinale di un parametro con valori di tabella, si riferisce al parametro con valori di tabella e specifica il numero di righe per set di parametri per il parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="77694-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="77694-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="77694-142">APD</span><span class="sxs-lookup"><span data-stu-id="77694-142">APD</span></span>|<span data-ttu-id="77694-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="77694-143">SQLINTEGER</span></span>|<span data-ttu-id="77694-144">L'impostazione predefinita è SQL_PARAM_BIND_BY_COLUMN.</span><span class="sxs-lookup"><span data-stu-id="77694-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="77694-145">Per selezionare l'associazione per riga, questo campo è impostato sulla lunghezza della struttura o su un'istanza di un buffer che verrà associato a un set di righe del parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="77694-146">Questa lunghezza deve includere lo spazio per tutte le colonne associate ed eventuale riempimento della struttura o del buffer.</span><span class="sxs-lookup"><span data-stu-id="77694-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="77694-147">In questo modo si garantisce che, quando l'indirizzo di una colonna associata viene incrementato con la lunghezza specificata, il risultato punterà all'inizio della stessa colonna della riga successiva.</span><span class="sxs-lookup"><span data-stu-id="77694-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="77694-148">In caso di utilizzo dell'operatore `sizeof` in ANSI C, questo comportamento è garantito.</span><span class="sxs-lookup"><span data-stu-id="77694-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="77694-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="77694-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="77694-150">APD</span><span class="sxs-lookup"><span data-stu-id="77694-150">APD</span></span>|<span data-ttu-id="77694-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="77694-151">SQLINTEGER\*</span></span>|<span data-ttu-id="77694-152">Il valore predefinito è un puntatore null.</span><span class="sxs-lookup"><span data-stu-id="77694-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="77694-153">Se questo campo è non null, il driver risolve il riferimento dell'indicatore di misura, aggiunge il valore per il quale è stato risolto il riferimento a ognuno dei campi posticipati nel record del descrittore (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR e SQL_DESC_OCTET_LENGTH_PTR) e utilizza i nuovi valori dell'indicatore di misura per accedere ai valori dei dati.</span><span class="sxs-lookup"><span data-stu-id="77694-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="77694-154">Questi campi sono validi solo per i parametri con valori di tabella e vengono ignorati per altri tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="77694-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="77694-155">SQL_CA_SS_TYPE_NAME è facoltativo per le chiamate della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="77694-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="77694-156">Deve essere specificato per istruzioni SQL che non sono chiamate di stored procedure per consentire al server di determinare il tipo di parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="77694-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="77694-157">Se il nome del tipo è obbligatorio e il tipo di tabella per il parametro con valori di tabella è definito in uno schema diverso dalla stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME deve essere specificato nel descrittore di parametri di implementazione (IPD).</span><span class="sxs-lookup"><span data-stu-id="77694-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="77694-158">In caso contrario, il server non sarà in grado di determinare il tipo di parametro con valori di tabella</span><span class="sxs-lookup"><span data-stu-id="77694-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="77694-159">Verrà generato un errore quando si chiama SQLExecute o SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="77694-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="77694-160">con SQLSTATE = 07006 e verrà visualizzato il messaggio "Violazione dell'attributo del tipo di dati".</span><span class="sxs-lookup"><span data-stu-id="77694-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="77694-161">Le colonne dei parametri con valori di tabella possono utilizzare l'associazione per riga o per colonna.</span><span class="sxs-lookup"><span data-stu-id="77694-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="77694-162">L'impostazione predefinita è l'associazione per colonna.</span><span class="sxs-lookup"><span data-stu-id="77694-162">The default is column-wise binding.</span></span> <span data-ttu-id="77694-163">L'associazione per riga può essere specificata impostando SQL_ATTR_PARAM_BIND_TYPE e SQL_ATTR_ PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="77694-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="77694-164">ed è analoga all'associazione per riga di colonne e parametri.</span><span class="sxs-lookup"><span data-stu-id="77694-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="77694-165">SQL_CA_SS_TYPE_CATALOG_NAME e SQL_CA_SS_TYPE_SCHEMA_NAME possono inoltre essere utilizzati per recuperare il catalogo e lo schema associati ai parametri del tipo CLR definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="77694-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="77694-166">Si tratta di alternative agli attributi dello schema del catalogo specifico del tipo esistente per questi tipi.</span><span class="sxs-lookup"><span data-stu-id="77694-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="77694-167">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="77694-167">See Also</span></span>  
 [<span data-ttu-id="77694-168">Parametri con valori di tabella &#40;&#41;ODBC</span><span class="sxs-lookup"><span data-stu-id="77694-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
