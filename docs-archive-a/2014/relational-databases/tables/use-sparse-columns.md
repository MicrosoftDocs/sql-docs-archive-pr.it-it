---
title: Usare le colonne di tipo sparse | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- sparse columns, described
- null columns
- sparse columns
ms.assetid: ea7ddb87-f50b-46b6-9f5a-acab222a2ede
author: stevestein
ms.author: sstein
ms.openlocfilehash: b3068ac7a3094605bb809ac84c63766b64fda486
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628569"
---
# <a name="use-sparse-columns"></a><span data-ttu-id="eb076-102">Utilizzo di colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-102">Use Sparse Columns</span></span>
  <span data-ttu-id="eb076-103">Le colonne di tipo sparse sono colonne comuni che dispongono di archiviazione ottimizzata per i valori Null.</span><span class="sxs-lookup"><span data-stu-id="eb076-103">Sparse columns are ordinary columns that have an optimized storage for null values.</span></span> <span data-ttu-id="eb076-104">Tali colonne consentono di ridurre i requisiti di spazio per i valori Null aumentando tuttavia l'overhead per il recupero dei valori non Null.</span><span class="sxs-lookup"><span data-stu-id="eb076-104">Sparse columns reduce the space requirements for null values at the cost of more overhead to retrieve nonnull values.</span></span> <span data-ttu-id="eb076-105">È consigliabile utilizzare colonne di tipo sparse quando la quantità di spazio risparmiata è compresa almeno tra il 20% e il 40%.</span><span class="sxs-lookup"><span data-stu-id="eb076-105">Consider using sparse columns when the space saved is at least 20 percent to 40 percent.</span></span> <span data-ttu-id="eb076-106">Le colonne di tipo sparse e i set di colonne vengono definiti utilizzando l'istruzione [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql) o [ALTER TABLE](/sql/t-sql/statements/alter-table-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="eb076-106">Sparse columns and column sets are defined by using the [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql) or [ALTER TABLE](/sql/t-sql/statements/alter-table-transact-sql) statements.</span></span>  
  
 <span data-ttu-id="eb076-107">Le colonne di tipo sparse possono essere utilizzate con set di colonne e indici filtrati:</span><span class="sxs-lookup"><span data-stu-id="eb076-107">Sparse columns can be used with column sets and filtered indexes:</span></span>  
  
-   <span data-ttu-id="eb076-108">Set di colonne</span><span class="sxs-lookup"><span data-stu-id="eb076-108">Column sets</span></span>  
  
     <span data-ttu-id="eb076-109">Le istruzioni INSERT, UPDATE e DELETE possono fare riferimento alle colonne di tipo sparse in base al nome.</span><span class="sxs-lookup"><span data-stu-id="eb076-109">INSERT, UPDATE, and DELETE statements can reference the sparse columns by name.</span></span> <span data-ttu-id="eb076-110">È tuttavia possibile visualizzare e utilizzare tutte le colonne di tipo sparse di una tabella combinate in una singola colonna XML,</span><span class="sxs-lookup"><span data-stu-id="eb076-110">However, you can also view and work with all the sparse columns of a table that are combined into a single XML column.</span></span> <span data-ttu-id="eb076-111">denominata set di colonne.</span><span class="sxs-lookup"><span data-stu-id="eb076-111">This column is called a column set.</span></span> <span data-ttu-id="eb076-112">Per altre informazioni sui set di colonne, vedere [Utilizzare set di colonne](../tables/use-column-sets.md).</span><span class="sxs-lookup"><span data-stu-id="eb076-112">For more information about column sets, see [Use Column Sets](../tables/use-column-sets.md).</span></span>  
  
-   <span data-ttu-id="eb076-113">Indici filtrati</span><span class="sxs-lookup"><span data-stu-id="eb076-113">Filtered indexes</span></span>  
  
     <span data-ttu-id="eb076-114">Poiché le colonne di tipo sparse contengono molte righe con valori Null, sono particolarmente adatte per l'utilizzo di indici filtrati.</span><span class="sxs-lookup"><span data-stu-id="eb076-114">Because sparse columns have many null-valued rows, they are especially appropriate for filtered indexes.</span></span> <span data-ttu-id="eb076-115">Un indice filtrato applicato a una colonna di tipo sparse consente di indicizzare solo le righe popolate con valori.</span><span class="sxs-lookup"><span data-stu-id="eb076-115">A filtered index on a sparse column can index only the rows that have populated values.</span></span> <span data-ttu-id="eb076-116">In questo modo, viene creato un indice più efficiente e di dimensioni minori.</span><span class="sxs-lookup"><span data-stu-id="eb076-116">This creates a smaller and more efficient index.</span></span> <span data-ttu-id="eb076-117">Per altre informazioni, vedere [Create Filtered Indexes](../indexes/indexes.md).</span><span class="sxs-lookup"><span data-stu-id="eb076-117">For more information, see [Create Filtered Indexes](../indexes/indexes.md).</span></span>  
  
 <span data-ttu-id="eb076-118">Le colonne di tipo sparse e gli indici filtrati consentono alle applicazioni, ad esempio [!INCLUDE[winSPServ](../../includes/winspserv-md.md)], di archiviare in modo efficiente un elevato numero di proprietà definite dall'utente e accedervi usando [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eb076-118">Sparse columns and filtered indexes enable applications, such as [!INCLUDE[winSPServ](../../includes/winspserv-md.md)], to efficiently store and access a large number of user-defined properties by using [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="properties-of-sparse-columns"></a><span data-ttu-id="eb076-119">Proprietà delle colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-119">Properties of Sparse Columns</span></span>  
 <span data-ttu-id="eb076-120">Le colonne di tipo sparse hanno le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="eb076-120">Sparse columns have the following characteristics:</span></span>  
  
-   <span data-ttu-id="eb076-121">Il [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] utilizza la parola chiave SPARSE nella definizione di una colonna per ottimizzare l'archiviazione dei valori in tale colonna.</span><span class="sxs-lookup"><span data-stu-id="eb076-121">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] uses the SPARSE keyword in a column definition to optimize the storage of values in that column.</span></span> <span data-ttu-id="eb076-122">Di conseguenza, quando il valore della colonna è Null per qualsiasi riga della tabella, i valori non devono essere archiviati.</span><span class="sxs-lookup"><span data-stu-id="eb076-122">Therefore, when the column value is NULL for any row in the table, the values require no storage.</span></span>  
  
-   <span data-ttu-id="eb076-123">Le viste del catalogo per una tabella contenente colonne di tipo sparse sono identiche a quelle di una tabella tipica.</span><span class="sxs-lookup"><span data-stu-id="eb076-123">Catalog views for a table that has sparse columns are the same as for a typical table.</span></span> <span data-ttu-id="eb076-124">La vista del catalogo sys.columns contiene una riga per ogni colonna della tabella e include un set di colonne, se definito.</span><span class="sxs-lookup"><span data-stu-id="eb076-124">The sys.columns catalog view contains a row for each column in the table and includes a column set if one is defined.</span></span>  
  
-   <span data-ttu-id="eb076-125">Le colonne di tipo sparse sono una proprietà del livello dell'archiviazione, piuttosto che la tabella logica.</span><span class="sxs-lookup"><span data-stu-id="eb076-125">Sparse columns are a property of the storage layer, rather than the logical table.</span></span> <span data-ttu-id="eb076-126">Di conseguenza un'istruzione SELECT...INTO non viene copiata sopra la proprietà della colonna di tipo sparse in una nuova tabella.</span><span class="sxs-lookup"><span data-stu-id="eb076-126">Therefore a SELECT...INTO statement does not copy over the sparse column property into a new table.</span></span>  
  
-   <span data-ttu-id="eb076-127">La funzione COLUMNS_UPDATED restituisce un valore `varbinary` per indicare tutte le colonne aggiornate durante un'azione DML.</span><span class="sxs-lookup"><span data-stu-id="eb076-127">The COLUMNS_UPDATED function returns a `varbinary` value to indicate all the columns that were updated during a DML action.</span></span> <span data-ttu-id="eb076-128">I bit restituiti dalla funzione COLUMNS_UPDATED vengono impostati come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="eb076-128">The bits that are returned by the COLUMNS_UPDATED function are as follows:</span></span>  
  
    -   <span data-ttu-id="eb076-129">Quando una colonna di tipo sparse viene aggiornata in modo esplicito, il bit corrispondente per tale colonna e il bit per il set di colonne vengono impostati su 1.</span><span class="sxs-lookup"><span data-stu-id="eb076-129">When a sparse column is explicitly updated, the corresponding bit for that sparse column is set to 1, and the bit for the column set is set to 1.</span></span>  
  
    -   <span data-ttu-id="eb076-130">Quando un set di colonne viene aggiornato in modo esplicito, il bit per il set di colonne e i bit per tutte le colonne di tipo sparse della tabella vengono impostati su 1.</span><span class="sxs-lookup"><span data-stu-id="eb076-130">When a column set is explicitly updated, the bit for the column set is set to 1, and the bits for all the sparse columns in that table are set to 1.</span></span>  
  
    -   <span data-ttu-id="eb076-131">Per le operazioni di inserimento, tutti i bit vengono impostati su 1.</span><span class="sxs-lookup"><span data-stu-id="eb076-131">For insert operations, all bits are set to 1.</span></span>  
  
     <span data-ttu-id="eb076-132">Per altre informazioni sui set di colonne, vedere [Utilizzare set di colonne](../tables/use-column-sets.md).</span><span class="sxs-lookup"><span data-stu-id="eb076-132">For more information about columns sets, see [Use Column Sets](../tables/use-column-sets.md).</span></span>  
  
 <span data-ttu-id="eb076-133">I tipi di dati seguenti non possono essere specificati come SPARSE:</span><span class="sxs-lookup"><span data-stu-id="eb076-133">The following data types cannot be specified as SPARSE:</span></span>  
  
|||  
|-|-|  
|`geography`|`text`|  
|`geometry`|`timestamp`|  
|`image`|`user-defined data types`|  
|`ntext`||  
  
## <a name="estimated-space-savings-by-data-type"></a><span data-ttu-id="eb076-134">Risparmio stimato in termini di spazio in base al tipo di dati</span><span class="sxs-lookup"><span data-stu-id="eb076-134">Estimated Space Savings by Data Type</span></span>  
 <span data-ttu-id="eb076-135">Le colonne di tipo sparse richiedono una quantità maggiore di spazio di archiviazione per i valori non Null rispetto a quella necessaria per dati identici non contrassegnati come SPARSE.</span><span class="sxs-lookup"><span data-stu-id="eb076-135">Sparse columns require more storage space for nonnull values than the space required for identical data that is not marked SPARSE.</span></span> <span data-ttu-id="eb076-136">Nelle tabelle seguenti viene illustrato l'utilizzo dello spazio per ogni tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="eb076-136">The following tables show the space usage for each data type.</span></span> <span data-ttu-id="eb076-137">La colonna **Percentuale valori Null** indica la percentuale di dati con valore Null necessaria per ottenere un risparmio netto del 40% in termini di spazio.</span><span class="sxs-lookup"><span data-stu-id="eb076-137">The **NULL Percentage** column indicates what percent of the data must be NULL for a net space savings of 40 percent.</span></span>  
  
 <span data-ttu-id="eb076-138">**Tipi di dati a lunghezza fissa**</span><span class="sxs-lookup"><span data-stu-id="eb076-138">**Fixed-Length Data Types**</span></span>  
  
|<span data-ttu-id="eb076-139">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="eb076-139">Data type</span></span>|<span data-ttu-id="eb076-140">Byte non di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-140">Nonsparse bytes</span></span>|<span data-ttu-id="eb076-141">Byte di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-141">Sparse bytes</span></span>|<span data-ttu-id="eb076-142">Percentuale valori Null</span><span class="sxs-lookup"><span data-stu-id="eb076-142">NULL percentage</span></span>|  
|---------------|---------------------|------------------|---------------------|  
|`bit`|<span data-ttu-id="eb076-143">0,125</span><span class="sxs-lookup"><span data-stu-id="eb076-143">0.125</span></span>|<span data-ttu-id="eb076-144">5</span><span class="sxs-lookup"><span data-stu-id="eb076-144">5</span></span>|<span data-ttu-id="eb076-145">98%</span><span class="sxs-lookup"><span data-stu-id="eb076-145">98%</span></span>|  
|`tinyint`|<span data-ttu-id="eb076-146">1</span><span class="sxs-lookup"><span data-stu-id="eb076-146">1</span></span>|<span data-ttu-id="eb076-147">5</span><span class="sxs-lookup"><span data-stu-id="eb076-147">5</span></span>|<span data-ttu-id="eb076-148">86%</span><span class="sxs-lookup"><span data-stu-id="eb076-148">86%</span></span>|  
|`smallint`|<span data-ttu-id="eb076-149">2</span><span class="sxs-lookup"><span data-stu-id="eb076-149">2</span></span>|<span data-ttu-id="eb076-150">6</span><span class="sxs-lookup"><span data-stu-id="eb076-150">6</span></span>|<span data-ttu-id="eb076-151">76%</span><span class="sxs-lookup"><span data-stu-id="eb076-151">76%</span></span>|  
|`int`|<span data-ttu-id="eb076-152">4</span><span class="sxs-lookup"><span data-stu-id="eb076-152">4</span></span>|<span data-ttu-id="eb076-153">8</span><span class="sxs-lookup"><span data-stu-id="eb076-153">8</span></span>|<span data-ttu-id="eb076-154">64%</span><span class="sxs-lookup"><span data-stu-id="eb076-154">64%</span></span>|  
|`bigint`|<span data-ttu-id="eb076-155">8</span><span class="sxs-lookup"><span data-stu-id="eb076-155">8</span></span>|<span data-ttu-id="eb076-156">12</span><span class="sxs-lookup"><span data-stu-id="eb076-156">12</span></span>|<span data-ttu-id="eb076-157">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-157">52%</span></span>|  
|`real`|<span data-ttu-id="eb076-158">4</span><span class="sxs-lookup"><span data-stu-id="eb076-158">4</span></span>|<span data-ttu-id="eb076-159">8</span><span class="sxs-lookup"><span data-stu-id="eb076-159">8</span></span>|<span data-ttu-id="eb076-160">64%</span><span class="sxs-lookup"><span data-stu-id="eb076-160">64%</span></span>|  
|`float`|<span data-ttu-id="eb076-161">8</span><span class="sxs-lookup"><span data-stu-id="eb076-161">8</span></span>|<span data-ttu-id="eb076-162">12</span><span class="sxs-lookup"><span data-stu-id="eb076-162">12</span></span>|<span data-ttu-id="eb076-163">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-163">52%</span></span>|  
|`smallmoney`|<span data-ttu-id="eb076-164">4</span><span class="sxs-lookup"><span data-stu-id="eb076-164">4</span></span>|<span data-ttu-id="eb076-165">8</span><span class="sxs-lookup"><span data-stu-id="eb076-165">8</span></span>|<span data-ttu-id="eb076-166">64%</span><span class="sxs-lookup"><span data-stu-id="eb076-166">64%</span></span>|  
|`money`|<span data-ttu-id="eb076-167">8</span><span class="sxs-lookup"><span data-stu-id="eb076-167">8</span></span>|<span data-ttu-id="eb076-168">12</span><span class="sxs-lookup"><span data-stu-id="eb076-168">12</span></span>|<span data-ttu-id="eb076-169">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-169">52%</span></span>|  
|`smalldatetime`|<span data-ttu-id="eb076-170">4</span><span class="sxs-lookup"><span data-stu-id="eb076-170">4</span></span>|<span data-ttu-id="eb076-171">8</span><span class="sxs-lookup"><span data-stu-id="eb076-171">8</span></span>|<span data-ttu-id="eb076-172">64%</span><span class="sxs-lookup"><span data-stu-id="eb076-172">64%</span></span>|  
|`datetime`|<span data-ttu-id="eb076-173">8</span><span class="sxs-lookup"><span data-stu-id="eb076-173">8</span></span>|<span data-ttu-id="eb076-174">12</span><span class="sxs-lookup"><span data-stu-id="eb076-174">12</span></span>|<span data-ttu-id="eb076-175">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-175">52%</span></span>|  
|`uniqueidentifier`|<span data-ttu-id="eb076-176">16</span><span class="sxs-lookup"><span data-stu-id="eb076-176">16</span></span>|<span data-ttu-id="eb076-177">20</span><span class="sxs-lookup"><span data-stu-id="eb076-177">20</span></span>|<span data-ttu-id="eb076-178">43%</span><span class="sxs-lookup"><span data-stu-id="eb076-178">43%</span></span>|  
|`date`|<span data-ttu-id="eb076-179">3</span><span class="sxs-lookup"><span data-stu-id="eb076-179">3</span></span>|<span data-ttu-id="eb076-180">7</span><span class="sxs-lookup"><span data-stu-id="eb076-180">7</span></span>|<span data-ttu-id="eb076-181">69%</span><span class="sxs-lookup"><span data-stu-id="eb076-181">69%</span></span>|  
  
 <span data-ttu-id="eb076-182">**Tipi di dati con lunghezza dipendente dalla precisione**</span><span class="sxs-lookup"><span data-stu-id="eb076-182">**Precision-Dependent-Length Data Types**</span></span>  
  
|<span data-ttu-id="eb076-183">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="eb076-183">Data type</span></span>|<span data-ttu-id="eb076-184">Byte non di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-184">Nonsparse bytes</span></span>|<span data-ttu-id="eb076-185">Byte di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-185">Sparse bytes</span></span>|<span data-ttu-id="eb076-186">Percentuale valori Null</span><span class="sxs-lookup"><span data-stu-id="eb076-186">NULL percentage</span></span>|  
|---------------|---------------------|------------------|---------------------|  
|`datetime2(0)`|<span data-ttu-id="eb076-187">6</span><span class="sxs-lookup"><span data-stu-id="eb076-187">6</span></span>|<span data-ttu-id="eb076-188">10</span><span class="sxs-lookup"><span data-stu-id="eb076-188">10</span></span>|<span data-ttu-id="eb076-189">57%</span><span class="sxs-lookup"><span data-stu-id="eb076-189">57%</span></span>|  
|`datetime2(7)`|<span data-ttu-id="eb076-190">8</span><span class="sxs-lookup"><span data-stu-id="eb076-190">8</span></span>|<span data-ttu-id="eb076-191">12</span><span class="sxs-lookup"><span data-stu-id="eb076-191">12</span></span>|<span data-ttu-id="eb076-192">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-192">52%</span></span>|  
|`time(0)`|<span data-ttu-id="eb076-193">3</span><span class="sxs-lookup"><span data-stu-id="eb076-193">3</span></span>|<span data-ttu-id="eb076-194">7</span><span class="sxs-lookup"><span data-stu-id="eb076-194">7</span></span>|<span data-ttu-id="eb076-195">69%</span><span class="sxs-lookup"><span data-stu-id="eb076-195">69%</span></span>|  
|`time(7)`|<span data-ttu-id="eb076-196">5</span><span class="sxs-lookup"><span data-stu-id="eb076-196">5</span></span>|<span data-ttu-id="eb076-197">9</span><span class="sxs-lookup"><span data-stu-id="eb076-197">9</span></span>|<span data-ttu-id="eb076-198">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-198">60%</span></span>|  
|`datetimetoffset(0)`|<span data-ttu-id="eb076-199">8</span><span class="sxs-lookup"><span data-stu-id="eb076-199">8</span></span>|<span data-ttu-id="eb076-200">12</span><span class="sxs-lookup"><span data-stu-id="eb076-200">12</span></span>|<span data-ttu-id="eb076-201">52%</span><span class="sxs-lookup"><span data-stu-id="eb076-201">52%</span></span>|  
|`datetimetoffset (7)`|<span data-ttu-id="eb076-202">10</span><span class="sxs-lookup"><span data-stu-id="eb076-202">10</span></span>|<span data-ttu-id="eb076-203">14</span><span class="sxs-lookup"><span data-stu-id="eb076-203">14</span></span>|<span data-ttu-id="eb076-204">49%</span><span class="sxs-lookup"><span data-stu-id="eb076-204">49%</span></span>|  
|`decimal/numeric(1,s)`|<span data-ttu-id="eb076-205">5</span><span class="sxs-lookup"><span data-stu-id="eb076-205">5</span></span>|<span data-ttu-id="eb076-206">9</span><span class="sxs-lookup"><span data-stu-id="eb076-206">9</span></span>|<span data-ttu-id="eb076-207">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-207">60%</span></span>|  
|`decimal/numeric(38,s)`|<span data-ttu-id="eb076-208">17</span><span class="sxs-lookup"><span data-stu-id="eb076-208">17</span></span>|<span data-ttu-id="eb076-209">21</span><span class="sxs-lookup"><span data-stu-id="eb076-209">21</span></span>|<span data-ttu-id="eb076-210">42%</span><span class="sxs-lookup"><span data-stu-id="eb076-210">42%</span></span>|  
|`vardecimal(p,s)`|<span data-ttu-id="eb076-211">Utilizzare il tipo `decimal` come stima conservativa.</span><span class="sxs-lookup"><span data-stu-id="eb076-211">Use the `decimal` type as a conservative estimate.</span></span>|||  
  
 <span data-ttu-id="eb076-212">**Tipi di dati con lunghezza dipendente dai dati**</span><span class="sxs-lookup"><span data-stu-id="eb076-212">**Data-Dependent-Length Data Types**</span></span>  
  
|<span data-ttu-id="eb076-213">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="eb076-213">Data type</span></span>|<span data-ttu-id="eb076-214">Byte non di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-214">Nonsparse bytes</span></span>|<span data-ttu-id="eb076-215">Byte di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-215">Sparse bytes</span></span>|<span data-ttu-id="eb076-216">Percentuale valori Null</span><span class="sxs-lookup"><span data-stu-id="eb076-216">NULL percentage</span></span>|  
|---------------|---------------------|------------------|---------------------|  
|`sql_variant`|<span data-ttu-id="eb076-217">Varia in base al tipo di dati sottostante</span><span class="sxs-lookup"><span data-stu-id="eb076-217">Varies with the underlying data type</span></span>|||  
|<span data-ttu-id="eb076-218">`varchar` o `char`</span><span class="sxs-lookup"><span data-stu-id="eb076-218">`varchar` or `char`</span></span>|<span data-ttu-id="eb076-219">2\*</span><span class="sxs-lookup"><span data-stu-id="eb076-219">2\*</span></span>|<span data-ttu-id="eb076-220">4\*</span><span class="sxs-lookup"><span data-stu-id="eb076-220">4\*</span></span>|<span data-ttu-id="eb076-221">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-221">60%</span></span>|  
|<span data-ttu-id="eb076-222">`nvarchar` o `nchar`</span><span class="sxs-lookup"><span data-stu-id="eb076-222">`nvarchar` or `nchar`</span></span>|<span data-ttu-id="eb076-223">2\*</span><span class="sxs-lookup"><span data-stu-id="eb076-223">2\*</span></span>|<span data-ttu-id="eb076-224">4\*+</span><span class="sxs-lookup"><span data-stu-id="eb076-224">4\*+</span></span>|<span data-ttu-id="eb076-225">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-225">60%</span></span>|  
|<span data-ttu-id="eb076-226">`varbinary` o `binary`</span><span class="sxs-lookup"><span data-stu-id="eb076-226">`varbinary` or `binary`</span></span>|<span data-ttu-id="eb076-227">2\*</span><span class="sxs-lookup"><span data-stu-id="eb076-227">2\*</span></span>|<span data-ttu-id="eb076-228">4\*</span><span class="sxs-lookup"><span data-stu-id="eb076-228">4\*</span></span>|<span data-ttu-id="eb076-229">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-229">60%</span></span>|  
|`xml`|<span data-ttu-id="eb076-230">2\*</span><span class="sxs-lookup"><span data-stu-id="eb076-230">2\*</span></span>|<span data-ttu-id="eb076-231">4\*</span><span class="sxs-lookup"><span data-stu-id="eb076-231">4\*</span></span>|<span data-ttu-id="eb076-232">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-232">60%</span></span>|  
|`hierarchyid`|<span data-ttu-id="eb076-233">2\*</span><span class="sxs-lookup"><span data-stu-id="eb076-233">2\*</span></span>|<span data-ttu-id="eb076-234">4\*</span><span class="sxs-lookup"><span data-stu-id="eb076-234">4\*</span></span>|<span data-ttu-id="eb076-235">60%</span><span class="sxs-lookup"><span data-stu-id="eb076-235">60%</span></span>|  
  
 <span data-ttu-id="eb076-236">\*La lunghezza è uguale alla media dei dati contenuti nel tipo, più 2 o 4 byte.</span><span class="sxs-lookup"><span data-stu-id="eb076-236">\*The length is equal to the average of the data that is contained in the type, plus 2 or 4 bytes.</span></span>  
  
## <a name="in-memory-overhead-required-for-updates-to-sparse-columns"></a><span data-ttu-id="eb076-237">Overhead in memoria necessario per gli aggiornamenti alle colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-237">In-Memory Overhead Required for Updates to Sparse Columns</span></span>  
 <span data-ttu-id="eb076-238">Quando si progettano tabelle con colonne di tipo sparse, ricordare che sono necessari 2 byte aggiuntivi di overhead per ogni colonna di tipo sparse non Null nella tabella quando viene aggiornata una riga.</span><span class="sxs-lookup"><span data-stu-id="eb076-238">When designing tables with sparse columns, keep in mind that an additional 2 bytes of overhead are required for each non-null sparse column in the table when a row is being updated.</span></span> <span data-ttu-id="eb076-239">Dato questo requisito di memoria aggiuntivo, gli aggiornamenti potrebbero non riuscire in modo imprevisto con l'errore 576 quando le dimensioni totali della riga, incluso l'overhead di memoria, supera 8019 e nessuna colonna può essere spostata all'esterno della riga.</span><span class="sxs-lookup"><span data-stu-id="eb076-239">As a result of this additional memory requirement, updates can fail unexpectedly with error 576 when the total row size, including this memory overhead, exceeds 8019, and no columns can be pushed off the row.</span></span>  
  
 <span data-ttu-id="eb076-240">Si consideri l'esempio di una tabella contenente 600 colonne di tipo sparse di tipo bigint.</span><span class="sxs-lookup"><span data-stu-id="eb076-240">Consider the example of a table that has 600 sparse columns of type bigint.</span></span> <span data-ttu-id="eb076-241">Se le colonne non Null sono 571, la dimensione totale su disco è pari a 571 \* 12 = 6852 byte.</span><span class="sxs-lookup"><span data-stu-id="eb076-241">If there are 571 non-null columns, then the total size on disk is 571 \* 12 = 6852 bytes.</span></span> <span data-ttu-id="eb076-242">Dopo avere incluso l'overhead di riga aggiuntivo e l'intestazione della colonna di tipo sparse, i byte aumentano a 6895.</span><span class="sxs-lookup"><span data-stu-id="eb076-242">After including additional row overhead and the sparse column header, this increases to around 6895 bytes.</span></span> <span data-ttu-id="eb076-243">Per la pagina sono ancora disponibili su disco 1124 byte.</span><span class="sxs-lookup"><span data-stu-id="eb076-243">The page still has around 1124 bytes available on disk.</span></span> <span data-ttu-id="eb076-244">Ciò può dare l'impressione che sia possibile aggiornare correttamente le colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="eb076-244">This can give the impression that additional columns can be updated successfully.</span></span> <span data-ttu-id="eb076-245">Durante l'aggiornamento, tuttavia, si verifica un ulteriore overhead in memoria pari a 2\*(numero di colonne di tipo sparse non Null).</span><span class="sxs-lookup"><span data-stu-id="eb076-245">However, during the update, there is additional overhead in memory which is 2\*(number of non-null sparse columns).</span></span> <span data-ttu-id="eb076-246">In questo esempio, incluso l'overhead aggiuntivo, ovvero 2 \* 571 = 1142 byte, le dimensioni della riga su disco aumentano a 8037 byte.</span><span class="sxs-lookup"><span data-stu-id="eb076-246">In this example, including the additional overhead - 2 \* 571 = 1142 bytes - increases the row size on disk to around 8037 bytes.</span></span> <span data-ttu-id="eb076-247">Queste dimensioni superano le dimensioni massime consentite di 8019 byte.</span><span class="sxs-lookup"><span data-stu-id="eb076-247">This size exceeds the maximum allowed size of 8019 bytes.</span></span> <span data-ttu-id="eb076-248">Poiché tutte le colonne sono tipi di dati a lunghezza fissa, non è possibile spostarle all'esterno della riga.</span><span class="sxs-lookup"><span data-stu-id="eb076-248">Since all the columns are fixed-length data types, they cannot be pushed off the row.</span></span> <span data-ttu-id="eb076-249">Di conseguenza, durante l'aggiornamento si verificherà l'errore 576.</span><span class="sxs-lookup"><span data-stu-id="eb076-249">As a result, the update fails with the 576 error.</span></span>  
  
## <a name="restrictions-for-using-sparse-columns"></a><span data-ttu-id="eb076-250">Restrizioni relative all'utilizzo di colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-250">Restrictions for Using Sparse Columns</span></span>  
 <span data-ttu-id="eb076-251">Le colonne di tipo sparse possono essere di qualsiasi tipo di dati di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e presentano un comportamento analogo a qualsiasi altra colonna, ma con le restrizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="eb076-251">Sparse columns can be of any [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type and behave like any other column with the following restrictions:</span></span>  
  
-   <span data-ttu-id="eb076-252">Una colonna di tipo sparse deve ammettere i valori Null e non può includere proprietà ROWGUIDCOL o IDENTITY.</span><span class="sxs-lookup"><span data-stu-id="eb076-252">A sparse column must be nullable and cannot have the ROWGUIDCOL or IDENTITY properties.</span></span> <span data-ttu-id="eb076-253">Una colonna di tipo sparse non può essere costituita dai tipi di dati `text`, `ntext`, `image`, `timestamp`, tipi di dati definiti dall'utente, `geometry` o `geography` né disporre dell'attributo FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="eb076-253">A sparse column cannot be of the following data types: `text`, `ntext`, `image`, `timestamp`, user-defined data type, `geometry`, or `geography`; or have the FILESTREAM attribute.</span></span>  
  
-   <span data-ttu-id="eb076-254">Una colonna di tipo sparse non può avere un valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="eb076-254">A sparse column cannot have a default value.</span></span>  
  
-   <span data-ttu-id="eb076-255">Una colonna di tipo sparse non può essere associata a una regola.</span><span class="sxs-lookup"><span data-stu-id="eb076-255">A sparse column cannot be bound to a rule.</span></span>  
  
-   <span data-ttu-id="eb076-256">Sebbene possa contenere una colonna di tipo sparse, una colonna calcolata non può essere contrassegnata come SPARSE.</span><span class="sxs-lookup"><span data-stu-id="eb076-256">Although a computed column can contain a sparse column, a computed column cannot be marked as SPARSE.</span></span>  
  
-   <span data-ttu-id="eb076-257">Una colonna di tipo sparse non può far parte di un indice cluster o di un indice di chiave primaria univoco.</span><span class="sxs-lookup"><span data-stu-id="eb076-257">A sparse column cannot be part of a clustered index or a unique primary key index.</span></span> <span data-ttu-id="eb076-258">Sia le colonne calcolate persistenti sia quelle non persistenti definite in colonne di tipo sparse, tuttavia, possono far parte di una chiave cluster.</span><span class="sxs-lookup"><span data-stu-id="eb076-258">However, both persisted and nonpersisted computed columns that are defined on sparse columns can be part of a clustered key.</span></span>  
  
-   <span data-ttu-id="eb076-259">Una colonna di tipo sparse non può essere utilizzata come chiave di partizione di un indice cluster o di un heap,</span><span class="sxs-lookup"><span data-stu-id="eb076-259">A sparse column cannot be used as a partition key of a clustered index or heap.</span></span> <span data-ttu-id="eb076-260">ma può essere utilizzata come chiave di partizione di un indice non cluster.</span><span class="sxs-lookup"><span data-stu-id="eb076-260">However, a sparse column can be used as the partition key of a nonclustered index.</span></span>  
  
-   <span data-ttu-id="eb076-261">Una colonna di tipo sparse non può far parte di un tipo di tabella definito dall'utente, utilizzato in variabili di tabella e in parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="eb076-261">A sparse column cannot be part of a user-defined table type, which are used in table variables and table-valued parameters.</span></span>  
  
-   <span data-ttu-id="eb076-262">Le colonne di tipo sparse sono incompatibili con la compressione dei dati.</span><span class="sxs-lookup"><span data-stu-id="eb076-262">Sparse columns are incompatible with data compression.</span></span> <span data-ttu-id="eb076-263">Non è pertanto possibile aggiungere colonne di tipo sparse alle tabelle compresse, né comprimere tabelle contenenti colonne di tipo sparse.</span><span class="sxs-lookup"><span data-stu-id="eb076-263">Therefore sparse columns cannot be added to compressed tables, nor can any tables containing sparse columns be compressed.</span></span>  
  
-   <span data-ttu-id="eb076-264">Per modificare una colonna di tipo sparse in non sparse o viceversa, è necessario modificare il formato di archiviazione della colonna.</span><span class="sxs-lookup"><span data-stu-id="eb076-264">Changing a column from sparse to nonsparse or nonsparse to sparse requires changing the storage format of the column.</span></span> <span data-ttu-id="eb076-265">Per effettuare questa modifica, nel Motore di database di SQL Server viene utilizzata la procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="eb076-265">The SQL Server Database Engine uses the following procedure to accomplish this change:</span></span>  
  
    1.  <span data-ttu-id="eb076-266">Viene aggiunta una nuova colonna alla tabella con le nuove dimensioni e nel nuovo formato di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="eb076-266">Adds a new column to the table in the new storage size and format.</span></span>  
  
    2.  <span data-ttu-id="eb076-267">Per ogni riga della tabella, il valore archiviato nella colonna precedente viene aggiornato e copiato nella nuova colonna.</span><span class="sxs-lookup"><span data-stu-id="eb076-267">For each row in the table, updates and copies the value stored in the old column to the new column.</span></span>  
  
    3.  <span data-ttu-id="eb076-268">La colonna precedente viene rimossa dallo schema della tabella.</span><span class="sxs-lookup"><span data-stu-id="eb076-268">Removes the old column from the table schema.</span></span>  
  
    4.  <span data-ttu-id="eb076-269">Viene ricompilata la tabella, se non include un indice cluster, oppure viene ricompilato l'indice cluster per recuperare lo spazio utilizzato dalla colonna precedente.</span><span class="sxs-lookup"><span data-stu-id="eb076-269">Rebuilds the table (if there is no clustered index) or rebuilds the clustered index to reclaim space used by the old column.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="eb076-270">È possibile che il passaggio 2 non venga completato correttamente se i dati della riga superano le dimensioni di riga massime consentite.</span><span class="sxs-lookup"><span data-stu-id="eb076-270">Step 2 can fail when the size of the data in the row exceeds the maximum allowable row size.</span></span> <span data-ttu-id="eb076-271">Tali dimensioni includono quelle dei dati archiviati nella colonna precedente e quelle dei dati aggiornati archiviati nella nuova colonna.</span><span class="sxs-lookup"><span data-stu-id="eb076-271">This size includes the size of the data stored in the old column and the updated data stored in the new column.</span></span> <span data-ttu-id="eb076-272">Il limite è di 8060 byte per le tabelle che non contengono colonne di tipo sparse o di 8018 byte per le tabelle che contengono colonne di tipo sparse.</span><span class="sxs-lookup"><span data-stu-id="eb076-272">This limit is 8060 bytes for tables that do not contain any sparse columns or 8018 bytes for tables that contain sparse columns.</span></span> <span data-ttu-id="eb076-273">Questo errore può verificarsi anche se tutte le colonne idonee sono state spostate all'esterno delle righe.</span><span class="sxs-lookup"><span data-stu-id="eb076-273">This error can occur even if all eligible columns have been pushed off-row.</span></span>  
  
-   <span data-ttu-id="eb076-274">Quando una colonna non di tipo sparse viene modificata in una di tipo sparse, quest'ultima utilizzerà una quantità di spazio maggiore per i valori non Null.</span><span class="sxs-lookup"><span data-stu-id="eb076-274">When you change a non-sparse column to a sparse column, the sparse column will consume more space for non-null values.</span></span> <span data-ttu-id="eb076-275">Quando le dimensioni di una riga si avvicinano al limite massimo consentito, potrebbe non essere possibile completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="eb076-275">When a row is close to the maximum row size limit, the operation can fail.</span></span>  
  
## <a name="sql-server-technologies-that-support-sparse-columns"></a><span data-ttu-id="eb076-276">Tecnologie SQL Server che supportano le colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="eb076-276">SQL Server Technologies That Support Sparse Columns</span></span>  
 <span data-ttu-id="eb076-277">In questa sezione viene descritto il supporto delle colonne di tipo sparse nelle tecnologie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] seguenti:</span><span class="sxs-lookup"><span data-stu-id="eb076-277">This section describes how sparse columns are supported in the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] technologies:</span></span>  
  
-   <span data-ttu-id="eb076-278">Replica transazionale</span><span class="sxs-lookup"><span data-stu-id="eb076-278">Transactional replication</span></span>  
  
     <span data-ttu-id="eb076-279">La replica transazionale supporta le colonne di tipo sparse, ma non i set di colonne che possono essere utilizzati con le colonne di tipo sparse.</span><span class="sxs-lookup"><span data-stu-id="eb076-279">Transactional replication supports sparse columns, but it does not support column sets, which can be used with sparse columns.</span></span> <span data-ttu-id="eb076-280">Per altre informazioni sui set di colonne, vedere [Utilizzare set di colonne](../tables/use-column-sets.md).</span><span class="sxs-lookup"><span data-stu-id="eb076-280">For more information about column sets, see [Use Column Sets](../tables/use-column-sets.md).</span></span>  
  
     <span data-ttu-id="eb076-281">La replica dell'attributo SPARSE è determinata da un'opzione di schema specificata utilizzando [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) o la finestra di dialogo **Article Properties** in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eb076-281">The replication of the SPARSE attribute is determined by a schema option that is specified by using [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) or by using the **Article Properties** dialog box in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="eb076-282">Le versioni precedenti di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non supportano le colonne di tipo sparse.</span><span class="sxs-lookup"><span data-stu-id="eb076-282">Earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] do not support sparse columns.</span></span> <span data-ttu-id="eb076-283">Se è necessario replicare dati in una versione precedente, specificare che l'attributo SPARSE non deve essere replicato.</span><span class="sxs-lookup"><span data-stu-id="eb076-283">If you must replicate data to an earlier version, specify that the SPARSE attribute should not be replicated.</span></span>  
  
     <span data-ttu-id="eb076-284">Per le tabelle pubblicate, non è possibile aggiungere nuove colonne di tipo sparse a una tabella né modificare la proprietà sparse di una colonna esistente.</span><span class="sxs-lookup"><span data-stu-id="eb076-284">For tables that are published, you cannot add any new sparse columns to a table or change the sparse property of an existing column.</span></span> <span data-ttu-id="eb076-285">Se questa operazione è necessaria, eliminare e ricreare la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="eb076-285">If such an operation is required, drop and re-create the publication.</span></span>  
  
-   <span data-ttu-id="eb076-286">Replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="eb076-286">Merge replication</span></span>  
  
     <span data-ttu-id="eb076-287">La replica di tipo merge non supporta le colonne di tipo sparse né i set di colonne.</span><span class="sxs-lookup"><span data-stu-id="eb076-287">Merge replication does not support sparse columns or column sets.</span></span>  
  
-   <span data-ttu-id="eb076-288">Change tracking</span><span class="sxs-lookup"><span data-stu-id="eb076-288">Change tracking</span></span>  
  
     <span data-ttu-id="eb076-289">Il rilevamento delle modifiche supporta le colonne di tipo sparse e i set di colonne.</span><span class="sxs-lookup"><span data-stu-id="eb076-289">Change tracking supports sparse columns and column sets.</span></span> <span data-ttu-id="eb076-290">Quando un set di colonne viene aggiornato in una tabella, il rilevamento delle modifiche considera questa operazione un aggiornamento all'intera riga.</span><span class="sxs-lookup"><span data-stu-id="eb076-290">When a column set is updated in a table, change tracking treats this as an update to the whole row.</span></span> <span data-ttu-id="eb076-291">Non è disponibile alcun rilevamento delle modifiche dettagliato per ottenere il set esatto di colonne di tipo sparse aggiornate mediante l'aggiornamento del set di colonne.</span><span class="sxs-lookup"><span data-stu-id="eb076-291">No detailed change tracking is provided to obtain the exact set of sparse columns that are updated through the column set update operation.</span></span> <span data-ttu-id="eb076-292">Se le colonne di tipo sparse vengono aggiornate in modo esplicito mediante un'istruzione DML, il rilevamento delle modifiche su tali colonne funzionerà nel modo usuale e verrà identificato il set esatto delle colonne modificate.</span><span class="sxs-lookup"><span data-stu-id="eb076-292">If the sparse columns are updated explicitly through a DML statement, change tracking on them will work ordinarily and can identify the exact set of changed columns.</span></span>  
  
-   <span data-ttu-id="eb076-293">Change Data Capture</span><span class="sxs-lookup"><span data-stu-id="eb076-293">Change data capture</span></span>  
  
     <span data-ttu-id="eb076-294">La funzionalità Change Data Capture supporta le colonne di tipo sparse, ma non i set di colonne.</span><span class="sxs-lookup"><span data-stu-id="eb076-294">Change data capture supports sparse columns, but it does not support column sets.</span></span>  
  
-   <span data-ttu-id="eb076-295">La proprietà di tipo sparse di una colonna non viene mantenuta in caso di copia della tabella.</span><span class="sxs-lookup"><span data-stu-id="eb076-295">The sparse property of a column is not preserved when the table is copied.</span></span>  
  
## <a name="examples"></a><span data-ttu-id="eb076-296">Esempi</span><span class="sxs-lookup"><span data-stu-id="eb076-296">Examples</span></span>  
 <span data-ttu-id="eb076-297">In questo esempio viene illustrata una tabella Document che contiene un set comune in cui sono presenti le colonne `DocID` e `Title`.</span><span class="sxs-lookup"><span data-stu-id="eb076-297">In this example, a document table contains a common set that has the columns `DocID` and `Title`.</span></span> <span data-ttu-id="eb076-298">Il gruppo Production richiede una colonna `ProductionSpecification` e una colonna `ProductionLocation` per tutti i documenti relativi alla produzione,</span><span class="sxs-lookup"><span data-stu-id="eb076-298">The Production group wants a `ProductionSpecification` and `ProductionLocation` column for all production documents.</span></span> <span data-ttu-id="eb076-299">mentre il gruppo Marketing richiede una colonna `MarketingSurveyGroup` per i documenti relativi al marketing.</span><span class="sxs-lookup"><span data-stu-id="eb076-299">The Marketing group wants a `MarketingSurveyGroup` column for marketing documents.</span></span> <span data-ttu-id="eb076-300">Tramite il codice incluso nell'esempio viene creata una tabella che utilizza colonne di tipo sparse, vengono inserite due righe nella tabella, quindi vengono selezionati dati nella tabella.</span><span class="sxs-lookup"><span data-stu-id="eb076-300">The code in this example creates a table that uses sparse columns, inserts two rows into the table, and then selects data from the table.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="eb076-301">Questa tabella è costituita solo da cinque colonne per semplificare la visualizzazione e la lettura.</span><span class="sxs-lookup"><span data-stu-id="eb076-301">This table has only five columns to make it easier to display and read.</span></span> <span data-ttu-id="eb076-302">Se è impostata l'opzione ANSI_NULL_DFLT_ON, è facoltativo dichiarare che le colonne di tipo sparse devono ammettere i valori Null.</span><span class="sxs-lookup"><span data-stu-id="eb076-302">Declaring the sparse columns to be nullable is optional if the ANSI_NULL_DFLT_ON option is set.</span></span>  
  
```  
USE AdventureWorks2012;  
GO  
  
CREATE TABLE DocumentStore  
    (DocID int PRIMARY KEY,  
     Title varchar(200) NOT NULL,  
     ProductionSpecification varchar(20) SPARSE NULL,  
     ProductionLocation smallint SPARSE NULL,  
     MarketingSurveyGroup varchar(20) SPARSE NULL ) ;  
GO  
  
INSERT DocumentStore(DocID, Title, ProductionSpecification, ProductionLocation)  
VALUES (1, 'Tire Spec 1', 'AXZZ217', 27);  
GO  
  
INSERT DocumentStore(DocID, Title, MarketingSurveyGroup)  
VALUES (2, 'Survey 2142', 'Men 25 - 35');  
GO  
```  
  
 <span data-ttu-id="eb076-303">Selezionando tutte le colonne della tabella viene restituito un set di risultati comune.</span><span class="sxs-lookup"><span data-stu-id="eb076-303">To select all the columns from the table returns an ordinary result set.</span></span>  
  
```  
SELECT * FROM DocumentStore ;  
```  
  
 [!INCLUDE[ssResult](../../includes/ssresult-md.md)]  
  
 `DocID  Title        ProductionSpecification  ProductionLocation  MarketingSurveyGroup`  
  
 `1      Tire Spec 1  AXZZ217                  27                  NULL`  
  
 `2      Survey 2142  NULL                     NULL                Men 25-35`  
  
 <span data-ttu-id="eb076-304">Poiché i dati di marketing non interessano il reparto Production, questo desidera utilizzare un elenco di colonne che restituisca solo colonne di interesse specifico, come illustrato nella query seguente.</span><span class="sxs-lookup"><span data-stu-id="eb076-304">Because the Production department is not interested in the marketing data, they want to use a column list that returns only columns of interest, as shown in the following query.</span></span>  
  
```  
SELECT DocID, Title, ProductionSpecification, ProductionLocation   
FROM DocumentStore   
WHERE ProductionSpecification IS NOT NULL ;  
```  
  
 [!INCLUDE[ssResult](../../includes/ssresult-md.md)]  
  
 `DocID  Title        ProductionSpecification  ProductionLocation`  
  
 `1      Tire Spec 1  AXZZ217                  27`  
  
## <a name="see-also"></a><span data-ttu-id="eb076-305">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="eb076-305">See Also</span></span>  
 <span data-ttu-id="eb076-306">[Usare set di colonne](../tables/use-column-sets.md) </span><span class="sxs-lookup"><span data-stu-id="eb076-306">[Use Column Sets](../tables/use-column-sets.md) </span></span>  
 <span data-ttu-id="eb076-307">[CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="eb076-307">[CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) </span></span>  
 <span data-ttu-id="eb076-308">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="eb076-308">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span></span>  
 [<span data-ttu-id="eb076-309">sys.columns &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="eb076-309">sys.columns &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-columns-transact-sql)  
  
  
