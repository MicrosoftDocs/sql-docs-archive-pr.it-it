---
title: Vincoli di chiavi primarie ed esterne | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- foreign keys [SQL Server], cascading referential integrity
- FOREIGN KEY constraints
- foreign keys [SQL Server]
- foreign keys [SQL Server], about foreign key constraints
ms.assetid: 31fbcc9f-2dc5-4bf9-aa50-ed70ec7b5bcd
author: stevestein
ms.author: sstein
ms.openlocfilehash: b6e7b88de880348fabb00cb46d3028716441bc2b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635972"
---
# <a name="primary-and-foreign-key-constraints"></a><span data-ttu-id="f5498-102">Vincoli di chiavi primarie ed esterne</span><span class="sxs-lookup"><span data-stu-id="f5498-102">Primary and Foreign Key Constraints</span></span>
  <span data-ttu-id="f5498-103">Le chiavi primarie e le chiavi esterne sono due tipi di vincoli che possono essere utilizzati per applicare l'integrità dei dati nelle tabelle di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f5498-103">Primary keys and foreign keys are two types of constraints that can be used to enforce data integrity in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="f5498-104">Si tratta di importanti oggetti di database.</span><span class="sxs-lookup"><span data-stu-id="f5498-104">These are important database objects.</span></span>

 <span data-ttu-id="f5498-105">In questo argomento sono contenute le sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="f5498-105">This topic contains the following sections.</span></span>

 [<span data-ttu-id="f5498-106">Vincoli di chiave primaria</span><span class="sxs-lookup"><span data-stu-id="f5498-106">Primary Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#PKeys)

 [<span data-ttu-id="f5498-107">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="f5498-107">Foreign Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#FKeys)

 [<span data-ttu-id="f5498-108">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="f5498-108">Related Tasks</span></span>](../tables/primary-and-foreign-key-constraints.md#Tasks)

##  <a name="primary-key-constraints"></a><a name="PKeys"></a> <span data-ttu-id="f5498-109">Vincoli di chiave primaria</span><span class="sxs-lookup"><span data-stu-id="f5498-109">Primary Key Constraints</span></span>
 <span data-ttu-id="f5498-110">Una tabella include in genere una colonna o una combinazione di colonne i cui valori identificano in modo univoco ogni riga della tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-110">A table typically has a column or combination of columns that contain values that uniquely identify each row in the table.</span></span> <span data-ttu-id="f5498-111">Queste colonne sono denominate chiave primaria e garantiscono l'integrità di entità della tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-111">This column, or columns, is called the primary key (PK) of the table and enforces the entity integrity of the table.</span></span> <span data-ttu-id="f5498-112">Poiché i vincoli di chiave primaria garantiscono l'univocità dei dati, vengono spesso definiti per la colonna Identity.</span><span class="sxs-lookup"><span data-stu-id="f5498-112">Because primary key constraints guarantee unique data, they are frequently defined on an identity column.</span></span>

 <span data-ttu-id="f5498-113">Quando si specifica un vincolo di chiave primaria per una tabella, [!INCLUDE[ssDE](../../includes/ssde-md.md)] assicura l'univocità dei dati creando automaticamente un indice univoco per le colonne chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-113">When you specify a primary key constraint for a table, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] enforces data uniqueness by automatically creating a unique index for the primary key columns.</span></span> <span data-ttu-id="f5498-114">Questo indice consente inoltre di accedere rapidamente ai dati quando si utilizza la chiave primaria nelle query.</span><span class="sxs-lookup"><span data-stu-id="f5498-114">This index also permits fast access to data when the primary key is used in queries.</span></span> <span data-ttu-id="f5498-115">Se un vincolo di chiave primaria viene definito per più colonne, possono essere presenti valori duplicati nella stessa colonna, ma ogni combinazione di valori di tutte le colonne nella definizione del vincolo di chiave primaria deve essere univoca.</span><span class="sxs-lookup"><span data-stu-id="f5498-115">If a primary key constraint is defined on more than one column, values may be duplicated within one column, but each combination of values from all the columns in the primary key constraint definition must be unique.</span></span>

 <span data-ttu-id="f5498-116">Le colonne **ProductID** e **VendorID** nella tabella **Purchasing.ProductVendor** costituiscono un vincolo di chiave primaria composto per la tabella, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="f5498-116">As shown in the following illustration, the **ProductID** and **VendorID** columns in the **Purchasing.ProductVendor** table form a composite primary key constraint for this table.</span></span> <span data-ttu-id="f5498-117">Ciò assicura che ogni riga nella tabella **ProductVendor** contenga una combinazione univoca di **ProductID** e **VendorID**.</span><span class="sxs-lookup"><span data-stu-id="f5498-117">This makes sure that every row in the **ProductVendor** table has a unique combination of **ProductID** and **VendorID**.</span></span> <span data-ttu-id="f5498-118">e impedisce l'inserimento di righe duplicate.</span><span class="sxs-lookup"><span data-stu-id="f5498-118">This prevents the insertion of duplicate rows.</span></span>

 <span data-ttu-id="f5498-119">![Vincolo PRIMARY KEY composto](../../database-engine/media/fund04.gif "Vincolo PRIMARY KEY composto")</span><span class="sxs-lookup"><span data-stu-id="f5498-119">![Composite PRIMARY KEY constraint](../../database-engine/media/fund04.gif "Composite PRIMARY KEY constraint")</span></span>

-   <span data-ttu-id="f5498-120">Una tabella può includere un solo vincolo di chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-120">A table can contain only one primary key constraint.</span></span>

-   <span data-ttu-id="f5498-121">Una chiave primaria non può superare 16 colonne e una lunghezza della chiave totale di 900 byte.</span><span class="sxs-lookup"><span data-stu-id="f5498-121">A primary key cannot exceed 16 columns and a total key length of 900 bytes.</span></span>

-   <span data-ttu-id="f5498-122">Se l'indice viene generato da un vincolo di chiave primaria, nella tabella sarà possibile creare non più di 999 indici non cluster e di 1 indice cluster.</span><span class="sxs-lookup"><span data-stu-id="f5498-122">The index generated by a primary key constraint cannot cause the number of indexes on the table to exceed 999 nonclustered indexes and 1 clustered index.</span></span>

-   <span data-ttu-id="f5498-123">Nel caso in cui per un vincolo di chiave primaria non si specifichi CLUSTERED né NONCLUSTERED, verrà utilizzato automaticamente il valore CLUSTERED se nella tabella non sono specificati indici cluster.</span><span class="sxs-lookup"><span data-stu-id="f5498-123">If clustered or nonclustered is not specified for a primary key constraint, clustered is used if there no clustered index on the table.</span></span>

-   <span data-ttu-id="f5498-124">Tutte le colonne specificate in un vincolo di chiave primaria devono essere definite come NOT NULL.</span><span class="sxs-lookup"><span data-stu-id="f5498-124">All columns defined within a primary key constraint must be defined as not null.</span></span> <span data-ttu-id="f5498-125">Se non si specifica il supporto di valori Null, per tutte le colonne coinvolte in un vincolo di chiave primaria viene impostato NOT NULL.</span><span class="sxs-lookup"><span data-stu-id="f5498-125">If nullability is not specified, all columns participating in a primary key constraint have their nullability set to not null.</span></span>

-   <span data-ttu-id="f5498-126">Se si definisce una chiave primaria in una colonna di tipo CLR definito dall'utente, è necessario che l'implementazione del tipo supporti l'ordinamento binario.</span><span class="sxs-lookup"><span data-stu-id="f5498-126">If a primary key is defined on a CLR user-defined type column, the implementation of the type must support binary ordering.</span></span>

##  <a name="foreign-key-constraints"></a><a name="FKeys"></a> <span data-ttu-id="f5498-127">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="f5498-127">Foreign Key Constraints</span></span>
 <span data-ttu-id="f5498-128">Per chiave esterna si intende una colonna o combinazione di colonne utilizzata per stabilire e applicare un collegamento tra i dati di due tabelle per controllare i dati che possono essere archiviati nella tabella della chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-128">A foreign key (FK) is a column or combination of columns that is used to establish and enforce a link between the data in two tables to control the data that can be stored in the foreign key table.</span></span> <span data-ttu-id="f5498-129">In un riferimento a una chiave esterna viene creato un collegamento tra tabelle quando le colonne contenenti il valore della chiave primaria per una tabella vengono utilizzate come riferimento dalle colonne di un'altra tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-129">In a foreign key reference, a link is created between two tables when the column or columns that hold the primary key value for one table are referenced by the column or columns in another table.</span></span> <span data-ttu-id="f5498-130">Questa colonna diventa una chiave esterna nella seconda tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-130">This column becomes a foreign key in the second table.</span></span>

 <span data-ttu-id="f5498-131">Nella tabella **Sales.SalesOrderHeader** , ad esempio, è incluso un collegamento di chiave esterna alla tabella **Sales.SalesPerson** , in quanto esiste una relazione logica tra gli ordini di vendita e i venditori.</span><span class="sxs-lookup"><span data-stu-id="f5498-131">For example, the **Sales.SalesOrderHeader** table has a foreign key link to the **Sales.SalesPerson** table because there is a logical relationship between sales orders and salespeople.</span></span> <span data-ttu-id="f5498-132">La colonna **SalesPersonID** della tabella **SalesOrderHeader** corrisponde alla colonna chiave primaria della tabella **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="f5498-132">The **SalesPersonID** column in the **SalesOrderHeader** table matches the primary key column of the **SalesPerson** table.</span></span> <span data-ttu-id="f5498-133">La colonna **SalesPersonID** della tabella **SalesOrderHeader** rappresenta la chiave esterna alla tabella **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="f5498-133">The **SalesPersonID** column in the **SalesOrderHeader** table is the foreign key to the **SalesPerson** table.</span></span> <span data-ttu-id="f5498-134">Creando questa relazione di chiave esterna, non è possibile inserire un valore per **SalesPersonID** nella tabella **SalesOrderHeader** se non esiste già nella tabella **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="f5498-134">By creating this foreign key relationship, a value for **SalesPersonID** cannot be inserted into the **SalesOrderHeader** table if it does not already exist in the **SalesPerson** table.</span></span>

### <a name="indexes-on-foreign-key-constraints"></a><span data-ttu-id="f5498-135">Indici nei vincoli di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-135">Indexes on Foreign Key Constraints</span></span>
 <span data-ttu-id="f5498-136">A differenza di quanto avviene per i vincoli di chiave primaria, la creazione di un vincolo di chiave esterna non determina automaticamente la creazione di un indice corrispondente.</span><span class="sxs-lookup"><span data-stu-id="f5498-136">Unlike primary key constraints, creating a foreign key constraint does not automatically create a corresponding index.</span></span> <span data-ttu-id="f5498-137">La creazione manuale di un indice in una chiave esterna, tuttavia, rappresenta spesso un'operazione utile per i motivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="f5498-137">However, manually creating an index on a foreign key is often useful for the following reasons:</span></span>

-   <span data-ttu-id="f5498-138">Le colonne chiave esterna vengono in genere utilizzate nei criteri di join quando i dati provenienti da tabelle correlate vengono riuniti in query confrontando le colonne nel vincolo di chiave esterna di una tabella con le colonne chiave primaria o univoca nell'altra tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-138">Foreign key columns are frequently used in join criteria when the data from related tables is combined in queries by matching the column or columns in the foreign key constraint of one table with the primary or unique key column or columns in the other table.</span></span> <span data-ttu-id="f5498-139">Un indice consente a [!INCLUDE[ssDE](../../includes/ssde-md.md)] di trovare rapidamente i dati correlati nella tabella della chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-139">An index enables the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to quickly find related data in the foreign key table.</span></span> <span data-ttu-id="f5498-140">La creazione di questo indice, tuttavia, non è un requisito necessario.</span><span class="sxs-lookup"><span data-stu-id="f5498-140">However, creating this index is not required.</span></span> <span data-ttu-id="f5498-141">È possibile riunire i dati di due tabelle correlate anche se non è stato definito alcun vincolo di chiave primaria o di chiave esterna tra le tabelle, ma una relazione di chiave esterna tra due tabelle indica che le due tabelle sono state ottimizzate per essere riunite in una query che utilizza le chiavi come criteri.</span><span class="sxs-lookup"><span data-stu-id="f5498-141">Data from two related tables can be combined even if no primary key or foreign key constraints are defined between the tables, but a foreign key relationship between two tables indicates that the two tables have been optimized to be combined in a query that uses the keys as its criteria.</span></span>

-   <span data-ttu-id="f5498-142">Le modifiche apportate ai vincoli di chiave primaria vengono confrontate con i vincoli di chiave esterna nelle tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="f5498-142">Changes to primary key constraints are checked with foreign key constraints in related tables.</span></span>

### <a name="referential-integrity"></a><span data-ttu-id="f5498-143">Integrità referenziale</span><span class="sxs-lookup"><span data-stu-id="f5498-143">Referential Integrity</span></span>
 <span data-ttu-id="f5498-144">Benché lo scopo primario di un vincolo di chiave esterna consista nel controllare i dati che è possibile archiviare nella tabella della chiave esterna, tale vincolo controlla inoltre le modifiche apportate ai dati nella tabella della chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-144">Although the main purpose of a foreign key constraint is to control the data that can be stored in the foreign key table, it also controls changes to data in the primary key table.</span></span> <span data-ttu-id="f5498-145">Se, ad esempio, la riga relativa a un venditore viene eliminata dalla tabella **Sales.SalesPerson** e l'ID del venditore viene usato per gli ordini di vendita inclusi nella tabella **Sales.SalesOrderHeader** , viene interrotta l'integrità relazionale tra le due tabelle. Gli ordini di vendita del venditore eliminato risultano isolati (orfani) nella tabella **SalesOrderHeader** e privi di un collegamento ai dati inclusi nella tabella **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="f5498-145">For example, if the row for a salesperson is deleted from the **Sales.SalesPerson** table, and the salesperson's ID is used for sales orders in the **Sales.SalesOrderHeader** table, the relational integrity between the two tables is broken; the deleted salesperson's sales orders are orphaned in the **SalesOrderHeader** table without a link to the data in the **SalesPerson** table.</span></span>

 <span data-ttu-id="f5498-146">Un vincolo di chiave esterna impedisce il verificarsi di tale situazione</span><span class="sxs-lookup"><span data-stu-id="f5498-146">A foreign key constraint prevents this situation.</span></span> <span data-ttu-id="f5498-147">e applica l'integrità referenziale assicurando che non sia possibile apportare modifiche alla tabella della chiave primaria se tali modifiche annullano il collegamento ai dati della tabella della chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-147">The constraint enforces referential integrity by guaranteeing that changes cannot be made to data in the primary key table if those changes invalidate the link to data in the foreign key table.</span></span> <span data-ttu-id="f5498-148">Se si tenta di eliminare la riga in una tabella della chiave primaria oppure di modificare un valore della chiave primaria, l'azione avrà esito negativo se il valore della chiave primaria eliminato o modificato corrisponde a un valore nel vincolo di chiave esterna di un'altra tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-148">If an attempt is made to delete the row in a primary key table or to change a primary key value, the action will fail when the deleted or changed primary key value corresponds to a value in the foreign key constraint of another table.</span></span> <span data-ttu-id="f5498-149">Per modificare o eliminare correttamente una riga in un vincolo di chiave esterna, è necessario innanzitutto modificare o eliminare i dati della chiave esterna nella tabella della chiave esterna e collegare quindi la chiave esterna ad altri dati della chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-149">To successfully change or delete a row in a foreign key constraint, you must first either delete the foreign key data in the foreign key table or change the foreign key data in the foreign key table, which links the foreign key to different primary key data.</span></span>

#### <a name="cascading-referential-integrity"></a><span data-ttu-id="f5498-150">Integrità referenziale di propagazione</span><span class="sxs-lookup"><span data-stu-id="f5498-150">Cascading Referential Integrity</span></span>
 <span data-ttu-id="f5498-151">I vincoli di integrità referenziale di propagazione consentono di definire le operazioni eseguite da [!INCLUDE[ssDE](../../includes/ssde-md.md)] quando un utente tenta di eliminare o aggiornare una chiave alla quale fa riferimento una chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-151">By using cascading referential integrity constraints, you can define the actions that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] takes when a user tries to delete or update a key to which existing foreign keys point.</span></span> <span data-ttu-id="f5498-152">È possibile definire le azioni di propagazione seguenti.</span><span class="sxs-lookup"><span data-stu-id="f5498-152">The following cascading actions can be defined.</span></span>

 <span data-ttu-id="f5498-153">Nessuna azione [!INCLUDE[ssDE](../../includes/ssde-md.md)] genera un errore e viene eseguito il rollback dell'azione di eliminazione o aggiornamento sulla riga nella tabella padre.</span><span class="sxs-lookup"><span data-stu-id="f5498-153">NO ACTION The [!INCLUDE[ssDE](../../includes/ssde-md.md)] raises an error and the delete or update action on the row in the parent table is rolled back.</span></span>

 <span data-ttu-id="f5498-154">Le righe corrispondenti a cascata vengono aggiornate o eliminate nella tabella di riferimento quando la riga viene aggiornata o eliminata nella tabella padre.</span><span class="sxs-lookup"><span data-stu-id="f5498-154">CASCADE Corresponding rows are updated or deleted in the referencing table when that row is updated or deleted in the parent table.</span></span> <span data-ttu-id="f5498-155">Non è possibile specificare la clausola CASCADE se nella chiave esterna o nella chiave a cui si fa riferimento è presente una colonna `timestamp`.</span><span class="sxs-lookup"><span data-stu-id="f5498-155">CASCADE cannot be specified if a `timestamp` column is part of either the foreign key or the referenced key.</span></span> <span data-ttu-id="f5498-156">Non è possibile specificare ON DELETE CASCADE per una tabella in cui è presente un trigger INSTEAD OF DELETE.</span><span class="sxs-lookup"><span data-stu-id="f5498-156">ON DELETE CASCADE cannot be specified for a table that has an INSTEAD OF DELETE trigger.</span></span> <span data-ttu-id="f5498-157">Non è possibile specificare ON UPDATE CASCADE per tabelle in cui sono presenti trigger INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="f5498-157">ON UPDATE CASCADE cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="f5498-158">SET NULL tutti i valori che compongono la chiave esterna vengono impostati su NULL quando viene aggiornata o eliminata la riga corrispondente nella tabella padre.</span><span class="sxs-lookup"><span data-stu-id="f5498-158">SET NULL All the values that make up the foreign key are set to NULL when the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="f5498-159">Per l'esecuzione di questo vincolo, è necessario che le colonne chiave esterna ammettano valori Null.</span><span class="sxs-lookup"><span data-stu-id="f5498-159">For this constraint to execute, the foreign key columns must be nullable.</span></span> <span data-ttu-id="f5498-160">Il vincolo non può essere specificato per tabelle in cui sono presenti trigger INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="f5498-160">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="f5498-161">Imposta predefiniti tutti i valori che costituiscono la chiave esterna vengono impostati sui rispettivi valori predefiniti se la riga corrispondente nella tabella padre viene aggiornata o eliminata.</span><span class="sxs-lookup"><span data-stu-id="f5498-161">SET DEFAULT All the values that make up the foreign key are set to their default values if the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="f5498-162">Per l'esecuzione di questo vincolo, è necessario che per tutte le colonne chiave esterna siano definiti valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="f5498-162">For this constraint to execute, all foreign key columns must have default definitions.</span></span> <span data-ttu-id="f5498-163">Se una colonna ammette valori Null e non viene impostato un valore predefinito esplicito, NULL diventa il valore predefinito implicito della colonna.</span><span class="sxs-lookup"><span data-stu-id="f5498-163">If a column is nullable, and there is no explicit default value set, NULL becomes the implicit default value of the column.</span></span> <span data-ttu-id="f5498-164">Il vincolo non può essere specificato per tabelle in cui sono presenti trigger INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="f5498-164">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="f5498-165">È possibile combinare le azioni CASCADE, SET NULL, SET DEFAULT e NO ACTION in tabelle con relazioni referenziali reciproche.</span><span class="sxs-lookup"><span data-stu-id="f5498-165">CASCADE, SET NULL, SET DEFAULT and NO ACTION can be combined on tables that have referential relationships with each other.</span></span> <span data-ttu-id="f5498-166">Se [!INCLUDE[ssDE](../../includes/ssde-md.md)] rileva l'azione NO ACTION, l'operazione viene arrestata e viene eseguito il rollback delle azioni CASCADE, SET NULL e SET DEFAULT correlate.</span><span class="sxs-lookup"><span data-stu-id="f5498-166">If the [!INCLUDE[ssDE](../../includes/ssde-md.md)] encounters NO ACTION, it stops and rolls back related CASCADE, SET NULL and SET DEFAULT actions.</span></span> <span data-ttu-id="f5498-167">Quando un'istruzione DELETE genera una combinazione di azioni CASCADE, SET NULL, SET DEFAULT e NO ACTION, tutte le azioni CASCADE, SET NULL e SET DEFAULT vengono applicate prima che il [!INCLUDE[ssDE](../../includes/ssde-md.md)] verifichi l'esistenza di azioni NO ACTION.</span><span class="sxs-lookup"><span data-stu-id="f5498-167">When a DELETE statement causes a combination of CASCADE, SET NULL, SET DEFAULT and NO ACTION actions, all the CASCADE, SET NULL and SET DEFAULT actions are applied before the [!INCLUDE[ssDE](../../includes/ssde-md.md)] checks for any NO ACTION.</span></span>

### <a name="triggers-and-cascading-referential-actions"></a><span data-ttu-id="f5498-168">Trigger e operazioni referenziali di propagazione</span><span class="sxs-lookup"><span data-stu-id="f5498-168">Triggers and Cascading Referential Actions</span></span>
 <span data-ttu-id="f5498-169">Le operazioni referenziali di propagazione attivano i trigger AFTER UPDATE o AFTER DELETE nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="f5498-169">Cascading referential actions fire the AFTER UPDATE or AFTER DELETE triggers in the following manner:</span></span>

-   <span data-ttu-id="f5498-170">Vengono eseguite per prime tutte le operazioni referenziali di propagazione determinate direttamente dall'istruzione DELETE o UPDATE originale.</span><span class="sxs-lookup"><span data-stu-id="f5498-170">All the cascading referential actions directly caused by the original DELETE or UPDATE are performed first.</span></span>

-   <span data-ttu-id="f5498-171">Se nelle tabelle interessate sono stati definiti trigger AFTER, tali trigger vengono attivati dopo che sono state eseguite tutte le operazioni di propagazione.</span><span class="sxs-lookup"><span data-stu-id="f5498-171">If there are any AFTER triggers defined on the affected tables, these triggers fire after all cascading actions are performed.</span></span> <span data-ttu-id="f5498-172">L'ordine di attivazione dei trigger è inverso rispetto all'ordine delle operazioni di propagazione.</span><span class="sxs-lookup"><span data-stu-id="f5498-172">These triggers fire in opposite order of the cascading action.</span></span> <span data-ttu-id="f5498-173">Se in una tabella sono presenti più trigger, tali trigger vengono attivati in ordine casuale a meno che per la tabella non sia stato specificato un primo o un ultimo trigger dedicato.</span><span class="sxs-lookup"><span data-stu-id="f5498-173">If there are multiple triggers on a single table, they fire in random order, unless there is a dedicated first or last trigger for the table.</span></span> <span data-ttu-id="f5498-174">L'ordine viene specificato usando [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f5498-174">This order is as specified by using [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span></span>

-   <span data-ttu-id="f5498-175">Se dalla tabella che rappresenta la destinazione diretta di un'azione UPDATE o DELETE vengono originate più catene di propagazione, l'ordine di attivazione dei rispettivi trigger non è specificato.</span><span class="sxs-lookup"><span data-stu-id="f5498-175">If multiple cascading chains originate from the table that was the direct target of an UPDATE or DELETE action, the order in which these chains fire their respective triggers is unspecified.</span></span> <span data-ttu-id="f5498-176">Prima che una catena inizi ad attivare i propri trigger è tuttavia necessario che un'altra catena abbia completato l'attivazione di tutti i relativi trigger.</span><span class="sxs-lookup"><span data-stu-id="f5498-176">However, one chain always fires all its triggers before another chain starts firing.</span></span>

-   <span data-ttu-id="f5498-177">Un trigger AFTER presente nella tabella di destinazione diretta di un'azione UPDATE o DELETE viene attivato indipendentemente dal fatto che influisca o meno su qualsiasi riga.</span><span class="sxs-lookup"><span data-stu-id="f5498-177">An AFTER trigger on the table that is the direct target of an UPDATE or DELETE action fires regardless of whether any rows are affected.</span></span> <span data-ttu-id="f5498-178">In questo caso, la propagazione non avrà effetti su nessun'altra tabella.</span><span class="sxs-lookup"><span data-stu-id="f5498-178">There are no other tables affected by cascading in this case.</span></span>

-   <span data-ttu-id="f5498-179">Se uno dei trigger precedenti esegue operazioni UPDATE o DELETE su altre tabelle, tali operazioni possono avviare catene di propagazione secondarie</span><span class="sxs-lookup"><span data-stu-id="f5498-179">If any one of the previous triggers perform UPDATE or DELETE operations on other tables, these actions can start secondary cascading chains.</span></span> <span data-ttu-id="f5498-180">che vengono elaborate per un'operazione UPDATE o DELETE alla volta dopo che tutti i trigger di tutte le catene primarie sono stati attivati.</span><span class="sxs-lookup"><span data-stu-id="f5498-180">These secondary chains are processed for each UPDATE or DELETE operation at a time after all triggers on all primary chains fire.</span></span> <span data-ttu-id="f5498-181">È possibile ripetere il processo in modo ricorsivo per le operazioni UPDATE o DELETE successive.</span><span class="sxs-lookup"><span data-stu-id="f5498-181">This process may be recursively repeated for subsequent UPDATE or DELETE operations.</span></span>

-   <span data-ttu-id="f5498-182">L'esecuzione di operazioni CREATE, ALTER, DELETE o di altre operazioni DDL (Data Definition Language) nei trigger può comportare l'attivazione dei trigger DDL</span><span class="sxs-lookup"><span data-stu-id="f5498-182">Performing CREATE, ALTER, DELETE, or other data definition language (DDL) operations inside the triggers may cause DDL triggers to fire.</span></span> <span data-ttu-id="f5498-183">e la conseguente esecuzione di operazioni DELETE o UPDATE che avviano catene e trigger di propagazione aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="f5498-183">This may subsequently perform DELETE or UPDATE operations that start additional cascading chains and triggers.</span></span>

-   <span data-ttu-id="f5498-184">Se in una catena di operazioni referenziali di propagazione si verifica un errore, verrà generato un errore, non verrà attivato alcun trigger AFTER nella catena specifica e verrà eseguito il rollback dell'operazione DELETE o UPDATE che ha creato la catena.</span><span class="sxs-lookup"><span data-stu-id="f5498-184">If an error is generated inside any particular cascading referential action chain, an error is raised, no AFTER triggers are fired in that chain, and the DELETE or UPDATE operation that created the chain is rolled back.</span></span>

-   <span data-ttu-id="f5498-185">Una tabella in cui è presente un trigger INSTEAD OF non può inoltre includere un clausola REFERENCES che specifica un'operazione di propagazione.</span><span class="sxs-lookup"><span data-stu-id="f5498-185">A table that has an INSTEAD OF trigger cannot also have a REFERENCES clause that specifies a cascading action.</span></span> <span data-ttu-id="f5498-186">Un trigger AFTER in una tabella di destinazione di un'operazione di propagazione può tuttavia eseguire un'istruzione INSERT, UPDATE o DELETE su un'altra tabella o vista che attiva un trigger INSTEAD OF definito nell'oggetto specifico.</span><span class="sxs-lookup"><span data-stu-id="f5498-186">However, an AFTER trigger on a table targeted by a cascading action can execute an INSERT, UPDATE, or DELETE statement on another table or view that fires an INSTEAD OF trigger defined on that object.</span></span>

##  <a name="related-tasks"></a><a name="Tasks"></a> <span data-ttu-id="f5498-187">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="f5498-187">Related Tasks</span></span>
 <span data-ttu-id="f5498-188">Nella tabella seguente vengono elencate le attività comuni associate a vincoli di chiave primaria e di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-188">The following table lists the common tasks associated with primary key and foreign key constraints.</span></span>

|<span data-ttu-id="f5498-189">Attività</span><span class="sxs-lookup"><span data-stu-id="f5498-189">Task</span></span>|<span data-ttu-id="f5498-190">Argomento</span><span class="sxs-lookup"><span data-stu-id="f5498-190">Topic</span></span>|
|----------|-----------|
|<span data-ttu-id="f5498-191">Viene descritto come creare una chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-191">Describes how to create a primary key.</span></span>|[<span data-ttu-id="f5498-192">Creazione di chiavi primarie</span><span class="sxs-lookup"><span data-stu-id="f5498-192">Create Primary Keys</span></span>](../tables/create-primary-keys.md)|
|<span data-ttu-id="f5498-193">Si descrive come eliminare una chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-193">Describes how to delete a primary key.</span></span>|[<span data-ttu-id="f5498-194">Eliminazione di chiavi primarie</span><span class="sxs-lookup"><span data-stu-id="f5498-194">Delete Primary Keys</span></span>](../tables/delete-primary-keys.md)|
|<span data-ttu-id="f5498-195">Si descrive come modificare una chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="f5498-195">Describes how to modify a primary key.</span></span>|[<span data-ttu-id="f5498-196">Modificare chiavi primarie</span><span class="sxs-lookup"><span data-stu-id="f5498-196">Modify Primary Keys</span></span>](../tables/modify-primary-keys.md)|
|<span data-ttu-id="f5498-197">Si descrive come creare relazioni di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-197">Describes how to create foreign key relationships</span></span>|[<span data-ttu-id="f5498-198">Creare relazioni di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-198">Create Foreign Key Relationships</span></span>](../tables/create-foreign-key-relationships.md)|
|<span data-ttu-id="f5498-199">Si descrive come modificare relazioni di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-199">Describes how to modify foreign key relationships.</span></span>|[<span data-ttu-id="f5498-200">Modifica di relazioni di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-200">Modify Foreign Key Relationships</span></span>](../tables/modify-foreign-key-relationships.md)|
|<span data-ttu-id="f5498-201">Si descrive come eliminare relazioni di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-201">Describes how to delete foreign key relationships.</span></span>|[<span data-ttu-id="f5498-202">Eliminare relazioni di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-202">Delete Foreign Key Relationships</span></span>](../tables/delete-foreign-key-relationships.md)|
|<span data-ttu-id="f5498-203">Viene descritto come visualizzare le proprietà di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="f5498-203">Describes how to view foreign key properties.</span></span>|[<span data-ttu-id="f5498-204">Visualizzare proprietà di chiave esterna</span><span class="sxs-lookup"><span data-stu-id="f5498-204">View Foreign Key Properties</span></span>](../tables/view-foreign-key-properties.md)|
|<span data-ttu-id="f5498-205">Viene descritto come disabilitare vincoli di chiave esterna per la replica.</span><span class="sxs-lookup"><span data-stu-id="f5498-205">Describes how to disable foreign key constraints for replication.</span></span>|[<span data-ttu-id="f5498-206">Disabilitare i vincoli di chiave esterna per la replica</span><span class="sxs-lookup"><span data-stu-id="f5498-206">Disable Foreign Key Constraints for Replication</span></span>](../tables/disable-foreign-key-constraints-for-replication.md)|
|<span data-ttu-id="f5498-207">Viene descritto come disabilitare un vincolo di chiave esterna durante l'istruzione INSERT o UPDATE.</span><span class="sxs-lookup"><span data-stu-id="f5498-207">Describes how to disable foreign key constraints during an INSERT or UPDATE statement.</span></span>|[<span data-ttu-id="f5498-208">Disabilitare i vincoli di chiave esterna con le istruzioni INSERT e UPDATE</span><span class="sxs-lookup"><span data-stu-id="f5498-208">Disable Foreign Key Constraints with INSERT and UPDATE Statements</span></span>](../tables/disable-foreign-key-constraints-with-insert-and-update-statements.md)|


