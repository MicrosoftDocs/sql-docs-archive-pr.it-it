---
title: Novità di SQLXML 4,0 SP1 |&#39;Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- registry keys [SQLXML]
- SQLNCLI, SQLXML
- what's new [SQLXML]
- SQLXML, what's new
- migrating SQLXML applications
- redistributing SQLXML
- SQL Server Native Client, SQLXML
- side-by-side installations [SQLXML]
ms.assetid: 48f7720b-1705-402d-93ce-097ff1737877
author: rothja
ms.author: jroth
ms.openlocfilehash: 880937520385fbe6ce64be3fdfcbbf7d11c73741
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713028"
---
# <a name="what39s-new-in-sqlxml-40-sp1"></a><span data-ttu-id="87069-102">Novità di SQLXML 4,0 SP1&#39;</span><span class="sxs-lookup"><span data-stu-id="87069-102">What&#39;s New in SQLXML 4.0 SP1</span></span>
  <span data-ttu-id="87069-103">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] SQLXML 4.0 SP1 sono inclusi diversi aggiornamenti e miglioramenti.</span><span class="sxs-lookup"><span data-stu-id="87069-103">[!INCLUDE[msCoName](../../includes/msconame-md.md)] SQLXML 4.0 SP1 includes various updates and enhancements.</span></span> <span data-ttu-id="87069-104">In questo argomento viene fornito un riepilogo degli aggiornamenti e vengono riportati i collegamenti a informazioni più dettagliate, se disponibili.</span><span class="sxs-lookup"><span data-stu-id="87069-104">This topic summarizes the updates and provides links to more detailed information, where available.</span></span> <span data-ttu-id="87069-105">In SQLXML 4.0 SP1 sono stati apportati ulteriori miglioramenti per supportare i nuovi tipi di dati introdotti in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="87069-105">SQLXML 4.0 SP1 provides additional enhancements to support the new data types introduced in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="87069-106">Vengono inoltre presentati gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="87069-106">This topic includes the following subjects:</span></span>  
  
-   <span data-ttu-id="87069-107">Installazione di SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="87069-107">Installing SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="87069-108">Problemi di installazione affiancata</span><span class="sxs-lookup"><span data-stu-id="87069-108">Side-by-Side Installation Issues</span></span>  
  
-   <span data-ttu-id="87069-109">SQLXML 4.0 e MSXML</span><span class="sxs-lookup"><span data-stu-id="87069-109">SQLXML 4.0 and MSXML</span></span>  
  
-   <span data-ttu-id="87069-110">Ridistribuzione di SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="87069-110">Redistributing SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="87069-111">Supporto per [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client</span><span class="sxs-lookup"><span data-stu-id="87069-111">Support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client</span></span>  
  
-   <span data-ttu-id="87069-112">Supporto per i tipi di dati introdotti in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="87069-112">Support for Data Types Introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span></span>  
  
-   <span data-ttu-id="87069-113">Modifiche al caricamento bulk XML per SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="87069-113">XML Bulk Load Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="87069-114">Modifiche alle chiavi del Registro di sistema per SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="87069-114">Registry Key Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="87069-115">Problemi di migrazione</span><span class="sxs-lookup"><span data-stu-id="87069-115">Migration Issues</span></span>  
  
## <a name="installing-sqlxml-40-sp1"></a><span data-ttu-id="87069-116">Installazione di SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="87069-116">Installing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="87069-117">Prima di [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], SQLXML 4.0 veniva rilasciato con SQL Server e apparteneva all'installazione predefinita di tutte le versioni di SQL Server, ad eccezione di SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="87069-117">Before [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], SQLXML 4.0 was released with SQL Server and was part of the default installation of all SQL Server versions except for SQL Server Express.</span></span> <span data-ttu-id="87069-118">A partire da [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], la versione più recente di SQLXML (SQLXML 4.0 SP1) non è più inclusa in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="87069-118">Starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], the latest version of SQLXML (SQLXML 4.0 SP1) is no longer included in SQL Server.</span></span> <span data-ttu-id="87069-119">Per installare SQLXML 4,0 SP1, scaricarlo dal [percorso di installazione per sqlxml 4,0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span><span class="sxs-lookup"><span data-stu-id="87069-119">To install SQLXML 4.0 SP1, download it from [Install Location for SQLXML 4.0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span></span>  
  
 <span data-ttu-id="87069-120">I file di SQLXML 4.0 SP1 vengono installati nel percorso seguente:</span><span class="sxs-lookup"><span data-stu-id="87069-120">The SQLXML 4.0 SP1 files are installed in the following location:</span></span>  
  
 `%PROGRAMFILES%\SQLXML 4.0\`  
  
> [!NOTE]  
>  <span data-ttu-id="87069-121">Tutte le impostazioni del Registro di sistema appropriate per SQLXML 4.0 vengono definite durante il processo di installazione.</span><span class="sxs-lookup"><span data-stu-id="87069-121">All appropriate registry settings for SQLXML 4.0 are made as part of the installation process.</span></span>  
  
 <span data-ttu-id="87069-122">Per consentire l'esecuzione delle applicazioni SQLXML a 32 bit in sistemi operativi WOW64 (Windows on Windows) a 64 bit, eseguire il pacchetto SQLXML 4.0 SP1 a 64 bit, denominato sqlxml4.msi, disponibile nell'Area download Microsoft.</span><span class="sxs-lookup"><span data-stu-id="87069-122">To allow 32-bit SQLXML applications to run under Windows on Windows (WOW64) on 64-bit Windows operating systems, run the 64-bit SQLXML 4.0 SP1 package, named sqlxml4.msi, which can be found on the Download Center.</span></span>  
  
#### <a name="uninstalling-sqlxml-40-sp1"></a><span data-ttu-id="87069-123">Disinstallazione di SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="87069-123">Uninstalling SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="87069-124">In SQLXML 3.0 SP3, SQLXML 4.0 e SQLXML 4.0 SP1 sono presenti chiavi del Registro di sistema condivise.</span><span class="sxs-lookup"><span data-stu-id="87069-124">Shared registry keys exist between SQLXML 3.0 SP3, SQLXML 4.0 and SQLXML 4.0 SP1.</span></span> <span data-ttu-id="87069-125">Se le versioni più recenti di SQLXML vengono disinstallate dallo stesso computer su cui è presente SQLXML 3.0 SP3, potrebbe essere necessario reinstallare quest'ultimo.</span><span class="sxs-lookup"><span data-stu-id="87069-125">If the later versions of SQLXML are uninstalled on the same computer which contains SQLXML 3.0 SP3, you might need to reinstall SQLXML 3.0 SP3.</span></span>  
  
## <a name="side-by-side-installation-issues"></a><span data-ttu-id="87069-126">Problemi di installazione affiancata</span><span class="sxs-lookup"><span data-stu-id="87069-126">Side-by-Side Installation Issues</span></span>  
 <span data-ttu-id="87069-127">Il processo di installazione di SQLXML 4.0 non determina la rimozione dei file installati da versioni precedenti di SQLXML.</span><span class="sxs-lookup"><span data-stu-id="87069-127">The installation process for SQLXML 4.0 does not remove the files that were installed by earlier versions of SQLXML.</span></span> <span data-ttu-id="87069-128">È pertanto possibile che in un computer siano presenti le DLL relative a installazioni di diverse versioni di SQLXML.</span><span class="sxs-lookup"><span data-stu-id="87069-128">Therefore, you can have DLLs for several different version-distinctive installations of SQLXML on your computer.</span></span> <span data-ttu-id="87069-129">È possibile eseguire installazioni side-by-side.</span><span class="sxs-lookup"><span data-stu-id="87069-129">You can run the installations side-by-side.</span></span> <span data-ttu-id="87069-130">In SQLXML 4.0 sono inclusi sia i PROGID dipendenti sia quelli indipendenti dalla versione.</span><span class="sxs-lookup"><span data-stu-id="87069-130">SQLXML 4.0 includes both version-independent and version-dependent PROGIDs.</span></span> <span data-ttu-id="87069-131">Per tutte le applicazioni di produzione è consigliabile usare i PROGID dipendenti dalla versione.</span><span class="sxs-lookup"><span data-stu-id="87069-131">All production applications should use version-dependent PROGIDs.</span></span>  
  
## <a name="sqlxml-40-sp1-and-msxml"></a><span data-ttu-id="87069-132">SQLXML 4.0 SP1 e MSXML</span><span class="sxs-lookup"><span data-stu-id="87069-132">SQLXML 4.0 SP1 and MSXML</span></span>  
 <span data-ttu-id="87069-133">SQLXML 4.0 non prevede l'installazione di MSXML,</span><span class="sxs-lookup"><span data-stu-id="87069-133">SQLXML 4.0 does not install MSXML.</span></span> <span data-ttu-id="87069-134">ma l'uso di MSXML 6.0, che viene installato insieme a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="87069-134">SQLXML 4.0 uses MSXML 6.0, which is installed as part of the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later installation.</span></span>  
  
## <a name="redistributing-sqlxml-40-sp1"></a><span data-ttu-id="87069-135">Ridistribuzione di SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="87069-135">Redistributing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="87069-136">Per distribuire SQLXML 4.0 SP1, usare il pacchetto del programma di installazione ridistribuibile.</span><span class="sxs-lookup"><span data-stu-id="87069-136">You can distribute SQLXML 4.0 SP1 using the redistributable installer package.</span></span> <span data-ttu-id="87069-137">Un modo per installare più pacchetti in un'installazione che all'utente può sembrare singola consiste nell'usare la tecnologia del chainer e del programma di avvio automatico.</span><span class="sxs-lookup"><span data-stu-id="87069-137">One way to install multiple packages in what seems to the user to be a single installation is to use chainer and bootstrapper technology.</span></span> <span data-ttu-id="87069-138">Per altre informazioni, vedere Authoring a Custom Bootstrapper Package for Visual Studio 2005 e Aggiunta di prerequisiti personalizzati.</span><span class="sxs-lookup"><span data-stu-id="87069-138">For more information, see Authoring a Custom Bootstrapper Package for Visual Studio 2005 and Adding Custom Prerequisites.</span></span>  
  
 <span data-ttu-id="87069-139">Se l'applicazione è destinata a una piattaforma diversa da quella su cui è stata sviluppata, è possibile scaricare versioni di sqlncli.msi per x64, Itanium e x86 dall'Area download Microsoft.</span><span class="sxs-lookup"><span data-stu-id="87069-139">If your application targets a platform other than the one it was developed on, you can download versions of sqlncli.msi for x64, Itanium, and x86 from the Microsoft Download Center.</span></span>  
  
 <span data-ttu-id="87069-140">Sono anche disponibili programmi di installazione di ridistribuzione separati per MSXML 6.0 (msxml6.msi).</span><span class="sxs-lookup"><span data-stu-id="87069-140">There are also separate redistribution installation programs for MSXML 6.0 (msxml6.msi).</span></span> <span data-ttu-id="87069-141">Tali programmi sono disponibili nel CD di installazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nel percorso seguente:</span><span class="sxs-lookup"><span data-stu-id="87069-141">These can be found on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation CD in the following location:</span></span>  
  
 `%CD%\Setup\`  
  
 <span data-ttu-id="87069-142">Questi file di installazione possono essere usati per installare MSXML 6.0 direttamente dal CD.</span><span class="sxs-lookup"><span data-stu-id="87069-142">These installation files can be used to install MSXML 6.0 directly from the CD.</span></span> <span data-ttu-id="87069-143">Possono inoltre essere usati per ridistribuire liberamente MSXML 6.0 con SQLXML 4.0 SP1 con applicazioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="87069-143">They can also be used to freely redistribute MSXML 6.0 along with SQLXML 4.0 SP1 with your own custom applications.</span></span>  
  
 <span data-ttu-id="87069-144">È inoltre necessario ridistribuire [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client se viene usato come provider di dati con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="87069-144">You will also need to redistribute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client if you are using it as the data provider with your application.</span></span> <span data-ttu-id="87069-145">Per altre informazioni, vedere [Installazione di SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="87069-145">For more information, see [Installing SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span></span>  
  
## <a name="support-for-sql-server-native-client"></a><span data-ttu-id="87069-146">Supporto per SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="87069-146">Support for SQL Server Native Client</span></span>  
 <span data-ttu-id="87069-147">SQLXML 4,0 supporta i provider SQLOLEDB e [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="87069-147">SQLXML 4.0 supports both the SQLOLEDB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client providers.</span></span> <span data-ttu-id="87069-148">È consigliabile utilizzare la stessa versione del [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider native client e [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native client è stato sviluppato per supportare i nuovi tipi di dati disponibili nel server, ad esempio i `Date, Time` tipi di `DateTime2` dati, e `dateTimeOffset` in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] e supportati da [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="87069-148">It is recommended that you use the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client provider and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is developed to support any new data types that ship in the server, such as the `Date, Time`, `DateTime2`, and `dateTimeOffset` data types in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="87069-149">Native Client è una tecnologia di accesso ai dati introdotta in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="87069-149">Native Client is a data access technology that was introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="87069-150">Questa tecnologia integra il provider SQLOLEDB e il driver SQLODBC in un'unica libreria a collegamento dinamico (DLL) nativa, offrendo contemporaneamente nuove funzionalità diverse da Microsoft Data Access Components (MDAC).</span><span class="sxs-lookup"><span data-stu-id="87069-150">It combines the SQLOLEDB Provider and the SQLODBC Driver into one native dynamic link library (DLL), while also providing new functionality that is separate and distinct from the Microsoft Data Access Components (MDAC).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="87069-151">Native Client può essere usato per creare nuove applicazioni o migliorare quelle esistenti che richiedono l'utilizzo delle funzionalità introdotte in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e non supportate da SQLOLEDB e SQLODBC in MDAC e [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="87069-151">Native Client can be used to create new applications or enhance existing applications that need to take advantage of features introduced in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that are not supported by SQLOLEDB and SQLODBC in MDAC and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span></span> <span data-ttu-id="87069-152">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client è ad esempio necessario per consentire a funzionalità SQLXML sul lato client, come FOR XML, di usare il tipo di dati `xml`.</span><span class="sxs-lookup"><span data-stu-id="87069-152">For example, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is required for client-side SQLXML features, such as FOR XML, to use the `xml` data type.</span></span> <span data-ttu-id="87069-153">Per ulteriori informazioni, vedere la pagina relativa alla [formattazione XML sul lato Client &#40;SQLXML 4,0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [utilizzo di ADO per eseguire query SQLXML 4,0](using-ado-to-execute-sqlxml-4-0-queries.md)e [SQL Server Native Client programmazione](../native-client/sql-server-native-client-programming.md).</span><span class="sxs-lookup"><span data-stu-id="87069-153">For more information, see [Client-side XML Formatting &#40;SQLXML 4.0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md), and [SQL Server Native Client Programming](../native-client/sql-server-native-client-programming.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="87069-154">SQLXML 4.0 non è completamente compatibile con la versione precedente SQLXML 3.0.</span><span class="sxs-lookup"><span data-stu-id="87069-154">SQLXML 4.0 is not completely backward compatible with SQLXML 3.0.</span></span> <span data-ttu-id="87069-155">A causa di alcune correzioni di bug e di altre modifiche funzionali, in modo specifico la rimozione del supporto ISAPI SQLXML, non è possibile usare le directory virtuali IIS con SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="87069-155">Because of some bug fixes and other functional changes, particularly the removal of SQLXML ISAPI support, you cannot use IIS virtual directories with SQLXML 4.0.</span></span> <span data-ttu-id="87069-156">Anche se la maggior parte delle applicazioni viene eseguita con modifiche minori, è necessario testare le applicazioni prima di metterle in produzione con SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="87069-156">Although most applications will run with minor modifications, you must test them before putting them into production with SQLXML 4.0.</span></span>  
  
## <a name="support-for-data-types-introduced-in-sql-server-2005-and-sql-server-2008"></a><span data-ttu-id="87069-157">Supporto per i tipi di dati introdotti in SQL Server 2005 e SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="87069-157">Support for Data Types Introduced in SQL Server 2005 and SQL Server 2008</span></span>  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="87069-158">è stato introdotto il `xml` tipo di dati e SQLXML 4,0 supporta il `xml` tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="87069-158">introduced the `xml` data type, and SQLXML 4.0 supports the `xml` data type.</span></span> <span data-ttu-id="87069-159">Per ulteriori informazioni, vedere [supporto del tipo di dati XML in SQLXML 4,0](xml-data-type-support-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="87069-159">For more information, see [xml Data Type Support in SQLXML 4.0](xml-data-type-support-in-sqlxml-4-0.md).</span></span>  
  
 <span data-ttu-id="87069-160">Per esempi relativi all'utilizzo del tipo di dati `xml` in SQLXML in caso di mapping di viste XML, di caricamento bulk XML o di esecuzione di updategram XML, fare riferimento agli esempi forniti negli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="87069-160">For examples of how to use the `xml` data type in SQLXML when mapping XML views, bulk loading XML or executing XML updategrams, refer to examples provided in the following topics.</span></span>  
  
-   [<span data-ttu-id="87069-161">Mapping predefinito di attributi ed elementi XSD a tabelle e colonne</span><span class="sxs-lookup"><span data-stu-id="87069-161">Default Mapping of XSD Elements and Attributes to Tables and Columns</span></span>](../sqlxml-annotated-xsd-schemas-using/default-mapping-of-xsd-elements-and-attributes-to-tables-and-columns-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="87069-162">Inserimento di dati mediante updategram XML</span><span class="sxs-lookup"><span data-stu-id="87069-162">Inserting Data by Using XML Updategrams</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/updategrams/inserting-data-using-xml-updategrams-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="87069-163">Esempi di caricamento bulk di documenti XML</span><span class="sxs-lookup"><span data-stu-id="87069-163">Examples of Bulk Loading XML Documents</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/xml-bulk-load-examples-sqlxml-4-0.md)  
  
 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]<span data-ttu-id="87069-164">sono stati introdotti i `Date, Time` `DateTime2` tipi di dati, e **DateTimeOffset** .</span><span class="sxs-lookup"><span data-stu-id="87069-164">introduced the `Date, Time`, `DateTime2`, and **DateTimeOffset** data types.</span></span> <span data-ttu-id="87069-165">I quattro nuovi tipi di dati vengono abilitati come tipi scalari predefiniti quando SQLXML 4.0 SP1 viene usato con il provider OLE DB di [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client (SQLNCLI11), fornito con [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="87069-165">SQLXML 4.0 SP1 will enable these four new data types as built-in scalar types when used with [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client OLE DB Provider (SQLNCLI11), which ships in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="xml-bulk-load-changes-for-sqlxml-40-sp1"></a><span data-ttu-id="87069-166">Modifiche al caricamento bulk XML per SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="87069-166">XML Bulk Load Changes for SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="87069-167">Per SQLXML 4,0, il campo di overflow SchemaGen viene creato usando il `xml` tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="87069-167">For SQLXML 4.0, the SchemaGen overflow field is created using the `xml` data type.</span></span> <span data-ttu-id="87069-168">Per ulteriori informazioni, vedere [SQL Server modello a oggetti per il caricamento bulk XML](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="87069-168">For more information, see [SQL Server XML Bulk Load Object Model](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span></span>  
  
-   <span data-ttu-id="87069-169">Se sono state precedentemente create applicazioni [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic e si desidera usare SQLXML 4.0, è necessario ricompilarle con il riferimento a Xblkld4.dll.</span><span class="sxs-lookup"><span data-stu-id="87069-169">If you have previously created [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic applications and you want to use SQLXML 4.0, you must recompile the application with reference to Xblkld4.dll.</span></span>  
  
-   <span data-ttu-id="87069-170">Per le applicazioni Visual Basic, Scripting Edition è necessario registrare la DLL da usare.</span><span class="sxs-lookup"><span data-stu-id="87069-170">For Visual Basic Scripting Edition applications, you must register the DLL you want to use.</span></span> <span data-ttu-id="87069-171">Nell'esempio seguente, se si specificano PROGID indipendenti dalla versione, l'applicazione dipende dall'ultima DLL registrata:</span><span class="sxs-lookup"><span data-stu-id="87069-171">In the following example, if you specify version-independent PROGIDs, the application depends on the last registered DLL:</span></span>  
  
    ```  
    set objBulkLoad = CreateObject("SQLXMLBulkLoad.SQLXMLBulkLoad")   
    ```  
  
    > [!NOTE]  
    >  <span data-ttu-id="87069-172">Il PROGID dipendente dalla versione è SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span><span class="sxs-lookup"><span data-stu-id="87069-172">The version-dependent PROGID is SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span></span>  
  
## <a name="registry-key-changes-for-sqlxml-40"></a><span data-ttu-id="87069-173">Modifiche alle chiavi del Registro di sistema per SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="87069-173">Registry Key Changes for SQLXML 4.0</span></span>  
 <span data-ttu-id="87069-174">In SQLXML 4.0 le chiavi del Registro di sistema sono state sostituite rispetto alle versioni precedenti dalle chiavi seguenti.</span><span class="sxs-lookup"><span data-stu-id="87069-174">In SQLXML 4.0, the registry keys have changed from the earlier releases to the following:</span></span>  
  
 <span data-ttu-id="87069-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span><span class="sxs-lookup"><span data-stu-id="87069-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span></span>  
  
 <span data-ttu-id="87069-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span><span class="sxs-lookup"><span data-stu-id="87069-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span></span>  
  
 <span data-ttu-id="87069-177">Se si desidera rendere effettive tali chiavi per SQLXML 4.0, è necessario modificare le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="87069-177">You must change the settings if you want these keys to be in effect for SQLXML 4.0.</span></span>  
  
 <span data-ttu-id="87069-178">Con SQLXML 4.0 vengono inoltre introdotte le chiavi del Registro di sistema seguenti:</span><span class="sxs-lookup"><span data-stu-id="87069-178">In addition, SQLXML 4.0 introduces the following registry keys:</span></span>  
  
-   `HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\ReportErrorsWithSQLInfo`  
  
     <span data-ttu-id="87069-179">Per impostazione predefinita, SQLXML 4.0 restituisce informazioni sugli errori nativi fornite da OLE DB e [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], anziché un errore SQLXML di livello elevato (come nel caso delle versioni precedenti di SQLXML).</span><span class="sxs-lookup"><span data-stu-id="87069-179">By default, SQLXML 4.0 returns native error information provided by OLE DB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instead of a high-level SQLXML error (as was the case in earlier versions of SQLXML).</span></span> <span data-ttu-id="87069-180">Per evitare questo comportamento, il valore di questa chiave del Registro di sistema di tipo DWORD deve essere impostato su 0 (l'impostazione predefinita è 1).</span><span class="sxs-lookup"><span data-stu-id="87069-180">If you do not want this behavior, the value of this registry key of type DWORD must be set to 0 (default is 1).</span></span>  
  
-   <span data-ttu-id="87069-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span><span class="sxs-lookup"><span data-stu-id="87069-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span></span>  
  
     <span data-ttu-id="87069-182">Per impostazione predefinita, SQLXML restituisce i valori GUID di SQL Server senza racchiuderli fra parentesi graffe.</span><span class="sxs-lookup"><span data-stu-id="87069-182">By default, SQLXML return SQL Server GUID values without the enclosing braces.</span></span> <span data-ttu-id="87069-183">Se si desidera che il valore GUID venga restituito con le parentesi graffe, ad esempio {*some GUID*}, il valore di questa chiave del registro di sistema deve essere impostato su 1 (l'impostazione predefinita è 0).</span><span class="sxs-lookup"><span data-stu-id="87069-183">If you want the GUID value returned with the braces (for example, {*some GUID*}), value of this registry key must be set to 1 (default is 0).</span></span>  
  
-   <span data-ttu-id="87069-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span><span class="sxs-lookup"><span data-stu-id="87069-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span></span>  
  
     <span data-ttu-id="87069-185">Per impostazione predefinita, quando il parser XML carica i dati, gli spazi vuoti vengono normalizzati in base alle regole di XML 1.0.</span><span class="sxs-lookup"><span data-stu-id="87069-185">By default, when the XML parser loads the data, white spaces are normalized according to the XML 1.0 rules.</span></span> <span data-ttu-id="87069-186">In questo modo vengono persi alcuni degli spazi vuoti nei dati.</span><span class="sxs-lookup"><span data-stu-id="87069-186">This results in loss of some of the white space characters in your data.</span></span> <span data-ttu-id="87069-187">La rappresentazione testuale dei dati potrebbe pertanto non essere uguale dopo l'analisi, anche se i dati rimarranno invariati dal punto di vista semantico.</span><span class="sxs-lookup"><span data-stu-id="87069-187">Thus, the textual representation of your data may not be the same after parsing, although semantically the data is the same.</span></span>  
  
     <span data-ttu-id="87069-188">Questa chiave viene introdotta in modo che sia possibile scegliere di mantenere gli spazi vuoti nei dati.</span><span class="sxs-lookup"><span data-stu-id="87069-188">This key is introduced so that you can choose to keep the white space characters in the data.</span></span> <span data-ttu-id="87069-189">Se si aggiunge tale chiave del Registro di sistema e se ne imposta il valore su 0, gli spazi vuoti (LF, CR e TAB) nei dati XML vengono restituiti codificati nel caso di valori di attributi.</span><span class="sxs-lookup"><span data-stu-id="87069-189">If you add this registry key and set its value to 0, white space characters (LF, CR, and tab) in the XML are returned encoded in case of attribute values.</span></span> <span data-ttu-id="87069-190">Nel caso di valori di elementi, solo il carattere CR viene restituito codificato.</span><span class="sxs-lookup"><span data-stu-id="87069-190">In case of element values, only CR is returned encoded.</span></span>  
  
     <span data-ttu-id="87069-191">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="87069-191">For example:</span></span>  
  
    ```  
    CREATE TABLE T( Col1 int, Col2 nvarchar(100));  
    GO  
    -- Insert data with tab, line feed and carriage return).  
    INSERT INTO T VALUES (1, 'This is a tab    . This is a line feed and CR   
     more text');  
    GO  
    -- Test this query (without the registry key).  
    SELECT * FROM T   
    FOR XML AUTO;  
    -- This is the result (no encoding of special characters).  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
    -- Now add registry key with value 0 and execute the query again.  
    -- Note the encoding for carriage return, line-feed and tab in the attribute value.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
  
    -- Update the query and specify ELEMENTS directive  
    SELECT * FROM T  
    FOR XML AUTO, ELEMENTS  
    -- Only the carriage return is returned encoded.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
       <T>  
          <Col1>1</Col1>  
          <Col2>This is a tab    . This is a line feed and CR   
     more text</Col2>  
       </T>  
    </r>  
    ```  
  
## <a name="migration-issues"></a><span data-ttu-id="87069-192">Problemi di migrazione</span><span class="sxs-lookup"><span data-stu-id="87069-192">Migration Issues</span></span>  
 <span data-ttu-id="87069-193">Di seguito vengono riportati i problemi che potrebbero avere un impatto sulla migrazione delle applicazioni SQLXML legacy a SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="87069-193">The following are issues that could impact migration of your legacy SQLXML applications to SQLXML 4.0.</span></span>  
  
### <a name="ado-and-sqlxml-40-queries"></a><span data-ttu-id="87069-194">Query ADO e SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="87069-194">ADO and SQLXML 4.0 Queries</span></span>  
 <span data-ttu-id="87069-195">Nelle versioni precedenti di SQLXML viene fornito il supporto per l'esecuzione di query basate sull'URL mediante le directory virtuali IIS e il filtro ISAPI SQLXML.</span><span class="sxs-lookup"><span data-stu-id="87069-195">In earlier versions of SQLXML, support for URL-based query execution using IIS virtual directories and the SQLXML ISAPI filter was provided.</span></span> <span data-ttu-id="87069-196">Per le applicazioni che usano SQLXML 4.0 questo supporto non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="87069-196">For applications that use SQLXML 4.0, this support is no longer available.</span></span>  
  
 <span data-ttu-id="87069-197">Gli updategram, i modelli e le query SQLXML possono invece essere eseguiti usando le estensioni SQLXML di ActiveX Data Objects (ADO), introdotte per la prima volta con Microsoft Data Access Components (MDAC) 2.6 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="87069-197">Instead, SQLXML queries, templates, and updategrams can be executed by using the SQLXML extensions to ActiveX Data Objects (ADO) first introduced in Microsoft Data Access Components (MDAC) 2.6 and later.</span></span>  
  
 <span data-ttu-id="87069-198">Per ulteriori informazioni, vedere [utilizzo di ADO per eseguire query SQLXML 4,0](using-ado-to-execute-sqlxml-4-0-queries.md).</span><span class="sxs-lookup"><span data-stu-id="87069-198">For more information, see [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md).</span></span>  
  
### <a name="supportability-for-sqlxml-30-isapi-and-data-types-introduced-in-sql-server-2005"></a><span data-ttu-id="87069-199">Supporto per ISAPI SQLXML 3.0 e per i tipi di dati introdotti in SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="87069-199">Supportability for SQLXML 3.0 ISAPI and Data Types Introduced in SQL Server 2005</span></span>  
 <span data-ttu-id="87069-200">Poiché il supporto ISAPI è stato rimosso da SQLXML 4,0, se la soluzione richiede le funzionalità avanzate di tipizzazione dei dati introdotte in, [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ad esempio il [tipo di dati XML](/sql/t-sql/xml/xml-transact-sql) o i [tipi di dati definiti dall'utente](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) e l'accesso basato sul Web, sarà necessario utilizzare un'altra soluzione, ad esempio [classi gestite SQLXML](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) o un altro tipo di gestore HTTP, ad esempio i servizi Web XML nativi per SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="87069-200">Because ISAPI support has been removed from SQLXML 4.0, if your solution requires the enhanced data typing features introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] such as the [xml data type](/sql/t-sql/xml/xml-transact-sql) or [user-defined data types (UDTs)](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) and Web-based access, you will need to use another solution such as [SQLXML managed classes](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) or another type of HTTP handler, such as Native XML Web Services for SQL Server 2005.</span></span>  
  
 <span data-ttu-id="87069-201">In alternativa, se queste estensioni di tipo non sono necessarie, è possibile continuare a utilizzare SQLXML 3,0 per connettersi alle [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] installazioni di e [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="87069-201">Alternately, if you do not require these type extensions, you can continue to use SQLXML 3.0 to connect to [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] installations.</span></span> <span data-ttu-id="87069-202">Il supporto ISAPI SQLXML 3.0 funziona con le versioni più recenti, ma non supporta o riconosce il tipo di dati `xml` o i tipi definiti dall'utente introdotti in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="87069-202">The SQLXML 3.0 ISAPI support will work against these later versions but does not support or recognize the `xml` data type or UDT type support introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span>  
  
### <a name="xml-bulk-load-security-changes-for-temporary-files"></a><span data-ttu-id="87069-203">Modifiche alla sicurezza del caricamento bulk XML per i file temporanei</span><span class="sxs-lookup"><span data-stu-id="87069-203">XML Bulk Load Security Changes for Temporary Files</span></span>  
 <span data-ttu-id="87069-204">Per SQLXML 4.0 e [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], le autorizzazioni per i file del caricamento bulk XML vengono concesse all'utente che esegue l'operazione di caricamento bulk.</span><span class="sxs-lookup"><span data-stu-id="87069-204">For SQLXML 4.0 and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], XML Bulk Load file permissions are granted to the user executing the bulk load operation.</span></span> <span data-ttu-id="87069-205">Le autorizzazioni di lettura e scrittura vengono ereditate dal file system.</span><span class="sxs-lookup"><span data-stu-id="87069-205">Read and Write permissions are inherited from the file system.</span></span> <span data-ttu-id="87069-206">Nelle versioni precedenti di SQLXML e SQL Server, il caricamento bulk XML in SQLXML crea file temporanei non protetti che potrebbero essere letti da chiunque.</span><span class="sxs-lookup"><span data-stu-id="87069-206">In previous releases of SQLXML and SQL Server, XML Bulk Load under SQLXML would create temporary files that were not secured and could be readable by anyone.</span></span>  
  
### <a name="migration-issues-for-client-side-for-xml"></a><span data-ttu-id="87069-207">Problemi di migrazione per FOR XML sul lato client</span><span class="sxs-lookup"><span data-stu-id="87069-207">Migration Issues for Client-Side FOR XML</span></span>  
 <span data-ttu-id="87069-208">A causa delle modifiche apportate al motore di esecuzione, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] può restituire valori diversi nei metadati per una tabella di base rispetto a quelli restituiti se la query for XML è stata eseguita con [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="87069-208">Due to changes in the execution engine, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might return different values in the metadata for a base table than would be returned if the FOR XML query was executed under [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span></span> <span data-ttu-id="87069-209">In questi casi, la formattazione sul lato client dei risultati della query FOR XML presenterà un output differente, a seconda della versione sulla quale viene eseguita la query.</span><span class="sxs-lookup"><span data-stu-id="87069-209">In cases where this occurs, client-side formatting of the FOR XML query results will have differing output depending on which version the query is run against.</span></span>  
  
 <span data-ttu-id="87069-210">Se una query FOR XML viene eseguita sul lato client usando SQLXML 3.0 su una colonna con tipo di dati `xml`, i dati dei risultati verranno restituiti sotto forma di stringa sostituita completamente da entità.</span><span class="sxs-lookup"><span data-stu-id="87069-210">If a FOR XML query is executed client-side using SQLXML 3.0 over an `xml` data type column, the data in the results will come back as a fully entitized string.</span></span> <span data-ttu-id="87069-211">In SQLXML 4.0, se [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client (SQLNCLI11) viene specificato come provider, i dati verranno restituiti come XML.</span><span class="sxs-lookup"><span data-stu-id="87069-211">In SQLXML 4.0, if the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client (SQLNCLI11) is specified as the provider, the data will be returned as XML.</span></span>  
  
  
