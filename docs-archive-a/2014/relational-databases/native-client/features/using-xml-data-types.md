---
title: Uso di tipi di dati XML | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- IRowsetChange interface
- IRowsetUpdate interface
- data access [SQL Server Native Client], xml data type
- SQL Server Native Client OLE DB schema rowsets
- PROVIDER_TYPES rowset
- IColumnsInfo interface
- IRowsetFind interface
- IColumnsRowset interface
- PROCEDURE_PARAMETERS rowset
- SQLNCLI, XML
- xml data type [SQL Server], SQL Server Native Client
- SQL Server Native Client, XML
- IRowset interface
- ISequentialStream interface
- ISSCommandWithParameters interface
- SS_XMLSCHEMA rowset
- SQL Server Native Client OLE DB interfaces
- XML [SQL Server], SQL Server Native Client
- COLUMNS rowset
ms.assetid: a7af5b72-c5c2-418d-a636-ae4ac6270ee5
author: rothja
ms.author: jroth
ms.openlocfilehash: 3d0dcc8cf7259a24e53281724d8440c6ff2209f1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635531"
---
# <a name="using-xml-data-types"></a><span data-ttu-id="a337c-102">Utilizzo di tipi di dati XML</span><span class="sxs-lookup"><span data-stu-id="a337c-102">Using XML Data Types</span></span>
  <span data-ttu-id="a337c-103">In [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] è stato introdotto il tipo di dati **xml** che consente di archiviare documenti e frammenti XML in un database di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a337c-103">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] introduced an **xml** data type that enables you to store XML documents and fragments in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="a337c-104">Il tipo di dati **xml**,un tipo di dati predefinito di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], è simile per alcuni aspetti ad altri tipi predefiniti, quali **int** e **varchar**.</span><span class="sxs-lookup"><span data-stu-id="a337c-104">The **xml** data type is a built-in data type in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], and is in some ways similar to other built-in types, such as **int** and **varchar**.</span></span> <span data-ttu-id="a337c-105">Come per gli altri tipi predefiniti, è possibile usare il tipo di dati **xml** come tipo di colonna quando si crea una tabella, come tipo di variabile, tipo di parametro o tipo restituito dalla funzione oppure in funzioni CAST e CONVERT.</span><span class="sxs-lookup"><span data-stu-id="a337c-105">As with other built-in types, you can use the **xml** data type as a column type when creating a table; as a variable type, a parameter type, or a function-return type; or in CAST and CONVERT functions.</span></span>  
  
## <a name="programming-considerations"></a><span data-ttu-id="a337c-106">Considerazioni sulla programmazione</span><span class="sxs-lookup"><span data-stu-id="a337c-106">Programming Considerations</span></span>  
 <span data-ttu-id="a337c-107">XML può essere autodescrittivo in quanto può eventualmente includere un'intestazione XML che specifica la codifica del documento, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a337c-107">XML can be self-describing in that it can optionally include an XML header that specifies the encoding of the document, for example:</span></span>  
  
 `<?xml version="1.0" encoding="windows-1252"?><doc/>`  
  
 <span data-ttu-id="a337c-108">Lo standard XML descrive il modo in cui un processore XML può rilevare la codifica utilizzata per un documento esaminando i primi byte del documento.</span><span class="sxs-lookup"><span data-stu-id="a337c-108">The XML standard describes how an XML processor can detect the encoding used for a document by examining the first few bytes of the document.</span></span> <span data-ttu-id="a337c-109">È possibile che la codifica specificata nell'applicazione crei conflitti con quella specificata nel documento.</span><span class="sxs-lookup"><span data-stu-id="a337c-109">There are opportunities for the encoding specified by the application to conflict with the encoding specified by the document.</span></span> <span data-ttu-id="a337c-110">Poiché per i documenti passati come parametri associati i dati XML vengono considerati dati binari in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], non viene eseguita alcuna conversione e il parser XML può utilizzare senza problemi la codifica specificata nel documento.</span><span class="sxs-lookup"><span data-stu-id="a337c-110">For documents passed as bound parameters, XML is treated as binary data by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], so no conversions are made and the XML parser can use the encoding specified within the document without problems.</span></span> <span data-ttu-id="a337c-111">Per i dati XML associati come WSTR, tuttavia, l'applicazione deve quindi garantire che il documento venga codificato come Unicode.</span><span class="sxs-lookup"><span data-stu-id="a337c-111">However, for XML data that is bound as WSTR, then the application must ensure that the document is encoded as Unicode.</span></span> <span data-ttu-id="a337c-112">Ciò può comportare il caricamento del documento in un modello DOM, impostando la codifica su Unicode e serializzando il documento.</span><span class="sxs-lookup"><span data-stu-id="a337c-112">This may entail loading the document into a DOM, changing the encoding to Unicode and serializing the document.</span></span> <span data-ttu-id="a337c-113">In caso contrario, possono verificarsi conversioni dei dati che producono dati XML non validi o danneggiati.</span><span class="sxs-lookup"><span data-stu-id="a337c-113">If this is not done, data conversions may occur, resulting in invalid or corrupt XML.</span></span>  
  
 <span data-ttu-id="a337c-114">Vi è inoltre il rischio di conflitti quando XML viene specificato in valori letterali.</span><span class="sxs-lookup"><span data-stu-id="a337c-114">There is also potential for conflict when XML is specified in literals.</span></span> <span data-ttu-id="a337c-115">I dati seguenti, ad esempio, non sono validi:</span><span class="sxs-lookup"><span data-stu-id="a337c-115">For example the following are invalid:</span></span>  
  
 `INSERT INTO xmltable(xmlcol) VALUES('<?xml version="1.0" encoding="UTF-16"?><doc/>')`  
  
 `INSERT INTO xmltable(xmlcol) VALUES(N'<?xml version="1.0" encoding="UTF-8"?><doc/>')`  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="a337c-116">Provider OLE DB di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="a337c-116">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="a337c-117">DBTYPE_XML è un nuovo tipo di dati specifico di XML nel provider OLE DB per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="a337c-117">DBTYPE_XML is a new data type specific to XML in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="a337c-118">È inoltre possibile accedere ai dati XML tramite i tipi OLE DB esistenti DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT e DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="a337c-118">In addition, XML data can be accessed through the existing OLE DB types of DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT, and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="a337c-119">I dati archiviati in colonne di tipo XML possono essere recuperati da una colonna in un set di righe del provider OLE DB per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client nei formati seguenti:</span><span class="sxs-lookup"><span data-stu-id="a337c-119">Data stored in columns of type XML can be retrieved from a column in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset in the following formats:</span></span>  
  
-   <span data-ttu-id="a337c-120">Stringa di testo</span><span class="sxs-lookup"><span data-stu-id="a337c-120">A text string</span></span>  
  
-   <span data-ttu-id="a337c-121">**ISequentialStream**</span><span class="sxs-lookup"><span data-stu-id="a337c-121">An **ISequentialStream**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a337c-122">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native client non include un lettore sax, ma è possibile passare facilmente **ISequentialStream** a oggetti sax e Dom in MSXML.</span><span class="sxs-lookup"><span data-stu-id="a337c-122">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not include a SAX reader, but the **ISequentialStream** can be easily passed to SAX and DOM objects in MSXML.</span></span>  
  
 <span data-ttu-id="a337c-123">È consigliabile utilizzare **ISequentialStream** per il recupero di documenti XML di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="a337c-123">**ISequentialStream** should be use used for retrieval of large XML documents.</span></span> <span data-ttu-id="a337c-124">A XML si applicano le stesse tecniche utilizzate per altri tipi di valore di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="a337c-124">The same techniques used for other large value types also apply to XML.</span></span> <span data-ttu-id="a337c-125">Per altre informazioni, vedere la sezione [Uso di tipi valore di grandi dimensioni](using-large-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="a337c-125">For more information, see [Using Large Value Types](using-large-value-types.md).</span></span>  
  
 <span data-ttu-id="a337c-126">I dati in colonne di tipo XML in un set di righe possono inoltre essere recuperati, inseriti o aggiornati da un'applicazione tramite le normali interfacce, ad esempio **IRow::GetColumns**, **IRowChange::SetColumns** e **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="a337c-126">Data stored in columns of type XML in a rowset can also be retrieved, inserted, or updated by an application via the usual interfaces such as **IRow::GetColumns**, **IRowChange::SetColumns**, and **ICommand::Execute**.</span></span> <span data-ttu-id="a337c-127">Analogamente al caso di recupero, un programma applicativo può passare una stringa di testo o un **ISequentialStream** al [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider OLE DB di Native Client.</span><span class="sxs-lookup"><span data-stu-id="a337c-127">Similarly to the retrieval case, an application program can pass either a text string or an **ISequentialStream** to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a337c-128">Per inviare dati XML in formato stringa tramite l'interfaccia **ISequentialStream**, è necessario ottenere **ISequentialStream** specificando DBTYPE_IUNKNOWN e impostare il relativo argomento *pObject* su Null nell'associazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-128">To send XML data in string format through the **ISequentialStream** interface, you must obtain **ISequentialStream** by specifying DBTYPE_IUNKNOWN and set its *pObject* argument to null in the binding.</span></span>  
  
 <span data-ttu-id="a337c-129">Quando i dati XML recuperati risultano troncati a causa di un buffer del consumer di dimensioni troppo ridotte, è possibile che la lunghezza venga restituita come 0xffffffff, a indicare che non è nota.</span><span class="sxs-lookup"><span data-stu-id="a337c-129">When retrieved XML data is truncated due to the consumer buffer being too small, the length may be returned as 0xffffffff, which means that the length is unknown.</span></span> <span data-ttu-id="a337c-130">Questo comportamento è coerente con l'implementazione come tipo di dati trasmesso al client senza inviare informazioni sulla lunghezza dei dati effettivi.</span><span class="sxs-lookup"><span data-stu-id="a337c-130">This is consistent with its implementation as a data type that is streamed to the client without sending length information ahead of the actual data.</span></span> <span data-ttu-id="a337c-131">In alcuni casi è possibile che venga restituita la lunghezza effettiva quando il provider ha memorizzato nel buffer l'intero valore, ad esempio **IRowset:: GetData** e dove viene eseguita la conversione dei dati.</span><span class="sxs-lookup"><span data-stu-id="a337c-131">In some cases the actual length may be returned when the provider has buffered the whole value, such as **IRowset::GetData** and where data conversion is performed.</span></span>  
  
 <span data-ttu-id="a337c-132">I dati XML inviati a SQL Server vengono considerati dati binari dal server.</span><span class="sxs-lookup"><span data-stu-id="a337c-132">XML data sent to SQL Server is treated as binary data by the server.</span></span> <span data-ttu-id="a337c-133">In questo modo viene impedito il verificarsi di qualsiasi conversione e il parser XML può rilevare automaticamente la codifica XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-133">This prevents any conversions occurring and allows the XML parser to auto-detect the XML encoding.</span></span> <span data-ttu-id="a337c-134">Di conseguenza, una più ampia gamma di documenti XML, ad esempio quelli codificati in UTF-8, viene accettata come input in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a337c-134">This allows a wider range of XML documents (for example those encoded in UTF-8) to be accepted as input to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="a337c-135">Se i dati XML di input vengono associati come DBTYPE_WSTR, l'applicazione deve verificare che i dati siano già codificati come Unicode per evitare qualsiasi rischio di danni dovuti a conversioni di dati indesiderate.</span><span class="sxs-lookup"><span data-stu-id="a337c-135">If input XML is bound as DBTYPE_WSTR, the application must ensure it is already Unicode encoded to avoid any possibility of corruption by unwanted data conversions.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="a337c-136">Associazione dati e coercizioni</span><span class="sxs-lookup"><span data-stu-id="a337c-136">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="a337c-137">Nella tabella seguente vengono descritte l'associazione e la coercizione che si verificano quando si usano i tipi di dati elencati con il tipo di dati  **xml** di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a337c-137">The following table describes the binding and coercion that occurs when using the listed data types with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **xml** data type.</span></span>  
  
|<span data-ttu-id="a337c-138">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="a337c-138">Data type</span></span>|<span data-ttu-id="a337c-139">Al server</span><span class="sxs-lookup"><span data-stu-id="a337c-139">To Server</span></span><br /><br /> <span data-ttu-id="a337c-140">**XML**</span><span class="sxs-lookup"><span data-stu-id="a337c-140">**XML**</span></span>|<span data-ttu-id="a337c-141">Al server</span><span class="sxs-lookup"><span data-stu-id="a337c-141">To Server</span></span><br /><br /> <span data-ttu-id="a337c-142">**Non XML**</span><span class="sxs-lookup"><span data-stu-id="a337c-142">**Non-XML**</span></span>|<span data-ttu-id="a337c-143">Dal server</span><span class="sxs-lookup"><span data-stu-id="a337c-143">From Server</span></span><br /><br /> <span data-ttu-id="a337c-144">**XML**</span><span class="sxs-lookup"><span data-stu-id="a337c-144">**XML**</span></span>|<span data-ttu-id="a337c-145">Dal server</span><span class="sxs-lookup"><span data-stu-id="a337c-145">From Server</span></span><br /><br /> <span data-ttu-id="a337c-146">**Non XML**</span><span class="sxs-lookup"><span data-stu-id="a337c-146">**Non-XML**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="a337c-147">DBTYPE_XML</span><span class="sxs-lookup"><span data-stu-id="a337c-147">DBTYPE_XML</span></span>|<span data-ttu-id="a337c-148">Pass-through<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-148">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="a337c-149">Errore<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-149">Error<sup>1</sup></span></span>|<span data-ttu-id="a337c-150">OK<sup>11,6</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-150">OK<sup>11, 6</sup></span></span>|<span data-ttu-id="a337c-151">Errore<sup>8</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-151">Error<sup>8</sup></span></span>|  
|<span data-ttu-id="a337c-152">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="a337c-152">DBTYPE_BYTES</span></span>|<span data-ttu-id="a337c-153">Pass-through<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-153">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="a337c-154">N/D<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-154">N/A<sup>2</sup></span></span>|<span data-ttu-id="a337c-155">OK <sup>11, 6</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-155">OK <sup>11, 6</sup></span></span>|<span data-ttu-id="a337c-156">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-156">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-157">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-157">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-158">Pass-through<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-158">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="a337c-159">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-159">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-160">OK<sup>4, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-160">OK<sup>4, 6, 12</sup></span></span>|<span data-ttu-id="a337c-161">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-161">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-162">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-162">DBTYPE_BSTR</span></span>|<span data-ttu-id="a337c-163">Pass-through<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-163">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="a337c-164">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-164">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-165">OK <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-165">OK <sup>3</sup></span></span>|<span data-ttu-id="a337c-166">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-166">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-167">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="a337c-167">DBTYPE_STR</span></span>|<span data-ttu-id="a337c-168">OK<sup>6, 9, 10</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-168">OK<sup>6, 9, 10</sup></span></span>|<span data-ttu-id="a337c-169">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-169">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-170">OK<sup>5, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-170">OK<sup>5, 6, 12</sup></span></span>|<span data-ttu-id="a337c-171">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-171">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-172">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="a337c-172">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="a337c-173">Flusso di byte tramite **ISequentialStream**<sup>7</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-173">Byte stream via **ISequentialStream**<sup>7</sup></span></span>|<span data-ttu-id="a337c-174">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-174">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-175">Flusso di byte tramite **ISequentialStream**<sup>11</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-175">Byte stream via **ISequentialStream**<sup>11</sup></span></span>|<span data-ttu-id="a337c-176">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-176">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="a337c-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="a337c-178">Pass-through<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-178">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="a337c-179">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-179">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-180">N/D</span><span class="sxs-lookup"><span data-stu-id="a337c-180">N/A</span></span>|<span data-ttu-id="a337c-181">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-181">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="a337c-182">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="a337c-182">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="a337c-183">Pass-through<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-183">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="a337c-184">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-184">N/A <sup>2</sup></span></span>|<span data-ttu-id="a337c-185">OK<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-185">OK<sup>3</sup></span></span>|<span data-ttu-id="a337c-186">N/D <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="a337c-186">N/A <sup>2</sup></span></span>|  
  
 <span data-ttu-id="a337c-187"><sup>1</sup> Se un tipo di server diverso da DBTYPE_XML viene specificato con **ICommandWithParameters:: separameterinfo** e il tipo di funzione di accesso è DBTYPE_XML, si verifica un errore durante l'esecuzione dell'istruzione (DB_E_ERRORSOCCURRED, lo stato del parametro è DBSTATUS_E_BADACCESSOR); in caso contrario, i dati vengono inviati al server, ma il server restituisce un errore che indica che non esiste alcuna conversione implicita da XML al tipo di dati del parametro.</span><span class="sxs-lookup"><span data-stu-id="a337c-187"><sup>1</sup>If a server type other than DBTYPE_XML is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_XML, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED, the parameter status is DBSTATUS_E_BADACCESSOR); otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from XML to the parameter's data type.</span></span>  
  
 <span data-ttu-id="a337c-188"><sup>2</sup> Esula dall'ambito di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="a337c-188"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="a337c-189"><sup>3</sup>Il formato è UTF-16, nessun byte order mark (BOM), nessuna specifica di codifica, nessuna terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-189"><sup>3</sup>Format is UTF-16, no bye-order mark (BOM), no encoding specification, no null termination.</span></span>  
  
 <span data-ttu-id="a337c-190"><sup>4</sup>Il formato è UTF-16, nessun BOM, nessuna specifica di codifica, terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-190"><sup>4</sup>Format is UTF-16, no BOM, no encoding specification, null termination.</span></span>  
  
 <span data-ttu-id="a337c-191"><sup>5</sup>Il formato è caratteri multibyte codificati nella tabella codici del client con terminatore Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-191"><sup>5</sup>Format is multibyte characters encoded in client code page with null terminator.</span></span> <span data-ttu-id="a337c-192">Poiché la conversione dal formato Unicode fornito dal server può provocare danni ai dati, questa associazione è sconsigliata.</span><span class="sxs-lookup"><span data-stu-id="a337c-192">Conversion from server supplied Unicode may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="a337c-193"><sup>6</sup>Può essere usato BY_REF.</span><span class="sxs-lookup"><span data-stu-id="a337c-193"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="a337c-194"><sup>7</sup>I dati UTF-16 devono iniziare con un indicatore BOM.</span><span class="sxs-lookup"><span data-stu-id="a337c-194"><sup>7</sup>UTF-16 data must start with a BOM.</span></span> <span data-ttu-id="a337c-195">In caso contrario, la codifica potrebbe non essere riconosciuta correttamente dal server.</span><span class="sxs-lookup"><span data-stu-id="a337c-195">If it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
 <span data-ttu-id="a337c-196"><sup>8</sup>La convalida può verificarsi in fase di creazione della funzione di accesso o in fase di recupero.</span><span class="sxs-lookup"><span data-stu-id="a337c-196"><sup>8</sup>Validation can happen at create accessor time, or at fetch time.</span></span> <span data-ttu-id="a337c-197">L'errore è DB_E_ERRORSOCCURRED, lo stato dell'associazione è impostato su DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="a337c-197">The error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="a337c-198"><sup>9</sup>I dati vengono convertiti in Unicode usando la tabella codici del client prima di inviarli al server.</span><span class="sxs-lookup"><span data-stu-id="a337c-198"><sup>9</sup>Data is converted to Unicode using the client codepage before being sent to the server.</span></span> <span data-ttu-id="a337c-199">Se la codifica del documento non corrisponde alla tabella codici del client, i dati possono risultare danneggiati e, pertanto, questa associazione è fortemente sconsigliata.</span><span class="sxs-lookup"><span data-stu-id="a337c-199">If the document encoding does not match the client codepage, this can result in data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="a337c-200"><sup>10</sup>Ai dati inviati al server viene sempre aggiunto un indicatore BOM (Byte Order Mark).</span><span class="sxs-lookup"><span data-stu-id="a337c-200"><sup>10</sup>A BOM is always added to data sent to the server.</span></span> <span data-ttu-id="a337c-201">Se i dati iniziano già con un indicatore dell'ordine dei byte, saranno presenti due indicatori dell'ordine dei byte all'inizio del buffer.</span><span class="sxs-lookup"><span data-stu-id="a337c-201">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="a337c-202">Il server utilizza il primo indicatore dell'ordine dei byte per riconoscere la codifica come UTF-16, quindi lo ignora.</span><span class="sxs-lookup"><span data-stu-id="a337c-202">The server uses the first BOM to recognize the encoding as UTF-16 and then discards it.</span></span> <span data-ttu-id="a337c-203">Il secondo indicatore dell'ordine dei byte viene interpretato come spazio unificatore di larghezza zero.</span><span class="sxs-lookup"><span data-stu-id="a337c-203">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
 <span data-ttu-id="a337c-204"><sup>11</sup>Il formato è UTF-16, nessuna specifica di codifica, BOM aggiunto ai dati ricevuti dal server.</span><span class="sxs-lookup"><span data-stu-id="a337c-204"><sup>11</sup>Format is UTF-16, no encoding specification, a BOM is added to data received from the server.</span></span> <span data-ttu-id="a337c-205">Se dal server viene restituita una stringa vuota, all'applicazione viene comunque restituito un indicatore dell'ordine dei byte.</span><span class="sxs-lookup"><span data-stu-id="a337c-205">If an empty string is returned by the server, a BOM is still returned to the application.</span></span> <span data-ttu-id="a337c-206">Se la lunghezza di buffer è un numero dispari di byte, i dati vengono troncati correttamente.</span><span class="sxs-lookup"><span data-stu-id="a337c-206">If the buffer length is an odd number of bytes, the data is truncated correctly.</span></span> <span data-ttu-id="a337c-207">Se il valore intero viene restituito in blocchi, questi possono essere concatenati per ricostituire il valore corretto.</span><span class="sxs-lookup"><span data-stu-id="a337c-207">If the whole value is returned in chunks, they can be concatenated to reconstitute the correct value.</span></span>  
  
 <span data-ttu-id="a337c-208"><sup>12</sup> Se la lunghezza del buffer è minore di due caratteri, ovvero non è sufficiente spazio per la terminazione null, viene segnalato un errore di overflow.</span><span class="sxs-lookup"><span data-stu-id="a337c-208"><sup>12</sup>If the buffer length is less than two characters--that is, not enough space for null termination--an overflow error is reported.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a337c-209">Per i valori XML NULL non viene restituito alcun dato.</span><span class="sxs-lookup"><span data-stu-id="a337c-209">No data is returned for NULL XML values.</span></span>  
  
 <span data-ttu-id="a337c-210">Lo standard XML richiede che i dati XML con codifica UTF-16 inizino con un indicatore dell'ordine dei byte, codice di carattere UTF-16 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="a337c-210">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="a337c-211">Quando si utilizzano binding WSTR e BSTR, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client non richiede né aggiunge un BOM perché la codifica è implicita nell'associazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-211">When working with WSTR and BSTR bindings, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM as the encoding is implied by the binding.</span></span> <span data-ttu-id="a337c-212">Quando si utilizzano associazioni BYTES, XML o IUNKNOWN, lo scopo è semplicità di gestione di altri processori XML e sistemi di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-212">When working with BYTES, XML, or IUNKNOWN bindings, the intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="a337c-213">In questo caso, con i dati XML con codifica UTF-16 deve essere presente un indicatore dell'ordine dei byte e l'applicazione non deve considerare l'effettiva codifica, in quando la maggior parte dei processori XML, incluso SQL Server, deduce la codifica controllando i primi byte del valore.</span><span class="sxs-lookup"><span data-stu-id="a337c-213">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, since the majority of XML processors (including SQL Server) deduces the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="a337c-214">I dati XML ricevuti da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client utilizzando le associazioni bytes, XML o IUnknown sono sempre codificati in UTF-16 con un BOM e senza una dichiarazione di codifica incorporata.</span><span class="sxs-lookup"><span data-stu-id="a337c-214">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using BYTES, XML, or IUNKNOWN bindings is always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
 <span data-ttu-id="a337c-215">Le conversioni dei dati fornite dai servizi OLE DB (**IDataConvert**) principali non sono applicabili a DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-215">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_XML.</span></span>  
  
 <span data-ttu-id="a337c-216">La convalida viene eseguita durante l'invio dei dati al server.</span><span class="sxs-lookup"><span data-stu-id="a337c-216">Validation is done when data is sent to the server.</span></span> <span data-ttu-id="a337c-217">Le modifiche di convalida e di codifica sul lato client devono essere gestite dall'applicazione ed è consigliabile non elaborare i dati XML direttamente, ma utilizzare invece un indicatore dell'ordine dei byte o un lettore SAX per elaborarli.</span><span class="sxs-lookup"><span data-stu-id="a337c-217">Client-side validation and encoding changes should be handled by your application, and it is strongly recommended that you not process the XML data directly, but should instead use a DOM or SAX reader to process it.</span></span>  
  
 <span data-ttu-id="a337c-218">DBTYPE_NULL e DBTYPE_EMPTY possono essere associati per i parametri di input ma non per i parametri di output o per i risultati.</span><span class="sxs-lookup"><span data-stu-id="a337c-218">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="a337c-219">Se vengono associati per i parametri di input, lo stato deve essere impostato su DBSTATUS_S_ISNULL o DBSTATUS_S_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="a337c-219">When bound for input parameters the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="a337c-220">DBTYPE_XML può essere convertito in DBTYPE_EMPTY e DBTYPE_NULL, DBTYPE_EMPTY può essere convertito in DBTYPE_XML, ma DBTYPE_NULL non può essere convertito in DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-220">DBTYPE_XML can be converted to DBTYPE_EMPTY and DBTYPE_NULL, DBTYPE_EMPTY can be converted to DBTYPE_XML, but DBTYPE_NULL cannot be converted to DBTYPE_XML.</span></span> <span data-ttu-id="a337c-221">Questo comportamento è coerente con DBTYPE_WSTR.</span><span class="sxs-lookup"><span data-stu-id="a337c-221">This is consistent with DBTYPE_WSTR.</span></span>  
  
 <span data-ttu-id="a337c-222">Come illustrato nella tabella precedente, DBTYPE_IUNKNOWN è un'associazione supportata, ma non è disponibile alcuna conversione tra DBTYPE_XML e DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="a337c-222">DBTYPE_IUNKNOWN is a supported binding (as shown in the above table), but there are no conversions between DBTYPE_XML and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="a337c-223">DBTYPE_IUNKNOWN non può essere utilizzato con DBTYPE_BYREF.</span><span class="sxs-lookup"><span data-stu-id="a337c-223">DBTYPE_IUNKNOWN may not be used with DBTYPE_BYREF.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="a337c-224">Aggiunte e modifiche ai set di righe OLE DB</span><span class="sxs-lookup"><span data-stu-id="a337c-224">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="a337c-225">Native client aggiunge nuovi valori o modifiche a molti dei set di righe dello schema core OLE DB.</span><span class="sxs-lookup"><span data-stu-id="a337c-225">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-columns-and-procedure_parameters-schema-rowsets"></a><span data-ttu-id="a337c-226">Set di righe dello schema COLUMNS e PROCEDURE_PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="a337c-226">The COLUMNS and PROCEDURE_PARAMETERS Schema Rowsets</span></span>  
 <span data-ttu-id="a337c-227">Tra le aggiunte ai set di righe dello schema COLUMNS e PROCEDURE_PARAMETERS sono incluse le colonne seguenti.</span><span class="sxs-lookup"><span data-stu-id="a337c-227">Additions to the COLUMNS and PROCEDURE_PARAMETERS schema rowsets include the following columns.</span></span>  
  
|<span data-ttu-id="a337c-228">Nome colonna</span><span class="sxs-lookup"><span data-stu-id="a337c-228">Column name</span></span>|<span data-ttu-id="a337c-229">Type</span><span class="sxs-lookup"><span data-stu-id="a337c-229">Type</span></span>|<span data-ttu-id="a337c-230">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a337c-230">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="a337c-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="a337c-232">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-232">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-233">Nome di un catalogo in cui viene definita una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-233">The name of a catalog in which an XML schema collection is defined.</span></span> <span data-ttu-id="a337c-234">NULL per una colonna non XML o una colonna XML non tipizzata.</span><span class="sxs-lookup"><span data-stu-id="a337c-234">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="a337c-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="a337c-236">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-236">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-237">Nome di uno schema in cui viene definita una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-237">The name of a schema in which an XML schema collection is defined.</span></span> <span data-ttu-id="a337c-238">NULL per una colonna non XML o una colonna XML non tipizzata.</span><span class="sxs-lookup"><span data-stu-id="a337c-238">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="a337c-239">SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-239">SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="a337c-240">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-240">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-241">Nome della raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-241">The name of XML schema collection.</span></span> <span data-ttu-id="a337c-242">NULL per una colonna non XML o una colonna XML non tipizzata.</span><span class="sxs-lookup"><span data-stu-id="a337c-242">NULL for a non-XML column or un-typed XML column.</span></span>|  
  
#### <a name="the-provider_types-schema-rowset"></a><span data-ttu-id="a337c-243">Set di righe dello schema PROVIDER_TYPES</span><span class="sxs-lookup"><span data-stu-id="a337c-243">The PROVIDER_TYPES Schema Rowset</span></span>  
 <span data-ttu-id="a337c-244">Nel set di righe dello schema PROVIDER_TYPES il valore di COLUMN_SIZE è 0 per il tipo di dati **xml** e DATA_TYPE è DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-244">In the PROVIDER_TYPES schema rowset, the COLUMN_SIZE value is 0 for the **xml** data type, and the DATA_TYPE is DBTYPE_XML.</span></span>  
  
#### <a name="the-ss_xmlschema-schema-rowset"></a><span data-ttu-id="a337c-245">Set di righe dello schema SS_XMLSCHEMA</span><span class="sxs-lookup"><span data-stu-id="a337c-245">The SS_XMLSCHEMA Schema Rowset</span></span>  
 <span data-ttu-id="a337c-246">È stato introdotto un nuovo set di righe dello schema per i client, denominato SS_XMLSCHEMA, che consente il recupero di informazioni su XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-246">A new schema rowset SS_XMLSCHEMA is introduced for clients to retrieve XML schema information.</span></span> <span data-ttu-id="a337c-247">Il set di righe SS_XMLSCHEMA contiene le colonne seguenti.</span><span class="sxs-lookup"><span data-stu-id="a337c-247">The SS_XMLSCHEMA rowset contains the following columns.</span></span>  
  
|<span data-ttu-id="a337c-248">Nome colonna</span><span class="sxs-lookup"><span data-stu-id="a337c-248">Column name</span></span>|<span data-ttu-id="a337c-249">Type</span><span class="sxs-lookup"><span data-stu-id="a337c-249">Type</span></span>|<span data-ttu-id="a337c-250">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a337c-250">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="a337c-251">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-251">SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="a337c-252">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-252">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-253">Catalogo cui appartiene una raccolta XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-253">The catalog an XML collection belongs to.</span></span>|  
|<span data-ttu-id="a337c-254">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-254">SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="a337c-255">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-255">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-256">Schema cui appartiene una raccolta XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-256">The schema an XML collection belongs to.</span></span>|  
|<span data-ttu-id="a337c-257">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-257">SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="a337c-258">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-258">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-259">Nome di una raccolta di XML Schema per colonne XML tipizzate. In caso contrario, NULL.</span><span class="sxs-lookup"><span data-stu-id="a337c-259">The name of an XML schema collection for typed XML columns, NULL otherwise.</span></span>|  
|<span data-ttu-id="a337c-260">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="a337c-260">TARGETNAMESPACEURI</span></span>|<span data-ttu-id="a337c-261">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-261">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-262">Spazio dei nomi di destinazione di un elemento XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-262">The target name space of an XML schema.</span></span>|  
|<span data-ttu-id="a337c-263">SCHEMACONTENT</span><span class="sxs-lookup"><span data-stu-id="a337c-263">SCHEMACONTENT</span></span>|<span data-ttu-id="a337c-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-265">Contenuto dell'elemento XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-265">The XML schema content.</span></span>|  
  
 <span data-ttu-id="a337c-266">L'ambito di ogni XML Schema è costituito da nome del catalogo, nome dello schema, nome della raccolta di schemi e URI dello spazio dei nomi di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-266">Each XML schema is scoped by catalog name, schema name, schema collection name, and target name space Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="a337c-267">Viene inoltre definito un nuovo GUID con il nome DBSCHEMA_XML_COLLECTIONS.</span><span class="sxs-lookup"><span data-stu-id="a337c-267">In addition, a new GUID with the name DBSCHEMA_XML_COLLECTIONS is also defined.</span></span> <span data-ttu-id="a337c-268">Il numero di restrizioni e di colonne limitate per il set di righe dello schema SS_XMLSCHEMA viene definito come segue.</span><span class="sxs-lookup"><span data-stu-id="a337c-268">The number of restrictions and restricted columns for the SS_XMLSCHEMA schema rowset are defined as follows.</span></span>  
  
|<span data-ttu-id="a337c-269">GUID</span><span class="sxs-lookup"><span data-stu-id="a337c-269">GUID</span></span>|<span data-ttu-id="a337c-270">Numero di restrizioni</span><span class="sxs-lookup"><span data-stu-id="a337c-270">Number of restrictions</span></span>|<span data-ttu-id="a337c-271">Colonne limitate</span><span class="sxs-lookup"><span data-stu-id="a337c-271">Restricted columns</span></span>|  
|----------|----------------------------|------------------------|  
|<span data-ttu-id="a337c-272">DBSCHEMA_XML_COLLECTIONS</span><span class="sxs-lookup"><span data-stu-id="a337c-272">DBSCHEMA_XML_COLLECTIONS</span></span>|<span data-ttu-id="a337c-273">4</span><span class="sxs-lookup"><span data-stu-id="a337c-273">4</span></span>|<span data-ttu-id="a337c-274">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-274">SCHEMACOLLECTION_CATALOGNAME</span></span><br /><br /> <span data-ttu-id="a337c-275">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-275">SCHEMACOLLECTION_SCHEMANAME</span></span><br /><br /> <span data-ttu-id="a337c-276">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-276">SCHEMACOLLECTIONNAME</span></span><br /><br /> <span data-ttu-id="a337c-277">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="a337c-277">TARGETNAMESPACEURI</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="a337c-278">Aggiunte e modifiche ai set di proprietà OLE DB</span><span class="sxs-lookup"><span data-stu-id="a337c-278">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="a337c-279">Native client aggiunge nuovi valori o modifiche a molti dei set di proprietà OLE DB principali.</span><span class="sxs-lookup"><span data-stu-id="a337c-279">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="a337c-280">Set di proprietà DBPROPSET_SQLSERVERPARAMETER</span><span class="sxs-lookup"><span data-stu-id="a337c-280">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="a337c-281">Per supportare il tipo di dati **XML** tramite OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implementa il nuovo set di proprietà DBPROPSET_SQLSERVERPARAMETER, che contiene i valori seguenti.</span><span class="sxs-lookup"><span data-stu-id="a337c-281">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set, which contains the following values.</span></span>  
  
|<span data-ttu-id="a337c-282">Nome</span><span class="sxs-lookup"><span data-stu-id="a337c-282">Name</span></span>|<span data-ttu-id="a337c-283">Type</span><span class="sxs-lookup"><span data-stu-id="a337c-283">Type</span></span>|<span data-ttu-id="a337c-284">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a337c-284">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="a337c-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="a337c-286">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-286">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-287">Nome di un catalogo (database) in cui viene definita una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-287">The name of a catalog (database) in which an XML schema collection is defined.</span></span> <span data-ttu-id="a337c-288">Una delle tre parti di cui è composto l'identificatore del nome SQL.</span><span class="sxs-lookup"><span data-stu-id="a337c-288">A part of the SQL three-part name identifier.</span></span>|  
|<span data-ttu-id="a337c-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="a337c-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-291">Nome di un elemento XML Schema all'interno della raccolta di schemi.</span><span class="sxs-lookup"><span data-stu-id="a337c-291">The name of an XML schema within the schema collection.</span></span> <span data-ttu-id="a337c-292">Una delle tre parti di cui è composto l'identificatore del nome SQL.</span><span class="sxs-lookup"><span data-stu-id="a337c-292">A part of the SQL three -part name identifier.</span></span>|  
|<span data-ttu-id="a337c-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="a337c-294">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-294">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-295">Nome della raccolta di XML Schema all'interno del catalogo. Una delle tre parti di cui è composto l'identificatore del nome SQL.</span><span class="sxs-lookup"><span data-stu-id="a337c-295">The name of the XML schema collection within the catalog A part of the SQL three -part name identifier.</span></span>|  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="a337c-296">Set di proprietà DBPROPSET_SQLSERVERCOLUMN</span><span class="sxs-lookup"><span data-stu-id="a337c-296">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="a337c-297">Per supportare la creazione di tabelle nell'interfaccia **ITableDefinition** , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client aggiunge tre nuove colonne al set di proprietà DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="a337c-297">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="a337c-298">Nome</span><span class="sxs-lookup"><span data-stu-id="a337c-298">Name</span></span>|<span data-ttu-id="a337c-299">Type</span><span class="sxs-lookup"><span data-stu-id="a337c-299">Type</span></span>|<span data-ttu-id="a337c-300">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a337c-300">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="a337c-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="a337c-302">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-302">VT_BSTR</span></span>|<span data-ttu-id="a337c-303">Per le colonne XML tipizzate, questa proprietà è una stringa che specifica il nome del catalogo in cui viene archiviato l'elemento XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-303">For typed XML columns, this property is a string specifying the name of the catalog where the XML schema is stored.</span></span> <span data-ttu-id="a337c-304">Per gli altri tipi di colonna questa proprietà restituisce una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="a337c-304">For other column types this property returns an empty string.</span></span>|  
|<span data-ttu-id="a337c-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="a337c-306">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-306">VT_BSTR</span></span>|<span data-ttu-id="a337c-307">Per le colonne XML tipizzate, questa proprietà è una stringa che specifica il nome dell'elemento XML Schema che definisce la colonna.</span><span class="sxs-lookup"><span data-stu-id="a337c-307">For typed XML columns, this property is a string specifying the name of XML schema that defines this column.</span></span>|  
|<span data-ttu-id="a337c-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="a337c-309">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-309">VT_BSTR</span></span>|<span data-ttu-id="a337c-310">Per le colonne XML tipizzate, questa proprietà è una stringa che specifica il nome della raccolta di XML Schema che definisce il valore.</span><span class="sxs-lookup"><span data-stu-id="a337c-310">For typed XML columns, this property is a string specifying the name of the schema XML schema collection defining the value.</span></span>|  
  
 <span data-ttu-id="a337c-311">Analogamente ai valori di SSPROP_PARAM, tutte queste proprietà sono facoltative e non sono specificate per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a337c-311">Like the SSPROP_PARAM values, all of these properties are optional and default to empty.</span></span> <span data-ttu-id="a337c-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME e SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME possono essere specificate solo se si specifica SSPROP_COL_XML_SCHEMACOLLECTIONNAME.</span><span class="sxs-lookup"><span data-stu-id="a337c-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME and SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME may only be specified if SSPROP_COL_XML_SCHEMACOLLECTIONNAME is specified.</span></span> <span data-ttu-id="a337c-313">Se quando si passano dati XML al server questi valori sono inclusi, ne viene verificata l'esistenza (validità) rispetto al database corrente e i dati dell'istanza vengono controllati rispetto allo schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-313">When passing XML to the server, if these values are included they are checked for existence (validity) against the current database and the instance data is checked against the schema.</span></span> <span data-ttu-id="a337c-314">In tutti i casi, per essere validi tali valori devono essere tutti vuoti o specificati.</span><span class="sxs-lookup"><span data-stu-id="a337c-314">In all cases, to be valid they are either all empty or all filled in.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="a337c-315">Aggiunte e modifiche alle interfacce OLE DB</span><span class="sxs-lookup"><span data-stu-id="a337c-315">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="a337c-316">Native client aggiunge nuovi valori o modifiche a molte delle interfacce di OLE DB principali.</span><span class="sxs-lookup"><span data-stu-id="a337c-316">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="a337c-317">Interfaccia ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="a337c-317">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="a337c-318">Per supportare il tipo di dati **XML** tramite OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implementa una serie di modifiche, inclusa l'aggiunta dell'interfaccia [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) .</span><span class="sxs-lookup"><span data-stu-id="a337c-318">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes including the addition of the [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span> <span data-ttu-id="a337c-319">Questa nuova interfaccia eredita dall'interfaccia OLE DB principale **ICommandWithParameters**.</span><span class="sxs-lookup"><span data-stu-id="a337c-319">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="a337c-320">Oltre ai tre metodi ereditati da **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**e **separameterinfo**; **ISSCommandWithParameters** fornisce i metodi [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) e [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) utilizzati per gestire i tipi di dati specifici del server.</span><span class="sxs-lookup"><span data-stu-id="a337c-320">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) and [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a337c-321">L'interfaccia **ISSCommandWithParameters** usa anche la nuova struttura SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="a337c-321">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="a337c-322">Interfaccia IColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="a337c-322">The IColumnsRowset Interface</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="a337c-323">Native client aggiunge le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] colonne specifiche seguenti al set di righe restituito dal metodo **interfaccia IColumnRowset:: GetColumnsRowset** .</span><span class="sxs-lookup"><span data-stu-id="a337c-323">Native Client adds the following [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific columns to the rowset returned by the **IColumnRowset::GetColumnsRowset** method.</span></span> <span data-ttu-id="a337c-324">Tali colonne contengono il nome in tre parti di una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-324">These columns contain the three-part name of an XML schema collection.</span></span> <span data-ttu-id="a337c-325">Per le colonne non XML o per le colonne XML non tipizzate, le tre colonne assumono tutte il valore predefinito NULL.</span><span class="sxs-lookup"><span data-stu-id="a337c-325">For non-XML columns or untyped XML columns, all three columns take the default value of NULL.</span></span>  
  
|<span data-ttu-id="a337c-326">Nome colonna</span><span class="sxs-lookup"><span data-stu-id="a337c-326">Column name</span></span>|<span data-ttu-id="a337c-327">Type</span><span class="sxs-lookup"><span data-stu-id="a337c-327">Type</span></span>|<span data-ttu-id="a337c-328">Descrizione</span><span class="sxs-lookup"><span data-stu-id="a337c-328">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="a337c-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="a337c-330">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-330">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-331">Catalogo cui appartiene una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-331">The catalog an XML schema collection belongs to,</span></span><br /><br /> <span data-ttu-id="a337c-332">In caso contrario, NULL.</span><span class="sxs-lookup"><span data-stu-id="a337c-332">NULL otherwise.</span></span>|  
|<span data-ttu-id="a337c-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="a337c-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="a337c-334">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-334">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-335">Schema cui appartiene una raccolta di XML Schema.</span><span class="sxs-lookup"><span data-stu-id="a337c-335">The schema an XML schema collection belongs to.</span></span> <span data-ttu-id="a337c-336">In caso contrario, NULL.</span><span class="sxs-lookup"><span data-stu-id="a337c-336">NULL otherwise.</span></span>|  
|<span data-ttu-id="a337c-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="a337c-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="a337c-338">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="a337c-338">DBTYPE_WSTR</span></span>|<span data-ttu-id="a337c-339">Nome della raccolta di XML Schema per le colonne XML tipizzate. In caso contrario, NULL.</span><span class="sxs-lookup"><span data-stu-id="a337c-339">The name of XML schema collection for typed XML column, NULL otherwise.</span></span>|  
  
#### <a name="the-irowset-interface"></a><span data-ttu-id="a337c-340">Interfaccia IRowset</span><span class="sxs-lookup"><span data-stu-id="a337c-340">The IRowset Interface</span></span>  
 <span data-ttu-id="a337c-341">Un'istanza XML in una colonna XML viene recuperata tramite il metodo **IRowset::GetData**.</span><span class="sxs-lookup"><span data-stu-id="a337c-341">An XML instance in an XML column is retrieved through the **IRowset::GetData** method.</span></span> <span data-ttu-id="a337c-342">A seconda dell'associazione specificata dal client, un'istanza XML può essere recuperata come DBTYPE_BSTR, DBTYPE_WSTR DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES o come interfaccia tramite DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="a337c-342">Depending on the binding specified by the client, an XML instance can be retrieved as DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES, or as an interface via DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="a337c-343">Se il consumer specifica DBTYPE_BSTR, DBTYPE_WSTR o DBTYPE_VARIANT, il provider converte l'istanza XML nel tipo richiesto dall'utente e la archivia nella posizione specificata nell'associazione corrispondente.</span><span class="sxs-lookup"><span data-stu-id="a337c-343">If the consumer specifies DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider converts the XML instance to the user requested type and put it into the location specified in the corresponding binding.</span></span>  
  
 <span data-ttu-id="a337c-344">Se il consumer specifica DBTYPE_IUNKNOWN e imposta l'argomento *pObject* su NULL oppure imposta l'argomento *pObject* su IID_ISequentialStream, il provider restituisce un'interfaccia **ISequentialStream** all'utente in modo che questi possa eseguire il flusso dei dati XML all'esterno della colonna.</span><span class="sxs-lookup"><span data-stu-id="a337c-344">If the consumer specifies DBTYPE_IUNKNOWN and sets the *pObject* argument to NULL, or sets the *pObject* argument to IID_ISequentialStream, the provider returns an **ISequentialStream** interface to the consumer so that the consumer can stream the XML data out of the column.</span></span> <span data-ttu-id="a337c-345">**ISequentialStream** restituisce quindi i dati XML come flusso di caratteri Unicode.</span><span class="sxs-lookup"><span data-stu-id="a337c-345">**ISequentialStream** then returns the XML data as a Unicode character stream.</span></span>  
  
 <span data-ttu-id="a337c-346">Quando viene restituito un valore XML associato a DBTYPE_IUNKNOWN, il provider segnala un valore di dimensioni `sizeof (IUnknown *)`.</span><span class="sxs-lookup"><span data-stu-id="a337c-346">When returning an XML value bound to DBTYPE_IUNKNOWN, the provider reports a size value of `sizeof (IUnknown *)`.</span></span> <span data-ttu-id="a337c-347">Si noti che questo comportamento è coerente con l'approccio adottato quando una colonna è associata come DBTYPE_IUnknown o DBTYPE_IDISPATCH, e tramite DBTYPE_IUNKNOWN/ISequentialStream quando non è possibile determinare con esattezza le dimensioni della colonna.</span><span class="sxs-lookup"><span data-stu-id="a337c-347">Note that this is consistent with the approach taken when a column is bound as DBTYPE_IUnknown or DBTYPE_IDISPATCH, and by DBTYPE_IUNKNOWN/ISequentialStream when the exact column size cannot be determined.</span></span>  
  
#### <a name="the-irowsetchange-interface"></a><span data-ttu-id="a337c-348">Interfaccia IRowsetChange</span><span class="sxs-lookup"><span data-stu-id="a337c-348">The IRowsetChange Interface</span></span>  
 <span data-ttu-id="a337c-349">Il consumer può aggiornare un'istanza XML in una colonna utilizzando due modalità diverse.</span><span class="sxs-lookup"><span data-stu-id="a337c-349">There are two ways a consumer can update an XML instance in a column.</span></span> <span data-ttu-id="a337c-350">La prima consiste nell'usare l'oggetto **ISequentialStream** creato dal provider.</span><span class="sxs-lookup"><span data-stu-id="a337c-350">The first one is through the storage object **ISequentialStream** created by the provider.</span></span> <span data-ttu-id="a337c-351">Il consumer può chiamare il metodo **ISequentialStream::Write** per aggiornare direttamente l'istanza XML restituita dal provider.</span><span class="sxs-lookup"><span data-stu-id="a337c-351">The consumer can call the **ISequentialStream::Write** method to directly update the XML instance returned by the provider.</span></span>  
  
 <span data-ttu-id="a337c-352">Il secondo approccio consiste nell'usare il metodo **IRowsetChange::SetData** o **IRowsetChange::InsertRow**.</span><span class="sxs-lookup"><span data-stu-id="a337c-352">The second approach is through **IRowsetChange::SetData** or **IRowsetChange::InsertRow** methods.</span></span> <span data-ttu-id="a337c-353">In questo approccio è possibile specificare un'istanza XML nel buffer del consumer in un'associazione di tipo DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML o DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="a337c-353">In this approach, an XML instance in the consumer's buffer can be specified in a binding of type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML or DBTYPE_IUNKNOWN.</span></span>  
  
 <span data-ttu-id="a337c-354">Se si utilizza il tipo DBTYPE_BSTR, DBTYPE_WSTR o DBTYPE_VARIANT, il provider archivia l'istanza XML che si trova nel buffer del consumer nella colonna appropriata.</span><span class="sxs-lookup"><span data-stu-id="a337c-354">In case of DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider stores the XML instance residing in the consumer buffer into the proper column.</span></span>  
  
 <span data-ttu-id="a337c-355">Nel caso di DBTYPE_IUNKNOWN/ISequentialStream, se il consumer non specifica alcun oggetto di archiviazione, il consumer deve creare un oggetto **ISequentialStream** in anticipo, associare il documento XML all'oggetto, quindi passare l'oggetto al provider tramite il metodo **IRowsetChange:: SetData** .</span><span class="sxs-lookup"><span data-stu-id="a337c-355">In the case of DBTYPE_IUNKNOWN/ISequentialStream, if the consumer does not specify any storage object, the consumer must create an **ISequentialStream** object in advance, bind the XML document with the object, and then pass the object to the provider through the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="a337c-356">Il consumer può creare inoltre un oggetto di archiviazione, impostare l'argomento pObject su IID_ISequentialStream, creare un oggetto **ISequentialStream**, quindi passare l'oggetto **ISequentialStream** al metodo **IRowsetChange::SetData**.</span><span class="sxs-lookup"><span data-stu-id="a337c-356">The consumer can also create a storage object, set the pObject argument to IID_ISequentialStream, create an **ISequentialStream** object and then pass the **ISequentialStream** object to the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="a337c-357">In entrambi casi, il provider può recuperare l'oggetto XML tramite l'oggetto **ISequentialStream** e può inserirlo in una colonna appropriata.</span><span class="sxs-lookup"><span data-stu-id="a337c-357">In both cases, the provider can retrieve the XML object through the **ISequentialStream** object and insert it into a proper column.</span></span>  
  
#### <a name="the-irowsetupdate-interface"></a><span data-ttu-id="a337c-358">Interfaccia IRowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="a337c-358">The IRowsetUpdate Interface</span></span>  
 <span data-ttu-id="a337c-359">L'interfaccia **IRowsetUpdate** fornisce una funzionalità per aggiornamenti ritardati.</span><span class="sxs-lookup"><span data-stu-id="a337c-359">**IRowsetUpdate** interface provides functionality for delayed updates.</span></span> <span data-ttu-id="a337c-360">I dati resi disponibili per i set di righe non vengono resi disponibili ad altre transazioni fino a quando il consumer non chiama il metodo **IRowsetUpdate: Update** .</span><span class="sxs-lookup"><span data-stu-id="a337c-360">The data made available to the rowsets is not made available to other transactions until the consumer calls the **IRowsetUpdate:Update** method.</span></span>  
  
#### <a name="the-irowsetfind-interface"></a><span data-ttu-id="a337c-361">Interfaccia IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="a337c-361">The IRowsetFind Interface</span></span>  
 <span data-ttu-id="a337c-362">Non è possibile usare il metodo **IRowsetFind::FindNextRow** con il tipo di dati **xml**.</span><span class="sxs-lookup"><span data-stu-id="a337c-362">The **IRowsetFind::FindNextRow** method does not work with the **xml** data type.</span></span> <span data-ttu-id="a337c-363">Quando **IRowsetFind::FindNextRow** viene chiamato e l'argomento *hAccessor* specifica una colonna di tipo DBTYPE_XML, viene restituito DB_E_BADBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="a337c-363">When **IRowsetFind::FindNextRow** is called and the *hAccessor* argument specifies a column of DBTYPE_XML, DB_E_BADBINDINFO is returned.</span></span> <span data-ttu-id="a337c-364">Ciò si verifica indipendentemente dal tipo di colonna di cui si esegue la ricerca.</span><span class="sxs-lookup"><span data-stu-id="a337c-364">This occurs regardless of the type of column that is being searched.</span></span> <span data-ttu-id="a337c-365">Per qualsiasi altro tipo di associazione, **FindNextRow** ha esito negativo con DB_E_BADCOMPAREOP se la colonna da cercare è del tipo di dati **xml**.</span><span class="sxs-lookup"><span data-stu-id="a337c-365">For any other binding type, the **FindNextRow** fails with DB_E_BADCOMPAREOP if the column to be searched is of the **xml** data type.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="a337c-366">Driver ODBC di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="a337c-366">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="a337c-367">Nel [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client sono state apportate alcune modifiche a diverse funzioni per supportare il tipo di dati **XML** .</span><span class="sxs-lookup"><span data-stu-id="a337c-367">In the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, a number of changes have been made to various functions to support the **xml** data type.</span></span>  
  
### <a name="sqlcolattribute"></a><span data-ttu-id="a337c-368">SQLColAttribute</span><span class="sxs-lookup"><span data-stu-id="a337c-368">SQLColAttribute</span></span>  
 <span data-ttu-id="a337c-369">La funzione [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) presenta tre nuovi identificatori di campo, tra cui SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME e SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="a337c-369">The [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) function has three new field identifiers, including SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span></span>  
  
 <span data-ttu-id="a337c-370">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client segnala SQL_SS_LENGTH_UNLIMITED per le colonne SQL_DESC_DISPLAY_SIZE e SQL_DESC_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="a337c-370">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the SQL_DESC_DISPLAY_SIZE and SQL_DESC_LENGTH columns.</span></span>  
  
### <a name="sqlcolumns"></a><span data-ttu-id="a337c-371">SQLColumns</span><span class="sxs-lookup"><span data-stu-id="a337c-371">SQLColumns</span></span>  
 <span data-ttu-id="a337c-372">La funzione [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) include tre nuove colonne, tra cui SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME e SS_XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="a337c-372">The [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) function has three new columns including SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SS_XML_SCHEMACOLLECTION_NAME.</span></span> <span data-ttu-id="a337c-373">La colonna TYPE_NAME esistente viene utilizzata per indicare il nome del tipo XML e DATA_TYPE per una colonna o un parametro di tipo XML è SQL_SS_XML.</span><span class="sxs-lookup"><span data-stu-id="a337c-373">The existing TYPE_NAME column is used to indicate the name of the XML type, and the DATA_TYPE for a XML type column or parameter is SQL_SS_XML.</span></span>  
  
 <span data-ttu-id="a337c-374">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client segnala SQL_SS_LENGTH_UNLIMITED per i valori COLUMN_SIZE e CHAR_OCTET_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="a337c-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the COLUMN_SIZE and CHAR_OCTET_LENGTH values.</span></span>  
  
### <a name="sqldescribecol"></a><span data-ttu-id="a337c-375">SQLDescribeCol</span><span class="sxs-lookup"><span data-stu-id="a337c-375">SQLDescribeCol</span></span>  
 <span data-ttu-id="a337c-376">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client segnala SQL_SS_LENGTH_UNLIMITED quando non è possibile determinare le dimensioni della colonna nella funzione [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) .</span><span class="sxs-lookup"><span data-stu-id="a337c-376">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED when the column size cannot be determined in the [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) function.</span></span>  
  
### <a name="sqlgettypeinfo"></a><span data-ttu-id="a337c-377">SQLGetTypeInfo</span><span class="sxs-lookup"><span data-stu-id="a337c-377">SQLGetTypeInfo</span></span>  
 <span data-ttu-id="a337c-378">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client segnala SQL_SS_LENGTH_UNLIMITED come COLUMN_SIZE massimo per il tipo di dati **XML** nella funzione [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) .</span><span class="sxs-lookup"><span data-stu-id="a337c-378">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type in the [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) function.</span></span>  
  
### <a name="sqlprocedurecolumns"></a><span data-ttu-id="a337c-379">SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="a337c-379">SQLProcedureColumns</span></span>  
 <span data-ttu-id="a337c-380">La funzione [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) presenta le stesse aggiunte di colonna della funzione **SQLColumns** .</span><span class="sxs-lookup"><span data-stu-id="a337c-380">The [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) function has the same column additions as the **SQLColumns** function.</span></span>  
  
 <span data-ttu-id="a337c-381">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client segnala SQL_SS_LENGTH_UNLIMITED come COLUMN_SIZE massimo per il tipo di dati **XML** .</span><span class="sxs-lookup"><span data-stu-id="a337c-381">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="a337c-382">Conversioni supportate</span><span class="sxs-lookup"><span data-stu-id="a337c-382">Supported Conversions</span></span>  
 <span data-ttu-id="a337c-383">Quando si esegue una conversione dai tipi di dati SQL ai tipi di dati C, SQL_C_WCHAR, SQL_C_BINARY e SQL_C_CHAR possono essere convertiti tutti in SQL_SS_XML alle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a337c-383">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="a337c-384">SQL_C_WCHAR: il formato è UTF-16, nessun indicatore dell'ordine dei byte, con terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-384">SQL_C_WCHAR: Format is UTF-16, no byte-order mark (BOM), with null termination.</span></span>  
  
-   <span data-ttu-id="a337c-385">SQL_C_BINARY: il formato è UTF-16, senza alcuna terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-385">SQL_C_BINARY: Format is UTF-16, with no null termination.</span></span> <span data-ttu-id="a337c-386">Ai dati ricevuti dal server viene aggiunto un indicatore dell'ordine dei byte.</span><span class="sxs-lookup"><span data-stu-id="a337c-386">A BOM is added to data received from the server.</span></span> <span data-ttu-id="a337c-387">Se dal server viene restituita una stringa vuota, all'applicazione viene comunque restituito un indicatore dell'ordine dei byte.</span><span class="sxs-lookup"><span data-stu-id="a337c-387">If an empty string is returned by the server a BOM is still returned to the application.</span></span> <span data-ttu-id="a337c-388">Se la lunghezza di buffer è un numero dispari di byte, i dati vengono troncati correttamente.</span><span class="sxs-lookup"><span data-stu-id="a337c-388">If the buffer length is an odd number of bytes the data ise truncated correctly.</span></span> <span data-ttu-id="a337c-389">Se il valore intero viene restituito in blocchi, questi possono essere concatenati per ricostituire il valore corretto.</span><span class="sxs-lookup"><span data-stu-id="a337c-389">If the whole value is returned in chunks they can be concatenated to re-constitute the correct value</span></span>  
  
-   <span data-ttu-id="a337c-390">SQL_C_CHAR: il formato è caratteri multibyte codificati nella tabella codici del client con terminazione Null.</span><span class="sxs-lookup"><span data-stu-id="a337c-390">SQL_C_CHAR: Format is multibyte characters encoded in client code page with null termination.</span></span> <span data-ttu-id="a337c-391">Poiché la conversione dal formato UTF-16 fornito dal server può provocare danni ai dati, questa associazione è sconsigliata.</span><span class="sxs-lookup"><span data-stu-id="a337c-391">Conversion from server supplied UTF-16 may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="a337c-392">Quando si esegue una conversione dai tipi di dati V ai tipi di dati SQL, SQL_C_WCHAR, SQL_C_BINARY e SQL_C_CHAR possono essere convertiti tutti in SQL_SS_XML alle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a337c-392">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="a337c-393">SQL_C_WCHAR: ai dati inviati al server viene sempre aggiunto un indicatore dell'ordine dei byte.</span><span class="sxs-lookup"><span data-stu-id="a337c-393">SQL_C_WCHAR: A BOM is always be added to data sent to the server.</span></span> <span data-ttu-id="a337c-394">Se i dati iniziano già con un indicatore dell'ordine dei byte, saranno presenti due indicatori dell'ordine dei byte all'inizio del buffer.</span><span class="sxs-lookup"><span data-stu-id="a337c-394">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="a337c-395">Il server utilizza il primo indicatore dell'ordine dei byte per riconoscere la codifica come UTF-16, quindi lo ignora.</span><span class="sxs-lookup"><span data-stu-id="a337c-395">The server uses the first BOM to recognize the encoding as UTF-16 and then discard it.</span></span> <span data-ttu-id="a337c-396">Il secondo indicatore dell'ordine dei byte viene interpretato come spazio unificatore di larghezza zero.</span><span class="sxs-lookup"><span data-stu-id="a337c-396">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
-   <span data-ttu-id="a337c-397">SQL_C_BINARY: non viene eseguita alcuna conversione e i dati vengono passati al server come invariati.</span><span class="sxs-lookup"><span data-stu-id="a337c-397">SQL_C_BINARY: No conversion is performed, and the data is passed to the server "as is."</span></span> <span data-ttu-id="a337c-398">I dati UTF-16 devono iniziare con un indicatore dell'ordine dei byte. In caso contrario, la codifica potrebbe non essere riconosciuta correttamente dal server.</span><span class="sxs-lookup"><span data-stu-id="a337c-398">UTF-16 data must start with a BOM; if it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
-   <span data-ttu-id="a337c-399">SQL_C_CHAR: i dati vengono convertiti in UTF-16 nel client e inviati al server solo come SQL_C_WCHAR, aggiungendo un indicatore dell'ordine dei byte.</span><span class="sxs-lookup"><span data-stu-id="a337c-399">SQL_C_CHAR: The data is converted to UTF-16 on the client and sent to the server just as SQL_C_WCHAR (including the addition of a BOM).</span></span> <span data-ttu-id="a337c-400">La mancata codifica dei dati XML nella tabella codici del client può provocare danni ai dati.</span><span class="sxs-lookup"><span data-stu-id="a337c-400">If the XML is not encoded in the client code page this can cause data corruption.</span></span>  
  
 <span data-ttu-id="a337c-401">Lo standard XML richiede che i dati XML con codifica UTF-16 inizino con un indicatore dell'ordine dei byte, codice di carattere UTF-16 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="a337c-401">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="a337c-402">Quando si utilizza un'associazione SQL_C_BINARY, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client non richiede né aggiunge un BOM, perché la codifica è implicita nell'associazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-402">When working with a SQL_C_BINARY binding, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM, as the encoding is implied by the binding.</span></span> <span data-ttu-id="a337c-403">Lo scopo consiste nel fornire semplicità di gestione con altri elaboratori XML e sistemi dell'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a337c-403">The intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="a337c-404">In questo caso, con i dati XML con codifica UTF-16 deve essere presente un indicatore dell'ordine dei byte e l'applicazione non deve considerare l'effettiva codifica, in quando la maggior parte dei processori XML, incluso [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], deduce la codifica controllando i primi byte del valore.</span><span class="sxs-lookup"><span data-stu-id="a337c-404">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, because the majority of XML processors (including [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) deduce the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="a337c-405">I dati XML ricevuti da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client usando associazioni SQL_C_BINARY vengono sempre codificati in UTF-16 con un BOM e senza una dichiarazione di codifica incorporata.</span><span class="sxs-lookup"><span data-stu-id="a337c-405">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using SQL_C_BINARY bindings are always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a337c-406">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a337c-406">See Also</span></span>  
 <span data-ttu-id="a337c-407">[Funzionalità di SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="a337c-407">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="a337c-408">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="a337c-408">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
