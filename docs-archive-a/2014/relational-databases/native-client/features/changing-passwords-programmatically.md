---
title: Modifica delle password a livello di programmazione | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], password expiration
- SQL Server Native Client ODBC driver, passwords
- SQL Server Native Client OLE DB provider, passwords
- passwords [SQL Server], expiration
- SQLNCLI, password expiration
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- expired passwords [SQL Server Native Client]
- SQL Server Native Client, password expiration
- modifying passwords
ms.assetid: 624ad949-5fed-4ce5-b319-878549f9487b
author: rothja
ms.author: jroth
ms.openlocfilehash: 86085f8ba7c54cfcab1a3c7f6e8ade30ecf9d0da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714291"
---
# <a name="changing-passwords-programmatically"></a><span data-ttu-id="fddc1-102">Modifica delle password a livello di programmazione</span><span class="sxs-lookup"><span data-stu-id="fddc1-102">Changing Passwords Programmatically</span></span>
  <span data-ttu-id="fddc1-103">Nelle versioni precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] una password di un utente scaduta può essere reimpostata solo da un amministratore.</span><span class="sxs-lookup"><span data-stu-id="fddc1-103">Before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], when a user's password expired, only an administrator could reset it.</span></span> <span data-ttu-id="fddc1-104">A partire da [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supporta la gestione della scadenza delle password a livello di programmazione tramite il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native client e il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native client e le modifiche apportate alle finestre di dialogo **SQL Server account di accesso** .</span><span class="sxs-lookup"><span data-stu-id="fddc1-104">Beginning with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports handling password expiration programmatically through both the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and through changes to the **SQL Server Login** dialog boxes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fddc1-105">Quando possibile, richiedere agli utenti di immettere le credenziali in fase di esecuzione ed evitare di archiviarle in un formato persistente.</span><span class="sxs-lookup"><span data-stu-id="fddc1-105">When possible, prompt users to enter their credentials at run time and avoid storing their credentials in a persisted format.</span></span> <span data-ttu-id="fddc1-106">Se è necessario rendere persistenti le credenziali, è consigliabile crittografarle usando l'[API di crittografia Win32](https://go.microsoft.com/fwlink/?LinkId=64532).</span><span class="sxs-lookup"><span data-stu-id="fddc1-106">If you must persist their credentials, you should encrypt them using the [Win32 crypto API](https://go.microsoft.com/fwlink/?LinkId=64532).</span></span> <span data-ttu-id="fddc1-107">Per altre informazioni sull'uso delle password, vedere [Password complesse](../../security/strong-passwords.md).</span><span class="sxs-lookup"><span data-stu-id="fddc1-107">For more information about the use of passwords, see [Strong Passwords](../../security/strong-passwords.md).</span></span>  
  
## <a name="sql-server-login-error-codes"></a><span data-ttu-id="fddc1-108">Codici di errore degli account di accesso di SQL Server</span><span class="sxs-lookup"><span data-stu-id="fddc1-108">SQL Server Login Error Codes</span></span>  
 <span data-ttu-id="fddc1-109">Quando non è possibile stabilire una connessione a causa di problemi di autenticazione, sarà disponibile uno dei codici di errore di SQL Server seguenti per consentire la diagnosi e il recupero.</span><span class="sxs-lookup"><span data-stu-id="fddc1-109">When a connection cannot be made because of authentication problems, one of the following SQL Server error codes will be available to the application to assist diagnosis and recovery.</span></span>  
  
|<span data-ttu-id="fddc1-110">Codice di errore di SQL Server</span><span class="sxs-lookup"><span data-stu-id="fddc1-110">SQL Server Error Code</span></span>|<span data-ttu-id="fddc1-111">Messaggio di errore</span><span class="sxs-lookup"><span data-stu-id="fddc1-111">Error Message</span></span>|  
|---------------------------|-------------------|  
|<span data-ttu-id="fddc1-112">15113</span><span class="sxs-lookup"><span data-stu-id="fddc1-112">15113</span></span>|<span data-ttu-id="fddc1-113">Accesso non riuscito per l'utente '%.\*ls' Motivo: impossibile convalidare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-113">Login failed for user '%.\*ls' Reason: Password validation failed.</span></span> <span data-ttu-id="fddc1-114">L'account è bloccato.</span><span class="sxs-lookup"><span data-stu-id="fddc1-114">The account is locked out.</span></span>|  
|<span data-ttu-id="fddc1-115">18463</span><span class="sxs-lookup"><span data-stu-id="fddc1-115">18463</span></span>|<span data-ttu-id="fddc1-116">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-116">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-117">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-117">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-118">Impossibile utilizzare la password in questo momento.</span><span class="sxs-lookup"><span data-stu-id="fddc1-118">The password cannot be used at this time.</span></span>|  
|<span data-ttu-id="fddc1-119">18464</span><span class="sxs-lookup"><span data-stu-id="fddc1-119">18464</span></span>|<span data-ttu-id="fddc1-120">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-120">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-121">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-121">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-122">La password non soddisfa i criteri di Windows in quanto è troppo breve.</span><span class="sxs-lookup"><span data-stu-id="fddc1-122">The password does not meet policy requirements because it is too short.</span></span>|  
|<span data-ttu-id="fddc1-123">18465</span><span class="sxs-lookup"><span data-stu-id="fddc1-123">18465</span></span>|<span data-ttu-id="fddc1-124">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-124">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-125">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-125">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-126">La password non soddisfa i criteri di Windows in quanto è troppo lunga.</span><span class="sxs-lookup"><span data-stu-id="fddc1-126">The password does not meet policy requirements because it is too long.</span></span>|  
|<span data-ttu-id="fddc1-127">18466</span><span class="sxs-lookup"><span data-stu-id="fddc1-127">18466</span></span>|<span data-ttu-id="fddc1-128">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-128">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-129">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-129">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-130">La password non soddisfa i criteri di Windows in quanto non è sufficientemente complessa.</span><span class="sxs-lookup"><span data-stu-id="fddc1-130">The password does not meet policy requirements because it is not complex enough.</span></span>|  
|<span data-ttu-id="fddc1-131">18467</span><span class="sxs-lookup"><span data-stu-id="fddc1-131">18467</span></span>|<span data-ttu-id="fddc1-132">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-132">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-133">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-133">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-134">La password non soddisfa i requisiti della DLL per il filtro delle password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-134">The password does not meet the requirements of the password filter DLL.</span></span>|  
|<span data-ttu-id="fddc1-135">18468</span><span class="sxs-lookup"><span data-stu-id="fddc1-135">18468</span></span>|<span data-ttu-id="fddc1-136">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-136">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-137">Motivo: impossibile modificare la password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-137">Reason: Password change failed.</span></span> <span data-ttu-id="fddc1-138">Si è verificato un errore imprevisto durante la convalida della password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-138">An unexpected error occurred during password validation.</span></span>|  
|<span data-ttu-id="fddc1-139">18487</span><span class="sxs-lookup"><span data-stu-id="fddc1-139">18487</span></span>|<span data-ttu-id="fddc1-140">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-140">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-141">Motivo: la password dell'account è scaduta.</span><span class="sxs-lookup"><span data-stu-id="fddc1-141">Reason: The password of the account has expired.</span></span>|  
|<span data-ttu-id="fddc1-142">18488</span><span class="sxs-lookup"><span data-stu-id="fddc1-142">18488</span></span>|<span data-ttu-id="fddc1-143">Accesso non riuscito per l'utente '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="fddc1-143">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="fddc1-144">Motivo: è necessario modificare la password dell'account.</span><span class="sxs-lookup"><span data-stu-id="fddc1-144">Reason: The password of the account must be changed.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="fddc1-145">Provider OLE DB di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="fddc1-145">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="fddc1-146">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client supporta la scadenza delle password tramite un'interfaccia utente e a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="fddc1-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="ole-db-user-interface-password-expiration"></a><span data-ttu-id="fddc1-147">Scadenza password dell'interfaccia utente OLE DB</span><span class="sxs-lookup"><span data-stu-id="fddc1-147">OLE DB User Interface Password Expiration</span></span>  
 <span data-ttu-id="fddc1-148">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client supporta la scadenza delle password tramite le modifiche apportate alle finestre di dialogo **SQL Server account di accesso** .</span><span class="sxs-lookup"><span data-stu-id="fddc1-148">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span> <span data-ttu-id="fddc1-149">Se il valore di DBPROP_INIT_PROMPT è impostato su DBPROMPT_NOPROMPT, il tentativo di connessione iniziale non riesce se la password è scaduta.</span><span class="sxs-lookup"><span data-stu-id="fddc1-149">If the value of DBPROP_INIT_PROMPT is set to DBPROMPT_NOPROMPT, the initial connection attempt will fail if the password has expired.</span></span>  
  
 <span data-ttu-id="fddc1-150">Se DBPROP_INIT_PROMPT è stato impostato su qualsiasi altro valore, viene visualizzata la finestra di dialogo **Account di accesso di SQL Server** indipendentemente dalla scadenza della password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-150">If DBPROP_INIT_PROMPT has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="fddc1-151">L'utente può cambiare la password facendo clic sul pulsante **Opzioni** e selezionando **Cambia password**.</span><span class="sxs-lookup"><span data-stu-id="fddc1-151">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="fddc1-152">Se l'utente fa clic su OK e la password è scaduta, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] richiede all'utente di immettere e confermare una nuova password usando la finestra di dialogo **Modifica password SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="fddc1-152">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts the user to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="ole-db-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="fddc1-153">Comportamento del prompt di OLE DB e account bloccati</span><span class="sxs-lookup"><span data-stu-id="fddc1-153">OLE DB Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="fddc1-154">È possibile che non si riesca a stabilire una connessione perché l'account è bloccato.</span><span class="sxs-lookup"><span data-stu-id="fddc1-154">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="fddc1-155">Se questo problema si verifica in seguito alla visualizzazione della finestra di dialogo **Account di accesso di SQL Server**, viene visualizzato il messaggio di errore del server e il tentativo di connessione viene interrotto.</span><span class="sxs-lookup"><span data-stu-id="fddc1-155">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="fddc1-156">Il problema può verificarsi anche se, in seguito alla visualizzazione della finestra di dialogo **Modifica password SQL Server**, l'utente immette un valore non corretto per la vecchia password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-156">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="fddc1-157">In questo caso viene visualizzato lo stesso messaggio di errore e il tentativo di connessione viene interrotto.</span><span class="sxs-lookup"><span data-stu-id="fddc1-157">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="ole-db-connection-pooling-password-expiration-and-locked-accounts"></a><span data-ttu-id="fddc1-158">Pool di connessioni OLE DB, scadenza password e account bloccati</span><span class="sxs-lookup"><span data-stu-id="fddc1-158">OLE DB Connection Pooling, Password Expiration, and Locked Accounts</span></span>  
 <span data-ttu-id="fddc1-159">Un account può essere bloccato o la rispettiva password può scadere mentre la connessione è ancora attiva in un pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="fddc1-159">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="fddc1-160">Il server controlla le password scadute e gli account bloccati in due circostanze.</span><span class="sxs-lookup"><span data-stu-id="fddc1-160">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="fddc1-161">Quando una connessione viene creata per la prima volta</span><span class="sxs-lookup"><span data-stu-id="fddc1-161">The first is when a connection is first created.</span></span> <span data-ttu-id="fddc1-162">e quando la connessione viene reimpostata, ovvero quando viene estratta dal pool.</span><span class="sxs-lookup"><span data-stu-id="fddc1-162">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="fddc1-163">Quando il tentativo di ripristino non riesce, la connessione viene rimossa dal pool e viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="fddc1-163">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="ole-db-programmatic-password-expiration"></a><span data-ttu-id="fddc1-164">Scadenza password OLE DB a livello di programmazione</span><span class="sxs-lookup"><span data-stu-id="fddc1-164">OLE DB Programmatic Password Expiration</span></span>  
 <span data-ttu-id="fddc1-165">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client supporta la scadenza delle password tramite l'aggiunta della proprietà SSPROP_AUTH_OLD_PASSWORD (type VT_BSTR) aggiunta al set di proprietà DBPROPSET_SQLSERVERDBINIT.</span><span class="sxs-lookup"><span data-stu-id="fddc1-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through the addition of the SSPROP_AUTH_OLD_PASSWORD (type VT_BSTR) property that has been added to the DBPROPSET_SQLSERVERDBINIT property set.</span></span>  
  
 <span data-ttu-id="fddc1-166">La proprietà "Password" esistente si riferisce a DBPROP_AUTH_PASSWORD e viene utilizzata per archiviare la nuova password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-166">The existing "Password" property refers to DBPROP_AUTH_PASSWORD and is used to store the new password.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fddc1-167">Nella stringa di connessione la proprietà "Vecchia password" imposta SSPROP_AUTH_OLD_PASSWORD, ovvero la password corrente (probabilmente scaduta) che non è disponibile tramite una proprietà della stringa del provider.</span><span class="sxs-lookup"><span data-stu-id="fddc1-167">In the connection string, the "Old Password" property sets SSPROP_AUTH_OLD_PASSWORD, which is the current (possibly expired) password that is not available via a provider string property.</span></span>  
  
 <span data-ttu-id="fddc1-168">Il provider non rende persistente il valore di questa proprietà.</span><span class="sxs-lookup"><span data-stu-id="fddc1-168">The provider does not persist the value of this property.</span></span> <span data-ttu-id="fddc1-169">Quando questa proprietà è impostata, il provider non utilizza il pool di connessioni per la prima connessione, dal momento che verrà stabilita una nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="fddc1-169">When this property is set, the provider does not use the connection pool for the first connection because a new connection will occur.</span></span> <span data-ttu-id="fddc1-170">Dopo aver cambiato la password, non sarà più possibile utilizzare la connessione corrente in quanto contiene ancora la vecchia password che non è più valida.</span><span class="sxs-lookup"><span data-stu-id="fddc1-170">If the password change is successful, the current connection cannot be reused since it still contains the old password, which will be invalid after the password change.</span></span> <span data-ttu-id="fddc1-171">Se inoltre si riesce ad accedere, il provider cancella questa proprietà.</span><span class="sxs-lookup"><span data-stu-id="fddc1-171">Also, if the login succeeds, the provider clears this property.</span></span> <span data-ttu-id="fddc1-172">I tentativi successivi di recuperare la vecchia password restituiscono VT_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="fddc1-172">Subsequent attempts to retrieve the old password return VT_EMPTY.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fddc1-173">SSPROP_AUTH_OLD_PASSWORD non deve essere resa persistente in quanto viene utilizzata solo quando una password è scaduta.</span><span class="sxs-lookup"><span data-stu-id="fddc1-173">SSPROP_AUTH_OLD_PASSWORD should never be persisted since it is only used when a password has expired.</span></span>  
  
 <span data-ttu-id="fddc1-174">Ogni volta che la proprietà "Vecchia password" viene impostata, il provider presuppone che sia in atto un tentativo di modificare la password, a meno che non venga specificata anche l'autenticazione di Windows. In questo caso, questa avrebbe comunque ha la precedenza.</span><span class="sxs-lookup"><span data-stu-id="fddc1-174">Note that whenever the "Old Password" property is set, the provider assumes that an attempt to change the password is being made, unless Windows Authentication is also specified, in which case it always takes precedence.</span></span>  
  
 <span data-ttu-id="fddc1-175">Se si usa l'autenticazione di Windows, l'immissione della vecchia password restituisce DB_E_ERRORSOCCURRED o DB_S_ERRORSOCCURRED, a seconda se la vecchia password è stata specificata rispettivamente come REQUIRED o OPTIONAL e il valore dello stato di DBPROPSTATUS_CONFLICTINGBADVALUE viene restituito in *dwStatus*.</span><span class="sxs-lookup"><span data-stu-id="fddc1-175">If Windows Authentication is used, specifying the old password results in either DB_E_ERRORSOCCURRED or DB_S_ERRORSOCCURRED depending on whether the old password was specified as REQUIRED or OPTIONAL respectively, and the status value of DBPROPSTATUS_CONFLICTINGBADVALUE is returned in *dwStatus*.</span></span> <span data-ttu-id="fddc1-176">Questo errore viene rilevato quando viene chiamato **IDBInitialize::Initialize**.</span><span class="sxs-lookup"><span data-stu-id="fddc1-176">This is detected when **IDBInitialize::Initialize** is called.</span></span>  
  
 <span data-ttu-id="fddc1-177">Se un tentativo di modificare la password non riesce in modo imprevisto, il server restituisce il codice di errore 18468.</span><span class="sxs-lookup"><span data-stu-id="fddc1-177">If an attempt to change the password fails unexpectedly, the server returns error code 18468.</span></span> <span data-ttu-id="fddc1-178">Dal tentativo di connessione viene restituito un errore OLE DB standard.</span><span class="sxs-lookup"><span data-stu-id="fddc1-178">A standard OLEDB error is returned from the connection attempt.</span></span>  
  
 <span data-ttu-id="fddc1-179">Per altre informazioni sul set di proprietà DBPROPSET_SQLSERVERDBINIT, vedere [Proprietà di inizializzazione e di autorizzazione](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span><span class="sxs-lookup"><span data-stu-id="fddc1-179">For more information about the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="fddc1-180">Driver ODBC di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="fddc1-180">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="fddc1-181">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client supporta la scadenza delle password tramite un'interfaccia utente e a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="fddc1-181">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="odbc-user-interface-password-expiration"></a><span data-ttu-id="fddc1-182">Scadenza password dell'interfaccia utente ODBC</span><span class="sxs-lookup"><span data-stu-id="fddc1-182">ODBC User Interface Password Expiration</span></span>  
 <span data-ttu-id="fddc1-183">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client supporta la scadenza delle password tramite le modifiche apportate alle finestre di dialogo di **accesso SQL Server** .</span><span class="sxs-lookup"><span data-stu-id="fddc1-183">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span>  
  
 <span data-ttu-id="fddc1-184">Se viene chiamato [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) e il valore di **DriverCompletion** è impostato su SQL_DRIVER_NOPROMPT, il tentativo di connessione iniziale non riesce se la password è scaduta.</span><span class="sxs-lookup"><span data-stu-id="fddc1-184">If [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) is called and the value of **DriverCompletion** is set to SQL_DRIVER_NOPROMPT, the initial connection attempt fails if the password has expired.</span></span> <span data-ttu-id="fddc1-185">Il valore SQLSTATE 28000 e il valore del codice di errore nativo 18487 vengono restituiti dalle chiamate successive a **SQLError** o **SQLGetDiagRec**.</span><span class="sxs-lookup"><span data-stu-id="fddc1-185">The SQLSTATE value 28000 and the native error code value 18487 are returned by subsequent calls to **SQLError** or **SQLGetDiagRec**.</span></span>  
  
 <span data-ttu-id="fddc1-186">Se **DriverCompletion** è stato impostato su qualsiasi altro valore, l'utente Visualizza la finestra di dialogo **SQL Server login** , indipendentemente dal fatto che la password sia scaduta o meno.</span><span class="sxs-lookup"><span data-stu-id="fddc1-186">If **DriverCompletion** has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="fddc1-187">L'utente può cambiare la password facendo clic sul pulsante **Opzioni** e selezionando **Cambia password**.</span><span class="sxs-lookup"><span data-stu-id="fddc1-187">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="fddc1-188">Se l'utente fa clic su OK e la password è scaduta, viene [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] richiesto di immettere e confermare una nuova password utilizzando la finestra di dialogo **Cambia SQL Server password** .</span><span class="sxs-lookup"><span data-stu-id="fddc1-188">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="odbc-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="fddc1-189">Comportamento del prompt di ODBC e account bloccati</span><span class="sxs-lookup"><span data-stu-id="fddc1-189">ODBC Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="fddc1-190">È possibile che non si riesca a stabilire una connessione perché l'account è bloccato.</span><span class="sxs-lookup"><span data-stu-id="fddc1-190">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="fddc1-191">Se questo problema si verifica in seguito alla visualizzazione della finestra di dialogo **Account di accesso di SQL Server**, viene visualizzato il messaggio di errore del server e il tentativo di connessione viene interrotto.</span><span class="sxs-lookup"><span data-stu-id="fddc1-191">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="fddc1-192">Il problema può verificarsi anche se, in seguito alla visualizzazione della finestra di dialogo **Modifica password SQL Server**, l'utente immette un valore non corretto per la vecchia password.</span><span class="sxs-lookup"><span data-stu-id="fddc1-192">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="fddc1-193">In questo caso viene visualizzato lo stesso messaggio di errore e il tentativo di connessione viene interrotto.</span><span class="sxs-lookup"><span data-stu-id="fddc1-193">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="odbc-connection-pooling-password-expiry-and-locked-accounts"></a><span data-ttu-id="fddc1-194">Pool di connessioni ODBC, scadenza password e account bloccati</span><span class="sxs-lookup"><span data-stu-id="fddc1-194">ODBC Connection Pooling, Password Expiry, and Locked Accounts</span></span>  
 <span data-ttu-id="fddc1-195">Un account può essere bloccato o la rispettiva password può scadere mentre la connessione è ancora attiva in un pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="fddc1-195">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="fddc1-196">Il server controlla le password scadute e gli account bloccati in due circostanze.</span><span class="sxs-lookup"><span data-stu-id="fddc1-196">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="fddc1-197">Quando una connessione viene creata per la prima volta</span><span class="sxs-lookup"><span data-stu-id="fddc1-197">The first is when a connection is first created.</span></span> <span data-ttu-id="fddc1-198">e quando la connessione viene reimpostata, ovvero quando viene estratta dal pool.</span><span class="sxs-lookup"><span data-stu-id="fddc1-198">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="fddc1-199">Quando il tentativo di ripristino non riesce, la connessione viene rimossa dal pool e viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="fddc1-199">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="odbc-programmatic-password-expiration"></a><span data-ttu-id="fddc1-200">Scadenza password ODBC a livello di programmazione</span><span class="sxs-lookup"><span data-stu-id="fddc1-200">ODBC Programmatic Password Expiration</span></span>  
 <span data-ttu-id="fddc1-201">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client supporta la scadenza delle password mediante l'aggiunta dell'attributo SQL_COPT_SS_OLDPWD impostato prima della connessione al server tramite la funzione [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) .</span><span class="sxs-lookup"><span data-stu-id="fddc1-201">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through the addition of the SQL_COPT_SS_OLDPWD attribute which is set before connecting to the server using the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) function.</span></span>  
  
 <span data-ttu-id="fddc1-202">L'attributo SQL_COPT_SS_OLDPWD dell'handle di connessione si riferisce alla password scaduta.</span><span class="sxs-lookup"><span data-stu-id="fddc1-202">The SQL_COPT_SS_OLDPWD attribute of the connection handle refers to the expired password.</span></span> <span data-ttu-id="fddc1-203">Per questo attributo non è disponibile un attributo di stringa di connessione, in quanto interferirebbe con il pool di connessioni.</span><span class="sxs-lookup"><span data-stu-id="fddc1-203">There is no connection string attribute for this attribute, as this would interfere with connection pooling.</span></span> <span data-ttu-id="fddc1-204">Se si riesce ad accedere, il driver cancella questo attributo.</span><span class="sxs-lookup"><span data-stu-id="fddc1-204">If the login succeeds, the driver clears this attribute.</span></span>  
  
 <span data-ttu-id="fddc1-205">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native Client restituisce SQL_ERROR in quattro casi per questa funzionalità: scadenza password, conflitto tra criteri password, blocco account e quando la proprietà vecchia password viene impostata durante l'utilizzo dell'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="fddc1-205">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver returns SQL_ERROR in four cases for this feature: password expiration, password policy conflict, account lockout, and when the old password property is set while using Windows Authentication.</span></span> <span data-ttu-id="fddc1-206">Il driver restituisce all'utente i messaggi di errore appropriati quando viene richiamato [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) .</span><span class="sxs-lookup"><span data-stu-id="fddc1-206">The driver returns the appropriate error messages to the user when [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) is invoked.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fddc1-207">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="fddc1-207">See Also</span></span>  
 [<span data-ttu-id="fddc1-208">Funzionalità di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="fddc1-208">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
