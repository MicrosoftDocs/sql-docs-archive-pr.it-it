---
title: Supporto SQL Server Native Client per la disponibilità elevata, ripristino di emergenza | Microsoft Docs
ms.custom: ''
ms.date: 08/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 2b06186b-4090-4728-b96b-90d6ebd9f66f
author: rothja
ms.author: jroth
ms.openlocfilehash: 43c835d5c0e1c064387aee7fb0db65f577c3aa26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87636690"
---
# <a name="sql-server-native-client-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="8978c-102">Supporto di SQL Server Native Client per il ripristino di emergenza a disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="8978c-102">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>
  <span data-ttu-id="8978c-103">In questo argomento viene illustrato il supporto in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (aggiunto in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8978c-103">This topic discusses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support (added in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="8978c-104">Per altre informazioni su [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], vedere [Listener del gruppo di disponibilità, connettività client e failover dell’applicazione &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creazione e configurazione di gruppi di disponibilità &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Clustering di failover e gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md) e [Repliche secondarie attive: Repliche secondarie leggibili (Gruppi di disponibilità AlwaysOn)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="8978c-104">For more information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), and [Active Secondaries: Readable Secondary Replicas (AlwaysOn Availability Groups)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>  
  
 <span data-ttu-id="8978c-105">È possibile specificare il listener di un determinato gruppo di disponibilità nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="8978c-105">You can specify the availability group listener of a given availability group in the connection string.</span></span> <span data-ttu-id="8978c-106">Se un'applicazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client è connessa a un database in un gruppo di disponibilità, la connessione originale viene interrotta e deve esserne aperta una nuova per l'applicazione affinché quest'ultima possa continuare a funzionare dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="8978c-106">If a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application is connected to a database in an availability group that fails over, the original connection is broken, and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="8978c-107">Se non si sta eseguendo la connessione a un listener del gruppo di disponibilità e se più indirizzi IP sono associati a un nome host, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client verranno scorsi in sequenza tutti gli indirizzi IP associati alla voce DNS.</span><span class="sxs-lookup"><span data-stu-id="8978c-107">If you are not connecting to an availability group listener, and if multiple IP addresses are associated with a hostname, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="8978c-108">Questa operazione può richiedere tempi lunghi se il primo indirizzo IP restituito dal server DNS non è associato ad alcuna scheda di interfaccia di rete.</span><span class="sxs-lookup"><span data-stu-id="8978c-108">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="8978c-109">In caso di connessione a un listener del gruppo di disponibilità, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client viene effettuato un tentativo di connessione a tutti gli indirizzi IP in parallelo e in caso di riuscita, tramite il driver verrà rimosso qualsiasi tentativo di connessione in sospeso.</span><span class="sxs-lookup"><span data-stu-id="8978c-109">When connecting to an availability group listener, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8978c-110">L'aumento del timeout di connessione e l'implementazione della logica di riesecuzione per le connessioni aumentano le probabilità che un'applicazione si connetta a un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="8978c-110">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="8978c-111">Inoltre, poiché potrebbe non essere possibile stabilire una connessione a causa del failover di un gruppo di disponibilità, è opportuno implementare la logica di riesecuzione delle connessioni, finché non si ottiene la riconnessione.</span><span class="sxs-lookup"><span data-stu-id="8978c-111">Also, because a connection can fail because of an availability group failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="8978c-112">Connessione con MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="8978c-112">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="8978c-113">Specificare sempre `MultiSubnetFailover=Yes` in caso di connessione a un listener del gruppo di disponibilità di SQL Server 2012 o a un'istanza del cluster di failover di SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="8978c-113">Always specify `MultiSubnetFailover=Yes` when connecting to a SQL Server 2012 availability group listener or SQL Server 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="8978c-114">`MultiSubnetFailover` consente un failover più veloce per tutti i gruppi di disponibilità, permette di abilitare l'istanza del cluster di failover in SQL Server 2012, nonché di ridurre in modo significativo la durata del failover per le topologie AlwaysOn singole e su più subnet.</span><span class="sxs-lookup"><span data-stu-id="8978c-114">`MultiSubnetFailover` enables faster failover for all Availability Groups and failover cluster instance in SQL Server 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="8978c-115">Durante un failover su più subnet, verranno tentate connessioni in parallelo da parte del client.</span><span class="sxs-lookup"><span data-stu-id="8978c-115">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="8978c-116">Durante un failover della subnet, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client verrà ritentata in modo insistente la connessione TCP.</span><span class="sxs-lookup"><span data-stu-id="8978c-116">During a subnet failover, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="8978c-117">La proprietà di connessione `MultiSubnetFailover` indica che l'applicazione viene distribuita in un gruppo di disponibilità o nell'istanza del cluster di failover e che in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client verrà effettuato un tentativo di connessione al database nell'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] primaria tentando di connettersi a tutti gli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="8978c-117">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or Failover Cluster Instance, and that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="8978c-118">Quando `MultiSubnetFailover=Yes` si specifica per una connessione, il client riesegue i tentativi di connessione TCP più velocemente rispetto agli intervalli di ritrasmissione TCP predefiniti del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="8978c-118">When `MultiSubnetFailover=Yes` is specified for a connection, the client retries TCP connection attempts faster than the operating system's default TCP retransmit intervals.</span></span> <span data-ttu-id="8978c-119">In tal modo si abilita la riconnessione a seguito di failover di un gruppo di disponibilità AlwaysOn o un'istanza del cluster di failover AlwaysOn ed è applicabile a istanze del cluster di failover o a gruppi di disponibilità su una singola subnet o su più subnet.</span><span class="sxs-lookup"><span data-stu-id="8978c-119">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="8978c-120">Per altre informazioni sulle parole chiave della stringa di connessione, vedere [Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="8978c-120">For more information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="8978c-121">La specificazione di `MultiSubnetFailover=Yes` durante la connessione a un oggetto diverso da un listener del gruppo di disponibilità o dell'istanza del cluster di failover non è supportata poiché potrebbe determinare un impatto negativo sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8978c-121">Specifying `MultiSubnetFailover=Yes` when connecting to something other than an availability group listener or Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="8978c-122">Utilizzare le linee guida seguenti per connettersi a un server in un gruppo di disponibilità o nell'istanza del cluster di failover:</span><span class="sxs-lookup"><span data-stu-id="8978c-122">Use the following guidelines to connect to a server in an availability group or Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="8978c-123">Utilizzare la proprietà di connessione `MultiSubnetFailover` in caso di connessione a una subnet singola o a più subnet, in modo da migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8978c-123">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="8978c-124">Per eseguire la connessione a un gruppo di disponibilità, specificare il listener del gruppo di disponibilità come server nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="8978c-124">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="8978c-125">La connessione a un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] configurata con più di 64 indirizzi IP determinerà un errore di connessione.</span><span class="sxs-lookup"><span data-stu-id="8978c-125">Connecting to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="8978c-126">Il comportamento di un'applicazione in cui viene utilizzata la proprietà di connessione `MultiSubnetFailover` non è influenzato dal tipo di autenticazione, cioè Autenticazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], Autenticazione Kerberos o Autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="8978c-126">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="8978c-127">È possibile aumentare il valore di `loginTimeout` per adattarlo alla durata del failover e ridurre il numero di nuovi tentativi di connessione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8978c-127">You can increase the value of `loginTimeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="8978c-128">Le transazioni distribuite non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="8978c-128">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="8978c-129">Se il routing di sola lettura non è attivo, non è possibile stabilire una connessione a un percorso di replica secondaria in un gruppo di disponibilità nelle situazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8978c-129">If read-only routing is not in effect, connecting to a secondary replica location in an availability group will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="8978c-130">Se il percorso di replica secondaria non è configurato per accettare le connessioni.</span><span class="sxs-lookup"><span data-stu-id="8978c-130">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="8978c-131">Se in un'applicazione viene utilizzato `ApplicationIntent=ReadWrite` (già illustrato in precedenza) e il percorso di replica secondaria è configurato per l'accesso in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-131">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="8978c-132">Una connessione non verrà eseguita correttamente se una replica primaria è configurata per rifiutare i carichi di lavoro in sola lettura e nella stringa di connessione è contenuto `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="8978c-132">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="8978c-133">Aggiornamento per l'utilizzo di cluster su più subnet dal mirroring del database</span><span class="sxs-lookup"><span data-stu-id="8978c-133">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="8978c-134">Si verificherà un errore di connessione se nella stringa di connessione sono presenti le parole chiave di connessione `MultiSubnetFailover` e `Failover_Partner`.</span><span class="sxs-lookup"><span data-stu-id="8978c-134">A connection error will occur if the `MultiSubnetFailover` and `Failover_Partner` connection keywords are present in the connection string.</span></span> <span data-ttu-id="8978c-135">Si verificherà un errore anche se viene utilizzato `MultiSubnetFailover` e se tramite [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] viene restituita una risposta del partner di failover in cui viene indicato che fa parte di una coppia del mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="8978c-135">An error will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="8978c-136">Se si aggiorna un'applicazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in cui al momento è utilizzato il mirroring del database in uno scenario su più subnet, è necessario rimuovere la proprietà di connessione `Failover_Partner` e sostituirla con `MultiSubnetFailover` impostata su `Yes`, nonché sostituire il nome del server nella stringa di connessione con un listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="8978c-136">If you upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover_Partner` connection property and replace it with `MultiSubnetFailover` set to `Yes` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="8978c-137">Se in una stringa di connessione vengono utilizzati `Failover_Partner` e `MultiSubnetFailover=Yes`, verrà generato un errore dal driver.</span><span class="sxs-lookup"><span data-stu-id="8978c-137">If a connection string uses `Failover_Partner` and `MultiSubnetFailover=Yes`, the driver will generate an error.</span></span> <span data-ttu-id="8978c-138">Se, tuttavia, in una stringa di connessione vengono utilizzati `Failover_Partner` e `MultiSubnetFailover=No` (o `ApplicationIntent=ReadWrite`), nell'applicazione verrà utilizzato il mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="8978c-138">However, if a connection string uses `Failover_Partner` and `MultiSubnetFailover=No` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="8978c-139">Tramite il driver verrà restituito un errore se il mirroring del database viene utilizzato nel database primario nel gruppo di disponibilità e se `MultiSubnetFailover=Yes` viene utilizzato nella stringa di connessione a un database primario anziché a un listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="8978c-139">The driver will return an error if database mirroring is used on the primary database in the availability group, and if `MultiSubnetFailover=Yes` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="8978c-140">Specificazione della finalità dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="8978c-140">Specifying Application Intent</span></span>  
 <span data-ttu-id="8978c-141">Se `ApplicationIntent=ReadOnly`, nel client viene richiesto un carico di lavoro di lettura quando si esegue la connessione a un database abilitato per AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="8978c-141">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="8978c-142">Tramite il server, la finalità verrà applicata al momento della connessione e durante un'istruzione di database USE, ma solo a un database abilitato per Always On.</span><span class="sxs-lookup"><span data-stu-id="8978c-142">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="8978c-143">La parola chiave `ApplicationIntent` non funziona con i database legacy di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-143">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="8978c-144">Un database può consentire o impedire carichi di lavoro di lettura nel database AlwaysOn di destinazione.</span><span class="sxs-lookup"><span data-stu-id="8978c-144">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="8978c-145">Questa operazione viene eseguita con la clausola `ALLOW_CONNECTIONS` delle istruzioni `PRIMARY_ROLE` e `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8978c-145">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="8978c-146">La parola chiave `ApplicationIntent` è utilizzata per abilitare il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-146">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="8978c-147">Routing di sola lettura</span><span class="sxs-lookup"><span data-stu-id="8978c-147">Read-Only Routing</span></span>  
 <span data-ttu-id="8978c-148">Il routing di sola lettura è una funzionalità che può garantire la disponibilità di una replica di sola lettura di un database.</span><span class="sxs-lookup"><span data-stu-id="8978c-148">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="8978c-149">Per abilitare il routing di sola lettura:</span><span class="sxs-lookup"><span data-stu-id="8978c-149">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="8978c-150">È necessario connettersi a un listener del gruppo di disponibilità Always On.</span><span class="sxs-lookup"><span data-stu-id="8978c-150">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="8978c-151">La parola chiave della stringa di connessione `ApplicationIntent` deve essere impostata su `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="8978c-151">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="8978c-152">Il gruppo di disponibilità deve essere configurato dall'amministratore del database per abilitare il routing di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-152">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="8978c-153">È possibile che non tutte le connessioni in cui viene utilizzato il routing di sola lettura vengano stabilite alla stessa replica di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-153">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="8978c-154">Le modifiche nella sincronizzazione del database o nella configurazione di routing del server possono comportare connessioni client a repliche di sola lettura diverse.</span><span class="sxs-lookup"><span data-stu-id="8978c-154">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="8978c-155">Per assicurare la connessione di tutte le richieste di sola lettura alla stessa replica di sola lettura, non fornire un listener del gruppo di disponibilità alla parola chiave della stringa di connessione `Server`.</span><span class="sxs-lookup"><span data-stu-id="8978c-155">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Server` connection string keyword.</span></span> <span data-ttu-id="8978c-156">Specificare invece il nome dell'istanza di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-156">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="8978c-157">Il routing di sola lettura potrebbe impiegare più tempo a connettersi rispetto alla replica primaria poiché innanzitutto viene eseguita la connessione del routing di sola lettura alla replica primaria e, successivamente, viene cercata la replica secondaria migliore dal punto di vista della lettura.</span><span class="sxs-lookup"><span data-stu-id="8978c-157">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="8978c-158">Per questo motivo è necessario aumentare il timeout di accesso.</span><span class="sxs-lookup"><span data-stu-id="8978c-158">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="odbc"></a><span data-ttu-id="8978c-159">ODBC</span><span class="sxs-lookup"><span data-stu-id="8978c-159">ODBC</span></span>  
 <span data-ttu-id="8978c-160">Sono state aggiunte due parole chiave per le stringhe di connessione ODBC per supportare [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span><span class="sxs-lookup"><span data-stu-id="8978c-160">Two ODBC connection string keywords were added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="8978c-161">Per altre informazioni sulle parole chiave della stringa di connessione ODBC in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vedere [Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="8978c-161">For more information about ODBC connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="8978c-162">Le proprietà di connessione equivalenti sono:</span><span class="sxs-lookup"><span data-stu-id="8978c-162">The equivalent connection properties are:</span></span>  
  
-   `SQL_COPT_SS_APPLICATION_INTENT`  
  
-   `SQL_COPT_SS_MULTISUBNET_FAILOVER`  
  
 <span data-ttu-id="8978c-163">Per altre informazioni sulle proprietà di connessione ODBC in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vedere [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="8978c-163">For more information about ODBC connection properties in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span></span>  
  
 <span data-ttu-id="8978c-164">La funzionalità delle parole chiave `ApplicationIntent` e `MultiSubnetFailover` verrà esposta in Amministratore origine dati ODBC per i DSN in cui viene utilizzato il driver di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, a partire da [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8978c-164">The functionality of the `ApplicationIntent` and `MultiSubnetFailover` keywords will be exposed in the ODBC Data Source Administrator for DSNs that use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver, beginning in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
 <span data-ttu-id="8978c-165">Un'applicazione ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client può utilizzare, per la connessione, una delle tre funzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8978c-165">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC application can use one of three functions to make the connection:</span></span>  
  
|<span data-ttu-id="8978c-166">Funzione</span><span class="sxs-lookup"><span data-stu-id="8978c-166">Function</span></span>|<span data-ttu-id="8978c-167">Descrizione</span><span class="sxs-lookup"><span data-stu-id="8978c-167">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="8978c-168">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="8978c-168">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)|<span data-ttu-id="8978c-169">L'elenco di server restituiti da `SQLBrowseConnect` non includerà i nomi di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8978c-169">The list of servers returned by `SQLBrowseConnect` will not include VNNs.</span></span> <span data-ttu-id="8978c-170">Verrà visualizzato solo un elenco di server senza indicazione del fatto che il server sia un server autonomo oppure un server primario o secondario in un cluster WSFC (Windows Server Failover Clustering) che contiene due o più istanze di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] abilitate per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8978c-170">You will only see a list of servers without any indication if the server is a standalone server, or a primary or secondary server in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="8978c-171">Se si esegue la connessione a un server e viene restituito un errore, è possibile che sia stata stabilita la connessione a un server e l'impostazione `ApplicationIntent` non sia compatibile con la configurazione del server.</span><span class="sxs-lookup"><span data-stu-id="8978c-171">If you connect to a server and get a failure, it may be because you have connected to a server, and the `ApplicationIntent` setting is not compatible with the server configuration.</span></span><br /><br /> <span data-ttu-id="8978c-172">Poiché `SQLBrowseConnect` non riconosce i server in un cluster WSFC (Windows Server Failover Clustering) che contiene due o più istanze di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] abilitate per [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], la parola chiave della stringa di connessione `SQLBrowseConnect` viene ignorata da `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="8978c-172">Because `SQLBrowseConnect` does not recognize servers in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignores the `MultiSubnetFailover` connection string keyword.</span></span>|  
|[<span data-ttu-id="8978c-173">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="8978c-173">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)|<span data-ttu-id="8978c-174">`SQLConnect` supporta sia `ApplicationIntent` sia `MultiSubnetFailover` tramite un nome di origine dati (DSN) o proprietà di connessione.</span><span class="sxs-lookup"><span data-stu-id="8978c-174">`SQLConnect` supports both `ApplicationIntent` and `MultiSubnetFailover` via a data source name (DSN) or connection properties.</span></span>|  
|[<span data-ttu-id="8978c-175">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="8978c-175">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)|<span data-ttu-id="8978c-176">`SQLDriverConnect` supporta `ApplicationIntent` e `MultiSubnetFailover` tramite parole chiave della stringa di connessione, proprietà di connessione o DSN.</span><span class="sxs-lookup"><span data-stu-id="8978c-176">`SQLDriverConnect` supports `ApplicationIntent` and `MultiSubnetFailover` via connection string keywords, connection properties, or DSN.</span></span>|  
  
## <a name="ole-db"></a><span data-ttu-id="8978c-177">OLE DB</span><span class="sxs-lookup"><span data-stu-id="8978c-177">OLE DB</span></span>  
 <span data-ttu-id="8978c-178">OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client non supporta la parola chiave `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="8978c-178">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not support the `MultiSubnetFailover` keyword.</span></span>  
  
 <span data-ttu-id="8978c-179">OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supporta la finalità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8978c-179">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will support application intent.</span></span> <span data-ttu-id="8978c-180">La finalità dell'applicazione è la stessa per le applicazioni OLE DB e per quelle ODBC (vedere sopra).</span><span class="sxs-lookup"><span data-stu-id="8978c-180">Application intent will behave the same for OLE DB applications as ODBC applications (see above).</span></span>  
  
 <span data-ttu-id="8978c-181">Per supportare [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client è stata aggiunta una parole chiave per la stringa di connessione OLE DB:</span><span class="sxs-lookup"><span data-stu-id="8978c-181">One OLE DB connection string keyword added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `Application Intent`  
  
 <span data-ttu-id="8978c-182">Per altre informazioni sulle parole chiave della stringa di connessione in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, vedere [Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="8978c-182">For more information about connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="8978c-183">Le proprietà di connessione equivalenti sono:</span><span class="sxs-lookup"><span data-stu-id="8978c-183">The equivalent connection properties are:</span></span>  
  
-   `SSPROP_INIT_APPLICATIONINTENT`  
  
-   `DBPROP_INIT_PROVIDERSTRING`  
  
 <span data-ttu-id="8978c-184">Un'applicazione OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client può utilizzare, per specificare la finalità dell'applicazione, uno dei metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="8978c-184">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB application can use one of the methods to specify application intent:</span></span>  
  
 `IDBInitialize::Initialize`  
 <span data-ttu-id="8978c-185">`IDBInitialize::Initialize` prevede l'utilizzo del set di proprietà precedentemente configurato per inizializzare l'origine dati e creare l'oggetto origine dati.</span><span class="sxs-lookup"><span data-stu-id="8978c-185">`IDBInitialize::Initialize` uses the previously configured set of properties to initialize the data source and create the data source object.</span></span> <span data-ttu-id="8978c-186">La finalità dell'applicazione viene specificata come proprietà del provider o come parte della stringa di proprietà estesa.</span><span class="sxs-lookup"><span data-stu-id="8978c-186">Specify application intent as a provider property or as part of the extended properties string.</span></span>  
  
 `IDataInitialize::GetDataSource`  
 <span data-ttu-id="8978c-187">`IDataInitialize::GetDataSource` accetta una stringa di connessione di input che può contenere la parola chiave `Application Intent`.</span><span class="sxs-lookup"><span data-stu-id="8978c-187">`IDataInitialize::GetDataSource` takes an input connection string that can contain the `Application Intent` keyword.</span></span>  
  
 `IDBProperties::GetProperties`  
 <span data-ttu-id="8978c-188">`IDBProperties::GetProperties` consente di recuperare il valore della proprietà attualmente impostata sull'origine dati.</span><span class="sxs-lookup"><span data-stu-id="8978c-188">`IDBProperties::GetProperties` retrieves the value of the property that is currently set on the data source.</span></span>  <span data-ttu-id="8978c-189">È possibile recuperare il valore di `Application Intent` tramite la proprietà DBPROP_INIT_PROVIDERSTRING e la proprietà SSPROP_INIT_APPLICATIONINTENT.</span><span class="sxs-lookup"><span data-stu-id="8978c-189">You can retrieve the `Application Intent` value through the DBPROP_INIT_PROVIDERSTRING property and SSPROP_INIT_APPLICATIONINTENT property.</span></span>  
  
 `IDBProperties::SetProperties`  
 <span data-ttu-id="8978c-190">Per impostare il valore della proprietà `ApplicationIntent`, chiamare `IDBProperties::SetProperties` passando la proprietà `SSPROP_INIT_APPLICATIONINTENT` con un valore "`ReadWrite`" o "`ReadOnly`" oppure la proprietà `DBPROP_INIT_PROVIDERSTRING` con un valore contenente "`ApplicationIntent=ReadOnly`" o "`ApplicationIntent=ReadWrite`".</span><span class="sxs-lookup"><span data-stu-id="8978c-190">To set the `ApplicationIntent` property value, call `IDBProperties::SetProperties` passing in the `SSPROP_INIT_APPLICATIONINTENT` property with value "`ReadWrite`" or "`ReadOnly`" or `DBPROP_INIT_PROVIDERSTRING` property with value containing "`ApplicationIntent=ReadOnly`" or "`ApplicationIntent=ReadWrite`".</span></span>  
  
 <span data-ttu-id="8978c-191">È possibile specificare la finalità dell'applicazione nel campo delle proprietà della finalità dell’applicazione della scheda Tutte nella finestra di dialogo **Proprietà di Data Link**.</span><span class="sxs-lookup"><span data-stu-id="8978c-191">You can specify application intent in the Application Intent Properties field of the All tab in the **Data Link Properties** dialog box.</span></span>  
  
 <span data-ttu-id="8978c-192">Quando vengono stabilite connessioni implicite, per la connessione viene utilizzata l'impostazione relativa alla finalità dell'applicazione definita per la connessione padre.</span><span class="sxs-lookup"><span data-stu-id="8978c-192">When implicit connections are established, the implicit connection will use the application intent setting of the parent connection.</span></span> <span data-ttu-id="8978c-193">Analogamente, più sessioni create dalla stessa origine dati ereditano l'impostazione relativa alla finalità dell'applicazione definita per l'origine dati.</span><span class="sxs-lookup"><span data-stu-id="8978c-193">Similarly, multiple sessions created from the same data source will inherit the data source's application intent setting.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8978c-194">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="8978c-194">See Also</span></span>  
 <span data-ttu-id="8978c-195">[Funzionalità di SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="8978c-195">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="8978c-196">Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="8978c-196">Using Connection String Keywords with SQL Server Native Client</span></span>](../applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
  
