---
title: Operazioni di copia bulk | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625374"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="68333-102">Esecuzione di operazioni di copia bulk</span><span class="sxs-lookup"><span data-stu-id="68333-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="68333-103">La funzionalità di copia bulk di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supporta il trasferimento di grandi quantità di dati in o da una tabella o una vista di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="68333-104">Il trasferimento dei dati può essere eseguito anche specificando un'istruzione SELECT.</span><span class="sxs-lookup"><span data-stu-id="68333-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="68333-105">È possibile spostare i dati tra [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e un file di dati del sistema operativo, ad esempio un file ASCII.</span><span class="sxs-lookup"><span data-stu-id="68333-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="68333-106">Il file di dati può avere formati diversi. Per eseguire una copia bulk in un file di formato, è necessario definire il formato.</span><span class="sxs-lookup"><span data-stu-id="68333-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="68333-107">I dati possono essere caricati in variabili di programma e trasferiti a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] mediante metodi e funzioni di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="68333-108">Per un'applicazione di esempio che dimostra questa funzionalità, vedere [Eseguire una copia bulk dei dati usando IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="68333-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="68333-109">In un'applicazione la copia bulk viene generalmente utilizzata in una delle modalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="68333-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="68333-110">Copia bulk da una tabella, da una vista o dal set di risultati di un'istruzione Transact-SQL in un file di dati in cui i dati vengono archiviati nello stesso formato della tabella o della vista.</span><span class="sxs-lookup"><span data-stu-id="68333-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="68333-111">Tale file viene definito file di dati in modalità nativa.</span><span class="sxs-lookup"><span data-stu-id="68333-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="68333-112">Copia bulk da una tabella, da una vista o dal set di risultati di un'istruzione Transact-SQL in un file di dati in cui i dati vengono archiviati in un formato diverso da quello della tabella o della vista.</span><span class="sxs-lookup"><span data-stu-id="68333-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="68333-113">In questo caso viene creato un file di formato separato che definisce le caratteristiche (tipo di dati, posizione, lunghezza, carattere di terminazione e così via) di ogni colonna che viene archiviata nel file di dati.</span><span class="sxs-lookup"><span data-stu-id="68333-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="68333-114">Se tutte le colonne vengono convertite in formato carattere, il file risultante viene definito file di dati in modalità carattere.</span><span class="sxs-lookup"><span data-stu-id="68333-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="68333-115">Copia bulk da un file di dati in una tabella o una vista.</span><span class="sxs-lookup"><span data-stu-id="68333-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="68333-116">Se necessario, viene utilizzato un file di formato per determinare il layout del file di dati.</span><span class="sxs-lookup"><span data-stu-id="68333-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="68333-117">Caricare i dati in variabili di programma, quindi importarli in una tabella o in una vista utilizzando le funzioni di copia bulk per eseguire una copia bulk in una riga per volta.</span><span class="sxs-lookup"><span data-stu-id="68333-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="68333-118">Non è necessario che i file di dati utilizzati dalle funzioni di copia bulk vengano creati da un altro programma per la copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="68333-119">È possibile generare un file di dati e il file di formato in base alle definizioni della copia bulk in qualsiasi altro modo. Tali file possono essere quindi utilizzati con un programma per la copia bulk di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per importare i dati in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="68333-120">È ad esempio possibile esportare dati da un foglio di calcolo in un file delimitato da tabulazione, compilare un file di formato che descrive il file delimitato da tabulazione, quindi utilizzare un programma per la copia bulk per importare rapidamente i dati in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="68333-121">I file di dati generati dalla copia bulk possono essere importati anche in altre applicazioni.</span><span class="sxs-lookup"><span data-stu-id="68333-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="68333-122">È ad esempio possibile utilizzare le funzioni di copia bulk per esportare i dati da una tabella o da una vista in un file con valori delimitati da tabulazioni, che è quindi possibile caricare in un foglio di calcolo.</span><span class="sxs-lookup"><span data-stu-id="68333-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="68333-123">I programmatori che eseguono la codifica di applicazioni per l'utilizzo delle funzioni di copia bulk devono seguire le regole generali per garantire un buon livello di prestazioni per la copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="68333-124">Per altre informazioni sul supporto delle operazioni di copia bulk in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], vedere [Importazione ed esportazione bulk di dati &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="68333-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="68333-125">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="68333-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="68333-126">Un tipo CLR definito dall'utente deve essere associato come dati binari.</span><span class="sxs-lookup"><span data-stu-id="68333-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="68333-127">Anche se un file di formato specifica SQLCHAR come tipo di dati per una colonna con tipo definito dall'utente (UDT) di destinazione, l'utilità BCP tratterà i dati come binari.</span><span class="sxs-lookup"><span data-stu-id="68333-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="68333-128">Non utilizzare SET FMTONLY OFF con le operazioni di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="68333-129">SET FMTONLY OFF può compromettere la riuscita dell'operazione di copia bulk o determinare risultati imprevisti.</span><span class="sxs-lookup"><span data-stu-id="68333-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="68333-130">Provider OLE DB di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="68333-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="68333-131">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client implementa due metodi per l'esecuzione di operazioni di copia bulk con un [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database di.</span><span class="sxs-lookup"><span data-stu-id="68333-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="68333-132">Il primo metodo prevede l'uso dell'interfaccia [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) per le operazioni di copia bulk basate sulla memoria, mentre il secondo prevede l'uso dell'interfaccia [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) per le operazioni di copia bulk basate su file.</span><span class="sxs-lookup"><span data-stu-id="68333-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="68333-133">Utilizzo di operazioni di copia bulk basate sulla memoria</span><span class="sxs-lookup"><span data-stu-id="68333-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="68333-134">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client implementa l'interfaccia **IRowsetFastLoad** per esporre il supporto per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] le operazioni di copia bulk basate sulla memoria.</span><span class="sxs-lookup"><span data-stu-id="68333-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="68333-135">L'interfaccia **IRowsetFastLoad** implementa i metodi [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) e [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="68333-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="68333-136">Abilitazione di una sessione per IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="68333-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="68333-137">Il consumer notifica al provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client la necessità di eseguire la copia bulk impostando su VARIANT_TRUE la proprietà dell'origine dati SSPROP_ENABLEFASTLOAD specifica del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="68333-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="68333-138">Con la proprietà impostata sull'origine dati, il consumer crea una sessione del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="68333-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="68333-139">La nuova sessione consente al consumer di accedere all'interfaccia **IRowsetFastLoad**.</span><span class="sxs-lookup"><span data-stu-id="68333-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="68333-140">Se l'interfaccia **IDataInitialize** viene usata per l'inizializzazione dell'origine dati, è necessario impostare la proprietà SSPROP_IRowsetFastLoad nel parametro *rgPropertySets* del metodo **IOpenRowset::OpenRowset**. In caso contrario, la chiamata al metodo **OpenRowset** restituirà E_NOINTERFACE.</span><span class="sxs-lookup"><span data-stu-id="68333-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="68333-141">L'abilitazione di una sessione per la copia bulk vincola il supporto del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client per le interfacce nella sessione.</span><span class="sxs-lookup"><span data-stu-id="68333-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="68333-142">Una sessione abilitata per la copia bulk espone solo le interfacce seguenti:</span><span class="sxs-lookup"><span data-stu-id="68333-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="68333-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="68333-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="68333-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="68333-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="68333-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="68333-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="68333-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="68333-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="68333-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="68333-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="68333-148">Per disabilitare la creazione di set di righe abilitati per la copia bulk e fare in modo che la sessione del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ripristini l'elaborazione standard, reimpostare SSPROP_ENABLEFASTLOAD su VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="68333-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="68333-149">Set di righe IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="68333-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="68333-150">I set di righe della copia bulk del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client sono di sola scrittura ma espongono interfacce che consentono al consumer di determinare la struttura di una tabella [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="68333-151">Le interfacce seguenti sono esposte su un set di righe del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client abilitato per la copia bulk:</span><span class="sxs-lookup"><span data-stu-id="68333-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="68333-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="68333-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="68333-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="68333-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="68333-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="68333-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="68333-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="68333-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="68333-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="68333-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="68333-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="68333-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="68333-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="68333-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="68333-159">Le proprietà SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS e SSPROP_FASTLOADKEEPIDENTITY specifiche del provider controllano i comportamenti di un set di righe della copia bulk del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="68333-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="68333-160">Le proprietà vengono specificate nel membro *rgProperties* di un membro del parametro _rgPropertySets_**IOpenRowset**.</span><span class="sxs-lookup"><span data-stu-id="68333-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="68333-161">ID proprietà</span><span class="sxs-lookup"><span data-stu-id="68333-161">Property ID</span></span>|<span data-ttu-id="68333-162">Descrizione</span><span class="sxs-lookup"><span data-stu-id="68333-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="68333-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="68333-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="68333-164">Colonna: No</span><span class="sxs-lookup"><span data-stu-id="68333-164">Column: No</span></span><br /><br /> <span data-ttu-id="68333-165">R/W (L/S): Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="68333-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="68333-166">Digitare: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="68333-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="68333-167">Predefinito: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="68333-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="68333-168">Descrizione: gestisce i valori Identity specificati dal consumer.</span><span class="sxs-lookup"><span data-stu-id="68333-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="68333-169">VARIANT_FALSE: i valori per una colonna Identity nella tabella [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] vengono generati da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="68333-170">Qualsiasi valore associato per la colonna viene ignorato dal [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client.</span><span class="sxs-lookup"><span data-stu-id="68333-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="68333-171">VARIANT_TRUE: il consumer associa una funzione di accesso che specifica un valore per una colonna Identity di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="68333-172">La proprietà Identity non è disponibile in colonne che supportano valori NULL, pertanto il consumer specifica un valore univoco per ogni chiamata a **IRowsetFastLoad::Insert**.</span><span class="sxs-lookup"><span data-stu-id="68333-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="68333-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="68333-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="68333-174">Colonna: No</span><span class="sxs-lookup"><span data-stu-id="68333-174">Column: No</span></span><br /><br /> <span data-ttu-id="68333-175">R/W (L/S): Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="68333-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="68333-176">Digitare: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="68333-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="68333-177">Predefinito: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="68333-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="68333-178">Descrizione: gestisce i valori NULL per le colonne con un vincolo DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="68333-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="68333-179">Ha effetto solo su colonne di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] che supportano valori NULL e alle quali è applicato un vincolo DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="68333-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="68333-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserisce il valore predefinito per la colonna quando il consumer del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client inserisce una riga che contiene NULL per la colonna.</span><span class="sxs-lookup"><span data-stu-id="68333-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="68333-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserisce NULL per il valore di colonna quando il consumer del provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client inserisce una riga contenente NULL per la colonna.</span><span class="sxs-lookup"><span data-stu-id="68333-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="68333-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="68333-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="68333-183">Colonna: No</span><span class="sxs-lookup"><span data-stu-id="68333-183">Column: No</span></span><br /><br /> <span data-ttu-id="68333-184">R/W (L/S): Lettura/Scrittura</span><span class="sxs-lookup"><span data-stu-id="68333-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="68333-185">Digitare: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="68333-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="68333-186">Impostazione predefinita: nessuna</span><span class="sxs-lookup"><span data-stu-id="68333-186">Default: none</span></span><br /><br /> <span data-ttu-id="68333-187">Descrizione: questa proprietà corrisponde all'opzione **-h** "*hint*[,...*n*]" dell'utilità **bcp**.</span><span class="sxs-lookup"><span data-stu-id="68333-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="68333-188">Di seguito sono indicate le stringhe che è possibile utilizzare come opzioni per l'esecuzione della copia bulk di dati in una tabella.</span><span class="sxs-lookup"><span data-stu-id="68333-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="68333-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): ordinamento dei dati nel file di dati.</span><span class="sxs-lookup"><span data-stu-id="68333-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="68333-190">Le prestazioni della copia bulk vengono migliorate se il file di dati da caricare viene ordinato in base all'indice cluster della tabella.</span><span class="sxs-lookup"><span data-stu-id="68333-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="68333-191">**ROWS_PER_BATCH** = *bb*: Numero di righe di dati per batch (come *bb*).</span><span class="sxs-lookup"><span data-stu-id="68333-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="68333-192">Il server ottimizza il caricamento bulk in base al valore *bb*.</span><span class="sxs-lookup"><span data-stu-id="68333-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="68333-193">Per impostazione predefinita, il valore **ROWS_PER_BATCH** è sconosciuto.</span><span class="sxs-lookup"><span data-stu-id="68333-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="68333-194">**KILOBYTES_PER_BATCH** = *cc*: numero di kilobyte (KB) di dati per batch (come cc).</span><span class="sxs-lookup"><span data-stu-id="68333-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="68333-195">Per impostazione predefinita, il valore **KILOBYTES_PER_BATCH** è sconosciuto.</span><span class="sxs-lookup"><span data-stu-id="68333-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="68333-196">**TABLOCK**: un blocco a livello di tabella acquisito per la durata dell'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="68333-197">Questa opzione migliora in modo significativo le prestazioni, in quanto mantenere attivo un blocco solo per la durata dell'operazione di copia bulk riduce la contesa dei blocchi per la tabella.</span><span class="sxs-lookup"><span data-stu-id="68333-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="68333-198">Una tabella può essere caricata contemporaneamente da più client se non include indici e si specifica **TABLOCK**.</span><span class="sxs-lookup"><span data-stu-id="68333-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="68333-199">Per impostazione predefinita, il comportamento del blocco è determinato dall'opzione di tabella **table lock on bulk load**.</span><span class="sxs-lookup"><span data-stu-id="68333-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="68333-200">**CHECK_CONSTRAINTS**: tutti i vincoli per *table_name* vengono controllati durante l'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="68333-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="68333-201">Per impostazione predefinita, i vincoli vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="68333-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="68333-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usa il controllo delle versioni delle righe per i trigger e memorizza le versioni delle righe nell'archivio delle versioni in **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="68333-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="68333-203">Le ottimizzazioni della registrazione bulk sono, pertanto, disponibili anche quando i trigger sono abilitati.</span><span class="sxs-lookup"><span data-stu-id="68333-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="68333-204">Prima di eseguire l'importazione bulk di un batch con un numero elevato di righe con i trigger abilitati, può essere necessario aumentare le dimensioni di **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="68333-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="68333-205">Utilizzo di operazioni di copia bulk basate su file</span><span class="sxs-lookup"><span data-stu-id="68333-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="68333-206">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client implementa l'interfaccia **IBCPSession** per esporre il supporto per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] le operazioni di copia bulk basate su file.</span><span class="sxs-lookup"><span data-stu-id="68333-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="68333-207">L'interfaccia **IBCPSession** implementa i metodi [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) e [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="68333-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="68333-208">Driver ODBC di SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="68333-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="68333-209">Il driver ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client offre lo stesso supporto per le operazioni di copia bulk disponibili nelle versioni precedenti del driver ODBC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="68333-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="68333-210">Per informazioni sulle operazioni di copia bulk mediante il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] driver ODBC di Native client, vedere [esecuzione di operazioni di copia bulk &#40;&#41;ODBC ](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="68333-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="68333-211">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="68333-211">See Also</span></span>  
 <span data-ttu-id="68333-212">[Funzionalità di SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="68333-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="68333-213">[Proprietà delle origini dati &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="68333-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="68333-214">[Informazioni sull'importazione ed esportazione bulk di dati &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="68333-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="68333-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="68333-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="68333-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="68333-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="68333-217">[Ottimizzazione delle prestazioni dell'importazione bulk](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="68333-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
