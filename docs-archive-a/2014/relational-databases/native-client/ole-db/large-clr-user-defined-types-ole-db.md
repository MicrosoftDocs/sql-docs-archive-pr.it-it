---
title: Tipi CLR definiti dall'utente di grandi dimensioni (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714268"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="6204d-102">Tipi CLR definiti dall'utente di grandi dimensioni (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="6204d-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="6204d-103">In questo argomento vengono illustrate le modifiche apportate a OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client per supportare i tipi CLR (Common Language Runtime) definiti dall'utente di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6204d-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="6204d-104">Per ulteriori informazioni sul supporto di tipi definiti dall'utente CLR di grandi dimensioni in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client, vedere [tipi CLR definiti dall'utente di grandi dimensioni](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="6204d-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="6204d-105">Per un esempio, vedere [Usare tipi definiti dall'utente CLR di grandi dimensioni &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="6204d-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="6204d-106">Formato dati</span><span class="sxs-lookup"><span data-stu-id="6204d-106">Data Format</span></span>  
 <span data-ttu-id="6204d-107">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client viene utilizzato ~0 per rappresentare la lunghezza dei valori con dimensioni illimitate nel caso di tipi di oggetti LOB.</span><span class="sxs-lookup"><span data-stu-id="6204d-107">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="6204d-108">~ 0 rappresenta anche le dimensioni dei tipi CLR definiti dall'utente che superano 8.000 byte.</span><span class="sxs-lookup"><span data-stu-id="6204d-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="6204d-109">Nella tabella seguente viene illustrato il mapping dei tipi di dati nei parametri e nei set di righe:</span><span class="sxs-lookup"><span data-stu-id="6204d-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="6204d-110">Tipo di dati di SQL Server</span><span class="sxs-lookup"><span data-stu-id="6204d-110">SQL Server data type</span></span>|<span data-ttu-id="6204d-111">Tipo di dati OLE DB</span><span class="sxs-lookup"><span data-stu-id="6204d-111">OLE DB data type</span></span>|<span data-ttu-id="6204d-112">Layout in memoria</span><span class="sxs-lookup"><span data-stu-id="6204d-112">Memory layout</span></span>|<span data-ttu-id="6204d-113">Valore</span><span class="sxs-lookup"><span data-stu-id="6204d-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="6204d-114">tipo CLR definito dall'utente</span><span class="sxs-lookup"><span data-stu-id="6204d-114">CLR UDT</span></span>|<span data-ttu-id="6204d-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-115">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-116">BYTE[](matrice di byte\)</span><span class="sxs-lookup"><span data-stu-id="6204d-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="6204d-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="6204d-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="6204d-118">I valori dei tipi definiti dall'utente vengono rappresentati come matrici di byte.</span><span class="sxs-lookup"><span data-stu-id="6204d-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="6204d-119">Le conversioni da e verso le stringhe esadecimali sono supportate.</span><span class="sxs-lookup"><span data-stu-id="6204d-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="6204d-120">I valori letterali vengono rappresentati come stringhe esadecimali con il prefisso "0x".</span><span class="sxs-lookup"><span data-stu-id="6204d-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="6204d-121">Una stringa esadecimale è la rappresentazione testuale di dati binari in base 16.</span><span class="sxs-lookup"><span data-stu-id="6204d-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="6204d-122">Un esempio al riguardo è dato da una conversione dal tipo di dati del server `varbinary(10)` in DBTYPE_STR che determina la rappresentazione esadecimale di 20 caratteri in cui ogni coppia di caratteri rappresenta un solo byte.</span><span class="sxs-lookup"><span data-stu-id="6204d-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="6204d-123">Proprietà dei parametri</span><span class="sxs-lookup"><span data-stu-id="6204d-123">Parameter Properties</span></span>  
 <span data-ttu-id="6204d-124">Il set di proprietà DBPROPSET_SQLSERVERPARAMETER supporta i tipi definiti dall'utente tramite OLE DB.</span><span class="sxs-lookup"><span data-stu-id="6204d-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="6204d-125">Per altre informazioni, vedere [Uso dei tipi definiti dall'utente](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="6204d-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="6204d-126">Proprietà delle colonne</span><span class="sxs-lookup"><span data-stu-id="6204d-126">Column Properties</span></span>  
 <span data-ttu-id="6204d-127">Il set di proprietà DBPROPSET_SQLSERVERCOLUMN supporta la creazione di tabelle tramite OLE DB.</span><span class="sxs-lookup"><span data-stu-id="6204d-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="6204d-128">Per altre informazioni, vedere [Uso dei tipi definiti dall'utente](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="6204d-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="6204d-129">Mapping dei tipi di dati in ITableDefinition::CreateTable</span><span class="sxs-lookup"><span data-stu-id="6204d-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="6204d-130">Le informazioni seguenti vengono utilizzate nelle `DBCOLUMNDESC` strutture utilizzate da ITableDefinition:: CreateTable quando sono necessarie colonne con tipo definito dall'utente:</span><span class="sxs-lookup"><span data-stu-id="6204d-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="6204d-131">Tipo di dati OLE DB (*wType*)</span><span class="sxs-lookup"><span data-stu-id="6204d-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="6204d-132">*pwszTypeName*</span><span class="sxs-lookup"><span data-stu-id="6204d-132">*pwszTypeName*</span></span>|<span data-ttu-id="6204d-133">Tipo di dati di SQL Server</span><span class="sxs-lookup"><span data-stu-id="6204d-133">SQL Server data type</span></span>|<span data-ttu-id="6204d-134">*rgPropertySets*</span><span class="sxs-lookup"><span data-stu-id="6204d-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="6204d-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-135">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-136">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-136">Ignored</span></span>|<span data-ttu-id="6204d-137">UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-137">UDT</span></span>|<span data-ttu-id="6204d-138">Deve includere un set di proprietà DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="6204d-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="6204d-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="6204d-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="6204d-140">Di seguito sono riportate le informazioni restituite nella struttura DBPARAMINFO tramite **prgParamInfo**.</span><span class="sxs-lookup"><span data-stu-id="6204d-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="6204d-141">Tipo di parametro</span><span class="sxs-lookup"><span data-stu-id="6204d-141">Parameter type</span></span>|<span data-ttu-id="6204d-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="6204d-142">*wType*</span></span>|<span data-ttu-id="6204d-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="6204d-143">*ulParamSize*</span></span>|<span data-ttu-id="6204d-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="6204d-144">*bPrecision*</span></span>|<span data-ttu-id="6204d-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="6204d-145">*bScale*</span></span>|<span data-ttu-id="6204d-146">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="6204d-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="6204d-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-148">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="6204d-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="6204d-150">*n*</span><span class="sxs-lookup"><span data-stu-id="6204d-150">*n*</span></span>|<span data-ttu-id="6204d-151">Non definito</span><span class="sxs-lookup"><span data-stu-id="6204d-151">undefined</span></span>|<span data-ttu-id="6204d-152">Non definito</span><span class="sxs-lookup"><span data-stu-id="6204d-152">undefined</span></span>|<span data-ttu-id="6204d-153">deselezionare</span><span class="sxs-lookup"><span data-stu-id="6204d-153">clear</span></span>|  
|<span data-ttu-id="6204d-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-155">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="6204d-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="6204d-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="6204d-157">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-157">~0</span></span>|<span data-ttu-id="6204d-158">Non definito</span><span class="sxs-lookup"><span data-stu-id="6204d-158">undefined</span></span>|<span data-ttu-id="6204d-159">Non definito</span><span class="sxs-lookup"><span data-stu-id="6204d-159">undefined</span></span>|<span data-ttu-id="6204d-160">set</span><span class="sxs-lookup"><span data-stu-id="6204d-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="6204d-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="6204d-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="6204d-162">Le informazioni specificate nella struttura DBPARAMBINDINFO devono essere conformi agli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="6204d-163">Tipo di parametro</span><span class="sxs-lookup"><span data-stu-id="6204d-163">Parameter type</span></span>|<span data-ttu-id="6204d-164">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="6204d-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="6204d-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="6204d-165">*ulParamSize*</span></span>|<span data-ttu-id="6204d-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="6204d-166">*bPrecision*</span></span>|<span data-ttu-id="6204d-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="6204d-167">*bScale*</span></span>|<span data-ttu-id="6204d-168">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="6204d-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="6204d-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-170">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-171">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-172">*n*</span><span class="sxs-lookup"><span data-stu-id="6204d-172">*n*</span></span>|<span data-ttu-id="6204d-173">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-173">ignored</span></span>|<span data-ttu-id="6204d-174">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-174">ignored</span></span>|<span data-ttu-id="6204d-175">Deve essere impostato se è necessario passare il parametro utilizzando DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="6204d-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="6204d-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-177">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="6204d-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-178">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-179">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-179">~0</span></span>|<span data-ttu-id="6204d-180">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-180">ignored</span></span>|<span data-ttu-id="6204d-181">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-181">ignored</span></span>|<span data-ttu-id="6204d-182">Ignorato</span><span class="sxs-lookup"><span data-stu-id="6204d-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="6204d-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="6204d-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="6204d-184">Le applicazioni usano **ISSCommandWithParameters** per ottenere e impostare le proprietà dei parametri definite nella sezione Proprietà dei parametri.</span><span class="sxs-lookup"><span data-stu-id="6204d-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="6204d-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="6204d-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="6204d-186">Le colonne restituite sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="6204d-187">Tipo di colonna</span><span class="sxs-lookup"><span data-stu-id="6204d-187">Column type</span></span>|<span data-ttu-id="6204d-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="6204d-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="6204d-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="6204d-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="6204d-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="6204d-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="6204d-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="6204d-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="6204d-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="6204d-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="6204d-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="6204d-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="6204d-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="6204d-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="6204d-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-196">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-197">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-198">*n*</span><span class="sxs-lookup"><span data-stu-id="6204d-198">*n*</span></span>|<span data-ttu-id="6204d-199">NULL</span><span class="sxs-lookup"><span data-stu-id="6204d-199">NULL</span></span>|<span data-ttu-id="6204d-200">NULL</span><span class="sxs-lookup"><span data-stu-id="6204d-200">NULL</span></span>|<span data-ttu-id="6204d-201">Cancella</span><span class="sxs-lookup"><span data-stu-id="6204d-201">Clear</span></span>|<span data-ttu-id="6204d-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="6204d-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="6204d-203">n</span><span class="sxs-lookup"><span data-stu-id="6204d-203">n</span></span>|  
|<span data-ttu-id="6204d-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-205">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="6204d-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-206">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-207">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-207">~0</span></span>|<span data-ttu-id="6204d-208">NULL</span><span class="sxs-lookup"><span data-stu-id="6204d-208">NULL</span></span>|<span data-ttu-id="6204d-209">NULL</span><span class="sxs-lookup"><span data-stu-id="6204d-209">NULL</span></span>|<span data-ttu-id="6204d-210">Set</span><span class="sxs-lookup"><span data-stu-id="6204d-210">Set</span></span>|<span data-ttu-id="6204d-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="6204d-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="6204d-212">0</span><span class="sxs-lookup"><span data-stu-id="6204d-212">0</span></span>|  
  
 <span data-ttu-id="6204d-213">Per i tipi definiti dall'utente vengono definite anche le colonne seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="6204d-214">Identificatore di colonna</span><span class="sxs-lookup"><span data-stu-id="6204d-214">Column Identifier</span></span>|<span data-ttu-id="6204d-215">Type</span><span class="sxs-lookup"><span data-stu-id="6204d-215">Type</span></span>|<span data-ttu-id="6204d-216">Descrizione</span><span class="sxs-lookup"><span data-stu-id="6204d-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="6204d-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="6204d-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="6204d-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-219">Per le colonne con tipo definito dall'utente, il nome del catalogo in cui è indicato il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="6204d-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="6204d-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="6204d-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-222">Per le colonne con tipo definito dall'utente, il nome dello schema in cui è indicato il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="6204d-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="6204d-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="6204d-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-225">Per le colonne con tipo definito dall'utente, il nome composto da una parte del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="6204d-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="6204d-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="6204d-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-228">Per le colonne con tipo definito dall'utente, il nome completo del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="6204d-229">Il nome completo del tipo di assembly consente di creare un'istanza di un oggetto del tipo in questione utilizzando il metodo Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="6204d-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="6204d-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="6204d-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="6204d-231">Di seguito sono riportate le informazioni restituite nella struttura DBCOLUMNINFO.</span><span class="sxs-lookup"><span data-stu-id="6204d-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="6204d-232">Tipo di parametro</span><span class="sxs-lookup"><span data-stu-id="6204d-232">Parameter type</span></span>|<span data-ttu-id="6204d-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="6204d-233">*wType*</span></span>|<span data-ttu-id="6204d-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="6204d-234">*ulColumnSize*</span></span>|<span data-ttu-id="6204d-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="6204d-235">*bPrecision*</span></span>|<span data-ttu-id="6204d-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="6204d-236">*bScale*</span></span>|<span data-ttu-id="6204d-237">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="6204d-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="6204d-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="6204d-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="6204d-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-240">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-241">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-242">*n*</span><span class="sxs-lookup"><span data-stu-id="6204d-242">*n*</span></span>|<span data-ttu-id="6204d-243">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-243">~0</span></span>|<span data-ttu-id="6204d-244">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-244">~0</span></span>|<span data-ttu-id="6204d-245">Cancella</span><span class="sxs-lookup"><span data-stu-id="6204d-245">Clear</span></span>|  
|<span data-ttu-id="6204d-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-247">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="6204d-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-248">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-249">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-249">~0</span></span>|<span data-ttu-id="6204d-250">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-250">~0</span></span>|<span data-ttu-id="6204d-251">~0</span><span class="sxs-lookup"><span data-stu-id="6204d-251">~0</span></span>|<span data-ttu-id="6204d-252">Set</span><span class="sxs-lookup"><span data-stu-id="6204d-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="6204d-253">Set di righe COLUMNS (set di righe dello schema)</span><span class="sxs-lookup"><span data-stu-id="6204d-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="6204d-254">Per i tipi definiti dall'utente vengono restituiti i valori di colonna seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="6204d-255">Tipo di colonna</span><span class="sxs-lookup"><span data-stu-id="6204d-255">Column type</span></span>|<span data-ttu-id="6204d-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="6204d-256">DATA_TYPE</span></span>|<span data-ttu-id="6204d-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="6204d-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="6204d-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="6204d-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="6204d-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-260">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-261">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-262">Cancella</span><span class="sxs-lookup"><span data-stu-id="6204d-262">Clear</span></span>|<span data-ttu-id="6204d-263">*n*</span><span class="sxs-lookup"><span data-stu-id="6204d-263">*n*</span></span>|  
|<span data-ttu-id="6204d-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-265">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="6204d-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-266">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-267">Set</span><span class="sxs-lookup"><span data-stu-id="6204d-267">Set</span></span>|<span data-ttu-id="6204d-268">0</span><span class="sxs-lookup"><span data-stu-id="6204d-268">0</span></span>|  
  
 <span data-ttu-id="6204d-269">Per i tipi definiti dall'utente vengono definite le colonne aggiuntive seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="6204d-270">Identificatore di colonna</span><span class="sxs-lookup"><span data-stu-id="6204d-270">Column identifier</span></span>|<span data-ttu-id="6204d-271">Type</span><span class="sxs-lookup"><span data-stu-id="6204d-271">Type</span></span>|<span data-ttu-id="6204d-272">Descrizione</span><span class="sxs-lookup"><span data-stu-id="6204d-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="6204d-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="6204d-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="6204d-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-275">Per le colonne con tipo definito dall'utente, il nome del catalogo in cui è indicato il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="6204d-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="6204d-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="6204d-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-278">Per le colonne con tipo definito dall'utente, il nome dello schema in cui è indicato il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="6204d-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="6204d-279">SS_UDT_NAME</span></span>|<span data-ttu-id="6204d-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-281">Per le colonne con tipo definito dall'utente, il nome composto da una parte del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="6204d-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="6204d-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="6204d-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-284">Per le colonne con tipo definito dall'utente, il nome completo del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="6204d-285">Il nome completo del tipo di assembly consente di creare un'istanza di un oggetto del tipo in questione utilizzando il metodo Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="6204d-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="6204d-286">Se riferito al set di righe PROCEDURE_PARAMETERS, DATA_TYPE contiene gli stessi valori del set di righe dello schema COLUMNS e TYPE_NAME contiene il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="6204d-287">Vengono definite anche le stesse colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="6204d-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="6204d-288">I tipi definiti dall'utente non sono presenti nel set di righe dello schema PROVIDER_TYPES.</span><span class="sxs-lookup"><span data-stu-id="6204d-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="6204d-289">Associazioni e conversioni</span><span class="sxs-lookup"><span data-stu-id="6204d-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="6204d-290">Tipo di associazione dati</span><span class="sxs-lookup"><span data-stu-id="6204d-290">Binding data tpe</span></span>|<span data-ttu-id="6204d-291">Tipo definito dall'utente al server</span><span class="sxs-lookup"><span data-stu-id="6204d-291">UDT to server</span></span>|<span data-ttu-id="6204d-292">Tipo non definito dall'utente al server</span><span class="sxs-lookup"><span data-stu-id="6204d-292">Non-UDT to server</span></span>|<span data-ttu-id="6204d-293">Tipo definito dall'utente dal server</span><span class="sxs-lookup"><span data-stu-id="6204d-293">UDT from server</span></span>|<span data-ttu-id="6204d-294">Tipo non definito dall'utente dal server</span><span class="sxs-lookup"><span data-stu-id="6204d-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="6204d-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-295">DBTYPE_UDT</span></span>|<span data-ttu-id="6204d-296">Supportato (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-296">Supported (5)</span></span>|<span data-ttu-id="6204d-297">Errore (1)</span><span class="sxs-lookup"><span data-stu-id="6204d-297">Error (1)</span></span>|<span data-ttu-id="6204d-298">Supportato (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-298">Supported (5)</span></span>|<span data-ttu-id="6204d-299">Errore (4)</span><span class="sxs-lookup"><span data-stu-id="6204d-299">Error (4)</span></span>|  
|<span data-ttu-id="6204d-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="6204d-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="6204d-301">Supportato (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-301">Supported (5)</span></span>|<span data-ttu-id="6204d-302">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-302">N/A</span></span>|<span data-ttu-id="6204d-303">Supportato (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-303">Supported (5)</span></span>|<span data-ttu-id="6204d-304">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-304">N/A</span></span>|  
|<span data-ttu-id="6204d-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="6204d-306">Supportati (2), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-306">Supported (2), (5)</span></span>|<span data-ttu-id="6204d-307">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-307">N/A</span></span>|<span data-ttu-id="6204d-308">Supportato (3), (5), (6)</span><span class="sxs-lookup"><span data-stu-id="6204d-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="6204d-309">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-309">N/A</span></span>|  
|<span data-ttu-id="6204d-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="6204d-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="6204d-311">Supportati (2), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-311">Supported (2), (5)</span></span>|<span data-ttu-id="6204d-312">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-312">N/A</span></span>|<span data-ttu-id="6204d-313">Supportato (3), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-313">Supported (3), (5)</span></span>|<span data-ttu-id="6204d-314">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-314">N/A</span></span>|  
|<span data-ttu-id="6204d-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="6204d-315">DBTYPE_STR</span></span>|<span data-ttu-id="6204d-316">Supportati (2), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-316">Supported (2), (5)</span></span>|<span data-ttu-id="6204d-317">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-317">N/A</span></span>|<span data-ttu-id="6204d-318">Supportato (3), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-318">Supported (3), (5)</span></span>|<span data-ttu-id="6204d-319">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-319">N/A</span></span>|  
|<span data-ttu-id="6204d-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="6204d-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="6204d-321">Supportato (6)</span><span class="sxs-lookup"><span data-stu-id="6204d-321">Supported (6)</span></span>|<span data-ttu-id="6204d-322">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-322">N/A</span></span>|<span data-ttu-id="6204d-323">Supportato (6)</span><span class="sxs-lookup"><span data-stu-id="6204d-323">Supported (6)</span></span>|<span data-ttu-id="6204d-324">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-324">N/A</span></span>|  
|<span data-ttu-id="6204d-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="6204d-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="6204d-326">Supportato (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-326">Supported  (5)</span></span>|<span data-ttu-id="6204d-327">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-327">N/A</span></span>|<span data-ttu-id="6204d-328">Supportato (3), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-328">Supported (3), (5)</span></span>|<span data-ttu-id="6204d-329">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-329">N/A</span></span>|  
|<span data-ttu-id="6204d-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="6204d-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="6204d-331">Supportati (2), (5)</span><span class="sxs-lookup"><span data-stu-id="6204d-331">Supported (2), (5)</span></span>|<span data-ttu-id="6204d-332">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-332">N/A</span></span>|<span data-ttu-id="6204d-333">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-333">N/A</span></span>|<span data-ttu-id="6204d-334">N/D</span><span class="sxs-lookup"><span data-stu-id="6204d-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="6204d-335">Descrizione dei simboli</span><span class="sxs-lookup"><span data-stu-id="6204d-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="6204d-336">Simbolo</span><span class="sxs-lookup"><span data-stu-id="6204d-336">Symbol</span></span>|<span data-ttu-id="6204d-337">Significato</span><span class="sxs-lookup"><span data-stu-id="6204d-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="6204d-338">1</span><span class="sxs-lookup"><span data-stu-id="6204d-338">1</span></span>|<span data-ttu-id="6204d-339">Se viene specificato un tipo di dati del server diverso da DBTYPE_UDT con **ICommandWithParameters::SetParameterInfo** e il tipo di funzione di accesso è DBTYPE_UDT, si verifica un errore quando viene eseguita l'istruzione.</span><span class="sxs-lookup"><span data-stu-id="6204d-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="6204d-340">L'errore e lo stato del parametro saranno rispettivamente DB_E_ERRORSOCCURRED e DBSTATUS_E_BADACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="6204d-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="6204d-341">È un errore specificare un parametro con tipo definito dall'utente per un parametro del server che non presenta un tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6204d-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="6204d-342">2</span><span class="sxs-lookup"><span data-stu-id="6204d-342">2</span></span>|<span data-ttu-id="6204d-343">I dati vengono convertiti dal formato di stringa esadecimale nel formato binario.</span><span class="sxs-lookup"><span data-stu-id="6204d-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="6204d-344">3</span><span class="sxs-lookup"><span data-stu-id="6204d-344">3</span></span>|<span data-ttu-id="6204d-345">I dati vengono convertiti dal formato binario nel formato di stringa esadecimale.</span><span class="sxs-lookup"><span data-stu-id="6204d-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="6204d-346">4</span><span class="sxs-lookup"><span data-stu-id="6204d-346">4</span></span>|<span data-ttu-id="6204d-347">È possibile che venga eseguita la convalida quando si usa **CreateAccessor** o **GetNextRows**.</span><span class="sxs-lookup"><span data-stu-id="6204d-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="6204d-348">L'errore corrispondente è DB_E_ERRORSOCCURRED.</span><span class="sxs-lookup"><span data-stu-id="6204d-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="6204d-349">Lo stato di associazione viene impostato su DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="6204d-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="6204d-350">5</span><span class="sxs-lookup"><span data-stu-id="6204d-350">5</span></span>|<span data-ttu-id="6204d-351">È possibile utilizzare BY_REF.</span><span class="sxs-lookup"><span data-stu-id="6204d-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="6204d-352">6</span><span class="sxs-lookup"><span data-stu-id="6204d-352">6</span></span>|<span data-ttu-id="6204d-353">I parametri con tipo definito dall'utente possono essere associati come DBTYPE_IUNKNOWN in DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="6204d-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="6204d-354">L'associazione a DBTYPE_IUNKNOWN indica che l'applicazione richiede l'elaborazione dei dati come flusso usando l'interfaccia ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="6204d-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="6204d-355">Quando un consumer specifica *wType* in un'associazione come tipo DBTYPE_IUNKNOWN e la colonna o il parametro di output corrispondente della stored procedure è un tipo definito dall'utente, SQL Server Native Client restituirà ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="6204d-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="6204d-356">Per un parametro di input, SQL Server Native Client eseguirà una query per per l'interfaccia ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="6204d-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="6204d-357">È possibile scegliere di non associare la lunghezza del tipo definito dall'utente quando si utilizza l'associazione DBTYPE_IUNKNOWN nel caso di tipi definiti dall'utente di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6204d-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="6204d-358">La lunghezza deve essere invece associata nel caso di tipi definiti dall'utente di piccole dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6204d-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="6204d-359">Un parametro DBTYPE_UDT può essere specificato come tipo definito dall'utente di grandi dimensioni se si verificano una o più delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="6204d-360">-   *ulParamParamSize* è ~ 0.</span><span class="sxs-lookup"><span data-stu-id="6204d-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="6204d-361">-DBPARAMFLAGS_ISLONG viene impostato nello struct DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="6204d-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="6204d-362">Per i dati di riga, l'associazione DBTYPE_IUNKNOWN è consentita solo per i tipi definiti dall'utente di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="6204d-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="6204d-363">È possibile verificare se una colonna è un tipo definito dall'utente di grandi dimensioni usando il metodo IColumnsInfo::GetColumnInfo su un set di righe o sull'interfaccia IColumnsInfo di un oggetto Command.</span><span class="sxs-lookup"><span data-stu-id="6204d-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="6204d-364">Una colonna DBTYPE_UDT è una colonna con tipo definito dall'utente di grandi dimensioni se si verificano una o più delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="6204d-365">-DBCOLUMNFLAGS_ISLONG flag è impostato sul membro *dwFlags* della struttura DBCOLUMNINFO</span><span class="sxs-lookup"><span data-stu-id="6204d-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="6204d-366">-   il membro *ulColumnSize* di DBCOLUMNINFO è ~ 0.</span><span class="sxs-lookup"><span data-stu-id="6204d-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="6204d-367">DBTYPE_NULL e DBTYPE_EMPTY possono essere associati per i parametri di input ma non per i parametri di output o per i risultati.</span><span class="sxs-lookup"><span data-stu-id="6204d-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="6204d-368">Se vengono associati per i parametri di input, lo stato deve essere impostato su DBSTATUS_S_ISNULL per DBTYPE_NULL o su DBSTATUS_S_DEFAULT per DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="6204d-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="6204d-369">Non è possibile utilizzare DBTYPE_BYREF con DBTYPE_NULL o DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="6204d-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="6204d-370">DBTYPE_UDT può anche essere convertito in DBTYPE_EMPTY e DBTYPE_NULL.</span><span class="sxs-lookup"><span data-stu-id="6204d-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="6204d-371">DBTYPE_NULL e DBTYPE_EMPTY non possono invece essere convertiti in DBTYPE_UDT.</span><span class="sxs-lookup"><span data-stu-id="6204d-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="6204d-372">È coerente con DBTYPE_BYTES.</span><span class="sxs-lookup"><span data-stu-id="6204d-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="6204d-373">**ISSCommandWithParameters** viene usato per elaborare i tipi definiti dall'utente come parametri.</span><span class="sxs-lookup"><span data-stu-id="6204d-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="6204d-374">Le conversioni dei dati fornite dai servizi principali OLE DB (**IDataConvert**) non sono applicabili a DBTYPE_UDT.</span><span class="sxs-lookup"><span data-stu-id="6204d-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="6204d-375">Non sono supportate altre associazioni.</span><span class="sxs-lookup"><span data-stu-id="6204d-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="6204d-376">Possibilità di confronto per IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="6204d-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="6204d-377">Per i tipi definiti dall'utente sono supportati solo i confronti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6204d-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="6204d-378">EQ</span><span class="sxs-lookup"><span data-stu-id="6204d-378">EQ</span></span>  
  
-   <span data-ttu-id="6204d-379">NE</span><span class="sxs-lookup"><span data-stu-id="6204d-379">NE</span></span>  
  
-   <span data-ttu-id="6204d-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="6204d-380">IGNORE</span></span>  
  
 <span data-ttu-id="6204d-381">Se viene tentato qualsiasi altro confronto, viene restituito DB_E_BADCOMPAREOP.</span><span class="sxs-lookup"><span data-stu-id="6204d-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="6204d-382">Supporto di BCP per i tipi definiti dall'utente</span><span class="sxs-lookup"><span data-stu-id="6204d-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="6204d-383">I valori dei tipi definiti dall'utente possono essere importati ed esportati solo come caratteri o valori binari.</span><span class="sxs-lookup"><span data-stu-id="6204d-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="6204d-384">Comportamento dei client legacy per i tipi definiti dall'utente</span><span class="sxs-lookup"><span data-stu-id="6204d-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="6204d-385">I tipi definiti dall'utente sono soggetti al mapping dei tipi con i client legacy nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="6204d-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="6204d-386">Versione client </span><span class="sxs-lookup"><span data-stu-id="6204d-386">Client version</span></span>|<span data-ttu-id="6204d-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-388">(lunghezza minore o uguale a 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="6204d-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="6204d-390">(lunghezza maggiore di 8.000 byte)</span><span class="sxs-lookup"><span data-stu-id="6204d-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="6204d-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="6204d-391">SQL Server 2005</span></span>|<span data-ttu-id="6204d-392">UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-392">UDT</span></span>|<span data-ttu-id="6204d-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="6204d-393">varbinary(max)</span></span>|  
|<span data-ttu-id="6204d-394">SQL Server 2008 e versioni successive</span><span class="sxs-lookup"><span data-stu-id="6204d-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="6204d-395">UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-395">UDT</span></span>|<span data-ttu-id="6204d-396">UDT</span><span class="sxs-lookup"><span data-stu-id="6204d-396">UDT</span></span>|  
  
 <span data-ttu-id="6204d-397">Quando `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) è impostato su "80", i tipi definiti dall'utente di grandi dimensioni vengono visualizzati ai client nello stesso modo in cui vengono visualizzati ai client legacy.</span><span class="sxs-lookup"><span data-stu-id="6204d-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6204d-398">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6204d-398">See Also</span></span>  
 [<span data-ttu-id="6204d-399">Tipi CLR definiti dall'utente di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="6204d-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
