---
title: Nomi dell'entità servizio (SPN) nelle connessioni client (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: e212010e-a5b6-4ad1-a3c0-575327d3ffd3
author: rothja
ms.author: jroth
ms.openlocfilehash: cd88b11eb7416be869dce3c9ea166787f88d9ee7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625353"
---
# <a name="service-principal-names-spns-in-client-connections-ole-db"></a><span data-ttu-id="1b70b-102">Nomi SPN (Service Principal Name) nelle connessioni client (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="1b70b-102">Service Principal Names (SPNs) in Client Connections (OLE DB)</span></span>
  <span data-ttu-id="1b70b-103">In questo argomento vengono descritte le funzioni membro e le proprietà OLE DB che supportano i nomi SPN (Service Principal Name) nelle applicazioni client.</span><span class="sxs-lookup"><span data-stu-id="1b70b-103">This topic describes OLE DB properties and member functions that support service principal names (SPNs) in client applications.</span></span> <span data-ttu-id="1b70b-104">Per altre informazioni sui nomi SPN nelle applicazioni client, vedere [Supporto per nomi SPN nelle connessioni client](../features/service-principal-name-spn-support-in-client-connections.md).</span><span class="sxs-lookup"><span data-stu-id="1b70b-104">For more information about SPNs in client applications, see [Service Principal Name &#40;SPN&#41; Support in Client Connections](../features/service-principal-name-spn-support-in-client-connections.md).</span></span> <span data-ttu-id="1b70b-105">Per un esempio, vedere [Autenticazione Kerberos integrata &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="1b70b-105">For a sample, see [Integrated Kerberos Authentication &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span></span>  
  
## <a name="provider-initialization-string-keywords"></a><span data-ttu-id="1b70b-106">Parole chiave della stringa di inizializzazione del provider</span><span class="sxs-lookup"><span data-stu-id="1b70b-106">Provider Initialization String Keywords</span></span>  
 <span data-ttu-id="1b70b-107">Le seguenti parole chiave della stringa di inizializzazione del provider supportano i nomi SPN nelle applicazioni OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1b70b-107">The following provider initialization string keywords support SPNs in OLE DB applications.</span></span> <span data-ttu-id="1b70b-108">Nella tabella seguente i valori nella colonna relativa alla parola chiave vengono usati per la stringa del provider di IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="1b70b-108">In the following table, the values in the keyword column are used for the provider string of IDBInitialize::Initialize.</span></span> <span data-ttu-id="1b70b-109">I valori nella colonna relativa alla descrizione vengono usati nelle stringhe di inizializzazione quando la connessione viene eseguita con ADO oppure IDataInitialize::GetDataSource.</span><span class="sxs-lookup"><span data-stu-id="1b70b-109">The values in the description column are used in initialization strings when connecting using ADO or IDataInitialize::GetDataSource.</span></span>  
  
|<span data-ttu-id="1b70b-110">Parola chiave</span><span class="sxs-lookup"><span data-stu-id="1b70b-110">Keyword</span></span>|<span data-ttu-id="1b70b-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1b70b-111">Description</span></span>|<span data-ttu-id="1b70b-112">Valore</span><span class="sxs-lookup"><span data-stu-id="1b70b-112">Value</span></span>|  
|-------------|-----------------|-----------|  
|<span data-ttu-id="1b70b-113">ServerSPN</span><span class="sxs-lookup"><span data-stu-id="1b70b-113">ServerSPN</span></span>|<span data-ttu-id="1b70b-114">SPN server</span><span class="sxs-lookup"><span data-stu-id="1b70b-114">Server SPN</span></span>|<span data-ttu-id="1b70b-115">Nome SPN del server.</span><span class="sxs-lookup"><span data-stu-id="1b70b-115">The SPN for the server.</span></span> <span data-ttu-id="1b70b-116">Il valore predefinito è una stringa vuota, che in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client causa l'utilizzo del nome SPN predefinito generato dal provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-116">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="1b70b-117">FailoverPartnerSPN</span><span class="sxs-lookup"><span data-stu-id="1b70b-117">FailoverPartnerSPN</span></span>|<span data-ttu-id="1b70b-118">Nome SPN del partner di failover</span><span class="sxs-lookup"><span data-stu-id="1b70b-118">Failover Partner SPN</span></span>|<span data-ttu-id="1b70b-119">Nome SPN del partner di failover.</span><span class="sxs-lookup"><span data-stu-id="1b70b-119">The SPN for the failover partner.</span></span> <span data-ttu-id="1b70b-120">Il valore predefinito è una stringa vuota, che in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client causa l'utilizzo del nome SPN predefinito generato dal provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-120">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-initialization-properties"></a><span data-ttu-id="1b70b-121">Proprietà di inizializzazione dell'origine dati</span><span class="sxs-lookup"><span data-stu-id="1b70b-121">Data Source Initialization Properties</span></span>  
 <span data-ttu-id="1b70b-122">Le seguenti proprietà del set di proprietà `DBPROPSET_SQLSERVERDBINIT` consentono alle applicazioni di specificare nomi SPN.</span><span class="sxs-lookup"><span data-stu-id="1b70b-122">The following properties in the `DBPROPSET_SQLSERVERDBINIT` property set allow applications to specify SPNs.</span></span>  
  
|<span data-ttu-id="1b70b-123">Nome</span><span class="sxs-lookup"><span data-stu-id="1b70b-123">Name</span></span>|<span data-ttu-id="1b70b-124">Type</span><span class="sxs-lookup"><span data-stu-id="1b70b-124">Type</span></span>|<span data-ttu-id="1b70b-125">Uso</span><span class="sxs-lookup"><span data-stu-id="1b70b-125">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="1b70b-126">SSPROP_INIT_SERVERSPN</span><span class="sxs-lookup"><span data-stu-id="1b70b-126">SSPROP_INIT_SERVERSPN</span></span>|<span data-ttu-id="1b70b-127">VT_BSTR, lettura/scrittura</span><span class="sxs-lookup"><span data-stu-id="1b70b-127">VT_BSTR, read/write</span></span>|<span data-ttu-id="1b70b-128">Specifica il nome SPN per il server.</span><span class="sxs-lookup"><span data-stu-id="1b70b-128">Specifies the SPN for the server.</span></span> <span data-ttu-id="1b70b-129">Il valore predefinito è una stringa vuota, che in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client causa l'utilizzo del nome SPN predefinito generato dal provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-129">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="1b70b-130">SSPROP_INIT_FAILOVERPARTNERSPN</span><span class="sxs-lookup"><span data-stu-id="1b70b-130">SSPROP_INIT_FAILOVERPARTNERSPN</span></span>|<span data-ttu-id="1b70b-131">VT_BSTR, lettura/scrittura</span><span class="sxs-lookup"><span data-stu-id="1b70b-131">VT_BSTR, read/write</span></span>|<span data-ttu-id="1b70b-132">Specifica il nome SPN per il partner di failover.</span><span class="sxs-lookup"><span data-stu-id="1b70b-132">Specifies the SPN for the failover partner.</span></span> <span data-ttu-id="1b70b-133">Il valore predefinito è una stringa vuota, che in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client causa l'utilizzo del nome SPN predefinito generato dal provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-133">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-properties"></a><span data-ttu-id="1b70b-134">Proprietà dell'origine dati</span><span class="sxs-lookup"><span data-stu-id="1b70b-134">Data Source Properties</span></span>  
 <span data-ttu-id="1b70b-135">Le seguenti proprietà del set di proprietà `DBPROPSET_SQLSERVERDATASOURCEINFO` consentono alle applicazioni di individuare il metodo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="1b70b-135">The following properties in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set allow applications to discover the authentication method.</span></span>  
  
|<span data-ttu-id="1b70b-136">Nome</span><span class="sxs-lookup"><span data-stu-id="1b70b-136">Name</span></span>|<span data-ttu-id="1b70b-137">Type</span><span class="sxs-lookup"><span data-stu-id="1b70b-137">Type</span></span>|<span data-ttu-id="1b70b-138">Uso</span><span class="sxs-lookup"><span data-stu-id="1b70b-138">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="1b70b-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span><span class="sxs-lookup"><span data-stu-id="1b70b-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span></span>|<span data-ttu-id="1b70b-140">VT_BSTR, sola lettura</span><span class="sxs-lookup"><span data-stu-id="1b70b-140">VT_BSTR, readonly</span></span>|<span data-ttu-id="1b70b-141">Restituisce il metodo di autenticazione utilizzato per la connessione.</span><span class="sxs-lookup"><span data-stu-id="1b70b-141">Returns the authentication method used for the connection.</span></span> <span data-ttu-id="1b70b-142">Il valore restituito all'applicazione è il valore che Windows restituisce a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="1b70b-142">The value returned to the application is the value that Windows returns to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="1b70b-143">Di seguito sono indicati i valori possibili:</span><span class="sxs-lookup"><span data-stu-id="1b70b-143">The following are possible values:</span></span><br /><br /> <span data-ttu-id="1b70b-144">-"NTLM", che viene restituito quando una connessione viene aperta utilizzando l'autenticazione NTLM.</span><span class="sxs-lookup"><span data-stu-id="1b70b-144">-   "NTLM", which is returned when a connection is opened using NTLM authentication.</span></span><br /><span data-ttu-id="1b70b-145">-"Kerberos", che viene restituito quando viene aperta una connessione usando l'autenticazione Kerberos.</span><span class="sxs-lookup"><span data-stu-id="1b70b-145">-   "Kerberos", which is returned when a connection is opened using Kerberos authentication.</span></span><br /><br /> <span data-ttu-id="1b70b-146">Se è stata aperta una connessione ed è impossibile determinare il metodo di autenticazione, viene restituito VT_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="1b70b-146">If a connection has been opened and the authentication method cannot be determined, VT_EMPTY is returned.</span></span><br /><br /> <span data-ttu-id="1b70b-147">Questa proprietà può essere letta solo quando è stata inizializzata un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="1b70b-147">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="1b70b-148">Se si tenta di leggere la proprietà prima che sia stata inizializzata un'origine dati, IDBProperties::GetProperies restituirà DB_S_ERRORSOCCURRED o DB_E_ERRORSOCCURRED, a seconda dei casi e verrà impostato DBPROPSTATUS_NOTSUPPORTED in DBPROPSET_PROPERTIESINERROR per questa proprietà.</span><span class="sxs-lookup"><span data-stu-id="1b70b-148">If you attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="1b70b-149">Questo comportamento è conforme alla specifica OLE DB principale.</span><span class="sxs-lookup"><span data-stu-id="1b70b-149">This behavior is in accordance with the OLE DB core specification.</span></span>|  
|<span data-ttu-id="1b70b-150">SSPROP_MUTUALLYAUTHENICATED</span><span class="sxs-lookup"><span data-stu-id="1b70b-150">SSPROP_MUTUALLYAUTHENICATED</span></span>|<span data-ttu-id="1b70b-151">VT_BOOL, sola lettura</span><span class="sxs-lookup"><span data-stu-id="1b70b-151">VT_BOOL, readonly</span></span>|<span data-ttu-id="1b70b-152">Restituisce VARIANT_TRUE se nella connessione è stata eseguita un'autenticazione reciproca dei server. In caso contrario, restituisce VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="1b70b-152">Returns VARIANT_TRUE if the servers on the connection were mutually authenticated; otherwise, returns VARIANT_FALSE.</span></span><br /><br /> <span data-ttu-id="1b70b-153">Questa proprietà può essere letta solo quando è stata inizializzata un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="1b70b-153">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="1b70b-154">Se si tenta di leggere la proprietà prima che sia stata inizializzata un'origine dati, IDBProperties::GetProperies restituirà DB_S_ERRORSOCCURRED o DB_E_ERRORSOCCURRED, a seconda dei casi e verrà impostato DBPROPSTATUS_NOTSUPPORTED in DBPROPSET_PROPERTIESINERROR per questa proprietà.</span><span class="sxs-lookup"><span data-stu-id="1b70b-154">If there is an attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="1b70b-155">Questo comportamento è conforme alla specifica OLE DB principale</span><span class="sxs-lookup"><span data-stu-id="1b70b-155">This behavior is in accordance with the OLE DB core specification</span></span><br /><br /> <span data-ttu-id="1b70b-156">Se viene eseguita una query su questo attributo per una connessione in cui non è stata utilizzata l'autenticazione di Windows, viene restituito VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="1b70b-156">If this attribute is queried for a connection that did not use Windows Authentication, VARIANT_FALSE is returned.</span></span>|  
  
## <a name="ole-db-api-support-for-spns"></a><span data-ttu-id="1b70b-157">Supporto dell'API OLE DB per i nomi SPN</span><span class="sxs-lookup"><span data-stu-id="1b70b-157">OLE DB API Support for SPNs</span></span>  
 <span data-ttu-id="1b70b-158">Nella tabella seguente vengono descritte le funzioni membro OLE DB che supportano i nomi SPN nelle connessioni client:</span><span class="sxs-lookup"><span data-stu-id="1b70b-158">The following table describes the OLE DB member functions that support SPNs in client connections:</span></span>  
  
|<span data-ttu-id="1b70b-159">Funzione membro</span><span class="sxs-lookup"><span data-stu-id="1b70b-159">Member function</span></span>|<span data-ttu-id="1b70b-160">Descrizione</span><span class="sxs-lookup"><span data-stu-id="1b70b-160">Description</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="1b70b-161">IDataInitialize::GetDataSource</span><span class="sxs-lookup"><span data-stu-id="1b70b-161">IDataInitialize::GetDataSource</span></span>|<span data-ttu-id="1b70b-162">*pwszInitializationString* può contenere le nuove parole chiave `ServerSPN` e `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="1b70b-162">*pwszInitializationString* can contain the new keywords `ServerSPN` and `FailoverPartnerSPN`.</span></span>|  
|<span data-ttu-id="1b70b-163">IDataInitialize::GetInitializationString</span><span class="sxs-lookup"><span data-stu-id="1b70b-163">IDataInitialize::GetInitializationString</span></span>|<span data-ttu-id="1b70b-164">Se SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN hanno valori non predefiniti, verranno inclusi nella stringa di inizializzazione tramite *ppwszInitString* come valori di parola chiave per `ServerSPN` e `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="1b70b-164">If SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN have non-default values, they will be included in the initialization string through *ppwszInitString* as keyword values for `ServerSPN` and `FailoverPartnerSPN`.</span></span> <span data-ttu-id="1b70b-165">In caso contrario, queste parole chiave non saranno incluse nella stringa di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="1b70b-165">Otherwise, these keywords will not be included in the initialization string.</span></span>|  
|<span data-ttu-id="1b70b-166">IDBInitialize::Initialize</span><span class="sxs-lookup"><span data-stu-id="1b70b-166">IDBInitialize::Initialize</span></span>|<span data-ttu-id="1b70b-167">Se la richiesta viene abilitata impostando DBPROP_INIT_PROMPT nelle proprietà di inizializzazione dell'origine dati, verrà visualizzata la finestra di dialogo di accesso OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1b70b-167">If prompting is enabled by setting DBPROP_INIT_PROMPT in the data source initialization properties, the OLE DB Login dialog box will be displayed.</span></span> <span data-ttu-id="1b70b-168">Ciò consente di immettere i nomi SPN per il server principale e per il relativo partner di failover.</span><span class="sxs-lookup"><span data-stu-id="1b70b-168">This allows SPNs to be entered for both the principal server and its failover partner.</span></span><br /><br /> <span data-ttu-id="1b70b-169">La stringa del provider in DPPROP_INIT_PROVIDERSTRING, se impostata, rileverà le nuove parole chiave `ServerSPN` e `FailoverPartnerSPN` e utilizzerà i relativi valori, se presenti, per inizializzare SSPROP_INIT_SERVER_SPN e SSPROP_INIT_FAILOVER_PARTNER_SPN.</span><span class="sxs-lookup"><span data-stu-id="1b70b-169">The provider string in DPPROP_INIT_PROVIDERSTRING, if set, will recognize the new keywords `ServerSPN` and `FailoverPartnerSPN` and use their values, if present, to initialize SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN.</span></span><br /><br /> <span data-ttu-id="1b70b-170">È possibile chiamare IDBProperties::SetProperties per impostare le proprietà SSPROP_INIT_SERVER_SPN e SSPROP_INIT_FAILOVER_PARTNER_SPN prima che venga chiamato IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="1b70b-170">IDBProperties::SetProperties can be called to set the properties SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN before IDBInitialize::Initialize is called.</span></span> <span data-ttu-id="1b70b-171">Si tratta di un'alternativa all'utilizzo di una stringa del provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-171">This is an alternative to using a provider string.</span></span><br /><br /> <span data-ttu-id="1b70b-172">Se una proprietà viene impostata in più posizioni, un valore impostato a livello di programmazione ha la precedenza su un valore impostato nella stringa del provider.</span><span class="sxs-lookup"><span data-stu-id="1b70b-172">If a property is set in more than one place, a value set programmatically takes precedence over a value set in the provider string.</span></span> <span data-ttu-id="1b70b-173">Un valore impostato in una stringa di inizializzazione ha la precedenza su un valore impostato in una finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="1b70b-173">A value set in an initialization string takes precedence over a value set in a login dialog box.</span></span><br /><br /> <span data-ttu-id="1b70b-174">Se la stessa parola chiave viene visualizzata più volte nella stringa del provider, il valore della prima occorrenza avrà la precedenza.</span><span class="sxs-lookup"><span data-stu-id="1b70b-174">If the same keyword appears more than once in the provider string, the value from first occurrence takes precedence.</span></span>|  
|<span data-ttu-id="1b70b-175">IDBProperties::GetProperties</span><span class="sxs-lookup"><span data-stu-id="1b70b-175">IDBProperties::GetProperties</span></span>|<span data-ttu-id="1b70b-176">È possibile chiamare IDBProperties::GetProperties per ottenere i valori delle nuove proprietà di inizializzazione dell'origine dati SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN e delle nuove proprietà dell'origine dati SPROP_AUTHENTICATIONMETHOD e SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="1b70b-176">IDBProperties::GetProperties can be called to get the values of the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, and of the new data source properties SSPROP_AUTHENTICATIONMETHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="1b70b-177">IDBProperties::GetPropertyInfo</span><span class="sxs-lookup"><span data-stu-id="1b70b-177">IDBProperties::GetPropertyInfo</span></span>|<span data-ttu-id="1b70b-178">IdbProperties::GetPropertyInfo include le nuove proprietà di inizializzazione dell'origine dati SSPROP_INIT_SERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN oppure le nuove proprietà dell'origine dati SPROP_AUTHENTICATIONMETHOD e SSPROP_MUTUALLYAUTHENTICATED.</span><span class="sxs-lookup"><span data-stu-id="1b70b-178">IdbProperties::GetPropertyInfo will include the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, or the new data source properties SSPROP_AUTHENTICATION_METHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="1b70b-179">IDBProperties::SetProperties</span><span class="sxs-lookup"><span data-stu-id="1b70b-179">IDBProperties::SetProperties</span></span>|<span data-ttu-id="1b70b-180">È possibile chiamare IDBProperties::SetProperties per impostare i valori delle nuove proprietà di inizializzazione dell'origine dati SSPROP_INITSERVERSPN e SSPROP_INIT_FAILOVERPARTNERSPN.</span><span class="sxs-lookup"><span data-stu-id="1b70b-180">IDBProperties::SetProperties can be called to set the values of the new data source initialization properties SSPROP_INITSERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN.</span></span><br /><br /> <span data-ttu-id="1b70b-181">È possibile impostare queste proprietà in qualsiasi momento; tuttavia, se l'origine dati è già aperta, verrà restituito il seguente errore: DB_E_ERRORSOCCURRED, "Si sono verificati errori in un'operazione OLE DB composta da più passaggi.</span><span class="sxs-lookup"><span data-stu-id="1b70b-181">These properties can be set at any time, but if the data source is already open, the following error will be returned: DB_E_ERRORSOCCURRED, "Multiple-step OLE DB operation generated errors.</span></span> <span data-ttu-id="1b70b-182">Controllare i singoli valori di stato OLE DB, se disponibili.</span><span class="sxs-lookup"><span data-stu-id="1b70b-182">Check each OLE DB status value, if available.</span></span> <span data-ttu-id="1b70b-183">Nessuna operazione eseguita".</span><span class="sxs-lookup"><span data-stu-id="1b70b-183">No work was done."</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="1b70b-184">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="1b70b-184">See Also</span></span>  
 [<span data-ttu-id="1b70b-185">SQL Server Native Client &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="1b70b-185">SQL Server Native Client &#40;OLE DB&#41;</span></span>](sql-server-native-client-ole-db.md)  
  
  
