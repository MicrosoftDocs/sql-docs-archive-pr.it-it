---
title: Chiamata a una stored procedure (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- calling stored procedures
- RPC escape sequence
- OLE DB, stored procedures
- parameters [SQL Server Native Client], OLE DB
- ODBC CALL escape sequence
- stored procedures [OLE DB], calling
- SQL Server Native Client OLE DB provider, stored procedures
ms.assetid: 8e5738e5-4bbe-4f34-bd69-0c0633290bdd
author: rothja
ms.author: jroth
ms.openlocfilehash: 695848c8633d310f5e8ee21e9e738749d1550e4a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722692"
---
# <a name="calling-a-stored-procedure-ole-db"></a><span data-ttu-id="15bfe-102">Esecuzione di una chiamata a una stored procedure (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="15bfe-102">Calling a Stored Procedure (OLE DB)</span></span>
  <span data-ttu-id="15bfe-103">Una stored procedure può avere zero o più parametri.</span><span class="sxs-lookup"><span data-stu-id="15bfe-103">A stored procedure can have zero or more parameters.</span></span> <span data-ttu-id="15bfe-104">Può inoltre restituire un valore.</span><span class="sxs-lookup"><span data-stu-id="15bfe-104">It can also return a value.</span></span> <span data-ttu-id="15bfe-105">Quando si utilizza il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native client, è possibile passare i parametri di un stored procedure:</span><span class="sxs-lookup"><span data-stu-id="15bfe-105">When using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider, parameters to a stored procedure can be passed by:</span></span>  
  
-   <span data-ttu-id="15bfe-106">Specificando il valore dei dati a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="15bfe-106">Hard-coding the data value.</span></span>  
  
-   <span data-ttu-id="15bfe-107">Utilizzando un marcatore di parametro (?) per specificare i parametri, associare una variabile di programma all'marcatore di parametro e quindi inserire il valore dei dati nella variabile di programma.</span><span class="sxs-lookup"><span data-stu-id="15bfe-107">Using a parameter marker (?) to specify parameters, bind a program variable to the parameter marker, and then place the data value in the program variable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15bfe-108">Quando si esegue una chiamata alle stored procedure [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] usando parametri denominati con OLE DB, i nomi dei parametri devono iniziare con il carattere "\@".</span><span class="sxs-lookup"><span data-stu-id="15bfe-108">When calling [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedures using named parameters with OLE DB, the parameter names must start with the '\@' character.</span></span> <span data-ttu-id="15bfe-109">Si tratta di una restrizione specifica di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15bfe-109">This is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific restriction.</span></span> <span data-ttu-id="15bfe-110">Il provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client applica questa limitazione in modo più restrittivo rispetto a MDAC.</span><span class="sxs-lookup"><span data-stu-id="15bfe-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider enforces this restriction more strictly than MDAC.</span></span>  
  
 <span data-ttu-id="15bfe-111">Per supportare i parametri, l'interfaccia **ICommandWithParameters** viene esposta nell'oggetto comando.</span><span class="sxs-lookup"><span data-stu-id="15bfe-111">To support parameters, the **ICommandWithParameters** interface is exposed on the command object.</span></span> <span data-ttu-id="15bfe-112">Per usare i parametri, il consumer descrive prima i parametri al provider chiamando il metodo **ICommandWithParameters::SetParameterInfo** (o facoltativamente prepara un'istruzione di chiamata che chiama il metodo **GetParameterInfo**).</span><span class="sxs-lookup"><span data-stu-id="15bfe-112">To use parameters, the consumer first describes the parameters to the provider by calling the **ICommandWithParameters::SetParameterInfo** method (or optionally prepares a calling statement that calls the **GetParameterInfo** method).</span></span> <span data-ttu-id="15bfe-113">Il consumer crea quindi una funzione di accesso che specifica la struttura di un buffer e inserisce i valori dei parametri in questo buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-113">The consumer then creates an accessor that specifies the structure of a buffer and places parameter values in this buffer.</span></span> <span data-ttu-id="15bfe-114">Infine, passa l'handle della funzione di accesso e un puntatore al buffer a **Execute**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-114">Finally, it passes the handle of the accessor and a pointer to the buffer to **Execute**.</span></span> <span data-ttu-id="15bfe-115">Nelle chiamate successive a **Execute**, il consumer inserisce i nuovi valori dei parametri nel buffer e chiama **Execute** con l'handle della funzione di accesso e il puntatore al buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-115">On later calls to **Execute**, the consumer places new parameter values in the buffer and calls **Execute** with the accessor handle and buffer pointer.</span></span>  
  
 <span data-ttu-id="15bfe-116">Un comando che chiama una stored procedure temporanea con i parametri deve prima chiamare **ICommandWithParameters::SetParameterInfo** per definire le informazioni sui parametri, perché il comando possa essere preparato correttamente.</span><span class="sxs-lookup"><span data-stu-id="15bfe-116">A command that calls a temporary stored procedure using parameters must first call **ICommandWithParameters::SetParameterInfo** to define the parameter information, before the command can be successfully prepared.</span></span> <span data-ttu-id="15bfe-117">Questa operazione è necessaria perché il nome interno di una stored procedure temporanea è diverso dal nome esterno utilizzato da un client e SQLOLEDB non può eseguire una query sulle tabelle di sistema per determinare le informazioni sui parametri per una stored procedure temporanea.</span><span class="sxs-lookup"><span data-stu-id="15bfe-117">This is because the internal name for a temporary stored procedure differs from the external name used by a client and SQLOLEDB cannot query the system tables to determine the parameter information for a temporary stored procedure.</span></span>  
  
 <span data-ttu-id="15bfe-118">Di seguito sono riportati i passaggi del processo di associazione dei parametri:</span><span class="sxs-lookup"><span data-stu-id="15bfe-118">These are the steps in the parameter binding process:</span></span>  
  
1.  <span data-ttu-id="15bfe-119">Completare le informazioni sui parametri in una matrice di strutture DBPARAMBINDINFO, ovvero nome del parametro, nome specifico del provider per il tipo di dati del parametro o nome del tipo di dati standard e così via.</span><span class="sxs-lookup"><span data-stu-id="15bfe-119">Fill in the parameter information in an array of DBPARAMBINDINFO structures; that is, parameter name, provider-specific name for the data type of the parameter or a standard data type name, and so on.</span></span> <span data-ttu-id="15bfe-120">Ogni struttura della matrice descrive un solo parametro.</span><span class="sxs-lookup"><span data-stu-id="15bfe-120">Each structure in the array describes one parameter.</span></span> <span data-ttu-id="15bfe-121">Questa matrice viene quindi passata al metodo **SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-121">This array is then passed to the **SetParameterInfo** method.</span></span>  
  
2.  <span data-ttu-id="15bfe-122">Chiamare il metodo **ICommandWithParameters::SetParameterInfo** per descrivere i parametri al provider.</span><span class="sxs-lookup"><span data-stu-id="15bfe-122">Call the **ICommandWithParameters::SetParameterInfo** method to describe parameters to the provider.</span></span> <span data-ttu-id="15bfe-123">**SetParameterInfo** specifica il tipo di dati nativo di ogni parametro.</span><span class="sxs-lookup"><span data-stu-id="15bfe-123">**SetParameterInfo** specifies the native data type of each parameter.</span></span> <span data-ttu-id="15bfe-124">Gli argomenti di **SetParameterInfo** sono:</span><span class="sxs-lookup"><span data-stu-id="15bfe-124">**SetParameterInfo** arguments are:</span></span>  
  
    -   <span data-ttu-id="15bfe-125">Numero di parametri per i quali impostare le informazioni sul tipo.</span><span class="sxs-lookup"><span data-stu-id="15bfe-125">The number of parameters for which to set type information.</span></span>  
  
    -   <span data-ttu-id="15bfe-126">Matrice di numeri ordinali dei parametri per i quali impostare le informazioni sul tipo.</span><span class="sxs-lookup"><span data-stu-id="15bfe-126">An array of parameter ordinals for which to set type information.</span></span>  
  
    -   <span data-ttu-id="15bfe-127">Matrice di strutture DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="15bfe-127">An array of DBPARAMBINDINFO structures.</span></span>  
  
3.  <span data-ttu-id="15bfe-128">Creare una funzione di accesso ai parametri usando il comando **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-128">Create a parameter accessor by using the **IAccessor::CreateAccessor** command.</span></span> <span data-ttu-id="15bfe-129">La funzione di accesso specifica la struttura di un buffer e inserisce i valori dei parametri nel buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-129">The accessor specifies the structure of a buffer and places parameter values in the buffer.</span></span> <span data-ttu-id="15bfe-130">Il comando **CreateAccessor** crea una funzione di accesso da un set di associazioni.</span><span class="sxs-lookup"><span data-stu-id="15bfe-130">The **CreateAccessor** command creates an accessor from a set of bindings.</span></span> <span data-ttu-id="15bfe-131">Queste associazioni vengono descritte dal consumer mediante una matrice di strutture DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="15bfe-131">These bindings are described by the consumer by using an array of DBBINDING structures.</span></span> <span data-ttu-id="15bfe-132">Ogni associazione associa un singolo parametro al buffer del consumer e contiene le seguenti informazioni:</span><span class="sxs-lookup"><span data-stu-id="15bfe-132">Each binding associates a single parameter to the buffer of the consumer and contains information such as:</span></span>  
  
    -   <span data-ttu-id="15bfe-133">Numero ordinale del parametro a cui viene applicata l'associazione.</span><span class="sxs-lookup"><span data-stu-id="15bfe-133">The ordinal of the parameter to which the binding applies.</span></span>  
  
    -   <span data-ttu-id="15bfe-134">Elemento da associare (valore dei dati, lunghezza e stato).</span><span class="sxs-lookup"><span data-stu-id="15bfe-134">What is bound (the data value, its length, and its status).</span></span>  
  
    -   <span data-ttu-id="15bfe-135">Offset nel buffer per ognuna di queste parti.</span><span class="sxs-lookup"><span data-stu-id="15bfe-135">The offset in the buffer to each of these parts.</span></span>  
  
    -   <span data-ttu-id="15bfe-136">Lunghezza e tipo del valore dei dati esattamente come riportati nel buffer del consumer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-136">The length and type of the data value as it exists in the buffer of the consumer.</span></span>  
  
     <span data-ttu-id="15bfe-137">Una funzione di accesso viene identificata dal relativo handle di tipo HACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="15bfe-137">An accessor is identified by its handle, which is of type HACCESSOR.</span></span> <span data-ttu-id="15bfe-138">Questo handle viene restituito dal metodo **CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-138">This handle is returned by the **CreateAccessor** method.</span></span> <span data-ttu-id="15bfe-139">Al termine dell'uso di una funzione di accesso, il consumer deve chiamare il metodo **ReleaseAccessor** per rilasciarne la memoria.</span><span class="sxs-lookup"><span data-stu-id="15bfe-139">Whenever the consumer finishes using an accessor, the consumer must call the **ReleaseAccessor** method to release the memory it holds.</span></span>  
  
     <span data-ttu-id="15bfe-140">Quando il consumer chiama un metodo, ad esempio **ICommand::Execute**, passa l'handle a una funzione di accesso e a un puntatore a un buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-140">When the consumer calls a method, such as **ICommand::Execute**, it passes the handle to an accessor and a pointer to a buffer itself.</span></span> <span data-ttu-id="15bfe-141">Il provider utilizza questa funzione di accesso per determinare il modo in cui trasferire i dati contenuti nel buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-141">The provider uses this accessor to determine how to transfer the data contained in the buffer.</span></span>  
  
4.  <span data-ttu-id="15bfe-142">Completare la struttura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="15bfe-142">Fill in the DBPARAMS structure.</span></span> <span data-ttu-id="15bfe-143">Le variabili del consumer, da cui vengono acquisiti i valori dei parametri di input e in cui vengono scritti i valori dei parametri di output, vengono passate in fase di esecuzione a **ICommand::Execute** nella struttura DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="15bfe-143">The consumer variables from which input parameter values are taken and to which output parameter values are written are passed at run time to **ICommand::Execute** in the DBPARAMS structure.</span></span> <span data-ttu-id="15bfe-144">La struttura DBPARAMS include tre elementi:</span><span class="sxs-lookup"><span data-stu-id="15bfe-144">The DBPARAMS structure includes three elements:</span></span>  
  
    -   <span data-ttu-id="15bfe-145">Puntatore al buffer da cui il provider recupera i dati dei parametri di input e in cui il provider restituisce i dati dei parametri di output, in base alle associazioni specificate dall'handle della funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="15bfe-145">A pointer to the buffer from which the provider retrieves input parameter data and to which the provider returns output parameter data, according to the bindings specified by the accessor handle.</span></span>  
  
    -   <span data-ttu-id="15bfe-146">Numero di set di parametri nel buffer.</span><span class="sxs-lookup"><span data-stu-id="15bfe-146">The number of sets of parameters in the buffer.</span></span>  
  
    -   <span data-ttu-id="15bfe-147">Handle della funzione di accesso creato nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="15bfe-147">The accessor handle created in Step 3.</span></span>  
  
5.  <span data-ttu-id="15bfe-148">Eseguire il comando usando **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-148">Execute the command by using **ICommand::Execute**.</span></span>  
  
## <a name="methods-of-calling-a-stored-procedure"></a><span data-ttu-id="15bfe-149">Metodi per l'esecuzione di una chiamata a una stored procedure</span><span class="sxs-lookup"><span data-stu-id="15bfe-149">Methods of Calling a Stored Procedure</span></span>  
 <span data-ttu-id="15bfe-150">Quando si esegue un stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider OLE DB di Native Client supporta:</span><span class="sxs-lookup"><span data-stu-id="15bfe-150">When executing a stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports the:</span></span>  
  
-   <span data-ttu-id="15bfe-151">Sequenza di escape ODBC CALL.</span><span class="sxs-lookup"><span data-stu-id="15bfe-151">ODBC CALL escape sequence.</span></span>  
  
-   <span data-ttu-id="15bfe-152">Sequenza di escape RPC (Remote Procedure Call).</span><span class="sxs-lookup"><span data-stu-id="15bfe-152">Remote procedure call (RPC) escape sequence.</span></span>  
  
-   <span data-ttu-id="15bfe-153">Istruzione [!INCLUDE[tsql](../../../includes/tsql-md.md)]EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="15bfe-153">[!INCLUDE[tsql](../../../includes/tsql-md.md)] EXECUTE statement.</span></span>  
  
### <a name="odbc-call-escape-sequence"></a><span data-ttu-id="15bfe-154">Sequenza di escape ODBC CALL</span><span class="sxs-lookup"><span data-stu-id="15bfe-154">ODBC CALL Escape Sequence</span></span>  
 <span data-ttu-id="15bfe-155">Se si conoscono le informazioni sui parametri, chiamare il metodo **ICommandWithParameters::SetParameterInfo** per descrivere i parametri al provider.</span><span class="sxs-lookup"><span data-stu-id="15bfe-155">If you know parameter information, call **ICommandWithParameters::SetParameterInfo** method to describe the parameters to the provider.</span></span> <span data-ttu-id="15bfe-156">In caso contrario, quando viene utilizzata la sintassi ODBC CALL per eseguire la chiamata a una stored procedure, il provider chiama una funzione di supporto per trovare le informazioni sui parametri della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="15bfe-156">Otherwise, when the ODBC CALL syntax is used in calling a stored procedure, the provider calls a helper function to find the stored procedure parameter information.</span></span>  
  
 <span data-ttu-id="15bfe-157">Se non si è certi delle informazioni sui parametri (metadati dei parametri), è consigliata la sintassi ODBC CALL.</span><span class="sxs-lookup"><span data-stu-id="15bfe-157">If you are not sure about the parameter information (parameter metadata), ODBC CALL syntax is recommended.</span></span>  
  
 <span data-ttu-id="15bfe-158">La sintassi generale per la chiamata a una stored procedure mediante la sequenza di escape ODBC CALL è:</span><span class="sxs-lookup"><span data-stu-id="15bfe-158">The general syntax for calling a procedure by using the ODBC CALL escape sequence is:</span></span>  
  
 <span data-ttu-id="15bfe-159">{[**? =**]**chiama**_procedure_name_[**(**[*parametro*] [**,**[*parametro*]]... **)**]}</span><span class="sxs-lookup"><span data-stu-id="15bfe-159">{[**?=**]**call**_procedure_name_[**(**[*parameter*][**,**[*parameter*]]...**)**]}</span></span>  
  
 <span data-ttu-id="15bfe-160">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="15bfe-160">For example:</span></span>  
  
```  
{call SalesByCategory('Produce', '1995')}  
```  
  
### <a name="rpc-escape-sequence"></a><span data-ttu-id="15bfe-161">Sequenza di escape RPC</span><span class="sxs-lookup"><span data-stu-id="15bfe-161">RPC Escape Sequence</span></span>  
 <span data-ttu-id="15bfe-162">La sequenza di escape RPC è simile alla sintassi ODBC CALL della chiamata a una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="15bfe-162">The RPC escape sequence is similar to the ODBC CALL syntax of calling a stored procedure.</span></span> <span data-ttu-id="15bfe-163">Se si chiama la stored procedure più volte, la sequenza di escape RPC offre le massime prestazioni tra i tre metodi utilizzati per chiamare una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="15bfe-163">If you will call the procedure multiple times, the RPC escape sequence provides most optimal performance among the three methods of calling a stored procedure.</span></span>  
  
 <span data-ttu-id="15bfe-164">Quando la sequenza di escape RPC viene utilizzata per eseguire una stored procedure, il provider non chiama la funzione di supporto per determinare le informazioni sui parametri (come avviene nel caso della sintassi ODBC CALL).</span><span class="sxs-lookup"><span data-stu-id="15bfe-164">When the RPC escape sequence is used to execute a stored procedure, the provider does not call any helper function to determine the parameter information (as it does in the case of ODBC CALL syntax).</span></span> <span data-ttu-id="15bfe-165">La sintassi RPC è più semplice della sintassi ODBC CALL, pertanto il comando viene analizzato più velocemente, migliorando le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="15bfe-165">The RPC syntax is simpler than the ODBC CALL syntax, so the command is parsed faster, improving performance.</span></span> <span data-ttu-id="15bfe-166">In questo caso, è necessario fornire le informazioni sui parametri eseguendo **ICommandWithParameters::SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="15bfe-166">In this case, you need to provide the parameter information by executing **ICommandWithParameters::SetParameterInfo**.</span></span>  
  
 <span data-ttu-id="15bfe-167">Per utilizzare la sequenza di escape RPC è necessario disporre di un valore restituito.</span><span class="sxs-lookup"><span data-stu-id="15bfe-167">The RPC escape sequence requires you to have a return value.</span></span> <span data-ttu-id="15bfe-168">Se la stored procedure non restituisce un valore, il server restituisce per impostazione predefinita il valore 0.</span><span class="sxs-lookup"><span data-stu-id="15bfe-168">If the stored procedure does not return a value, the server returns a 0 by default.</span></span> <span data-ttu-id="15bfe-169">Inoltre, non è possibile aprire un cursore [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] nella stored procedure.</span><span class="sxs-lookup"><span data-stu-id="15bfe-169">In addition, you cannot open a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cursor on the stored procedure.</span></span> <span data-ttu-id="15bfe-170">La stored procedure viene preparata in modo implicito e la chiamata a **ICommandPrepare::Prepare** avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="15bfe-170">The stored procedure is prepared implicitly and the call to **ICommandPrepare::Prepare** will fail.</span></span> <span data-ttu-id="15bfe-171">A causa dell'impossibilità di preparare una chiamata RPC, non è possibile eseguire una query sui metadati delle colonne. IColumnsInfo::GetColumnInfo e IColumnsRowset::GetColumnsRowset restituiranno DB_E_NOTPREPARED.</span><span class="sxs-lookup"><span data-stu-id="15bfe-171">Because of the inability to prepare an RPC call, you can not query column metadata; IColumnsInfo::GetColumnInfo and IColumnsRowset::GetColumnsRowset will return DB_E_NOTPREPARED.</span></span>  
  
 <span data-ttu-id="15bfe-172">Se si conoscono tutti i metadati dei parametri, la sequenza di escape RPC è la modalità consigliata per eseguire le stored procedure.</span><span class="sxs-lookup"><span data-stu-id="15bfe-172">If you know all the parameter metadata, RPC escape sequence is the recommended way to execute stored procedures.</span></span>  
  
 <span data-ttu-id="15bfe-173">Di seguito viene riportato un esempio di sequenza di escape RPC per la chiamata a una stored procedure:</span><span class="sxs-lookup"><span data-stu-id="15bfe-173">This is an example of RPC escape sequence for calling a stored procedure:</span></span>  
  
```  
{rpc SalesByCategory}  
```  
  
 <span data-ttu-id="15bfe-174">Per un'applicazione di esempio che illustra una sequenza di escape RPC, vedere [Eseguire una stored procedure &#40;con la sintassi RPC&#41; ed elaborare i codici restituiti e i parametri di output &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span><span class="sxs-lookup"><span data-stu-id="15bfe-174">For a sample application that demonstrates an RPC escape sequence, see [Execute a Stored Procedure &#40;Using RPC Syntax&#41; and Process Return Codes and Output Parameters &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span></span>  
  
### <a name="transact-sql-execute-statement"></a><span data-ttu-id="15bfe-175">Istruzione Transact-SQL EXECUTE</span><span class="sxs-lookup"><span data-stu-id="15bfe-175">Transact-SQL EXECUTE Statement</span></span>  
 <span data-ttu-id="15bfe-176">La sequenza di escape ODBC CALL e la sequenza di escape RPC rappresentano i metodi preferiti per la chiamata a una stored procedure rispetto all'istruzione [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="15bfe-176">The ODBC CALL escape sequence and the RPC escape sequence are the preferred methods for calling a stored procedure rather than the [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql) statement.</span></span> <span data-ttu-id="15bfe-177">Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native client utilizza il meccanismo RPC di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per ottimizzare l'elaborazione del comando.</span><span class="sxs-lookup"><span data-stu-id="15bfe-177">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the RPC mechanism of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to optimize command processing.</span></span> <span data-ttu-id="15bfe-178">Questo protocollo RPC migliora le prestazioni riducendo l'elaborazione dei parametri e l'analisi delle istruzioni eseguite sul server.</span><span class="sxs-lookup"><span data-stu-id="15bfe-178">This RPC protocol increases performance by eliminating much of the parameter processing and statement parsing done on the server.</span></span>  
  
 <span data-ttu-id="15bfe-179">Di seguito è riportato un esempio dell'istruzione  **EXECUTE** di [!INCLUDE[tsql](../../../includes/tsql-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="15bfe-179">This is an example of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** statement:</span></span>  
  
```  
EXECUTE SalesByCategory 'Produce', '1995'  
```  
  
## <a name="see-also"></a><span data-ttu-id="15bfe-180">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="15bfe-180">See Also</span></span>  
 [<span data-ttu-id="15bfe-181">Stored procedure</span><span class="sxs-lookup"><span data-stu-id="15bfe-181">Stored Procedures</span></span>](stored-procedures.md)  
  
  
