---
title: Aggiornamento di un'applicazione da SQL Server 2005 Native Client | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: rothja
ms.author: jroth
ms.openlocfilehash: 6db02837b854d237607eba7583d204a4860906b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722720"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a><span data-ttu-id="18640-102">Aggiornamento di un'applicazione da SQL Server 2005 Native Client</span><span class="sxs-lookup"><span data-stu-id="18640-102">Updating an Application from SQL Server 2005 Native Client</span></span>
  <span data-ttu-id="18640-103">In questo argomento vengono descritte le modifiche di rilievo introdotte in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client rispetto a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18640-103">This topic discusses the breaking changes in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client since [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="18640-104">Quando si esegue l'aggiornamento da Microsoft Data Access Components (MDAC) a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, si potrebbero anche notare alcune differenze di comportamento.</span><span class="sxs-lookup"><span data-stu-id="18640-104">When you upgrade from Microsoft Data Access Components (MDAC) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, you might also see some behavior differences.</span></span> <span data-ttu-id="18640-105">Per ulteriori informazioni, vedere [aggiornamento di un'applicazione a SQL Server Native Client da MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span><span class="sxs-lookup"><span data-stu-id="18640-105">For more information, see [Updating an Application to SQL Server Native Client from MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="18640-106">Native Client 9.0 fornito con [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18640-106">Native Client 9.0 shipped with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="18640-107">Native Client 10.0 fornito con [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18640-107">Native Client 10.0 shipped with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="18640-108">Native Client 10.5 fornito con [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18640-108">Native Client 10.5 shipped with [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="18640-109">Native Client 11.0 fornito con [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] e [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18640-109">Native Client 11.0 shipped with [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] and [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="18640-110">Differenze di comportamento in SQL Server Native Client nelle versione successive a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="18640-110">Changed behavior in SQL Server Native Client Since [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>|<span data-ttu-id="18640-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="18640-111">Description</span></span>|  
|------------------------------------------------------------------------------------|-----------------|  
|<span data-ttu-id="18640-112">In OLE DB viene applicato il riempimento solo in base alla scala definita.</span><span class="sxs-lookup"><span data-stu-id="18640-112">OLE DB pads only to the defined scale.</span></span>|<span data-ttu-id="18640-113">Per le conversioni in cui i dati convertiti vengono inviati al server, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (a partire da [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) vengono inseriti zeri finali nei dati solo fino alla lunghezza massima dei valori `datetime`.</span><span class="sxs-lookup"><span data-stu-id="18640-113">For conversions where converted data is sent to the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) pads trailing zeros in data only up to the maximum length of `datetime` values.</span></span> <span data-ttu-id="18640-114">In SQL Server Native Client 9.0 viene applicato un riempimento fino a un massimo di 9 cifre.</span><span class="sxs-lookup"><span data-stu-id="18640-114">SQL Server Native Client 9.0 padded to 9 digits.</span></span>|  
|<span data-ttu-id="18640-115">Convalida di DBTYPE_DBTIMESTAMP per ICommandWithParameter::SetParameterInfo.</span><span class="sxs-lookup"><span data-stu-id="18640-115">Validate DBTYPE_DBTIMESTAMP for ICommandWithParameter::SetParameterInfo.</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="18640-116">Native Client (a partire da [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ) implementa il requisito OLE DB per *BScale* in ICommandWithParameter:: separameterinfo da impostare sulla precisione frazionaria dei secondi per DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="18640-116">Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) implements the OLE DB requirement for *bScale* in ICommandWithParameter::SetParameterInfo to be set to the fractional seconds' precision for DBTYPE_DBTIMESTAMP.</span></span>|  
|<span data-ttu-id="18640-117">Il `sp_columns` stored procedure restituisce ora **"No"** invece di **"No"** per la colonna IS_NULLABLE.</span><span class="sxs-lookup"><span data-stu-id="18640-117">The `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for the IS_NULLABLE column.</span></span>|<span data-ttu-id="18640-118">A partire da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0 ( [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] ), `sp_columns` stored procedure restituisce ora **"No"** invece di **"No"** per una colonna IS_NULLABLE.</span><span class="sxs-lookup"><span data-stu-id="18640-118">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]), `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for an IS_NULLABLE column.</span></span>|  
|<span data-ttu-id="18640-119">SQLSetDescRec, SQLBindParameter e SQLBindCol eseguono ora la verifica della coerenza.</span><span class="sxs-lookup"><span data-stu-id="18640-119">SQLSetDescRec, SQLBindParameter, and SQLBindCol now perform consistency checking.</span></span>|<span data-ttu-id="18640-120">Prima di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, l'impostazione SQL_DESC_DATA_PTR non ha provocato una verifica di coerenza per qualsiasi tipo di descrittore in SQLSetDescRec, SQLBindParameter o SQLBindCol.</span><span class="sxs-lookup"><span data-stu-id="18640-120">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, setting SQL_DESC_DATA_PTR did not cause a consistency check for any descriptor type in SQLSetDescRec, SQLBindParameter, or SQLBindCol.</span></span>|  
|<span data-ttu-id="18640-121">SQLCopyDesc ora esegue la verifica della coerenza del descrittore.</span><span class="sxs-lookup"><span data-stu-id="18640-121">SQLCopyDesc now does descriptor consistency checking.</span></span>|<span data-ttu-id="18640-122">Prima di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, SQLCopyDesc non esegue una verifica di coerenza quando il campo SQL_DESC_DATA_PTR è stato impostato su un record specifico.</span><span class="sxs-lookup"><span data-stu-id="18640-122">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLCopyDesc did not do a consistency check when the SQL_DESC_DATA_PTR field was set on a particular record.</span></span>|  
|<span data-ttu-id="18640-123">SQLGetDescRec non esegue più una verifica di coerenza del descrittore.</span><span class="sxs-lookup"><span data-stu-id="18640-123">SQLGetDescRec no longer does a descriptor consistency check.</span></span>|<span data-ttu-id="18640-124">Prima di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, SQLGetDescRec esegue una verifica di coerenza del descrittore quando è stato impostato il campo SQL_DESC_DATA_PTR.</span><span class="sxs-lookup"><span data-stu-id="18640-124">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec performed a descriptor consistency check when the SQL_DESC_DATA_PTR field was set.</span></span> <span data-ttu-id="18640-125">Tale controllo non è richiesto dalla specifica ODBC e in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) e versioni successive non viene più eseguito.</span><span class="sxs-lookup"><span data-stu-id="18640-125">This was not required by the ODBC specification and in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) and later versions, this consistency check is no longer performed.</span></span>|  
|<span data-ttu-id="18640-126">Quando la data non è inclusa nell'intervallo consentito viene restituito un errore differente.</span><span class="sxs-lookup"><span data-stu-id="18640-126">Different error returned when date is out of range.</span></span>|<span data-ttu-id="18640-127">Per il tipo `datetime`, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (a partire da [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) viene restituito un numero di errore diverso rispetto a quello restituito nelle versioni precedenti per una data non compresa nell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="18640-127">For the `datetime` type, a different error number will be returned by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) for an out-of-range date than was returned in earlier versions.</span></span><br /><br /> <span data-ttu-id="18640-128">In particolare, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 restituisce il numero 22007 per tutti i valori di anno non compresi nell'intervallo consentito nelle conversioni di stringa a `datetime`, mentre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client a partire dalla versione 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) restituisce il numero 22008 quando la data è compresa nell'intervallo supportato da `datetime2` ma esterna all'intervallo supportato da `datetime` o `smalldatetime`.</span><span class="sxs-lookup"><span data-stu-id="18640-128">Specifically, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 returned 22007 for all out of range year values in string conversions to `datetime`, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client beginning with version 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) returns 22008 when the date is within the range supported by `datetime2` but outside the range supported by `datetime` or `smalldatetime`.</span></span>|  
|<span data-ttu-id="18640-129">Il valore `datetime` tronca i secondi frazionari e non viene arrotondato se tale arrotondamento comporta la modifica del giorno.</span><span class="sxs-lookup"><span data-stu-id="18640-129">`datetime` value truncates fractional seconds and not round if rounding will change the day.</span></span>|<span data-ttu-id="18640-130">Nelle versioni precedenti a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, il client arrotonda i valori `datetime` inviati al server al valore 1/300 di un secondo più vicino.</span><span class="sxs-lookup"><span data-stu-id="18640-130">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the client behavior for `datetime` values sent to the server is to round them to nearest 1/300th of a second.</span></span> <span data-ttu-id="18640-131">A partire da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, in questo scenario si verifica il troncamento dei secondi frazionari se l'arrotondamento comporta la modifica del giorno.</span><span class="sxs-lookup"><span data-stu-id="18640-131">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, this scenario causes a truncation of fractional seconds if rounding changes the day.</span></span>|  
|<span data-ttu-id="18640-132">Possibile troncamento di secondi per il valore `datetime`.</span><span class="sxs-lookup"><span data-stu-id="18640-132">Possible trunction of seconds for `datetime` value.</span></span>|<span data-ttu-id="18640-133">In un'applicazione compilata con [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (o versioni successive) che si connette a un server [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 vengono troncati i secondi e i secondi frazionari per la porzione di tempo dei dati inviati al server se si esegue l'associazione a una colonna datetime con un identificatore di tipo DBTYPE_DBTIMESTAMP (OLE DB) o SQL_TIMESTAMP (ODBC) e una scala di 0.</span><span class="sxs-lookup"><span data-stu-id="18640-133">An application built with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (or later) that connects to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 server will truncate seconds and fractional seconds for time portion of data sent to the server if you bind to a datetime column with a type identifier of DBTYPE_DBTIMESTAMP (OLE DB) or SQL_TIMESTAMP (ODBC) and a scale of 0.</span></span><br /><br /> <span data-ttu-id="18640-134">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="18640-134">For example:</span></span><br /><br /> <span data-ttu-id="18640-135">Dati di input: 1994-08-21 21:21:36.000</span><span class="sxs-lookup"><span data-stu-id="18640-135">Input data: 1994-08-21 21:21:36.000</span></span><br /><br /> <span data-ttu-id="18640-136">Dati inseriti: 1994-08-21 21:21:00.000</span><span class="sxs-lookup"><span data-stu-id="18640-136">Inserted data: 1994-08-21 21:21:00.000</span></span>|  
|<span data-ttu-id="18640-137">La conversione dei dati OLE DB da DBTYPE_DBTIME a DBTYPE_DATE non può più causare la modifica del giorno.</span><span class="sxs-lookup"><span data-stu-id="18640-137">OLE DB data conversion from DBTYPE_DBTIME to DBTYPE_DATE no longer can cause the day to change.</span></span>|<span data-ttu-id="18640-138">Nelle versioni precedenti a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, se la parte relativa all'ora di un tipo DBTYPE_DATE è entro mezzo secondo dalla mezzanotte, il codice di conversione OLE DB causa la modifica del giorno.</span><span class="sxs-lookup"><span data-stu-id="18640-138">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, if the time part of a DBTYPE_DATE was within a half second of midnight, OLE DB conversion code caused the day to change.</span></span> <span data-ttu-id="18640-139">A partire da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, il giorno non viene modificato (i secondi frazionari vengono troncati ma non vengono arrotondati).</span><span class="sxs-lookup"><span data-stu-id="18640-139">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the day will not change (fractional seconds are truncated and not rounded).</span></span>|  
|<span data-ttu-id="18640-140">Modifiche della conversione IBCPSession::BCColFmt.</span><span class="sxs-lookup"><span data-stu-id="18640-140">IBCPSession::BCColFmt conversion changes.</span></span>|<span data-ttu-id="18640-141">A partire da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10,0, quando si usa IBCPSession:: BCOColFmt per convertire SqlDateTime o SqlDateTime in un tipo stringa, viene esportato un valore frazionario.</span><span class="sxs-lookup"><span data-stu-id="18640-141">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, when you use IBCPSession::BCOColFmt to convert SQLDATETIME or SQLDATETIME to a string type, a fractional value is exported.</span></span> <span data-ttu-id="18640-142">Quando ad esempio si converte il tipo SQLDATETIME nel tipo SQLNVARCHARMAX, le versioni precedenti di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client restituiscono</span><span class="sxs-lookup"><span data-stu-id="18640-142">For example, when converting type SQLDATETIME to type SQLNVARCHARMAX, earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client returned</span></span><br /><br /> <span data-ttu-id="18640-143">1989-02-01 00:00:00.</span><span class="sxs-lookup"><span data-stu-id="18640-143">1989-02-01 00:00:00.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="18640-144">Native Client 10.0 e versioni successive restituiscono 1989-02-01 00:00:00.0000000.</span><span class="sxs-lookup"><span data-stu-id="18640-144">Native Client 10.0 and later versions return 1989-02-01 00:00:00.0000000.</span></span>|  
|<span data-ttu-id="18640-145">Le dimensioni dei dati inviati devono corrispondere alla lunghezza specificata in SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="18640-145">Size of data sent must match length specified in SQL_LEN_DATA_AT_EXEC.</span></span>|<span data-ttu-id="18640-146">Quando si utilizza SQL_LEN_DATA_AT_EXEC, le dimensioni dei dati devono corrispondere alla lunghezza specificata con SQL_LEN_DATA_AT_EXEC.</span><span class="sxs-lookup"><span data-stu-id="18640-146">When using SQL_LEN_DATA_AT_EXEC, the size of the data must match the length that you specified with SQL_LEN_DATA_AT_EXEC.</span></span> <span data-ttu-id="18640-147">È possibile utilizzare SQL_DATA_AT_EXEC ma l'utilizzo di SQL_LEN_DATA_AT_EXEC comporta vantaggi potenziali in termini di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="18640-147">You can use SQL_DATA_AT_EXEC but there are potential performance benefits to using SQL_LEN_DATA_AT_EXEC.</span></span>|  
|<span data-ttu-id="18640-148">Le applicazioni personalizzate che utilizzano l'API BCP ora possono visualizzare un avviso.</span><span class="sxs-lookup"><span data-stu-id="18640-148">Custom applications that use the BCP API can now see a warning.</span></span>|<span data-ttu-id="18640-149">L'API BCP genererà un messaggio di avviso se la lunghezza dei dati di tutti i tipi è superiore a quella specificata per un campo.</span><span class="sxs-lookup"><span data-stu-id="18640-149">The BCP API will generate a warning message if data length is greater than the specified length for a field for all types.</span></span> <span data-ttu-id="18640-150">In precedenza, questo avviso veniva visualizzato solo per i dati di tipo carattere e non per tutti i tipi.</span><span class="sxs-lookup"><span data-stu-id="18640-150">Previously, this warning was only given for character types, but will not be issued for all types.</span></span>|  
|<span data-ttu-id="18640-151">Se si inserisce una stringa vuota in un oggetto `sql_variant` associato come tipo data/ora viene generato un errore.</span><span class="sxs-lookup"><span data-stu-id="18640-151">Inserting an empty string into a `sql_variant` bound as a date/time type generates an error.</span></span>|<span data-ttu-id="18640-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 l'inserimento di una stringa vuota in un oggetto `sql_variant` associato come tipo data/ora non genera alcun errore.</span><span class="sxs-lookup"><span data-stu-id="18640-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, inserting an empty string into a `sql_variant` bound as a date/time type did not generate an error.</span></span> <span data-ttu-id="18640-153">In questa situazione in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 e versioni successive viene correttamente generato un errore.</span><span class="sxs-lookup"><span data-stu-id="18640-153">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 (and later) correctly generates an error in this situation.</span></span>|  
|<span data-ttu-id="18640-154">Convalida dei parametri SQL_C_TYPE _TIMESTAMP e DBTYPE_DBTIMESTAMP più restrittiva.</span><span class="sxs-lookup"><span data-stu-id="18640-154">Stricter SQL_C_TYPE _TIMESTAMP and DBTYPE_DBTIMESTAMP parameter validation.</span></span>|<span data-ttu-id="18640-155">Prima di [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] native client, `datetime` i valori venivano arrotondati per adattarsi alla scala delle `datetime` `smalldatetime` colonne e in base a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="18640-155">Prior to [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` values were rounded to fit the scale of `datetime` and `smalldatetime` columns by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] <span data-ttu-id="18640-156">Native Client (e versioni successive) applica le regole di convalida più restrittive definite nella specifica ODBC per i secondi frazionari.</span><span class="sxs-lookup"><span data-stu-id="18640-156">Native Client (and later) applies the stricter validation rules that are defined in the ODBC core specification for fractional seconds.</span></span> <span data-ttu-id="18640-157">Se non è possibile convertire il valore di un parametro nel tipo SQL utilizzando la scala specificata o implicita dell'associazione client senza causare il troncamento delle cifre finali, viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="18640-157">If a parameter value cannot be converted to the SQL type by using the scale specified or implied by the client binding without truncation of trailing digits, an error is returned.</span></span>|  
|<span data-ttu-id="18640-158">Quando è in esecuzione un trigger, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] potrebbe restituire risultati diversi.</span><span class="sxs-lookup"><span data-stu-id="18640-158">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] might return different results when a trigger runs.</span></span>|<span data-ttu-id="18640-159">A causa delle modifiche introdotte in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], un'istruzione che ha causato l'esecuzione di un trigger con `NOCOUNT OFF` attivo potrebbe restituire risultati diversi a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="18640-159">Changes introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] might cause an application to have different results returned from a statement that caused a trigger to run when `NOCOUNT OFF` was in effect.</span></span> <span data-ttu-id="18640-160">In una situazione di questo tipo l'applicazione potrebbe generare un errore.</span><span class="sxs-lookup"><span data-stu-id="18640-160">In this situation, your application might generate an error.</span></span> <span data-ttu-id="18640-161">Per correggere l'errore, impostare `NOCOUNT ON` nel trigger o chiamare SQLMoreResults per passare al risultato successivo.</span><span class="sxs-lookup"><span data-stu-id="18640-161">To resolve this error, set `NOCOUNT ON` in the trigger or call SQLMoreResults to advance to the next result.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="18640-162">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="18640-162">See Also</span></span>  
 [<span data-ttu-id="18640-163">Programmazione in SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="18640-163">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
  
