---
title: Aggiornamento di un'applicazione a SQL Server Native Client da MDAC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722719"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="23bf7-102">Aggiornamento di un'applicazione da MDAC a SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="23bf7-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="23bf7-103">Esistono alcune differenze tra [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e Microsoft Data Access Components (MDAC). A partire da Windows Vista, i componenti di accesso ai dati vengono chiamati Windows Data Access Components o Windows DAC (applicazione livello dati).</span><span class="sxs-lookup"><span data-stu-id="23bf7-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="23bf7-104">Sebbene entrambe le tecnologie consentano l'accesso nativo ai dati dei database di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client è stato appositamente progettato per esporre le nuove caratteristiche di [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] pur mantenendo la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="23bf7-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="23bf7-105">In questo argomento viene illustrato come aggiornare l'applicazione MDAC (o Windows DAC) in base alla versione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client inclusa in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="23bf7-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="23bf7-106">Per rendere l'applicazione aggiornata con la versione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fornita in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] , vedere [aggiornamento di un'applicazione da SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="23bf7-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="23bf7-107">Inoltre, sebbene MDAC contenga componenti per l'utilizzo di OLE DB, ODBC e ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implementa solo OLE DB e ODBC, anche se ADO può accedere alla funzionalità di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-108">Native Client e MDAC presentano inoltre alcune differenze nelle aree seguenti:</span><span class="sxs-lookup"><span data-stu-id="23bf7-108">Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="23bf7-109">Gli utenti che utilizzano ADO per accedere a un provider di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client potrebbero riscontrare una funzionalità di filtro meno avanzata quando accedono a un provider OLE DB SQL.</span><span class="sxs-lookup"><span data-stu-id="23bf7-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="23bf7-110">Se un'applicazione ADO utilizza [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e tenta di aggiornare una colonna calcolata, viene generato un errore.</span><span class="sxs-lookup"><span data-stu-id="23bf7-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="23bf7-111">Con MDAC l'aggiornamento è stato accettato ma ignorato.</span><span class="sxs-lookup"><span data-stu-id="23bf7-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-112">Native Client è un singolo file DLL (libreria a collegamento dinamico) autonomo.</span><span class="sxs-lookup"><span data-stu-id="23bf7-112">Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="23bf7-113">Il numero di interfacce esposte pubblicamente è stato ridotto al minimo, per facilitare la distribuzione e limitare al tempo stesso i rischi legati alla sicurezza.</span><span class="sxs-lookup"><span data-stu-id="23bf7-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="23bf7-114">Sono supportate solo le interfacce OLE DB e ODBC.</span><span class="sxs-lookup"><span data-stu-id="23bf7-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="23bf7-115">Il provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e i nomi dei driver ODBC sono diversi da quelli utilizzati con MDAC.</span><span class="sxs-lookup"><span data-stu-id="23bf7-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="23bf7-116">Le funzionalità accessibili all'utente fornite dai componenti MDAC sono disponibili durante l'utilizzo di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="23bf7-117">Le più importanti sono le seguenti: pool di connessioni, supporto ADO e supporto del cursore del client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="23bf7-118">Quando una di esse viene utilizzata, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fornisce solo la connettività del database.</span><span class="sxs-lookup"><span data-stu-id="23bf7-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="23bf7-119">MDAC fornisce funzionalità come la traccia, i controlli di gestione e i contatori delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="23bf7-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="23bf7-120">Le applicazioni possono utilizzare i servizi di base di OLE DB con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ma in presenza del motore del cursore di OLE DB, è necessario selezionare l'opzione relativa alla compatibilità dei tipi di dati per evitare qualsiasi problema potenziale che potrebbe insorgere quando il motore del cursore non conosce i nuovi tipi di dati di [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="23bf7-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-121">Native Client supporta l'accesso ai database di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precedenti.</span><span class="sxs-lookup"><span data-stu-id="23bf7-121">Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-122">Native Client non include l'integrazione XML.</span><span class="sxs-lookup"><span data-stu-id="23bf7-122">Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="23bf7-123">Native Client supporta SELECT... PER le query XML, ma non supporta altre funzionalità XML.</span><span class="sxs-lookup"><span data-stu-id="23bf7-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="23bf7-124">Native client, tuttavia, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supporta il `xml` tipo di dati introdotto in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="23bf7-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-125">Native Client supporta la configurazione delle librerie di rete sul lato client utilizzando solo gli attributi della stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="23bf7-125">Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="23bf7-126">Per una configurazione delle libreria di rete più completa, è necessario utilizzare Gestione configurazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="23bf7-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-127">Native Client non è compatibile con odbcbcp.dll.</span><span class="sxs-lookup"><span data-stu-id="23bf7-127">Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="23bf7-128">Per poter utilizzare Native client, è necessario ricompilare le applicazioni che utilizzano le API ODBC e **bcp** per eseguire il collegamento con sqlncli11. lib [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="23bf7-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-129">Native Client non è supportato dal provider Microsoft OLE DB per ODBC (MSDASQL).</span><span class="sxs-lookup"><span data-stu-id="23bf7-129">Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="23bf7-130">Se si utilizza il driver MDAC SQLODBC con MSDASQL o il driver MDAC SQLODBC con ADO, utilizzare OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="23bf7-131">Le stringhe di connessione MDAC consentono un valore booleano ( `true` ) per la parola chiave **Trusted_Connection** .</span><span class="sxs-lookup"><span data-stu-id="23bf7-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="23bf7-132">Una [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stringa di connessione di Native client deve usare `yes` o **No**.</span><span class="sxs-lookup"><span data-stu-id="23bf7-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="23bf7-133">Gli avvisi e gli errori non hanno subito modifiche particolarmente rilevanti.</span><span class="sxs-lookup"><span data-stu-id="23bf7-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="23bf7-134">Quelli restituiti dal server mantengono ora lo stesso livello di gravità quando vengono passati a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="23bf7-135">Se l'intercettazione di determinati avvisi ed errori riveste un'importanza particolare, è necessario assicurarsi che l'applicazione sia stata sottoposta a test approfonditi.</span><span class="sxs-lookup"><span data-stu-id="23bf7-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-136">Native Client prevede un controllo degli errori più rigido rispetto a MDAC. Ciò significa che le applicazioni che non sono completamente conformi alle specifiche ODBC e OLE DB potrebbero avere un comportamento diverso.</span><span class="sxs-lookup"><span data-stu-id="23bf7-136">Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="23bf7-137">Il provider SQLOLEDB, ad esempio, non ha applicato la regola che i nomi dei parametri devono iniziare con ' \@ ' per i parametri del risultato, ma il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-138">Native Client e MDAC gestiscono i problemi di connessione in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="23bf7-138">Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="23bf7-139">MDAC, ad esempio, restituisce valori delle proprietà memorizzati nella cache per una connessione non riuscita, mentre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client segnala un errore all'applicazione chiamante.</span><span class="sxs-lookup"><span data-stu-id="23bf7-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-140">Native Client non genera eventi di Visual Studio Analyzer, bensì eventi di traccia di Windows.</span><span class="sxs-lookup"><span data-stu-id="23bf7-140">Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-141">Native Client non può essere utilizzato con perfmon.</span><span class="sxs-lookup"><span data-stu-id="23bf7-141">Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="23bf7-142">Perfmon è un strumento di Windows disponibile solo con i DSN che utilizzano il driver MDAC SQLODBC incluso in Windows.</span><span class="sxs-lookup"><span data-stu-id="23bf7-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="23bf7-143">Quando [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client è connesso a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive, l'errore del server 16947 viene restituito come SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="23bf7-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="23bf7-144">Tale errore si verifica quando tramite un'eliminazione o un aggiornamento posizionato non è possibile aggiornare o eliminare una riga.</span><span class="sxs-lookup"><span data-stu-id="23bf7-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="23bf7-145">Con MDAC, in caso di connessione a una versione qualsiasi di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], l'errore del server 16947 viene restituito come avviso (SQL_SUCCESS_WITH_INFO).</span><span class="sxs-lookup"><span data-stu-id="23bf7-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="23bf7-146">Native Client implementa l'interfaccia **IDBDataSourceAdmin** , che è un'interfaccia OLE DB facoltativa che non è stata implementata in precedenza, ma viene implementato solo il metodo **CreateDataSource** di questa interfaccia facoltativa.</span><span class="sxs-lookup"><span data-stu-id="23bf7-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="23bf7-147">Il provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client restituisce sinonimi nei set di righe degli schemi TABLES e TABLE_INFO, con TABLE_TYPE impostato su SYNONYM.</span><span class="sxs-lookup"><span data-stu-id="23bf7-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="23bf7-148">I valori restituiti del tipo di dati,,, `varchar(max)` `nvarchar(max)` `varbinary(max)` `xml` , `udt` o altri tipi di oggetti di grandi dimensioni non possono essere restituiti alle versioni client precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="23bf7-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="23bf7-149">Se si desidera utilizzare questi tipi come valori restituiti, è necessario utilizzare [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="23bf7-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="23bf7-150">A differenza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, MDAC consente l'esecuzione delle istruzioni seguenti all'inizio delle transazioni manuali e implicite.</span><span class="sxs-lookup"><span data-stu-id="23bf7-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="23bf7-151">L'esecuzione deve avvenire in modalità autocommit.</span><span class="sxs-lookup"><span data-stu-id="23bf7-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="23bf7-152">Tutte le operazioni full-text (DLL indice e catalogo)</span><span class="sxs-lookup"><span data-stu-id="23bf7-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="23bf7-153">Tutte le operazioni del database (creazione, modifica ed eliminazione del database)</span><span class="sxs-lookup"><span data-stu-id="23bf7-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="23bf7-154">Riconfigurare</span><span class="sxs-lookup"><span data-stu-id="23bf7-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="23bf7-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="23bf7-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="23bf7-156">Kill</span><span class="sxs-lookup"><span data-stu-id="23bf7-156">Kill</span></span>  
  
    -   <span data-ttu-id="23bf7-157">Backup</span><span class="sxs-lookup"><span data-stu-id="23bf7-157">Backup</span></span>  
  
-   <span data-ttu-id="23bf7-158">Quando le applicazioni MDAC si connettono a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], i tipi di dati introdotti in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] vengono visualizzati come tipi di dati compatibili con [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], come mostrato nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="23bf7-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="23bf7-159">Tipo di SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="23bf7-159">SQL Server 2005 type</span></span>|<span data-ttu-id="23bf7-160">Tipo di SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="23bf7-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="23bf7-161">Questo mapping dei tipi influisce sui valori restituiti per i metadati delle colonne.</span><span class="sxs-lookup"><span data-stu-id="23bf7-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="23bf7-162">Una colonna, ad esempio, `text` ha una dimensione massima di 2.147.483.647, ma [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client ODBC riporta le dimensioni massime delle `varchar(max)` colonne come SQL_SS_LENGTH_UNLIMITED e [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client OLE DB riporta le dimensioni massime delle `varchar(max)` colonne 2.147.483.647 o-1, a seconda della piattaforma.</span><span class="sxs-lookup"><span data-stu-id="23bf7-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="23bf7-163">Native Client supporta l'ambiguità nelle stringhe di connessione. In pratica, alcune parole chiave possono essere specificate più volte e, qualora siano in conflitto, viene adottata una risoluzione basata sulla posizione o sulla precedenza per garantire la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="23bf7-163">Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="23bf7-164">È possibile che nelle versioni successive di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tale ambiguità non sia più supportata.</span><span class="sxs-lookup"><span data-stu-id="23bf7-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="23bf7-165">Quando si modificano le applicazioni, è consigliabile utilizzare [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client per eliminare l'eventuale dipendenza dall'ambiguità delle stringhe di connessione.</span><span class="sxs-lookup"><span data-stu-id="23bf7-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="23bf7-166">Se si utilizza una chiamata ODBC o OLE DB per avviare le transazioni, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e MDAC presentano un comportamento diverso. Con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client le transazioni hanno inizio immediatamente, mentre con MDC si attende il primo accesso al database.</span><span class="sxs-lookup"><span data-stu-id="23bf7-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="23bf7-167">Questo può influire sul comportamento di stored procedure e batch perché [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] richiede che \@ \@ TRANCOUNT sia lo stesso dopo il completamento dell'esecuzione di un batch o stored procedure al momento dell'avvio del batch o della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="23bf7-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="23bf7-168">Con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client, ITransactionLocal:: BeginTransaction provocherà immediatamente l'avvio di una transazione.</span><span class="sxs-lookup"><span data-stu-id="23bf7-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="23bf7-169">Con MDAC l'avvio della transazione viene ritardato fino all'esecuzione da parte dell'applicazione di un'istruzione che ha richiesto una transazione in modalità implicita.</span><span class="sxs-lookup"><span data-stu-id="23bf7-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="23bf7-170">Per ulteriori informazioni, vedere [SET IMPLICIT_TRANSACTIONS &#40;&#41;Transact-SQL ](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="23bf7-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="23bf7-171">È possibile che si verifichino errori quando si utilizza [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] il driver native client con System. Data. ODBC per accedere a un [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] computer server che espone nuove [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] funzionalità o tipi di dati specifici di.</span><span class="sxs-lookup"><span data-stu-id="23bf7-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="23bf7-172">System. Data. ODBC fornisce un'implementazione ODBC generica e successivamente non espone funzionalità o estensioni specifiche del fornitore.</span><span class="sxs-lookup"><span data-stu-id="23bf7-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="23bf7-173">(Il [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Il driver di Native client viene aggiornato per supportare in modo nativo le funzionalità più recenti [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] . Per aggirare questo problema, è possibile ripristinare MDAC o eseguire la migrazione a System. Data. SqlClient.</span><span class="sxs-lookup"><span data-stu-id="23bf7-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="23bf7-174">Sia [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client che MDAC supportano l'isolamento delle transazioni Read Committed mediante il controllo delle versioni delle righe, ma solo [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supporta l'isolamento delle transazioni snapshot.</span><span class="sxs-lookup"><span data-stu-id="23bf7-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="23bf7-175">In termini di programmazione, l'isolamento della transazione Read Committed mediante il controllo delle versioni delle righe equivale a una transazione Read Committed.</span><span class="sxs-lookup"><span data-stu-id="23bf7-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="23bf7-176">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="23bf7-176">See Also</span></span>  
 [<span data-ttu-id="23bf7-177">Compilazione di applicazioni con SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="23bf7-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
