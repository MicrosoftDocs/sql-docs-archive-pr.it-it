---
title: Ambiente host CLR | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- type-safe code [CLR integration]
- UNSAFE permission set
- run-time environments [CLR integration]
- common language runtime [SQL Server], about CLR integration
- application domains [CLR integration]
- host protection attributes [CLR integration]
- managed code [SQL Server], common language runtime
- permission sets [CLR integration]
- reliability [CLR integration]
- SAFE permission set
- code access security [CLR integration]
- EXTERNAL_ACCESS permission set
- verifying type safety
- scalability [CLR integration]
- hosted environments [CLR integration]
- HPAs [CLR integration]
ms.assetid: d280d359-08f0-47b5-a07e-67dd2a58ad73
author: rothja
ms.author: jroth
ms.openlocfilehash: bd04536d1dfb8a4657fbe116cdfd38a6639a6327
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87720027"
---
# <a name="clr-hosted-environment"></a><span data-ttu-id="964d3-102">Ambiente CLR</span><span class="sxs-lookup"><span data-stu-id="964d3-102">CLR Hosted Environment</span></span>
  <span data-ttu-id="964d3-103">CLR (Common Language Runtime) di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework è un ambiente che esegue molti linguaggi di programmazione attuali, inclusi [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic e [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="964d3-103">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework common language runtime (CLR) is an environment that executes many modern programming languages, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic, and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="964d3-104">CLR include memoria sottoposta a Garbage Collection, threading preemptive, Servizio metadati (riflessione dei tipi), verificabilità del codice e sicurezza dall'accesso di codice.</span><span class="sxs-lookup"><span data-stu-id="964d3-104">The CLR features garbage-collected memory, pre-emptive threading, metadata services (type reflection), code verifiability, and code access security.</span></span> <span data-ttu-id="964d3-105">CLR utilizza metadati per individuare e caricare classi, disporre istanze in memoria, risolvere chiamate a metodi, generare codice nativo, implementare la sicurezza e impostare limiti di contesto per la fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="964d3-105">The CLR uses metadata to locate and load classes, lay out instances in memory, resolve method invocations, generate native code, enforce security, and set run-time context boundaries.</span></span>  
  
 <span data-ttu-id="964d3-106">CLR e [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] differiscono come ambienti di esecuzione nelle modalità di gestione di memoria, thread e sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-106">The CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] differ as run-time environments in the way they handle memory, threads, and synchronization.</span></span> <span data-ttu-id="964d3-107">In questo argomento viene descritta l'integrazione tra questi due ambienti di esecuzione per consentire la gestione uniforme di tutte le risorse di sistema.</span><span class="sxs-lookup"><span data-stu-id="964d3-107">This topic describes the way in which these two run times are integrated so that all system resources are managed uniformly.</span></span> <span data-ttu-id="964d3-108">In questo argomento viene inoltre descritta l'integrazione tra la sicurezza dall'accesso di codice di CLR e la sicurezza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per fornire un ambiente di esecuzione affidabile e protetto per il codice utente.</span><span class="sxs-lookup"><span data-stu-id="964d3-108">This topic also covers the way in which CLR code access security (CAS) and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security are integrated to provide a reliable and secure execution environment for user code.</span></span>  
  
## <a name="basic-concepts-of-clr-architecture"></a><span data-ttu-id="964d3-109">Concetti di base dell'architettura CLR</span><span class="sxs-lookup"><span data-stu-id="964d3-109">Basic Concepts of CLR Architecture</span></span>  
 <span data-ttu-id="964d3-110">In .NET Framework un programmatore scrive in un linguaggio di alto livello che implementa una classe definendone la struttura, ad esempio i campi o le proprietà della classe, e i metodi.</span><span class="sxs-lookup"><span data-stu-id="964d3-110">In the .NET Framework, a programmer writes in a high-level language that implements a class defining its structure (for example, the fields or properties of the class) and methods.</span></span> <span data-ttu-id="964d3-111">Alcuni di questi metodi possono essere funzioni statiche.</span><span class="sxs-lookup"><span data-stu-id="964d3-111">Some of these methods can be static functions.</span></span> <span data-ttu-id="964d3-112">La compilazione del programma produce un file denominato assembly che contiene il codice compilato in MSIL ([!INCLUDE[msCoName](../../../includes/msconame-md.md)] Intermediate Language) e un manifesto che contiene tutti i riferimenti agli assembly dipendenti.</span><span class="sxs-lookup"><span data-stu-id="964d3-112">The compilation of the program produces a file called an assembly that contains the compiled code in the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language (MSIL), and a manifest that contains all references to dependent assemblies.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="964d3-113">Gli assembly sono un elemento essenziale nell'architettura di CLR,</span><span class="sxs-lookup"><span data-stu-id="964d3-113">Assemblies are a vital element in the architecture of the CLR.</span></span> <span data-ttu-id="964d3-114">in quanto costituiscono le unità di compressione, distribuzione e controllo delle versioni del codice dell'applicazione in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="964d3-114">They are the units of packaging, deployment, and versioning of application code in the .NET Framework.</span></span> <span data-ttu-id="964d3-115">Utilizzando gli assembly è possibile distribuire codice dell'applicazione nel database e garantire un metodo uniforme per amministrare, eseguire il backup e ripristinare applicazioni di database complete.</span><span class="sxs-lookup"><span data-stu-id="964d3-115">Using assemblies, you can deploy application code inside the database and provide a uniform way to administer, back up, and restore complete database applications.</span></span>  
  
 <span data-ttu-id="964d3-116">Il manifesto dell'assembly contiene metadati sull'assembly che descrivono tutti i campi, le strutture, le proprietà, le classi, le relazioni di ereditarietà, le funzioni e i metodi definiti nel programma.</span><span class="sxs-lookup"><span data-stu-id="964d3-116">The assembly manifest contains metadata about the assembly, describing all of the structures, fields, properties, classes, inheritance relationships, functions, and methods defined in the program.</span></span> <span data-ttu-id="964d3-117">Il manifesto consente di stabilire l'identità dell'assembly, di specificare i file che costituiscono l'implementazione dell'assembly, di specificare i tipi e le risorse che compongono l'assembly, di rilevare le dipendenze in fase di compilazione da altri assembly e di specificare il set di autorizzazioni necessarie per la corretta esecuzione dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="964d3-117">The manifest establishes the assembly identity, specifies the files that make up the assembly implementation, specifies the types and resources that make up the assembly, itemizes the compile-time dependencies on other assemblies, and specifies the set of permissions required for the assembly to run properly.</span></span> <span data-ttu-id="964d3-118">Queste informazioni vengono utilizzate in fase di esecuzione per risolvere i riferimenti, applicare i criteri di associazione delle versioni e convalidare l'integrità degli assembly caricati.</span><span class="sxs-lookup"><span data-stu-id="964d3-118">This information is used at run time to resolve references, enforce version binding policy, and validate the integrity of loaded assemblies.</span></span>  
  
 <span data-ttu-id="964d3-119">.NET Framework supporta attributi personalizzati per l'annotazione di classi, proprietà, funzioni e metodi con informazioni aggiuntive che l'applicazione può acquisire nei metadati.</span><span class="sxs-lookup"><span data-stu-id="964d3-119">The .NET Framework supports custom attributes for annotating classes, properties, functions, and methods with additional information the application may capture in metadata.</span></span> <span data-ttu-id="964d3-120">Tutti i compilatori di .NET Framework utilizzano tali annotazioni senza interpretazione e le archiviano come metadati dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="964d3-120">All .NET Framework compilers consume these annotations without interpretation and store them as assembly metadata.</span></span> <span data-ttu-id="964d3-121">Le annotazioni possono essere esaminate allo stesso modo di tutti gli altri metadati.</span><span class="sxs-lookup"><span data-stu-id="964d3-121">These annotations can be examined in the same way as any other metadata.</span></span>  
  
 <span data-ttu-id="964d3-122">Il codice gestito viene eseguito da MSIL in CLR anziché direttamente dal sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="964d3-122">Managed code is MSIL executed in the CLR, rather than directly by the operating system.</span></span> <span data-ttu-id="964d3-123">Le applicazioni con codice gestito acquisiscono i servizi CLR, quali operazioni automatiche di Garbage Collection, controllo dei tipi in fase di esecuzione, supporto della sicurezza e così via.</span><span class="sxs-lookup"><span data-stu-id="964d3-123">Managed code applications acquire CLR services, such as automatic garbage collection, run-time type checking, and security support.</span></span> <span data-ttu-id="964d3-124">Tali servizi consentono di garantire un comportamento uniforme e indipendente dalla piattaforma e dalla lingua per le applicazioni con codice gestito.</span><span class="sxs-lookup"><span data-stu-id="964d3-124">These services help provide uniform platform- and language-independent behavior of managed code applications.</span></span>  
  
## <a name="design-goals-of-clr-integration"></a><span data-ttu-id="964d3-125">Obiettivi di progettazione dell'integrazione CLR</span><span class="sxs-lookup"><span data-stu-id="964d3-125">Design Goals of CLR Integration</span></span>  
 <span data-ttu-id="964d3-126">Quando il codice utente viene eseguito nell'ambiente CLR in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], caratteristica denominata integrazione CLR, si applicano gli obiettivi di progettazione seguenti:</span><span class="sxs-lookup"><span data-stu-id="964d3-126">When user code runs inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (called CLR integration), the following design goals apply:</span></span>  
  
###### <a name="reliability-safety"></a><span data-ttu-id="964d3-127">Affidabilità (protezione)</span><span class="sxs-lookup"><span data-stu-id="964d3-127">Reliability (Safety)</span></span>  
 <span data-ttu-id="964d3-128">Il codice utente non deve essere in grado di eseguire operazioni che danneggiano l'integrità dell'elaborazione del Motore di database, quali la visualizzazione di una finestra di messaggio popup in cui viene richiesta una risposta dell'utente o l'uscita dal processo.</span><span class="sxs-lookup"><span data-stu-id="964d3-128">User code should not be allowed to perform operations that compromise the integrity of the Database Engine process, such as popping a message box requesting a user response or exiting the process.</span></span> <span data-ttu-id="964d3-129">Il codice utente non deve essere in grado di sovrascrivere i buffer di memoria del Motore di database o le strutture di dati interne.</span><span class="sxs-lookup"><span data-stu-id="964d3-129">User code should not be able to overwrite Database Engine memory buffers or internal data structures.</span></span>  
  
###### <a name="scalability"></a><span data-ttu-id="964d3-130">Scalabilità</span><span class="sxs-lookup"><span data-stu-id="964d3-130">Scalability</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-131">e CLR dispongono di modelli interni diversi per la pianificazione e la gestione della memoria.</span><span class="sxs-lookup"><span data-stu-id="964d3-131">and the CLR have different internal models for scheduling and memory management.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-132">supporta un modello di threading cooperativo in modalità non preemptive in cui i thread producono volontariamente l'esecuzione con frequenza periodica o quando sono in attesa di blocchi o I/O.</span><span class="sxs-lookup"><span data-stu-id="964d3-132">supports a cooperative, non-preemptive threading model in which the threads voluntarily yield execution periodically, or when they are waiting on locks or I/O.</span></span> <span data-ttu-id="964d3-133">CLR supporta un modello di threading preemptive.</span><span class="sxs-lookup"><span data-stu-id="964d3-133">The CLR supports a preemptive threading model.</span></span> <span data-ttu-id="964d3-134">Se il codice utente in esecuzione in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] può chiamare direttamente le primitive di threading del sistema operativo, non si integra in modo soddisfacente nell'Utilità di pianificazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e può influire negativamente sulla scalabilità del sistema.</span><span class="sxs-lookup"><span data-stu-id="964d3-134">If user code running inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can directly call the operating system threading primitives, then it does not integrate well into the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] task scheduler and can degrade the scalability of the system.</span></span> <span data-ttu-id="964d3-135">CLR non distingue tra memoria virtuale e fisica, mentre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] gestisce direttamente la memoria fisica e deve utilizzarla entro un limite configurabile.</span><span class="sxs-lookup"><span data-stu-id="964d3-135">The CLR does not distinguish between virtual and physical memory, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] directly manages physical memory and is required to use physical memory within a configurable limit.</span></span>  
  
 <span data-ttu-id="964d3-136">I modelli diversi per threading, pianificazione e gestione della memoria presentano una sfida di integrazione per un sistema di gestione di database relazionali (RDBMS) con scalabilità in grado di supportare migliaia di sessioni utente simultanee.</span><span class="sxs-lookup"><span data-stu-id="964d3-136">The different models for threading, scheduling, and memory management present an integration challenge for a relational database management system (RDBMS) that scales to support thousands of concurrent user sessions.</span></span> <span data-ttu-id="964d3-137">L'architettura deve garantire che la scalabilità del sistema non venga danneggiata dal codice utente che chiama direttamente le API per le primitive di threading, memoria e sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-137">The architecture should ensure that the scalability of the system is not compromised by user code calling application programming interfaces (APIs) for threading, memory, and synchronization primitives directly.</span></span>  
  
###### <a name="security"></a><span data-ttu-id="964d3-138">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="964d3-138">Security</span></span>  
 <span data-ttu-id="964d3-139">Il codice utente in esecuzione nel database deve essere conforme alle regole di autenticazione e autorizzazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in caso di accesso a oggetti di database, quali tabelle e colonne.</span><span class="sxs-lookup"><span data-stu-id="964d3-139">User code running in the database must follow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] authentication and authorization rules when accessing database objects such as tables and columns.</span></span> <span data-ttu-id="964d3-140">Gli amministratori del database, inoltre, devono essere in grado di controllare l'accesso alle risorse del sistema operativo, ad esempio file e accesso di rete, dal codice utente in esecuzione nel database.</span><span class="sxs-lookup"><span data-stu-id="964d3-140">In addition, database administrators should be able to control access to operating system resources, such as files and network access, from user code running in the database.</span></span> <span data-ttu-id="964d3-141">Questo aspetto è importante in quanto i linguaggi di programmazione gestita, diversamente dai linguaggi non gestiti come Transact-SQL, forniscono API per accedere a tali risorse.</span><span class="sxs-lookup"><span data-stu-id="964d3-141">This becomes important as managed programming languages (unlike non-managed languages such as Transact-SQL) provide APIs to access such resources.</span></span> <span data-ttu-id="964d3-142">Il sistema deve fornire un metodo protetto che consenta al codice utente di accedere alle risorse del computer al di fuori dell'elaborazione del [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-142">The system must provide a secure way for user code to access machine resources outside the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] process.</span></span> <span data-ttu-id="964d3-143">Per altre informazioni, vedere [Sicurezza per l'integrazione con CLR](security/clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="964d3-143">For more information, see [CLR Integration Security](security/clr-integration-security.md).</span></span>  
  
###### <a name="performance"></a><span data-ttu-id="964d3-144">Prestazioni</span><span class="sxs-lookup"><span data-stu-id="964d3-144">Performance</span></span>  
 <span data-ttu-id="964d3-145">Il codice utente gestito in esecuzione nel [!INCLUDE[ssDE](../../../includes/ssde-md.md)] deve offrire prestazioni computazionali analoghe allo stesso codice eseguito al di fuori del server.</span><span class="sxs-lookup"><span data-stu-id="964d3-145">Managed user code running in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] should have computational performance comparable to the same code run outside the server.</span></span> <span data-ttu-id="964d3-146">L'accesso ai database dal codice utente gestito non è rapido quanto [!INCLUDE[tsql](../../../includes/tsql-md.md)] nativo.</span><span class="sxs-lookup"><span data-stu-id="964d3-146">Database access from managed user code is not as fast as native [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="964d3-147">Per ulteriori informazioni, vedere [prestazioni dell'integrazione CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="964d3-147">For more information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="clr-services"></a><span data-ttu-id="964d3-148">CLR Services</span><span class="sxs-lookup"><span data-stu-id="964d3-148">CLR Services</span></span>  
 <span data-ttu-id="964d3-149">CLR fornisce un numero di servizi che semplificano la realizzazione degli obiettivi di progettazione dell'integrazione CLR con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-149">The CLR provides a number of services to help achieve the design goals of CLR integration with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
###### <a name="type-safety-verification"></a><span data-ttu-id="964d3-150">Verifica dell'indipendenza dai tipi</span><span class="sxs-lookup"><span data-stu-id="964d3-150">Type safety verification</span></span>  
 <span data-ttu-id="964d3-151">Il codice indipendente dai tipi è un codice che accede alle strutture di memoria solo in modalità ben definite.</span><span class="sxs-lookup"><span data-stu-id="964d3-151">Type-safe code is code that accesses memory structures only in well-defined ways.</span></span> <span data-ttu-id="964d3-152">Dato un riferimento a un oggetto valido, ad esempio, il codice indipendente dai tipi può accedere alla memoria solo a offset fissi corrispondenti ai membri di campo effettivi.</span><span class="sxs-lookup"><span data-stu-id="964d3-152">For example, given a valid object reference, type-safe code can access memory at fixed offsets corresponding to actual field members.</span></span> <span data-ttu-id="964d3-153">Se, tuttavia, il codice accede alla memoria a offset arbitrari interni o esterni all'intervallo di memoria dell'oggetto, non si tratta di codice indipendente dai tipi.</span><span class="sxs-lookup"><span data-stu-id="964d3-153">However, if the code accesses memory at arbitrary offsets inside or outside the range of memory that belongs to the object, then it is not type-safe.</span></span> <span data-ttu-id="964d3-154">Quando gli assembly vengono caricati in CLR, prima che MSIL venga compilato tramite compilazione JIT (Just-In-Time), il runtime esegue una fase di verifica che esamina il codice per determinarne l'indipendenza dai tipi.</span><span class="sxs-lookup"><span data-stu-id="964d3-154">When assemblies are loaded in the CLR, prior to the MSIL being compiled using just-in-time (JIT) compilation, the runtime performs a verification phase that examines code to determine its type-safety.</span></span> <span data-ttu-id="964d3-155">Il codice che supera correttamente questa verifica viene denominato codice effettivamente indipendente dai tipi.</span><span class="sxs-lookup"><span data-stu-id="964d3-155">Code that successfully passes this verification is called verifiably type-safe code.</span></span>  
  
###### <a name="application-domains"></a><span data-ttu-id="964d3-156">Domini applicazione</span><span class="sxs-lookup"><span data-stu-id="964d3-156">Application domains</span></span>  
 <span data-ttu-id="964d3-157">CLR supporta il concetto di domini applicazione come aree di esecuzione all'interno di un processo host in cui è possibile caricare ed eseguire assembly di codice gestito.</span><span class="sxs-lookup"><span data-stu-id="964d3-157">The CLR supports the notion of application domains as execution zones within a host process where managed code assemblies can be loaded and executed.</span></span> <span data-ttu-id="964d3-158">Il confine del dominio applicazione fornisce isolamento tra assembly.</span><span class="sxs-lookup"><span data-stu-id="964d3-158">The application domain boundary provides isolation between assemblies.</span></span> <span data-ttu-id="964d3-159">Gli assembly sono isolati in termini di visibilità di variabili statiche e membri di dati e di possibilità di chiamare codice dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="964d3-159">The assemblies are isolated in terms of visibility of static variables and data members and the ability to call code dynamically.</span></span> <span data-ttu-id="964d3-160">I domini applicazione costituiscono inoltre il meccanismo per caricare e scaricare codice.</span><span class="sxs-lookup"><span data-stu-id="964d3-160">Application domains are also the mechanism for loading and unloading code.</span></span> <span data-ttu-id="964d3-161">Il codice può essere scaricato dalla memoria solo scaricando il dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-161">Code can be unloaded from memory only by unloading the application domain.</span></span> <span data-ttu-id="964d3-162">Per ulteriori informazioni, vedere [domini applicazione e sicurezza](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md)per l'integrazione con CLR.</span><span class="sxs-lookup"><span data-stu-id="964d3-162">For more information, see [Application Domains and CLR Integration Security](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span></span>  
  
###### <a name="code-access-security-cas"></a><span data-ttu-id="964d3-163">Sicurezza dall'accesso di codice (CAS, Code Access Security)</span><span class="sxs-lookup"><span data-stu-id="964d3-163">Code Access Security (CAS)</span></span>  
 <span data-ttu-id="964d3-164">Il sistema di sicurezza CLR fornisce un metodo per determinare i possibili tipi di operazioni eseguite dal codice gestito tramite l'assegnazione di autorizzazioni al codice.</span><span class="sxs-lookup"><span data-stu-id="964d3-164">The CLR security system provides a way to control what kinds of operations managed code can perform by assigning permissions to code.</span></span> <span data-ttu-id="964d3-165">Le autorizzazioni di accesso per il codice vengono assegnate in base all'identità del codice, ad esempio la firma dell'assembly o l'origine del codice.</span><span class="sxs-lookup"><span data-stu-id="964d3-165">Code access permissions are assigned based on code identity (for example, the signature of the assembly or the origin of the code).</span></span>  
  
 <span data-ttu-id="964d3-166">CLR fornisce criteri a livello di computer che possono essere impostati dall'amministratore del computer.</span><span class="sxs-lookup"><span data-stu-id="964d3-166">The CLR provides for a computer-wide policy that can be set by the computer administrator.</span></span> <span data-ttu-id="964d3-167">Tali criteri definiscono le autorizzazioni concesse per qualsiasi codice gestito in esecuzione nel computer.</span><span class="sxs-lookup"><span data-stu-id="964d3-167">This policy defines the permission grants for any managed code running on the machine.</span></span> <span data-ttu-id="964d3-168">Vi sono inoltre criteri di sicurezza a livello di host che possono essere utilizzati dagli host, ad esempio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], per specificare restrizioni aggiuntive per il codice gestito.</span><span class="sxs-lookup"><span data-stu-id="964d3-168">In addition, there is a host-level security policy that can be used by hosts such as [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to specify additional restrictions on managed code.</span></span>  
  
 <span data-ttu-id="964d3-169">Se un'API gestita in .NET Framework espone operazioni in risorse protette da un'autorizzazione di accesso per il codice, l'API richiederà tale autorizzazione prima di accedere alla risorsa.</span><span class="sxs-lookup"><span data-stu-id="964d3-169">If a managed API in the .NET Framework exposes operations on resources that are protected by a code access permission, the API will demand that permission before accessing the resource.</span></span> <span data-ttu-id="964d3-170">Questa richiesta fa in modo che il sistema di sicurezza CLR attivi un controllo completo di ogni unità di codice (assembly) nello stack di chiamate.</span><span class="sxs-lookup"><span data-stu-id="964d3-170">This demand causes the CLR security system to trigger a comprehensive check of every unit of code (assembly) in the call stack.</span></span> <span data-ttu-id="964d3-171">Verrà concesso l'accesso alla risorsa solo se l'intera sequenza delle chiamate dispone dell'autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-171">Only if the entire call chain has permission will access to the resource be granted.</span></span>  
  
 <span data-ttu-id="964d3-172">Si noti che la possibilità di generare dinamicamente codice gestito tramite l'API Reflection.Emit non è supportata all'interno dell'ambiente CLR in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-172">Note that the ability to generate managed code dynamically, using the Reflection.Emit API, is not supported inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="964d3-173">Tale codice non disporrebbe delle autorizzazioni di protezione dall'accesso di codice per l'esecuzione e avrebbe quindi esito negativo in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="964d3-173">Such code would not have the CAS permissions to run and would therefore fail at run time.</span></span> <span data-ttu-id="964d3-174">Per altre informazioni, vedere [sicurezza dall'accesso di codice per l'integrazione con CLR](security/clr-integration-code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="964d3-174">For more information, see [CLR Integration Code Access Security](security/clr-integration-code-access-security.md).</span></span>  
  
###### <a name="host-protection-attributes-hpas"></a><span data-ttu-id="964d3-175">Attributi di protezione host</span><span class="sxs-lookup"><span data-stu-id="964d3-175">Host Protection Attributes (HPAs)</span></span>  
 <span data-ttu-id="964d3-176">CLR fornisce un meccanismo per annotare API gestite che fanno parte di .NET Framework con determinati attributi che possono interessare un host di CLR.</span><span class="sxs-lookup"><span data-stu-id="964d3-176">The CLR provides a mechanism to annotate managed APIs that are part of the .NET Framework with certain attributes that may be of interest to a host of the CLR.</span></span> <span data-ttu-id="964d3-177">Tra gli esempi di tali attributi sono inclusi i seguenti:</span><span class="sxs-lookup"><span data-stu-id="964d3-177">Examples of such attributes include:</span></span>  
  
-   <span data-ttu-id="964d3-178">SharedState, che indica se l'API espone la possibilità di creare o gestire stato condiviso, ad esempio campi classe statici.</span><span class="sxs-lookup"><span data-stu-id="964d3-178">SharedState, which indicates whether the API exposes the ability to create or manage shared state (for example, static class fields).</span></span>  
  
-   <span data-ttu-id="964d3-179">Synchronization, che indica se l'API espone la possibilità di eseguire la sincronizzazione tra thread.</span><span class="sxs-lookup"><span data-stu-id="964d3-179">Synchronization, which indicates whether the API exposes the ability to perform synchronization between threads.</span></span>  
  
-   <span data-ttu-id="964d3-180">ExternalProcessMgmt, che indica se l'API espone una modalità per controllare il processo host.</span><span class="sxs-lookup"><span data-stu-id="964d3-180">ExternalProcessMgmt, which indicates whether the API exposes a way to control the host process.</span></span>  
  
 <span data-ttu-id="964d3-181">Tramite questi attributi l'host può specificare un elenco di attributi di protezione host, ad esempio l'attributo SharedState, che non devono essere consentiti nell'ambiente host.</span><span class="sxs-lookup"><span data-stu-id="964d3-181">Given these attributes, the host can specify a list of HPAs, such as the SharedState attribute, that should be disallowed in the hosted environment.</span></span> <span data-ttu-id="964d3-182">In tal caso, CLR rifiuta i tentativi da parte del codice utente di chiamare API annotate tramite attributi di protezione host inclusi nell'elenco degli attributi non consentiti.</span><span class="sxs-lookup"><span data-stu-id="964d3-182">In this case, the CLR denies attempts by user code to call APIs that are annotated by the HPAs in the prohibited list.</span></span> <span data-ttu-id="964d3-183">Per ulteriori informazioni, vedere [attributi di protezione host e programmazione dell'integrazione con CLR](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span><span class="sxs-lookup"><span data-stu-id="964d3-183">For more information, see [Host Protection Attributes and CLR Integration Programming](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span></span>  
  
## <a name="how-sql-server-and-the-clr-work-together"></a><span data-ttu-id="964d3-184">Funzionamento dell'integrazione tra SQL Server e CLR</span><span class="sxs-lookup"><span data-stu-id="964d3-184">How SQL Server and the CLR Work Together</span></span>  
 <span data-ttu-id="964d3-185">In questa sezione viene illustrata l'integrazione in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dei modelli di threading, di pianificazione, di sincronizzazione e di gestione della memoria di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e CLR.</span><span class="sxs-lookup"><span data-stu-id="964d3-185">This section discusses how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integrates the threading, scheduling, synchronization, and memory management models of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR.</span></span> <span data-ttu-id="964d3-186">In particolare, in questa sezione viene esaminata l'integrazione alla luce di obiettivi di scalabilità, affidabilità e sicurezza.</span><span class="sxs-lookup"><span data-stu-id="964d3-186">In particular, this section examines the integration in light of scalability, reliability, and security goals.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-187">essenzialmente è utilizzato come sistema operativo per CLR quando è ospitato in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-187">essentially acts as the operating system for the CLR when it is hosted inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="964d3-188">CLR chiama routine di basso livello implementate da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per il threading, la pianificazione, la sincronizzazione e la gestione della memoria.</span><span class="sxs-lookup"><span data-stu-id="964d3-188">The CLR calls low-level routines implemented by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for threading, scheduling, synchronization, and memory management.</span></span> <span data-ttu-id="964d3-189">Si tratta delle stesse primitive utilizzate dal resto del motore di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-189">These are the same primitives that the rest of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine uses.</span></span> <span data-ttu-id="964d3-190">Questo approccio offre diversi vantaggi correlati a scalabilità, affidabilità e sicurezza.</span><span class="sxs-lookup"><span data-stu-id="964d3-190">This approach provides several scalability, reliability, and security benefits.</span></span>  
  
###### <a name="scalability-common-threading-scheduling-and-synchronization"></a><span data-ttu-id="964d3-191">Scalabilità: threading, pianificazione e sincronizzazione comuni</span><span class="sxs-lookup"><span data-stu-id="964d3-191">Scalability: Common threading, scheduling, and synchronization</span></span>  
 <span data-ttu-id="964d3-192">CLR chiama le API di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per la creazione di thread, sia per l'esecuzione del codice utente sia per uso interno.</span><span class="sxs-lookup"><span data-stu-id="964d3-192">CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] APIs for creating threads, both for running user code and for its own internal use.</span></span> <span data-ttu-id="964d3-193">Ai fini della sincronizzazione tra più thread, CLR chiama gli oggetti di sincronizzazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-193">In order to synchronize between multiple threads, the CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] synchronization objects.</span></span> <span data-ttu-id="964d3-194">Ciò consente all'utilità di pianificazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] di pianificare altre attività quando un thread è in attesa di un oggetto di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-194">This allows the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler to schedule other tasks when a thread is waiting on a synchronization object.</span></span> <span data-ttu-id="964d3-195">Quando, ad esempio, CLR avvia la procedura di Garbage Collection, tutti i relativi thread sono in attesa del completamento di tale procedura.</span><span class="sxs-lookup"><span data-stu-id="964d3-195">For example, when the CLR initiates garbage collection, all of its threads wait for garbage collection to finish.</span></span> <span data-ttu-id="964d3-196">Poiché i thread CLR e gli oggetti di sincronizzazione di cui sono in attesa vengono rilevati dall'utilità di pianificazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] può pianificare thread che eseguono altre attività del database che non interessano CLR.</span><span class="sxs-lookup"><span data-stu-id="964d3-196">Because the CLR threads and the synchronization objects they are waiting on are known to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can schedule threads that are running other database tasks not involving the CLR.</span></span> <span data-ttu-id="964d3-197">Ciò consente inoltre a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] di rilevare deadlock che comportano blocchi acquisiti da oggetti di sincronizzazione CLR e di utilizzare tecniche tradizionali per la rimozione di tali deadlock.</span><span class="sxs-lookup"><span data-stu-id="964d3-197">This also enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to detect deadlocks that involve locks taken by CLR synchronization objects and employ traditional techniques for deadlock removal.</span></span>  
  
 <span data-ttu-id="964d3-198">Il codice gestito viene eseguito in modalità preemptive in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-198">Managed code runs preemptively in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="964d3-199">L'utilità di pianificazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] è in grado di rilevare e arrestare i thread non eseguiti per una quantità di tempo significativa.</span><span class="sxs-lookup"><span data-stu-id="964d3-199">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler has the ability to detect and stop threads that have not yielded for a significant amount of time.</span></span> <span data-ttu-id="964d3-200">La possibilità di eseguire hook di thread CLR a thread di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implica che l'utilità di pianificazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sia in grado di identificare i thread sfuggiti al controllo in CLR e di gestirne la priorità.</span><span class="sxs-lookup"><span data-stu-id="964d3-200">The ability to hook CLR threads to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] threads implies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler can identify "runaway" threads in the CLR and manage their priority.</span></span> <span data-ttu-id="964d3-201">Tali thread sfuggiti al controllo vengono sospesi e reinseriti nella coda.</span><span class="sxs-lookup"><span data-stu-id="964d3-201">Such runaway threads are suspended and put back in the queue.</span></span> <span data-ttu-id="964d3-202">I thread identificati ripetutamente come thread sfuggiti al controllo non possono essere eseguiti per un determinato periodo di tempo, in modo da consentire l'esecuzione di altri thread worker.</span><span class="sxs-lookup"><span data-stu-id="964d3-202">Threads that are repeatedly identified as runaway threads are not allowed to run for a given period of time so that other executing workers can run.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="964d3-203">Il codice gestito con esecuzione prolungata che accede ai dati o alloca memoria sufficiente per attivare la procedura di Garbage Collection viene restituito automaticamente.</span><span class="sxs-lookup"><span data-stu-id="964d3-203">Long-running managed code that accesses data or allocates enough memory to trigger garbage collection will yield automatically.</span></span> <span data-ttu-id="964d3-204">Il codice gestito con esecuzione prolungata che non accede ai dati né alloca memoria gestita sufficiente per attivare la procedura di Garbage Collection deve essere restituito in modo esplicito chiamando la funzione System.Thread.Sleep() di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="964d3-204">Long-running managed code that does not access data or allocate enough managed memory to trigger garbage collection should explicitly yield by calling the System.Thread.Sleep() function of the .NET Framework.</span></span>  
  
###### <a name="scalability-common-memory-management"></a><span data-ttu-id="964d3-205">Scalabilità: gestione della memoria comune</span><span class="sxs-lookup"><span data-stu-id="964d3-205">Scalability: Common memory management</span></span>  
 <span data-ttu-id="964d3-206">CLR chiama primitive di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per allocare e deallocare la memoria.</span><span class="sxs-lookup"><span data-stu-id="964d3-206">The CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] primitives for allocating and de-allocating its memory.</span></span> <span data-ttu-id="964d3-207">Poiché la memoria utilizzata da CLR viene rilevata nell'utilizzo di memoria totale del sistema, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] è in grado di rispettare i limiti di memoria configurati e di garantire che CLR e [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stesso non creino conflitti di memoria reciproci.</span><span class="sxs-lookup"><span data-stu-id="964d3-207">Because the memory used by the CLR is accounted for in the total memory usage of the system, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can stay within its configured memory limits and ensure the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are not competing with each other for memory.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-208">può anche rifiutare le richieste di memoria CLR quando la memoria di sistema è vincolata, e può chiedere a CLR di ridurre l'utilizzo della memoria quando le altre attività hanno bisogno memoria.</span><span class="sxs-lookup"><span data-stu-id="964d3-208">can also reject CLR memory requests when system memory is constrained, and ask CLR to reduce its memory use when other tasks need memory.</span></span>  
  
###### <a name="reliability-application-domains-and-unrecoverable-exceptions"></a><span data-ttu-id="964d3-209">Affidabilità: domini applicazione ed eccezioni irreversibili</span><span class="sxs-lookup"><span data-stu-id="964d3-209">Reliability: Application domains and unrecoverable exceptions</span></span>  
 <span data-ttu-id="964d3-210">Quando il codice gestito nelle API di .NET Framework rileva eccezioni critiche, ad esempio un errore di memoria insufficiente o di overflow dello stack, non è sempre possibile recuperare il sistema e garantire semantica coerente e corretta per l'implementazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-210">When managed code in the .NET Framework APIs encounters critical exceptions, such as out-of-memory or stack overflow, it is not always possible to recover from such failures and ensure consistent and correct semantics for their implementation.</span></span> <span data-ttu-id="964d3-211">Le API generano un'eccezione di interruzione del thread in risposta a tali errori.</span><span class="sxs-lookup"><span data-stu-id="964d3-211">These APIs raise a thread abort exception in response to these failures.</span></span>  
  
 <span data-ttu-id="964d3-212">Se ospitate in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], tali interruzioni del thread vengono gestite nel modo seguente: CLR rileva qualsiasi stato condiviso nel dominio applicazione in cui si verifica l'interruzione del thread.</span><span class="sxs-lookup"><span data-stu-id="964d3-212">When hosted in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such thread aborts are handled as follows: the CLR detects any shared state in the application domain in which the thread abort occurs.</span></span> <span data-ttu-id="964d3-213">A tale scopo, CLR verifica l'eventuale presenza di oggetti di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-213">The CLR does this by checking for the presence of synchronization objects.</span></span> <span data-ttu-id="964d3-214">Se è presente uno stato condiviso nel dominio applicazione, viene scaricato il dominio applicazione stesso.</span><span class="sxs-lookup"><span data-stu-id="964d3-214">If there is shared state in the application domain, then the application domain itself is unloaded.</span></span> <span data-ttu-id="964d3-215">Lo scaricamento del dominio applicazione comporta l'arresto delle transazioni del database in esecuzione nel dominio applicazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-215">The unloading of the application domain stops database transactions that are currently running in that application domain.</span></span> <span data-ttu-id="964d3-216">Poiché la presenza dello stato condiviso può aumentare l'impatto di tali eccezioni critiche sulle sessioni utente diverse da quella che ha attivato l'eccezione, in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e CLR sono state introdotte procedure per ridurre la probabilità del verificarsi di tale stato.</span><span class="sxs-lookup"><span data-stu-id="964d3-216">Because the presence of shared state can widen the impact of such critical exceptions to user sessions other than the one triggering the exception, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR have taken steps to reduce the likelihood of shared state.</span></span> <span data-ttu-id="964d3-217">Per ulteriori informazioni, vedere la documentazione di .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="964d3-217">For more information, see the .NET Framework documentation.</span></span>  
  
###### <a name="security-permission-sets"></a><span data-ttu-id="964d3-218">Sicurezza: set di autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="964d3-218">Security: Permission sets</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-219">consente agli utenti di specificare i requisiti di affidabilità e sicurezza per il codice distribuito nel database.</span><span class="sxs-lookup"><span data-stu-id="964d3-219">allows users to specify the reliability and security requirements for code deployed into the database.</span></span> <span data-ttu-id="964d3-220">Una volta caricati gli assembly nel database, l'autore dell'assembly può specificare uno tra i tre set di autorizzazioni per l'assembly seguenti: SAFE, EXTERNAL_ACCESS e UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="964d3-220">When assemblies are uploaded into the database, the author of the assembly can specify one of three permission sets for that assembly: SAFE, EXTERNAL_ACCESS and UNSAFE.</span></span>  
  
|||||  
|-|-|-|-|  
|<span data-ttu-id="964d3-221">Set di autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="964d3-221">Permission set</span></span>|<span data-ttu-id="964d3-222">SAFE</span><span class="sxs-lookup"><span data-stu-id="964d3-222">SAFE</span></span>|<span data-ttu-id="964d3-223">EXTERNAL_ACCESS</span><span class="sxs-lookup"><span data-stu-id="964d3-223">EXTERNAL_ACCESS</span></span>|<span data-ttu-id="964d3-224">UNSAFE</span><span class="sxs-lookup"><span data-stu-id="964d3-224">UNSAFE</span></span>|  
|<span data-ttu-id="964d3-225">Sicurezza dall'accesso di codice</span><span class="sxs-lookup"><span data-stu-id="964d3-225">Code Access Security</span></span>|<span data-ttu-id="964d3-226">Sola esecuzione</span><span class="sxs-lookup"><span data-stu-id="964d3-226">Execute only</span></span>|<span data-ttu-id="964d3-227">Esecuzione più accesso a risorse esterne</span><span class="sxs-lookup"><span data-stu-id="964d3-227">Execute + access to external resources</span></span>|<span data-ttu-id="964d3-228">Senza restrizioni</span><span class="sxs-lookup"><span data-stu-id="964d3-228">Unrestricted</span></span>|  
|<span data-ttu-id="964d3-229">Restrizioni del modello di programmazione</span><span class="sxs-lookup"><span data-stu-id="964d3-229">Programming model restrictions</span></span>|<span data-ttu-id="964d3-230">Sì</span><span class="sxs-lookup"><span data-stu-id="964d3-230">Yes</span></span>|<span data-ttu-id="964d3-231">Sì</span><span class="sxs-lookup"><span data-stu-id="964d3-231">Yes</span></span>|<span data-ttu-id="964d3-232">Nessuna restrizione</span><span class="sxs-lookup"><span data-stu-id="964d3-232">No restrictions</span></span>|  
|<span data-ttu-id="964d3-233">Requisito di verificabilità</span><span class="sxs-lookup"><span data-stu-id="964d3-233">Verifiability requirement</span></span>|<span data-ttu-id="964d3-234">Sì</span><span class="sxs-lookup"><span data-stu-id="964d3-234">Yes</span></span>|<span data-ttu-id="964d3-235">Sì</span><span class="sxs-lookup"><span data-stu-id="964d3-235">Yes</span></span>|<span data-ttu-id="964d3-236">No</span><span class="sxs-lookup"><span data-stu-id="964d3-236">No</span></span>|  
|<span data-ttu-id="964d3-237">Possibilità di chiamare il codice nativo</span><span class="sxs-lookup"><span data-stu-id="964d3-237">Ability to call native code</span></span>|<span data-ttu-id="964d3-238">No</span><span class="sxs-lookup"><span data-stu-id="964d3-238">No</span></span>|<span data-ttu-id="964d3-239">No</span><span class="sxs-lookup"><span data-stu-id="964d3-239">No</span></span>|<span data-ttu-id="964d3-240">Sì</span><span class="sxs-lookup"><span data-stu-id="964d3-240">Yes</span></span>|  
  
 <span data-ttu-id="964d3-241">Grazie alle restrizioni associate in termini di modello di programmazione consentito, SAFE rappresenta la modalità più affidabile e protetta.</span><span class="sxs-lookup"><span data-stu-id="964d3-241">SAFE is the most reliable and secure mode with associated restrictions in terms of the allowed programming model.</span></span> <span data-ttu-id="964d3-242">Gli assembly SAFE dispongono di autorizzazioni sufficienti per l'esecuzione, l'elaborazione di calcoli e l'accesso al database locale.</span><span class="sxs-lookup"><span data-stu-id="964d3-242">SAFE assemblies are given enough permission to run, perform computations, and have access to the local database.</span></span> <span data-ttu-id="964d3-243">Gli assembly SAFE devono essere effettivamente indipendenti dai tipi e non possono chiamare codice non gestito.</span><span class="sxs-lookup"><span data-stu-id="964d3-243">SAFE assemblies need to be verifiably type safe and are not allowed to call unmanaged code.</span></span>  
  
 <span data-ttu-id="964d3-244">UNSAFE è un set di autorizzazioni per codice altamente attendibile, che può essere creato solo dagli amministratori di database.</span><span class="sxs-lookup"><span data-stu-id="964d3-244">UNSAFE is for highly trusted code that can only be created by database administrators.</span></span> <span data-ttu-id="964d3-245">Questo codice attendibile non presenta restrizioni di sicurezza dall'accesso di codice e può chiamare codice non gestito (nativo).</span><span class="sxs-lookup"><span data-stu-id="964d3-245">This trusted code has no code access security restrictions, and it can call unmanaged (native) code.</span></span>  
  
 <span data-ttu-id="964d3-246">EXTERNAL_ACCESS fornisce un'opzione di sicurezza intermedia e consente al codice di accedere alle risorse esterne al database, offrendo lo stesso livello di affidabilità di SAFE.</span><span class="sxs-lookup"><span data-stu-id="964d3-246">EXTERNAL_ACCESS provides an intermediate security option, allowing code to access resources external to the database but still having the reliability guarantees of SAFE.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-247">utilizza il livello dei criteri di protezione dall'accesso di codice a livello di host per configurare un criterio host che concede uno dei tre set di autorizzazioni in base all'autorizzazione archiviata nei cataloghi di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-247">uses the host-level CAS policy layer to set up a host policy that grants one of the three sets of permissions based on the permission set stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] catalogs.</span></span> <span data-ttu-id="964d3-248">Il codice gestito in esecuzione all'interno del database ottiene sempre uno di questi set di autorizzazioni di accesso per il codice.</span><span class="sxs-lookup"><span data-stu-id="964d3-248">Managed code running inside the database always gets one of these code access permission sets.</span></span>  
  
### <a name="programming-model-restrictions"></a><span data-ttu-id="964d3-249">Restrizioni del modello di programmazione</span><span class="sxs-lookup"><span data-stu-id="964d3-249">Programming Model Restrictions</span></span>  
 <span data-ttu-id="964d3-250">Il modello di programmazione per il codice gestito in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] comporta la scrittura di funzioni, procedure e tipi che in genere non richiedono l'utilizzo dello stato gestito tra più chiamate né la condivisione dello stato tra più sessioni utente.</span><span class="sxs-lookup"><span data-stu-id="964d3-250">The programming model for managed code in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] involves writing functions, procedures, and types which typically do not require the use of state held across multiple invocations or the sharing of state across multiple user sessions.</span></span> <span data-ttu-id="964d3-251">Come descritto in precedenza, la presenza dello stato condiviso può inoltre determinare eccezioni critiche che influiscono sulla scalabilità e l'affidabilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="964d3-251">Further, as described earlier, the presence of shared state can cause critical exceptions that impact the scalability and the reliability of the application.</span></span>  
  
 <span data-ttu-id="964d3-252">Considerati questi aspetti, non è consigliabile utilizzare variabili statiche e membri di dati statici di classi utilizzate in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-252">Given these considerations, we discourage the use of static variables and static data members of classes used in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="964d3-253">Per gli assembly SAFE ed EXTERNAL_ACCESS, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] esamina i metadati dell'assembly durante la fase CREATE ASSEMBLY e, se rileva l'utilizzo di variabili e membri di dati statici, impedisce la creazione di tali assembly.</span><span class="sxs-lookup"><span data-stu-id="964d3-253">For SAFE and EXTERNAL_ACCESS assemblies, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examines the metadata of the assembly at CREATE ASSEMBLY time and fails the creation of such assemblies if it finds the use of static data members and variables.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="964d3-254">impedisce inoltre le chiamate ad API di .NET Framework annotate tramite gli attributi di protezione host `SharedState`, `Synchronization` e `ExternalProcessMgmt`.</span><span class="sxs-lookup"><span data-stu-id="964d3-254">also disallows calls to .NET Framework APIs that are annotated with the `SharedState`, `Synchronization` and `ExternalProcessMgmt` host protection attributes.</span></span> <span data-ttu-id="964d3-255">In questo modo, viene impedito agli assembly SAFE ed EXTERNAL_ACCESS di chiamare qualsiasi API che consente la condivisione dello stato, di eseguire la sincronizzazione e di influire sull'integrità del processo di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="964d3-255">This prevents SAFE and EXTERNAL_ACCESS assemblies from calling any APIs that enable sharing state, performing synchronization, and affecting the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="964d3-256">Per ulteriori informazioni, vedere [restrizioni del modello di programmazione dell'integrazione CLR](database-objects/clr-integration-programming-model-restrictions.md).</span><span class="sxs-lookup"><span data-stu-id="964d3-256">For more information, see [CLR Integration Programming Model Restrictions](database-objects/clr-integration-programming-model-restrictions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="964d3-257">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="964d3-257">See Also</span></span>  
 <span data-ttu-id="964d3-258">[Sicurezza dell'integrazione con CLR](security/clr-integration-security.md) </span><span class="sxs-lookup"><span data-stu-id="964d3-258">[CLR Integration Security](security/clr-integration-security.md) </span></span>  
 [<span data-ttu-id="964d3-259">Prestazioni dell'integrazione con CLR</span><span class="sxs-lookup"><span data-stu-id="964d3-259">Performance of CLR Integration</span></span>](clr-integration-architecture-performance.md)  
  
  
