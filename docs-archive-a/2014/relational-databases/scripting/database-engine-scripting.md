---
title: Script del motore di database
ms.custom: seo-lt-2019
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- scripts [SQL Server], PowerShell
- scripts [SQL Server]
- scripting [SQL Server Database Engine]
- scripting [SQL Server Database Engine], PowerShell
ms.assetid: 9978a884-59a2-4e7f-a82a-335149f3a261
author: rothja
ms.author: jroth
ms.openlocfilehash: 79dca27e2aa5f2c0bc473534e0a8b204345b3993
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87623130"
---
# <a name="database-engine-scripting"></a><span data-ttu-id="ae971-102">Script del motore di database</span><span class="sxs-lookup"><span data-stu-id="ae971-102">Database Engine Scripting</span></span>
  <span data-ttu-id="ae971-103">Il [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] supporta l'ambiente di scripting di [!INCLUDE[msCoName](../../includes/msconame-md.md)] PowerShell per gestire le istanze del [!INCLUDE[ssDE](../../includes/ssde-md.md)] e gli oggetti nelle istanze.</span><span class="sxs-lookup"><span data-stu-id="ae971-103">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] supports the [!INCLUDE[msCoName](../../includes/msconame-md.md)] PowerShell scripting environment to manage instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and the objects in the instances.</span></span> <span data-ttu-id="ae971-104">È anche possibile compilare ed eseguire query nel [!INCLUDE[ssDE](../../includes/ssde-md.md)] che contengono [!INCLUDE[tsql](../../includes/tsql-md.md)] e XQuery in ambienti molto simili agli ambienti di scripting.</span><span class="sxs-lookup"><span data-stu-id="ae971-104">You can also build and run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries that contain [!INCLUDE[tsql](../../includes/tsql-md.md)] and XQuery in environments very similar to scripting environments.</span></span>  
  
## <a name="sql-server-powershell"></a><span data-ttu-id="ae971-105">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="ae971-105">SQL Server PowerShell</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ae971-106">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sono inclusi due snap-in PowerShell che implementano:</span><span class="sxs-lookup"><span data-stu-id="ae971-106">includes two [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="ae971-107">Un provider PowerShell per [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] che espone le gerarchie dei modelli SMO ( [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Objects) come percorsi di PowerShell simili ai percorsi del file system.</span><span class="sxs-lookup"><span data-stu-id="ae971-107">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider that exposes the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model hierarchies as PowerShell paths that are similar to file system paths.</span></span> <span data-ttu-id="ae971-108">È possibile utilizzare le classi del modello SMO ( [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Objects) per gestire gli oggetti rappresentati in ciascun nodo del percorso.</span><span class="sxs-lookup"><span data-stu-id="ae971-108">You can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model classes to manage the objects represented at each node of the path.</span></span>  
  
-   <span data-ttu-id="ae971-109">Un set di cmdlet di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] che implementa i comandi di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ae971-109">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets that implement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] commands.</span></span> <span data-ttu-id="ae971-110">Uno dei cmdlet è **Invoke-Sqlcmd**,</span><span class="sxs-lookup"><span data-stu-id="ae971-110">One of the cmdlets is **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="ae971-111">Viene utilizzato per eseguire [!INCLUDE[ssDE](../../includes/ssde-md.md)] gli script di query da eseguire con l' `sqlcmd` utilità.</span><span class="sxs-lookup"><span data-stu-id="ae971-111">This is used to run [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query scripts to be run with the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ae971-112">include le caratteristiche seguenti per l'esecuzione di PowerShell:</span><span class="sxs-lookup"><span data-stu-id="ae971-112">provides these features for running PowerShell:</span></span>  
  
-   <span data-ttu-id="ae971-113">Modulo di PowerShell **sqlps** , che può essere importato in una sessione di PowerShell. Il modulo carica quindi gli snap-in di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . È possibile eseguire in modo interattivo comandi ad hoc di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ae971-113">The **sqlps** PowerShell module that can be imported to a PowerShell session, the module then loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins. You can interactively run ad hoc PowerShell commands.</span></span> <span data-ttu-id="ae971-114">È possibile eseguire file script utilizzando un comando come .\MyFolder\MyScript.ps1.</span><span class="sxs-lookup"><span data-stu-id="ae971-114">You can run script files using a command such as .\MyFolder\MyScript.ps1.</span></span>  
  
-   <span data-ttu-id="ae971-115">I file script di PowerShell possono essere utilizzati come input dei passaggi del processo di PowerShell per [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent che eseguono gli script in base a intervalli pianificati o in risposta a eventi di sistema.</span><span class="sxs-lookup"><span data-stu-id="ae971-115">PowerShell script files can be used as input to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell job steps that run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
-   <span data-ttu-id="ae971-116">Utilità **sqlps** , che avvia PowerShell e importa il modulo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ae971-116">The **sqlps** utility that starts PowerShell and imports the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] module.</span></span> <span data-ttu-id="ae971-117">È quindi possibile eseguire tutte le azioni supportate dal modulo.</span><span class="sxs-lookup"><span data-stu-id="ae971-117">You can then perform all actions supported by the module.</span></span> <span data-ttu-id="ae971-118">È possibile avviare l'utilità **sqlps** in un prompt dei comandi o facendo clic con il pulsante destro del mouse sui nodi dell'albero di Esplora oggetti di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio e scegliendo **Avvia PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="ae971-118">You can start the **sqlps** utility either in a command prompt or by right-clicking on the nodes in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio Object Explorer tree and selecting **Start PowerShell**.</span></span>  
  
## <a name="database-engine-queries"></a><span data-ttu-id="ae971-119">Query del motore di database</span><span class="sxs-lookup"><span data-stu-id="ae971-119">Database Engine Queries</span></span>  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="ae971-120">Gli script delle query contengono tre tipi di elementi:</span><span class="sxs-lookup"><span data-stu-id="ae971-120">query scripts contain three types of elements:</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="ae971-121">istruzioni del linguaggio.</span><span class="sxs-lookup"><span data-stu-id="ae971-121">language statements.</span></span>  
  
-   <span data-ttu-id="ae971-122">Istruzioni del linguaggio XQuery.</span><span class="sxs-lookup"><span data-stu-id="ae971-122">XQuery language statements</span></span>  
  
-   <span data-ttu-id="ae971-123">Comandi e variabili dell' `sqlcmd` utilità.</span><span class="sxs-lookup"><span data-stu-id="ae971-123">Commands and variables from the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ae971-124">offre tre ambienti per la compilazione e l'esecuzione di query del [!INCLUDE[ssDE](../../includes/ssde-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="ae971-124">provides three environments for building and running [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries:</span></span>  
  
-   <span data-ttu-id="ae971-125">Le query del [!INCLUDE[ssDE](../../includes/ssde-md.md)] e il relativo debug possono essere eseguiti in modo interattivo nell'editor di query del [!INCLUDE[ssDE](../../includes/ssde-md.md)] in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ae971-125">You can interactively run and debug [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries in the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="ae971-126">È possibile codificare ed eseguire il debug di varie istruzioni in una sessione, quindi salvare tutte le istruzioni in un solo file script.</span><span class="sxs-lookup"><span data-stu-id="ae971-126">You can code and debug several statements in one session, then save all of the statements in a single script file.</span></span>  
  
-   <span data-ttu-id="ae971-127">L' `sqlcmd` utilità del prompt dei comandi consente di eseguire query in modo interattivo [!INCLUDE[ssDE](../../includes/ssde-md.md)] ed eseguire anche [!INCLUDE[ssDE](../../includes/ssde-md.md)] i file script di query esistenti.</span><span class="sxs-lookup"><span data-stu-id="ae971-127">The `sqlcmd` command prompt utility lets you interactively run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries, and also run existing [!INCLUDE[ssDE](../../includes/ssde-md.md)] query script files.</span></span>  
  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="ae971-128">In genere, i file script delle query del [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] vengono codificati in modo interattivo usando l'editor di query del [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ae971-128">query script files are typically coded interactively in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] by using the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor.</span></span> <span data-ttu-id="ae971-129">Il file può essere aperto in un secondo momento in uno degli ambienti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ae971-129">The file can later be opened in one of these environments:</span></span>  
  
-   <span data-ttu-id="ae971-130">Usare il menu di [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] **File**/**Apri** per aprire il file in una nuova finestra dell'editor di query del [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ae971-130">Use the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] **File**/**Open** menu to open the file in a new [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor window.</span></span>  
  
-   <span data-ttu-id="ae971-131">Usare il parametro **-i**_input_file_ per eseguire il file con l' `sqlcmd` utilità.</span><span class="sxs-lookup"><span data-stu-id="ae971-131">Use the **-i**_input_file_ parameter to run the file with the `sqlcmd` utility.</span></span>  
  
-   <span data-ttu-id="ae971-132">Usare il parametro **-QueryFromFile** per eseguire il file con il cmdlet **Invoke-Sqlcmd** negli script di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ae971-132">Use the **-QueryFromFile** parameter to run the file with the **Invoke-Sqlcmd** cmdlet in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell scripts.</span></span>  
  
-   <span data-ttu-id="ae971-133">Utilizzare i passaggi del processo [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di [!INCLUDE[tsql](../../includes/tsql-md.md)] Agent per eseguire gli script a intervalli pianificati o in risposta a eventi di sistema.</span><span class="sxs-lookup"><span data-stu-id="ae971-133">Use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps to run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
 <span data-ttu-id="ae971-134">È anche possibile usare la Generazione guidata script di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] per generare script [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ae971-134">In addition, you can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Generate Script Wizard to generate [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts.</span></span> <span data-ttu-id="ae971-135">Fare clic con il pulsante destro del mouse su Esplora oggetti in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] , quindi selezionare la voce di menu **Genera script** .</span><span class="sxs-lookup"><span data-stu-id="ae971-135">You can right-click objects in the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Object Explorer, then select the **Generate Script** menu item.</span></span> <span data-ttu-id="ae971-136">Con**Genera script** viene avviata la procedura guidata, che consente di eseguire in modo semplificato i passaggi necessari per creare uno script.</span><span class="sxs-lookup"><span data-stu-id="ae971-136">**Generate Script** launches the wizard, which guides you through the process of creating a script.</span></span>  
  
## <a name="database-engine-scripting-tasks"></a><span data-ttu-id="ae971-137">Attività di scripting del Motore di database</span><span class="sxs-lookup"><span data-stu-id="ae971-137">Database Engine Scripting Tasks</span></span>  
  
|<span data-ttu-id="ae971-138">Descrizione dell'attività</span><span class="sxs-lookup"><span data-stu-id="ae971-138">Task Description</span></span>|<span data-ttu-id="ae971-139">Argomento</span><span class="sxs-lookup"><span data-stu-id="ae971-139">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="ae971-140">Descrive come utilizzare gli editor di codice e di testo in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] da sviluppare in modo interattivo, eseguire il debug ed eseguire script [!INCLUDE[tsql](../../includes/tsql-md.md)]</span><span class="sxs-lookup"><span data-stu-id="ae971-140">Describes how to use the code and text editors in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] to interactively develop, debug, and run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts</span></span>|[<span data-ttu-id="ae971-141">Editor di query e di testo &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="ae971-141">Query and Text Editors &#40;SQL Server Management Studio&#41;</span></span>](../scripting/query-and-text-editors-sql-server-management-studio.md)|  
|<span data-ttu-id="ae971-142">Descrive come utilizzare l'utilità `sqlcmd` per eseguire script [!INCLUDE[tsql](../../includes/tsql-md.md)] dal prompt dei comando, incluso la possibilità di sviluppare script in modo interattivo.</span><span class="sxs-lookup"><span data-stu-id="ae971-142">Describes how to use the `sqlcmd` utility to run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts from the command prompt, including the ability to interactively develop scripts.</span></span>|[<span data-ttu-id="ae971-143">Procedure correlate a sqlcmd</span><span class="sxs-lookup"><span data-stu-id="ae971-143">sqlcmd How-to Topics</span></span>](../../database-engine/sqlcmd-how-to-topics.md)|  
|<span data-ttu-id="ae971-144">Descrive come integrare i componenti di SQL Server in un ambiente Windows PowerShell 2.0 e compilare script di PowerShell per la gestione di istanze e oggetti di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ae971-144">Describes how to integrate the SQL Server components into a Windows PowerShell 2.0 environment and then build PowerShell scripts for managing SQL Server instances and objects.</span></span>|[<span data-ttu-id="ae971-145">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="ae971-145">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)|  
|<span data-ttu-id="ae971-146">Descrive come usare la **procedura guidata Genera e pubblica script** per creare script [!INCLUDE[tsql](../../includes/tsql-md.md)] per ricreare uno o più degli oggetti da un database.</span><span class="sxs-lookup"><span data-stu-id="ae971-146">Describes how to use the **Generate and Publish Scripts** wizard to create [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts that recreate one or more of the objects from a database.</span></span>|[<span data-ttu-id="ae971-147">Generazione di script &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="ae971-147">Generate Scripts &#40;SQL Server Management Studio&#41;</span></span>](generate-scripts-sql-server-management-studio.md)|  
  
## <a name="see-also"></a><span data-ttu-id="ae971-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ae971-148">See Also</span></span>  
 <span data-ttu-id="ae971-149">[Utilità sqlcmd](../../tools/sqlcmd-utility.md) </span><span class="sxs-lookup"><span data-stu-id="ae971-149">[sqlcmd Utility](../../tools/sqlcmd-utility.md) </span></span>  
 [<span data-ttu-id="ae971-150">Esercitazione: Scrittura di istruzioni Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ae971-150">Tutorial: Writing Transact-SQL Statements</span></span>](../../t-sql/tutorial-writing-transact-sql-statements.md)  
  
  
