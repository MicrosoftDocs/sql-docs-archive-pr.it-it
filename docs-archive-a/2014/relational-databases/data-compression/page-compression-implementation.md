---
title: Implementazione della compressione di pagina | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- page compression [Database Engine]
- compression [SQL Server], page
ms.assetid: 78c83277-1dbb-4e07-95bd-47b14d2b5cd4
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e6edba79d1548d68e60f406d370abd5354a62fcb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87636207"
---
# <a name="page-compression-implementation"></a><span data-ttu-id="f9a1a-102">Implementazione della compressione di pagina</span><span class="sxs-lookup"><span data-stu-id="f9a1a-102">Page Compression Implementation</span></span>
  <span data-ttu-id="f9a1a-103">Questo argomento offre un riepilogo delle modalità di implementazione della compressione di pagina nel [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f9a1a-103">This topic summarizes how the [!INCLUDE[ssDE](../../includes/ssde-md.md)] implements page compression.</span></span> <span data-ttu-id="f9a1a-104">Tale riepilogo fornisce informazioni di base che consentono di pianificare lo spazio di archiviazione necessario per i dati.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-104">This summary provides basic information to help you plan the storage space that you need for your data.</span></span>  
  
 <span data-ttu-id="f9a1a-105">La compressione di pagina è simile per tabelle e indici e relative partizioni.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-105">Page compression is similar for tables, table partitions, indexes, and index partitions.</span></span> <span data-ttu-id="f9a1a-106">La descrizione seguente della compressione di pagina per una tabella si applica in modo analogo alla compressione di pagina per tutti i tipi di oggetto.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-106">The following description of page compression for a table applies equally to page compression for all object types.</span></span> <span data-ttu-id="f9a1a-107">Negli esempi seguenti vengono compresse stringhe di caratteri, ma sia la compressione basata su prefisso che quella basata su dizionario applicano gli stessi principi agli altri tipi di dati.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-107">The following examples compress character strings, but both prefix and dictionary compression apply the same principles to other data types.</span></span>  
  
 <span data-ttu-id="f9a1a-108">La compressione del livello foglia di tabelle e indici con compressione di pagina è costituita da tre operazioni eseguite nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="f9a1a-108">Compressing the leaf level of tables and indexes with page compression consists of three operations in the following order:</span></span>  
  
1.  <span data-ttu-id="f9a1a-109">Compressione di riga</span><span class="sxs-lookup"><span data-stu-id="f9a1a-109">Row compression</span></span>  
  
2.  <span data-ttu-id="f9a1a-110">Compressione basata su prefisso</span><span class="sxs-lookup"><span data-stu-id="f9a1a-110">Prefix compression</span></span>  
  
3.  <span data-ttu-id="f9a1a-111">Compressione basata su dizionario</span><span class="sxs-lookup"><span data-stu-id="f9a1a-111">Dictionary compression</span></span>  
  
 <span data-ttu-id="f9a1a-112">Quando si usa la compressione di pagina, per le pagine di indici che non si trovano a livello foglia viene usata solo la compressione di riga.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-112">When you use page compression, non-leaf-level pages of indexes are compressed by using only row compression.</span></span> <span data-ttu-id="f9a1a-113">Per altre informazioni sulla compressione di riga, vedere [Implementazione della compressione di riga](../data-compression/row-compression-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="f9a1a-113">For more information about row compression, see [Row Compression Implementation](../data-compression/row-compression-implementation.md).</span></span>  
  
## <a name="prefix-compression"></a><span data-ttu-id="f9a1a-114">Compressione basata su prefisso</span><span class="sxs-lookup"><span data-stu-id="f9a1a-114">Prefix Compression</span></span>  
 <span data-ttu-id="f9a1a-115">Per ogni pagina da comprimere, la compressione basata su prefisso viene eseguita mediante i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="f9a1a-115">For each page that is being compressed, prefix compression uses the following steps:</span></span>  
  
1.  <span data-ttu-id="f9a1a-116">Per ogni colonna, viene identificato un valore che può essere utilizzato per ridurre lo spazio di archiviazione per i valori della colonna.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-116">For each column, a value is identified that can be used to reduce the storage space for the values in each column.</span></span>  
  
2.  <span data-ttu-id="f9a1a-117">Viene creata una riga che rappresenta i valori del prefisso per ogni colonna. Tale riga viene archiviata nella struttura delle informazioni di compressione immediatamente seguente all'intestazione della pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-117">A row that represents the prefix values for each column is created and stored in the compression information (CI) structure that immediately follows the page header.</span></span>  
  
3.  <span data-ttu-id="f9a1a-118">I valori del prefisso ripetuti nella colonna vengono sostituiti da un riferimento al prefisso corrispondente.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-118">The repeated prefix values in the column are replaced by a reference to the corresponding prefix.</span></span> <span data-ttu-id="f9a1a-119">Se il valore in una riga non corrisponde esattamente al valore del prefisso selezionato, è possibile indicare ancora una corrispondenza parziale.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-119">If the value in a row does not exactly match the selected prefix value, a partial match can still be indicated.</span></span>  
  
 <span data-ttu-id="f9a1a-120">Nell'illustrazione seguente viene mostrata una pagina di esempio di una tabella prima della compressione basata su prefisso.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-120">The following illustration shows a sample page of a table before prefix compression.</span></span>  
  
 <span data-ttu-id="f9a1a-121">![Pagina prima della compressione basata su prefisso](../media/skt-tblcompression1c.gif "Pagina prima della compressione basata su prefisso")</span><span class="sxs-lookup"><span data-stu-id="f9a1a-121">![Page before prefix compression](../media/skt-tblcompression1c.gif "Page before prefix compression")</span></span>  
  
 <span data-ttu-id="f9a1a-122">Nell'illustrazione seguente viene mostrata la stessa pagina di esempio dopo la compressione basata su prefisso.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-122">The following illustration shows the same page after prefix compression.</span></span> <span data-ttu-id="f9a1a-123">Il prefisso viene spostato nell'intestazione e i valori della colonna vengono impostati sui riferimenti al prefisso.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-123">The prefix is moved to the header, and the column values are changed to references to the prefix.</span></span>  
  
 <span data-ttu-id="f9a1a-124">![Pagina dopo la compressione basata su prefisso](../media/tblcompression2.gif "Pagina dopo la compressione basata su prefisso")</span><span class="sxs-lookup"><span data-stu-id="f9a1a-124">![Page after prefix compression](../media/tblcompression2.gif "Page after prefix compression")</span></span>  
  
 <span data-ttu-id="f9a1a-125">Nella prima colonna della prima riga, il valore 4b indica che i primi quattro caratteri del prefisso (aaab) sono presenti per tale riga, così come il carattere b.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-125">In the first column of the first row, the value 4b indicates that the first four characters of the prefix (aaab) are present for that row, and also the character b.</span></span> <span data-ttu-id="f9a1a-126">Il valore risultante è aaabb, ovvero il valore originale.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-126">This makes the resultant value aaabb, which is the original value.</span></span>  
  
## <a name="dictionary-compression"></a><span data-ttu-id="f9a1a-127">Compressione basata su dizionario</span><span class="sxs-lookup"><span data-stu-id="f9a1a-127">Dictionary Compression</span></span>  
 <span data-ttu-id="f9a1a-128">Dopo che la compressione basata su prefisso è stata completata, viene applicata quella basata su dizionario.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-128">After prefix compression has been completed, dictionary compression is applied.</span></span> <span data-ttu-id="f9a1a-129">In base a tale compressione, viene eseguita la ricerca di valori ripetuti in qualsiasi punto della pagina che successivamente vengono archiviati nell'area relativa alla struttura delle informazioni di compressione.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-129">Dictionary compression searches for repeated values anywhere on the page, and stores them in the CI area.</span></span> <span data-ttu-id="f9a1a-130">A differenza di quella basata su prefisso, la compressione basata su dizionario non è limitata a una colonna</span><span class="sxs-lookup"><span data-stu-id="f9a1a-130">Unlike prefix compression, dictionary compression is not restricted to one column.</span></span> <span data-ttu-id="f9a1a-131">e può sostituire valori ripetuti presenti in qualsiasi punto di una pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-131">Dictionary compression can replace repeated values that occur anywhere on a page.</span></span> <span data-ttu-id="f9a1a-132">Nell'illustrazione seguente viene mostrata la stessa pagina di esempio dopo la compressione basata su dizionario.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-132">The following illustration shows the same page after dictionary compression.</span></span>  
  
 <span data-ttu-id="f9a1a-133">![Pagina dopo la compressione basata su dizionario](../media/tblcompression3.gif "Pagina dopo la compressione basata su dizionario")</span><span class="sxs-lookup"><span data-stu-id="f9a1a-133">![Page after dictionary compression](../media/tblcompression3.gif "Page after dictionary compression")</span></span>  
  
 <span data-ttu-id="f9a1a-134">Notare che al valore 4b viene fatto riferimento da colonne diverse della pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-134">Note that the value 4b has been referenced from different columns of the page.</span></span>  
  
## <a name="when-page-compression-occurs"></a><span data-ttu-id="f9a1a-135">Esecuzione della compressione di pagina</span><span class="sxs-lookup"><span data-stu-id="f9a1a-135">When Page Compression Occurs</span></span>  
 <span data-ttu-id="f9a1a-136">Quando si crea una nuova tabella con compressione di pagina, non viene eseguita alcuna compressione.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-136">When a new table is created that has page compression, no compression occurs.</span></span> <span data-ttu-id="f9a1a-137">I metadati per la tabella indicano tuttavia la compressione di pagina da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-137">However, the metadata for the table indicates that page compression should be used.</span></span> <span data-ttu-id="f9a1a-138">Man mano che i dati vengono aggiunti alla prima pagina di dati, viene applicata la compressione di riga.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-138">As data is added to the first data page, data is row-compressed.</span></span> <span data-ttu-id="f9a1a-139">Poiché la pagina non è completa, la compressione di pagina non consente di ottenere alcun beneficio.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-139">Because the page is not full, no benefit is gained from page compression.</span></span> <span data-ttu-id="f9a1a-140">Quando la pagina è completa, la successiva riga da aggiungere avvia l'operazione di compressione di pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-140">When the page is full, the next row to be added initiates the page compression operation.</span></span> <span data-ttu-id="f9a1a-141">La pagina intera viene rivista, ogni colonna viene valutata per la compressione basata su prefisso, quindi tutte le colonne vengono valutate per eseguire la compressione basata su dizionario.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-141">The whole page is reviewed; each column is evaluated for prefix compression, and then all columns are evaluated for dictionary compression.</span></span> <span data-ttu-id="f9a1a-142">Se la compressione di pagina ha creato spazio sufficiente per un'ulteriore riga, la riga viene aggiunta e ai dati viene applicata sia la compressione di riga che quella di pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-142">If page compression has created enough room on the page for an additional row, the row is added, and the data is both row- and page-compressed.</span></span> <span data-ttu-id="f9a1a-143">Se lo spazio guadagnato in seguito alla compressione di pagina senza lo spazio necessario per la struttura delle informazioni di compressione non è significativo, la compressione di pagina non viene utilizzata.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-143">If the space gained by page compression minus the space that is required for the CI structure is not significant, page compression is not used for that page.</span></span> <span data-ttu-id="f9a1a-144">Le righe successive vengono inserite nella nuova pagina. Se lo spazio non è sufficiente, alla tabella viene aggiunta una nuova pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-144">Future rows either fit onto the new page or, if they do not fit, a new page is added to the table.</span></span> <span data-ttu-id="f9a1a-145">Analogamente alla prima pagina, alla nuova pagina non viene inizialmente applicata la compressione di pagina.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-145">Similar to the first page, the new page is not at first page-compressed.</span></span>  
  
 <span data-ttu-id="f9a1a-146">Quando una tabella esistente che contiene dati viene convertita in base alla compressione di pagina, ogni pagina viene ricompilata e valutata.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-146">When an existing table that contains data is converted to page compression, each page is rebuilt and evaluated.</span></span> <span data-ttu-id="f9a1a-147">La ricompilazione di tutte le pagine provoca la ricompilazione della tabella, dell'indice o della partizione.</span><span class="sxs-lookup"><span data-stu-id="f9a1a-147">Rebuilding all the pages causes the rebuilding of the table, index, or partition.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f9a1a-148">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f9a1a-148">See Also</span></span>  
 <span data-ttu-id="f9a1a-149">[Compressione dei dati](data-compression.md) </span><span class="sxs-lookup"><span data-stu-id="f9a1a-149">[Data Compression](data-compression.md) </span></span>  
 [<span data-ttu-id="f9a1a-150">Implementazione della compressione di riga</span><span class="sxs-lookup"><span data-stu-id="f9a1a-150">Row Compression Implementation</span></span>](row-compression-implementation.md)  
  
  
