---
title: Conversione automatica dei dati di tipo carattere | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- result sets [ODBC], autotranslating character data
- data types [ODBC], autotranslating character data
- ACPs
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- AutoTranslate feature
- ANSI code pages
- character data autotranslation [ODBC]
- autotranslating character data
- SQL Server Native Client ODBC driver, data types
- ODBC data types, autotranslating character data
ms.assetid: 86a8adda-c5ad-477f-870f-cb370c39ee13
author: rothja
ms.author: jroth
ms.openlocfilehash: 91dd1714d553f201c1cab78bbca77d2445b42923
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725663"
---
# <a name="autotranslation-of-character-data"></a><span data-ttu-id="24aa0-102">Conversione automatica dei dati di tipo carattere</span><span class="sxs-lookup"><span data-stu-id="24aa0-102">Autotranslation of Character Data</span></span>
  <span data-ttu-id="24aa0-103">I dati di tipo carattere, ad esempio le variabili di tipo carattere ANSI dichiarati con SQL_C_CHAR o i dati archiviati in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilizzando i tipi di dati **char**, **varchar**o **Text** , possono rappresentare solo un numero limitato di caratteri.</span><span class="sxs-lookup"><span data-stu-id="24aa0-103">Character data, such as ANSI character variables declared with SQL_C_CHAR or data stored in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the **char**, **varchar**, or **text** data types, can represent only a limited number of characters.</span></span> <span data-ttu-id="24aa0-104">I dati di tipo carattere archiviati utilizzando un byte per carattere possono rappresentare solo 256 caratteri.</span><span class="sxs-lookup"><span data-stu-id="24aa0-104">Character data stored using one byte per character can only represent 256 characters.</span></span> <span data-ttu-id="24aa0-105">I valori archiviati nelle variabili SQL_C_CHAR vengono interpretati mediante la tabella codici ANSI (ACP) del computer client.</span><span class="sxs-lookup"><span data-stu-id="24aa0-105">The values stored in SQL_C_CHAR variables are interpreted using the ANSI code page (ACP) of the client computer.</span></span> <span data-ttu-id="24aa0-106">I valori archiviati utilizzando i tipi di dati **char**, **varchar**o **Text** nel server vengono valutati utilizzando l'ACP del server.</span><span class="sxs-lookup"><span data-stu-id="24aa0-106">The values stored using **char**, **varchar**, or **text** data types on the server are evaluated using the ACP of the server.</span></span>  
  
 <span data-ttu-id="24aa0-107">Se il server e il client hanno lo stesso ACP, non si verificano problemi durante l'interpretazione dei valori archiviati negli oggetti SQL_C_CHAR, **char**, **varchar**o **Text** .</span><span class="sxs-lookup"><span data-stu-id="24aa0-107">If both the server and the client have the same ACP, then they have no problems in interpreting the values stored in SQL_C_CHAR, **char**, **varchar**, or **text** objects.</span></span> <span data-ttu-id="24aa0-108">Se il server e il client hanno invece diversi, SQL_C_CHAR dati dal client possono essere interpretati come un carattere diverso nel server se usati in colonne, variabili o parametri di tipo **char**, **varchar**o **Text** .</span><span class="sxs-lookup"><span data-stu-id="24aa0-108">If the server and client have different ACPs, then SQL_C_CHAR data from the client may be interpreted as a different character on the server if it is used in **char**, **varchar**, or **text** columns, variables, or parameters.</span></span> <span data-ttu-id="24aa0-109">Un byte di caratteri contenente il valore 0xA5, ad esempio, viene interpretato come carattere?</span><span class="sxs-lookup"><span data-stu-id="24aa0-109">For example, a character byte containing the value 0xA5 is interpreted as the character ??</span></span> <span data-ttu-id="24aa0-110">in un computer che usa la tabella codici 437 e viene interpretato come il segno di yen (??) in un computer che esegue la tabella codici 1252.</span><span class="sxs-lookup"><span data-stu-id="24aa0-110">on a computer using code page 437 and is interpreted as the yen sign (??) on a computer running code page 1252.</span></span>  
  
 <span data-ttu-id="24aa0-111">I dati Unicode vengono archiviati utilizzando due byte per carattere.</span><span class="sxs-lookup"><span data-stu-id="24aa0-111">Unicode data is stored using two bytes per character.</span></span> <span data-ttu-id="24aa0-112">Poiché tutti i caratteri estesi sono inclusi nella specifica Unicode, tutti i caratteri Unicode vengono interpretati allo stesso modo da tutti i computer.</span><span class="sxs-lookup"><span data-stu-id="24aa0-112">All extended characters are covered by the Unicode specification, so all Unicode characters are interpreted the same by all computers.</span></span>  
  
 <span data-ttu-id="24aa0-113">La funzionalità AutoTranslate del [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client tenta di ridurre al minimo i problemi di trasferimento dei dati di tipo carattere tra un client e un server con tabelle codici diverse.</span><span class="sxs-lookup"><span data-stu-id="24aa0-113">The AutoTranslate feature of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver attempts to minimize the problems in moving character data between a client and a server that have different code pages.</span></span> <span data-ttu-id="24aa0-114">È possibile impostare AutoTranslate nella stringa di connessione di [SQLDriverConnect](../native-client-odbc-api/sqldriverconnect.md), nella stringa di configurazione di [SQLConfigDataSource](../native-client-odbc-api/sqlconfigdatasource.md)o quando si configurano le origini dati per il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client mediante l'amministratore ODBC.</span><span class="sxs-lookup"><span data-stu-id="24aa0-114">AutoTranslate can be set in the connect string of [SQLDriverConnect](../native-client-odbc-api/sqldriverconnect.md), in the configuration string of [SQLConfigDataSource](../native-client-odbc-api/sqlconfigdatasource.md), or when configuring data sources for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver using ODBC Administrator.</span></span>  
  
 <span data-ttu-id="24aa0-115">Quando AutoTranslate è impostato su "No", non vengono eseguite conversioni sui dati spostati tra SQL_C_CHAR variabili nelle colonne client e **char**, **varchar**o **Text** , variabili o parametri di un [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span><span class="sxs-lookup"><span data-stu-id="24aa0-115">When AutoTranslate is set to "no", no conversions are done on data moved between SQL_C_CHAR variables on the client and **char**, **varchar**, or **text** columns, variables, or parameters in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="24aa0-116">Se i dati contengono caratteri estesi e i due computer dispongono di tabelle codici diverse, gli schemi di bit potrebbero essere interpretati in modo diverso sui computer client e server.</span><span class="sxs-lookup"><span data-stu-id="24aa0-116">The bit patterns may be interpreted differently on the client and server computers if the data contains extended characters and the two computers have different code pages.</span></span> <span data-ttu-id="24aa0-117">I dati verranno interpretati nello stesso modo se entrambi computer dispongono della stessa tabella codici.</span><span class="sxs-lookup"><span data-stu-id="24aa0-117">The data will be interpreted the same if both computers have the same code page.</span></span>  
  
 <span data-ttu-id="24aa0-118">Quando AutoTranslate è impostato su "Yes", il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client utilizza Unicode per convertire i dati spostati tra SQL_C_CHAR variabili nelle colonne client e **char**, **varchar**o **Text** , variabili o parametri di un [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database:</span><span class="sxs-lookup"><span data-stu-id="24aa0-118">When AutoTranslate is set to "yes", the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver uses Unicode to convert data moved between SQL_C_CHAR variables on the client and **char**, **varchar**, or **text** columns, variables, or parameters in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database:</span></span>  
  
-   <span data-ttu-id="24aa0-119">Quando i dati vengono inviati da una variabile SQL_C_CHAR sul client a una colonna **char**, **varchar**o **Text** , una variabile o un parametro di un [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, il driver ODBC esegue prima la conversione da SQL_C_CHAR a Unicode utilizzando l'ACP del client, quindi da Unicode di nuovo a carattere utilizzando l'ACP del server.</span><span class="sxs-lookup"><span data-stu-id="24aa0-119">When data is sent from an SQL_C_CHAR variable on the client to a **char**, **varchar**, or **text** column, variable, or parameter in an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, the ODBC driver first converts from SQL_C_CHAR to Unicode using the ACP of the client, then from Unicode back to character using the ACP of the server.</span></span>  
  
-   <span data-ttu-id="24aa0-120">Quando i dati vengono inviati da una colonna di tipo **char**, **varchar**o **Text** , una variabile o un parametro di un [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database a una variabile di SQL_C_CHAR nel client, il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client converte innanzitutto da carattere a Unicode utilizzando l'acp del server, quindi da Unicode a SQL_C_CHAR utilizzando l'ACP del client.</span><span class="sxs-lookup"><span data-stu-id="24aa0-120">When data is sent from a **char**, **varchar**, or **text** column, variable, or parameter in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database to a SQL_C_CHAR variable on the client, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver first converts from character to Unicode using the ACP of the server, then from Unicode back to SQL_C_CHAR using the ACP of the client.</span></span>  
  
 <span data-ttu-id="24aa0-121">Poiché tutte le conversioni vengono eseguite dal [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client in esecuzione sul client, l'ACP del server deve essere una delle tabelle codici installate nel computer client.</span><span class="sxs-lookup"><span data-stu-id="24aa0-121">Because all of these conversions are done by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver executing on the client, the server ACP must be one of the code pages installed on the client computer.</span></span>  
  
 <span data-ttu-id="24aa0-122">L'utilizzo di Unicode consente di eseguire la conversione più appropriata di tutti i caratteri presenti in entrambe le tabelle codici.</span><span class="sxs-lookup"><span data-stu-id="24aa0-122">Making the character conversions through Unicode ensures the proper conversion of all characters that exist in both code pages.</span></span> <span data-ttu-id="24aa0-123">Se tuttavia un carattere esiste in una tabella codici ma non in un'altra, non può essere rappresentato nella tabella codici di destinazione.</span><span class="sxs-lookup"><span data-stu-id="24aa0-123">If a character exists in one code page but not another, however, then the character cannot be represented in the target code page.</span></span> <span data-ttu-id="24aa0-124">Ad esempio, la tabella codici 1252 presenta il simbolo del marchio registrato (??), mentre la tabella codici 437 non lo è.</span><span class="sxs-lookup"><span data-stu-id="24aa0-124">For example, code page 1252 has the registered trademark symbol (??), while code page 437 does not.</span></span>  
  
 <span data-ttu-id="24aa0-125">L'impostazione di AutoTranslate non ha effetto sulle conversioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="24aa0-125">The AutoTranslate setting has no effect on these conversions:</span></span>  
  
-   <span data-ttu-id="24aa0-126">Lo stato di trasferimento dei dati tra caratteri SQL_C_CHAR variabili client e colonne, variabili o parametri Unicode **nchar**, **nvarchar**o **ntext** nei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span><span class="sxs-lookup"><span data-stu-id="24aa0-126">Moving data between character SQL_C_CHAR client variables and Unicode **nchar**, **nvarchar**, or **ntext** columns, variables, or parameters in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   <span data-ttu-id="24aa0-127">Lo stato di trasferimento dei dati tra le variabili client SQL_C_WCHAR Unicode e le colonne di tipo **char**, **varchar**o **Text** , le variabili o i parametri nei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span><span class="sxs-lookup"><span data-stu-id="24aa0-127">Moving data between Unicode SQL_C_WCHAR client variables and character **char**, **varchar**, or **text** columns, variables, or parameters in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="24aa0-128">I dati devono essere sempre convertiti nel passaggio da carattere a Unicode.</span><span class="sxs-lookup"><span data-stu-id="24aa0-128">Data always must be converted when moved from character to Unicode.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="24aa0-129">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="24aa0-129">See Also</span></span>  
 <span data-ttu-id="24aa0-130">[Elaborazione dei risultati &#40;&#41;ODBC](processing-results-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="24aa0-130">[Processing Results &#40;ODBC&#41;](processing-results-odbc.md) </span></span>  
 [<span data-ttu-id="24aa0-131">Regole di confronto e supporto Unicode</span><span class="sxs-lookup"><span data-stu-id="24aa0-131">Collation and Unicode Support</span></span>](../collations/collation-and-unicode-support.md)  
  
  
