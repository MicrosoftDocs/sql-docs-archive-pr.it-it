---
title: Cursori | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- results [SQL Server], cursors
- Transact-SQL cursors, about cursors
- cursors [SQL Server]
- data access [SQL Server], cursors
- result sets [SQL Server], cursors
- requesting cursors
- cursors [SQL Server], about cursors
ms.assetid: e668b40c-bd4d-4415-850d-20fc4872ee72
author: rothja
ms.author: jroth
ms.openlocfilehash: 055482a8cf64527f58ed983b449121a99960f566
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87637894"
---
# <a name="cursors"></a><span data-ttu-id="15c89-102">Cursori</span><span class="sxs-lookup"><span data-stu-id="15c89-102">Cursors</span></span>
  <span data-ttu-id="15c89-103">Nei database relazionali le operazioni vengono eseguite su set di righe completi.</span><span class="sxs-lookup"><span data-stu-id="15c89-103">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="15c89-104">Ad esempio, il set di righe restituito dall'istruzione SELECT include tutte le righe che soddisfano le condizioni specificate nella clausola WHERE dell'istruzione.</span><span class="sxs-lookup"><span data-stu-id="15c89-104">For example, the set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="15c89-105">Il set di righe completo restituito dall'istruzione è noto come set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-105">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="15c89-106">Le applicazioni, soprattutto le applicazioni online interattive, non sono sempre in grado di gestire in modo efficiente un intero set di risultati come singola unità.</span><span class="sxs-lookup"><span data-stu-id="15c89-106">Applications, especially interactive online applications, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="15c89-107">In tali applicazioni deve essere pertanto disponibile un meccanismo per l'elaborazione di una riga singola o di un blocco di righe di dimensioni ridotte.</span><span class="sxs-lookup"><span data-stu-id="15c89-107">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="15c89-108">I cursori sono un'estensione dei set di risultati che implementano appunto tale meccanismo.</span><span class="sxs-lookup"><span data-stu-id="15c89-108">Cursors are an extension to result sets that provide that mechanism.</span></span>  
  
 <span data-ttu-id="15c89-109">I cursori estendono l'elaborazione dei risultati nel modo seguente:</span><span class="sxs-lookup"><span data-stu-id="15c89-109">Cursors extend result processing by:</span></span>  
  
-   <span data-ttu-id="15c89-110">Consentono il posizionamento su righe specifiche del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-110">Allowing positioning at specific rows of the result set.</span></span>  
  
-   <span data-ttu-id="15c89-111">Recuperano una riga o un blocco di righe dalla posizione corrente del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-111">Retrieving one row or block of rows from the current position in the result set.</span></span>  
  
-   <span data-ttu-id="15c89-112">Supportano la modifica dei dati delle righe in corrispondenza della posizione corrente del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-112">Supporting data modifications to the rows at the current position in the result set.</span></span>  
  
-   <span data-ttu-id="15c89-113">Supportano livelli diversi di visibilità per le modifiche apportate da altri utenti ai dati del database inclusi nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-113">Supporting different levels of visibility to changes made by other users to the database data that is presented in the result set.</span></span>  
  
-   <span data-ttu-id="15c89-114">Consentono alle istruzioni [!INCLUDE[tsql](../includes/tsql-md.md)] incluse in script, stored procedure e trigger di accedere ai dati di un set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-114">Providing [!INCLUDE[tsql](../includes/tsql-md.md)] statements in scripts, stored procedures, and triggers access to the data in a result set.</span></span>  
  
## <a name="concepts"></a><span data-ttu-id="15c89-115">Concetti</span><span class="sxs-lookup"><span data-stu-id="15c89-115">Concepts</span></span>  
 <span data-ttu-id="15c89-116">Implementazione dei cursori</span><span class="sxs-lookup"><span data-stu-id="15c89-116">Cursor Implementations</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="15c89-117">supporta l'implementazione di tre tipi di cursori.</span><span class="sxs-lookup"><span data-stu-id="15c89-117">supports three cursor implementations.</span></span>  
  
 <span data-ttu-id="15c89-118">cursori Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="15c89-118">Transact-SQL cursors</span></span>  
 <span data-ttu-id="15c89-119">Sono basati sulla sintassi DECLARE CURSOR e sono principalmente usati in trigger, stored procedure e script [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15c89-119">Are based on the DECLARE CURSOR syntax and are used mainly in [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, stored procedures, and triggers.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="15c89-120">vengono implementati nel server e gestiti dalle istruzioni [!INCLUDE[tsql](../includes/tsql-md.md)] inviate dal client al server.</span><span class="sxs-lookup"><span data-stu-id="15c89-120">cursors are implemented on the server and are managed by [!INCLUDE[tsql](../includes/tsql-md.md)] statements sent from the client to the server.</span></span> <span data-ttu-id="15c89-121">Possono essere inoltre inclusi in batch, stored procedure o trigger.</span><span class="sxs-lookup"><span data-stu-id="15c89-121">They may also be contained in batches, stored procedures, or triggers.</span></span>  
  
 <span data-ttu-id="15c89-122">Cursori API (Application Programming Interface) del server</span><span class="sxs-lookup"><span data-stu-id="15c89-122">Application programming interface (API) server cursors</span></span>  
 <span data-ttu-id="15c89-123">Supportano le funzioni dei cursori API in OLE DB e ODBC.</span><span class="sxs-lookup"><span data-stu-id="15c89-123">Support the API cursor functions in OLE DB and ODBC.</span></span> <span data-ttu-id="15c89-124">Questi cursori sono implementati nel server.</span><span class="sxs-lookup"><span data-stu-id="15c89-124">API server cursors are implemented on the server.</span></span> <span data-ttu-id="15c89-125">Ogni volta che un'applicazione client chiama una funzione per un cursore API, il provider OLE DB o il driver ODBC di Native Client [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] trasmette al server la richiesta di eseguire un'azione sul cursore API del server.</span><span class="sxs-lookup"><span data-stu-id="15c89-125">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB provider or ODBC driver transmits the request to the server for action against the API server cursor.</span></span>  
  
 <span data-ttu-id="15c89-126">Cursori client</span><span class="sxs-lookup"><span data-stu-id="15c89-126">Client cursors</span></span>  
 <span data-ttu-id="15c89-127">Sono implementati internamente dal driver ODBC di Native Client [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] e dalla DLL che implementa l'API ADO.</span><span class="sxs-lookup"><span data-stu-id="15c89-127">Are implemented internally by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver and by the DLL that implements the ADO API.</span></span> <span data-ttu-id="15c89-128">I cursori client vengono implementati mediante la memorizzazione nella cache del client di tutte le righe del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-128">Client cursors are implemented by caching all the result set rows on the client.</span></span> <span data-ttu-id="15c89-129">Ogni volta che un'applicazione client chiama una funzione per un cursore API, la DLL ADO o il driver ODBC di Native Client [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] esegue l'operazione del cursore nelle righe del set di risultati memorizzate nella cache del client.</span><span class="sxs-lookup"><span data-stu-id="15c89-129">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver or the ADO DLL performs the cursor operation on the result set rows cached on the client.</span></span>  
  
 <span data-ttu-id="15c89-130">Tipo di cursori</span><span class="sxs-lookup"><span data-stu-id="15c89-130">Type of Cursors</span></span>  
 <span data-ttu-id="15c89-131">Forward-only</span><span class="sxs-lookup"><span data-stu-id="15c89-131">Forward-only</span></span>  
 <span data-ttu-id="15c89-132">I cursori forward-only non supportano lo scorrimento, ma solo le operazioni di recupero seriale delle righe dall'inizio alla fine del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-132">A forward-only cursor does not support scrolling; it supports only fetching the rows serially from the start to the end of the cursor.</span></span> <span data-ttu-id="15c89-133">Le righe vengono prelevate dal database solo quando si esegue l'operazione di recupero.</span><span class="sxs-lookup"><span data-stu-id="15c89-133">The rows are not retrieved from the database until they are fetched.</span></span> <span data-ttu-id="15c89-134">Gli effetti delle istruzioni INSERT, UPDATE e DELETE eseguite dall'utente corrente o da altri utenti che coinvolgono le righe del set di risultati sono visibili nel momento in cui le righe vengono recuperate dal cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-134">The effects of all INSERT, UPDATE, and DELETE statements made by the current user or committed by other users that affect rows in the result set are visible as the rows are fetched from the cursor.</span></span>  
  
 <span data-ttu-id="15c89-135">Poiché non è supportato lo scorrimento a ritroso del cursore, la maggior parte delle modifiche apportate alle righe nel database in seguito al recupero non sono visibili tramite il cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-135">Because the cursor cannot be scrolled backward, most changes made to rows in the database after the row was fetched are not visible through the cursor.</span></span> <span data-ttu-id="15c89-136">Nei casi in cui un valore usato per determinare la posizione della riga all'interno del set di risultati viene modificato, ad esempio tramite l'aggiornamento di una colonna coperta da un indice cluster, il valore modificato sarà visibile tramite il cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-136">In cases where a value used to determine the location of the row within the result set is modified, such as updating a column covered by a clustered index, the modified value is visible through the cursor.</span></span>  
  
 <span data-ttu-id="15c89-137">Anche se i modelli di cursore API del database considerano un cursore forward-only un tipo distinto di cursore, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] non fa questa distinzione.</span><span class="sxs-lookup"><span data-stu-id="15c89-137">Although the database API cursor models consider a forward-only cursor to be a distinct type of cursor, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] does not.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="15c89-138">considera il forward-only e lo scorrimento come opzioni da applicare ai cursori statici, gestiti da keyset e dinamici.</span><span class="sxs-lookup"><span data-stu-id="15c89-138">considers both forward-only and scroll as options that can be applied to static, keyset-driven, and dynamic cursors.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="15c89-139">supportano i cursori dinamici, i cursori gestiti da keyset e i cursori statici forward-only.</span><span class="sxs-lookup"><span data-stu-id="15c89-139">cursors support forward-only static, keyset-driven, and dynamic cursors.</span></span> <span data-ttu-id="15c89-140">In base ai modelli di cursore dell'API di database i cursori dinamici, gestiti da keyset o statici sono sempre scorrevoli.</span><span class="sxs-lookup"><span data-stu-id="15c89-140">The database API cursor models assume that static, keyset-driven, and dynamic cursors are always scrollable.</span></span> <span data-ttu-id="15c89-141">I cursori API del database con una proprietà o un attributo impostato su forward-only vengono implementati in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] come cursori forward-only dinamici.</span><span class="sxs-lookup"><span data-stu-id="15c89-141">When a database API cursor attribute or property is set to forward-only, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implements this as a forward-only dynamic cursor.</span></span>  
  
 <span data-ttu-id="15c89-142">Statico</span><span class="sxs-lookup"><span data-stu-id="15c89-142">Static</span></span>  
 <span data-ttu-id="15c89-143">Il set di risultati completo di un cursore statico viene compilato nel database **tempdb** all'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-143">The complete result set of a static cursor is built in **tempdb** when the cursor is opened.</span></span> <span data-ttu-id="15c89-144">Un cursore statico visualizza sempre il set di risultati così come è visualizzato all'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-144">A static cursor always displays the result set as it was when the cursor was opened.</span></span> <span data-ttu-id="15c89-145">I cursori statici rilevano poche modifiche o addirittura nessuna, ma utilizzano un numero relativamente ridotto di risorse per lo scorrimento.</span><span class="sxs-lookup"><span data-stu-id="15c89-145">Static cursors detect few or no changes, but consume relatively few resources while scrolling.</span></span>  
  
 <span data-ttu-id="15c89-146">Nel cursore non vengono riportate né le modifiche al database che hanno effetto sull'appartenenza del set di risultati, né le modifiche apportate ai valori inclusi nelle colonne delle righe del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-146">The cursor does not reflect any changes made in the database that affect either the membership of the result set or changes to the values in the columns of the rows that make up the result set.</span></span> <span data-ttu-id="15c89-147">Un cursore statico non visualizza le nuove righe inserite nel database dopo l'apertura del cursore, anche se tali righe soddisfano le condizioni di ricerca dell'istruzione SELECT del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-147">A static cursor does not display new rows inserted in the database after the cursor was opened, even if they match the search conditions of the cursor SELECT statement.</span></span> <span data-ttu-id="15c89-148">Non visualizza inoltre gli aggiornamenti eseguiti da altri utenti nelle righe del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-148">If rows making up the result set are updated by other users, the new data values are not displayed in the static cursor.</span></span> <span data-ttu-id="15c89-149">Un cursore statico riflette invece le operazioni di eliminazione di righe dal database dopo l'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-149">The static cursor displays rows deleted from the database after the cursor was opened.</span></span> <span data-ttu-id="15c89-150">Il risultato delle operazioni UPDATE, INSERT e DELETE non viene mai riportato nel cursore statico, né le modifiche eseguite sulla stessa connessione in cui è stato aperto il cursore (a meno che il cursore non venga chiuso e riaperto).</span><span class="sxs-lookup"><span data-stu-id="15c89-150">No UPDATE, INSERT, or DELETE operations are reflected in a static cursor (unless the cursor is closed and reopened), not even modifications made using the same connection that opened the cursor.</span></span>  
  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="15c89-151">sono sempre di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="15c89-151">static cursors are always read-only.</span></span>  
  
 <span data-ttu-id="15c89-152">Poiché il set di risultati di un cursore statico viene archiviato in una tabella di lavoro in **tempdb**, la lunghezza delle righe non può essere maggiore della lunghezza di riga massima consentita per le tabelle di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15c89-152">Because the result set of a static cursor is stored in a work table in **tempdb**, the size of the rows in the result set cannot exceed the maximum row size for a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] table.</span></span>  
  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="15c89-153">definisce i cursori statici come cursori di tipo insensitive.</span><span class="sxs-lookup"><span data-stu-id="15c89-153">uses the term insensitive for static cursors.</span></span> <span data-ttu-id="15c89-154">Alcune API di database li identificano come cursori snapshot.</span><span class="sxs-lookup"><span data-stu-id="15c89-154">Some database APIs identify them as snapshot cursors.</span></span>  
  
 <span data-ttu-id="15c89-155">Keyset</span><span class="sxs-lookup"><span data-stu-id="15c89-155">Keyset</span></span>  
 <span data-ttu-id="15c89-156">L'appartenenza e l'ordine delle righe di un cursore gestito da keyset vengono fissati al momento dell'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-156">The membership and order of rows in a keyset-driven cursor are fixed when the cursor is opened.</span></span> <span data-ttu-id="15c89-157">I cursori gestiti da keyset vengono controllati da un set di identificatori univoci, ovvero chiavi, noti come keyset.</span><span class="sxs-lookup"><span data-stu-id="15c89-157">Keyset-driven cursors are controlled by a set of unique identifiers, keys, known as the keyset.</span></span> <span data-ttu-id="15c89-158">Le chiavi sono costituite da un set di colonne che identificano in modo univoco le righe del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="15c89-158">The keys are built from a set of columns that uniquely identify the rows in the result set.</span></span> <span data-ttu-id="15c89-159">Il keyset corrisponde al set di valori chiave di tutte le righe risultanti dall'istruzione SELECT al momento dell'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-159">The keyset is the set of the key values from all the rows that qualified for the SELECT statement at the time the cursor was opened.</span></span> <span data-ttu-id="15c89-160">Il keyset di un cursore gestito da keyset viene compilato nel database **tempdb** all'apertura del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-160">The keyset for a keyset-driven cursor is built in **tempdb** when the cursor is opened.</span></span>  
  
 <span data-ttu-id="15c89-161">Dinamico</span><span class="sxs-lookup"><span data-stu-id="15c89-161">Dynamic</span></span>  
 <span data-ttu-id="15c89-162">I cursori dinamici sono l'opposto dei cursori statici.</span><span class="sxs-lookup"><span data-stu-id="15c89-162">Dynamic cursors are the opposite of static cursors.</span></span> <span data-ttu-id="15c89-163">Quando si scorre un cursore dinamico vengono visualizzate tutte le modifiche apportate alle righe del set di risultati corrispondente.</span><span class="sxs-lookup"><span data-stu-id="15c89-163">Dynamic cursors reflect all changes made to the rows in their result set when scrolling through the cursor.</span></span> <span data-ttu-id="15c89-164">I valori di dati, l'ordine e l'appartenenza delle righe del set di risultati possono variare a ogni operazione di recupero.</span><span class="sxs-lookup"><span data-stu-id="15c89-164">The data values, order, and membership of the rows in the result set can change on each fetch.</span></span> <span data-ttu-id="15c89-165">I risultati delle istruzioni UPDATE, INSERT e DELETE eseguite da tutti gli utenti sono visibili nel cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-165">All UPDATE, INSERT, and DELETE statements made by all users are visible through the cursor.</span></span> <span data-ttu-id="15c89-166">Gli aggiornamenti sono visibili immediatamente se eseguiti nel cursore tramite una funzione API quale **SQLSetPos** o la clausola WHERE CURRENT OF [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15c89-166">Updates are visible immediately if they are made through the cursor using either an API function such as **SQLSetPos** or the [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF clause.</span></span> <span data-ttu-id="15c89-167">Gli aggiornamenti eseguiti all'esterno del cursore risultano visibili solo dopo l'operazione di commit, a meno che il livello di isolamento della transazione non sia impostato su read uncommitted.</span><span class="sxs-lookup"><span data-stu-id="15c89-167">Updates made outside the cursor are not visible until they are committed, unless the cursor transaction isolation level is set to read uncommitted.</span></span> <span data-ttu-id="15c89-168">I piani dinamici del cursore non usano mai indici spaziali.</span><span class="sxs-lookup"><span data-stu-id="15c89-168">Dynamic cursor plans never use spatial indexes.</span></span>  
  
## <a name="requesting-a-cursor"></a><span data-ttu-id="15c89-169">Richiesta di cursori</span><span class="sxs-lookup"><span data-stu-id="15c89-169">Requesting a Cursor</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="15c89-170">supporta due metodi per richiedere un cursore:</span><span class="sxs-lookup"><span data-stu-id="15c89-170">supports two methods for requesting a cursor:</span></span>  
  
-   [!INCLUDE[tsql](../includes/tsql-md.md)]  
  
     <span data-ttu-id="15c89-171">Il linguaggio [!INCLUDE[tsql](../includes/tsql-md.md)] supporta una sintassi per l'utilizzo dei cursori creati in base alla sintassi del cursore ISO.</span><span class="sxs-lookup"><span data-stu-id="15c89-171">The [!INCLUDE[tsql](../includes/tsql-md.md)] language supports a syntax for using cursors modeled after the ISO cursor syntax.</span></span>  
  
-   <span data-ttu-id="15c89-172">Funzioni per i cursori delle API di database</span><span class="sxs-lookup"><span data-stu-id="15c89-172">Database application programming interface (API) cursor functions</span></span>  
  
     [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="15c89-173">supporta la funzionalità per i cursori delle API di database seguenti:</span><span class="sxs-lookup"><span data-stu-id="15c89-173">supports the cursor functionality of these database APIs:</span></span>  
  
    -   <span data-ttu-id="15c89-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span><span class="sxs-lookup"><span data-stu-id="15c89-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span></span>  
  
    -   <span data-ttu-id="15c89-175">OLE DB</span><span class="sxs-lookup"><span data-stu-id="15c89-175">OLE DB</span></span>  
  
    -   <span data-ttu-id="15c89-176">ODBC (Open Database Connectivity)</span><span class="sxs-lookup"><span data-stu-id="15c89-176">ODBC (Open Database Connectivity)</span></span>  
  
 <span data-ttu-id="15c89-177">Questi due metodi non devono essere implementati entrambi nella stessa applicazione.</span><span class="sxs-lookup"><span data-stu-id="15c89-177">An application should never mix these two methods of requesting a cursor.</span></span> <span data-ttu-id="15c89-178">In un'applicazione in cui le funzionalità del cursore sono state implementate tramite le API, non è consentito richiedere un cursore [!INCLUDE[tsql](../includes/tsql-md.md)] tramite l'istruzione [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR.</span><span class="sxs-lookup"><span data-stu-id="15c89-178">An application that has used the API to specify cursor behaviors should not then execute a [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR statement to also request a [!INCLUDE[tsql](../includes/tsql-md.md)] cursor.</span></span> <span data-ttu-id="15c89-179">L'istruzione DECLARE CURSOR può essere eseguita solo dopo il ripristino di tutti i valori predefiniti degli attributi dei cursori API.</span><span class="sxs-lookup"><span data-stu-id="15c89-179">An application should only execute DECLARE CURSOR if it has set all the API cursor attributes back to their defaults.</span></span>  
  
 <span data-ttu-id="15c89-180">Se non è stato richiesto né un cursore [!INCLUDE[tsql](../includes/tsql-md.md)] , né un cursore API, per impostazione predefinita [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] restituisce all'applicazione un set di risultati completo, ovvero un set di risultati predefinito.</span><span class="sxs-lookup"><span data-stu-id="15c89-180">If neither a [!INCLUDE[tsql](../includes/tsql-md.md)] nor API cursor has been requested, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] defaults to returning a complete result set, known as a default result set, to the application.</span></span>  
  
## <a name="cursor-process"></a><span data-ttu-id="15c89-181">Processo del cursore</span><span class="sxs-lookup"><span data-stu-id="15c89-181">Cursor Process</span></span>  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="15c89-182">e i cursori API prevedono una sintassi diversa, ma per tutti i cursori di [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] viene usata la seguente procedura generale:</span><span class="sxs-lookup"><span data-stu-id="15c89-182">cursors and API cursors have different syntax, but the following general process is used with all [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cursors:</span></span>  
  
1.  <span data-ttu-id="15c89-183">Associare un cursore al set di risultati di un'istruzione [!INCLUDE[tsql](../includes/tsql-md.md)] e definirne le caratteristiche, ad esempio se le righe del cursore sono aggiornabili.</span><span class="sxs-lookup"><span data-stu-id="15c89-183">Associate a cursor with the result set of a [!INCLUDE[tsql](../includes/tsql-md.md)] statement, and define characteristics of the cursor, such as whether the rows in the cursor can be updated.</span></span>  
  
2.  <span data-ttu-id="15c89-184">Eseguire l'istruzione [!INCLUDE[tsql](../includes/tsql-md.md)] per popolare il cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-184">Execute the [!INCLUDE[tsql](../includes/tsql-md.md)] statement to populate the cursor.</span></span>  
  
3.  <span data-ttu-id="15c89-185">Recuperare le righe del cursore da visualizzare.</span><span class="sxs-lookup"><span data-stu-id="15c89-185">Retrieve the rows in the cursor you want to see.</span></span> <span data-ttu-id="15c89-186">L'operazione che consente di ottenere una riga o un blocco di righe da un cursore è definita operazione di recupero.</span><span class="sxs-lookup"><span data-stu-id="15c89-186">The operation to retrieve one row or one block of rows from a cursor is called a fetch.</span></span> <span data-ttu-id="15c89-187">L'esecuzione di una serie di operazioni di recupero in avanti o a ritroso è definita scorrimento.</span><span class="sxs-lookup"><span data-stu-id="15c89-187">Performing a series of fetches to retrieve rows in either a forward or backward direction is called scrolling.</span></span>  
  
4.  <span data-ttu-id="15c89-188">Facoltativamente, eseguire operazioni di modifica (aggiornamento o eliminazione) sulla riga che si trova nella posizione corrente del cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-188">Optionally, perform modification operations (update or delete) on the row at the current position in the cursor.</span></span>  
  
5.  <span data-ttu-id="15c89-189">Chiudere il cursore.</span><span class="sxs-lookup"><span data-stu-id="15c89-189">Close the cursor.</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="15c89-190">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="15c89-190">Related Content</span></span>  
 <span data-ttu-id="15c89-191">[Comportamenti dei cursori](native-client-odbc-cursors/cursor-behaviors.md) [Modalità di implementazione dei cursori](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span><span class="sxs-lookup"><span data-stu-id="15c89-191">[Cursor Behaviors](native-client-odbc-cursors/cursor-behaviors.md) [How Cursors Are Implemented](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15c89-192">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="15c89-192">See Also</span></span>  
 <span data-ttu-id="15c89-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="15c89-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span></span>  
 <span data-ttu-id="15c89-194">[Cursori &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="15c89-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span></span>  
 <span data-ttu-id="15c89-195">[Funzioni di cursore &#40;&#41;Transact-SQL](/sql/t-sql/functions/cursor-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="15c89-195">[Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span></span>  
 [<span data-ttu-id="15c89-196">Stored procedure per cursori &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="15c89-196">Cursor Stored Procedures &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/cursor-stored-procedures-transact-sql)  
  
  
