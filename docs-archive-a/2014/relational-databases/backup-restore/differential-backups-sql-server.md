---
title: Backup differenziali (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- differential backups
- differential backups, about
ms.assetid: 123bb7af-1367-4bde-bfcb-76d36799b905
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5c057e0d41cb46adef0ec1e01c3406190db900e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87636734"
---
# <a name="differential-backups-sql-server"></a><span data-ttu-id="fda1b-102">Backup differenziali [SQL Server]</span><span class="sxs-lookup"><span data-stu-id="fda1b-102">Differential Backups (SQL Server)</span></span>
  <span data-ttu-id="fda1b-103">Questo argomento relativo a backup e ripristino è applicabile a tutti i database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fda1b-103">This backup and restore topic is relevant for all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="fda1b-104">un backup differenziale si basa sul precedente backup completo dei dati più recente.</span><span class="sxs-lookup"><span data-stu-id="fda1b-104">A differential backup is based on the most recent, previous full data backup.</span></span> <span data-ttu-id="fda1b-105">In un backup differenziale vengono acquisiti solo i dati che hanno subito modifiche dopo il backup completo.</span><span class="sxs-lookup"><span data-stu-id="fda1b-105">A differential backup captures only the data that has changed since that full backup.</span></span> <span data-ttu-id="fda1b-106">Il backup completo su cui si basa un backup differenziale è noto come *base* del backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-106">The full backup upon which a differential backup is based is known as the *base* of the differential.</span></span> <span data-ttu-id="fda1b-107">I backup completi, ad eccezione di backup di sola copia, possono servire come base per una serie di backup differenziali, compresi backup di database, backup parziali e backup di file.</span><span class="sxs-lookup"><span data-stu-id="fda1b-107">Full backups, except for copy-only backups, can serve as the base for a series of differential backups, including database backups, partial backups, and file backups.</span></span> <span data-ttu-id="fda1b-108">Il backup di base per un backup differenziale di file può essere contenuto in un backup completo, un backup di file o un backup parziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-108">The base backup for a file differential backup can be contained within a full backup, a file backup, or a partial backup.</span></span>  
  
  
##  <a name="benefits"></a><a name="Benefits"></a> <span data-ttu-id="fda1b-109">Vantaggi</span><span class="sxs-lookup"><span data-stu-id="fda1b-109">Benefits</span></span>  
  
-   <span data-ttu-id="fda1b-110">La creazione di backup differenziali può risultare molto rapida rispetto alla creazione di un backup completo.</span><span class="sxs-lookup"><span data-stu-id="fda1b-110">Creating a differential backups can be very fast compared to creating a full backup.</span></span> <span data-ttu-id="fda1b-111">Un backup differenziale registra solo i dati modificati dopo l'ultimo backup completo su cui si basa il backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-111">A differential backup records only the data that has changed since the full backup upon the differential backup is based.</span></span> <span data-ttu-id="fda1b-112">Ciò facilita l'esecuzione più frequente di backup dei dati, riducendo il rischio di perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="fda1b-112">This facilitates taking frequent data backups, which decrease the risk of data loss.</span></span> <span data-ttu-id="fda1b-113">Prima di ripristinare un backup differenziale, è tuttavia necessario eseguire il ripristino della relativa base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-113">However, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="fda1b-114">Pertanto, l'esecuzione di un ripristino da un backup differenziale richiederà necessariamente più passaggi e tempo di un ripristino da un backup completo, poiché sono richiesti due file di backup.</span><span class="sxs-lookup"><span data-stu-id="fda1b-114">Therefore restoring from a differential backup will necessarily take more steps and time than restoring from a full backup because two backup files are required.</span></span>  
  
-   <span data-ttu-id="fda1b-115">I backup differenziali del database risultano particolarmente utili se un subset di un database viene modificato più spesso rispetto al resto del database.</span><span class="sxs-lookup"><span data-stu-id="fda1b-115">Differential database backups are especially useful if a subset of a database is modified more frequently than the rest of the database.</span></span> <span data-ttu-id="fda1b-116">In questi casi, i backup differenziali del database consentono di eseguire frequentemente backup evitando l'overhead tipico dei backup completi del database.</span><span class="sxs-lookup"><span data-stu-id="fda1b-116">In these cases, differential database backups enable you back up frequently without the overhead of full database backups.</span></span>  
  
-   <span data-ttu-id="fda1b-117">In base al modello di recupero con registrazione completa, l'utilizzo di backup differenziali può ridurre il numero di backup del log che è necessario ripristinare.</span><span class="sxs-lookup"><span data-stu-id="fda1b-117">Under the full recovery model, using differential backups can reduce the number of log backups that you have to restore.</span></span>  
  
##  <a name="overview-of-differential-backups"></a><a name="Overview"></a> <span data-ttu-id="fda1b-118">Panoramica dei backup differenziali</span><span class="sxs-lookup"><span data-stu-id="fda1b-118">Overview of Differential Backups</span></span>  
 <span data-ttu-id="fda1b-119">Un backup differenziale acquisisce lo stato di qualsiasi *extent* (raccolta di otto pagine fisicamente contigue) che ha subito modifiche tra la creazione della base differenziale e la creazione del backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-119">A differential backup captures the state of any *extents* (collections of eight physically contiguous pages) that have changed between when the differential base was created and the when differential backup is created.</span></span> <span data-ttu-id="fda1b-120">Le dimensioni di un determinato backup differenziale dipendono pertanto dalla quantità di dati modificata rispetto alla base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-120">This means that the size of a given differential backup depends on the amount of data that has changed since the base.</span></span> <span data-ttu-id="fda1b-121">In genere, meno recente è la base, maggiori saranno le dimensioni di un nuovo backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-121">Generally, the older a base is, the larger a new differential backup will be.</span></span> <span data-ttu-id="fda1b-122">In una serie di backup differenziali, è probabile che gli extent aggiornati di frequente contengano dati diversi in ogni backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-122">In a series of differential backups, a frequently updated extent is likely to contain different data in each differential backup.</span></span>  
  
 <span data-ttu-id="fda1b-123">Nella figura seguente viene illustrato il funzionamento di un backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-123">The following illustration shows how a differential backup works.</span></span> <span data-ttu-id="fda1b-124">Nella figura sono illustrati 24 extent di dati, sei dei quali sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="fda1b-124">The figure shows 24 data extents, 6 of which have changed.</span></span> <span data-ttu-id="fda1b-125">Il backup differenziale contiene solo questi sei extent di dati.</span><span class="sxs-lookup"><span data-stu-id="fda1b-125">The differential backup contains only these 6 data extents.</span></span> <span data-ttu-id="fda1b-126">L'operazione di backup differenziale è basata su una pagina della mappa di bit contenente un bit per ogni extent.</span><span class="sxs-lookup"><span data-stu-id="fda1b-126">The differential backup operation relies on a bitmap page that contains a bit for every extent.</span></span> <span data-ttu-id="fda1b-127">Per ogni extent aggiornato rispetto alla base, il bit viene impostato su 1 nella mappa di bit.</span><span class="sxs-lookup"><span data-stu-id="fda1b-127">For each extent updated since the base, the bit is set to 1 in the bitmap.</span></span>  
  
 <span data-ttu-id="fda1b-128">![La mappa di bit differenziale identifica gli extent modificati](../../database-engine/media/bnr-how-diff-backups-work.gif "La mappa di bit differenziale identifica gli extent modificati")</span><span class="sxs-lookup"><span data-stu-id="fda1b-128">![Differential bitmap identifies changed extents](../../database-engine/media/bnr-how-diff-backups-work.gif "Differential bitmap identifies changed extents")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fda1b-129">La mappa di bit differenziale non viene aggiornata da un backup di sola copia.</span><span class="sxs-lookup"><span data-stu-id="fda1b-129">The differential bitmap is not updated by a copy-only backup.</span></span> <span data-ttu-id="fda1b-130">Di conseguenza, un backup di sola copia non influisce sui backup differenziali successivi.</span><span class="sxs-lookup"><span data-stu-id="fda1b-130">Therefore, a copy-only backup does not affect subsequent differential backups.</span></span>  
  
 <span data-ttu-id="fda1b-131">Un backup differenziale eseguito entro un periodo di tempo relativamente breve dalla base in genere ha dimensioni decisamente più ridotte rispetto alla base differenziale,</span><span class="sxs-lookup"><span data-stu-id="fda1b-131">A differential backup that is taken fairly soon after its base is usually significantly smaller than the differential base.</span></span> <span data-ttu-id="fda1b-132">il che consente di limitare lo spazio di archiviazione e il tempo di esecuzione del backup.</span><span class="sxs-lookup"><span data-stu-id="fda1b-132">This saves storage space and backup time.</span></span> <span data-ttu-id="fda1b-133">Con il passare del tempo, tuttavia, le modifiche apportate a un database comportano un aumento delle differenze tra tale database e una determinata base differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-133">However, as a database changes over time, the difference between the database and a specific differential base increases.</span></span> <span data-ttu-id="fda1b-134">In genere, l'aumento delle dimensioni del backup differenziale è direttamente proporzionale alla lunghezza del periodo che intercorre tra l'esecuzione di un backup differenziale e la creazione della relativa base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-134">The longer the time between a differential backup and its base, the larger the differential backup is likely to be.</span></span> <span data-ttu-id="fda1b-135">Questo significa che, con il passare del tempo, le dimensioni dei backup differenziali possono avvicinarsi a quelle della base differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-135">This means that the differential backups can eventually approach the differential base in size.</span></span> <span data-ttu-id="fda1b-136">Un backup differenziale di notevoli dimensioni non offre più i vantaggi correlati alla maggiore rapidità e allo spazio di archiviazione ridotto.</span><span class="sxs-lookup"><span data-stu-id="fda1b-136">A large differential backup loses the advantages of a faster and smaller backup.</span></span>  
  
 <span data-ttu-id="fda1b-137">A causa dell'aumento delle dimensioni dei backup differenziali, il ripristino di un backup di questo tipo può comportare un notevole aumento del tempo necessario per il ripristino di un database.</span><span class="sxs-lookup"><span data-stu-id="fda1b-137">As the differential backups increase in size, restoring a differential backup can significantly increase the time that is required to restore a database.</span></span> <span data-ttu-id="fda1b-138">È consigliabile pertanto eseguire un nuovo backup completo a intervalli prestabiliti per creare una nuova base differenziale per i dati.</span><span class="sxs-lookup"><span data-stu-id="fda1b-138">Therefore, we recommend that you take a new full backup at set intervals to establish a new differential base for the data.</span></span> <span data-ttu-id="fda1b-139">È ad esempio possibile eseguire un backup completo settimanale dell'intero database, ovvero un backup completo del database, seguito da una serie regolare di backup differenziali del database nell'arco della settimana.</span><span class="sxs-lookup"><span data-stu-id="fda1b-139">For example, you might take a weekly full backup of the whole database (that is, a full database backup) followed by a regular series of differential database backups during the week.</span></span>  
  
 <span data-ttu-id="fda1b-140">Prima di ripristinare un backup differenziale, è necessario eseguire il ripristino della relativa base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-140">At restore time, before you restore a differential backup, you must restore its base.</span></span> <span data-ttu-id="fda1b-141">Ripristinare quindi solo il backup differenziale più recente per riportare il database allo stato esistente nel momento in cui è stato creato tale backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="fda1b-141">Then, restore only the most recent differential backup to bring the database forward to the time when that differential backup was created.</span></span> <span data-ttu-id="fda1b-142">In genere, si ripristina il backup completo più recente, seguito dal backup differenziale più recente basato su tale backup completo.</span><span class="sxs-lookup"><span data-stu-id="fda1b-142">Typically, you would restore the most recent full backup followed by the most recent differential backup that is based on that full backup.</span></span>  
  
## <a name="differential-backups-of-databases-with-memory-optimized-tables"></a><span data-ttu-id="fda1b-143">Backup differenziali di database con tabelle con ottimizzazione per la memoria</span><span class="sxs-lookup"><span data-stu-id="fda1b-143">Differential Backups of Databases with Memory-Optimized Tables</span></span>  
 <span data-ttu-id="fda1b-144">Per informazioni sui backup differenziali e sui database con tabelle ottimizzate per la memoria, vedere [Backup di un database con tabelle ottimizzate per la memoria](../in-memory-oltp/memory-optimized-tables.md).</span><span class="sxs-lookup"><span data-stu-id="fda1b-144">For information about differential backups and databases with memory-optimized tables, see [Backing Up a Database with Memory-Optimized Tables](../in-memory-oltp/memory-optimized-tables.md).</span></span>  
  
##  <a name="differential-backups-of-read-only-databases"></a><a name="ReadOnlyDbs"></a> <span data-ttu-id="fda1b-145">Backup differenziali di database di sola lettura</span><span class="sxs-lookup"><span data-stu-id="fda1b-145">Differential Backups of Read-Only Databases</span></span>  
 <span data-ttu-id="fda1b-146">Per i database di sola lettura, i backup completi sono più semplici da gestire quando vengono utilizzati singolarmente anziché in combinazione con i backup differenziali.</span><span class="sxs-lookup"><span data-stu-id="fda1b-146">For read-only databases, full backups used alone are easier to manage than when they are used with differential backups.</span></span> <span data-ttu-id="fda1b-147">Quando un database è di sola lettura, il backup e le altre operazioni non sono in grado di modificare i metadati inclusi nel file.</span><span class="sxs-lookup"><span data-stu-id="fda1b-147">When a database is read-only, backup and other operations cannot change the metadata that is contained in the file.</span></span> <span data-ttu-id="fda1b-148">I metadati necessari per un backup differenziale, ad esempio il numero di sequenza del file di log in corrispondenza del quale il backup differenziale ha inizio (l'LSN di base del backup differenziale), vengono pertanto archiviati nel database **master** .</span><span class="sxs-lookup"><span data-stu-id="fda1b-148">Therefore, metadata that is required by a differential backup, such as the log sequence number at which the differential backup begins (the differential base LSN) is stored in the **master** database.</span></span> <span data-ttu-id="fda1b-149">Se la base differenziale viene creata quando il database è di sola lettura, la mappa di bit differenziale indicherà un numero maggiore di modifiche rispetto a quelle effettivamente apportate dopo il backup di base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-149">If the differential base is taken when the database is read-only, the differential bitmap indicates more changes than have actually occurred since the base backup.</span></span> <span data-ttu-id="fda1b-150">I dati aggiuntivi vengono letti dal backup, ma non vengono scritti nel backup, perché tramite il valore **differential_base_lsn** archiviato nella tabella di sistema [backupset](/sql/relational-databases/system-tables/backupset-transact-sql) viene determinato se i dati sono realmente cambiati dopo la creazione della base.</span><span class="sxs-lookup"><span data-stu-id="fda1b-150">The extra data is read by backup, but is not written to the backup, because the **differential_base_lsn** stored in the [backupset](/sql/relational-databases/system-tables/backupset-transact-sql) system table is used to determine whether the data has actually changed since the base.</span></span>  
  
 <span data-ttu-id="fda1b-151">Quando viene ricompilato, ripristinato oppure scollegato e collegato un database di sola lettura, le informazioni relative alla base differenziale vengono perse</span><span class="sxs-lookup"><span data-stu-id="fda1b-151">When a read-only database is rebuilt, restored, or detached and attached, the differential-base information is lost.</span></span> <span data-ttu-id="fda1b-152">perché il database **master** non è sincronizzato con il database utente.</span><span class="sxs-lookup"><span data-stu-id="fda1b-152">This occurs because the **master** database is not synchronized with the user database.</span></span> <span data-ttu-id="fda1b-153">Il [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] non è in grado di rilevare né evitare questo problema.</span><span class="sxs-lookup"><span data-stu-id="fda1b-153">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] cannot detect or prevent this problem.</span></span> <span data-ttu-id="fda1b-154">Gli eventuali backup differenziali successivi non saranno basati sul backup completo più recente e potrebbero generare risultati imprevisti.</span><span class="sxs-lookup"><span data-stu-id="fda1b-154">Any later differential backups are not based on the most recent full backup and could provide unexpected results.</span></span> <span data-ttu-id="fda1b-155">Per creare una nuova base differenziale, è consigliabile eseguire un backup completo del database.</span><span class="sxs-lookup"><span data-stu-id="fda1b-155">To establish a new differential base, we recommend that you create a full database backup.</span></span>  
  
### <a name="best-practices-for-using-differential-backups-with-a-read-only-database"></a><span data-ttu-id="fda1b-156">Procedure consigliate per l'utilizzo di backup differenziali con un database di sola lettura</span><span class="sxs-lookup"><span data-stu-id="fda1b-156">Best Practices for Using Differential Backups with a Read-Only Database</span></span>  
 <span data-ttu-id="fda1b-157">Se dopo la creazione di un backup completo di un database di sola lettura si ha intenzione di creare un successivo backup differenziale, eseguire il backup del database **master** .</span><span class="sxs-lookup"><span data-stu-id="fda1b-157">After you create a full database backup of a read-only database, if you intend to create a subsequent differential backup, back up the **master** database.</span></span>  
  
 <span data-ttu-id="fda1b-158">In caso di perdita del database **master** , ripristinarlo prima dei backup differenziali di un database utente.</span><span class="sxs-lookup"><span data-stu-id="fda1b-158">If the **master** database is lost, restore it before you restore any differential backup of a user database.</span></span>  
  
 <span data-ttu-id="fda1b-159">Se si scollega e si collega un database di sola lettura per il quale in seguito si prevede di usare backup differenziali, eseguire non appena possibile un backup completo sia del database di sola lettura che del database **master** .</span><span class="sxs-lookup"><span data-stu-id="fda1b-159">If you detach and attach a read-only database for which you plan to later use differential backups, as soon as it is practical, take a full database backup of both the read-only database and of the **master** database.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="fda1b-160">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="fda1b-160">Related Tasks</span></span>  
  
-   [<span data-ttu-id="fda1b-161">Creare un backup differenziale del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fda1b-161">Create a Differential Database Backup &#40;SQL Server&#41;</span></span>](create-a-differential-database-backup-sql-server.md)  
  
-   [<span data-ttu-id="fda1b-162">Ripristinare un backup differenziale del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fda1b-162">Restore a Differential Database Backup &#40;SQL Server&#41;</span></span>](restore-a-differential-database-backup-sql-server.md)  
  
  
## <a name="see-also"></a><span data-ttu-id="fda1b-163">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="fda1b-163">See Also</span></span>  
 <span data-ttu-id="fda1b-164">[Panoramica del backup &#40;SQL Server&#41;](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="fda1b-164">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="fda1b-165">[Backup completo del database &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="fda1b-165">[Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md) </span></span>  
 <span data-ttu-id="fda1b-166">[Ripristini di database completi &#40;modello di recupero con registrazione completa&#41;](complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="fda1b-166">[Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="fda1b-167">[Ripristini di database completi &#40;modello di recupero con registrazione minima&#41;](complete-database-restores-simple-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="fda1b-167">[Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md) </span></span>  
 [<span data-ttu-id="fda1b-168">Backup di log delle transazioni &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fda1b-168">Transaction Log Backups &#40;SQL Server&#41;</span></span>](transaction-log-backups-sql-server.md)  
  
  
