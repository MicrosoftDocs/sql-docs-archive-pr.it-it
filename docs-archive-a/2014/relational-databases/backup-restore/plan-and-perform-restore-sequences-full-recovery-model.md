---
title: Pianificare ed eseguire sequenze di ripristino (modello di recupero con registrazione completa) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- restore sequences [SQL Server], planning for
- full recovery model [SQL Server], planning restore sequences
ms.assetid: 9cbefaf8-d2b6-41c9-83fc-b3807a841fe2
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 85558c0a6361837b5645b9fc38ad040254265d72
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635688"
---
# <a name="plan-and-perform-restore-sequences-full-recovery-model"></a><span data-ttu-id="78f9b-102">Pianificare ed eseguire sequenze di ripristino (Modello di recupero con registrazione completa)</span><span class="sxs-lookup"><span data-stu-id="78f9b-102">Plan and Perform Restore Sequences (Full Recovery Model)</span></span>
  <span data-ttu-id="78f9b-103">In questo argomento si spiega come pianificare ed eseguire una sequenza di ripristino per un database di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in cui viene utilizzato in genere il modello di recupero con registrazione completa.</span><span class="sxs-lookup"><span data-stu-id="78f9b-103">This topic explains how to plan and perform a restore sequence for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases that ordinarily uses the full recovery model.</span></span> <span data-ttu-id="78f9b-104">Una *sequenza di ripristino* è una sequenza contenente una o più istruzioni [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="78f9b-104">A *restore sequence* is a sequence of one or more [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) statements.</span></span> <span data-ttu-id="78f9b-105">In genere, consente di inizializzare il contenuto del database, dei file e/o delle pagine in fase di ripristino (fase di copia dei dati), di eseguire il roll forward delle transazioni registrate (fase di rollforward) e quindi di eseguire il rollback delle transazioni di cui non è stato eseguito il commit (fase di rollback).</span><span class="sxs-lookup"><span data-stu-id="78f9b-105">Typically, a restore sequences initializes the contents of the database, files, and/or pages being restored (the data-copy phase), rolls forward logged transactions (the redo phase), and rolls back uncommitted transactions (the undo phase).</span></span>  
  
 <span data-ttu-id="78f9b-106">In scenari semplici, per una sequenza di ripristino sono necessari solo un backup completo del database, un backup differenziale del database e i successivi backup del log.</span><span class="sxs-lookup"><span data-stu-id="78f9b-106">In simple cases, a restore sequence requires only a full database backup, a differential database backup, and the subsequent log backups.</span></span> <span data-ttu-id="78f9b-107">In questi casi, la formulazione di una corretta sequenza di ripristino è un'operazione semplice.</span><span class="sxs-lookup"><span data-stu-id="78f9b-107">In these cases, constructing a correct restore sequence is easy.</span></span> <span data-ttu-id="78f9b-108">Per ripristinare ad esempio un intero database fino al punto in cui si è verificato un errore, eseguire innanzitutto il backup del log delle transazioni attivo (la *parte finale* del log).</span><span class="sxs-lookup"><span data-stu-id="78f9b-108">For example, to restore a whole database to the point of a failure, start by backing up the active transaction log (the *tail* of the log).</span></span> <span data-ttu-id="78f9b-109">Ripristinare quindi il backup completo del database più recente, l'eventuale backup differenziale più recente e tutti i successivi backup del log nell'ordine in cui sono stati eseguiti.</span><span class="sxs-lookup"><span data-stu-id="78f9b-109">Then, restore the most recent full database backup, the most recent differential backup (if any), and all subsequent log backups in the order in which they were taken.</span></span>  
  
 <span data-ttu-id="78f9b-110">In scenari più complessi, la formulazione di una corretta sequenza di ripristino può risultare difficile.</span><span class="sxs-lookup"><span data-stu-id="78f9b-110">In more complex cases, constructing a correct restore sequence can be a complex process.</span></span> <span data-ttu-id="78f9b-111">Una sequenza di ripristino potrebbe ad esempio richiedere più backup di file oppure il ripristino dei dati fino a un punto nel tempo specifico.</span><span class="sxs-lookup"><span data-stu-id="78f9b-111">For example, a restore sequence might require multiple file backups or restoring data to a specific point in time.</span></span> <span data-ttu-id="78f9b-112">In scenari estremamente complessi, potrebbe persino essere necessario attraversare un percorso di recupero che si estende su uno o più fork di recupero.</span><span class="sxs-lookup"><span data-stu-id="78f9b-112">In very complex cases, you might even have to traverse a forked recovery path that spans one or more recovery forks.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="78f9b-113">Un *percorso di recupero* è la sequenza di dati e di backup del log che hanno portato un database a un determinato momento, noto come punto di recupero.</span><span class="sxs-lookup"><span data-stu-id="78f9b-113">A *recovery path* is the sequence of data and log backups that have brought a database to a particular point in time (known as a recovery point).</span></span> <span data-ttu-id="78f9b-114">Un percorso di recupero è costituito da un set specifico di trasformazioni che hanno determinato la modifica del database nel corso del tempo, mantenendone tuttavia la coerenza.</span><span class="sxs-lookup"><span data-stu-id="78f9b-114">A recovery path is a specific set of transformations that have evolved the database over time, yet have maintained the consistency of the database.</span></span> <span data-ttu-id="78f9b-115">Un percorso di recupero descrive un intervallo di LSN da un punto di inizio (LSN,GUID) a un punto di fine (LSN,GUID).</span><span class="sxs-lookup"><span data-stu-id="78f9b-115">A recovery path describes a range of LSNs from a start point (LSN,GUID) to an end point (LSN,GUID).</span></span> <span data-ttu-id="78f9b-116">È possibile che l'intervallo di LSN in un percorso di recupero attraversi uno o più rami di recupero dall'inizio alla fine.</span><span class="sxs-lookup"><span data-stu-id="78f9b-116">The range of LSNs in a recovery path can traverse one or more recovery branches from start to end.</span></span>  
  
## <a name="to-plan-a-restore-sequence"></a><span data-ttu-id="78f9b-117">Per pianificare una sequenza di ripristino</span><span class="sxs-lookup"><span data-stu-id="78f9b-117">To Plan a Restore Sequence</span></span>  
 <span data-ttu-id="78f9b-118">Prima di avviare una sequenza di ripristino, effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="78f9b-118">Before you start a restore sequence, follow these steps:</span></span>  
  
1.  <span data-ttu-id="78f9b-119">Se possibile, creare un backup della parte finale del log per il database.</span><span class="sxs-lookup"><span data-stu-id="78f9b-119">Create a tail-log backup of the database, if you can.</span></span> <span data-ttu-id="78f9b-120">Per altre informazioni, vedere [Backup della parte finale del log &#40;SQL Server&#41;](tail-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-120">For more information, see [Tail-Log Backups &#40;SQL Server&#41;](tail-log-backups-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="78f9b-121">Determinare il punto di recupero previsto.</span><span class="sxs-lookup"><span data-stu-id="78f9b-121">Determine the target recovery point.</span></span>  
  
     <span data-ttu-id="78f9b-122">Il punto di recupero previsto può corrispondere a un qualsiasi punto nel tempo o un qualsiasi contrassegno all'interno di un backup del log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="78f9b-122">The target recovery point can be any point in time or mark within a transaction log backup.</span></span> <span data-ttu-id="78f9b-123">Per altre informazioni, vedere [Ripristinare un database di SQL Server fino a un punto specifico &#40;modello di recupero con registrazione completa&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) o [Usare transazioni contrassegnate per recuperare coerentemente i database correlati &#40;modello di recupero con registrazione completa&#41;](use-marked-transactions-to-recover-related-databases-consistently.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-123">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) or [Use Marked Transactions to Recover Related Databases Consistently &#40;Full Recovery Model&#41;](use-marked-transactions-to-recover-related-databases-consistently.md).</span></span>  
  
3.  <span data-ttu-id="78f9b-124">Determinare il tipo di ripristino che si desidera eseguire.</span><span class="sxs-lookup"><span data-stu-id="78f9b-124">Determine the type of restore you want to perform.</span></span> <span data-ttu-id="78f9b-125">Per altre informazioni, vedere [Panoramica del ripristino e del recupero &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-125">For more information, see [Restore and Recovery Overview &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md).</span></span>  
  
4.  <span data-ttu-id="78f9b-126">Individuare i backup necessari e verificare che siano disponibili i set di supporti e i dispositivi di backup appropriati.</span><span class="sxs-lookup"><span data-stu-id="78f9b-126">Identify which backups you require and make sure that the necessary media sets and backup devices are available.</span></span> <span data-ttu-id="78f9b-127">Per altre informazioni, vedere [Dispositivi di backup &#40;SQL Server&#41;](backup-devices-sql-server.md) e [Set di supporti, gruppi di supporti e set di backup &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-127">For more information, see [Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md) and [Media Sets, Media Families, and Backup Sets &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md).</span></span>  
  
## <a name="to-perform-a-restore-sequence"></a><span data-ttu-id="78f9b-128">Per eseguire una sequenza di ripristino</span><span class="sxs-lookup"><span data-stu-id="78f9b-128">To Perform a Restore Sequence</span></span>  
 <span data-ttu-id="78f9b-129">Per eseguire una sequenza di ripristino, effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="78f9b-129">To perform a restore sequence, follow these steps:</span></span>  
  
1.  <span data-ttu-id="78f9b-130">Per avviare la sequenza, ripristinare uno o più backup dei dati, ad esempio un backup del database, un backup parziale, uno o più backup di file.</span><span class="sxs-lookup"><span data-stu-id="78f9b-130">To start the sequence, restore a one or more data backups, such as: a database backup, a partial backup, one or more file backups.</span></span>  
  
2.  <span data-ttu-id="78f9b-131">Ripristinare facoltativamente gli ultimi backup differenziali basati su questi backup completi.</span><span class="sxs-lookup"><span data-stu-id="78f9b-131">Optionally, restore the latest differential backups that are based on these full backups.</span></span>  
  
     <span data-ttu-id="78f9b-132">Per ogni backup completo che si prevede di ripristinare, determinare se viene utilizzato come base per qualsiasi backup differenziale.</span><span class="sxs-lookup"><span data-stu-id="78f9b-132">For each full backup that you plan to restore, determine whether it is the base for any differential backups.</span></span> <span data-ttu-id="78f9b-133">In tal caso, ripristinare se possibile il backup differenziale più recente.</span><span class="sxs-lookup"><span data-stu-id="78f9b-133">If so, restore most recent differential backup, if you can.</span></span> <span data-ttu-id="78f9b-134">Per altre informazioni, vedere [Backup differenziali &#40;SQL Server&#41;](differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-134">For more information, see [Differential Backups &#40;SQL Server&#41;](differential-backups-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="78f9b-135">Eseguire il rollforward del database ripristinando in sequenza i backup del log e terminando con il backup che include il punto di recupero.</span><span class="sxs-lookup"><span data-stu-id="78f9b-135">Roll forward the database by restoring log backups in sequence, finishing with the backup that contains the recovery point.</span></span> <span data-ttu-id="78f9b-136">L'applicazione o meno di tutti i backup del log dipende dal backup del log che contiene il punto di recupero previsto, come descritto di seguito:</span><span class="sxs-lookup"><span data-stu-id="78f9b-136">Whether you have to apply all the log backups depends on what log backup contains the target recovery point, as follows:</span></span>  
  
    -   <span data-ttu-id="78f9b-137">Se il punto di recupero corrisponde al punto in cui si è verificato un errore, è necessario ripristinare tutti i backup del log creati dopo l'ultimo backup dei dati completo o differenziale ripristinato.</span><span class="sxs-lookup"><span data-stu-id="78f9b-137">If the recovery point is the point of a failure, you must restore every log backup that was created since the last data (full or differential) backup you restored.</span></span> <span data-ttu-id="78f9b-138">Per altre informazioni, vedere [Applicazione dei backup di log delle transazioni &#40;SQL Server&#41;](transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-138">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](transaction-log-backups-sql-server.md).</span></span>  
  
    -   <span data-ttu-id="78f9b-139">Nel caso di un ripristino temporizzato, i backup del log più recenti potrebbero non essere necessari.</span><span class="sxs-lookup"><span data-stu-id="78f9b-139">For a point-in-time restore, you might not require the most recent log backups.</span></span> <span data-ttu-id="78f9b-140">Se si utilizza [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], tramite Database Recovery Advisor viene assicurato che vengano selezionati solo i backup necessari per eseguire il ripristino alla temporizzazione specificata.</span><span class="sxs-lookup"><span data-stu-id="78f9b-140">If you use [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], the Database Recovery Advisor ensures that only backups that are required to restore to your specified point in time are selected.</span></span> <span data-ttu-id="78f9b-141">Questi backup costituiscono il piano di ripristino consigliato per il ripristino temporizzato.</span><span class="sxs-lookup"><span data-stu-id="78f9b-141">These backups make up the recommended restore plan for your point-in-time restore.</span></span> <span data-ttu-id="78f9b-142">Per altre informazioni, vedere [Ripristino di un database di SQL Server fino a un punto specifico all'interno di un backup &#40;modello di recupero con registrazione completa&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span><span class="sxs-lookup"><span data-stu-id="78f9b-142">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span></span>  
  
## <a name="restarting-a-restore-sequence"></a><span data-ttu-id="78f9b-143">Riavvio di una sequenza di ripristino</span><span class="sxs-lookup"><span data-stu-id="78f9b-143">Restarting a Restore Sequence</span></span>  
 <span data-ttu-id="78f9b-144">Se l'esito di una sequenza di ripristino viene compromesso da un problema, è possibile interrompere la sequenza e riavviarla dall'inizio.</span><span class="sxs-lookup"><span data-stu-id="78f9b-144">If you encounter a problem with the outcome of a restore sequence, you can quit it and restart the restore sequence over from the start.</span></span> <span data-ttu-id="78f9b-145">Se, ad esempio, si ripristina per errore un numero eccessivo di backup del log e si supera il punto di recupero desiderato, è necessario riavviare la sequenza di ripristino fino al backup del log che contiene il punto di recupero previsto.</span><span class="sxs-lookup"><span data-stu-id="78f9b-145">For example, if you accidentally restore too many log backups and overshoot the intended recovery point, you must restart the restore sequence up to log backup that contains the target recovery point.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="78f9b-146">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="78f9b-146">See Also</span></span>  
 <span data-ttu-id="78f9b-147">[Panoramica del backup &#40;SQL Server&#41;](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-147">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="78f9b-148">[Panoramica del ripristino e del recupero &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-148">[Restore and Recovery Overview &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span></span>  
 <span data-ttu-id="78f9b-149">[Ripristini di database completi &#40;modello di recupero con registrazione completa&#41;](complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-149">[Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="78f9b-150">[Ripristino online &#40;SQL Server&#41;](online-restore-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-150">[Online Restore &#40;SQL Server&#41;](online-restore-sql-server.md) </span></span>  
 <span data-ttu-id="78f9b-151">[Ripristini di file &#40;modello di recupero con registrazione completa&#41;](file-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-151">[File Restores &#40;Full Recovery Model&#41;](file-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="78f9b-152">[Ripristino di pagine &#40;SQL Server&#41;](restore-pages-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="78f9b-152">[Restore Pages &#40;SQL Server&#41;](restore-pages-sql-server.md) </span></span>  
 [<span data-ttu-id="78f9b-153">Ripristini a fasi &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="78f9b-153">Piecemeal Restores &#40;SQL Server&#41;</span></span>](piecemeal-restores-sql-server.md)  
  
  
