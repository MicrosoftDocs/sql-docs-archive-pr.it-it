---
title: Opzione SORT_IN_TEMPDB per gli indici | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- SORT_IN_TEMPDB option
- disk space [SQL Server], indexes
- space [SQL Server], indexes
- tempdb database [SQL Server], indexes
- indexes [SQL Server], tempdb database
- index creation [SQL Server], tempdb database
ms.assetid: 754a003f-fe51-4d10-975a-f6b8c04ebd35
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 8feccc5b1d29617193f481569e10648c6ed77242
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87723852"
---
# <a name="sort_in_tempdb-option-for-indexes"></a><span data-ttu-id="a64d5-102">Opzione SORT_IN_TEMPDB per gli indici</span><span class="sxs-lookup"><span data-stu-id="a64d5-102">SORT_IN_TEMPDB Option For Indexes</span></span>
  <span data-ttu-id="a64d5-103">Quando si crea o si ricompila un indice, l'impostazione dell'opzione SORT_IN_TEMPDB su ON consente a [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] di usare **tempdb** per l'archiviazione dei risultati intermedi dell'ordinamento usati per la compilazione dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-103">When you create or rebuild an index, by setting the SORT_IN_TEMPDB option to ON you can direct the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to use **tempdb** to store the intermediate sort results that are used to build the index.</span></span> <span data-ttu-id="a64d5-104">Questa opzione aumenta lo spazio su disco temporaneo necessario per creare un indice, ma può consentire di creare o ricompilare un indice in tempi più brevi se **tempdb** si trova in un set di dischi diverso rispetto al database utente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-104">Although this option increases the amount of temporary disk space that is used to create an index, the option could reduce the time that is required to create or rebuild an index when **tempdb** is on a set of disks different from that of the user database.</span></span> <span data-ttu-id="a64d5-105">Per altre informazioni su **tempdb**, vedere [Configurare l'opzione di configurazione del server index create memory](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="a64d5-105">For more information about **tempdb**, see [Configure the index create memory Server Configuration Option](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span></span>  
  
## <a name="phases-of-index-building"></a><span data-ttu-id="a64d5-106">Fasi della compilazione di un indice</span><span class="sxs-lookup"><span data-stu-id="a64d5-106">Phases of Index Building</span></span>  
 <span data-ttu-id="a64d5-107">La compilazione di un indice in [!INCLUDE[ssDE](../../includes/ssde-md.md)] include le fasi seguenti:</span><span class="sxs-lookup"><span data-stu-id="a64d5-107">As the [!INCLUDE[ssDE](../../includes/ssde-md.md)] builds an index, it goes through the following phases:</span></span>  
  
-   <span data-ttu-id="a64d5-108">[!INCLUDE[ssDE](../../includes/ssde-md.md)] esegue innanzitutto l'analisi delle pagine di dati della tabella di base per recuperare i valori di chiave e quindi compila una riga foglia dell'indice per ogni riga di dati.</span><span class="sxs-lookup"><span data-stu-id="a64d5-108">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] first scans the data pages of the base table to retrieve key values and builds an index leaf row for each data row.</span></span> <span data-ttu-id="a64d5-109">Quando i buffer di ordinamento interni vengono riempiti completamente con le voci dell'indice di livello foglia, le voci vengono ordinate e scritte su disco come operazione di ordinamento intermedia.</span><span class="sxs-lookup"><span data-stu-id="a64d5-109">When the internal sort buffers have been filled with leaf index entries, the entries are sorted and written to disk as an intermediate sort run.</span></span> <span data-ttu-id="a64d5-110">A questo punto [!INCLUDE[ssDE](../../includes/ssde-md.md)] riprende l'analisi delle pagine di dati fino a quando i buffer di ordinamento non vengono di nuovo riempiti completamente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-110">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] then resumes the data page scan until the sort buffers are again filled.</span></span> <span data-ttu-id="a64d5-111">Questo processo, che prevede l'analisi di più pagine di dati seguita dall'ordinamento e dalla registrazione di un'operazione di ordinamento, continua finché non vengono elaborate tutte le righe della tabella di base.</span><span class="sxs-lookup"><span data-stu-id="a64d5-111">This pattern of scanning multiple data pages followed by sorting and writing a sort run continues until all the rows of the base table have been processed.</span></span>  
  
     <span data-ttu-id="a64d5-112">Poiché in un indice cluster le righe foglia sono le righe dei dati della tabella, le operazioni di ordinamento intermedie includono tutte le righe di dati.</span><span class="sxs-lookup"><span data-stu-id="a64d5-112">In a clustered index, the leaf rows of the index are the data rows of the table; therefore, the intermediate sort runs contain all the data rows.</span></span> <span data-ttu-id="a64d5-113">In un indice non cluster, le righe foglia possono contenere colonne non chiave, ma sono in genere di dimensioni inferiori rispetto a quelle di un indice cluster.</span><span class="sxs-lookup"><span data-stu-id="a64d5-113">In a nonclustered index, the leaf rows may contain nonkey columns, but are generally smaller than a clustered index.</span></span> <span data-ttu-id="a64d5-114">Se le chiavi dell'indice sono di grandi dimensioni o se l'indice contiene numerose colonne non chiave, un'operazione di ordinamento di un indice non cluster può essere estesa.</span><span class="sxs-lookup"><span data-stu-id="a64d5-114">If the index keys are large, or there are several nonkey columns included in the index, a nonclustered sort run can be large.</span></span> <span data-ttu-id="a64d5-115">Per altre informazioni sull'inclusione di colonne non chiave, vedere [Creare indici con colonne incluse](create-indexes-with-included-columns.md).</span><span class="sxs-lookup"><span data-stu-id="a64d5-115">For more information about including nonkey columns, see [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span></span>  
  
-   <span data-ttu-id="a64d5-116">[!INCLUDE[ssDE](../../includes/ssde-md.md)] unisce i vari ordinamenti delle righe foglia dell'indice in un unico flusso ordinato.</span><span class="sxs-lookup"><span data-stu-id="a64d5-116">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] merges the sorted runs of index leaf rows into a single, sorted stream.</span></span> <span data-ttu-id="a64d5-117">Il componente di [!INCLUDE[ssDE](../../includes/ssde-md.md)] che presiede all'unione delle operazioni di ordinamento inizia dalla prima pagina di ogni operazione, trova la chiave minore in tutte le pagine e quindi passa la riga foglia corrispondente al componente per la creazione dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-117">The sort merge component of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts with the first page of each sort run, finds the lowest key in all the pages, and passes that leaf row to the index create component.</span></span> <span data-ttu-id="a64d5-118">Vengono quindi elaborate tutte le altre chiavi, dalla minore alla maggiore.</span><span class="sxs-lookup"><span data-stu-id="a64d5-118">The next lowest key is processed, and then the next, and so on.</span></span> <span data-ttu-id="a64d5-119">Dopo aver estratto l'ultima riga foglia dell'indice da una pagina di un'operazione di ordinamento, il processo passa alla pagina successiva della stessa operazione di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="a64d5-119">When the last leaf index row is extracted from a sort run page, the process shifts to the next page from that sort run.</span></span> <span data-ttu-id="a64d5-120">Quando sono state elaborate tutte le pagine di un extent di un'operazione di ordinamento, l'extent viene liberato.</span><span class="sxs-lookup"><span data-stu-id="a64d5-120">When all the pages in a sort run extent have been processed, the extent is freed.</span></span> <span data-ttu-id="a64d5-121">Ogni riga foglia passata al componente per la creazione dell'indice viene inserita in una pagina foglia dell'indice all'interno del buffer.</span><span class="sxs-lookup"><span data-stu-id="a64d5-121">As each leaf index row is passed to the index create component, it is included in a leaf index page in the buffer.</span></span> <span data-ttu-id="a64d5-122">Ogni pagina foglia viene scritta non appena viene riempita completamente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-122">Each leaf page is written as it is filled.</span></span> <span data-ttu-id="a64d5-123">Man mano che vengono scritte le pagine foglia, [!INCLUDE[ssDE](../../includes/ssde-md.md)] compila inoltre i livelli superiori dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-123">As leaf pages are written, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] also builds the upper levels of the index.</span></span> <span data-ttu-id="a64d5-124">Ogni pagina dell'indice di livello superiore viene scritta non appena viene riempita completamente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-124">Each upper level index page is written when it is filled.</span></span>  
  
## <a name="sort_in_tempdb-option"></a><span data-ttu-id="a64d5-125">SORT_IN_TEMPDB - opzione</span><span class="sxs-lookup"><span data-stu-id="a64d5-125">SORT_IN_TEMPDB Option</span></span>  
 <span data-ttu-id="a64d5-126">Se l'opzione SORT_IN_TEMPDB è impostata su OFF (impostazione predefinita), le operazioni di ordinamento vengono archiviate nel filegroup di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a64d5-126">When SORT_IN_TEMPDB is set to OFF, the default, the sort runs are stored in the destination filegroup.</span></span> <span data-ttu-id="a64d5-127">Durante la prima fase della creazione dell'indice, l'alternarsi delle operazioni di lettura delle pagine della tabella di base e delle operazioni di scrittura delle operazioni di ordinamento comporta lo spostamento delle testine di lettura/scrittura tra le diverse aree del disco.</span><span class="sxs-lookup"><span data-stu-id="a64d5-127">During the first phase of creating the index, the alternating reads of the base table pages and writes of the sort runs move the disk read/write heads from one area of the disk to another.</span></span> <span data-ttu-id="a64d5-128">Le testine si trovano nell'area delle pagine di dati delle quali viene eseguita l'analisi,</span><span class="sxs-lookup"><span data-stu-id="a64d5-128">The heads are in the data page area as the data pages are scanned.</span></span> <span data-ttu-id="a64d5-129">passano a un'area di spazio libero quando vengono riempiti completamente i buffer di ordinamento ed è necessario scrivere su disco l'operazione di ordinamento corrente, quindi tornano all'area delle pagine di dati non appena riprende l'analisi delle pagine della tabella.</span><span class="sxs-lookup"><span data-stu-id="a64d5-129">They move to an area of free space when the sort buffers fill and the current sort run has to be written to disk, and then move back to the data page area as the table page scan is resumed.</span></span> <span data-ttu-id="a64d5-130">Il movimento delle testine di lettura/scrittura è più intenso nella seconda fase,</span><span class="sxs-lookup"><span data-stu-id="a64d5-130">The read/write head movement is greater in the second phase.</span></span> <span data-ttu-id="a64d5-131">durante la quale il processo di ordinamento in genere legge alternativamente le varie aree relative alle operazioni di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="a64d5-131">At that time the sort process is typically alternating reads from each sort run area.</span></span> <span data-ttu-id="a64d5-132">Sia le operazioni di ordinamento che le pagine del nuovo indice vengono compilate nel filegroup di destinazione,</span><span class="sxs-lookup"><span data-stu-id="a64d5-132">Both the sort runs and the new index pages are built in the destination filegroup.</span></span> <span data-ttu-id="a64d5-133">a indicare che mentre [!INCLUDE[ssDE](../../includes/ssde-md.md)] distribuisce le letture tra le operazioni di ordinamento, deve passare periodicamente agli extent dell'indice per scrivere le nuove pagine dell'indice non appena vengono riempite completamente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-133">This means that at the same time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is spreading reads across the sort runs, it has to periodically jump to the index extents to write new index pages as they are filled.</span></span>  
  
 <span data-ttu-id="a64d5-134">Se l'opzione SORT_IN_TEMPDB è impostata su ON e **tempdb** si trova in un set di dischi diverso rispetto al filegroup di destinazione, durante la prima fase le operazioni di lettura delle pagine di dati vengono eseguite in un disco diverso da quello in cui vengono eseguite le operazioni di scrittura nell'area delle operazioni di ordinamento in **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="a64d5-134">If the SORT_IN_TEMPDB option is set to ON and **tempdb** is on a separate set of disks from the destination filegroup, during the first phase, the reads of the data pages occur on a different disk from the writes to the sort work area in **tempdb**.</span></span> <span data-ttu-id="a64d5-135">Di conseguenza, le letture da disco delle chiavi di dati tendono a procedere in modo più seriale nel disco e anche le operazioni di scrittura nel disco di **tempdb** e quelle necessarie per compilare l'indice finale sono seriali.</span><span class="sxs-lookup"><span data-stu-id="a64d5-135">This means the disk reads of the data keys generally continue more serially across the disk, and the writes to the **tempdb** disk also are generally serial, as do the writes to build the final index.</span></span> <span data-ttu-id="a64d5-136">Anche se altri utenti utilizzano il database e accedono a diverse aree dei dischi, lo schema generale di lettura e scrittura risulta più efficiente se viene specificata l'opzione SORT_IN_TEMPDB.</span><span class="sxs-lookup"><span data-stu-id="a64d5-136">Even if other users are using the database and accessing separate disk addresses, the overall pattern of reads and writes are more efficient when SORT_IN_TEMPDB is specified than when it is not.</span></span>  
  
 <span data-ttu-id="a64d5-137">L'opzione SORT_IN_TEMPDB può determinare una maggiore contiguità degli extent degli indici, in particolare se l'operazione CREATE INDEX non viene elaborata in parallelo.</span><span class="sxs-lookup"><span data-stu-id="a64d5-137">The SORT_IN_TEMPDB option may improve the contiguity of index extents, especially if the CREATE INDEX operation is not being processed in parallel.</span></span> <span data-ttu-id="a64d5-138">Gli extent dell'area delle operazioni di ordinamento vengono liberati in modo relativamente casuale rispetto alla relativa posizione nel database.</span><span class="sxs-lookup"><span data-stu-id="a64d5-138">The sort work area extents are freed on a somewhat random basis with regard to their location in the database.</span></span> <span data-ttu-id="a64d5-139">Se le aree delle operazioni di ordinamento sono incluse nel filegroup di destinazione, man mano che vengono liberati gli extent di ordinamento possono essere acquisite dalle richieste di inclusione della struttura dell'indice negli extent mentre la struttura viene compilata.</span><span class="sxs-lookup"><span data-stu-id="a64d5-139">If the sort work areas are contained in the destination filegroup, as the sort work extents are freed, they can be acquired by the requests for extents to hold the index structure as it is built.</span></span> <span data-ttu-id="a64d5-140">In una certa misura, ciò può comportare la distribuzione casuale degli extent dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-140">This can randomize the locations of the index extents to a degree.</span></span> <span data-ttu-id="a64d5-141">Se gli extent di ordinamento sono separati in **tempdb**, la sequenza con cui vengono liberati non influisce sulla posizione degli extent dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-141">If the sort extents are held separately in **tempdb**, the sequence in which they are freed has no effect on the location of the index extents.</span></span> <span data-ttu-id="a64d5-142">Se le operazioni di ordinamento intermedie vengono archiviate in **tempdb** anziché nel filegroup di destinazione, inoltre, in quest'ultimo sarà disponibile una maggiore quantità di spazio</span><span class="sxs-lookup"><span data-stu-id="a64d5-142">Also, when the intermediate sort runs are stored in **tempdb** instead of the destination filegroup, there is more space available in the destination filegroup.</span></span> <span data-ttu-id="a64d5-143">e pertanto aumenteranno le probabilità che gli extent degli indici siano contigui.</span><span class="sxs-lookup"><span data-stu-id="a64d5-143">This increases the chances that index extents will be contiguous.</span></span>  
  
 <span data-ttu-id="a64d5-144">L'opzione SORT_IN_TEMPDB ha effetto solo sull'istruzione corrente.</span><span class="sxs-lookup"><span data-stu-id="a64d5-144">The SORT_IN_TEMPDB option affects only the current statement.</span></span> <span data-ttu-id="a64d5-145">Non sono presenti metadati che indicano se l'indice è stato ordinato o meno in **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="a64d5-145">No metadata records that the index was or was not sorted in **tempdb**.</span></span> <span data-ttu-id="a64d5-146">Ad esempio, se si crea un indice non cluster utilizzando l'opzione SORT_IN_TEMPDB e successivamente si crea un indice cluster senza specificare tale opzione, [!INCLUDE[ssDE](../../includes/ssde-md.md)] non la utilizza per ricreare l'indice non cluster.</span><span class="sxs-lookup"><span data-stu-id="a64d5-146">For example, if you create a nonclustered index using the SORT_IN_TEMPDB option, and at a later time create a clustered index without specifying the option, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] does not use the option when it re-creates the nonclustered index.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a64d5-147">Se un'operazione di ordinamento non è necessaria o può essere eseguita in memoria, l'opzione SORT_IN_TEMPDB viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="a64d5-147">If a sort operation is not required or if the sort can be performed in memory, the SORT_IN_TEMPDB option is ignored.</span></span>  
  
## <a name="disk-space-requirements"></a><span data-ttu-id="a64d5-148">Requisiti relativi allo spazio su disco</span><span class="sxs-lookup"><span data-stu-id="a64d5-148">Disk Space Requirements</span></span>  
 <span data-ttu-id="a64d5-149">Se si imposta l'opzione SORT_IN_TEMPDB su ON, è necessario che lo spazio disponibile su disco di **tempdb** sia sufficiente per contenere le operazioni di ordinamento intermedie e che lo spazio disponibile su disco del filegroup di destinazione sia sufficiente per contenere il nuovo indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-149">When you set the SORT_IN_TEMPDB option to ON, you must have sufficient free disk space available in **tempdb** to hold the intermediate sort runs, and enough free disk space in the destination filegroup to hold the new index.</span></span> <span data-ttu-id="a64d5-150">L'istruzione CREATE INDEX non viene eseguita correttamente se lo spazio libero non è sufficiente e se per qualche motivo non è possibile aumentare automaticamente le dimensioni del database in modo da acquisire lo spazio necessario. Ciò si verifica, ad esempio, se lo spazio su disco è insufficiente oppure se la funzione di aumento automatico delle dimensioni è disattivata.</span><span class="sxs-lookup"><span data-stu-id="a64d5-150">The CREATE INDEX statement fails if there is insufficient free space and there is some reason the databases cannot autogrow to acquire more space, such as no space on the disk or autogrow is set to off.</span></span>  
  
 <span data-ttu-id="a64d5-151">Se l'opzione SORT_IN_TEMPDB è impostata su OFF, lo spazio libero nel filegroup di destinazione deve corrispondere approssimativamente alle dimensioni dell'indice finale.</span><span class="sxs-lookup"><span data-stu-id="a64d5-151">If SORT_IN_TEMPDB is set to OFF, the available free disk space in the destination filegroup must be roughly the size of the final index.</span></span> <span data-ttu-id="a64d5-152">Durante la prima fase vengono compilate le operazioni di ordinamento, che richiedono uno spazio quasi equivalente a quello necessario per l'indice finale.</span><span class="sxs-lookup"><span data-stu-id="a64d5-152">During the first phase, the sort runs are built and require about the same amount of space as the final index.</span></span> <span data-ttu-id="a64d5-153">Durante la seconda fase vengono elaborati e quindi liberati gli extent delle operazioni di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="a64d5-153">During the second phase, each sort run extent is freed after it has been processed.</span></span> <span data-ttu-id="a64d5-154">Poiché tali extent vengono liberati a una velocità analoga a quella con cui vengono acquisiti altri extent destinati alle pagine dell'indice finale, i requisiti di spazio complessivi non superano di molto le dimensioni dell'indice finale.</span><span class="sxs-lookup"><span data-stu-id="a64d5-154">This means that sort run extents are freed at about the same rate at which extents are acquired to hold the final index pages; therefore, the overall space requirements do not greatly exceed the size of the final index.</span></span> <span data-ttu-id="a64d5-155">Uno degli effetti collaterali è rappresentato dal fatto che se la quantità di spazio libero equivale approssimativamente alle dimensioni dell'indice finale, [!INCLUDE[ssDE](../../includes/ssde-md.md)] tenderà a riutilizzare gli extent delle operazioni di ordinamento non appena vengono liberati.</span><span class="sxs-lookup"><span data-stu-id="a64d5-155">One side effect of this is that if the amount of free space is very close to the size of the final index, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] will generally reuse the sort run extents very quickly after they are freed.</span></span> <span data-ttu-id="a64d5-156">Il fatto che gli extent delle operazioni di ordinamento vengano liberati in modo relativamente casuale rende meno continui gli extent dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-156">Because the sort run extents are freed in a somewhat random manner, this reduces the continuity of the index extents in this scenario.</span></span> <span data-ttu-id="a64d5-157">Se l'opzione SORT_IN_TEMPDB è impostata su OFF, la continuità degli extent dell'indice è maggiore se lo spazio libero nel filegroup di destinazione è sufficiente per consentire di allocare gli extent dell'indice da un pool contiguo anziché dagli extent delle operazioni di ordinamento appena deallocati.</span><span class="sxs-lookup"><span data-stu-id="a64d5-157">If SORT_IN_TEMPDB is set to OFF, the continuity of the index extents is improved if there is sufficient free space available in the destination filegroup that the index extents can be allocated from a contiguous pool instead of from the freshly deallocated sort run extents.</span></span>  
  
 <span data-ttu-id="a64d5-158">Quando si crea un indice non cluster, deve essere disponibile una quantità di spazio libero corrispondete alle indicazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a64d5-158">When you create a nonclustered index, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="a64d5-159">Se l'opzione SORT_IN_TEMPDB è impostata su ON, in **tempdb** deve essere disponibile spazio sufficiente per archiviare le operazioni di ordinamento e nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare la struttura finale dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-159">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs, and sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="a64d5-160">Le operazioni di ordinamento includono le righe foglia dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-160">The sort runs contain the leaf rows of the index.</span></span>  
  
-   <span data-ttu-id="a64d5-161">Se l'opzione SORT_IN_TEMPDB è impostata su OFF, nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare la struttura finale dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-161">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final index structure.</span></span> <span data-ttu-id="a64d5-162">È possibile che gli extent dell'indice abbiano una maggiore continuità se è disponibile una maggiore quantità di spazio libero.</span><span class="sxs-lookup"><span data-stu-id="a64d5-162">The continuity of the index extends may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="a64d5-163">Quando si crea un indice cluster in una tabella che non contiene indici non cluster, deve essere disponibile una quantità di spazio libero corrispondente alle indicazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a64d5-163">When you create a clustered index on a table that does not have nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="a64d5-164">Se l'opzione SORT_IN_TEMPDB è impostata su ON, in **tempdb** deve essere disponibile spazio sufficiente per archiviare le operazioni di ordinamento,</span><span class="sxs-lookup"><span data-stu-id="a64d5-164">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs.</span></span> <span data-ttu-id="a64d5-165">incluse le righe di dati della tabella.</span><span class="sxs-lookup"><span data-stu-id="a64d5-165">These include the data rows of the table.</span></span> <span data-ttu-id="a64d5-166">Nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare la struttura finale dell'indice,</span><span class="sxs-lookup"><span data-stu-id="a64d5-166">There must be sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="a64d5-167">incluse le righe di dati della tabella e l'albero B dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-167">This includes the data rows of the table and the index B-tree.</span></span> <span data-ttu-id="a64d5-168">Può essere necessario adeguare tale stima tenendo conto di fattori quali chiavi di grandi dimensioni oppure un fattore di riempimento con un valore basso.</span><span class="sxs-lookup"><span data-stu-id="a64d5-168">You may have to adjust the estimate for factors such as having a large key size or a fill factor with a low value.</span></span>  
  
-   <span data-ttu-id="a64d5-169">Se l'opzione SORT_IN_TEMPDB è impostata su OFF, nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare la tabella finale,</span><span class="sxs-lookup"><span data-stu-id="a64d5-169">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="a64d5-170">inclusa la struttura dell'indice.</span><span class="sxs-lookup"><span data-stu-id="a64d5-170">This includes the index structure.</span></span> <span data-ttu-id="a64d5-171">È possibile che gli extent della tabella e dell'indice abbiano una maggiore continuità se è disponibile una maggiore quantità di spazio libero.</span><span class="sxs-lookup"><span data-stu-id="a64d5-171">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="a64d5-172">Quando si crea un indice cluster in una tabella che contiene indici non cluster, deve essere disponibile una quantità di spazio libero corrispondente alle indicazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a64d5-172">When you create a clustered index on a table that has nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="a64d5-173">Se l'opzione SORT_IN_TEMPDB è impostata su ON, in **tempdb** deve essere disponibile spazio sufficiente per archiviare la raccolta delle operazioni di ordinamento relative all'indice di dimensioni maggiori (in genere l'indice cluster) e nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare le strutture finali di tutti gli indici,</span><span class="sxs-lookup"><span data-stu-id="a64d5-173">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the collection of sort runs for the largest index, typically the clustered index, and sufficient free space in the destination filegroup to store the final structures of all the indexes.</span></span> <span data-ttu-id="a64d5-174">incluso l'indice cluster che contiene le righe di dati della tabella.</span><span class="sxs-lookup"><span data-stu-id="a64d5-174">This includes the clustered index that contains the data rows of the table.</span></span>  
  
-   <span data-ttu-id="a64d5-175">Se l'opzione SORT_IN_TEMPDB è impostata su OFF, nel filegroup di destinazione deve essere disponibile spazio sufficiente per archiviare la tabella finale,</span><span class="sxs-lookup"><span data-stu-id="a64d5-175">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="a64d5-176">incluse le strutture di tutti gli indici.</span><span class="sxs-lookup"><span data-stu-id="a64d5-176">This includes the structures of all the indexes.</span></span> <span data-ttu-id="a64d5-177">È possibile che gli extent della tabella e dell'indice abbiano una maggiore continuità se è disponibile una maggiore quantità di spazio libero.</span><span class="sxs-lookup"><span data-stu-id="a64d5-177">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="a64d5-178">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="a64d5-178">Related Tasks</span></span>  
 [<span data-ttu-id="a64d5-179">CREATE INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a64d5-179">CREATE INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-index-transact-sql)  
  
 [<span data-ttu-id="a64d5-180">Riorganizzare e ricompilare gli indici</span><span class="sxs-lookup"><span data-stu-id="a64d5-180">Reorganize and Rebuild Indexes</span></span>](indexes.md)  
  
## <a name="related-content"></a><span data-ttu-id="a64d5-181">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="a64d5-181">Related Content</span></span>  
 [<span data-ttu-id="a64d5-182">ALTER INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="a64d5-182">ALTER INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-index-transact-sql)  
  
 [<span data-ttu-id="a64d5-183">Configurare l'opzione di configurazione del server index create memory</span><span class="sxs-lookup"><span data-stu-id="a64d5-183">Configure the index create memory Server Configuration Option</span></span>](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md)  
  
 [<span data-ttu-id="a64d5-184">Disk Space Requirements for Index DDL Operations</span><span class="sxs-lookup"><span data-stu-id="a64d5-184">Disk Space Requirements for Index DDL Operations</span></span>](disk-space-requirements-for-index-ddl-operations.md)  
  
  
