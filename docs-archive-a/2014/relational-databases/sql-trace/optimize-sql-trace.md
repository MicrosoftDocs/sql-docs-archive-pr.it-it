---
title: Ottimizzare l'uso di Traccia SQL | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- time [SQL Server], traces
- SQL Trace, performance
- traces [SQL Server], performance
- performance [SQL Server], trace
ms.assetid: 50944218-925f-4576-aec8-4379846d7681
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 831875218423bdb9106d7d84995af1e788da44db
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624544"
---
# <a name="optimize-sql-trace"></a><span data-ttu-id="0c6b9-102">Ottimizzare l'utilizzo di Traccia SQL</span><span class="sxs-lookup"><span data-stu-id="0c6b9-102">Optimize SQL Trace</span></span>
  <span data-ttu-id="0c6b9-103">Sebbene l'esecuzione di Traccia SQL comporti costi di prestazioni significativi, in quanto la funzionalità utilizza le risorse di sistema per raccogliere dati, è possibile adottare numerosi accorgimenti per ridurre tali costi.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-103">Although running SQL Trace incurs a performance cost because it uses system resources to gather data, you can do many things to minimize it.</span></span> <span data-ttu-id="0c6b9-104">Per ridurre i costi di prestazioni provocati dall'utilizzo di una traccia, provare le soluzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c6b9-104">To minimize the performance cost incurred by a trace, try the following:</span></span>  
  
-   <span data-ttu-id="0c6b9-105">Utilizzare il prompt dei comandi per eseguire tracce.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-105">Consider using the command prompt to run traces.</span></span> <span data-ttu-id="0c6b9-106">L'utilizzo di un'interfaccia utente grafica influisce sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-106">Using a graphical user interface hinders performance.</span></span> <span data-ttu-id="0c6b9-107">Per altre informazioni, vedere [sp_trace_create &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-trace-create-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="0c6b9-107">For more information, see [sp_trace_create &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-trace-create-transact-sql).</span></span>  
  
-   <span data-ttu-id="0c6b9-108">Evitare di includere eventi generati di frequente.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-108">Avoid including events that occur frequently.</span></span> <span data-ttu-id="0c6b9-109">Se possibile, limitare la traccia tramite classi di evento e filtri specifici.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-109">If possible, narrow your trace by means of specific event classes and filters.</span></span> <span data-ttu-id="0c6b9-110">Se viene raccolta una quantità minore di eventi di traccia, sarà minore anche la quantità di risorse di sistema necessarie per eseguire la traccia.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-110">If fewer trace events are gathered, fewer system resources are required to support tracing.</span></span>  
  
-   <span data-ttu-id="0c6b9-111">Concentrare la traccia per raccogliere solo gli eventi che forniscono dati pertinenti.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-111">Focus the trace to collect only events that provide relevant data.</span></span> <span data-ttu-id="0c6b9-112">Se, ad esempio, la traccia consiste nell'identificare deadlock, includere la classe di evento **Lock:Deadlock** , ma non **Lock:Acquired** .</span><span class="sxs-lookup"><span data-stu-id="0c6b9-112">For example, if your trace is to identify deadlocks, include the **Lock:Deadlock** event class, but not the **Lock:Acquired** event class.</span></span> <span data-ttu-id="0c6b9-113">Se si includono entrambe le classi di evento, la traccia dovrà rispondere a ogni blocco acquisito e i costi di esecuzione risulteranno raddoppiati.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-113">If you include both event classes, the trace has to respond to every lock that is acquired, and your execution cost is doubled.</span></span>  
  
-   <span data-ttu-id="0c6b9-114">Evitare di raccogliere dati duplicati.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-114">Avoid collecting duplicate data.</span></span> <span data-ttu-id="0c6b9-115">Se, ad esempio, si raccolgono le classi di evento **SQL:BatchStarted** e **SQL:BatchCompleted**, è possibile ridurre le dimensioni dei set di risultati raccogliendo i dati di testo solo per la classe di evento **SQL:BatchStarted** .</span><span class="sxs-lookup"><span data-stu-id="0c6b9-115">For example, if you collect **SQL:BatchStarted** and the **SQL:BatchCompleted**, you can minimize the size of the results set by collecting text data for the **SQL:BatchStarted** event class only.</span></span>  
  
-   <span data-ttu-id="0c6b9-116">Utilizzare filtri nella definizione di traccia.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-116">Use filters in the trace definition.</span></span> <span data-ttu-id="0c6b9-117">Se, ad esempio, un utente segnala prestazioni rallentate durante l'esecuzione di query ad hoc, creare un filtro in **LoginName**.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-117">For example, if you know that a certain user is reporting slow performance during ad hoc queries, create a filter on **LoginName**.</span></span> <span data-ttu-id="0c6b9-118">Impostare il filtro in modo da includere solo gli eventi in cui **LoginName** corrisponde al nome dell'utente.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-118">Set the filter to include only events where the **LoginName** matches that user name.</span></span>  
  
 <span data-ttu-id="0c6b9-119">Se è necessario eseguire una traccia per eventi che comportano un impatto significativo sulle prestazioni, provare a limitare tale impatto nel server utilizzando uno dei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c6b9-119">If you need to run a trace for events that create a significant impact on performance, consider limiting the performance impact on the server by using one of the following methods:</span></span>  
  
-   <span data-ttu-id="0c6b9-120">Eseguire tracce per periodi di tempo inferiori.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-120">Run traces for shorter periods of time.</span></span> <span data-ttu-id="0c6b9-121">È possibile controllare la quantità di tempo impiegata per l'esecuzione di una traccia abilitando un'ora di arresto.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-121">You can control the length of time that a trace runs by enabling a stop time.</span></span> <span data-ttu-id="0c6b9-122">Si tratta di un aspetto particolarmente importante se non è possibile limitare le classi di evento o filtrare un evento.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-122">This is especially important if you cannot limit the event classes or filter an event.</span></span> <span data-ttu-id="0c6b9-123">L'abilitazione di un'ora di arresto garantisce che l'impatto sulle prestazioni non duri all'infinito.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-123">Enabling a stop time ensures that the performance incurred does not last indefinitely.</span></span>  
  
-   <span data-ttu-id="0c6b9-124">Limitare le dimensioni dei risultati della traccia.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-124">Limit the size of the trace results.</span></span> <span data-ttu-id="0c6b9-125">È possibile limitare le dimensioni dei risultati della traccia impostando dimensioni file massime.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-125">You can limit the size of the trace results to a maximum file size.</span></span> <span data-ttu-id="0c6b9-126">Questa strategia assicura l'azzeramento dei costi di prestazioni dopo che sono state raggiunte le dimensioni limite per il file, a condizione che non sia abilitato il rollover dei file.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-126">This strategy ensures that the performance cost stops when the file-size limit is reached (if file rollover is not enabled).</span></span>  
  
-   <span data-ttu-id="0c6b9-127">Limitare il numero di eventi restituiti.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-127">Limit the number of events returned.</span></span> <span data-ttu-id="0c6b9-128">Tramite [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] è possibile limitare il numero di eventi restituiti salvando la traccia in una tabella e impostando il numero massimo di righe.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-128">With [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] you can limit the number of events returned by saving the trace to a table and setting the maximum number of rows.</span></span> <span data-ttu-id="0c6b9-129">I risultati della traccia verranno comunque restituiti nella schermata di [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] dopo il raggiungimento del numero massimo di righe, ma sarà possibile azzerare i costi correlati alla registrazione dei risultati in una tabella.</span><span class="sxs-lookup"><span data-stu-id="0c6b9-129">Trace results are still returned to the [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] screen after the maximum number of rows has been reached, but the cost of recording the results to a table is eliminated.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0c6b9-130">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0c6b9-130">See Also</span></span>  
 [<span data-ttu-id="0c6b9-131">Filtrare una traccia</span><span class="sxs-lookup"><span data-stu-id="0c6b9-131">Filter a Trace</span></span>](../sql-trace/filter-a-trace.md)  
  
  
