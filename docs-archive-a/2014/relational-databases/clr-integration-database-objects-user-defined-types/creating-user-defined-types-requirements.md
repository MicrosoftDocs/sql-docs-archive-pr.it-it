---
title: Requisiti dei tipi definiti dall'utente | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- UDTs [CLR integration], requirements
- serialization
- Native serialization format [CLR integration]
- attributes [CLR integration]
- XML serialization [CLR integration]
- user-defined types [CLR integration], requirements
- user-defined serialization [CLR integration]
- user-defined types [CLR integration], Native serialization
- UDTs [CLR integration], Native serialization
ms.assetid: bedc3372-50eb-40f2-bcf2-d6db6a63b7e6
author: rothja
ms.author: jroth
ms.openlocfilehash: d4e692a4523829713cd95daf62374f84a74b6584
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625422"
---
# <a name="user-defined-type-requirements"></a><span data-ttu-id="7d625-102">Requisiti per i tipi definiti dall'utente</span><span class="sxs-lookup"><span data-stu-id="7d625-102">User-Defined Type Requirements</span></span>
  <span data-ttu-id="7d625-103">Quando si crea un tipo definito dall'utente (UDT) da installare in, è necessario prendere alcune importanti decisioni di progettazione [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7d625-103">You must make several important design decisions when creating a user-defined type (UDT) to be installed in [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7d625-104">Benché nella maggior parte dei casi sia consigliabile creare il tipo definito dall'utente come struttura, la creazione come classe rappresenta un'altra opzione valida.</span><span class="sxs-lookup"><span data-stu-id="7d625-104">For most UDTs, creating the UDT as a structure is recommended, although creating it as a class is also an option.</span></span> <span data-ttu-id="7d625-105">Perché il tipo venga registrato con [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la definizione del tipo definito dall'utente deve essere conforme alle specifiche relative alla creazione di tali tipi.</span><span class="sxs-lookup"><span data-stu-id="7d625-105">The UDT definition must conform to the specifications for creating UDTs in order for it to be registered with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="requirements-for-implementing-udts"></a><span data-ttu-id="7d625-106">Requisiti per l'implementazione di tipi definiti dall'utente</span><span class="sxs-lookup"><span data-stu-id="7d625-106">Requirements for Implementing UDTs</span></span>  
 <span data-ttu-id="7d625-107">Ai fini dell'esecuzione in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], il tipo definito dall'utente deve implementare i requisiti seguenti nella relativa definizione:</span><span class="sxs-lookup"><span data-stu-id="7d625-107">To run in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your UDT must implement the following requirements in the UDT definition:</span></span>  
  
 <span data-ttu-id="7d625-108">Il tipo definito dall'utente deve specificare `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span><span class="sxs-lookup"><span data-stu-id="7d625-108">The UDT must specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span> <span data-ttu-id="7d625-109">L'utilizzo di `System.SerializableAttribute` è facoltativo ma consigliato.</span><span class="sxs-lookup"><span data-stu-id="7d625-109">The use of the `System.SerializableAttribute` is optional, but recommended.</span></span>  
  
-   <span data-ttu-id="7d625-110">Il tipo definito dall'utente deve implementare l'interfaccia `System.Data.SqlTypes.INullable` nella classe o nella struttura creando un metodo `static` (`Shared` in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic) `Null` pubblico.</span><span class="sxs-lookup"><span data-stu-id="7d625-110">The UDT must implement the `System.Data.SqlTypes.INullable` interface in the class or structure by creating a public `static` (`Shared` in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic) `Null` method.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="7d625-111">supporta il valore null per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="7d625-111">is null-aware by default.</span></span> <span data-ttu-id="7d625-112">Questa condizione è necessaria affinché il codice in esecuzione nel tipo definito dall'utente sia in grado di riconoscere un valore Null.</span><span class="sxs-lookup"><span data-stu-id="7d625-112">This is necessary for code executing in the UDT to be able to recognize a null value.</span></span>  
  
-   <span data-ttu-id="7d625-113">Nel tipo definito dall'utente deve essere incluso un metodo `static``Shared` (o `Parse`) che supporti l'analisi e un metodo `ToString` pubblico per la conversione in una rappresentazione di stringa dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="7d625-113">The UDT must contain a public `static` (or `Shared`) `Parse` method that supports parsing from, and a public `ToString` method for converting to a string representation of the object.</span></span>  
  
-   <span data-ttu-id="7d625-114">Un tipo definito dall'utente con un formato di serializzazione definito dall'utente deve implementare l'interfaccia `System.Data.IBinarySerialize` e fornire un metodo `Read` e un metodo `Write`.</span><span class="sxs-lookup"><span data-stu-id="7d625-114">A UDT with a user-defined serialization format must implement the `System.Data.IBinarySerialize` interface and provide a `Read` and a `Write` method.</span></span>  
  
-   <span data-ttu-id="7d625-115">Il tipo definito dall'utente deve implementare `System.Xml.Serialization.IXmlSerializable`. In caso contrario, tutti i campi e le proprietà pubblici devono essere di tipi compatibili con la serializzazione XML o decorati con l'attributo `XmlIgnore` se è necessario sostituire la serializzazione standard.</span><span class="sxs-lookup"><span data-stu-id="7d625-115">The UDT must implement `System.Xml.Serialization.IXmlSerializable`, or all public fields and properties must be of types that are XML serializable or decorated with the `XmlIgnore` attribute if overriding standard serialization is required.</span></span>  
  
-   <span data-ttu-id="7d625-116">È necessario che sia presente solo una serializzazione di un oggetto del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-116">There must be only one serialization of a UDT object.</span></span> <span data-ttu-id="7d625-117">La convalida ha esito negativo se le routine di serializzazione e deserializzazione riconoscono più di una rappresentazione di un oggetto specifico.</span><span class="sxs-lookup"><span data-stu-id="7d625-117">Validation fails if the serialize or deserialize routines recognize more than one representation of a particular object.</span></span>  
  
-   <span data-ttu-id="7d625-118">Per confrontare i dati in base all'ordine dei byte, è necessario che `SqlUserDefinedTypeAttribute.IsByteOrdered` sia `true`.</span><span class="sxs-lookup"><span data-stu-id="7d625-118">`SqlUserDefinedTypeAttribute.IsByteOrdered` must be `true` to compare data in byte order.</span></span> <span data-ttu-id="7d625-119">Se l'interfaccia IComparable non è implementata e `SqlUserDefinedTypeAttribute.IsByteOrdered` è `false`, i confronti in base all'ordine dei byte hanno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="7d625-119">If the IComparable interface is not implemented and `SqlUserDefinedTypeAttribute.IsByteOrdered` is `false`, byte order comparisons will fail.</span></span>  
  
-   <span data-ttu-id="7d625-120">Un tipo definito dall'utente specificato in una classe deve disporre di un costruttore pubblico che non accetta argomenti.</span><span class="sxs-lookup"><span data-stu-id="7d625-120">A UDT defined in a class must have a public constructor that takes no arguments.</span></span> <span data-ttu-id="7d625-121">È eventualmente possibile creare costruttori di classe di overload aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="7d625-121">You can optionally create additional overloaded class constructors.</span></span>  
  
-   <span data-ttu-id="7d625-122">Il tipo definito dall'utente deve esporre elementi dati come campi pubblici o routine di proprietà.</span><span class="sxs-lookup"><span data-stu-id="7d625-122">The UDT must expose data elements as public fields or property procedures.</span></span>  
  
-   <span data-ttu-id="7d625-123">I nomi pubblici non possono contenere più di 128 caratteri e devono essere conformi alle [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] regole di denominazione per gli identificatori come definito negli [identificatori del database](../databases/database-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="7d625-123">Public names cannot be longer than 128 characters, and must conform to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] naming rules for identifiers as defined in [Database Identifiers](../databases/database-identifiers.md).</span></span>  
  
-   <span data-ttu-id="7d625-124">Le colonne `sql_variant` non possono contenere istanze di un tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-124">`sql_variant` columns cannot contain instances of a UDT.</span></span>  
  
-   <span data-ttu-id="7d625-125">I membri ereditati non sono accessibili da [!INCLUDE[tsql](../../includes/tsql-md.md)] perché il sistema dei tipi di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non riconosce la gerarchia di ereditarietà tra tipi definiti dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-125">Inherited members are not accessible from [!INCLUDE[tsql](../../includes/tsql-md.md)] because the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] type system is not aware of the inheritance hierarchy among UDTs.</span></span> <span data-ttu-id="7d625-126">È tuttavia possibile utilizzare l'ereditarietà quando si strutturano le classi ed è possibile chiamare tali metodi nell'implementazione di codice gestito del tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-126">However, you can use inheritance when you structure your classes and you can call such methods in the managed code implementation of the type.</span></span>  
  
-   <span data-ttu-id="7d625-127">Non è possibile eseguire l'overload dei membri, ad eccezione del costruttore della classe.</span><span class="sxs-lookup"><span data-stu-id="7d625-127">Members cannot be overloaded, except for the class constructor.</span></span> <span data-ttu-id="7d625-128">Se si crea un metodo di overload, non viene generato alcun errore quando si registra l'assembly o si crea il tipo in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d625-128">If you do create an overloaded method, no error is raised when you register the assembly or create the type in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7d625-129">Il rilevamento del metodo di overload si verifica in fase di esecuzione e non durante la creazione del tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-129">Detection of the overloaded method occurs at run time, not when the type is created.</span></span> <span data-ttu-id="7d625-130">Nella classe possono essere presenti metodi di overload, a condizione che non vengano mai richiamati.</span><span class="sxs-lookup"><span data-stu-id="7d625-130">Overloaded methods can exist in the class as long as they are never invoked.</span></span> <span data-ttu-id="7d625-131">Quando si richiama il metodo di overload, viene generato un errore.</span><span class="sxs-lookup"><span data-stu-id="7d625-131">Once you invoke the overloaded method, an error is raised.</span></span>  
  
-   <span data-ttu-id="7d625-132">Qualsiasi membro `static` (o `Shared`) deve essere dichiarato come costante o come di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="7d625-132">Any `static` (or `Shared`) members must be declared as constants or as read-only.</span></span> <span data-ttu-id="7d625-133">I membri statici non possono essere modificati.</span><span class="sxs-lookup"><span data-stu-id="7d625-133">Static members cannot be mutable.</span></span>  
  
-   <span data-ttu-id="7d625-134">Se il campo `SqlUserDefinedTypeAttribute.MaxByteSize` è impostato su -1, le dimensioni del tipo definito dall'utente serializzato possono raggiungere il limite di dimensioni per gli oggetti LOB (attualmente 2 GB).</span><span class="sxs-lookup"><span data-stu-id="7d625-134">If the `SqlUserDefinedTypeAttribute.MaxByteSize` field is set to -1, the serialized UDT can be as large as the large object (LOB) size limit (currently 2 GB).</span></span> <span data-ttu-id="7d625-135">Le dimensioni del tipo definito dall'utente non possono superare il valore specificato nel campo `MaxByteSized`.</span><span class="sxs-lookup"><span data-stu-id="7d625-135">The size of the UDT cannot exceed the value specified in the `MaxByteSized` field.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d625-136">Benché non venga utilizzata dal server per l'esecuzione di confronti, è eventualmente possibile implementare l'interfaccia `System.IComparable`, che espone un singolo metodo, ovvero `CompareTo`.</span><span class="sxs-lookup"><span data-stu-id="7d625-136">Although it is not used by the server for performing comparisons, you can optionally implement the `System.IComparable` interface, which exposes a single method, `CompareTo`.</span></span> <span data-ttu-id="7d625-137">Tale metodo viene utilizzato sul lato client in situazioni in cui è preferibile confrontare o ordinare in modo accurato i valori del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-137">This is used on the client side in situations in which it is desirable to accurately compare or order UDT values.</span></span>  
  
## <a name="native-serialization"></a><span data-ttu-id="7d625-138">Serializzazione nativa</span><span class="sxs-lookup"><span data-stu-id="7d625-138">Native Serialization</span></span>  
 <span data-ttu-id="7d625-139">La scelta degli attributi di serializzazione corretti per il tipo definito dall'utente dipende dal tipo definito dall'utente che si desidera creare.</span><span class="sxs-lookup"><span data-stu-id="7d625-139">Choosing the right serialization attributes for your UDT depends on the type of UDT you are trying to create.</span></span> <span data-ttu-id="7d625-140">Nel formato di serializzazione `Native` viene utilizzata una struttura molto semplice che consente a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di archiviare una rappresentazione nativa efficace del tipo definito dall'utente nel disco.</span><span class="sxs-lookup"><span data-stu-id="7d625-140">The `Native` serialization format utilizes a very simple structure that enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to store an efficient native representation of the UDT on disk.</span></span> <span data-ttu-id="7d625-141">Il formato `Native` rappresenta la scelta consigliata se il tipo definito dall'utente è semplice e contiene solo campi dei tipi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d625-141">The `Native` format is recommended if the UDT is simple and only contains fields of the following types:</span></span>  
  
 <span data-ttu-id="7d625-142">**bool**, **byte**, **SByte**, **short**, **ushort**, **int**, **uint**, **Long**, **ULONG**, **float**, **Double**, **SqlByte**, **SqlInt16**, **SqlInt32**, **SqlInt64**, **SqlDateTime**, **SqlSingle**, **SqlDouble**, **SqlMoney**, **SqlBoolean**</span><span class="sxs-lookup"><span data-stu-id="7d625-142">**bool**, **byte**, **sbyte**, **short**, **ushort**, **int**, **uint**, **long**, **ulong**, **float**, **double**, **SqlByte**, **SqlInt16**, **SqlInt32**, **SqlInt64**, **SqlDateTime**, **SqlSingle**, **SqlDouble**, **SqlMoney**, **SqlBoolean**</span></span>  
  
 <span data-ttu-id="7d625-143">I tipi di valore composti da campi dei tipi precedenti sono candidati validi per il `Native` formato, ad esempio `structs` in Visual C# (o `Structures` come sono noti in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7d625-143">Value types that are composed of fields of the above types are good candidates for `Native` format, such as `structs` in Visual C#, (or `Structures` as they are known in Visual Basic).</span></span> <span data-ttu-id="7d625-144">Un tipo definito dall'utente specificato, ad esempio, con il formato di serializzazione `Native` può contenere un campo di un altro tipo definito dall'utente specificato anch'esso con il formato `Native`.</span><span class="sxs-lookup"><span data-stu-id="7d625-144">For example, a UDT specified with the `Native` serialization format may contain a field of another UDT that was also specified with the `Native` format.</span></span> <span data-ttu-id="7d625-145">Se la definizione del tipo definito dall'utente è più complessa e contiene tipi di dati non inclusi nell'elenco precedente, è invece necessario specificare il formato di serializzazione `UserDefined`.</span><span class="sxs-lookup"><span data-stu-id="7d625-145">If the UDT definition is more complex and contains data types not on the above list, you must specify the `UserDefined` serialization format instead.</span></span>  
  
 <span data-ttu-id="7d625-146">Il formato `Native` deve soddisfare i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d625-146">The `Native` format has the following requirements:</span></span>  
  
-   <span data-ttu-id="7d625-147">Il tipo non deve specificare un valore per `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize`.</span><span class="sxs-lookup"><span data-stu-id="7d625-147">The type must not specify a value for `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize`.</span></span>  
  
-   <span data-ttu-id="7d625-148">Tutti i campi devono essere serializzabili.</span><span class="sxs-lookup"><span data-stu-id="7d625-148">All fields must be serializable.</span></span>  
  
-   <span data-ttu-id="7d625-149">`System.Runtime.InteropServices.StructLayoutAttribute` deve essere specificato come `StructLayout.LayoutKindSequential` se il tipo definito dall'utente è specificato in una classe e non in una struttura.</span><span class="sxs-lookup"><span data-stu-id="7d625-149">The `System.Runtime.InteropServices.StructLayoutAttribute` must be specified as `StructLayout.LayoutKindSequential` if the UDT is defined in a class and not a structure.</span></span> <span data-ttu-id="7d625-150">Questo attributo controlla il layout fisico dei campi dati e viene utilizzato per forzare la disposizione dei membri in base all'ordine in cui vengono visualizzati.</span><span class="sxs-lookup"><span data-stu-id="7d625-150">This attribute controls the physical layout of the data fields and is used to force the members to be laid out in the order in which they appear.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="7d625-151">utilizza questo attributo per determinare l'ordine dei campi per i tipi definiti dall'utente con più valori.</span><span class="sxs-lookup"><span data-stu-id="7d625-151">uses this attribute to determine the field order for UDTs with multiple values.</span></span>  
  
 <span data-ttu-id="7d625-152">Per un esempio di un tipo definito dall' `Native` utente definito con la serializzazione, vedere il tipo definito dall'utente Point in [codifica dei tipi definiti dall'utente](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="7d625-152">For an example of a UDT defined with `Native` serialization, see the Point UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="userdefined-serialization"></a><span data-ttu-id="7d625-153">Serializzazione UserDefined</span><span class="sxs-lookup"><span data-stu-id="7d625-153">UserDefined Serialization</span></span>  
 <span data-ttu-id="7d625-154">L'impostazione del formato `UserDefined` per l'attributo `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` garantisce allo sviluppatore il controllo completo sul formato binario.</span><span class="sxs-lookup"><span data-stu-id="7d625-154">The `UserDefined` format setting for the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute gives the developer full control over the binary format.</span></span> <span data-ttu-id="7d625-155">Quando si specifica la proprietà dell'attributo `Format` come `UserDefined`, è necessario effettuare le operazioni seguenti nel codice:</span><span class="sxs-lookup"><span data-stu-id="7d625-155">When specifying the `Format` attribute property as `UserDefined`, you must do the following in your code:</span></span>  
  
-   <span data-ttu-id="7d625-156">Specificare la proprietà dell'attributo `IsByteOrdered` facoltativa.</span><span class="sxs-lookup"><span data-stu-id="7d625-156">Specify the optional `IsByteOrdered` attribute property.</span></span> <span data-ttu-id="7d625-157">Il valore predefinito è `false`.</span><span class="sxs-lookup"><span data-stu-id="7d625-157">The default value is `false`.</span></span>  
  
-   <span data-ttu-id="7d625-158">Specificare la proprietà `MaxByteSize` di `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span><span class="sxs-lookup"><span data-stu-id="7d625-158">Specify the `MaxByteSize` property of the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span>  
  
-   <span data-ttu-id="7d625-159">Scrivere il codice per implementare i metodi `Read` e `Write` per il tipo definito dall'utente implementando l'interfaccia `System.Data.Sql.IBinarySerialize`.</span><span class="sxs-lookup"><span data-stu-id="7d625-159">Write code to implement `Read` and `Write` methods for the UDT by implementing the `System.Data.Sql.IBinarySerialize` interface.</span></span>  
  
 <span data-ttu-id="7d625-160">Per un esempio di un tipo definito dall' `UserDefined` utente definito con la serializzazione, vedere il tipo definito dall'utente Currency in [codifica dei tipi definiti dall'utente](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="7d625-160">For an example of a UDT defined with `UserDefined` serialization, see the Currency UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7d625-161">Ai fini dell'indicizzazione, i campi con tipo definito dall'utente devono utilizzare la serializzazione nativa o essere resi persistenti.</span><span class="sxs-lookup"><span data-stu-id="7d625-161">UDT fields must use native serialization or be persisted in order to be indexed.</span></span>  
  
## <a name="serialization-attributes"></a><span data-ttu-id="7d625-162">Attributi di serializzazione</span><span class="sxs-lookup"><span data-stu-id="7d625-162">Serialization Attributes</span></span>  
 <span data-ttu-id="7d625-163">Gli attributi consentono di determinare la modalità di utilizzo della serializzazione per costruire la rappresentazione di archiviazione dei tipi definiti dall'utente e per trasmettere tali tipi al client in base al valore.</span><span class="sxs-lookup"><span data-stu-id="7d625-163">Attributes determine how serialization is used to construct the storage representation of UDTs and to transmit UDTs by value to the client.</span></span> <span data-ttu-id="7d625-164">Quando si crea il tipo definito dall'utente, viene richiesto di specificare `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span><span class="sxs-lookup"><span data-stu-id="7d625-164">You are required to specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` when creating the UDT.</span></span> <span data-ttu-id="7d625-165">L'attributo `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` indica che la classe è un tipo definito dall'utente e specifica l'archiviazione per il tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-165">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute indicates that the class is a UDT and specifies the storage for the UDT.</span></span> <span data-ttu-id="7d625-166">È eventualmente possibile specificare l'attributo `Serializable`, anche se non è necessario in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d625-166">You can optionally specify the `Serializable` attribute, although [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not require this.</span></span>  
  
 <span data-ttu-id="7d625-167">`Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` include le proprietà indicate di seguito.</span><span class="sxs-lookup"><span data-stu-id="7d625-167">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` has the following properties.</span></span>  
  
 `Format`  
 <span data-ttu-id="7d625-168">Specifica il formato di serializzazione, che può essere `Native` o `UserDefined` a seconda dei tipi di dati del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-168">Specifies the serialization format, which can be `Native` or `UserDefined`, depending on the data types of the UDT.</span></span>  
  
 `IsByteOrdered`  
 <span data-ttu-id="7d625-169">Valore `Boolean` che determina la modalità di esecuzione dei confronti binari nel tipo definito dall'utente in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d625-169">A `Boolean` value that determines how [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performs binary comparisons on the UDT.</span></span>  
  
 `IsFixedLength`  
 <span data-ttu-id="7d625-170">Indica se tutte le istanze del tipo definito dall'utente sono della stessa lunghezza.</span><span class="sxs-lookup"><span data-stu-id="7d625-170">Indicates whether all instances of this UDT are the same length.</span></span>  
  
 `MaxByteSize`  
 <span data-ttu-id="7d625-171">Dimensioni massime, in byte, dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="7d625-171">The maximum size of the instance, in bytes.</span></span> <span data-ttu-id="7d625-172">È necessario specificare `MaxByteSize` con il formato di serializzazione `UserDefined`.</span><span class="sxs-lookup"><span data-stu-id="7d625-172">You must specify `MaxByteSize` with the `UserDefined` serialization format.</span></span> <span data-ttu-id="7d625-173">Per un tipo definito dall'utente per cui è specificata una serializzazione definita dall'utente, `MaxByteSize` si riferisce alle dimensioni totali del tipo definito dall'utente nel formato serializzato definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-173">For a UDT with user-defined serialization specified, `MaxByteSize` refers to the total size of the UDT in its serialized form as defined by the user.</span></span> <span data-ttu-id="7d625-174">Il valore di `MaxByteSize` deve essere compreso nell'intervallo tra 1 e 8000 o impostato su -1 a indicare che il tipo definito dall'utente è maggiore di 8000 byte (le dimensioni totali non possono superare le dimensioni LOB massime).</span><span class="sxs-lookup"><span data-stu-id="7d625-174">The value of `MaxByteSize` must be in the range of 1 to 8000, or set to -1 to indicate that the UDT is greater than 8000 bytes (the total size cannot exceed the maximum LOB size).</span></span> <span data-ttu-id="7d625-175">Si consideri un tipo definito dall'utente con una proprietà di una stringa di 10 caratteri (`System.Char`).</span><span class="sxs-lookup"><span data-stu-id="7d625-175">Consider a UDT with a property of a string of 10 characters (`System.Char`).</span></span> <span data-ttu-id="7d625-176">Quando il tipo definito dall'utente viene serializzato utilizzando un oggetto BinaryWriter, le dimensioni totali della stringa serializzata sono pari a 22 byte per ciascun carattere Unicode UTF-16, moltiplicati per il numero massimo di caratteri, più 2 byte di controllo per l'overhead generato dalla serializzazione di un flusso binario.</span><span class="sxs-lookup"><span data-stu-id="7d625-176">When the UDT is serialized by using a BinaryWriter, the total size of the serialized string is 22 bytes: 2 bytes per Unicode UTF-16 character, multiplied by the maximum number of characters, plus 2 control bytes of overhead incurred from serializing a binary stream.</span></span> <span data-ttu-id="7d625-177">Di conseguenza, nel determinare il valore di `MaxByteSize`, è necessario considerare le dimensioni totali del tipo definito dall'utente serializzato, ovvero le dimensioni dei dati serializzati in formato binario più l'overhead generato dalla serializzazione.</span><span class="sxs-lookup"><span data-stu-id="7d625-177">Therefore, when determining the value of `MaxByteSize`, the total size of the serialized UDT must be considered: the size of the data serialized in binary form plus the overhead incurred by serialization.</span></span>  
  
 `ValidationMethodName`  
 <span data-ttu-id="7d625-178">Nome del metodo utilizzato per convalidare le istanze del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-178">The name of the method used to validate instances of the UDT.</span></span>  
  
### <a name="setting-isbyteordered"></a><span data-ttu-id="7d625-179">Impostazione di IsByteOrdered</span><span class="sxs-lookup"><span data-stu-id="7d625-179">Setting IsByteOrdered</span></span>  
 <span data-ttu-id="7d625-180">Impostando la proprietà `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` su `true`, si garantisce che i dati binari serializzati possono essere utilizzati per l'ordinamento semantico delle informazioni.</span><span class="sxs-lookup"><span data-stu-id="7d625-180">When the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` property is set to `true`, you are in effect guaranteeing that the serialized binary data can be used for semantic ordering of the information.</span></span> <span data-ttu-id="7d625-181">In questo modo, ogni istanza di un oggetto del tipo definito dall'utente ordinato per byte può disporre di una sola rappresentazione serializzata.</span><span class="sxs-lookup"><span data-stu-id="7d625-181">Thus, each instance of a byte-ordered UDT object can only have one serialized representation.</span></span> <span data-ttu-id="7d625-182">Se in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] viene eseguita un'operazione di confronto sui byte serializzati, i risultati di tale operazione dovranno essere identici a quelli di un caso in cui la stessa operazione di confronto venga eseguita nel codice gestito.</span><span class="sxs-lookup"><span data-stu-id="7d625-182">When a comparison operation is performed in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the serialized bytes, its results should be the same as if the same comparison operation had taken place in managed code.</span></span> <span data-ttu-id="7d625-183">Se la proprietà `IsByteOrdered` è impostata su `true`, sono supportate le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d625-183">The following features are also supported when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="7d625-184">Capacità di creare indici nelle colonne di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-184">The ability to create indexes on columns of this type.</span></span>  
  
-   <span data-ttu-id="7d625-185">Capacità di creare chiavi primarie ed esterne, nonché vincoli CHECK e UNIQUE sulle colonne di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-185">The ability to create primary and foreign keys as well as CHECK and UNIQUE constraints on columns of this type.</span></span>  
  
-   <span data-ttu-id="7d625-186">Capacità di utilizzare le clausole [!INCLUDE[tsql](../../includes/tsql-md.md)] ORDER BY, GROUP BY e PARTITION BY.</span><span class="sxs-lookup"><span data-stu-id="7d625-186">The ability to use [!INCLUDE[tsql](../../includes/tsql-md.md)] ORDER BY, GROUP BY, and PARTITION BY clauses.</span></span> <span data-ttu-id="7d625-187">In questi casi, per determinare l'ordine viene utilizzata la rappresentazione binaria del tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-187">In these cases, the binary representation of the type is used to determine the order.</span></span>  
  
-   <span data-ttu-id="7d625-188">Capacità di utilizzare operatori di confronto in istruzioni [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d625-188">The ability to use comparison operators in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   <span data-ttu-id="7d625-189">Capacità di garantire la persistenza delle colonne calcolate di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="7d625-189">The ability to persist computed columns of this type.</span></span>  
  
 <span data-ttu-id="7d625-190">Si noti che i formati di serializzazione `Native` e `UserDefined` supportano gli operatori di confronto seguenti quando `IsByteOrdered` è impostato su `true`.</span><span class="sxs-lookup"><span data-stu-id="7d625-190">Note that both the `Native` and `UserDefined` serialization formats support the following comparison operators when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="7d625-191">Uguale a (=)</span><span class="sxs-lookup"><span data-stu-id="7d625-191">Equal to (=)</span></span>  
  
-   <span data-ttu-id="7d625-192">Diverso da (!=)</span><span class="sxs-lookup"><span data-stu-id="7d625-192">Not equal to (!=)</span></span>  
  
-   <span data-ttu-id="7d625-193">Maggiore di (>)</span><span class="sxs-lookup"><span data-stu-id="7d625-193">Greater than (>)</span></span>  
  
-   <span data-ttu-id="7d625-194">Minore di (\<)</span><span class="sxs-lookup"><span data-stu-id="7d625-194">Less than (\<)</span></span>  
  
-   <span data-ttu-id="7d625-195">Maggiore o uguale a (>=)</span><span class="sxs-lookup"><span data-stu-id="7d625-195">Greater than or equal to (>=)</span></span>  
  
-   <span data-ttu-id="7d625-196">Minore o uguale a (&lt;=)</span><span class="sxs-lookup"><span data-stu-id="7d625-196">Less than or equal to (<=)</span></span>  
  
### <a name="implementing-nullability"></a><span data-ttu-id="7d625-197">Implementazione del supporto dei valori Null</span><span class="sxs-lookup"><span data-stu-id="7d625-197">Implementing Nullability</span></span>  
 <span data-ttu-id="7d625-198">Oltre a specificare correttamente gli attributi per gli assembly, la classe deve inoltre supportare i valori Null.</span><span class="sxs-lookup"><span data-stu-id="7d625-198">In addition to specifying the attributes for your assemblies correctly, your class must also support nullability.</span></span> <span data-ttu-id="7d625-199">Benché i tipi definiti dall'utente caricati in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] supportino i valori Null, perché un tipo definito dall'utente possa riconoscere un valore Null è necessario che la classe implementi l'interfaccia `INullable`.</span><span class="sxs-lookup"><span data-stu-id="7d625-199">UDTs loaded into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are null-aware, but in order for the UDT to recognize a null value, the class must implement the `INullable` interface.</span></span> <span data-ttu-id="7d625-200">Per ulteriori informazioni e un esempio di come implementare il supporto di valori null in un tipo definito dall'utente, vedere [codifica di tipi definiti dall'utente](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="7d625-200">For more information and an example of how to implement nullability in a UDT, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
### <a name="string-conversions"></a><span data-ttu-id="7d625-201">Conversioni di stringhe</span><span class="sxs-lookup"><span data-stu-id="7d625-201">String Conversions</span></span>  
 <span data-ttu-id="7d625-202">Per supportare la conversione di stringhe da e verso il tipo definito dall'utente, è necessario fornire un metodo `Parse` e un metodo `ToString` nella classe.</span><span class="sxs-lookup"><span data-stu-id="7d625-202">To support string conversion to and from the UDT, you must provide a `Parse` method and a `ToString` method in your class.</span></span> <span data-ttu-id="7d625-203">Il metodo `Parse` consente la conversione di una stringa in un tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-203">The `Parse` method allows a string to be converted into a UDT.</span></span> <span data-ttu-id="7d625-204">Tale metodo deve essere dichiarato come `static` (o `Shared` in Visual Basic) e accetta un parametro di tipo `System.Data.SqlTypes.SqlString`.</span><span class="sxs-lookup"><span data-stu-id="7d625-204">It must be declared as `static` (or `Shared` in Visual Basic), and take a parameter of type `System.Data.SqlTypes.SqlString`.</span></span> <span data-ttu-id="7d625-205">Per ulteriori informazioni e un esempio di come implementare i `Parse` metodi e `ToString` , vedere [codifica di tipi definiti dall'utente](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="7d625-205">For more information and an example of how to implement the `Parse` and `ToString` methods, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="xml-serialization"></a><span data-ttu-id="7d625-206">Serializzazione XML</span><span class="sxs-lookup"><span data-stu-id="7d625-206">XML Serialization</span></span>  
 <span data-ttu-id="7d625-207">I tipi definiti dall'utente devono supportare la conversione da e verso il tipo di dati `xml` rispettando la conformità al contratto per la serializzazione XML.</span><span class="sxs-lookup"><span data-stu-id="7d625-207">UDTs must support conversion to and from the `xml` data type by conforming to the contract for XML serialization.</span></span> <span data-ttu-id="7d625-208">Lo spazio dei nomi `System.Xml.Serialization` contiene classi utilizzate per serializzare oggetti in documenti o flussi in formato XML.</span><span class="sxs-lookup"><span data-stu-id="7d625-208">The `System.Xml.Serialization` namespace contains classes that are used to serialize objects into XML format documents or streams.</span></span> <span data-ttu-id="7d625-209">È possibile scegliere di implementare la serializzazione `xml` utilizzando l'interfaccia `IXmlSerializable`, che fornisce formattazione personalizzata per la serializzazione e la deserializzazione XML.</span><span class="sxs-lookup"><span data-stu-id="7d625-209">You can choose to implement `xml` serialization by using the `IXmlSerializable` interface, which provides custom formatting for XML serialization and deserialization.</span></span>  
  
 <span data-ttu-id="7d625-210">Oltre a eseguire conversioni esplicite dal tipo definito dall'utente a `xml`, la serializzazione XML consente di effettuare le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d625-210">In addition to performing explicit conversions from UDT to `xml`, XML serialization enables you to:</span></span>  
  
-   <span data-ttu-id="7d625-211">Utilizzare `Xquery` su valori di istanze del tipo definito dall'utente dopo la conversione al tipo di dati `xml`.</span><span class="sxs-lookup"><span data-stu-id="7d625-211">Use `Xquery` over values of UDT instances after conversion to the `xml` data type.</span></span>  
  
-   <span data-ttu-id="7d625-212">Utilizzare i tipi definiti dall'utente (UDT) in metodi Web e query con parametri con i servizi Web XML nativi in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7d625-212">Use UDTs in parameterized queries and Web methods with Native XML Web Services in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="7d625-213">Utilizzare i tipi definiti dall'utente per ricevere un caricamento bulk di dati XML.</span><span class="sxs-lookup"><span data-stu-id="7d625-213">Use UDTs to receive a bulk load of XML data.</span></span>  
  
-   <span data-ttu-id="7d625-214">Serializzare set di dati che contengono tabelle con colonne del tipo definito dall'utente.</span><span class="sxs-lookup"><span data-stu-id="7d625-214">Serialize DataSets that contain tables with UDT columns.</span></span>  
  
 <span data-ttu-id="7d625-215">I tipi definiti dall'utente non vengono serializzati nelle query FOR XML.</span><span class="sxs-lookup"><span data-stu-id="7d625-215">UDTs are not serialized in FOR XML queries.</span></span> <span data-ttu-id="7d625-216">Per eseguire una query FOR XML che visualizza la serializzazione XML dei tipi definiti dall'utente, convertire in modo esplicito ogni colonna del tipo definito dall'utente nel tipo di dati `xml` nell'istruzione SELECT.</span><span class="sxs-lookup"><span data-stu-id="7d625-216">To execute a FOR XML query that displays the XML serialization of UDTs, explicitly convert each UDT column to the `xml` data type in the SELECT statement.</span></span> <span data-ttu-id="7d625-217">È inoltre possibile convertire esplicitamente le colonne in `varbinary`, `varchar` o `nvarchar`.</span><span class="sxs-lookup"><span data-stu-id="7d625-217">You can also explicitly convert the columns to `varbinary`, `varchar`, or `nvarchar`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7d625-218">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="7d625-218">See Also</span></span>  
 [<span data-ttu-id="7d625-219">Creazione di un tipo definito dall'utente</span><span class="sxs-lookup"><span data-stu-id="7d625-219">Creating a User-Defined Type</span></span>](creating-user-defined-types.md)  
  
  
