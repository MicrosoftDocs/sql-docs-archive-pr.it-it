---
title: SQLSetStmtAttr | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628668"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="2fcce-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="2fcce-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="2fcce-103">Il driver ODBC di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client non supporta il modello di cursore misto (keyset/dinamico).</span><span class="sxs-lookup"><span data-stu-id="2fcce-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="2fcce-104">I tentativi di impostare la dimensione del keyset utilizzando SQL_ATTR_KEYSET_SIZE non riescono se il set di valori non è uguale a 0.</span><span class="sxs-lookup"><span data-stu-id="2fcce-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="2fcce-105">L'applicazione imposta SQL_ATTR_ROW_ARRAY_SIZE in tutte le istruzioni per dichiarare il numero di righe restituite in una chiamata di funzione **SQLFetch** o [SQLFetchScroll](sqlfetchscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="2fcce-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="2fcce-106">Nelle istruzioni che indicano un cursore del server il driver utilizza SQL_ATTR_ROW_ARRAY_SIZE per determinare la dimensione del blocco di righe che il server genera per soddisfare una richiesta di recupero dal cursore.</span><span class="sxs-lookup"><span data-stu-id="2fcce-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="2fcce-107">Nelle dimensioni del blocco di un cursore dinamico, l'ordinamento e l'appartenenza delle righe sono fissi se il livello di isolamento della transazione è sufficiente per assicurare letture ripetibili delle transazioni di cui è stato eseguito il commit.</span><span class="sxs-lookup"><span data-stu-id="2fcce-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="2fcce-108">Il cursore è completamente dinamico al di fuori del blocco indicato da questo valore.</span><span class="sxs-lookup"><span data-stu-id="2fcce-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="2fcce-109">Le dimensioni del blocco del cursore del server sono completamente dinamiche e possono essere modificate in qualsiasi momento durante l'elaborazione del recupero.</span><span class="sxs-lookup"><span data-stu-id="2fcce-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="2fcce-110">SQLSetStmtAttr e parametri con valori di tabella</span><span class="sxs-lookup"><span data-stu-id="2fcce-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="2fcce-111">SQLSetStmtAttr può essere usato per impostare SQL_SOPT_SS_PARAM_FOCUS nel descrittore del parametro dell'applicazione (APD) prima di accedere ai campi del descrittore per le colonne dei parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="2fcce-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="2fcce-112">Se viene effettuato un tentativo di impostare SQL_SOPT_SS_PARAM_FOCUS sull'ordinale di un parametro che non è un parametro con valori di tabella, SQLSetStmtAttr restituisce SQL_ERROR e viene creato un record di diagnostica con SQLSTATE = HY024 e il messaggio "valore attributo non valido".</span><span class="sxs-lookup"><span data-stu-id="2fcce-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="2fcce-113">SQL_SOPT_SS_PARAM_FOCUS non viene modificato al momento della restituzione di SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="2fcce-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="2fcce-114">L'impostazione di SQL_SOPT_SS_PARAM_FOCUS su 0 ripristina l'accesso ai record del descrittore per i parametri.</span><span class="sxs-lookup"><span data-stu-id="2fcce-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="2fcce-115">SQLSetStmtAttr può essere usato anche per impostare SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="2fcce-116">Per ulteriori informazioni, vedere la sezione SQL_SOPT_SS_NAME_SCOPE più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="2fcce-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="2fcce-117">Per ulteriori informazioni, vedere [metadati dei parametri con valori di tabella per le istruzioni preparate](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span><span class="sxs-lookup"><span data-stu-id="2fcce-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="2fcce-118">Per ulteriori informazioni sui parametri con valori di tabella, vedere [parametri con valori di tabella &#40;&#41;ODBC ](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="2fcce-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="2fcce-119">Supporto di SQLSetStmtAttr per colonne di tipo sparse</span><span class="sxs-lookup"><span data-stu-id="2fcce-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="2fcce-120">SQLSetStmtAttr può essere utilizzato per impostare SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="2fcce-121">Per ulteriori informazioni, vedere la sezione SQL_SOPT_SS_NAME_SCOPE più avanti in questo argomento. Per ulteriori informazioni sulle colonne di tipo sparse, vedere [supporto di colonne di tipo sparse &#40;&#41;ODBC ](../native-client/odbc/sparse-columns-support-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="2fcce-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="2fcce-122">Attributi di istruzione</span><span class="sxs-lookup"><span data-stu-id="2fcce-122">Statement Attributes</span></span>  
 <span data-ttu-id="2fcce-123">Il driver ODBC di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client supporta anche gli attributi di istruzione seguenti specifici del driver.</span><span class="sxs-lookup"><span data-stu-id="2fcce-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="2fcce-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="2fcce-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="2fcce-125">L'attributo SQL_SOPT_SS_CURSOR specifica se il driver utilizzerà opzioni delle prestazioni specifiche del driver sui cursori.</span><span class="sxs-lookup"><span data-stu-id="2fcce-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="2fcce-126">[SQLGetData](sqlgetdata.md) non è consentito quando queste opzioni sono impostate.</span><span class="sxs-lookup"><span data-stu-id="2fcce-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="2fcce-127">L'impostazione predefinita è SQL_CO_OFF.</span><span class="sxs-lookup"><span data-stu-id="2fcce-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="2fcce-128">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="2fcce-129">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-129">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-130">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="2fcce-131">SQL_CO_OFF</span></span>|<span data-ttu-id="2fcce-132">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-132">Default.</span></span> <span data-ttu-id="2fcce-133">Disabilita i cursori fast-only, di sola lettura e di recupero automatico, Abilita **SQLGetData** su cursori di sola lettura e di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2fcce-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="2fcce-134">Quando SQL_SOPT_SS_CURSOR_OPTIONS è impostato su SQL_CO_OFF, il tipo di cursore non cambia.</span><span class="sxs-lookup"><span data-stu-id="2fcce-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="2fcce-135">Ciò significa che il cursore fast forward-only resterà tale.</span><span class="sxs-lookup"><span data-stu-id="2fcce-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="2fcce-136">Per modificare il tipo di cursore, l'applicazione deve ora impostare un tipo di cursore diverso utilizzando `SQLSetStmtAttr` /SQL_ATTR_CURSOR_TYPE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="2fcce-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="2fcce-137">SQL_CO_FFO</span></span>|<span data-ttu-id="2fcce-138">Consente cursori fast-only di sola lettura, Disabilita **SQLGetData** sui cursori di sola lettura di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="2fcce-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="2fcce-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="2fcce-139">SQL_CO_AF</span></span>|<span data-ttu-id="2fcce-140">Abilita l'opzione per il recupero automatico su qualsiasi tipo di cursore.</span><span class="sxs-lookup"><span data-stu-id="2fcce-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="2fcce-141">Quando questa opzione è impostata per un handle di istruzione, **SQLExecute** o **SQLExecDirect** genererà un **SQLFetchScroll** implicito (SQL_FIRST).</span><span class="sxs-lookup"><span data-stu-id="2fcce-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="2fcce-142">Il cursore è aperto e il primo batch di righe viene restituito in un solo round trip al server.</span><span class="sxs-lookup"><span data-stu-id="2fcce-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="2fcce-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="2fcce-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="2fcce-144">Abilita i cursori fast forward-only con l'opzione di recupero automatico.</span><span class="sxs-lookup"><span data-stu-id="2fcce-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="2fcce-145">Produce gli stessi risultati della specifica contemporanea di SQL_CO_AF e SQL_CO_FFO.</span><span class="sxs-lookup"><span data-stu-id="2fcce-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="2fcce-146">Quando queste opzioni sono impostate, il server chiude automaticamente il cursore quando rileva che l'ultima riga è stata recuperata.</span><span class="sxs-lookup"><span data-stu-id="2fcce-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="2fcce-147">L'applicazione deve comunque chiamare [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) o [SQLCloseCursor](sqlclosecursor.md), ma il driver non deve inviare la notifica di chiusura al server.</span><span class="sxs-lookup"><span data-stu-id="2fcce-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="2fcce-148">Se l'elenco di selezione contiene una colonna di tipo **Text**, **ntext**o **Image** , il cursore fast-only viene convertito in un cursore dinamico e **SQLGetData** è consentito.</span><span class="sxs-lookup"><span data-stu-id="2fcce-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="2fcce-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="2fcce-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="2fcce-150">L'attributo SQL_SOPT_SS_DEFER_PREPARE determina se l'istruzione viene preparata immediatamente o rinviata fino a quando non viene eseguito **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) o [SQLDescribeParam](sqldescribeparam.md) .</span><span class="sxs-lookup"><span data-stu-id="2fcce-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="2fcce-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 e versioni precedenti questa proprietà viene ignorata (nessuna preparazione posticipata).</span><span class="sxs-lookup"><span data-stu-id="2fcce-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="2fcce-152">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="2fcce-153">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-153">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-154">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="2fcce-155">SQL_DP_ON</span></span>|<span data-ttu-id="2fcce-156">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-156">Default.</span></span> <span data-ttu-id="2fcce-157">Dopo la chiamata della [funzione SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360), la preparazione dell'istruzione viene posticipata fino alla chiamata di **SQLExecute** o all'esecuzione dell'operazione di metaproprietà (**SQLDescribeCol** o **SQLDescribeParam**).</span><span class="sxs-lookup"><span data-stu-id="2fcce-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="2fcce-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="2fcce-158">SQL_DP_OFF</span></span>|<span data-ttu-id="2fcce-159">L'istruzione viene preparata non appena viene eseguito **SQLPrepare** .</span><span class="sxs-lookup"><span data-stu-id="2fcce-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="2fcce-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="2fcce-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="2fcce-161">L'attributo SQL_SOPT_SS_REGIONALIZE viene utilizzato per determinare la conversione dei dati a livello di istruzione.</span><span class="sxs-lookup"><span data-stu-id="2fcce-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="2fcce-162">L'attributo fa sì che il driver rispetti l'impostazione locale del client durante la conversione dei valori di data, ora e valuta nelle stringhe di caratteri.</span><span class="sxs-lookup"><span data-stu-id="2fcce-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="2fcce-163">La conversione viene effettuata dai tipi di dati nativi di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] solo in stringhe di caratteri.</span><span class="sxs-lookup"><span data-stu-id="2fcce-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="2fcce-164">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="2fcce-165">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-165">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-166">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="2fcce-167">SQL_RE_OFF</span></span>|<span data-ttu-id="2fcce-168">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-168">Default.</span></span> <span data-ttu-id="2fcce-169">Il driver non converte i dati di tipo data, ora e valuta in stringhe di caratteri mediante l'impostazione locale del client.</span><span class="sxs-lookup"><span data-stu-id="2fcce-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="2fcce-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="2fcce-170">SQL_RE_ON</span></span>|<span data-ttu-id="2fcce-171">Il driver utilizza l'impostazione locale del client durante la conversione dei dati di tipo data, ora e valuta in stringhe di caratteri.</span><span class="sxs-lookup"><span data-stu-id="2fcce-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="2fcce-172">Ai dati di tipo valuta, numerico, data e ora vengono applicate le impostazioni di conversione internazionali.</span><span class="sxs-lookup"><span data-stu-id="2fcce-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="2fcce-173">L'impostazione di conversione è applicabile solo alle conversioni di output quando i valori di valuta, data, ora o numerici vengono convertiti in stringhe di caratteri.</span><span class="sxs-lookup"><span data-stu-id="2fcce-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2fcce-174">Quando l'opzione di istruzione SQL_SOPT_SS_REGIONALIZE è impostata, il driver utilizza le impostazioni locali del Registro di sistema per l'utente corrente.</span><span class="sxs-lookup"><span data-stu-id="2fcce-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="2fcce-175">Il driver non rispetta le impostazioni locali del thread corrente se l'applicazione la imposta, ad esempio, chiamando **SetThreadLocale**.</span><span class="sxs-lookup"><span data-stu-id="2fcce-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="2fcce-176">La modifica del comportamento internazionale di un'origine dati può generare un errore nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="2fcce-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="2fcce-177">Un'applicazione che analizza le stringhe relative alla data e ne prevede la visualizzazione in base a quanto definito da ODBC, potrebbe essere influenzata negativamente dalla modifica di questo valore.</span><span class="sxs-lookup"><span data-stu-id="2fcce-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="2fcce-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="2fcce-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="2fcce-179">L'attributo SQL_SOPT_SS_TEXTPTR_LOGGING attiva la registrazione delle operazioni sulle colonne contenenti dati di **testo** o di **immagine** .</span><span class="sxs-lookup"><span data-stu-id="2fcce-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="2fcce-180">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="2fcce-181">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-181">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-182">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="2fcce-183">SQL_TL_OFF</span></span>|<span data-ttu-id="2fcce-184">Disabilita la registrazione di operazioni eseguite su dati di **testo** e di **immagine** .</span><span class="sxs-lookup"><span data-stu-id="2fcce-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="2fcce-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="2fcce-185">SQL_TL_ON</span></span>|<span data-ttu-id="2fcce-186">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-186">Default.</span></span> <span data-ttu-id="2fcce-187">Abilita la registrazione delle operazioni eseguite sui dati di **testo** e di **immagine** .</span><span class="sxs-lookup"><span data-stu-id="2fcce-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="2fcce-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="2fcce-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="2fcce-189">L'attributo SQL_SOPT_SS_HIDDEN_COLUMNS espone nel set di risultati le colonne nascoste in un'istruzione SELECT FOR BROWSE di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2fcce-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="2fcce-190">Per impostazione predefinita, il driver non espone queste colonne.</span><span class="sxs-lookup"><span data-stu-id="2fcce-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="2fcce-191">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="2fcce-192">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-192">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-193">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="2fcce-194">SQL_HC_OFF</span></span>|<span data-ttu-id="2fcce-195">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-195">Default.</span></span> <span data-ttu-id="2fcce-196">Le colonne FOR BROWSE sono nascoste dal set di risultati.</span><span class="sxs-lookup"><span data-stu-id="2fcce-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="2fcce-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="2fcce-197">SQL_HC_ON</span></span>|<span data-ttu-id="2fcce-198">Espone colonne FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="2fcce-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="2fcce-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="2fcce-200">L'attributo SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT restituisce il testo del messaggio per la richiesta di notifica di query.</span><span class="sxs-lookup"><span data-stu-id="2fcce-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="2fcce-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="2fcce-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="2fcce-202">L'attributo SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS specifica le opzioni utilizzate per la richiesta di notifica di query.</span><span class="sxs-lookup"><span data-stu-id="2fcce-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="2fcce-203">Tali opzioni vengono specificate in una stringa con la sintassi `name=value` come indicato di seguito.</span><span class="sxs-lookup"><span data-stu-id="2fcce-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="2fcce-204">L'applicazione è responsabile della creazione del servizio e della lettura delle notifiche all'esterno della coda.</span><span class="sxs-lookup"><span data-stu-id="2fcce-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="2fcce-205">La sintassi delle opzioni delle notifiche delle query è la seguente:</span><span class="sxs-lookup"><span data-stu-id="2fcce-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="2fcce-206">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="2fcce-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="2fcce-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="2fcce-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="2fcce-208">L'attributo SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT specifica per quanti secondi la notifica di query deve rimanere attiva.</span><span class="sxs-lookup"><span data-stu-id="2fcce-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="2fcce-209">Il valore predefinito è 432000 secondi (5 giorni).</span><span class="sxs-lookup"><span data-stu-id="2fcce-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="2fcce-210">Il valore *ValuePtr* è di tipo SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="2fcce-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="2fcce-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="2fcce-212">L'attributo SQL_SOPT_SS_PARAM_FOCUS specifica lo stato attivo per le chiamate successive a SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec e SQLSetDescRec.</span><span class="sxs-lookup"><span data-stu-id="2fcce-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="2fcce-213">Il tipo per SQL_SOPT_SS_PARAM_FOCUS è SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="2fcce-214">L'impostazione predefinita è 0 e indica che queste chiamate riguardano i parametri che corrispondono a marcatori di parametro nell'istruzione SQL.</span><span class="sxs-lookup"><span data-stu-id="2fcce-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="2fcce-215">Se l'impostazione corrisponde al numero di un parametro con valori di tabella, queste chiamate riguardano le colonne del parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="2fcce-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="2fcce-216">Se l'impostazione corrisponde a un valore diverso dal numero un parametro con valori di tabella, queste chiamate restituiscono l'errore IM020: "Lo stato attivo del parametro non fa riferimento a un parametro con valori di tabella".</span><span class="sxs-lookup"><span data-stu-id="2fcce-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="2fcce-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="2fcce-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="2fcce-218">L'attributo SQL_SOPT_SS_NAME_SCOPE specifica l'ambito del nome per le chiamate di funzione di catalogo successive.</span><span class="sxs-lookup"><span data-stu-id="2fcce-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="2fcce-219">Il set di risultati restituito da SQLColumns dipende dall'impostazione di SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="2fcce-220">Il tipo per SQL_SOPT_SS_NAME_SCOPE è SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="2fcce-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="2fcce-221">Valore *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="2fcce-221">*ValuePtr* value</span></span>|<span data-ttu-id="2fcce-222">Descrizione</span><span class="sxs-lookup"><span data-stu-id="2fcce-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="2fcce-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="2fcce-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="2fcce-224">Predefinita.</span><span class="sxs-lookup"><span data-stu-id="2fcce-224">Default.</span></span><br /><br /> <span data-ttu-id="2fcce-225">In caso di utilizzo di parametri con valori di tabella, indica che è necessario che vengano restituiti i metadati per le tabelle effettive.</span><span class="sxs-lookup"><span data-stu-id="2fcce-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="2fcce-226">Quando si utilizza la funzionalità colonne di tipo sparse, SQLColumns restituisce solo le colonne che non sono membri di tipo sparse `column_set` .</span><span class="sxs-lookup"><span data-stu-id="2fcce-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="2fcce-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="2fcce-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="2fcce-228">Indica che l'applicazione richiede metadati per un tipo di tabella, anziché una tabella effettiva. Le funzioni di catalogo devono restituire metadati per i tipi di tabella.</span><span class="sxs-lookup"><span data-stu-id="2fcce-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="2fcce-229">L'applicazione passa quindi il TYPE_NAME del parametro con valori di tabella come parametro *TableName* .</span><span class="sxs-lookup"><span data-stu-id="2fcce-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="2fcce-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="2fcce-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="2fcce-231">Quando si utilizza la funzionalità colonne di tipo sparse, SQLColumns restituisce tutte le colonne, indipendentemente dall' `column_set` appartenenza.</span><span class="sxs-lookup"><span data-stu-id="2fcce-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="2fcce-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="2fcce-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="2fcce-233">Quando si utilizza la funzionalità colonne di tipo sparse, SQLColumns restituisce solo le colonne che sono membri di sparse `column_set` .</span><span class="sxs-lookup"><span data-stu-id="2fcce-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="2fcce-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="2fcce-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="2fcce-235">Equivale a SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="2fcce-236">Per identificare il catalogo e lo schema per il parametro con valori di tabella, SS_TYPE_CATALOG_NAME e SS_TYPE_SCHEMA_NAME vengono utilizzati rispettivamente con i parametri *CatalogName* e *SchemaName* .</span><span class="sxs-lookup"><span data-stu-id="2fcce-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="2fcce-237">Quando un'applicazione ha completato il recupero dei metadati per i parametri con valori di tabella, deve impostare nuovamente SQL_SOPT_SS_NAME_SCOPE sul valore predefinito di SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="2fcce-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="2fcce-238">Quando SQL_SOPT_SS_NAME_SCOPE è impostato su SQL_SS_NAME_SCOPE_TABLE, le query ai server collegati non riescono.</span><span class="sxs-lookup"><span data-stu-id="2fcce-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="2fcce-239">Le chiamate a SQLColumns o SQLPrimaryKeys con un catalogo contenente un componente server avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="2fcce-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="2fcce-240">Se si tenta di impostare SQL_SOPT_SS_NAME_SCOPE su un valore non valido, viene restituito SQL_ERROR e un record di diagnostica viene generato con SQLSTATE HY024 e il messaggio "Valore attributo non valido".</span><span class="sxs-lookup"><span data-stu-id="2fcce-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="2fcce-241">Se una funzione di catalogo, ovvero SQLTables, SQLColumns o SQLPrimaryKeys, viene chiamata quando SQL_SOPT_SS_NAME_SCOPE dispone di un valore diverso da SQL_SS_NAME_SCOPE_TABLE, viene restituito SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="2fcce-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="2fcce-242">Viene generato un record di diagnostica con SQLSTATE HY010 e il messaggio "Errore nella sequenza della funzione (SQL_SOPT_SS_NAME_SCOPE non è impostato su SQL_SS_NAME_SCOPE_TABLE)".</span><span class="sxs-lookup"><span data-stu-id="2fcce-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2fcce-243">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2fcce-243">See Also</span></span>  
 <span data-ttu-id="2fcce-244">[SQLGetStmtAttr (funzione)](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="2fcce-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="2fcce-245">Dettagli di implementazione dell'API ODBC</span><span class="sxs-lookup"><span data-stu-id="2fcce-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
