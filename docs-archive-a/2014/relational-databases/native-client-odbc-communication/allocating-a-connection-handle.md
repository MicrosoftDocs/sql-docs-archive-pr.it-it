---
title: Allocazione di un handle di connessione | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, passwords
- ODBC applications, connections
- handles [SQL Server Native Client]
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- SQL Server Native Client ODBC driver, connection handles
- connection handles [SQL Server Native Client]
- modifying passwords
- SQLAllocHandle function
ms.assetid: 471d8a31-199c-4f92-bb10-004fc7733b35
author: rothja
ms.author: jroth
ms.openlocfilehash: d3cf84e541f114d527d9a00cd19bce705a09af30
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725715"
---
# <a name="allocating-a-connection-handle"></a><span data-ttu-id="91836-102">Allocazione di un handle di connessione</span><span class="sxs-lookup"><span data-stu-id="91836-102">Allocating a Connection Handle</span></span>
  <span data-ttu-id="91836-103">Prima che l'applicazione possa connettersi a un'origine dati o a un driver, è necessario che allochi un handle di connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-103">Before the application can connect to a data source or driver, it must allocate a connection handle.</span></span> <span data-ttu-id="91836-104">Questa operazione viene eseguita chiamando **SQLAllocHandle** con il parametro *HandleType* impostato su SQL_HANDLE_DBC e *InputHandle puntare* che punta a un handle di ambiente inizializzato.</span><span class="sxs-lookup"><span data-stu-id="91836-104">This is done by calling **SQLAllocHandle** with the *HandleType* parameter set to SQL_HANDLE_DBC and *InputHandle* pointing to an initialized environment handle.</span></span>  
  
 <span data-ttu-id="91836-105">Le caratteristiche della connessione vengono controllate mediante l'impostazione degli attributi di connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-105">The characteristics of the connection are controlled by setting connection attributes.</span></span> <span data-ttu-id="91836-106">Poiché ad esempio le transazioni si verificano al livello della connessione, il livello di isolamento delle transazioni è un attributo di connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-106">For example, because transactions occur at the connection level, the transaction isolation level is a connection attribute.</span></span> <span data-ttu-id="91836-107">Allo stesso modo, il timeout di accesso, ovvero il numero di secondi di attesa durante il tentativo di connessione prima del timeout, è un attributo di connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-107">Similarly, the login time-out, or number of seconds to wait while trying to connect before timing out, is a connection attribute.</span></span>  
  
 <span data-ttu-id="91836-108">Gli attributi di connessione vengono impostati con [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md)e le impostazioni correnti vengono recuperate con [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="91836-108">Connection attributes are set with [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md), and their current settings are retrieved with [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span></span> <span data-ttu-id="91836-109">Se **SQLSetConnectAttr** viene chiamato prima del tentativo di connessione, gestione driver ODBC archivia gli attributi nella relativa struttura di connessione e li imposta nel driver come parte del processo di connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-109">If **SQLSetConnectAttr** is called before a connection is attempted, the ODBC Driver Manager stores the attributes in its connection structure and sets them in the driver as part of the connection process.</span></span> <span data-ttu-id="91836-110">Alcuni attributi di connessione devono essere impostati prima che l'applicazione tenti di connettersi, altri possono essere impostati al termine della connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-110">Some connection attributes must be set before the application attempts to connect; others can be set after the connection has completed.</span></span> <span data-ttu-id="91836-111">SQL_ATTR_ODBC_CURSORS, ad esempio, deve essere impostato prima che venga stabilita una connessione, mentre SQL_ATTR_AUTOCOMMIT può essere impostato dopo la connessione.</span><span class="sxs-lookup"><span data-stu-id="91836-111">For example, SQL_ATTR_ODBC_CURSORS must be set before a connection is made, but SQL_ATTR_AUTOCOMMIT can be set after connecting.</span></span>  
  
 <span data-ttu-id="91836-112">È possibile migliorare le prestazioni delle applicazioni in esecuzione in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] versione 7.0 o successiva reimpostando le dimensioni del pacchetto di rete TDS (Tabular Data Stream).</span><span class="sxs-lookup"><span data-stu-id="91836-112">Applications running against [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 or later can sometimes improve their performance by resetting the tabular data stream (TDS) network packet size.</span></span> <span data-ttu-id="91836-113">Le dimensioni predefinite del pacchetto sono impostate nel server su 4 KB.</span><span class="sxs-lookup"><span data-stu-id="91836-113">The default packet size is set at the server, at 4 KB.</span></span> <span data-ttu-id="91836-114">Per ottenere le massime prestazioni le dimensioni del pacchetto devono essere in genere impostate su un valore compreso tra 4 e 8 KB.</span><span class="sxs-lookup"><span data-stu-id="91836-114">A packet size of 4 KB to 8 KB generally gives the best performance.</span></span> <span data-ttu-id="91836-115">Se dal test si evince che con dimensioni diverse si possono ottenere prestazioni migliori, sarà possibile reimpostarle.</span><span class="sxs-lookup"><span data-stu-id="91836-115">If testing shows that it performs better with a different packet size, the application can reset the packet size.</span></span> <span data-ttu-id="91836-116">Le applicazioni ODBC possono eseguire questa operazione prima della connessione chiamando **SQLSetConnectAttr** con l'opzione SQL_ATTR_PACKET_SIZE.</span><span class="sxs-lookup"><span data-stu-id="91836-116">ODBC applications can do this before connecting by calling **SQLSetConnectAttr** with the SQL_ATTR_PACKET_SIZE option.</span></span> <span data-ttu-id="91836-117">Le prestazioni di alcune applicazioni migliorano con dimensioni del pacchetto superiori, ma i miglioramenti sono in genere minimi nel caso di dimensioni maggiori di 8 KB.</span><span class="sxs-lookup"><span data-stu-id="91836-117">Some applications perform better with a larger packet size, but performance improvements are generally minimal for packet sizes larger than 8 KB.</span></span>  
  
 <span data-ttu-id="91836-118">Il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] driver ODBC di Native client dispone di numerosi attributi di connessione estesi che possono essere utilizzati da un'applicazione per aumentarne la funzionalità.</span><span class="sxs-lookup"><span data-stu-id="91836-118">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver has a number of extended connection attributes that an application can use to increase its functionality.</span></span> <span data-ttu-id="91836-119">Alcuni di questi attributi controllano le stesse opzioni che possono essere specificate nelle origini dati e utilizzate per sostituire eventuali opzioni impostate in un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="91836-119">Some of these attributes control the same options that can be specified in data sources and used to override whatever option is set in a data source.</span></span> <span data-ttu-id="91836-120">Se ad esempio un'applicazione utilizza identificatori tra virgolette, può impostare l'attributo SQL_COPT_SS_QUOTED_IDENT specifico del driver su SQL_QI_ON per assicurarsi che questa opzione sia sempre impostata indipendentemente dall'impostazione presente in qualsiasi origine dati.</span><span class="sxs-lookup"><span data-stu-id="91836-120">For example, if an application uses quoted identifiers, it can set the driver-specific attribute SQL_COPT_SS_QUOTED_IDENT to SQL_QI_ON to ensure this option is always set regardless of the setting in any data source.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="91836-121">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="91836-121">See Also</span></span>  
 [<span data-ttu-id="91836-122">Comunicazione con SQL Server &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="91836-122">Communicating with SQL Server &#40;ODBC&#41;</span></span>](communicating-with-sql-server-odbc.md)  
  
  
