---
title: Gerarchia di crittografia | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- encryption [SQL Server], hierarchies
- cryptography [SQL Server], hierarchies
- encryption keys [SQL Server]
- security [SQL Server], encryption
- hierarchies [SQL Server], encryption
ms.assetid: 96c276d5-1bba-4e95-b678-10f059f1fbcf
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: d38bb83c2f6a2487e547c4686be5c65bc012e33e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725372"
---
# <a name="encryption-hierarchy"></a><span data-ttu-id="4d999-102">Gerarchia di crittografia</span><span class="sxs-lookup"><span data-stu-id="4d999-102">Encryption Hierarchy</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="4d999-103">crittografa i dati in base ad una particolare gerarchia di crittografia e infrastruttura di gestione delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="4d999-103">encrypts data with a hierarchical encryption and key management infrastructure.</span></span> <span data-ttu-id="4d999-104">Ciascun livello crittografa il livello sottostante utilizzando una combinazione di certificati, chiavi asimmetriche e chiavi simmetriche.</span><span class="sxs-lookup"><span data-stu-id="4d999-104">Each layer encrypts the layer below it by using a combination of certificates, asymmetric keys, and symmetric keys.</span></span> <span data-ttu-id="4d999-105">Le chiavi asimmetriche e simmetriche possono essere archiviate al di fuori di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in un modulo EKM (Extensible Key Management).</span><span class="sxs-lookup"><span data-stu-id="4d999-105">Asymmetric keys and symmetric keys can be stored outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in an Extensible Key Management (EKM) module.</span></span>  
  
 <span data-ttu-id="4d999-106">Nella figura seguente viene indicato come nella gerarchia di crittografia ogni livello crittografi il livello sottostante e vengono visualizzate le configurazioni di crittografia più comuni.</span><span class="sxs-lookup"><span data-stu-id="4d999-106">The following illustration shows that each layer of the encryption hierarchy encrypts the layer beneath it, and displays the most common encryption configurations.</span></span> <span data-ttu-id="4d999-107">L'accesso all'inizio della gerarchia è in genere protetto da una password.</span><span class="sxs-lookup"><span data-stu-id="4d999-107">The access to the start of the hierarchy is usually protected by a password.</span></span>  
  
 <span data-ttu-id="4d999-108">![Visualizza alcune combinazioni di crittografia in uno stack.](../../../database-engine/media/encryption-hierarchy-stack.gif "Visualizza alcune combinazioni di crittografia in uno stack.")</span><span class="sxs-lookup"><span data-stu-id="4d999-108">![Displays some encryption combinations in a stack.](../../../database-engine/media/encryption-hierarchy-stack.gif "Displays some encryption combinations in a stack.")</span></span>  
  
 <span data-ttu-id="4d999-109">Tenere presenti i concetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d999-109">Keep in mind the following concepts:</span></span>  
  
-   <span data-ttu-id="4d999-110">Per ottenere prestazioni ottimali, crittografare i dati utilizzando chiavi simmetriche anziché certificati o chiavi asimmetriche.</span><span class="sxs-lookup"><span data-stu-id="4d999-110">For best performance, encrypt data using symmetric keys instead of certificates or asymmetric keys.</span></span>  
  
-   <span data-ttu-id="4d999-111">Le chiavi master del database sono protette dalla chiave master del servizio.</span><span class="sxs-lookup"><span data-stu-id="4d999-111">Database master keys are protected by the Service Master Key.</span></span> <span data-ttu-id="4d999-112">La chiave master del servizio viene creata dal programma di installazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e viene crittografata tramite l'API di protezione dati di Windows (DPAPI).</span><span class="sxs-lookup"><span data-stu-id="4d999-112">The Service Master Key is created by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup and is encrypted with the Windows Data Protection API (DPAPI).</span></span>  
  
-   <span data-ttu-id="4d999-113">Sono possibili altre gerarchie di crittografia che includono livelli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="4d999-113">Other encryption hierarchies stacking additional layers are possible.</span></span>  
  
-   <span data-ttu-id="4d999-114">Un modulo EKM contiene chiavi simmetriche o asimmetriche al di fuori di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4d999-114">An Extensible Key Management (EKM) module holds symmetric or asymmetric keys outside of SQL Server.</span></span>  
  
-   <span data-ttu-id="4d999-115">Transparent Data Encryption (TDE) deve utilizzare una chiave simmetrica denominata chiave di crittografia del database, che è protetta da un certificato protetto a sua volta dalla chiave master del database master o da una chiave asimmetrica archiviata in un modulo EKM.</span><span class="sxs-lookup"><span data-stu-id="4d999-115">Transparent Data Encryption (TDE) must use a symmetric key called the database encryption key which is protected by either a certificate protected by the database master key of the master database, or by an asymmetric key stored in an EKM.</span></span>  
  
-   <span data-ttu-id="4d999-116">La chiave master del servizio e tutte le chiavi master del database sono chiavi simmetriche.</span><span class="sxs-lookup"><span data-stu-id="4d999-116">The Service Master Key and all Database Master Keys are symmetric keys.</span></span>  
  
 <span data-ttu-id="4d999-117">Le stesse informazioni vengono illustrate in modo diverso nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="4d999-117">The following illustration shows the same information in an alternative manner.</span></span>  
  
 <span data-ttu-id="4d999-118">![Visualizza alcune combinazioni di crittografia in una ruota.](../../../database-engine/media/encryption-hierarchy-wheel.gif "Visualizza alcune combinazioni di crittografia in una ruota.")</span><span class="sxs-lookup"><span data-stu-id="4d999-118">![Displays some encryption combinations in a wheel.](../../../database-engine/media/encryption-hierarchy-wheel.gif "Displays some encryption combinations in a wheel.")</span></span>  
  
 <span data-ttu-id="4d999-119">In questo diagramma vengono illustrati i concetti aggiuntivi seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d999-119">This diagram illustrates the following additional concepts:</span></span>  
  
-   <span data-ttu-id="4d999-120">In questa illustrazione le frecce indicano gerarchie di crittografia comuni.</span><span class="sxs-lookup"><span data-stu-id="4d999-120">In this illustration, arrows indicate common encryption hierarchies.</span></span>  
  
-   <span data-ttu-id="4d999-121">Le chiavi simmetriche e asimmetriche in EKM possono proteggere l'accesso alle chiavi simmetriche e asimmetriche archiviate in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4d999-121">Symmetric and asymmetric keys in the EKM can protect access to the symmetric and asymmetric keys stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="4d999-122">La linea punteggiata associata a EKM indica che le chiavi in EKM potrebbero sostituire le chiavi simmetriche e asimmetriche archiviate in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4d999-122">The dotted line associated with EKM indicates that keys in the EKM could replace the symmetric and asymmetric keys stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="encryption-mechanisms"></a><span data-ttu-id="4d999-123">Meccanismi di crittografia</span><span class="sxs-lookup"><span data-stu-id="4d999-123">Encryption Mechanisms</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="4d999-124">comprende i meccanismi di crittografia seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d999-124">provides the following mechanisms for encryption:</span></span>  
  
-   [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="4d999-125">funzioni</span><span class="sxs-lookup"><span data-stu-id="4d999-125">functions</span></span>  
  
-   <span data-ttu-id="4d999-126">Chiavi asimmetriche</span><span class="sxs-lookup"><span data-stu-id="4d999-126">Asymmetric keys</span></span>  
  
-   <span data-ttu-id="4d999-127">Chiavi simmetriche</span><span class="sxs-lookup"><span data-stu-id="4d999-127">Symmetric keys</span></span>  
  
-   <span data-ttu-id="4d999-128">Certificati</span><span class="sxs-lookup"><span data-stu-id="4d999-128">Certificates</span></span>  
  
-   <span data-ttu-id="4d999-129">Transparent Data Encryption</span><span class="sxs-lookup"><span data-stu-id="4d999-129">Transparent Data Encryption</span></span>  
  
### <a name="transact-sql-functions"></a><span data-ttu-id="4d999-130">Funzioni Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="4d999-130">Transact-SQL Functions</span></span>  
 <span data-ttu-id="4d999-131">Singoli elementi possono essere crittografati mentre vengono inseriti o aggiornati con le funzioni [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4d999-131">Individual items can be encrypted as they are inserted or updated using [!INCLUDE[tsql](../../../includes/tsql-md.md)] functions.</span></span> <span data-ttu-id="4d999-132">Per altre informazioni, vedere [ENCRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/encryptbypassphrase-transact-sql) e [DECRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/decryptbypassphrase-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4d999-132">For more information, see [ENCRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/encryptbypassphrase-transact-sql) and [DECRYPTBYPASSPHRASE &#40;Transact-SQL&#41;](/sql/t-sql/functions/decryptbypassphrase-transact-sql).</span></span>  
  
### <a name="certificates"></a><span data-ttu-id="4d999-133">Certificati</span><span class="sxs-lookup"><span data-stu-id="4d999-133">Certificates</span></span>  
 <span data-ttu-id="4d999-134">Un certificato a chiave pubblica, normalmente chiamato semplicemente un certificato, è un'istruzione firmata digitalmente che associa il valore di una chiave pubblica all'identità di una persona, un dispositivo o un servizio che detiene la corrispondente chiave privata.</span><span class="sxs-lookup"><span data-stu-id="4d999-134">A public key certificate, usually just called a certificate, is a digitally-signed statement that binds the value of a public key to the identity of the person, device, or service that holds the corresponding private key.</span></span> <span data-ttu-id="4d999-135">I certificati vengono rilasciati e firmati da un'autorità di certificazione (CA).</span><span class="sxs-lookup"><span data-stu-id="4d999-135">Certificates are issued and signed by a certification authority (CA).</span></span> <span data-ttu-id="4d999-136">L'entità che riceve un certificato da un'autorità di certificazione è il soggetto del certificato.</span><span class="sxs-lookup"><span data-stu-id="4d999-136">The entity that receives a certificate from a CA is the subject of that certificate.</span></span> <span data-ttu-id="4d999-137">Normalmente, i certificati contengono le informazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="4d999-137">Typically, certificates contain the following information.</span></span>  
  
-   <span data-ttu-id="4d999-138">Chiave pubblica del soggetto.</span><span class="sxs-lookup"><span data-stu-id="4d999-138">The public key of the subject.</span></span>  
  
-   <span data-ttu-id="4d999-139">Informazioni di identificazione del soggetto, come ad esempio il nome e l'indirizzo di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="4d999-139">The identifier information of the subject, such as the name and e-mail address.</span></span>  
  
-   <span data-ttu-id="4d999-140">Periodo di validità.</span><span class="sxs-lookup"><span data-stu-id="4d999-140">The validity period.</span></span> <span data-ttu-id="4d999-141">È il periodo di tempo durante il quale il certificato è considerato valido.</span><span class="sxs-lookup"><span data-stu-id="4d999-141">This is the length of time that the certificate is considered valid.</span></span>  
  
     <span data-ttu-id="4d999-142">Un certificato è valido solo per il periodo di tempo specificato nel certificato; e ogni certificato contiene le date **Valido dal** e **Valido fino al** .</span><span class="sxs-lookup"><span data-stu-id="4d999-142">A certificate is valid only for the period of time specified within it; every certificate contains **Valid From** and **Valid To** dates.</span></span> <span data-ttu-id="4d999-143">Queste date definiscono i limiti del periodo di validità.</span><span class="sxs-lookup"><span data-stu-id="4d999-143">These dates set the boundaries of the validity period.</span></span> <span data-ttu-id="4d999-144">Quando il periodo di validità di un certificato viene superato, il soggetto del certificato scaduto deve richiedere un nuovo certificato.</span><span class="sxs-lookup"><span data-stu-id="4d999-144">When the validity period for a certificate has passed, a new certificate must be requested by the subject of the now-expired certificate.</span></span>  
  
-   <span data-ttu-id="4d999-145">Informazioni di identificazione dell'emittente</span><span class="sxs-lookup"><span data-stu-id="4d999-145">Issuer identifier information.</span></span>  
  
-   <span data-ttu-id="4d999-146">Firma digitale dell'emittente.</span><span class="sxs-lookup"><span data-stu-id="4d999-146">The digital signature of the issuer.</span></span>  
  
     <span data-ttu-id="4d999-147">Questa firma attesta la validità dell'associazione tra la chiave pubblica e le informazioni di identificazione del soggetto.</span><span class="sxs-lookup"><span data-stu-id="4d999-147">This signature attests to the validity of the binding between the public key and the identifier information of the subject.</span></span> <span data-ttu-id="4d999-148">(L'apposizione di una firma digitale a informazioni comporta la trasformazione delle informazioni, e di alcune informazioni segrete detenute dal mittente, in un tag chiamato firma.)</span><span class="sxs-lookup"><span data-stu-id="4d999-148">(The process of digitally signing information entails transforming the information, as well as some secret information held by the sender, into a tag called a signature.)</span></span>  
  
 <span data-ttu-id="4d999-149">Il vantaggio principale dei certificati è quello di evitare che gli host debbano mantenere un set di password per singoli soggetti.</span><span class="sxs-lookup"><span data-stu-id="4d999-149">A primary benefit of certificates is that they relieve hosts of the need to maintain a set of passwords for individual subjects.</span></span> <span data-ttu-id="4d999-150">L'host non deve fare altro che stabilire una relazione di trust con l'emittente di un certificato, che successivamente può firmare un numero illimitato di certificati.</span><span class="sxs-lookup"><span data-stu-id="4d999-150">Instead, the host merely establishes trust in a certificate issuer, which may then sign an unlimited number of certificates.</span></span>  
  
 <span data-ttu-id="4d999-151">Quando un host, come ad esempio un server Web sicuro, designa un emittente come autorità radice affidabile, l'host implicitamente considera affidabili i criteri che l'emittente ha utilizzato per stabilire le associazioni relative ai certificati emessi.</span><span class="sxs-lookup"><span data-stu-id="4d999-151">When a host, such as a secure Web server, designates an issuer as a trusted root authority, the host implicitly trusts the policies that the issuer has used to establish the bindings of certificates it issues.</span></span> <span data-ttu-id="4d999-152">In effetti, l'host fa affidamento all'emittente per la verifica dell'identità del soggetto del certificato.</span><span class="sxs-lookup"><span data-stu-id="4d999-152">In effect, the host trusts that the issuer has verified the identity of the certificate subject.</span></span> <span data-ttu-id="4d999-153">L'host designa un emittente come autorità radice affidabile collocando il certificato autofirmato dell'emittente, contenente la chiave pubblica dell'emittente, nell'archivio certificati delle autorità di certificazione affidabili del computer host.</span><span class="sxs-lookup"><span data-stu-id="4d999-153">A host designates an issuer as a trusted root authority by putting the self-signed certificate of the issuer, which contains the public key of the issuer, into the trusted root certification authority certificate store of the host computer.</span></span> <span data-ttu-id="4d999-154">Le autorità di certificazione intermedie o subordinate vengono considerate affidabili solo se dispongono di un percorso di certificazione valido ottenuto da un'autorità di certificazione radice affidabile.</span><span class="sxs-lookup"><span data-stu-id="4d999-154">Intermediate or subordinate certification authorities are trusted only if they have a valid certification path from a trusted root certification authority.</span></span>  
  
 <span data-ttu-id="4d999-155">L'emittente può revocare un certificato prima che scada.</span><span class="sxs-lookup"><span data-stu-id="4d999-155">The issuer can revoke a certificate before it expires.</span></span> <span data-ttu-id="4d999-156">La revoca di un certificato annulla l'associazione tra la chiave pubblica e l'identità dichiarata nel certificato.</span><span class="sxs-lookup"><span data-stu-id="4d999-156">Revocation cancels the binding of a public key to an identity that is asserted in the certificate.</span></span> <span data-ttu-id="4d999-157">Ciascun emittente mantiene un elenco di revoche di certificati che può essere utilizzato da programmi per la verifica della validità di un particolare certificato.</span><span class="sxs-lookup"><span data-stu-id="4d999-157">Each issuer maintains a certificate revocation list that can be used by programs when they are checking the validity of any given certificate.</span></span>  
  
 <span data-ttu-id="4d999-158">I certificati autofirmati creati da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sono conformi allo standard X.509 e supportano i campi X.509 v1.</span><span class="sxs-lookup"><span data-stu-id="4d999-158">The self-signed certificates created by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] follow the X.509 standard and support the X.509 v1 fields.</span></span>  
  
### <a name="asymmetric-keys"></a><span data-ttu-id="4d999-159">Chiavi asimmetriche</span><span class="sxs-lookup"><span data-stu-id="4d999-159">Asymmetric Keys</span></span>  
 <span data-ttu-id="4d999-160">Una chiave asimmetrica è costituita da una chiave privata e dalla corrispondente chiave pubblica.</span><span class="sxs-lookup"><span data-stu-id="4d999-160">An asymmetric key is made up of a private key and the corresponding public key.</span></span> <span data-ttu-id="4d999-161">Ogni chiave può decrittografare dati crittografati dall'altra chiave.</span><span class="sxs-lookup"><span data-stu-id="4d999-161">Each key can decrypt data encrypted by the other.</span></span> <span data-ttu-id="4d999-162">La crittografia e la decrittografia asimmetrica richiedono un uso intensivo delle risorse ma offrono un livello di sicurezza superiore a quello della crittografia simmetrica.</span><span class="sxs-lookup"><span data-stu-id="4d999-162">Asymmetric encryption and decryption are relatively resource-intensive, but they provide a higher level of security than symmetric encryption.</span></span> <span data-ttu-id="4d999-163">Una chiave asimmetrica può essere utilizzata per crittografare una chiave simmetrica da memorizzare in un database.</span><span class="sxs-lookup"><span data-stu-id="4d999-163">An asymmetric key can be used to encrypt a symmetric key for storage in a database.</span></span>  
  
### <a name="symmetric-keys"></a><span data-ttu-id="4d999-164">Chiavi simmetriche</span><span class="sxs-lookup"><span data-stu-id="4d999-164">Symmetric Keys</span></span>  
 <span data-ttu-id="4d999-165">Una chiave simmetrica è una chiave che viene utilizzata sia per la crittografia che per decrittografia.</span><span class="sxs-lookup"><span data-stu-id="4d999-165">A symmetric key is one key that is used for both encryption and decryption.</span></span> <span data-ttu-id="4d999-166">La crittografia e la decrittografia tramite una chiave simmetrica sono veloci e sono quindi adatte per essere utilizzate in modo ricorrente per informazioni riservate contenute in database.</span><span class="sxs-lookup"><span data-stu-id="4d999-166">Encryption and decryption by using a symmetric key is fast, and suitable for routine use with sensitive data in the database.</span></span>  
  
### <a name="transparent-data-encryption"></a><span data-ttu-id="4d999-167">Transparent Data Encryption</span><span class="sxs-lookup"><span data-stu-id="4d999-167">Transparent Data Encryption</span></span>  
 <span data-ttu-id="4d999-168">Transparent Data Encryption è un caso speciale di crittografia che utilizza una chiave simmetrica.</span><span class="sxs-lookup"><span data-stu-id="4d999-168">Transparent Data Encryption (TDE) is a special case of encryption using a symmetric key.</span></span> <span data-ttu-id="4d999-169">Transparent Data Encryption crittografa un intero database utilizzando una chiave simmetrica denominata chiave di crittografia del database.</span><span class="sxs-lookup"><span data-stu-id="4d999-169">TDE encrypts an entire database using that symmetric key called the database encryption key.</span></span> <span data-ttu-id="4d999-170">La chiave di crittografia del database è protetta da altri certificati o chiavi, a loro volta protetti dalla chiave master del database o da una chiave asimmetrica archiviata in un modulo EKM.</span><span class="sxs-lookup"><span data-stu-id="4d999-170">The database encryption key is protected by other keys or certificates which are protected either by the database master key or by an asymmetric key stored in an EKM module.</span></span> <span data-ttu-id="4d999-171">Per altre informazioni sulla crittografia trasparente del database, vedere [Transparent Data Encryption &#40;TDE&#41;](transparent-data-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="4d999-171">For more information, see [Transparent Data Encryption &#40;TDE&#41;](transparent-data-encryption.md).</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="4d999-172">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="4d999-172">Related Content</span></span>  
 [<span data-ttu-id="4d999-173">Sicurezza di SQL Server</span><span class="sxs-lookup"><span data-stu-id="4d999-173">Securing SQL Server</span></span>](../securing-sql-server.md)  
  
 [<span data-ttu-id="4d999-174">Funzioni di sicurezza &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="4d999-174">Security Functions &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/functions/security-functions-transact-sql)  
  
## <a name="see-also"></a><span data-ttu-id="4d999-175">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4d999-175">See Also</span></span>  
 <span data-ttu-id="4d999-176">[Gerarchia delle autorizzazioni &#40;Motore di database&#41;](../permissions-hierarchy-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="4d999-176">[Permissions Hierarchy &#40;Database Engine&#41;](../permissions-hierarchy-database-engine.md) </span></span>  
 [<span data-ttu-id="4d999-177">Entità a protezione diretta</span><span class="sxs-lookup"><span data-stu-id="4d999-177">Securables</span></span>](../securables.md)  
  
  
