---
title: Chiavi di crittografia del database e di SQL Server (motore di database) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- keys [SQL Server], database encryption
ms.assetid: 15c0a5e8-9177-484c-ae75-8c552dc0dac0
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: f846e74e0afd89c6bb10a4aa9a23a6420b6a613a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87726835"
---
# <a name="sql-server-and-database-encryption-keys-database-engine"></a><span data-ttu-id="31f83-102">Chiavi di crittografia del database e di SQL Server (Motore di database)</span><span class="sxs-lookup"><span data-stu-id="31f83-102">SQL Server and Database Encryption Keys (Database Engine)</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="31f83-103">usa le chiavi di crittografia per la protezione di dati, credenziali e informazioni di connessione archiviate in un database del server.</span><span class="sxs-lookup"><span data-stu-id="31f83-103">uses encryption keys to help secure data, credentials, and connection information that is stored in a server database.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="31f83-104">dispone di due tipi di chiavi: *simmetrica* e *asimmetrica*.</span><span class="sxs-lookup"><span data-stu-id="31f83-104">has two kinds of keys: *symmetric* and *asymmetric*.</span></span> <span data-ttu-id="31f83-105">Le chiavi simmetriche utilizzano la stessa password per crittografare e decrittografare i dati.</span><span class="sxs-lookup"><span data-stu-id="31f83-105">Symmetric keys use the same password to encrypt and decrypt data.</span></span> <span data-ttu-id="31f83-106">Le chiavi asimmetriche usano una password per crittografare i dati (chiave *pubblica* ) e un'altra per decrittografare i dati (chiave *privata* ).</span><span class="sxs-lookup"><span data-stu-id="31f83-106">Asymmetric keys use one password to encrypt data (called the *public* key) and another to decrypt data (called the *private* key).</span></span>  
  
 <span data-ttu-id="31f83-107">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], le chiavi di crittografia sono costituite da una combinazione di chiavi pubbliche, private e simmetriche utilizzate per proteggere dati riservati.</span><span class="sxs-lookup"><span data-stu-id="31f83-107">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], encryption keys include a combination of public, private, and symmetric keys that are used to protect sensitive data.</span></span> <span data-ttu-id="31f83-108">La chiave simmetrica viene creata durante l'inizializzazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] quando si avvia per la prima volta l'istanza [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="31f83-108">The symmetric key is created during [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] initialization when you first start the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="31f83-109">La chiave è utilizzata da [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per crittografare dati riservati archiviati in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="31f83-109">The key is used by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to encrypt sensitive data that is stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="31f83-110">Le chiavi pubblica e privata vengono create dal sistema operativo e sono utilizzate per proteggere la chiave simmetrica.</span><span class="sxs-lookup"><span data-stu-id="31f83-110">Public and private keys are created by the operating system and they are used to protect the symmetric key.</span></span> <span data-ttu-id="31f83-111">Per ogni istanza [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] che contiene dati riservati in un database viene creata una coppia di chiavi pubblica e privata.</span><span class="sxs-lookup"><span data-stu-id="31f83-111">A public and private key pair is created for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance that stores sensitive data in a database.</span></span>  
  
## <a name="applications-for-sql-server-and-database-keys"></a><span data-ttu-id="31f83-112">Applicazioni per chiavi del SQL Server e del database</span><span class="sxs-lookup"><span data-stu-id="31f83-112">Applications for SQL Server and Database Keys</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="31f83-113">contiene due applicazioni principali per le chiavi: una *chiave master del servizio* (SMK) generata per un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e una *chiave master del database* (DMK) usata per un database.</span><span class="sxs-lookup"><span data-stu-id="31f83-113">has two primary applications for keys: a *service master key* (SMK) generated on and for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance, and a *database master key* (DMK) used for a database.</span></span>  
  
 <span data-ttu-id="31f83-114">La SMK viene generata automaticamente la prima volta che viene avviata e usata l'istanza [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per crittografare la password, le credenziali o la chiave master del database di un server collegato.</span><span class="sxs-lookup"><span data-stu-id="31f83-114">The SMK is automatically generated the first time the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is started and is used to encrypt a linked server password, credentials, and the database master key.</span></span> <span data-ttu-id="31f83-115">La SMK viene crittografata usando la chiave locale del computer che utilizza l'API Windows Data Protection (DPAPI).</span><span class="sxs-lookup"><span data-stu-id="31f83-115">The SMK is encrypted by using the local computer key using the Windows Data Protection API (DPAPI).</span></span> <span data-ttu-id="31f83-116">Il DPAPI usa una chiave derivata dalle credenziali Windows dell'account di servizio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] e le credenziali del computer.</span><span class="sxs-lookup"><span data-stu-id="31f83-116">The DPAPI uses a key that is derived from the Windows credentials of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account and the computer's credentials.</span></span> <span data-ttu-id="31f83-117">La chiave master del servizio può essere decrittografata solo dall'account del servizio con cui è stata creata o da un'entità autorizzata ad accedere alle credenziali della macchina.</span><span class="sxs-lookup"><span data-stu-id="31f83-117">The service master key can only be decrypted by the service account under which it was created or by a principal that has access to the machine's credentials.</span></span>  
  
 <span data-ttu-id="31f83-118">La chiave master del database è una chiave simmetrica utilizzata per proteggere le chiavi private dei certificati e le chiavi asimmetriche presenti nel database.</span><span class="sxs-lookup"><span data-stu-id="31f83-118">The database master key is a symmetric key that is used to protect the private keys of certificates and asymmetric keys that are present in the database.</span></span> <span data-ttu-id="31f83-119">Si può utilizzare anche per crittografare dati, ma ha limitazioni di lunghezza che la rendono meno pratica per i dati rispetto all'utilizzo di una chiave simmetrica.</span><span class="sxs-lookup"><span data-stu-id="31f83-119">It can also be used to encrypt data, but it has length limitations that make it less practical for data than using a symmetric key.</span></span>  
  
 <span data-ttu-id="31f83-120">Al momento della creazione, la chiave master viene crittografata con l'algoritmo Triple DES e una password specificata dall'utente.</span><span class="sxs-lookup"><span data-stu-id="31f83-120">When it is created, the master key is encrypted by using the Triple DES algorithm and a user-supplied password.</span></span> <span data-ttu-id="31f83-121">Per attivare la decrittografia automatica della chiave master, viene crittografata una copia della chiave utilizzando la SMK.</span><span class="sxs-lookup"><span data-stu-id="31f83-121">To enable the automatic decryption of the master key, a copy of the key is encrypted by using the SMK.</span></span> <span data-ttu-id="31f83-122">Viene archiviata in entrambi i database dove è utilizzata e nel database `master` di sistema.</span><span class="sxs-lookup"><span data-stu-id="31f83-122">It is stored in both the database where it is used and in the `master` system database.</span></span>  
  
 <span data-ttu-id="31f83-123">La copia della DMK archiviata nel database `master` di sistema viene aggiornata automaticamente ogni qualvolta la DMK è modificata.</span><span class="sxs-lookup"><span data-stu-id="31f83-123">The copy of the DMK stored in the `master` system database is silently updated whenever the DMK is changed.</span></span> <span data-ttu-id="31f83-124">Tuttavia, questa impostazione predefinita può essere modificata utilizzando l'opzione `DROP ENCRYPTION BY SERVICE MASTER KEY` dell'istruzione `ALTER MASTER KEY`.</span><span class="sxs-lookup"><span data-stu-id="31f83-124">However, this default can be changed by using the `DROP ENCRYPTION BY SERVICE MASTER KEY` option of the `ALTER MASTER KEY` statement.</span></span> <span data-ttu-id="31f83-125">Per aprire una DMK non crittografata con la chiave master del servizio, è necessario utilizzare l'istruzione `OPEN MASTER KEY` e una password.</span><span class="sxs-lookup"><span data-stu-id="31f83-125">A DMK that is not encrypted by the service master key must be opened by using the `OPEN MASTER KEY` statement and a password.</span></span>  
  
## <a name="managing-sql-server-and-database-keys"></a><span data-ttu-id="31f83-126">Gestione delle chiavi del SQL Server e del database</span><span class="sxs-lookup"><span data-stu-id="31f83-126">Managing SQL Server and Database Keys</span></span>  
 <span data-ttu-id="31f83-127">La gestione delle chiavi di crittografia comprende la creazione di nuove chiavi di database, la creazione di un backup delle chiavi server e del database e informazioni su quando e come ripristinare, eliminare o modificare le chiavi.</span><span class="sxs-lookup"><span data-stu-id="31f83-127">Managing encryption keys consists of creating new database keys, creating a backup of the server and database keys, and knowing when and how to restore, delete, or change the keys.</span></span>  
  
 <span data-ttu-id="31f83-128">Per la gestione delle chiavi simmetriche è possibile utilizzare gli strumenti inclusi in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="31f83-128">To manage symmetric keys, you can use the tools included in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to do the following:</span></span>  
  
-   <span data-ttu-id="31f83-129">Backup di una copia delle chiavi del server e del database per poterle utilizzare per il recupero dell'installazione di un server di report o come parte di una migrazione pianificata.</span><span class="sxs-lookup"><span data-stu-id="31f83-129">Back up a copy of the server and database keys so that you can use them to recover a server installation, or as part of a planned migration.</span></span>  
  
-   <span data-ttu-id="31f83-130">Ripristino di una chiave precedentemente salvata in un database.</span><span class="sxs-lookup"><span data-stu-id="31f83-130">Restore a previously saved key to a database.</span></span> <span data-ttu-id="31f83-131">Consente a una nuova istanza del server l'accesso a dati esistenti che non erano stati crittografati in origine.</span><span class="sxs-lookup"><span data-stu-id="31f83-131">This enables a new server instance to access existing data that it did not originally encrypt.</span></span>  
  
-   <span data-ttu-id="31f83-132">Eliminazione dei dati crittografati in un database nel caso molto improbabile in cui non sia più possibile accedere a tali dati.</span><span class="sxs-lookup"><span data-stu-id="31f83-132">Delete the encrypted data in a database in the unlikely event that you can no longer access encrypted data.</span></span>  
  
-   <span data-ttu-id="31f83-133">Ricreazione delle chiavi e riesecuzione della crittografia dei dati nel caso molto improbabile in cui la chiave risulti compromessa.</span><span class="sxs-lookup"><span data-stu-id="31f83-133">Re-create keys and re-encrypt data in the unlikely event that the key is compromised.</span></span> <span data-ttu-id="31f83-134">Come procedura di sicurezza consigliata, ricreare le chiavi periodicamente, ad esempio dopo qualche mese, per proteggere il server da attacchi informatici mirati alla decrittazione delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="31f83-134">As a security best practice, you should re-create the keys periodically (for example, every few months) to protect the server from attacks that try to decipher the keys.</span></span>  
  
-   <span data-ttu-id="31f83-135">Aggiunta o rimozione di un'istanza del server da una distribuzione del server con scalabilità orizzontale in cui più server condividono sia un unico database sia la chiave che consente la crittografia reversibile per quel database.</span><span class="sxs-lookup"><span data-stu-id="31f83-135">Add or remove a server instance from a server scale-out deployment where multiple servers share both a single database and the key that provides reversible encryption for that database.</span></span>  
  
## <a name="important-security-information"></a><span data-ttu-id="31f83-136">Importanti informazioni relative alla sicurezza</span><span class="sxs-lookup"><span data-stu-id="31f83-136">Important Security Information</span></span>  
 <span data-ttu-id="31f83-137">L'accesso a oggetti protetti dalla chiave master del servizio richiede l'account di servizio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] utilizzato per creare la chiave o l'account del computer.</span><span class="sxs-lookup"><span data-stu-id="31f83-137">Accessing objects secured by the service master key requires either the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service account that was used to create the key or the computer (machine) account.</span></span> <span data-ttu-id="31f83-138">In altre parole, il computer è legato al sistema sul quale la chiave è stata creata.</span><span class="sxs-lookup"><span data-stu-id="31f83-138">That is, the computer is tied to the system where the key was created.</span></span> <span data-ttu-id="31f83-139">È possibile modificare l'account del servizio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]*o* l'account del computer senza perdere l'accesso alla chiave.</span><span class="sxs-lookup"><span data-stu-id="31f83-139">You can change the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service account *or* the computer account without losing access to the key.</span></span> <span data-ttu-id="31f83-140">Tuttavia, se si modificano entrambi, si perderà l'accesso alla chiave master del servizio.</span><span class="sxs-lookup"><span data-stu-id="31f83-140">However, if you change both, you will lose access to the service master key.</span></span> <span data-ttu-id="31f83-141">Se si verifica tale perdita senza disporre di uno di questi due elementi, non sarà possibile decrittografare i dati e gli oggetti crittografati usando la chiave originale.</span><span class="sxs-lookup"><span data-stu-id="31f83-141">If you lose access to the service master key without one of these two elements, you be unable to decrypt data and objects encrypted by using the original key.</span></span>  
  
 <span data-ttu-id="31f83-142">Non è possibile ripristinare connessioni protette con la chiave master del servizio se non si dispone della stessa.</span><span class="sxs-lookup"><span data-stu-id="31f83-142">Connections secured with the service master key cannot be restored without the service master key.</span></span>  
  
 <span data-ttu-id="31f83-143">L'accesso a oggetti e dati protetti con la chiave master del database richiede solo la password utilizzata per proteggere la chiave.</span><span class="sxs-lookup"><span data-stu-id="31f83-143">Access to objects and data secured with the database master key require only the password that is used to help secure the key.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="31f83-144">Se si perde ogni accesso alle chiavi descritte in precedenza, si perderà l'accesso agli oggetti, alle connessioni e ai dati protetti da quelle chiavi.</span><span class="sxs-lookup"><span data-stu-id="31f83-144">If you lose all access to the keys described earlier, you will lose access to the objects, connections, and data secured by those keys.</span></span> <span data-ttu-id="31f83-145">È possibile ripristinare la chiave master del servizio, come viene descritto nei collegamenti qui riportati, oppure è possibile ritornare al sistema di crittografa originale per recuperare l'accesso.</span><span class="sxs-lookup"><span data-stu-id="31f83-145">You can restore the service master key, as described in the links that are shown here, or you can go back to the original encrypting system to recover the access.</span></span> <span data-ttu-id="31f83-146">Non è possibile recuperare l'accesso in altro modo.</span><span class="sxs-lookup"><span data-stu-id="31f83-146">There is no "back-door" to recover the access.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="31f83-147">Contenuto della sezione</span><span class="sxs-lookup"><span data-stu-id="31f83-147">In This Section</span></span>  
 [<span data-ttu-id="31f83-148">Chiave master del servizio</span><span class="sxs-lookup"><span data-stu-id="31f83-148">Service Master Key</span></span>](service-master-key.md)  
 <span data-ttu-id="31f83-149">Viene fornita una breve spiegazione della chiave master del servizio e delle procedure consigliate.</span><span class="sxs-lookup"><span data-stu-id="31f83-149">Provides a brief explanation for the service master key and its best practices.</span></span>  
  
 [<span data-ttu-id="31f83-150">Extensible Key Management &#40;EKM&#41;</span><span class="sxs-lookup"><span data-stu-id="31f83-150">Extensible Key Management &#40;EKM&#41;</span></span>](extensible-key-management-ekm.md)  
 <span data-ttu-id="31f83-151">Viene illustrata la modalità di utilizzo dei sistemi di gestione delle chiavi di terze parti con [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="31f83-151">Explains how to use third-party key management systems with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="31f83-152">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="31f83-152">Related Tasks</span></span>  
 [<span data-ttu-id="31f83-153">Eseguire il backup della chiave master del servizio</span><span class="sxs-lookup"><span data-stu-id="31f83-153">Back Up the Service Master Key</span></span>](back-up-the-service-master-key.md)  
  
 [<span data-ttu-id="31f83-154">Ripristino della chiave master del servizio</span><span class="sxs-lookup"><span data-stu-id="31f83-154">Restore the Service Master Key</span></span>](restore-the-service-master-key.md)  
  
 [<span data-ttu-id="31f83-155">Creazione della chiave master di un database</span><span class="sxs-lookup"><span data-stu-id="31f83-155">Create a Database Master Key</span></span>](create-a-database-master-key.md)  
  
 [<span data-ttu-id="31f83-156">Backup della chiave master di un database</span><span class="sxs-lookup"><span data-stu-id="31f83-156">Back Up a Database Master Key</span></span>](back-up-a-database-master-key.md)  
  
 [<span data-ttu-id="31f83-157">Ripristino di una chiave master del database</span><span class="sxs-lookup"><span data-stu-id="31f83-157">Restore a Database Master Key</span></span>](restore-a-database-master-key.md)  
  
 [<span data-ttu-id="31f83-158">Creare chiavi simmetriche identiche su due server</span><span class="sxs-lookup"><span data-stu-id="31f83-158">Create Identical Symmetric Keys on Two Servers</span></span>](create-identical-symmetric-keys-on-two-servers.md)  
  
 [<span data-ttu-id="31f83-159">Extensible Key Management con l'insieme di credenziali delle chiavi di Azure &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="31f83-159">Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;</span></span>](extensible-key-management-using-azure-key-vault-sql-server.md)  
  
 [<span data-ttu-id="31f83-160">Abilitare Transparent Data Encryption con EKM</span><span class="sxs-lookup"><span data-stu-id="31f83-160">Enable TDE Using EKM</span></span>](enable-tde-on-sql-server-using-ekm.md)  
  
## <a name="related-content"></a><span data-ttu-id="31f83-161">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="31f83-161">Related Content</span></span>  
 [<span data-ttu-id="31f83-162">CREATE MASTER KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="31f83-162">CREATE MASTER KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-master-key-transact-sql)  
  
 [<span data-ttu-id="31f83-163">ALTER SERVICE MASTER KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="31f83-163">ALTER SERVICE MASTER KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-service-master-key-transact-sql)  
  
 [<span data-ttu-id="31f83-164">Ripristino di una chiave master del database</span><span class="sxs-lookup"><span data-stu-id="31f83-164">Restore a Database Master Key</span></span>](restore-a-database-master-key.md)  
  
## <a name="see-also"></a><span data-ttu-id="31f83-165">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="31f83-165">See Also</span></span>  
 <span data-ttu-id="31f83-166">[Eseguire il backup e il ripristino delle chiavi di crittografia di Reporting Services](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="31f83-166">[Back Up and Restore Reporting Services Encryption Keys](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span></span>  
 <span data-ttu-id="31f83-167">[Eliminare e ricreare chiavi di crittografia &#40;Gestione configurazione SSRS&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="31f83-167">[Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span></span>  
 <span data-ttu-id="31f83-168">[Aggiungere e rimuovere le chiavi di crittografia per una distribuzione con scalabilità orizzontale &#40;Gestione configurazione SSRS&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span><span class="sxs-lookup"><span data-stu-id="31f83-168">[Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span></span>  
 [<span data-ttu-id="31f83-169">Transparent Data Encryption &#40;TDE&#41;</span><span class="sxs-lookup"><span data-stu-id="31f83-169">Transparent Data Encryption &#40;TDE&#41;</span></span>](transparent-data-encryption.md)  
  
  
