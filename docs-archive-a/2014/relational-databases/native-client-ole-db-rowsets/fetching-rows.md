---
title: Recupero di righe | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- fetching rows
- OLE DB rowsets, fetching
- rowsets [OLE DB], fetching
- IRowset interface
- SQL Server Native Client OLE DB provider, fetching
ms.assetid: 5e6dbe36-b682-464d-adfa-8e886f9bd452
author: rothja
ms.author: jroth
ms.openlocfilehash: 435e1d705091814b2544c75772f20882caddf942
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625373"
---
# <a name="fetching-rows"></a><span data-ttu-id="e722b-102">Recupero di righe</span><span class="sxs-lookup"><span data-stu-id="e722b-102">Fetching Rows</span></span>
  <span data-ttu-id="e722b-103">**IRowset** è l'interfaccia di base dei set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-103">The **IRowset** interface is the base rowset interface.</span></span> <span data-ttu-id="e722b-104">L'interfaccia **IRowset** comprende metodi che consentono di recuperare le righe in modo sequenziale, ottenere dati dalle righe e gestire le righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-104">The **IRowset** interface provides methods for fetching rows sequentially, getting the data from those rows, and managing rows.</span></span> <span data-ttu-id="e722b-105">I consumer utilizzano i metodi disponibili in **IRowset** per tutte le operazioni di base relative ai set di righe,</span><span class="sxs-lookup"><span data-stu-id="e722b-105">Consumers use the methods in **IRowset** for all basic rowset operations.</span></span> <span data-ttu-id="e722b-106">incluse quelle che consentono di recuperare e rilasciare le righe nonché ottenere i valori delle colonne.</span><span class="sxs-lookup"><span data-stu-id="e722b-106">This includes fetching and releasing rows and getting column values.</span></span>  
  
 <span data-ttu-id="e722b-107">Quando un consumer ottiene un puntatore di interfaccia su un set di righe, il primo passaggio consiste, in genere, nel determinare le funzionalità del set di righe mediante il metodo **IRowsetInfo::GetProperties**.</span><span class="sxs-lookup"><span data-stu-id="e722b-107">When a consumer obtains an interface pointer on a rowset, the first step is ordinarily to determine the capabilities of the rowset by using the **IRowsetInfo::GetProperties** method.</span></span> <span data-ttu-id="e722b-108">In questo modo vengono restituite le informazioni sulle interfacce esposte dal set di righe nonché le funzionalità del set di righe che non vengono visualizzate come interfacce distinte, ad esempio il numero massimo di righe attive e il numero di righe che possono presentare aggiornamenti in sospeso contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e722b-108">This returns information about the interfaces exposed by the rowset and also capabilities of the rowset that do not show up as distinct interfaces, such as the maximum number of active rows and the number of rows that can have pending updates at the same time.</span></span>  
  
 <span data-ttu-id="e722b-109">Il passaggio successivo per i consumer consiste nel determinare le caratteristiche, o metadati, delle colonne nel set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-109">The next step for consumers is to determine the characteristics, or metadata, of the columns in the rowset.</span></span> <span data-ttu-id="e722b-110">A questo scopo, è necessario utilizzare il metodo **IColumnsInfo** per le informazioni sulle colonne semplici o il metodo **IColumnsRowset** per le informazioni sulle colonne estese.</span><span class="sxs-lookup"><span data-stu-id="e722b-110">For this they use the **IColumnsInfo** method for simple column information or the **IColumnsRowset** method for extended column information.</span></span> <span data-ttu-id="e722b-111">Il metodo **GetColumnInfo** restituisce le informazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e722b-111">The **GetColumnInfo** method returns the following information:</span></span>  
  
-   <span data-ttu-id="e722b-112">Il numero di colonne nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="e722b-112">The number of columns in the result set.</span></span>  
  
-   <span data-ttu-id="e722b-113">Una matrice di strutture DBCOLUMNINFO, una per colonna.</span><span class="sxs-lookup"><span data-stu-id="e722b-113">An array of DBCOLUMNINFO structures, one per column.</span></span>  
  
     <span data-ttu-id="e722b-114">L'ordine delle strutture corrisponde all'ordine in cui le colonne vengono visualizzate nel set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-114">The order of the structures is the order in which the columns appear in the rowset.</span></span> <span data-ttu-id="e722b-115">Ogni struttura DBCOLUMNINFO include metadati di colonna, ad esempio nome della colonna, ordinale della colonna, lunghezza massima consentita per un valore nella colonna, tipo di dati della colonna, precisione e lunghezza.</span><span class="sxs-lookup"><span data-stu-id="e722b-115">Each DBCOLUMNINFO structure includes column metadata, such as column name, ordinal of the column, maximum possible length of a value in the column, data type of the column, precision, and length.</span></span>  
  
-   <span data-ttu-id="e722b-116">Il puntatore a un archivio per tutti i valori stringa all'interno di un singolo blocco di allocazione.</span><span class="sxs-lookup"><span data-stu-id="e722b-116">The pointer to a storage for all string values within a single allocation block.</span></span>  
  
 <span data-ttu-id="e722b-117">Il consumer determina le colonne necessarie dai metadati o in base al comando di testo che ha generato il set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-117">The consumer determines which columns it needs either from the metadata or based on the text command that generated the rowset.</span></span> <span data-ttu-id="e722b-118">Determina inoltre gli ordinali delle colonne necessarie dall'ordinamento delle informazioni sulle colonne restituite da **IColumnsInfo** o dagli ordinali nel set di righe dei metadati di colonna restituito da **IColumnsRowset**.</span><span class="sxs-lookup"><span data-stu-id="e722b-118">It determines the ordinals of the needed columns from the ordering of the column information returned by **IColumnsInfo** or from the ordinals in the column metadata rowset returned by **IColumnsRowset**.</span></span>  
  
 <span data-ttu-id="e722b-119">Le interfacce **IColumnsInfo** e **IColumnsRowset** vengono utilizzate per estrarre informazioni sulle colonne nel set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-119">The **IColumnsInfo** and **IColumnsRowset** interfaces are used to extract information about the columns in the rowset.</span></span> <span data-ttu-id="e722b-120">L'interfaccia **IColumnsInfo** restituisce un set limitato di informazioni, mentre **IColumnsRowset** fornisce tutti i metadati.</span><span class="sxs-lookup"><span data-stu-id="e722b-120">The **IColumnsInfo** interface returns a limited set of information, whereas **IColumnsRowset** provides all the metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e722b-121">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] versione 7.0 e precedenti la colonna dei metadati facoltativa DBCOLUMN_COMPUTEMODE restituita da **IColumnsInfo::GetColumnsInfo** restituisce DBSTATUS_S_ISNULL, anziché i valori che descrivono se la colonna viene calcolata, perché non è possibile stabilire se la colonna sottostante viene calcolata.</span><span class="sxs-lookup"><span data-stu-id="e722b-121">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 and earlier, the optional metadata column DBCOLUMN_COMPUTEMODE returned by **IColumnsInfo::GetColumnsInfo** returns DBSTATUS_S_ISNULL (instead of the values describing whether the column is computed) because it cannot be determined whether the underlying column is computed.</span></span>  
  
 <span data-ttu-id="e722b-122">Gli ordinali vengono utilizzati per specificare un'associazione a una colonna.</span><span class="sxs-lookup"><span data-stu-id="e722b-122">The ordinals are used to specify a binding to a column.</span></span> <span data-ttu-id="e722b-123">Un'associazione è una struttura che associa un elemento della struttura del consumer a una colonna.</span><span class="sxs-lookup"><span data-stu-id="e722b-123">A binding is a structure that associates an element of the consumer's structure with a column.</span></span> <span data-ttu-id="e722b-124">Può inoltre associare il valore dei dati, la lunghezza e il valore dello stato della colonna.</span><span class="sxs-lookup"><span data-stu-id="e722b-124">The binding can bind the data value, length, and status value of the column.</span></span>  
  
 <span data-ttu-id="e722b-125">Un set di associazioni viene raccolto in una funzione di accesso</span><span class="sxs-lookup"><span data-stu-id="e722b-125">A set of bindings is gathered together in an accessor.</span></span> <span data-ttu-id="e722b-126">creata mediante il metodo **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="e722b-126">This is created by using the **IAccessor::CreateAccessor** method.</span></span> <span data-ttu-id="e722b-127">Una funzione di accesso può contenere più associazioni in modo da consentire il recupero o l'impostazione dei dati per più colonne in una singola chiamata.</span><span class="sxs-lookup"><span data-stu-id="e722b-127">An accessor can contain multiple bindings so that the data for multiple columns can be retrieved or set in a single call.</span></span> <span data-ttu-id="e722b-128">Il consumer può creare diverse funzioni di accesso in base ai differenti modelli di utilizzo nelle varie parti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e722b-128">The consumer can create several accessors to match different usage patterns in different parts of the application.</span></span> <span data-ttu-id="e722b-129">Può creare e rilasciare funzioni di accesso mentre il set di righe è ancora attivo.</span><span class="sxs-lookup"><span data-stu-id="e722b-129">It can create and release accessors while the rowset remains in existence.</span></span>  
  
 <span data-ttu-id="e722b-130">Per recuperare righe dal database, il consumer chiama un metodo, ad esempio **IRowset::GetNextRows** o **IRowsetLocate::GetRowsAt**.</span><span class="sxs-lookup"><span data-stu-id="e722b-130">To fetch rows from the database, the consumer calls a method, such as **IRowset::GetNextRows** or **IRowsetLocate::GetRowsAt**.</span></span> <span data-ttu-id="e722b-131">Queste operazioni di recupero inseriscono i dati delle righe dal server nel buffer di riga del provider.</span><span class="sxs-lookup"><span data-stu-id="e722b-131">These fetch operations put row data from the server into the row buffer of the provider.</span></span> <span data-ttu-id="e722b-132">Il consumer non dispone di accesso diretto al buffer di riga del provider</span><span class="sxs-lookup"><span data-stu-id="e722b-132">The consumer does not have direct access to the row buffer of the provider.</span></span> <span data-ttu-id="e722b-133">e utilizza **IRowset::GetData** per copiare i dati dal buffer del provider nel proprio buffer e **IRowsetChange::SetData** per copiare le modifiche dei dati dal proprio buffer nel buffer del provider.</span><span class="sxs-lookup"><span data-stu-id="e722b-133">The consumer uses **IRowset::GetData** to copy data from the buffer of the provider to the consumer buffer and **IRowsetChange::SetData** to copy data changes from the consumer buffer to the provider buffer.</span></span>  
  
 <span data-ttu-id="e722b-134">Il consumer chiama il metodo **GetData** e passa l'handle a una riga, l'handle a una funzione di accesso e un puntatore a un buffer allocato dal consumer.</span><span class="sxs-lookup"><span data-stu-id="e722b-134">The consumer calls the **GetData** method and passes the handle to a row, the handle to an accessor, and a pointer to a consumer-allocated buffer.</span></span> <span data-ttu-id="e722b-135">**GetData** converte i dati e restituisce le colonne come specificato nelle associazioni utilizzate per creare la funzione di accesso.</span><span class="sxs-lookup"><span data-stu-id="e722b-135">**GetData** converts the data and returns the columns as specified in the bindings used to create the accessor.</span></span> <span data-ttu-id="e722b-136">Il consumer può chiamare **GetData** più volte per una riga, utilizzando buffer e funzioni di accesso differenti, e può pertanto ottenere più copie degli stessi dati.</span><span class="sxs-lookup"><span data-stu-id="e722b-136">The consumer can call **GetData** more than one time for a row, using different accessors and buffers and therefore the consumer can obtain multiple copies of the same data.</span></span>  
  
 <span data-ttu-id="e722b-137">I dati delle colonne a lunghezza variabile possono essere utilizzati in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="e722b-137">Data from variable-length columns can be treated several ways.</span></span> <span data-ttu-id="e722b-138">Innanzitutto, tali colonne possono essere associate a una sezione limitata della struttura del consumer.</span><span class="sxs-lookup"><span data-stu-id="e722b-138">First, such columns can be bound to a finite section of the consumer's structure.</span></span> <span data-ttu-id="e722b-139">Questo causa il troncamento quando la lunghezza dei dati supera la lunghezza del buffer.</span><span class="sxs-lookup"><span data-stu-id="e722b-139">This causes truncation when the length of the data exceeds the length of the buffer.</span></span> <span data-ttu-id="e722b-140">Per stabilire se il troncamento si è verificato, il consumer può controllare lo stato DBSTATUS_S_TRUNCATED.</span><span class="sxs-lookup"><span data-stu-id="e722b-140">The consumer can determine that truncation has occurred by checking for the status DBSTATUS_S_TRUNCATED.</span></span> <span data-ttu-id="e722b-141">Poiché la lunghezza restituita è sempre la lunghezza effettiva in byte, il consumer può determinare anche la quantità di dati troncati.</span><span class="sxs-lookup"><span data-stu-id="e722b-141">The returned length is always the true length in bytes, so that the consumer also can determine how much data was truncated.</span></span>  
  
 <span data-ttu-id="e722b-142">Al termine del recupero o dell'aggiornamento, il consumer rilascia le righe mediante il metodo **ReleaseRows**.</span><span class="sxs-lookup"><span data-stu-id="e722b-142">When the consumer has finished fetching or updating rows, it releases them with the **ReleaseRows** method.</span></span> <span data-ttu-id="e722b-143">In questo modo vengono rilasciate le risorse dalla copia delle righe nel set di righe e si crea spazio per le nuove righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-143">This releases resources from the copy of the rows in the rowset and makes room for new rows.</span></span> <span data-ttu-id="e722b-144">Il consumer può quindi ripetere il ciclo di recupero o creazione di righe e di accesso ai dati in esse contenuti.</span><span class="sxs-lookup"><span data-stu-id="e722b-144">The consumer can then repeat its cycle of fetching or creating rows and accessing the data in them.</span></span>  
  
 <span data-ttu-id="e722b-145">Al termine delle operazioni relative al set di righe, il consumer chiama il metodo **IAccessor::ReleaseAccessor** per rilasciare le funzioni di accesso</span><span class="sxs-lookup"><span data-stu-id="e722b-145">When the consumer is finished with the rowset, it calls the **IAccessor::ReleaseAccessor** method to release any accessor.</span></span> <span data-ttu-id="e722b-146">e il metodo **IUnknown::Release** su tutte le interfacce esposte dal set di righe per rilasciare il set di righe.</span><span class="sxs-lookup"><span data-stu-id="e722b-146">It calls the **IUnknown::Release** method on all interfaces exposed by the rowset to release the rowset.</span></span> <span data-ttu-id="e722b-147">Quando il set di righe viene rilasciato, forza il rilascio delle eventuali righe o funzioni di accesso rimanenti ancora in gestione da parte del consumer.</span><span class="sxs-lookup"><span data-stu-id="e722b-147">When the rowset is released, it forces the release of any remaining rows or accessors the consumer may hold.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="e722b-148">Contenuto della sezione</span><span class="sxs-lookup"><span data-stu-id="e722b-148">In This Section</span></span>  
  
-   [<span data-ttu-id="e722b-149">Posizione del recupero successivo</span><span class="sxs-lookup"><span data-stu-id="e722b-149">Next Fetch Position</span></span>](fetching-rows-next-fetch-position.md)  
  
## <a name="see-also"></a><span data-ttu-id="e722b-150">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e722b-150">See Also</span></span>  
 [<span data-ttu-id="e722b-151">Set di righe</span><span class="sxs-lookup"><span data-stu-id="e722b-151">Rowsets</span></span>](rowsets.md)  
  
  
