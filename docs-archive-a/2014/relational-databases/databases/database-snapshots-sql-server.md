---
title: Snapshot del database (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- static database views
- snapshots [SQL Server database snapshots]
- source databases [SQL Server]
- snapshots [SQL Server database snapshots], about database snapshots
- database snapshots [SQL Server]
- read-only database views
- database snapshots [SQL Server], about database snapshots
ms.assetid: 00179314-f23e-47cb-a35c-da6f180f86d3
author: stevestein
ms.author: sstein
ms.openlocfilehash: 8a0fa9b6cee2287d4e6060d4cb39f34d909e7db9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725895"
---
# <a name="database-snapshots-sql-server"></a><span data-ttu-id="6ee4e-102">Snapshot del database (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6ee4e-102">Database Snapshots (SQL Server)</span></span>
  <span data-ttu-id="6ee4e-103">Uno snapshot del database è una vista statica di sola lettura di un database [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , ovvero il *database di origine*.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-103">A database snapshot is a read-only, static view of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database (the *source database*).</span></span> <span data-ttu-id="6ee4e-104">Lo snapshot del database è consistente dal punto di vista transazionale con il database di origine al momento della creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-104">The database snapshot is transactionally consistent with the source database as of the moment of the snapshot's creation.</span></span> <span data-ttu-id="6ee4e-105">Lo snapshot di un database deve risiedere sempre nella stessa istanza del server dove si trova il relativo database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-105">A database snapshot always resides on the same server instance as its source database.</span></span> <span data-ttu-id="6ee4e-106">Con l'aggiornamento del database di origine, viene aggiornato anche lo snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-106">As the source database is updated, the database snapshot is updated.</span></span> <span data-ttu-id="6ee4e-107">Pertanto, più a lungo viene conservato uno snapshot del database, più è probabile che utilizzi tutto il proprio spazio disponibile su disco.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-107">Therefore, the longer a database snapshot exists, the more likely it is to use up its available disk space.</span></span>  
  
 <span data-ttu-id="6ee4e-108">È possibile generare più snapshot di uno stesso database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-108">Multiple snapshots can exist on a given source database.</span></span> <span data-ttu-id="6ee4e-109">Ogni snapshot del database viene mantenuto finché non viene eliminato esplicitamente dal proprietario del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-109">Each database snapshot persists until it is explicitly dropped by the database owner.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6ee4e-110">Gli snapshot del database non sono correlati a backup di snapshot, transazioni di isolamento dello snapshot o replica snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-110">Database snapshots are unrelated to snapshot backups, snapshot isolation of transactions, or snapshot replication.</span></span>  
  
 <span data-ttu-id="6ee4e-111">**Contenuto dell'argomento**</span><span class="sxs-lookup"><span data-stu-id="6ee4e-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="6ee4e-112">Panoramica delle caratteristiche</span><span class="sxs-lookup"><span data-stu-id="6ee4e-112">Feature Overview</span></span>](#FeatureOverview)  
  
-   [<span data-ttu-id="6ee4e-113">Vantaggi degli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-113">Benefits of Database Snapshots</span></span>](#Benefits)  
  
-   [<span data-ttu-id="6ee4e-114">Termini e definizioni</span><span class="sxs-lookup"><span data-stu-id="6ee4e-114">Terms and Definitions</span></span>](#TermsAndDefinitions)  
  
-   [<span data-ttu-id="6ee4e-115">Prerequisiti e limitazioni per gli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-115">Prerequisites for and Limitations on Database Snapshots</span></span>](#LimitationsRequirements)  
  
-   [<span data-ttu-id="6ee4e-116">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="6ee4e-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="feature-overview"></a><a name="FeatureOverview"></a> <span data-ttu-id="6ee4e-117">Panoramica delle caratteristiche</span><span class="sxs-lookup"><span data-stu-id="6ee4e-117">Feature Overview</span></span>  
 <span data-ttu-id="6ee4e-118">Gli snapshot del database operano a livello di pagine di dati.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-118">Database snapshots operate at the data-page level.</span></span> <span data-ttu-id="6ee4e-119">Prima che una pagina del database di origine venga modificata per la prima volta, la pagina originale viene copiata dal database di origine allo snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-119">Before a page of the source database is modified for the first time, the original page is copied from the source database to the snapshot.</span></span> <span data-ttu-id="6ee4e-120">Nello snapshot viene archiviata la pagina originale, mantenendo i record di dati nello stato corrispondente al momento in cui è stato creato lo snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-120">The snapshot stores the original page, preserving the data records as they existed when the snapshot was created.</span></span> <span data-ttu-id="6ee4e-121">Lo stesso processo viene ripetuto per ogni pagina modificata per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-121">The same process is repeated for every page that is being modified for the first time.</span></span> <span data-ttu-id="6ee4e-122">All'utente uno snapshot del database appare sempre come non modificato, in quanto le operazioni di lettura nello snapshot del database accedono sempre alle pagine di dati originali, indipendentemente dalla posizione.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-122">To the user, a database snapshot appears never to change, because read operations on a database snapshot always access the original data pages, regardless of where they reside.</span></span>  
  
 <span data-ttu-id="6ee4e-123">Per archiviare le pagine originali copiate, lo snapshot utilizza uno o più *file sparse*.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-123">To store the copied original pages, the snapshot uses one or more *sparse files*.</span></span> <span data-ttu-id="6ee4e-124">All'inizio un file sparse è un file essenzialmente vuoto che non contiene alcun dato utente e in cui non è stato allocato spazio su disco per i dati utente.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-124">Initially, a sparse file is an essentially empty file that contains no user data and has not yet been allocated disk space for user data.</span></span> <span data-ttu-id="6ee4e-125">Man mano che una sempre maggiore quantità di pagine viene aggiornata nel database di origine, la dimensione del file aumenta.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-125">As more and more pages are updated in the source database, the size of the file grows.</span></span> <span data-ttu-id="6ee4e-126">Nella figura seguente vengono illustrati gli effetti di due modelli di aggiornamento diversi sulle dimensioni di uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-126">The following figure illustrates the effects of two contrasting update patterns on the size of a snapshot.</span></span> <span data-ttu-id="6ee4e-127">Il modello di aggiornamento A rappresenta un ambiente in cui solo il 30% delle pagine originali è stato aggiornato durante la vita dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-127">Update pattern A reflects an environment in which only 30 percent of the original pages are updated during the life of the snapshot.</span></span> <span data-ttu-id="6ee4e-128">Il modello di aggiornamento B rappresenta un ambiente in cui durante la vita dello snapshot è stato aggiornato l'80% delle pagine originali.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-128">Update pattern B reflects an environment in which 80 percent of the original pages are updated during the life of the snapshot.</span></span>  
  
 <span data-ttu-id="6ee4e-129">![Modelli di aggiornamento alternativi e dimensioni dello snapshot](../../database-engine/media/dbview-04.gif "Modelli di aggiornamento alternativi e dimensioni dello snapshot")</span><span class="sxs-lookup"><span data-stu-id="6ee4e-129">![Alternative update patterns and snapshot size](../../database-engine/media/dbview-04.gif "Alternative update patterns and snapshot size")</span></span>  
  
##  <a name="benefits-of-database-snapshots"></a><a name="Benefits"></a> <span data-ttu-id="6ee4e-130">Vantaggi degli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-130">Benefits of Database Snapshots</span></span>  
  
-   <span data-ttu-id="6ee4e-131">È possibile utilizzare gli snapshot per la generazione di report.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-131">Snapshots can be used for reporting purposes.</span></span>  
  
     <span data-ttu-id="6ee4e-132">I client possono eseguire query in uno snapshot del database. Questa operazione risulta utile per la scrittura di report basati sui dati disponibili al momento della creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-132">Clients can query a database snapshot, which makes it useful for writing reports based on the data at the time of snapshot creation.</span></span>  
  
-   <span data-ttu-id="6ee4e-133">Mantenimento dei dati cronologici per la generazione di report.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-133">Maintaining historical data for report generation.</span></span>  
  
     <span data-ttu-id="6ee4e-134">Uno snapshot consente di estendere l'accesso utente ai dati relativi a un momento determinato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-134">A snapshot can extend user access to data from a particular point in time.</span></span> <span data-ttu-id="6ee4e-135">Ad esempio, è possibile creare uno snapshot del database al termine di un determinato periodo di tempo, quale un trimestre fiscale, per consentire la creazione successiva di report</span><span class="sxs-lookup"><span data-stu-id="6ee4e-135">For example, you can create a database snapshot at the end of a given time period (such as a financial quarter) for later reporting.</span></span> <span data-ttu-id="6ee4e-136">ed eseguire report di fine periodo sullo snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-136">You can then run end-of-period reports on the snapshot.</span></span> <span data-ttu-id="6ee4e-137">Se lo spazio su disco è sufficiente, è inoltre possibile mantenere gli snapshot di fine periodo a tempo indeterminato, consentendo l'esecuzione di query sui risultati relativi a tali periodi, ad esempio per esaminare le prestazioni aziendali.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-137">If disk space permits, you can also maintain end-of-period snapshots indefinitely, allowing queries against the results from these periods; for example, to investigate organizational performance.</span></span>  
  
-   <span data-ttu-id="6ee4e-138">Utilizzo di un database mirror mantenuto per assicurare la disponibilità in modo da ripartire il carico di lavoro dei report.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-138">Using a mirror database that you are maintaining for availability purposes to offload reporting.</span></span>  
  
     <span data-ttu-id="6ee4e-139">L'utilizzo degli snapshot del database con il mirroring del database consente di rendere disponibili per la creazione di report i dati archiviati nel server mirror.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-139">Using database snapshots with database mirroring permits you to make the data on the mirror server accessible for reporting.</span></span> <span data-ttu-id="6ee4e-140">L'esecuzione di query sul database mirror consente inoltre di liberare risorse sul server principale.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-140">Additionally, running queries on the mirror database can free up resources on the principal.</span></span> <span data-ttu-id="6ee4e-141">Per altre informazioni , vedere [Mirroring e snapshot del database &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-141">For more information, see [Database Mirroring and Database Snapshots &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span></span>  
  
-   <span data-ttu-id="6ee4e-142">Salvaguardia dei dati da errori amministrativi.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-142">Safeguarding data against administrative error.</span></span>  
  
-   <span data-ttu-id="6ee4e-143">In caso di errore da parte di un utente in un database di origine, è possibile ripristinare lo stato in cui si trovava il database al momento della creazione di un determinato snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-143">In the event of a user error on a source database, you can revert the source database to the state it was in when a given database snapshot was created.</span></span> <span data-ttu-id="6ee4e-144">La perdita di dati è limitata agli aggiornamenti del database eseguiti dopo la creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-144">Data loss is confined to updates to the database since the snapshot's creation.</span></span>  
  
     <span data-ttu-id="6ee4e-145">Prima dell'esecuzione di aggiornamenti importanti quale un aggiornamento bulk o una modifica dello schema, ad esempio, la creazione di uno snapshot del database consente di proteggere i dati.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-145">For example, before doing major updates, such as a bulk update or a schema change, create a database snapshot on the database protects data.</span></span> <span data-ttu-id="6ee4e-146">In caso di errore è possibile utilizzare lo snapshot per il recupero, riportando il database allo stato memorizzato nello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-146">If you make a mistake, you can use the snapshot to recover by reverting the database to the snapshot.</span></span> <span data-ttu-id="6ee4e-147">L'operazione di ripristino da snapshot risulta potenzialmente più rapida, in questo caso, rispetto al ripristino da un backup, ma non consente l'esecuzione successiva del rollforward.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-147">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6ee4e-148">Non è possibile eseguire il ripristino di un database offline o danneggiato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-148">Reverting does not work in an offline or corrupted database.</span></span> <span data-ttu-id="6ee4e-149">Per proteggere un database è pertanto necessario eseguire backup regolari e testare il piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-149">Therefore, taking regular backups and testing your restore plan are necessary to protect a database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ee4e-150">Gli snapshot del database dipendono dal database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-150">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="6ee4e-151">L'utilizzo di snapshot per il ripristino di un database, pertanto, non rappresenta una soluzione alternativa alla strategia di backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-151">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="6ee4e-152">L'esecuzione di tutti i backup pianificati rimane comunque essenziale.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-152">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="6ee4e-153">Se è necessario ripristinare il database di origine al punto nel tempo in cui è stato creato uno snapshot del database, implementare criteri di backup che consentano di eseguire tale operazione.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-153">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="6ee4e-154">Salvaguardia dei dati da errori degli utenti.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-154">Safeguarding data against user error.</span></span>  
  
     <span data-ttu-id="6ee4e-155">La creazione su base regolare di snapshot del database consente di ridurre l'impatto di un errore grave da parte degli utenti, ad esempio l'eliminazione di una tabella.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-155">By creating database snapshots on a regular basis, you can mitigate the impact of a major user error, such as a dropped table.</span></span> <span data-ttu-id="6ee4e-156">Per assicurare un livello elevato di protezione, è possibile creare una serie di snapshot del database, relativi a un intervallo di tempo sufficiente per riconoscere e rispondere alla maggior parte degli errori da parte degli utenti.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-156">For a high level of protection, you can create a series of database snapshots spanning enough time to recognize and respond to most user errors.</span></span> <span data-ttu-id="6ee4e-157">Ad esempio, è possibile mantenere da 6 a 12 snapshot in sequenza relativi a un intervallo di 24 ore, a seconda delle risorse del disco.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-157">For instance, you might maintain 6 to 12 rolling snapshots spanning a 24-hour interval, depending on your disk resources.</span></span> <span data-ttu-id="6ee4e-158">Ogni volta che viene creato un nuovo snapshot è possibile eliminare lo snapshot meno recente.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-158">Then, each time a new snapshot is created, the earliest snapshot can be deleted.</span></span>  
  
    -   <span data-ttu-id="6ee4e-159">Per il recupero dopo un errore da parte degli utenti, è possibile riportare il database allo stato registrato nello snapshot immediatamente precedente l'errore.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-159">To recover from a user error, you can revert the database to the snapshot immediately before the error.</span></span> <span data-ttu-id="6ee4e-160">L'operazione di ripristino da snapshot risulta potenzialmente più rapida, in questo caso, rispetto al ripristino da un backup, ma non consente l'esecuzione successiva del rollforward.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-160">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    -   <span data-ttu-id="6ee4e-161">In alternativa, è possibile ricostruire manualmente una tabella eliminata o altri dati persi, basandosi sulle informazioni disponibili in uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-161">Alternatively, you may be able to manually reconstruct a dropped table or other lost data from the information in a snapshot.</span></span> <span data-ttu-id="6ee4e-162">Ad esempio, è possibile eseguire una copia bulk dei dati dallo snapshot al database, quindi integrare manualmente i dati nel database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-162">For instance, you could bulk copy the data out of the snapshot into the database and manually merge the data back into the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ee4e-163">Il numero di snapshot simultanei necessari in un database, la frequenza per la creazione di un nuovo snapshot e il tempo di memorizzazione degli snapshot dipendono dalle ragioni per cui si decide di utilizzare gli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-163">Your reasons for using database snapshots determine how many concurrent snapshots you need on a database, how frequently to create a new snapshot, and how long to keep it.</span></span>  
  
-   <span data-ttu-id="6ee4e-164">Gestione di un database di prova</span><span class="sxs-lookup"><span data-stu-id="6ee4e-164">Managing a test database</span></span>  
  
     <span data-ttu-id="6ee4e-165">In un ambiente di testing, può essere utile, durante l'esecuzione ripetuta di un protocollo di test, che il database contenga dati identici all'inizio di ogni sessione di test.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-165">In a testing environment, it can be useful when repeatedly running a test protocol for the database to contain identical data at the start of each round of testing.</span></span> <span data-ttu-id="6ee4e-166">Prima di eseguire la prima sessione, uno sviluppatore o un tester di applicazioni può creare uno snapshot del database nel database di prova.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-166">Before running the first round, an application developer or tester can create a database snapshot on the test database.</span></span> <span data-ttu-id="6ee4e-167">Dopo ogni test, sarà possibile ripristinare rapidamente lo stato precedente del database ripristinando il relativo snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-167">After each test run, the database can be quickly returned to its prior state by reverting the database snapshot.</span></span>  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="6ee4e-168">Termini e definizioni</span><span class="sxs-lookup"><span data-stu-id="6ee4e-168">Terms and Definitions</span></span>  
 <span data-ttu-id="6ee4e-169">database snapshot</span><span class="sxs-lookup"><span data-stu-id="6ee4e-169">database snapshot</span></span>  
 <span data-ttu-id="6ee4e-170">Vista statica, di sola lettura e consistente dal punto di vista transazionale di un database (di origine).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-170">A transactionally consistent, read-only, static view of a database (the source database).</span></span>  
  
 <span data-ttu-id="6ee4e-171">database di origine</span><span class="sxs-lookup"><span data-stu-id="6ee4e-171">source database</span></span>  
 <span data-ttu-id="6ee4e-172">Per uno snapshot del database, il database del quale è stato creato lo snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-172">For a database snapshot, the database on which the snapshot was created.</span></span> <span data-ttu-id="6ee4e-173">Gli snapshot del database dipendono dal database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-173">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="6ee4e-174">Gli snapshot di un database devono essere inclusi nella stessa istanza del server del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-174">The snapshots of a database must be on the same server instance as the database.</span></span> <span data-ttu-id="6ee4e-175">Inoltre, se un database diventa non disponibile per qualsiasi motivo, tutti i relativi snapshot diventano anch'essi non disponibili.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-175">Furthermore, if that database becomes unavailable for any reason, all of its database snapshots also become unavailable.</span></span>  
  
 <span data-ttu-id="6ee4e-176">file sparse</span><span class="sxs-lookup"><span data-stu-id="6ee4e-176">sparse file</span></span>  
 <span data-ttu-id="6ee4e-177">File fornito dal file system NTFS che richiede molto meno spazio su disco rispetto allo spazio necessario per una modalità di gestione diversa.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-177">A file provided by the NTFS file system that requires much less disk space than would otherwise be needed.</span></span> <span data-ttu-id="6ee4e-178">Un file di tipo sparse viene utilizzato per archiviare pagine copiate in uno snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-178">A sparse file is used to store pages copied to a database snapshot.</span></span> <span data-ttu-id="6ee4e-179">Un file di tipo sparse appena creato richiede poco spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-179">When first created, a sparse file takes up little disk space.</span></span> <span data-ttu-id="6ee4e-180">Man mano che i dati vengono scritti in uno snapshot del database, lo spazio su disco viene allocato gradualmente dal file system NTFS nel file di tipo sparse corrispondente.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-180">As data is written to a database snapshot, NTFS allocates disk space gradually to the corresponding sparse file.</span></span>  
  
##  <a name="prerequisites-for-and-limitations-on-database-snapshots"></a><a name="LimitationsRequirements"></a> <span data-ttu-id="6ee4e-181">Prerequisiti e limitazioni per gli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-181">Prerequisites for and Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="6ee4e-182">**Contenuto della sezione**</span><span class="sxs-lookup"><span data-stu-id="6ee4e-182">**In This Section:**</span></span>  
  
-   [<span data-ttu-id="6ee4e-183">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="6ee4e-183">Prerequisites</span></span>](#Prerequisites)  
  
-   [<span data-ttu-id="6ee4e-184">Limitazioni del database di origine</span><span class="sxs-lookup"><span data-stu-id="6ee4e-184">Limitations on the Source Database</span></span>](#LimitsOnSourceDb)  
  
-   [<span data-ttu-id="6ee4e-185">Limitazioni degli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-185">Limitations on Database Snapshots</span></span>](#LimitsOnDbSS)  
  
-   [<span data-ttu-id="6ee4e-186">Requisiti relativi allo spazio su disco</span><span class="sxs-lookup"><span data-stu-id="6ee4e-186">Disk Space Requirements</span></span>](#DiskSpace)  
  
-   [<span data-ttu-id="6ee4e-187">Snapshot del database con filegroup offline</span><span class="sxs-lookup"><span data-stu-id="6ee4e-187">Database Snapshots with Offline Filegroups</span></span>](#OfflineFGs)  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="6ee4e-188">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="6ee4e-188">Prerequisites</span></span>  
 <span data-ttu-id="6ee4e-189">Il database di origine, in cui può essere utilizzato qualsiasi modello di recupero, deve soddisfare i prerequisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ee4e-189">The source database, which can use any recovery model, must meet the following prerequisites:</span></span>  
  
-   <span data-ttu-id="6ee4e-190">L'istanza del server deve essere in esecuzione in un'edizione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in cui sono supportati gli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-190">The server instance must be running on an edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that supports database snapshots.</span></span> <span data-ttu-id="6ee4e-191">Per ulteriori informazioni, vedere [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-191">For more information, see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
-   <span data-ttu-id="6ee4e-192">Il database di origine deve essere online, a meno che non si tratti di un database mirror nell'ambito di una sessione di mirroring del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-192">The source database must be online, unless the database is a mirror database within a database mirroring session.</span></span>  
  
-   <span data-ttu-id="6ee4e-193">È possibile creare uno snapshot del database in qualsiasi database primario o secondario in un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-193">You can create a database snapshot on any primary or secondary database in an availability group.</span></span> <span data-ttu-id="6ee4e-194">Il ruolo di replica deve essere PRIMARY o SECONDARY, non nello stato di RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-194">The replica role must be either PRIMARY or SECONDARY, not in the RESOLVING state.</span></span>  
  
     <span data-ttu-id="6ee4e-195">È consigliabile uno stato di sincronizzazione del database corrispondente a SYNCHRONIZING o SYNCHRONIZED quando si crea uno snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-195">We recommend that the database synchronization state be SYNCHRONIZING or SYNCHRONIZED when you create a database snapshot.</span></span> <span data-ttu-id="6ee4e-196">È tuttavia possibile creare gli snapshot del database anche se lo stato della sincronizzazione del database è NOT SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-196">However, database snapshots can be created when the database synchronization state is NOT SYNCHRONIZING.</span></span>  
  
     <span data-ttu-id="6ee4e-197">Per altre informazioni, vedere [Snapshot del database con gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-197">For more information, see [Database Snapshots with AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="6ee4e-198">Per creare uno snapshot del database in un database mirror, è necessario che il database si trovi nello stato di mirroring SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-198">To create a database snapshot on a mirror database, the database must be in the SYNCHRONIZED mirroring state.</span></span>  
  
-   <span data-ttu-id="6ee4e-199">Non è possibile configurare il database di origine come un database condiviso scalabile.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-199">The source database cannot be configured as a scalable shared database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6ee4e-200">Tutti i modelli di recupero supportano gli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-200">All recovery models support database snapshots.</span></span>  
  
###  <a name="limitations-on-the-source-database"></a><a name="LimitsOnSourceDb"></a> <span data-ttu-id="6ee4e-201">Limitazioni del database di origine</span><span class="sxs-lookup"><span data-stu-id="6ee4e-201">Limitations on the Source Database</span></span>  
 <span data-ttu-id="6ee4e-202">In presenza di snapshot del database, al database di origine dello snapshot si applicano le limitazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ee4e-202">As long as a database snapshot exists, the following limitations exist on the snapshot's source database:</span></span>  
  
-   <span data-ttu-id="6ee4e-203">Non è possibile eliminare, scollegare o ripristinare il database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-203">The database cannot be dropped, detached, or restored.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ee4e-204">Il backup del database di origine funziona normalmente e non viene influenzato dagli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-204">Backing up the source database works normally; it is unaffected by database snapshots.</span></span>  
  
-   <span data-ttu-id="6ee4e-205">Le prestazioni sono ridotte a causa del numero maggiore di operazioni I/O sul database di origine derivanti da un'operazione di copia in scrittura per lo snapshot eseguita a ogni aggiornamento di una pagina.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-205">Performance is reduced, due to increased I/O on the source database resulting from a copy-on-write operation to the snapshot every time a page is updated.</span></span>  
  
-   <span data-ttu-id="6ee4e-206">Non è possibile eliminare file dal database di origine o da uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-206">Files cannot be dropped from the source database or from any snapshots.</span></span>  
  
###  <a name="limitations-on-database-snapshots"></a><a name="LimitsOnDbSS"></a> <span data-ttu-id="6ee4e-207">Limitazioni degli snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-207">Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="6ee4e-208">Agli snapshot del database si applicano le limitazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ee4e-208">The following limitations apply to database snapshots:</span></span>  
  
-   <span data-ttu-id="6ee4e-209">È necessario creare e mantenere uno snapshot del database sulla stessa istanza del server in cui si trova il database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-209">A database snapshot must be created and remain on the same server instance as the source database.</span></span>  
  
-   <span data-ttu-id="6ee4e-210">Gli snapshot del database includono sempre un intero database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-210">Database snapshots always work on an entire database.</span></span>  
  
-   <span data-ttu-id="6ee4e-211">Gli snapshot del database dipendono dal database di origine e non fungono da archivi ridondanti.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-211">Database snapshots are dependent on the source database and are not redundant storage.</span></span> <span data-ttu-id="6ee4e-212">Non proteggono da errori del disco o da altri tipi di danno.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-212">They do not protect against disk errors or other types of corruption.</span></span> <span data-ttu-id="6ee4e-213">L'utilizzo di snapshot per il ripristino di un database, pertanto, non rappresenta una soluzione alternativa alla strategia di backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-213">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="6ee4e-214">L'esecuzione di tutti i backup pianificati rimane comunque essenziale.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-214">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="6ee4e-215">Se è necessario ripristinare il database di origine al punto nel tempo in cui è stato creato uno snapshot del database, implementare criteri di backup che consentano di eseguire tale operazione.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-215">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="6ee4e-216">Quando una pagina in fase di aggiornamento nel database di origine viene inserita in uno snapshot, se questo esaurisce lo spazio su disco oppure si verifica un altro errore, lo snapshot diventa sospetto e deve essere eliminato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-216">When a page getting updated on the source database is pushed to a snapshot, if the snapshot runs out of disk space or encounters some other error, the snapshot becomes suspect and must be deleted.</span></span>  
  
-   <span data-ttu-id="6ee4e-217">Gli snapshot sono di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-217">Snapshots are read-only.</span></span> <span data-ttu-id="6ee4e-218">Poiché sono di sola lettura, non possono essere aggiornati.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-218">Since they are read only, they cannot be upgraded.</span></span> <span data-ttu-id="6ee4e-219">Pertanto, dopo un aggiornamento gli snapshot di database non possono essere usati.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-219">Therefore, database snapshots are not expected to be viable after an upgrade.</span></span>  
  
-   <span data-ttu-id="6ee4e-220">Gli snapshot dei database **model**, **master**e **temp** non sono consentiti.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-220">Snapshots of the **model**, **master**, and **tempdb** databases are prohibited.</span></span>  
  
-   <span data-ttu-id="6ee4e-221">Non è possibile modificare le specifiche dei file degli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-221">You cannot change any of the specifications of the database snapshot files.</span></span>  
  
-   <span data-ttu-id="6ee4e-222">Non è possibile eliminare file da uno snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-222">You cannot drop files from a database snapshot.</span></span>  
  
-   <span data-ttu-id="6ee4e-223">Non è possibile eseguire il backup o il ripristino degli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-223">You cannot back up or restore database snapshots.</span></span>  
  
-   <span data-ttu-id="6ee4e-224">Non è possibile collegare o scollegare snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-224">You cannot attach or detach database snapshots.</span></span>  
  
-   <span data-ttu-id="6ee4e-225">Non è possibile creare snapshot del database con file system FAT32 o partizioni RAW.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-225">You cannot create database snapshots on FAT32 file system or RAW partitions.</span></span> <span data-ttu-id="6ee4e-226">I file sparse utilizzati dagli snapshot del database vengono forniti dal file system NTFS.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-226">The sparse files used by database snapshots are provided by the NTFS file system.</span></span>  
  
-   <span data-ttu-id="6ee4e-227">L'indicizzazione full-text non è supportata negli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-227">Full-text indexing is not supported on database snapshots.</span></span> <span data-ttu-id="6ee4e-228">I cataloghi full-text non vengono propagati dal database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-228">Full-text catalogs are not propagated from the source database.</span></span>  
  
-   <span data-ttu-id="6ee4e-229">Uno snapshot del database eredita i vincoli di sicurezza del proprio database di origine esistenti al momento della creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-229">A database snapshot inherits the security constraints of its source database at the time of snapshot creation.</span></span> <span data-ttu-id="6ee4e-230">Poiché gli snapshot sono di sola lettura, non è possibile modificare le autorizzazioni ereditate e le modifiche alle autorizzazioni effettuate sul database di origine non verranno riportate negli snapshot esistenti.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-230">Because snapshots are read-only, inherited permissions cannot be changed and permission changes made to the source will not be reflected in existing snapshots.</span></span>  
  
-   <span data-ttu-id="6ee4e-231">Uno snapshot riflette sempre lo stato dei filegroup al momento della sua creazione. I filegroup online e quelli offline non modificano il proprio stato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-231">A snapshot always reflects the state of filegroups at the time of snapshot creation: online filegroups remain online, and offline filegroups remain offline.</span></span> <span data-ttu-id="6ee4e-232">Per ulteriori informazioni, vedere la sezione dedicata agli snapshot del database con filegroup offline più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-232">For more information, see "Database Snapshots with Offline Filegroups" later in this topic.</span></span>  
  
-   <span data-ttu-id="6ee4e-233">Se un database di origine acquisisce lo stato di RECOVERY_PENDING, potrebbe non essere possibile accedere ai relativi snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-233">If a source database becomes RECOVERY_PENDING, its database snapshots may become inaccessible.</span></span> <span data-ttu-id="6ee4e-234">Dopo aver risolto il problema sul database di origine, tuttavia, i relativi snapshot dovrebbero ridiventare disponibili.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-234">After the issue on the source database is resolved, however, its snapshots should become available again.</span></span>  
  
-   <span data-ttu-id="6ee4e-235">Il ripristino non è supportato per i filegroup di sola lettura e per i filegroup compressi.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-235">Reverting is unsupported for read-only filegroups and for compressed filegroups.</span></span> <span data-ttu-id="6ee4e-236">Eventuali tentativi di ripristinare un database contenente filegroup di questo tipo determineranno un errore.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-236">Attempts to revert a database containing either of these types of filegroups fail.</span></span>  
  
-   <span data-ttu-id="6ee4e-237">In una configurazione per il log shipping, è possibile creare snapshot del database solo nel database primario.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-237">In a log shipping configuration, database snapshots can be created only on the primary database, not on a secondary database.</span></span> <span data-ttu-id="6ee4e-238">Se si cambiano i ruoli tra l'istanza del server primario e un'istanza del server secondario, è necessario eliminare tutti gli snapshot del database per poter impostare il database primario come database secondario.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-238">If you switch roles between the primary server instance and a secondary server instance, you must drop all the database snapshots before you can set the primary database up as a secondary database.</span></span>  
  
-   <span data-ttu-id="6ee4e-239">Non è possibile configurare uno snapshot del database come database condiviso scalabile.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-239">A database snapshot cannot be configured as a scalable shared database.</span></span>  
  
-   <span data-ttu-id="6ee4e-240">I filegroup FILESTREAM non sono supportati dagli snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-240">FILESTREAM filegroups are not supported by database snapshots.</span></span> <span data-ttu-id="6ee4e-241">Se in un database di origine sono presenti filegroup FILESTREAM, questi ultimi vengono contrassegnati come offline nei relativi snapshot del database e gli snapshot del database non possono essere utilizzati per ripristinare il database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-241">If FILESTREAM filegroups exist in a source database, they are marked as offline in its database snapshots, and the database snapshots cannot be used for reverting the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6ee4e-242">Un'istruzione SELECT eseguita in uno snapshot del database non deve specificare una colonna FILESTREAM. In caso contrario, verrà restituito il seguente messaggio di errore: `Could not continue scan with NOLOCK due to data movement.`</span><span class="sxs-lookup"><span data-stu-id="6ee4e-242">A SELECT statement that is executed on a database snapshot must not specify a FILESTREAM column; otherwise, the following error message will be returned: `Could not continue scan with NOLOCK due to data movement.`</span></span>  
  
-   <span data-ttu-id="6ee4e-243">Se le statistiche relative a uno snapshot di sola lettura mancano o non sono aggiornate, il [!INCLUDE[ssDE](../../includes/ssde-md.md)] crea e gestisce statistiche temporanee in tempdb.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-243">When statistics on a read-only snapshot are missing or stale, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] creates and maintains temporary statistics in tempdb.</span></span> <span data-ttu-id="6ee4e-244">Per altre informazioni, vedere l'articolo relativo alle [statistiche](../statistics/statistics.md).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-244">For more information, see [Statistics](../statistics/statistics.md).</span></span>  
  
###  <a name="disk-space-requirements"></a><a name="DiskSpace"></a> <span data-ttu-id="6ee4e-245">Requisiti relativi allo spazio su disco</span><span class="sxs-lookup"><span data-stu-id="6ee4e-245">Disk Space Requirements</span></span>  
 <span data-ttu-id="6ee4e-246">Gli snapshot del database richiedono spazio su disco.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-246">Database snapshots consume disk space.</span></span> <span data-ttu-id="6ee4e-247">Se uno snapshot del database esaurisce lo spazio su disco, viene contrassegnato come sospetto e deve essere eliminato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-247">If a database snapshot runs out of disk space, it is marked as suspect and must be dropped.</span></span> <span data-ttu-id="6ee4e-248">Il database di origine, tuttavia, non viene influenzato e continua a funzionare normalmente. Gli snapshot tuttavia utilizzano lo spazio su disco in maniera molto più efficiente rispetto a una copia completa di un database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-248">(The source database, however, is not affected; actions on it continue normally.) Compared to a full copy of a database, however, snapshots are highly space efficient.</span></span> <span data-ttu-id="6ee4e-249">Uno snapshot richiede esclusivamente lo spazio necessario per le pagine che vengono modificate durante la sua durata.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-249">A snapshot requires only enough storage for the pages that change during its lifetime.</span></span> <span data-ttu-id="6ee4e-250">Poiché in genere gli snapshot vengono conservati per periodi di tempo limitati, le loro dimensioni non rappresentano un problema.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-250">Generally, snapshots are kept for a limited time, so their size is not a major concern.</span></span>  
  
 <span data-ttu-id="6ee4e-251">Più a lungo viene conservato uno snapshot, più è probabile che utilizzi tutto lo spazio disponibile.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-251">The longer you keep a snapshot, however, the more likely it is to use up available space.</span></span> <span data-ttu-id="6ee4e-252">Le dimensioni massime cui un file sparse può arrivare sono quelle del file del database di origine corrispondente al momento della creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-252">The maximum size to which a sparse file can grow is the size of the corresponding source database file at the time of the snapshot creation.</span></span>  
  
 <span data-ttu-id="6ee4e-253">Se uno snapshot del database esaurisce lo spazio su disco, deve essere eliminato.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-253">If a database snapshot runs out of disk space, it must be deleted (dropped).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6ee4e-254">Tranne che per lo spazio del file, uno snapshot del database utilizza approssimativamente le stesse risorse di un database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-254">Except for file space, a database snapshot consumes roughly as many resources as a database.</span></span>  
  
###  <a name="database-snapshots-with-offline-filegroups"></a><a name="OfflineFGs"></a> <span data-ttu-id="6ee4e-255">Snapshot del database con filegroup offline</span><span class="sxs-lookup"><span data-stu-id="6ee4e-255">Database Snapshots with Offline Filegroups</span></span>  
 <span data-ttu-id="6ee4e-256">I filegroup offline nel database di origine influenzano gli snapshot del database quando si tenta di eseguire una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6ee4e-256">Offline filegroups in the source database affect database snapshots when you try to do any of the following:</span></span>  
  
-   <span data-ttu-id="6ee4e-257">Creare uno snapshot</span><span class="sxs-lookup"><span data-stu-id="6ee4e-257">Create a snapshot</span></span>  
  
     <span data-ttu-id="6ee4e-258">Quando nel database di origine sono presenti uno o più filegroup offline, la creazione degli snapshot ha esito positivo con i filegroup offline.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-258">When a source database has one or more offline filegroups, snapshot creation succeeds with the filegroups offline.</span></span> <span data-ttu-id="6ee4e-259">Per i filegroup offline non vengono creati file sparse.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-259">Sparse files are not created for the offline filegroups.</span></span>  
  
-   <span data-ttu-id="6ee4e-260">Portare un filegroup offline</span><span class="sxs-lookup"><span data-stu-id="6ee4e-260">Take a filegroup offline</span></span>  
  
     <span data-ttu-id="6ee4e-261">È possibile portare un file offline nel database di origine.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-261">You can take a file offline in the source database.</span></span> <span data-ttu-id="6ee4e-262">Tuttavia, il filegroup rimane online negli snapshot del database se era tale alla creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-262">However, the filegroup remains online in database snapshots if it was online when the snapshot was created.</span></span> <span data-ttu-id="6ee4e-263">Se i dati per i quali viene eseguita una query sono stati modificati dal momento della creazione dello snapshot, la pagina di dati originale sarà accessibile nello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-263">If the queried data has changed since snapshot creation, the original data page will be accessible in the snapshot.</span></span> <span data-ttu-id="6ee4e-264">Tuttavia, è possibile che, per le query che utilizzano lo snapshot per l'accesso ai dati non modificati nel filegroup, si verifichino errori di input/output (I/O).</span><span class="sxs-lookup"><span data-stu-id="6ee4e-264">However, queries that use the snapshot to access unmodified data in the filegroup are likely to fail with input/output (I/O) errors.</span></span>  
  
-   <span data-ttu-id="6ee4e-265">Portare un filegroup online</span><span class="sxs-lookup"><span data-stu-id="6ee4e-265">Bring a filegroup online</span></span>  
  
     <span data-ttu-id="6ee4e-266">Non è possibile portare un filegroup online in un database che presenti snapshot del database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-266">You cannot bring a filegroup online in a database that has any database snapshots.</span></span> <span data-ttu-id="6ee4e-267">Se un filegroup è offline al momento della creazione dello snapshot o viene portato offline in presenza di uno snapshot del database, il filegroup rimane offline.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-267">If a filegroup is offline at the time of snapshot creation or is taken offline while a database snapshot exists, the filegroup remains offline.</span></span> <span data-ttu-id="6ee4e-268">Per riportare un file online è infatti necessario ripristinarlo, operazione impossibile se è presente uno snapshot nel database.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-268">This is because bringing a file back online involves restoring it, which is not possible if a database snapshot exists on the database.</span></span>  
  
-   <span data-ttu-id="6ee4e-269">Ripristinare lo snapshot come database di origine</span><span class="sxs-lookup"><span data-stu-id="6ee4e-269">Revert the source database to the snapshot</span></span>  
  
     <span data-ttu-id="6ee4e-270">Il ripristino di uno snapshot del database come database di origine richiede che tutti i filegroup siano online, fatta eccezione per quelli offline al momento della creazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="6ee4e-270">Reverting a source database to a database snapshot requires that all of the filegroups are online except for filegroups that were offline when the snapshot was created.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="6ee4e-271">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="6ee4e-271">Related Tasks</span></span>  
  
-   [<span data-ttu-id="6ee4e-272">Creare uno snapshot del database &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6ee4e-272">Create a Database Snapshot &#40;Transact-SQL&#41;</span></span>](create-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="6ee4e-273">Visualizzazione di uno snapshot del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="6ee4e-273">View a Database Snapshot &#40;SQL Server&#41;</span></span>](view-a-database-snapshot-sql-server.md)  
  
-   [<span data-ttu-id="6ee4e-274">Visualizzare le dimensioni del file sparse di uno snapshot del database &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6ee4e-274">View the Size of the Sparse File of a Database Snapshot &#40;Transact-SQL&#41;</span></span>](view-the-size-of-the-sparse-file-of-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="6ee4e-275">Ripristinare un database a uno snapshot del database</span><span class="sxs-lookup"><span data-stu-id="6ee4e-275">Revert a Database to a Database Snapshot</span></span>](revert-a-database-to-a-database-snapshot.md)  
  
-   [<span data-ttu-id="6ee4e-276">Eliminare uno snapshot del database &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="6ee4e-276">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="6ee4e-277">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6ee4e-277">See Also</span></span>  
 [<span data-ttu-id="6ee4e-278">Mirroring e snapshot del database &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="6ee4e-278">Database Mirroring and Database Snapshots &#40;SQL Server&#41;</span></span>](database-snapshots-sql-server.md)  
  
  
