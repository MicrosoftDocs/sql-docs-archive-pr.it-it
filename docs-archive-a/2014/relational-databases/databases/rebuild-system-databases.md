---
title: Ricompilare database di sistema | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- master database [SQL Server], rebuilding
- REBUILDDATABASE parameter
- rebuilding databases, master
- system databases [SQL Server], rebuilding
ms.assetid: af457ecd-523e-4809-9652-bdf2e81bd876
author: stevestein
ms.author: sstein
ms.openlocfilehash: 5f695589fa0fc1b86d4433d36afa1bc6357aabd6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87627802"
---
# <a name="rebuild-system-databases"></a><span data-ttu-id="cb529-102">Ricompilare database di sistema</span><span class="sxs-lookup"><span data-stu-id="cb529-102">Rebuild System Databases</span></span>
  <span data-ttu-id="cb529-103">Il processo di ricompilazione deve essere eseguito per correggere problemi di danneggiamento nei database di sistema [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md)e [resource](resource-database.md) oppure per modificare le regole di confronto predefinite a livello di server.</span><span class="sxs-lookup"><span data-stu-id="cb529-103">System databases must be rebuilt to fix corruption problems in the [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md), or [resource](resource-database.md) system databases or to modify the default server-level collation.</span></span> <span data-ttu-id="cb529-104">In questo argomento sono incluse istruzioni dettagliate per la ricompilazione di database di sistema in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cb529-104">This topic provides step-by-step instructions to rebuild system databases in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="cb529-105">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="cb529-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="cb529-106">**Prima di iniziare:**</span><span class="sxs-lookup"><span data-stu-id="cb529-106">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="cb529-107">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="cb529-107">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="cb529-108">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="cb529-108">Prerequisites</span></span>](#Prerequisites)  
  
-   <span data-ttu-id="cb529-109">**Procedure:**</span><span class="sxs-lookup"><span data-stu-id="cb529-109">**Procedures:**</span></span>  
  
     [<span data-ttu-id="cb529-110">Ricompilare database di sistema</span><span class="sxs-lookup"><span data-stu-id="cb529-110">Rebuild System Databases</span></span>](#RebuildProcedure)  
  
     [<span data-ttu-id="cb529-111">Ricompilare il database resource</span><span class="sxs-lookup"><span data-stu-id="cb529-111">Rebuild the resource Database</span></span>](#Resource)  
  
     [<span data-ttu-id="cb529-112">Creare un nuovo database msdb</span><span class="sxs-lookup"><span data-stu-id="cb529-112">Create a New msdb Database</span></span>](#CreateMSDB)  
  
-   <span data-ttu-id="cb529-113">**Completamento:**</span><span class="sxs-lookup"><span data-stu-id="cb529-113">**Follow Up:**</span></span>  
  
     [<span data-ttu-id="cb529-114">Risolvere gli errori di ricompilazione</span><span class="sxs-lookup"><span data-stu-id="cb529-114">Troubleshoot Rebuild Errors</span></span>](#Troubleshoot)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="cb529-115">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="cb529-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="cb529-116">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="cb529-116">Limitations and Restrictions</span></span>  
 <span data-ttu-id="cb529-117">Quando vengono ricompilati, i database di sistema master, model, msdb e tempdb vengono eliminati e ricreati nel percorso originale.</span><span class="sxs-lookup"><span data-stu-id="cb529-117">When the master, model, msdb, and tempdb system databases are rebuilt, the databases are dropped and re-created in their original location.</span></span> <span data-ttu-id="cb529-118">Se nell'istruzione di ricompilazione vengono specificate nuove regole di confronto, i database di sistema vengono creati utilizzando tale impostazione delle regole di confronto.</span><span class="sxs-lookup"><span data-stu-id="cb529-118">If a new collation is specified in the rebuild statement, the system databases are created using that collation setting.</span></span> <span data-ttu-id="cb529-119">Le eventuali modifiche apportate dall'utente ai database vanno perdute.</span><span class="sxs-lookup"><span data-stu-id="cb529-119">Any user modifications to these databases are lost.</span></span> <span data-ttu-id="cb529-120">Ad esempio, è possibile che siano presenti oggetti definiti dall'utente nel database master, processi pianificati nel database msdb o modifiche alle impostazioni predefinite nel database modello.</span><span class="sxs-lookup"><span data-stu-id="cb529-120">For example, you may have user-defined objects in the master database, scheduled jobs in msdb, or changes to the default database settings in the model database.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="cb529-121">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="cb529-121">Prerequisites</span></span>  
 <span data-ttu-id="cb529-122">Prima di ricompilare i database di sistema, effettuare le attività seguenti per assicurarsi che sia possibile ripristinare le impostazioni correnti dei database.</span><span class="sxs-lookup"><span data-stu-id="cb529-122">Perform the following tasks before you rebuild the system databases to ensure that you can restore the system databases to their current settings.</span></span>  
  
1.  <span data-ttu-id="cb529-123">Registrare tutti i valori di configurazione a livello di server.</span><span class="sxs-lookup"><span data-stu-id="cb529-123">Record all server-wide configuration values.</span></span>  
  
    ```  
    SELECT * FROM sys.configurations;  
    ```  
  
2.  <span data-ttu-id="cb529-124">Registrare tutti i Service Pack e gli hotfix applicati all'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e le regole di confronto correnti.</span><span class="sxs-lookup"><span data-stu-id="cb529-124">Record all service packs and hotfixes applied to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current collation.</span></span> <span data-ttu-id="cb529-125">È necessario riapplicare questi aggiornamenti dopo la ricompilazione dei database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-125">You must reapply these updates after rebuilding the system databases.</span></span>  
  
    ```  
    SELECT  
    SERVERPROPERTY('ProductVersion ') AS ProductVersion,  
    SERVERPROPERTY('ProductLevel') AS ProductLevel,  
    SERVERPROPERTY('ResourceVersion') AS ResourceVersion,  
    SERVERPROPERTY('ResourceLastUpdateDateTime') AS ResourceLastUpdateDateTime,  
    SERVERPROPERTY('Collation') AS Collation;  
    ```  
  
3.  <span data-ttu-id="cb529-126">Registrare il percorso corrente di tutti i file di dati e di log relativi ai database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-126">Record the current location of all data and log files for the system databases.</span></span> <span data-ttu-id="cb529-127">Dopo la ricompilazione, tutti i database di sistema vengono installati nel percorso originale.</span><span class="sxs-lookup"><span data-stu-id="cb529-127">Rebuilding the system databases installs all system databases to their original location.</span></span> <span data-ttu-id="cb529-128">Se i file di dati o di log dei database di sistema sono stati spostati in un percorso diverso, è necessario spostarli di nuovo.</span><span class="sxs-lookup"><span data-stu-id="cb529-128">If you have moved system database data or log files to a different location, you must move the files again.</span></span>  
  
    ```  
    SELECT name, physical_name AS current_file_location  
    FROM sys.master_files  
    WHERE database_id IN (DB_ID('master'), DB_ID('model'), DB_ID('msdb'), DB_ID('tempdb'));  
    ```  
  
4.  <span data-ttu-id="cb529-129">Individuare il backup corrente dei database master, modello e msdb.</span><span class="sxs-lookup"><span data-stu-id="cb529-129">Locate the current backup of the master, model, and msdb databases.</span></span>  
  
5.  <span data-ttu-id="cb529-130">Se l'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è configurata come server di distribuzione repliche, individuare il backup corrente del database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="cb529-130">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, locate the current backup of the distribution database.</span></span>  
  
6.  <span data-ttu-id="cb529-131">Assicurarsi di disporre delle autorizzazioni appropriate per ricompilare i database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-131">Ensure you have appropriate permissions to rebuild the system databases.</span></span> <span data-ttu-id="cb529-132">Per eseguire questa operazione, è necessario essere membro del ruolo predefinito del server `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="cb529-132">To perform this operation, you must be a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="cb529-133">Per altre informazioni, vedere [Ruoli a livello di server](../security/authentication-access/server-level-roles.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-133">For more information, see [Server-Level Roles](../security/authentication-access/server-level-roles.md).</span></span>  
  
7.  <span data-ttu-id="cb529-134">Verificare che le copie dei file modello di log e dati dei database master, modello e msdb esistano nel server locale.</span><span class="sxs-lookup"><span data-stu-id="cb529-134">Verify that copies of the master, model, msdb data and log template files exist on the local server.</span></span> <span data-ttu-id="cb529-135">Il percorso predefinito per i file modello è C:\Programmi\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="cb529-135">The default location for the template files is C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span></span> <span data-ttu-id="cb529-136">Questi file vengono utilizzati durante il processo di ricompilazione e devono essere presenti affinché l'installazione venga completata correttamente.</span><span class="sxs-lookup"><span data-stu-id="cb529-136">These files are used during the rebuild process and must be present for Setup to succeed.</span></span> <span data-ttu-id="cb529-137">Se non sono disponibili, eseguire la caratteristica Ripristina del programma di installazione oppure copiarli manualmente dal supporto di installazione.</span><span class="sxs-lookup"><span data-stu-id="cb529-137">If they are missing, run the Repair feature of Setup, or manually copy the files from your installation media.</span></span> <span data-ttu-id="cb529-138">Per individuare i file nel supporto di installazione, passare alla directory della piattaforma appropriata (x86 o x64), quindi a setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="cb529-138">To locate the files on the installation media, navigate to the appropriate platform directory (x86 or x64) and then navigate to setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span></span>  
  
##  <a name="rebuild-system-databases"></a><a name="RebuildProcedure"></a> <span data-ttu-id="cb529-139">Ricompilare database di sistema</span><span class="sxs-lookup"><span data-stu-id="cb529-139">Rebuild System Databases</span></span>  
 <span data-ttu-id="cb529-140">La procedura seguente consente di ricompilare i database di sistema master, modello, msdb e tempdb.</span><span class="sxs-lookup"><span data-stu-id="cb529-140">The following procedure rebuilds the master, model, msdb, and tempdb system databases.</span></span> <span data-ttu-id="cb529-141">Non è possibile specificare i database di sistema da ricompilare.</span><span class="sxs-lookup"><span data-stu-id="cb529-141">You cannot specify the system databases to be rebuilt.</span></span> <span data-ttu-id="cb529-142">Per le istanze cluster, questa procedura deve essere eseguita nel nodo attivo e la risorsa di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nel gruppo di applicazioni cluster corrispondente deve essere portata offline prima di eseguire la procedura.</span><span class="sxs-lookup"><span data-stu-id="cb529-142">For clustered instances, this procedure must be performed on the active node and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] resource in the corresponding cluster application group must be taken offline before performing the procedure.</span></span>  
  
 <span data-ttu-id="cb529-143">Con questa procedura non viene ricompilato il database delle risorse (resource).</span><span class="sxs-lookup"><span data-stu-id="cb529-143">This procedure does not rebuild the resource database.</span></span> <span data-ttu-id="cb529-144">Vedere la sezione "Procedura per la ricompilazione del database resource" più avanti in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="cb529-144">See the section, "Rebuild the resource Database Procedure" later in this topic.</span></span>  
  
#### <a name="to-rebuild-system-databases-for-an-instance-of-sql-server"></a><span data-ttu-id="cb529-145">Per ricompilare i database di sistema per un'istanza di SQL Server:</span><span class="sxs-lookup"><span data-stu-id="cb529-145">To rebuild system databases for an instance of SQL Server:</span></span>  
  
1.  <span data-ttu-id="cb529-146">Inserire il supporto di installazione di [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] nell'unità disco oppure dal prompt dei comandi passare alla directory in cui si trova il file setup.exe nel server locale.</span><span class="sxs-lookup"><span data-stu-id="cb529-146">Insert the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] installation media into the disk drive, or, from a command prompt, change directories to the location of the setup.exe file on the local server.</span></span> <span data-ttu-id="cb529-147">Il percorso predefinito sul server è C:\Programmi\Microsoft SQL Server\120\Setup Bootstrap\Release.</span><span class="sxs-lookup"><span data-stu-id="cb529-147">The default location on the server is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Release.</span></span>  
  
2.  <span data-ttu-id="cb529-148">Da una finestra del prompt dei comandi immettere il comando seguente.</span><span class="sxs-lookup"><span data-stu-id="cb529-148">From a command prompt window, enter the following command.</span></span> <span data-ttu-id="cb529-149">Le parentesi quadre indicano i parametri facoltativi</span><span class="sxs-lookup"><span data-stu-id="cb529-149">Square brackets are used to indicate optional parameters.</span></span> <span data-ttu-id="cb529-150">e non devono essere digitate.</span><span class="sxs-lookup"><span data-stu-id="cb529-150">Do not enter the brackets.</span></span> <span data-ttu-id="cb529-151">Se si utilizza un sistema operativo Windows con Controllo account utente abilitato, per eseguire il programma di installazione è necessario disporre di privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="cb529-151">When using a Windows operating system that has User Account Control (UAC) enabled, running Setup requires elevated privileges.</span></span> <span data-ttu-id="cb529-152">Il prompt dei comandi deve essere eseguito come Amministratore.</span><span class="sxs-lookup"><span data-stu-id="cb529-152">The command prompt must be run as Administrator.</span></span>  
  
     `Setup /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=InstanceName /SQLSYSADMINACCOUNTS=accounts [ /SAPWD= StrongPassword ] [ /SQLCOLLATION=CollationName]`  
  
    |<span data-ttu-id="cb529-153">Nome parametro</span><span class="sxs-lookup"><span data-stu-id="cb529-153">Parameter name</span></span>|<span data-ttu-id="cb529-154">Descrizione</span><span class="sxs-lookup"><span data-stu-id="cb529-154">Description</span></span>|  
    |--------------------|-----------------|  
    |<span data-ttu-id="cb529-155">/QUIET o /Q</span><span class="sxs-lookup"><span data-stu-id="cb529-155">/QUIET or /Q</span></span>|<span data-ttu-id="cb529-156">Specifica che il programma di installazione verrà eseguito senza alcuna interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="cb529-156">Specifies that Setup run without any user interface.</span></span>|  
    |<span data-ttu-id="cb529-157">/ACTION=REBUILDDATABASE</span><span class="sxs-lookup"><span data-stu-id="cb529-157">/ACTION=REBUILDDATABASE</span></span>|<span data-ttu-id="cb529-158">Specifica che il programma di installazione dovrà ricreare i database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-158">Specifies that Setup re-create the system databases.</span></span>|  
    |<span data-ttu-id="cb529-159">/INSTANCENAME=*InstanceName*</span><span class="sxs-lookup"><span data-stu-id="cb529-159">/INSTANCENAME=*InstanceName*</span></span>|<span data-ttu-id="cb529-160">Nome dell'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cb529-160">Is the name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cb529-161">Per l'istanza predefinita, immettere MSSQLSERVER.</span><span class="sxs-lookup"><span data-stu-id="cb529-161">For the default instance, enter MSSQLSERVER.</span></span>|  
    |<span data-ttu-id="cb529-162">/SQLSYSADMINACCOUNTS=*accounts*</span><span class="sxs-lookup"><span data-stu-id="cb529-162">/SQLSYSADMINACCOUNTS=*accounts*</span></span>|<span data-ttu-id="cb529-163">Specifica i gruppi o i singoli account di Windows da aggiungere al ruolo predefinito del server `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="cb529-163">Specifies the Windows groups or individual accounts to add to the `sysadmin` fixed server role.</span></span> <span data-ttu-id="cb529-164">Se si specificano più account, separarli con uno spazio.</span><span class="sxs-lookup"><span data-stu-id="cb529-164">When specifying more than one account, separate the accounts with a blank space.</span></span> <span data-ttu-id="cb529-165">Ad esempio, immettere **BUILTIN\Administrators MyDomain\MyUser**.</span><span class="sxs-lookup"><span data-stu-id="cb529-165">For example, enter **BUILTIN\Administrators MyDomain\MyUser**.</span></span> <span data-ttu-id="cb529-166">Quando si specifica un account che contiene uno spazio vuoto all'interno del nome dell'account, racchiudere l'account tra doppie virgolette.</span><span class="sxs-lookup"><span data-stu-id="cb529-166">When you are specifying an account that contains a blank space within the account name, enclose the account in double quotation marks.</span></span> <span data-ttu-id="cb529-167">Immettere ad esempio `NT AUTHORITY\SYSTEM`.</span><span class="sxs-lookup"><span data-stu-id="cb529-167">For example, enter `NT AUTHORITY\SYSTEM`.</span></span>|  
    |<span data-ttu-id="cb529-168">[ /SAPWD=*StrongPassword* ]</span><span class="sxs-lookup"><span data-stu-id="cb529-168">[ /SAPWD=*StrongPassword* ]</span></span>|<span data-ttu-id="cb529-169">Specifica la password per l' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` account.</span><span class="sxs-lookup"><span data-stu-id="cb529-169">Specifies the password for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` account.</span></span> <span data-ttu-id="cb529-170">Questo parametro è necessario se l'istanza usa la modalità autenticazione mista (autenticazione di[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e di Windows).</span><span class="sxs-lookup"><span data-stu-id="cb529-170">This parameter is required if the instance uses Mixed Authentication ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and Windows Authentication) mode.</span></span><br /><br /> <span data-ttu-id="cb529-171">Nota sulla sicurezza l'account è \*\* \* un account noto ed \* è spesso indirizzato da utenti malintenzionati. \* \* \*\* `sa` [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="cb529-171">**\*\* Security Note \*\*** The `sa` account is a well-known [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] account and it is often targeted by malicious users.</span></span> <span data-ttu-id="cb529-172">È estremamente importante utilizzare una password complessa per l'accesso all'account `sa`.</span><span class="sxs-lookup"><span data-stu-id="cb529-172">It is very important that you use a strong password for the `sa` login.</span></span><br /><br /> <span data-ttu-id="cb529-173">Non specificare questo parametro per la modalità di autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="cb529-173">Do not specify this parameter for Windows Authentication mode.</span></span>|  
    |<span data-ttu-id="cb529-174">[ /SQLCOLLATION=*CollationName* ]</span><span class="sxs-lookup"><span data-stu-id="cb529-174">[ /SQLCOLLATION=*CollationName* ]</span></span>|<span data-ttu-id="cb529-175">Vengono specificate nuove regole di confronto a livello di server.</span><span class="sxs-lookup"><span data-stu-id="cb529-175">Specifies a new server-level collation.</span></span> <span data-ttu-id="cb529-176">Questo parametro è facoltativo e,</span><span class="sxs-lookup"><span data-stu-id="cb529-176">This parameter is optional.</span></span> <span data-ttu-id="cb529-177">Se non viene specificato, verranno utilizzate le regole di confronto correnti del server.</span><span class="sxs-lookup"><span data-stu-id="cb529-177">When not specified, the current collation of the server is used.</span></span><br /><br /> <span data-ttu-id="cb529-178">**\*\* Importante \*\*** La modifica delle regole di confronto a livello di server non comporta la modifica delle regole di confronto dei database utente esistenti.</span><span class="sxs-lookup"><span data-stu-id="cb529-178">**\*\* Important \*\*** Changing the server-level collation does not change the collation of existing user databases.</span></span> <span data-ttu-id="cb529-179">Tutti i nuovi database utente creati utilizzeranno le nuove regole di confronto per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="cb529-179">All newly created user databases will use the new collation by default.</span></span><br /><br /> <span data-ttu-id="cb529-180">Per altre informazioni, vedere [Impostare o modificare le regole di confronto del server](../collations/set-or-change-the-server-collation.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-180">For more information, see [Set or Change the Server Collation](../collations/set-or-change-the-server-collation.md).</span></span>|  
  
3.  <span data-ttu-id="cb529-181">Al termine della ricompilazione dei database di sistema, verrà visualizzato di nuovo il prompt dei comandi senza messaggi.</span><span class="sxs-lookup"><span data-stu-id="cb529-181">When Setup has completed rebuilding the system databases, it returns to the command prompt with no messages.</span></span> <span data-ttu-id="cb529-182">Esaminare il file di log Summary.txt per verificare che il processo sia stato completato correttamente.</span><span class="sxs-lookup"><span data-stu-id="cb529-182">Examine the Summary.txt log file to verify that the process completed successfully.</span></span> <span data-ttu-id="cb529-183">Il percorso di questo file è C:\Programmi\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="cb529-183">This file is located at C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span>  
  
## <a name="post-rebuild-tasks"></a><span data-ttu-id="cb529-184">Attività successive alla ricompilazione</span><span class="sxs-lookup"><span data-stu-id="cb529-184">Post-Rebuild Tasks</span></span>  
 <span data-ttu-id="cb529-185">Al termine della ricompilazione del database, potrebbe essere necessario effettuare le attività aggiuntive seguenti:</span><span class="sxs-lookup"><span data-stu-id="cb529-185">After rebuilding the database you may need to perform the following additional tasks:</span></span>  
  
-   <span data-ttu-id="cb529-186">Ripristinare i backup completi più recenti dei database master, modello e msdb.</span><span class="sxs-lookup"><span data-stu-id="cb529-186">Restore your most recent full backups of the master, model, and msdb databases.</span></span> <span data-ttu-id="cb529-187">Per altre informazioni, vedere [Backup e ripristino di Database di sistema &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-187">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="cb529-188">Se sono state modificate le regole di confronto del server, non ripristinare i database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-188">If you have changed the server collation, do not restore the system databases.</span></span> <span data-ttu-id="cb529-189">In caso contrario, le nuove regole di confronto verranno sostituite con quelle precedenti.</span><span class="sxs-lookup"><span data-stu-id="cb529-189">Doing so will replace the new collation with the previous collation setting.</span></span>  
  
     <span data-ttu-id="cb529-190">Se non è disponibile alcun backup oppure se il backup ripristinato non è aggiornato, ricreare le eventuali voci mancanti.</span><span class="sxs-lookup"><span data-stu-id="cb529-190">If a backup is not available or if the restored backup is not current, re-create any missing entries.</span></span> <span data-ttu-id="cb529-191">Ad esempio, ricreare tutte le voci mancanti per i database utente, i dispositivi di backup, gli account di accesso di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , gli endpoint e così via.</span><span class="sxs-lookup"><span data-stu-id="cb529-191">For example, re-create all missing entries for your user databases, backup devices, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logins, end points, and so on.</span></span> <span data-ttu-id="cb529-192">Il modo più efficace per ricreare le voci consiste nell'eseguire gli script originali con cui sono state create.</span><span class="sxs-lookup"><span data-stu-id="cb529-192">The best way to re-create entries is to run the original scripts that created them.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="cb529-193">È consigliabile proteggere gli script per impedire che il contenuto venga modificato da utenti non autorizzati.</span><span class="sxs-lookup"><span data-stu-id="cb529-193">We recommend that you secure your scripts to prevent their being altered by unauthorized by individuals.</span></span>  
  
-   <span data-ttu-id="cb529-194">Se l'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è configurata come server di distribuzione repliche, è necessario ripristinare il database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="cb529-194">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, you must restore the distribution database.</span></span> <span data-ttu-id="cb529-195">Per altre informazioni, vedere [Eseguire il backup e ripristino di database replicati](../replication/administration/back-up-and-restore-replicated-databases.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-195">For more information, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>  
  
-   <span data-ttu-id="cb529-196">Spostare i database di sistema nei percorsi registrati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="cb529-196">Move the system databases to the locations you recorded previously.</span></span> <span data-ttu-id="cb529-197">Per altre informazioni vedere l'articolo [Spostare i database di sistema](system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-197">For more information, see [Move System Databases](system-databases.md).</span></span>  
  
-   <span data-ttu-id="cb529-198">Verificare che i valori di configurazione a livello di server corrispondano ai valori registrati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="cb529-198">Verify the server-wide configuration values match the values you recorded previously.</span></span>  
  
##  <a name="rebuild-the-resource-database"></a><a name="Resource"></a> <span data-ttu-id="cb529-199">Ricompilare il database resource</span><span class="sxs-lookup"><span data-stu-id="cb529-199">Rebuild the resource Database</span></span>  
 <span data-ttu-id="cb529-200">Con la procedura seguente viene ricompilato il database di sistema delle risorse.</span><span class="sxs-lookup"><span data-stu-id="cb529-200">The following procedure rebuilds the resource system database.</span></span> <span data-ttu-id="cb529-201">Quando si ricompila il database delle risorse, tutti i Service Pack e gli hotfix vanno persi e devono pertanto essere riapplicati.</span><span class="sxs-lookup"><span data-stu-id="cb529-201">When you rebuild the resource database, all service packs and hot fixes are lost, and therefore must be reapplied.</span></span>  
  
#### <a name="to-rebuild-the-resource-system-database"></a><span data-ttu-id="cb529-202">Per ricompilare il database di sistema resource:</span><span class="sxs-lookup"><span data-stu-id="cb529-202">To rebuild the resource system database:</span></span>  
  
1.  <span data-ttu-id="cb529-203">Avviare il programma di installazione di [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (setup.exe) dal supporto di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="cb529-203">Launch the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup program (setup.exe) from the distribution media.</span></span>  
  
2.  <span data-ttu-id="cb529-204">Nell'area di navigazione sinistra fare clic su **Manutenzione**, quindi su **Ripristina**.</span><span class="sxs-lookup"><span data-stu-id="cb529-204">In the left navigation area, click **Maintenance**, and then click **Repair**.</span></span>  
  
3.  <span data-ttu-id="cb529-205">Verranno eseguite la regola di supporto dell'installazione e le routine dei file per garantire che nel sistema siano installati i prerequisiti e che il computer soddisfi le regole di convalida dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="cb529-205">Setup support rule and file routines run to ensure that your system has prerequisites installed and that the computer passes Setup validation rules.</span></span> <span data-ttu-id="cb529-206">Fare clic su **OK** o **Installa** per continuare.</span><span class="sxs-lookup"><span data-stu-id="cb529-206">Click **OK** or **Install** to continue.</span></span>  
  
4.  <span data-ttu-id="cb529-207">Nella pagina Seleziona istanza selezionare l'istanza da ripristinare, quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="cb529-207">On the Select Instance page, select the instance to repair, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="cb529-208">Verranno eseguite le regole di ripristino per convalidare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="cb529-208">The repair rules will run to validate the operation.</span></span> <span data-ttu-id="cb529-209">Scegliere **Avanti**per continuare.</span><span class="sxs-lookup"><span data-stu-id="cb529-209">To continue, click **Next**.</span></span>  
  
6.  <span data-ttu-id="cb529-210">Nella pagina **Ripristino** scegliere **Ripristina**.</span><span class="sxs-lookup"><span data-stu-id="cb529-210">From the **Ready to Repair** page, click **Repair**.</span></span> <span data-ttu-id="cb529-211">Nella pagina Operazione completata è indicato che l'operazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="cb529-211">The Complete page indicates that the operation is finished.</span></span>  
  
##  <a name="create-a-new-msdb-database"></a><a name="CreateMSDB"></a> <span data-ttu-id="cb529-212">Creare un nuovo database msdb</span><span class="sxs-lookup"><span data-stu-id="cb529-212">Create a New msdb Database</span></span>  
 <span data-ttu-id="cb529-213">Se il `msdb` database è danneggiato e non si dispone di un backup del `msdb` database, è possibile crearne uno nuovo `msdb` tramite lo script **lo instmsdb comporterà** .</span><span class="sxs-lookup"><span data-stu-id="cb529-213">If the `msdb` database is damaged and you do not have a backup of the `msdb` database, you can create a new `msdb` by using the **instmsdb** script.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="cb529-214">La ricompilazione del `msdb` database tramite lo script **lo instmsdb comporterà** eliminerà tutte le informazioni archiviate in `msdb` , ad esempio processi, avvisi, operatori, piani di manutenzione, cronologia di backup, impostazioni della gestione basata su criteri, posta elettronica database, prestazioni data warehouse e così via.</span><span class="sxs-lookup"><span data-stu-id="cb529-214">Rebuilding the `msdb` database using the **instmsdb** script will eliminate all the information stored in `msdb` such as jobs, alert, operators, maintenance plans, backup history, Policy-Based Management settings, Database Mail, Performance Data Warehouse, etc.</span></span>  
  
1.  <span data-ttu-id="cb529-215">Arrestare tutti i servizi che si connettono al [!INCLUDE[ssDE](../../includes/ssde-md.md)], tra cui [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)]e tutte le applicazioni in cui [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] viene utilizzato come archivio dati.</span><span class="sxs-lookup"><span data-stu-id="cb529-215">Stop all services connecting to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], including [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)], and all applications using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] as data store.</span></span>  
  
2.  <span data-ttu-id="cb529-216">Avviare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dalla riga di comando utilizzando il comando `NET START MSSQLSERVER /T3608`</span><span class="sxs-lookup"><span data-stu-id="cb529-216">Start [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the command line using the command: `NET START MSSQLSERVER /T3608`</span></span>  
  
     <span data-ttu-id="cb529-217">Per altre informazioni, vedere [Avviare, arrestare, sospendere, riprendere, riavviare i servizi SQL Server](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span><span class="sxs-lookup"><span data-stu-id="cb529-217">For more information, see [Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span></span>  
  
3.  <span data-ttu-id="cb529-218">In un'altra finestra della riga di comando scollegare il `msdb` database eseguendo il comando seguente, sostituendo *\<servername>* con l'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :`SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span><span class="sxs-lookup"><span data-stu-id="cb529-218">In another command line window, detach the `msdb` database by executing the following command, replacing *\<servername>* with the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]: `SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span></span>  
  
4.  <span data-ttu-id="cb529-219">Utilizzando Esplora risorse, rinominare i `msdb` file di database.</span><span class="sxs-lookup"><span data-stu-id="cb529-219">Using the Windows Explorer, rename the `msdb` database files.</span></span> <span data-ttu-id="cb529-220">Per impostazione predefinita, tali file si trovano nella sottocartella DATA per l'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cb529-220">By default these are in the DATA sub-folder for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
5.  <span data-ttu-id="cb529-221">Utilizzando Gestione configurazione [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , arrestare e riavviare normalmente il servizio [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cb529-221">Using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, stop and restart the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service normally.</span></span>  
  
6.  <span data-ttu-id="cb529-222">In una finestra della riga di comando connettersi a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ed eseguire il comando `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span><span class="sxs-lookup"><span data-stu-id="cb529-222">In a command line window, connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and execute the command: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span></span>  
  
     <span data-ttu-id="cb529-223">Sostituire *\<servername>* con l'istanza del [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cb529-223">Replace *\<servername>* with the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span> <span data-ttu-id="cb529-224">Utilizzare il percorso del file system dell'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cb529-224">Use the file system path of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
7.  <span data-ttu-id="cb529-225">Tramite Blocco note di Windows, aprire il file **instmsdb.out** e verificare la presenza di eventuali errori nell'output.</span><span class="sxs-lookup"><span data-stu-id="cb529-225">Using the Windows Notepad, open the **instmsdb.out** file and check the output for any errors.</span></span>  
  
8.  <span data-ttu-id="cb529-226">Applicare di nuovo qualsiasi Service Pack o hotfix installati nell'istanza.</span><span class="sxs-lookup"><span data-stu-id="cb529-226">Re-apply any service packs or hotfix installed on the instance.</span></span>  
  
9. <span data-ttu-id="cb529-227">Ricreare il contenuto dell'utente archiviato nel `msdb` database, ad esempio processi, avvisi e così via.</span><span class="sxs-lookup"><span data-stu-id="cb529-227">Recreate the user content stored in the `msdb` database, such as jobs, alert, etc.</span></span>  
  
10. <span data-ttu-id="cb529-228">Eseguire il backup del database di `msdb` .</span><span class="sxs-lookup"><span data-stu-id="cb529-228">Backup the `msdb` database.</span></span>  
  
##  <a name="troubleshoot-rebuild-errors"></a><a name="Troubleshoot"></a> <span data-ttu-id="cb529-229">Risolvere gli errori di ricompilazione</span><span class="sxs-lookup"><span data-stu-id="cb529-229">Troubleshoot Rebuild Errors</span></span>  
 <span data-ttu-id="cb529-230">Gli errori di sintassi e altri errori di runtime vengono visualizzati nella finestra del prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="cb529-230">Syntax and other run-time errors are displayed in the command prompt window.</span></span> <span data-ttu-id="cb529-231">Esaminare l'istruzione di installazione per rilevare gli errori di sintassi seguenti:</span><span class="sxs-lookup"><span data-stu-id="cb529-231">Examine the Setup statement for the following syntax errors:</span></span>  
  
-   <span data-ttu-id="cb529-232">Barra (/) mancante prima di ogni nome di parametro.</span><span class="sxs-lookup"><span data-stu-id="cb529-232">Missing slash mark (/) in front of each parameter name.</span></span>  
  
-   <span data-ttu-id="cb529-233">Segno di uguale (=) mancante tra il nome e il valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="cb529-233">Missing equal sign (=) between the parameter name and the parameter value.</span></span>  
  
-   <span data-ttu-id="cb529-234">Presenza di spazi tra il nome del parametro e il segno di uguale.</span><span class="sxs-lookup"><span data-stu-id="cb529-234">Presence of blank spaces between the parameter name and the equal sign.</span></span>  
  
-   <span data-ttu-id="cb529-235">Presenza di virgole (,) o di altri caratteri non specificati nella sintassi.</span><span class="sxs-lookup"><span data-stu-id="cb529-235">Presence of commas (,) or other characters that are not specified in the syntax.</span></span>  
  
 <span data-ttu-id="cb529-236">Al termine dell'operazione di ricompilazione, esaminare i log di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] per rilevare eventuali errori.</span><span class="sxs-lookup"><span data-stu-id="cb529-236">After the rebuild operation is complete, examine the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logs for any errors.</span></span> <span data-ttu-id="cb529-237">Il percorso predefinito dei log è C:\Programmi\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="cb529-237">The default log location is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span> <span data-ttu-id="cb529-238">Per individuare il file di log che contiene i risultati del processo di ricompilazione, passare alla cartella Logs dal prompt dei comandi, quindi eseguire `findstr /s RebuildDatabase summary*.*`.</span><span class="sxs-lookup"><span data-stu-id="cb529-238">To locate the log file that contains the results of the rebuild process, change directories to the Logs folder from a command prompt, and then run `findstr /s RebuildDatabase summary*.*`.</span></span> <span data-ttu-id="cb529-239">Con questa ricerca sarà possibile trovare tutti i file di log che contengono i risultati della ricompilazione dei database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-239">This search will point you to any log files that contain the results of rebuilding system databases.</span></span> <span data-ttu-id="cb529-240">Aprire i file di log ed esaminare i messaggi di errore pertinenti.</span><span class="sxs-lookup"><span data-stu-id="cb529-240">Open the log files and examine them for relevant error messages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cb529-241">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="cb529-241">See Also</span></span>  
 [<span data-ttu-id="cb529-242">Database di sistema.</span><span class="sxs-lookup"><span data-stu-id="cb529-242">System Databases</span></span>](system-databases.md)  
  
  
