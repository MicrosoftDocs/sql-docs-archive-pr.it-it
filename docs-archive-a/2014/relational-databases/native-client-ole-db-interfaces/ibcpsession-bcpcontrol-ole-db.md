---
title: IBCPSession::BCPControl (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPControl (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPControl method
ms.assetid: d58f3fe1-45e3-4e46-8e9c-000971829d99
author: rothja
ms.author: jroth
ms.openlocfilehash: a3de4d0a942d29f18752374b4020fbfd19aa15ec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87723775"
---
# <a name="ibcpsessionbcpcontrol-ole-db"></a><span data-ttu-id="630d4-102">IBCPSession::BCPControl (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="630d4-102">IBCPSession::BCPControl (OLE DB)</span></span>
  <span data-ttu-id="630d4-103">Imposta le opzioni per un'operazione di copia bulk.</span><span class="sxs-lookup"><span data-stu-id="630d4-103">Sets the options for a bulk-copy operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="630d4-104">Sintassi</span><span class="sxs-lookup"><span data-stu-id="630d4-104">Syntax</span></span>  
  
```  
  
HRESULT BCPControl(   
inteOption,  
void *iValue);  
```  
  
## <a name="remarks"></a><span data-ttu-id="630d4-105">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="630d4-105">Remarks</span></span>  
 <span data-ttu-id="630d4-106">Il metodo **BCPControl** imposta diversi parametri di controllo per le operazioni di copia bulk, inclusi il numero di errori consentiti prima di annullare una copia bulk, i numeri della prima e dell'ultima riga da copiare da un file di dati e le dimensioni batch.</span><span class="sxs-lookup"><span data-stu-id="630d4-106">The **BCPControl** method sets various control parameters for bulk-copy operations including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy from a data file, and the batch size.</span></span>  
  
 <span data-ttu-id="630d4-107">Questo metodo viene inoltre utilizzato per specificare l'istruzione SELECT da utilizzare durante la copia bulk di dati da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-107">This method is also used to specify the SELECT statement to use when bulk copying data out from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="630d4-108">È possibile impostare l' `eOption` argomento su BCP_OPTION_HINTS e l' `iValue` argomento in modo che disponga di un puntatore a una stringa di caratteri wide che contiene l'istruzione SELECT.</span><span class="sxs-lookup"><span data-stu-id="630d4-108">You can set the `eOption` argument to BCP_OPTION_HINTS and `iValue` argument to have a pointer to a wide character string containing the SELECT statement.</span></span>  
  
 <span data-ttu-id="630d4-109">I valori possibili per *eOption* sono:</span><span class="sxs-lookup"><span data-stu-id="630d4-109">Possible values for *eOption* are:</span></span>  
  
|<span data-ttu-id="630d4-110">Opzione</span><span class="sxs-lookup"><span data-stu-id="630d4-110">Option</span></span>|<span data-ttu-id="630d4-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="630d4-111">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="630d4-112">BCP_OPTION_ABORT</span><span class="sxs-lookup"><span data-stu-id="630d4-112">BCP_OPTION_ABORT</span></span>|<span data-ttu-id="630d4-113">Arresta un'operazione di copia bulk già in corso.</span><span class="sxs-lookup"><span data-stu-id="630d4-113">Stops a bulk-copy operation that is already in progress.</span></span> <span data-ttu-id="630d4-114">È possibile chiamare il metodo **BCPControl** con un argomento *eOption* di BCP_OPTION_ABORT da un altro thread per arrestare un'operazione di copia bulk in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="630d4-114">You can call the **BCPControl** method with an *eOption* argument of BCP_OPTION_ABORT from another thread to stop a running bulk-copy operation.</span></span> <span data-ttu-id="630d4-115">L'argomento *iValue* viene ignorato.</span><span class="sxs-lookup"><span data-stu-id="630d4-115">The *iValue* argument is ignored.</span></span>|  
|<span data-ttu-id="630d4-116">BCP_OPTION_BATCH</span><span class="sxs-lookup"><span data-stu-id="630d4-116">BCP_OPTION_BATCH</span></span>|<span data-ttu-id="630d4-117">Numero di righe per batch.</span><span class="sxs-lookup"><span data-stu-id="630d4-117">The number of rows per batch.</span></span> <span data-ttu-id="630d4-118">L'impostazione predefinita è 0 e indica tutte le righe di una tabella quando i dati vengono estratti oppure tutte le righe nel file di dati dell'utente quando i dati vengono copiati in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-118">The default is 0, which indicates all rows in a table when data is being extracted, or all rows in the user data file when data is being copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="630d4-119">Un valore minore di 1 consente di reimpostare BCP_OPTION_BATCH sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="630d4-119">A value less than 1 resets BCP_OPTION_BATCH to the default.</span></span>|  
|<span data-ttu-id="630d4-120">BCP_OPTION_DELAYREADFMT</span><span class="sxs-lookup"><span data-stu-id="630d4-120">BCP_OPTION_DELAYREADFMT</span></span>|<span data-ttu-id="630d4-121">Valore booleano che, se impostato su true, comporta la lettura da parte di [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) al momento dell'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="630d4-121">A Boolean, if set to true, will cause [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) to read at execution.</span></span> <span data-ttu-id="630d4-122">Se impostato su false (impostazione predefinita), il file di formato viene letto immediatamente da IBCPSession::BCPReadFmt.</span><span class="sxs-lookup"><span data-stu-id="630d4-122">If false (the default), IBCPSession::BCPReadFmt will immediately read the format file.</span></span> <span data-ttu-id="630d4-123">Si verificherà un errore di sequenza se `BCP_OPTION_DELAYREADFMT` è true e si chiama IBCPSession:: BCPColumns o IBCPSession:: BCPColFmt.</span><span class="sxs-lookup"><span data-stu-id="630d4-123">A sequence error will occur if `BCP_OPTION_DELAYREADFMT` is true and you call IBCPSession::BCPColumns or IBCPSession::BCPColFmt.</span></span><br /><br /> <span data-ttu-id="630d4-124">Un errore nella sequenza si verifica anche se si chiama `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` dopo `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` e IBCPSession::BCPWriteFmt.</span><span class="sxs-lookup"><span data-stu-id="630d4-124">A sequence error will also occur if you call `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` after calling `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` and IBCPSession::BCPWriteFmt.</span></span><br /><br /> <span data-ttu-id="630d4-125">Per altre informazioni, vedere [Metadata Discovery](../native-client/features/metadata-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="630d4-125">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>|  
|<span data-ttu-id="630d4-126">BCP_OPTION_FILECP</span><span class="sxs-lookup"><span data-stu-id="630d4-126">BCP_OPTION_FILECP</span></span>|<span data-ttu-id="630d4-127">L'argomento *iValue* contiene il numero della tabella codici per il file di dati.</span><span class="sxs-lookup"><span data-stu-id="630d4-127">The *iValue* argument contains the number of the code page for the data file.</span></span> <span data-ttu-id="630d4-128">È possibile specificare il numero della tabella codici, ad esempio 1252 o 850, o uno dei valori seguenti:</span><span class="sxs-lookup"><span data-stu-id="630d4-128">You can specify the number of the code page, such as 1252 or 850, or one of the following values:</span></span><br /><br /> <span data-ttu-id="630d4-129">-BCP_FILECP_ACP: i dati nel file si trova in Microsoft Windows?</span><span class="sxs-lookup"><span data-stu-id="630d4-129">-   BCP_FILECP_ACP: data in the file is in the Microsoft Windows??</span></span> <span data-ttu-id="630d4-130">tabella codici del client.</span><span class="sxs-lookup"><span data-stu-id="630d4-130">code page of the client.</span></span><br /><span data-ttu-id="630d4-131">-BCP_FILECP_OEMCP: i dati nel file si trova nella tabella codici OEM del client (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="630d4-131">-   BCP_FILECP_OEMCP: data in the file is in the OEM code page of the client (default).</span></span><br /><span data-ttu-id="630d4-132">-BCP_FILECP_RAW: i dati nel file si trova nella tabella codici di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="630d4-132">-   BCP_FILECP_RAW: data in the file is in the code page of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="630d4-133">BCP_OPTION_FILEFMT</span><span class="sxs-lookup"><span data-stu-id="630d4-133">BCP_OPTION_FILEFMT</span></span>|<span data-ttu-id="630d4-134">Numero di versione del formato del file di dati.</span><span class="sxs-lookup"><span data-stu-id="630d4-134">The version number of the data file format.</span></span> <span data-ttu-id="630d4-135">Il valore può essere 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] o [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]) o 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="630d4-135">This can be 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]), or 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="630d4-136">120 è il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="630d4-136">120 is the default.</span></span> <span data-ttu-id="630d4-137">Questo valore è utile per l'esportazione e l'importazione di dati in formati supportati da una versione precedente del server.</span><span class="sxs-lookup"><span data-stu-id="630d4-137">This is useful for exporting and importing data in formats that were supported by earlier version of the server.</span></span>  <span data-ttu-id="630d4-138">Per importare i dati ottenuti, ad esempio, da una colonna di testo di un server [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] in una colonna **varchar(max)** di un server [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] o versione successiva, è necessario specificare 80.</span><span class="sxs-lookup"><span data-stu-id="630d4-138">For example, to import data obtained from a text column in a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server into a **varchar(max)** column in a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later server, you should specify 80.</span></span> <span data-ttu-id="630d4-139">Analogamente, se si specifica 80 quando si esportano dati da una colonna **varchar(max)** , tali dati vengono salvati esattamente come vengono salvate le colonne di testo nel formato [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] e possono essere importati in una colonna di testo di un server [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-139">Similarly, if you specify 80 while exporting data from a **varchar(max)** column, it will be saved just like text columns are saved in the [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] format, and can be imported into a text column of a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server.</span></span>|  
|<span data-ttu-id="630d4-140">BCP_OPTION_FIRST</span><span class="sxs-lookup"><span data-stu-id="630d4-140">BCP_OPTION_FIRST</span></span>|<span data-ttu-id="630d4-141">Prima riga di dati del file o della tabella da copiare.</span><span class="sxs-lookup"><span data-stu-id="630d4-141">The first row of data of the file or table to copy.</span></span> <span data-ttu-id="630d4-142">Il valore predefinito è 1. Un valore minore di 1 reimposta l'opzione sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="630d4-142">The default is 1; a value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="630d4-143">BCP_OPTION_FIRSTEX</span><span class="sxs-lookup"><span data-stu-id="630d4-143">BCP_OPTION_FIRSTEX</span></span>|<span data-ttu-id="630d4-144">Per le operazioni BCP out, specifica la prima riga della tabella di database da copiare nel file di dati.</span><span class="sxs-lookup"><span data-stu-id="630d4-144">For BCP out operations, specifies the first row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="630d4-145">Per le operazioni BCP in, specifica la prima riga del file di dati da copiare nella tabella di database.</span><span class="sxs-lookup"><span data-stu-id="630d4-145">For BCP in operations, specifies the first row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="630d4-146">È previsto che il parametro *iValue* corrisponda all'indirizzo di un numero intero a 64 bit con segno contenente il valore.</span><span class="sxs-lookup"><span data-stu-id="630d4-146">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="630d4-147">Il valore massimo che è possibile passare a BCPFIRSTEX è 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="630d4-147">The maximum value that can be passed to BCPFIRSTEX 2^63-1.</span></span>|  
|<span data-ttu-id="630d4-148">BCP_OPTION_FMTXML</span><span class="sxs-lookup"><span data-stu-id="630d4-148">BCP_OPTION_FMTXML</span></span>|<span data-ttu-id="630d4-149">Specifica che il file di formato generato deve essere in formato XML.</span><span class="sxs-lookup"><span data-stu-id="630d4-149">Used to specify that the format file generated should be in an XML format.</span></span> <span data-ttu-id="630d4-150">L'opzione è disattivata per impostazione predefinita e per impostazione predefinita i file di formato vengono salvati come file di testo.</span><span class="sxs-lookup"><span data-stu-id="630d4-150">It is off by default and by default the format files are saved as text files.</span></span> <span data-ttu-id="630d4-151">I file di formato XML offrono una maggiore flessibilità ma comportano alcuni vincoli aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="630d4-151">The XML format file provides greater flexibility but with some added constraints.</span></span> <span data-ttu-id="630d4-152">Diversamente dai file nei formati precedenti, non è ad esempio possibile specificare contemporaneamente il prefisso e il carattere di terminazione per un campo.</span><span class="sxs-lookup"><span data-stu-id="630d4-152">For example, you can not specify the prefix and terminator for a field simultaneously which is possible in older format files.</span></span> <span data-ttu-id="630d4-153">**Nota:**  I file di formato XML sono supportati solo quando [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] gli strumenti di vengono installati insieme a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="630d4-153">**Note:**  XML format files are only supported when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tools are installed along with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="630d4-154">BCP_OPTION_HINTS</span><span class="sxs-lookup"><span data-stu-id="630d4-154">BCP_OPTION_HINTS</span></span>|<span data-ttu-id="630d4-155">L'argomento *iValue* contiene un puntatore alla stringa di caratteri wide.</span><span class="sxs-lookup"><span data-stu-id="630d4-155">The *iValue* argument contains a wide character string pointer.</span></span> <span data-ttu-id="630d4-156">La stringa a cui viene fatto riferimento specifica hint di elaborazione della copia bulk [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] o un'istruzione [!INCLUDE[tsql](../../includes/tsql-md.md)] che restituisce un set di risultati.</span><span class="sxs-lookup"><span data-stu-id="630d4-156">The string addressed specifies either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-copy processing hints or a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns a result set.</span></span> <span data-ttu-id="630d4-157">Se viene specificata un'istruzione [!INCLUDE[tsql](../../includes/tsql-md.md)] che restituisce più set di risultati, vengono ignorati tutti i set di risultati successivi al primo.</span><span class="sxs-lookup"><span data-stu-id="630d4-157">If a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement is specified that returns more than one result set, all result sets after the first are ignored.</span></span>|  
|<span data-ttu-id="630d4-158">BCP_OPTION_KEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="630d4-158">BCP_OPTION_KEEPIDENTITY</span></span>|<span data-ttu-id="630d4-159">Quando l'argomento *iValue* è impostato su TRUE, questa opzione specifica che i metodi di copia bulk inseriscono i valori di dati specificati per le colonne di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] definite con un vincolo di identità.</span><span class="sxs-lookup"><span data-stu-id="630d4-159">When the *iValue* argument is set to TRUE, this option specifies that the bulk copy methods insert data values supplied for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] columns defined with an identity constraint.</span></span> <span data-ttu-id="630d4-160">Il file di input deve fornire valori per le colonne di identità.</span><span class="sxs-lookup"><span data-stu-id="630d4-160">The input file must supply values for the identity columns.</span></span> <span data-ttu-id="630d4-161">Se questa impostazione non è disponibile, per le righe inserite vengono generati nuovi valori Identity.</span><span class="sxs-lookup"><span data-stu-id="630d4-161">If this is not set, new identity values are generated for the inserted rows.</span></span> <span data-ttu-id="630d4-162">Eventuali dati presenti nel file per le colonne di identità vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="630d4-162">Any data present in the file for the identity columns is ignored.</span></span>|  
|<span data-ttu-id="630d4-163">BCP_OPTION_KEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="630d4-163">BCP_OPTION_KEEPNULLS</span></span>|<span data-ttu-id="630d4-164">Specifica se i valori di dati vuoti nel file verranno convertiti in valori NULL nella tabella di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-164">Specifies whether empty data values in the file will be converted to NULL values in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="630d4-165">Quando l'argomento *iValue* è impostato su TRUE, i valori vuoti vengono convertiti in valori NULL nella tabella di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-165">When the *iValue* argument is set to TRUE, empty values will be converted to NULL in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="630d4-166">L'impostazione predefinita prevede che i valori vuoti vengano convertiti in un valore predefinito, se presente, per la colonna nella tabella di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="630d4-166">The default is for empty values to be converted to a default value for the column in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table if a default exists.</span></span>|  
|<span data-ttu-id="630d4-167">BCP_OPTION_LAST</span><span class="sxs-lookup"><span data-stu-id="630d4-167">BCP_OPTION_LAST</span></span>|<span data-ttu-id="630d4-168">Ultima riga da copiare.</span><span class="sxs-lookup"><span data-stu-id="630d4-168">The last row to copy.</span></span> <span data-ttu-id="630d4-169">L'impostazione predefinita consiste nella copia di tutte le righe.</span><span class="sxs-lookup"><span data-stu-id="630d4-169">The default is to copy all rows.</span></span> <span data-ttu-id="630d4-170">Un valore minore di 1 reimposta l'opzione sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="630d4-170">A value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="630d4-171">BCP_OPTION_LASTEX</span><span class="sxs-lookup"><span data-stu-id="630d4-171">BCP_OPTION_LASTEX</span></span>|<span data-ttu-id="630d4-172">Per le operazioni BCP out, specifica l'ultima riga della tabella di database da copiare nel file di dati.</span><span class="sxs-lookup"><span data-stu-id="630d4-172">For BCP out operations, specifies the last row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="630d4-173">Per le operazioni BCP in, specifica l'ultima riga del file di dati da copiare nella tabella di database.</span><span class="sxs-lookup"><span data-stu-id="630d4-173">For BCP in operations, specifies the last row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="630d4-174">È previsto che il parametro *iValue* corrisponda all'indirizzo di un numero intero a 64 bit con segno contenente il valore.</span><span class="sxs-lookup"><span data-stu-id="630d4-174">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="630d4-175">Il valore massimo che è possibile passare a BCPLASTEX è 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="630d4-175">The maximum value that can be passed to BCPLASTEX is 2^63-1.</span></span>|  
|<span data-ttu-id="630d4-176">BCP_OPTION_MAXERRS</span><span class="sxs-lookup"><span data-stu-id="630d4-176">BCP_OPTION_MAXERRS</span></span>|<span data-ttu-id="630d4-177">Numero massimo di errori consentiti prima che l'operazione di copia bulk non riesca.</span><span class="sxs-lookup"><span data-stu-id="630d4-177">The number of errors allowed before the bulk copy operation fails.</span></span> <span data-ttu-id="630d4-178">Il valore predefinito è 10.</span><span class="sxs-lookup"><span data-stu-id="630d4-178">The default is 10.</span></span> <span data-ttu-id="630d4-179">Un valore minore di 1 reimposta l'opzione sul valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="630d4-179">A value less than 1 resets this option to its default.</span></span> <span data-ttu-id="630d4-180">La copia bulk impone un massimo di 65.535 errori.</span><span class="sxs-lookup"><span data-stu-id="630d4-180">Bulk copy imposes a maximum of 65,535 errors.</span></span> <span data-ttu-id="630d4-181">Il tentativo di impostare questa opzione su un valore maggiore di 65.535 comporta l'impostazione dell'opzione su 65.535.</span><span class="sxs-lookup"><span data-stu-id="630d4-181">An attempt to set this option to a value larger than 65,535 results in the option being set to 65,535.</span></span>|  
|<span data-ttu-id="630d4-182">BCP_OPTION_ROWCOUNT</span><span class="sxs-lookup"><span data-stu-id="630d4-182">BCP_OPTION_ROWCOUNT</span></span>|<span data-ttu-id="630d4-183">Restituisce il numero di righe interessate dall'ultima operazione BCP o da quella corrente.</span><span class="sxs-lookup"><span data-stu-id="630d4-183">Returns the number of rows affected by the current (or last) BCP operation.</span></span>|  
|<span data-ttu-id="630d4-184">BCP_OPTION_TEXTFILE</span><span class="sxs-lookup"><span data-stu-id="630d4-184">BCP_OPTION_TEXTFILE</span></span>|<span data-ttu-id="630d4-185">Il file di dati non è un file binario, ma è un file di testo.</span><span class="sxs-lookup"><span data-stu-id="630d4-185">The data file is not a binary file, but is a text file.</span></span> <span data-ttu-id="630d4-186">BCP rileva se il file sia o meno Unicode controllando il marcatore di byte Unicode nei primi due byte del file di dati.</span><span class="sxs-lookup"><span data-stu-id="630d4-186">BCP does the detection whether the text file is Unicode or not by checking the Unicode byte marker in the first 2 bytes of the data file.</span></span>|  
|<span data-ttu-id="630d4-187">BCP_OPTION_UNICODEFILE</span><span class="sxs-lookup"><span data-stu-id="630d4-187">BCP_OPTION_UNICODEFILE</span></span>|<span data-ttu-id="630d4-188">Se impostata su TRUE, questa opzione specifica che il file di input utilizza un formato di file Unicode.</span><span class="sxs-lookup"><span data-stu-id="630d4-188">When set to TRUE, this option specifies that the input file is a Unicode file format.</span></span>|  
  
## <a name="arguments"></a><span data-ttu-id="630d4-189">Argomenti</span><span class="sxs-lookup"><span data-stu-id="630d4-189">Arguments</span></span>  
 <span data-ttu-id="630d4-190">*eOption*[in]</span><span class="sxs-lookup"><span data-stu-id="630d4-190">*eOption*[in]</span></span>  
 <span data-ttu-id="630d4-191">Impostare questo argomento su una delle opzioni elencate nella sezione precedente contenente le osservazioni.</span><span class="sxs-lookup"><span data-stu-id="630d4-191">Set to one of the options listed in the remarks section above.</span></span>  
  
 <span data-ttu-id="630d4-192">*iValue*[in]</span><span class="sxs-lookup"><span data-stu-id="630d4-192">*iValue*[in]</span></span>  
 <span data-ttu-id="630d4-193">Valore per l'argomento *eOption* specificato.</span><span class="sxs-lookup"><span data-stu-id="630d4-193">The value for the specified *eOption*.</span></span> <span data-ttu-id="630d4-194">L'argomento *iValue* è un valore integer con cast a un puntatore void per consentire l'espansione futura a valori a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="630d4-194">The *iValue* argument is an integer value cast to a void pointer to allow for future expansion to 64 bit values.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="630d4-195">Valori del codice restituito</span><span class="sxs-lookup"><span data-stu-id="630d4-195">Return Code Values</span></span>  
 <span data-ttu-id="630d4-196">S_OK</span><span class="sxs-lookup"><span data-stu-id="630d4-196">S_OK</span></span>  
 <span data-ttu-id="630d4-197">Il metodo è riuscito.</span><span class="sxs-lookup"><span data-stu-id="630d4-197">The method succeeded.</span></span>  
  
 <span data-ttu-id="630d4-198">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="630d4-198">E_FAIL</span></span>  
 <span data-ttu-id="630d4-199">Si è verificato un errore specifico del provider. Per informazioni dettagliate, usare l'interfaccia [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="630d4-199">A provider-specific error occurred; for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="630d4-200">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="630d4-200">E_UNEXPECTED</span></span>  
 <span data-ttu-id="630d4-201">La chiamata al metodo non era prevista.</span><span class="sxs-lookup"><span data-stu-id="630d4-201">The call to the method was unexpected.</span></span> <span data-ttu-id="630d4-202">Non è stato ad esempio chiamato il metodo [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) prima della chiamata a questa funzione.</span><span class="sxs-lookup"><span data-stu-id="630d4-202">For example, the [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) method was not called before calling this function.</span></span>  
  
 <span data-ttu-id="630d4-203">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="630d4-203">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="630d4-204">Errore di memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="630d4-204">Out-of-memory error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="630d4-205">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="630d4-205">See Also</span></span>  
 <span data-ttu-id="630d4-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="630d4-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="630d4-207">Esecuzione di operazioni di copia bulk</span><span class="sxs-lookup"><span data-stu-id="630d4-207">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
