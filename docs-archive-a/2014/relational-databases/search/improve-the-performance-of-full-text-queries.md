---
title: Migliorare le prestazioni delle query full-text | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
ms.assetid: 0658dc74-25eb-4486-bbd6-e85c1f92c272
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: a1437f710725df5c87d31f6a80939a5d7869b412
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87717741"
---
# <a name="improve-the-performance-of-full-text-queries"></a><span data-ttu-id="f91cb-102">Migliorare le prestazioni delle query full-text</span><span class="sxs-lookup"><span data-stu-id="f91cb-102">Improve the Performance of Full-Text Queries</span></span>
  <span data-ttu-id="f91cb-103">Di seguito viene riportato un elenco di indicazioni che possono favorire il miglioramento delle prestazioni di esecuzione delle query full-text.</span><span class="sxs-lookup"><span data-stu-id="f91cb-103">The following is a list of recommendations that will help to improve the performance of full-text queries.</span></span>  
  
 <span data-ttu-id="f91cb-104">Le prestazioni di esecuzione delle query full-text possono dipendere inoltre da risorse hardware quali memoria, velocità del disco e della CPU, nonché dall'architettura del computer.</span><span class="sxs-lookup"><span data-stu-id="f91cb-104">The performance of full-text queries is also influenced by hardware resources, such as memory, disk speed, CPU speed, and machine architecture.</span></span>  
  
-   <span data-ttu-id="f91cb-105">Deframmentare l'indice della tabella di base tramite [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f91cb-105">Defragment the index of the base table by using [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span></span>  
  
-   <span data-ttu-id="f91cb-106">Riorganizzare il catalogo full-text tramite [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f91cb-106">Reorganize the full-text catalog by using [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span></span> <span data-ttu-id="f91cb-107">È necessario eseguire queste operazioni prima del test delle prestazioni poiché l'esecuzione di questa istruzione determina un'unione nell'indice master degli indici full-text in tale catalogo.</span><span class="sxs-lookup"><span data-stu-id="f91cb-107">Make sure that you do this before performance testing because running this statement causes a master merge of the full-text indexes in that catalog.</span></span>  
  
-   <span data-ttu-id="f91cb-108">Limitare la scelta delle colonne chiave full-text a una a colonna di dimensioni ridotte.</span><span class="sxs-lookup"><span data-stu-id="f91cb-108">Restrict your choice of full-text key columns to a small column.</span></span> <span data-ttu-id="f91cb-109">Benché le colonne a 900 byte siano supportate, è consigliabile utilizzare una colonna chiave di dimensioni inferiori per un indice full-text.</span><span class="sxs-lookup"><span data-stu-id="f91cb-109">Although a 900-byte column is supported, we recommend using a smaller key column in a full-text index.</span></span> <span data-ttu-id="f91cb-110">`int` e `bigint` forniscono le migliori prestazioni.</span><span class="sxs-lookup"><span data-stu-id="f91cb-110">`int` and `bigint` provide the best performance.</span></span>  
  
-   <span data-ttu-id="f91cb-111">L'uso di una chiave full-text a numero intero evita la creazione di un join con la tabella di mapping **docid** .</span><span class="sxs-lookup"><span data-stu-id="f91cb-111">Using an integer full-text key avoids a join with the **docid** mapping table.</span></span> <span data-ttu-id="f91cb-112">Una chiave full-text di tipo integer, pertanto, consente di migliorare le prestazioni di esecuzione delle query di un ordine di grandezza e le prestazioni della ricerca per indicizzazione.</span><span class="sxs-lookup"><span data-stu-id="f91cb-112">Therefore, an integer full-text key improves query performance by an order of magnitude and improves crawl performance.</span></span> <span data-ttu-id="f91cb-113">Nel caso in cui la chiave full-text corrisponda anche alla chiave di indice cluster, i vantaggi a livello di prestazioni saranno ancora maggiori.</span><span class="sxs-lookup"><span data-stu-id="f91cb-113">Additional performance benefits might result if the full-text key is also the clustered index key.</span></span>  
  
-   <span data-ttu-id="f91cb-114">Combinare più predicati [CONTAINS](/sql/t-sql/queries/contains-transact-sql) in un unico predicato CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="f91cb-114">Combine multiple [CONTAINS](/sql/t-sql/queries/contains-transact-sql) predicates into one CONTAINS predicate.</span></span> <span data-ttu-id="f91cb-115">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] è possibile specificare un elenco di colonne nella query CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="f91cb-115">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can specify a list of columns in the CONTAINS query.</span></span>  
  
-   <span data-ttu-id="f91cb-116">Se sono necessarie solo informazioni sulla chiave full-text o sulla pertinenza, invece di CONTAINS o FREETEXT usare, rispettivamente, [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) o [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="f91cb-116">If you only require full-text key or rank information, use [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) or [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) instead of CONTAINS or FREETEXT, respectively.</span></span>  
  
-   <span data-ttu-id="f91cb-117">Per limitare i risultati e ottimizzare le prestazioni, usare il parametro *top_n_by_rank* delle funzioni FREETEXTTABLE e CONTAINSTABLE.</span><span class="sxs-lookup"><span data-stu-id="f91cb-117">To limit results and increase performance, use the *top_n_by_rank* parameter of the FREETEXTTABLE and CONTAINSTABLE functions.</span></span> <span data-ttu-id="f91cb-118">*top_n_by_rank* consente di richiamare solo le occorrenze più attinenti.</span><span class="sxs-lookup"><span data-stu-id="f91cb-118">*top_n_by_rank* allows you to recall only the most relevant hits.</span></span> <span data-ttu-id="f91cb-119">Usare questo parametro solo se lo scenario aziendale non richiede il richiamo di tutte le occorrenze possibili, ovvero se non richiede il *richiamo totale*.</span><span class="sxs-lookup"><span data-stu-id="f91cb-119">Use this parameter only if your business scenario does not require recalling all possible hits (that is, it does not require *total recall*).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="f91cb-120">Il richiamo totale è in genere necessario per gli scenari legali, ma potrebbe essere meno importante delle prestazioni per altri scenari, ad esempio il commercio elettronico.</span><span class="sxs-lookup"><span data-stu-id="f91cb-120">Total recall is typically necessary for legal scenarios but might be less important than performance for business scenarios such as an e-business.</span></span>  
  
-   <span data-ttu-id="f91cb-121">Controllare il piano di query full-text per verificare che venga scelto il piano di join appropriato.</span><span class="sxs-lookup"><span data-stu-id="f91cb-121">Check the full-text query plan to make sure that the appropriate join plan is chosen.</span></span> <span data-ttu-id="f91cb-122">Se necessario, utilizzare un hint di join o un hint per la query.</span><span class="sxs-lookup"><span data-stu-id="f91cb-122">Use a join hint or query hint if you have to.</span></span> <span data-ttu-id="f91cb-123">Se un parametro viene utilizzato nella query full-text, il valore utilizzato per la prima volta per il parametro determina il piano di query.</span><span class="sxs-lookup"><span data-stu-id="f91cb-123">If a parameter is used in the full-text query, the first-time value of the parameter determines the query plan.</span></span> <span data-ttu-id="f91cb-124">È possibile usare l' [hint per la query](/sql/t-sql/queries/hints-transact-sql-query) OPTIMIZE FOR per forzare la compilazione della query con il valore voluto.</span><span class="sxs-lookup"><span data-stu-id="f91cb-124">You can use the OPTIMIZE FOR [query hint](/sql/t-sql/queries/hints-transact-sql-query) to force the query to compile with the value you want.</span></span> <span data-ttu-id="f91cb-125">In questo modo è possibile ottenere un piano della query deterministico e prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="f91cb-125">This helps achieve a deterministic query plan and better performance.</span></span>  
  
-   <span data-ttu-id="f91cb-126">Un numero eccessivo di frammenti di indice full-text nell'indice full-text può causare una significativa riduzione delle prestazioni di esecuzione delle query.</span><span class="sxs-lookup"><span data-stu-id="f91cb-126">Too many full-text index fragments in the full-text index, can lead to substantial degradation in query performance.</span></span> <span data-ttu-id="f91cb-127">Per ridurre il numero di frammenti, riorganizzare il catalogo full-text tramite l'opzione REORGANIZE dell'istruzione [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f91cb-127">To reduce the number of fragments, reorganize the full-text catalog by using the REORGANIZE option of the [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)[!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="f91cb-128">Questa istruzione consente di unire tutti i frammenti in un singolo frammento più grande e di rimuovere tutte le voci obsolete dall'indice full-text.</span><span class="sxs-lookup"><span data-stu-id="f91cb-128">This statement essentially merges all the fragments into a single larger fragment and removes all obsolete entries from the full-text index.</span></span>  
  
-   <span data-ttu-id="f91cb-129">Nelle ricerche full-text gli operatori logici specificati in CONTAINSTABLE (AND, OR) possono essere implementati come join SQL o all'interno di funzioni di flusso con valori di tabella per l'esecuzione full-text.</span><span class="sxs-lookup"><span data-stu-id="f91cb-129">In  full-text search, logical operators specified in CONTAINSTABLE (AND, OR) can be implemented either as SQL joins or inside the full-text execution streaming table-valued functions (STVF).</span></span> <span data-ttu-id="f91cb-130">Le query con un solo tipo di operatori logici vengono in genere implementate dall'esecuzione full-text, mentre le query con operatori logici di più tipi presentano anche join SQL.</span><span class="sxs-lookup"><span data-stu-id="f91cb-130">Typically, queries with only one type of logical operators are implemented purely by full-text execution, whereas queries that mix logical operators also possess SQL joins.</span></span> <span data-ttu-id="f91cb-131">L'implementazione di un operatore logico all'interno della funzione con valori di tabella per l'esecuzione full-text prevede l'utilizzo di alcune proprietà di indice speciali che ne migliorano la velocità rispetto ai join SQL.</span><span class="sxs-lookup"><span data-stu-id="f91cb-131">Implementation of a logical operator inside the full-text execution STVF uses some special index properties that make it much faster than SQL joins.</span></span> <span data-ttu-id="f91cb-132">Per questo motivo, è consigliabile, se possibile, definire le query utilizzando un solo tipo di operatore logico.</span><span class="sxs-lookup"><span data-stu-id="f91cb-132">For this reason, we recommend that, where possible, you frame queries using only a single type of logical operator.</span></span>  
  
-   <span data-ttu-id="f91cb-133">Per le applicazioni che contengono affermazioni a relazione selettiva, le prestazioni di esecuzione delle query che utilizzano predicati relazionali selettivi e predicati full-text non selettivi potrebbero risultare migliori se le query sono scritte per l'utilizzo di Query Optimizer.</span><span class="sxs-lookup"><span data-stu-id="f91cb-133">For applications that contain selective-relation predications, queries that use selective relational predicates and unselective full-text predicates might perform best when they are written to use the query optimizer.</span></span> <span data-ttu-id="f91cb-134">In questo modo, Query Optimizer sarà in grado di stabilire la possibilità o meno di utilizzare l'impostazione di intervalli o di predicati per produrre un piano di query efficace.</span><span class="sxs-lookup"><span data-stu-id="f91cb-134">This allows the query optimizer to decide whether it can exploit predicate or range pushdown to produce an effective query plan.</span></span> <span data-ttu-id="f91cb-135">Questo metodo è più semplice e spesso più efficiente rispetto all'indicizzazione di dati relazionali come dati full-text.</span><span class="sxs-lookup"><span data-stu-id="f91cb-135">This approach is simpler and often more efficient than indexing relational data as full-text data.</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="f91cb-136">Risorse correlate</span><span class="sxs-lookup"><span data-stu-id="f91cb-136">Related Resources</span></span>  
 [<span data-ttu-id="f91cb-137">SQL Server 2008 Full-Text Search: Internals and Enhancements</span><span class="sxs-lookup"><span data-stu-id="f91cb-137">SQL Server 2008 Full-Text Search: Internals and Enhancements</span></span>](https://go.microsoft.com/fwlink/?LinkId=129544)  
  
## <a name="see-also"></a><span data-ttu-id="f91cb-138">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="f91cb-138">See Also</span></span>  
 <span data-ttu-id="f91cb-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="f91cb-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span></span>  
 [<span data-ttu-id="f91cb-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="f91cb-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-pools-transact-sql)  
  
  
