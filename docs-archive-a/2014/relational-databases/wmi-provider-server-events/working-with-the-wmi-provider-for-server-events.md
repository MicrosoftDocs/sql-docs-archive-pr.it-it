---
title: Utilizzo del provider WMI per eventi del server | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- event notifications [WMI]
- permissions [WMI]
- connection strings [WMI]
- security [WMI]
- Service Broker [WMI]
- WMI Provider for Server Events, connection strings
- WMI Provider for Server Events, Service Broker
- notifications [WMI]
- WMI Provider for Server Events, security
ms.assetid: cd974b3b-2309-4a20-b9be-7cfc93fc4389
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: 79ee9c4402971807263284d10e31db702abeee86
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87713947"
---
# <a name="working-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="c7895-102">Utilizzo del provider WMI per eventi del server</span><span class="sxs-lookup"><span data-stu-id="c7895-102">Working with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="c7895-103">In questo argomento vengono fornite linee guida che è consigliabile tenere presenti prima di programmare tramite il provider WMI per eventi del server.</span><span class="sxs-lookup"><span data-stu-id="c7895-103">This topic provides guidelines you should consider before you program using the WMI Provider for Server Events.</span></span>  
  
## <a name="enabling-service-broker"></a><span data-ttu-id="c7895-104">Abilitazione di Service Broker</span><span class="sxs-lookup"><span data-stu-id="c7895-104">Enabling Service Broker</span></span>  
 <span data-ttu-id="c7895-105">Il provider WMI per eventi del server converte query WQL per eventi in notifiche degli eventi nel database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="c7895-105">The WMI Provider for Server Events works by translating WQL queries for events into event notifications in the database that you target.</span></span> <span data-ttu-id="c7895-106">Una corretta comprensione del funzionamento delle notifiche degli eventi può risultare utile quando si programma per il provider.</span><span class="sxs-lookup"><span data-stu-id="c7895-106">An understanding of how event notifications work can be useful to you when programming against the provider.</span></span> <span data-ttu-id="c7895-107">Per altre informazioni, vedere [Concetti relativi al provider WMI per eventi del server](https://technet.microsoft.com/library/ms180560.aspx).</span><span class="sxs-lookup"><span data-stu-id="c7895-107">For more information, see [WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx).</span></span>  
  
 <span data-ttu-id="c7895-108">In particolare, poiché le notifiche degli eventi create dal provider WMI utilizzano [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] per inviare messaggi sugli eventi del server, questo servizio deve essere abilitato ogni volta che vengono generati gli eventi.</span><span class="sxs-lookup"><span data-stu-id="c7895-108">In particular, because the event notifications created by the WMI Provider use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send messages about server events, this service must be enabled wherever the events are generated.</span></span> <span data-ttu-id="c7895-109">Se il programma esegue query sugli eventi in un'istanza del server, è necessario abilitare [!INCLUDE[ssSB](../../includes/sssb-md.md)] in msdb di tale istanza, in quanto corrisponde al percorso del servizio [!INCLUDE[ssSB](../../includes/sssb-md.md)] di destinazione (denominato SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) creato dal provider.</span><span class="sxs-lookup"><span data-stu-id="c7895-109">If your program queries events on a server instance, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in msdb of that instance must be enabled, because that is the location of the target [!INCLUDE[ssSB](../../includes/sssb-md.md)] service (named SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) that is created by the provider.</span></span> <span data-ttu-id="c7895-110">Se il programma esegue query sugli eventi in un database o in un determinato oggetto di database, è necessario che [!INCLUDE[ssSB](../../includes/sssb-md.md)] sia abilitato nel database di destinazione specifico.</span><span class="sxs-lookup"><span data-stu-id="c7895-110">If your program queries events in a database or on a particular database object, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in that target database must be enabled.</span></span> <span data-ttu-id="c7895-111">Se il servizio di [!INCLUDE[ssSB](../../includes/sssb-md.md)] non è abilitato in seguito alla distribuzione dell'applicazione, qualsiasi evento generato dalla notifica degli eventi sottostante viene inviato alla coda del servizio utilizzato dalla notifica, ma non viene restituito all'applicazione di gestione WMI fino a quando [!INCLUDE[ssSB](../../includes/sssb-md.md)] non è abilitato.</span><span class="sxs-lookup"><span data-stu-id="c7895-111">If the corresponding [!INCLUDE[ssSB](../../includes/sssb-md.md)] is not enabled after your application is deployed, any events generated by the underlying event notification are sent to the queue of the service used by the event notification, but are not returned to your WMI management application until [!INCLUDE[ssSB](../../includes/sssb-md.md)] is enabled.</span></span>  
  
 <span data-ttu-id="c7895-112">La query seguente consente di determinare i servizi di Service Broker abilitati in un'istanza del server e il GUID dell'istanza di Service Broker:</span><span class="sxs-lookup"><span data-stu-id="c7895-112">The following query determines which service brokers are enabled on a server instance, and the broker instance GUID:</span></span>  
  
```  
SELECT name, is_broker_enabled, service_broker_guid FROM sys.databases;  
```  
  
 <span data-ttu-id="c7895-113">Il GUID di Service Broker di msdb è rilevante in quanto corrisponde al percorso del servizio di destinazione del provider.</span><span class="sxs-lookup"><span data-stu-id="c7895-113">The service broker GUID of msdb is of particular interest because that is the location of the target service of the provider.</span></span>  
  
 <span data-ttu-id="c7895-114">Per abilitare [!INCLUDE[ssSB](../../includes/sssb-md.md)] in un database, utilizzare l'opzione ENABLE_BROKER SET dell'istruzione [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="c7895-114">To enable [!INCLUDE[ssSB](../../includes/sssb-md.md)] in a database, use the ENABLE_BROKER SET option of the [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) statement.</span></span>  
  
## <a name="specifying-a-connection-string"></a><span data-ttu-id="c7895-115">Definizione di una stringa di connessione</span><span class="sxs-lookup"><span data-stu-id="c7895-115">Specifying a Connection String</span></span>  
 <span data-ttu-id="c7895-116">Le applicazioni indirizzano il provider WMI per eventi del server a un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connettendosi a uno spazio dei nomi WMI definito dal provider.</span><span class="sxs-lookup"><span data-stu-id="c7895-116">Applications direct the WMI Provider for Server Events to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by connecting to a WMI namespace defined by the provider.</span></span> <span data-ttu-id="c7895-117">Il servizio Windows WMI esegue il mapping di questo spazio dei nomi alla DLL del provider, Sqlwep.dll, e lo carica in memoria.</span><span class="sxs-lookup"><span data-stu-id="c7895-117">The Windows WMI service maps this namespace to the provider DLL, Sqlwep.dll, and loads it into memory.</span></span> <span data-ttu-id="c7895-118">Ogni istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dispone di uno spazio dei nomi WMI personalizzato, che per impostazione predefinita è: \\ \\ . \\ *root* \\ *instance_name*radice \Microsoft\SqlServer\ServerEvents.</span><span class="sxs-lookup"><span data-stu-id="c7895-118">Each instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] has its own WMI namespace, which defaults to: \\\\.\\*root*\Microsoft\SqlServer\ServerEvents\\*instance_name*.</span></span> <span data-ttu-id="c7895-119">*nome_istanza* viene impostato in modo predefinito su MSSQLSERVER in un'installazione predefinita di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c7895-119">*instance_name* defaults to MSSQLSERVER in a default installation of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="permissions-and-server-authentication"></a><span data-ttu-id="c7895-120">Autorizzazioni e autenticazione del server</span><span class="sxs-lookup"><span data-stu-id="c7895-120">Permissions and Server Authentication</span></span>  
 <span data-ttu-id="c7895-121">Per accedere al provider WMI per eventi del server, il client in cui ha origine un'applicazione di gestione WMI deve corrispondere all'account di accesso o al gruppo autenticato di Windows nell'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specificata nella stringa di connessione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c7895-121">To access the WMI Provider for Server Events, the client on which a WMI management application originates must correspond to Windows authenticated login or group in the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specified in the application's connection string of the application.</span></span>  
  
## <a name="permissions-and-event-notification-scope"></a><span data-ttu-id="c7895-122">Autorizzazioni e ambito delle notifiche degli eventi</span><span class="sxs-lookup"><span data-stu-id="c7895-122">Permissions and Event Notification Scope</span></span>  
 <span data-ttu-id="c7895-123">Il provider WMI per eventi del server converte query WQL in notifiche degli eventi nel database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="c7895-123">The WMI Provider for Server Events translates WQL queries into event notifications in the target database.</span></span> <span data-ttu-id="c7895-124">Di conseguenza, l'applicazione chiamante deve disporre non solo delle autorizzazioni minime necessarie per accedere al provider, ma anche delle autorizzazioni corrette nel database per creare le notifiche degli eventi necessarie.</span><span class="sxs-lookup"><span data-stu-id="c7895-124">Because of this, the calling application must have not only the required minimum permissions to access the provider, but must also have the correct permissions in the database to create the required event notifications.</span></span> <span data-ttu-id="c7895-125">Sono necessarie le autorizzazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c7895-125">The following are the permissions:</span></span>  
  
-   <span data-ttu-id="c7895-126">Per creare una notifica degli eventi il cui ambito è costituito dal database, è necessario disporre almeno dell'autorizzazione CREATE DATABASE DDL EVENT NOTIFICATION per il database corrente.</span><span class="sxs-lookup"><span data-stu-id="c7895-126">To create an event notification that is scoped to the database, at a minimum, CREATE DATABASE DDL EVENT NOTIFICATION permission in the current database is required.</span></span>  
  
-   <span data-ttu-id="c7895-127">Per creare una notifica degli eventi per un'istruzione DDL il cui ambito è costituito dal server, è necessario disporre almeno dell'autorizzazione CREATE DDL EVENT NOTIFICATION nel server.</span><span class="sxs-lookup"><span data-stu-id="c7895-127">To create an event notification on a DDL statement that is scoped to the server, at a minimum, CREATE DDL EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="c7895-128">Per creare una notifica degli eventi per un evento di traccia, è necessario disporre almeno dell'autorizzazione CREATE TRACE EVENT NOTIFICATION nel server.</span><span class="sxs-lookup"><span data-stu-id="c7895-128">To create an event notification on a trace event, at a minimum, CREATE TRACE EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="c7895-129">Per creare una notifica degli eventi il cui ambito è costituito da una coda, è necessario disporre almeno dell'autorizzazione ALTER per la coda.</span><span class="sxs-lookup"><span data-stu-id="c7895-129">To create an event notification that is scoped to a queue, at a minimum, ALTER permission on the queue is required.</span></span>  
  
 <span data-ttu-id="c7895-130">Per informazioni sull'ambito delle query WQL, vedere [Utilizzo di WQL con il provider WMI per eventi del server](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="c7895-130">For information about how WQL queries are scoped, see [Using WQL with the WMI Provider for Server Events](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span></span>  
  
 <span data-ttu-id="c7895-131">Per illustrare l'ambito, si consideri un'applicazione del provider WMI che include la query WQL seguente:</span><span class="sxs-lookup"><span data-stu-id="c7895-131">To illustrate scope, consider a WMI Provider application that includes the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE  
WHERE DatabaseName = "AdventureWorks2012"   
    AND SchemaName = "Person"  
    AND ObjectName = "Person"  
    AND ObjectType = "TABLE";  
```  
  
 <span data-ttu-id="c7895-132">Il provider WMI converte la query in una notifica degli eventi creata nel database [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c7895-132">The WMI provider translates this query into an event notification that is created in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="c7895-133">Di conseguenza, il chiamante deve disporre delle autorizzazioni necessarie per creare tale notifica degli eventi, in particolare dell'autorizzazione CREATE DATABASE DDL EVENT NOTIFICATION nel database [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c7895-133">This means that the caller must have the required permissions to create such an event notification, specifically CREATE DATABASE DDL EVENT NOTIFICATION permission in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span>  
  
 <span data-ttu-id="c7895-134">Se una query WQL specifica una notifica degli eventi con ambito a livello di server, ad esempio eseguendo la query SELECT \* FROM ALTER_TABLE, l'applicazione chiamante deve disporre dell'autorizzazione CREATE DDL EVENT NOTIFICATION a livello di server.</span><span class="sxs-lookup"><span data-stu-id="c7895-134">If a WQL query specifies an event notification scoped at the server level, for example by issuing the query SELECT \* FROM ALTER_TABLE, the calling application must have the server-level CREATE DDL EVENT NOTIFICATION permission.</span></span> <span data-ttu-id="c7895-135">Si noti che le notifiche degli eventi con ambito server vengono archiviate nel database master.</span><span class="sxs-lookup"><span data-stu-id="c7895-135">Note that server-scoped event notifications are stored in the master database.</span></span> <span data-ttu-id="c7895-136">Per visualizzare i metadati di tali notifiche, è possibile utilizzare la vista del catalogo [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="c7895-136">You can use the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view to see their metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="c7895-137">L'ambito della notifica degli eventi creata dal provider WMI (server, database o oggetto) dipende in definitiva dal risultato del processo di verifica delle autorizzazioni utilizzato dal provider WMI,</span><span class="sxs-lookup"><span data-stu-id="c7895-137">The scope of the event notification that is created by the WMI Provider (server, database, or object) ultimately depends on the outcome of the permissions verification process that is used by the WMI provider.</span></span> <span data-ttu-id="c7895-138">che dipende a sua volta dal set di autorizzazioni dell'utente che chiama il provider e dalla verifica del database su cui vengono eseguite le query.</span><span class="sxs-lookup"><span data-stu-id="c7895-138">This is affected by the permission set of the user that is calling the provider and on the verification of the database that is being queried.</span></span>  
>   
>  <span data-ttu-id="c7895-139">Nell'esempio precedente il provider tenta innanzitutto di creare una notifica degli eventi il cui ambito è costituito dal database (`ON DATABASE`).</span><span class="sxs-lookup"><span data-stu-id="c7895-139">In the previous example, the provider first tries to create an event notification scoped to the database (`ON DATABASE`).</span></span> <span data-ttu-id="c7895-140">Se il provider verifica che il database è presente e che il chiamante dispone delle autorizzazioni necessarie per crearvi una notifica degli eventi, la registrazione ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="c7895-140">If the provider verifies that the database exists and that the caller has the required permissions to create an event notification on it, the registration is successful.</span></span> <span data-ttu-id="c7895-141">Se la registrazione ha esito negativo, il provider tenta di creare una notifica degli eventi nel server (`ON SERVER`).</span><span class="sxs-lookup"><span data-stu-id="c7895-141">If it is not successful, the provider tries to create an event notification on the server (`ON SERVER`).</span></span> <span data-ttu-id="c7895-142">Supponendo che il tentativo abbia esito positivo, tutti gli eventi `ALTER_TABLE` che si verificano nel server vengono inviati dal processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] al processo del servizio WMI.</span><span class="sxs-lookup"><span data-stu-id="c7895-142">Assuming that this attempt is successful, all `ALTER_TABLE` events that occur on the server are sent from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process to the WMI Service process.</span></span> <span data-ttu-id="c7895-143">Il provider, tuttavia, esclude tramite filtro tutti gli eventi che non si applicano al database `AdventureWorks` .</span><span class="sxs-lookup"><span data-stu-id="c7895-143">However, the provider filters out any events that do not apply to the `AdventureWorks` database.</span></span> <span data-ttu-id="c7895-144">Benché questo processo rischi di aumentare la quantità di traffico di rete richiesta per l'ambito dell'evento, offre inoltre la flessibilità necessaria per registrare query WQL nei database prima che questi vengano creati e per ricevere quindi i dati degli eventi in seguito alla creazione del database e all'avvio dell'attività DDL nel database stesso.</span><span class="sxs-lookup"><span data-stu-id="c7895-144">Although this process potentially increases the amount of network traffic necessary for the scope of the event, this process also enables you with the flexibility to register WQL queries on databases before they are created, and then receive event data after the database is created and DDL activity starts on it.</span></span>  
  
## <a name="permissions-and-message-verification"></a><span data-ttu-id="c7895-145">Autorizzazioni e verifica dei messaggi</span><span class="sxs-lookup"><span data-stu-id="c7895-145">Permissions and Message Verification</span></span>  
 <span data-ttu-id="c7895-146">Il provider WMI non invia messaggi per le notifiche degli eventi se si verificano entrambe le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="c7895-146">The WMI Provider does not send messages for event notifications if both of the following conditions are true:</span></span>  
  
-   <span data-ttu-id="c7895-147">L'utente che ha creato la notifica degli eventi tramite il provider WMI non è più presente nel database o non dispone più dell'autorizzazione necessaria per creare una notifica degli eventi simile.</span><span class="sxs-lookup"><span data-stu-id="c7895-147">The user that created the event notification through the WMI Provider no longer exists in the database, or no longer has the required permission to create a similar event notification.</span></span>  
  
-   <span data-ttu-id="c7895-148">Le notifiche degli eventi vengono create negli eventi seguenti.</span><span class="sxs-lookup"><span data-stu-id="c7895-148">The event notifications are created on the following events:</span></span>  
  
    -   <span data-ttu-id="c7895-149">DROP_LOGIN</span><span class="sxs-lookup"><span data-stu-id="c7895-149">DROP_LOGIN</span></span>  
  
    -   <span data-ttu-id="c7895-150">ALTER_LOGIN</span><span class="sxs-lookup"><span data-stu-id="c7895-150">ALTER_LOGIN</span></span>  
  
    -   <span data-ttu-id="c7895-151">DROP_USER</span><span class="sxs-lookup"><span data-stu-id="c7895-151">DROP_USER</span></span>  
  
    -   <span data-ttu-id="c7895-152">ALTER_USER</span><span class="sxs-lookup"><span data-stu-id="c7895-152">ALTER_USER</span></span>  
  
    -   <span data-ttu-id="c7895-153">ADD_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="c7895-153">ADD_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="c7895-154">DROP_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="c7895-154">DROP_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="c7895-155">ADD_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="c7895-155">ADD_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="c7895-156">DROP_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="c7895-156">DROP_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="c7895-157">DENY o REVOKE (si applica solo alle autorizzazioni ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION O CREATE TRACE EVENT NOTIFICATION)</span><span class="sxs-lookup"><span data-stu-id="c7895-157">DENY or REVOKE (Applies only to ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION, OR CREATE TRACE EVENT NOTIFICATION permissions.)</span></span>  
  
## <a name="working-with-event-data-on-the-client-side"></a><span data-ttu-id="c7895-158">Utilizzo dei dati degli eventi sul lato client</span><span class="sxs-lookup"><span data-stu-id="c7895-158">Working with Event Data on the Client Side</span></span>  
 <span data-ttu-id="c7895-159">Dopo che il provider WMI per eventi del server crea la notifica degli eventi necessaria nel database di destinazione, la notifica degli eventi invia i dati dell'evento al servizio di destinazione in msdb denominato **SQL/Notifications/ProcessWMIEventProviderNotification/v 1.0**.</span><span class="sxs-lookup"><span data-stu-id="c7895-159">After the WMI Provider for Server Events creates the required event notification in the target database, the event notification sends event data to the target service in msdb that is named **SQL/Notifications/ProcessWMIEventProviderNotification/v1.0**.</span></span> <span data-ttu-id="c7895-160">Il servizio di destinazione inserisce l'evento in una coda in `msdb` denominata **WMIEventProviderNotificationQueue**.</span><span class="sxs-lookup"><span data-stu-id="c7895-160">The target service puts the event into a queue in `msdb` that is named **WMIEventProviderNotificationQueue**.</span></span> <span data-ttu-id="c7895-161">Sia il servizio sia la coda vengono creati dinamicamente dal provider quando si connette per la prima volta a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Il provider legge quindi i dati degli eventi XML dalla coda e li trasforma in MOF (Managed Object Format) prima di restituirlo all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="c7895-161">(Both the service and the queue are dynamically created by the provider when it first connects to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].) The provider then reads the XML event data from this queue and transforms it into managed object format (MOF) before returning it to the client application.</span></span> <span data-ttu-id="c7895-162">I dati MOF sono costituiti dalle proprietà dell'evento richiesto dalla query WQL come definizione della classe CIM (Common Information Model).</span><span class="sxs-lookup"><span data-stu-id="c7895-162">The MOF data is made up of the properties of the event that is requested by the WQL query as a Common Information Model (CIM) class definition.</span></span> <span data-ttu-id="c7895-163">Ogni proprietà dispone di un tipo CIM corrispondente.</span><span class="sxs-lookup"><span data-stu-id="c7895-163">Each property has a corresponding CIM type.</span></span> <span data-ttu-id="c7895-164">La proprietà `SPID`, ad esempio, viene restituita come tipo CIM `Sint32`.</span><span class="sxs-lookup"><span data-stu-id="c7895-164">For example, the `SPID` property is returned as CIM type `Sint32`.</span></span> <span data-ttu-id="c7895-165">I tipi CIM per ogni proprietà sono elencati all'interno di ogni classe di evento in [Classi e proprietà del provider WMI per eventi del server](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c7895-165">The CIM types for each property are listed under each event class in [WMI Provider for Server Events Classes and Properties](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c7895-166">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="c7895-166">See Also</span></span>  
 [<span data-ttu-id="c7895-167">Concetti relativi al provider WMI per eventi del server</span><span class="sxs-lookup"><span data-stu-id="c7895-167">WMI Provider for Server Events Concepts</span></span>](https://technet.microsoft.com/library/ms180560.aspx)  
  
  
