---
title: Utilizzo di WQL con il provider WMI per eventi del server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- queries [WMI]
- query language [WMI]
- WMI Query Language [WMI]
- WQL [WMI]
- WMI Provider for Server Events, WQL
ms.assetid: 58b67426-1e66-4445-8e2c-03182e94c4be
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: df2bbf5c6031781494695f95116441fde34bf4f5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628544"
---
# <a name="using-wql-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="a5c0a-102">Utilizzo di WQL con il provider WMI per eventi del server</span><span class="sxs-lookup"><span data-stu-id="a5c0a-102">Using WQL with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="a5c0a-103">Le applicazioni di gestione accedono agli eventi di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilizzando il provider WMI per eventi del server ed eseguendo istruzioni WQL (WMI Query Language).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-103">Management applications access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] events using the WMI Provider for Server Events by issuing WMI Query Language (WQL) statements.</span></span> <span data-ttu-id="a5c0a-104">WQL è un subset semplificato del linguaggio SQL (Structured Query Language), con alcune estensioni specifiche di WMI.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-104">WQL is a simplified subset of structured query language (SQL), with some WMI-specific extensions.</span></span> <span data-ttu-id="a5c0a-105">Quando si utilizza WQL, un'applicazione recupera un tipo di evento da un'istanza specifica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], un database o un oggetto di database (l'unico oggetto attualmente supportato è la coda).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-105">In using WQL, an application retrieves an event type against a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], a database, or a database object (the only object currently supported is queue).</span></span> <span data-ttu-id="a5c0a-106">Il provider WMI per eventi del server converte la query in una notifica degli eventi creata nel database di destinazione per le notifiche degli eventi con ambito database o oggetto o nel database **Master** per le notifiche degli eventi con ambito server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-106">The WMI Provider for Server Events translates the query into an event notification that is created in the target database for database-scoped or object-scoped event notifications, or in the **master** database for server-scoped event notifications.</span></span>  
  
 <span data-ttu-id="a5c0a-107">Si consideri, ad esempio, la query WQL seguente:</span><span class="sxs-lookup"><span data-stu-id="a5c0a-107">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM DDL_DATABASE_LEVEL_EVENTS WHERE DatabaseName = 'AdventureWorks'  
```  
  
 <span data-ttu-id="a5c0a-108">Da questa query il provider WMI tenta di produrre l'equivalente della notifica degli eventi sul server di destinazione:</span><span class="sxs-lookup"><span data-stu-id="a5c0a-108">From this query, the WMI Provider tries to produce the equivalent of this event notification on the target server:</span></span>  
  
```  
USE AdventureWorks ;  
GO  
  
CREATE EVENT NOTIFICATION SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9  
    ON DATABASE  
    WITH FAN_IN  
    FOR DDL_DATABASE_LEVEL_EVENTS  
    TO SERVICE   
        'SQL/Notifications/ProcessWMIEventProviderNotification/v1.0',  
        'A7E5521A-1CA6-4741-865D-826F804E5135';  
GO  
```  
  
 <span data-ttu-id="a5c0a-109">L'argomento nella clausola `FROM` della query WQL (`DDL_DATABASE_LEVEL_EVENTS`) può essere qualsiasi evento valido per il quale può essere creata una notifica.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-109">The argument in the `FROM` clause of the WQL query (`DDL_DATABASE_LEVEL_EVENTS`) can be any valid event upon which an event notification can be created.</span></span> <span data-ttu-id="a5c0a-110">Gli argomenti nelle clausole `SELECT` e `WHERE` possono specificare qualsiasi proprietà di evento associata a un evento o al relativo evento padre.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-110">The arguments in the `SELECT` and `WHERE` clauses can specify any event property associated with an event or its parent event.</span></span> <span data-ttu-id="a5c0a-111">Per un elenco di eventi e proprietà di evento validi, vedere [notifiche degli eventi (motore di database)](https://technet.microsoft.com/library/ms182602.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-111">For a list of valid events and event properties, see [Event Notifications (Database Engine)](https://technet.microsoft.com/library/ms182602.aspx).</span></span>  
  
 <span data-ttu-id="a5c0a-112">La sintassi WQL seguente è supportata in modo esplicito dal provider WMI per eventi del server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-112">The following WQL syntax is supported explicitly by the WMI Provider for Server Events.</span></span> <span data-ttu-id="a5c0a-113">È possibile specificare elementi di sintassi WQL aggiuntivi. Tali elementi non sono specifici di questo provider e vengono analizzati dal servizio host WMI.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-113">Additional WQL syntax may be specified, but it is not specific to this provider and is parsed instead by the WMI host service.</span></span> <span data-ttu-id="a5c0a-114">Per ulteriori informazioni sul linguaggio WQL (WMI Query Language), vedere la documentazione relativa a WQL in MSDN (Microsoft Developer Network).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-114">For more information about the WMI Query Language, see the WQL documentation on the Microsoft Developer Network (MSDN).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="a5c0a-115">Sintassi</span><span class="sxs-lookup"><span data-stu-id="a5c0a-115">Syntax</span></span>  
  
```  
  
SELECT { event_property [ ,...n ] | * }  
FROM event_type   
WHERE where_condition  
```  
  
## <a name="arguments"></a><span data-ttu-id="a5c0a-116">Argomenti</span><span class="sxs-lookup"><span data-stu-id="a5c0a-116">Arguments</span></span>  
 <span data-ttu-id="a5c0a-117">*event_property*</span><span class="sxs-lookup"><span data-stu-id="a5c0a-117">*event_property*</span></span>  
 <span data-ttu-id="a5c0a-118">Proprietà di un evento.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-118">Is a property of an event.</span></span> <span data-ttu-id="a5c0a-119">Tra gli esempi sono inclusi `PostTime`, `SPID` e `LoginName`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-119">Examples include `PostTime`, `SPID`, and `LoginName`.</span></span> <span data-ttu-id="a5c0a-120">Cercare ogni evento elencato in [classi e proprietà del provider WMI per eventi del server](wmi-provider-for-server-events-classes-and-properties.md) per determinare le proprietà che possiede.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-120">Look up each event listed in [WMI Provider for Server Events Classes and Properties](wmi-provider-for-server-events-classes-and-properties.md) to determine which properties it holds.</span></span> <span data-ttu-id="a5c0a-121">L'evento DDL_DATABASE_LEVEL_EVENTS include, ad esempio, le proprietà `DatabaseName` e `UserName`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-121">For example, the DDL_DATABASE_LEVEL_EVENTS event holds the `DatabaseName` and `UserName` properties.</span></span> <span data-ttu-id="a5c0a-122">Eredita inoltre le proprietà `SQLInstance`, `LoginName`, `PostTime`, `SPID` e `ComputerName` dai relativi eventi padre.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-122">It also inherits the `SQLInstance`, `LoginName`, `PostTime`, `SPID`, and `ComputerName` properties from its parent events.</span></span>  
  
 <span data-ttu-id="a5c0a-123">**,** *... n*</span><span class="sxs-lookup"><span data-stu-id="a5c0a-123">**,** *...n*</span></span>  
 <span data-ttu-id="a5c0a-124">Indica che *event_property* possibile eseguire query più volte, separate da virgole.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-124">Indicates that *event_property* can be queried multiple times, separated by commas.</span></span>  
  
 \*  
 <span data-ttu-id="a5c0a-125">Specifica che tutte le proprietà associate a un evento vengono sottoposte a query.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-125">Specifies that all properties associated with an event are queried.</span></span>  
  
 <span data-ttu-id="a5c0a-126">*event_type*</span><span class="sxs-lookup"><span data-stu-id="a5c0a-126">*event_type*</span></span>  
 <span data-ttu-id="a5c0a-127">Qualsiasi evento per il quale è possibile creare una notifica.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-127">Is any event against which an event notification can be created.</span></span> <span data-ttu-id="a5c0a-128">Per un elenco degli eventi disponibili, vedere [classi e proprietà del provider WMI per eventi del server](https://technet.microsoft.com/library/ms186449.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-128">For a list of available events, see [WMI Provider for Server Events Classes and Properties](https://technet.microsoft.com/library/ms186449.aspx).</span></span> <span data-ttu-id="a5c0a-129">Si noti che i nomi dei *tipi di evento* corrispondono allo stesso *event_type*  |  *event_group* che è possibile specificare quando si crea manualmente una notifica degli eventi usando Crea notifica evento.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-129">Note that *event type* names correspond to the same *event_type* | *event_group* that can be specified when you manually create an event notification by using CREATE EVENT NOTIFICATION.</span></span> <span data-ttu-id="a5c0a-130">Esempi di *tipo di evento* includono CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS e TRC_DATABASE.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-130">Examples of *event type* include CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS, and TRC_DATABASE.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a5c0a-131">Anche determinate stored procedure di sistema che eseguono operazioni di tipo DDL possono attivare notifiche degli eventi.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-131">Certain system stored procedures that perform DDL-like operations can also fire event notifications.</span></span> <span data-ttu-id="a5c0a-132">Testare le notifiche degli eventi per determinarne le risposte alle stored procedure di sistema eseguite.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-132">Test your event notifications to determine their responses to system stored procedures that are run.</span></span> <span data-ttu-id="a5c0a-133">Ad esempio, l'istruzione CREATE TYPE e **sp_addtype** stored procedure genereranno una notifica degli eventi creata in un evento di CREATE_TYPE.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-133">For example, the CREATE TYPE statement and **sp_addtype** stored procedure will both fire an event notification that is created on a CREATE_TYPE event.</span></span> <span data-ttu-id="a5c0a-134">Tuttavia, il **sp_rename** stored procedure non genera alcuna notifica degli eventi.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-134">However, the **sp_rename** stored procedure does not fire any event notifications.</span></span> <span data-ttu-id="a5c0a-135">Per ulteriori informazioni, vedere[eventi DDL](../triggers/ddl-events.md).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-135">For more information, see[DDL Events](../triggers/ddl-events.md).</span></span>  
  
 <span data-ttu-id="a5c0a-136">*where_condition*</span><span class="sxs-lookup"><span data-stu-id="a5c0a-136">*where_condition*</span></span>  
 <span data-ttu-id="a5c0a-137">Predicato di query clausola WHERE costituito da nomi *event_property* e operatori logici e di confronto.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-137">Is a WHERE clause query predicate made up of *event_property* names and logical and comparison operators.</span></span> <span data-ttu-id="a5c0a-138">Il *where_condition* determina l'ambito in cui la notifica degli eventi corrispondente è registrata nel database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-138">The *where_condition* determines the scope in which the corresponding event notification is registered in the target database.</span></span> <span data-ttu-id="a5c0a-139">Può anche fungere da filtro per indirizzare un particolare schema o oggetto da cui eseguire una query *event_type.*</span><span class="sxs-lookup"><span data-stu-id="a5c0a-139">It can also act as a filter to target a particular schema or object from which to query *event_type.*</span></span> <span data-ttu-id="a5c0a-140">Per ulteriori informazioni, vedere la sezione Osservazioni di seguito in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-140">For more information, see the Remarks section later in this topic.</span></span>  
  
 <span data-ttu-id="a5c0a-141">È possibile utilizzare solo l'operando `=` insieme a `DatabaseName`, `SchemaName` e `ObjectName`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-141">Only the `=` operand can be used together with `DatabaseName`, `SchemaName`, and `ObjectName`.</span></span> <span data-ttu-id="a5c0a-142">Con queste proprietà di evento non è possibile utilizzare altre espressioni.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-142">Other expressions cannot be used with these event properties.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="a5c0a-143">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="a5c0a-143">Remarks</span></span>  
 <span data-ttu-id="a5c0a-144">Il *where_condition* della sintassi del provider WMI per gli eventi del server determina quanto segue:</span><span class="sxs-lookup"><span data-stu-id="a5c0a-144">The *where_condition* of the WMI Provider for Server Events syntax determines the following:</span></span>  
  
-   <span data-ttu-id="a5c0a-145">Ambito dal quale il provider tenta di recuperare il *event_type*specificato, ovvero a livello di server, a livello di database o a livello di oggetto (l'unico oggetto attualmente supportato è Queue).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-145">The scope by which the provider tries to retrieve the specified *event_type*: the server level, database level, or object level (the only object currently supported is queue).</span></span> <span data-ttu-id="a5c0a-146">Infine, tale ambito determina il tipo di notifica degli eventi creato nel database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-146">Ultimately, this scope determines the type of event notification created in the target database.</span></span> <span data-ttu-id="a5c0a-147">Questo processo viene chiamato registrazione della notifica degli eventi.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-147">This process called event notification registration.</span></span>  
  
-   <span data-ttu-id="a5c0a-148">Il database, lo schema e l'oggetto, se appropriato, in cui effettuare la registrazione.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-148">The database, schema, and object, where appropriate, on which to register.</span></span>  
  
 <span data-ttu-id="a5c0a-149">Il provider WMI per eventi del server utilizza un algoritmo bottom-up, first-fit per produrre l'ambito più ristretto possibile per l'oggetto EVENT NOTIFICATION sottostante.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-149">The WMI Provider for Server Events uses a bottom-up, first-fit algorithm to produce the narrowest possible scope for the underlying EVENT NOTIFICATION.</span></span> <span data-ttu-id="a5c0a-150">L'algoritmo tenta di ridurre l'attività interna sul server e il traffico di rete tra l'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e il processo host WMI.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-150">The algorithm tries to minimize internal activity on the server and network traffic between the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the WMI host process.</span></span> <span data-ttu-id="a5c0a-151">Il provider esamina la *event_type* specificata nella clausola from e le condizioni nella clausola WHERE e tenta di registrare la notifica degli eventi sottostante con l'ambito più piccolo possibile.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-151">The provider examines the *event_type* specified in the FROM clause and the conditions in the WHERE clause, and tries to register the underlying EVENT NOTIFICATION with the narrowest possible scope.</span></span> <span data-ttu-id="a5c0a-152">Se tale registrazione non riesce, prova a eseguirla nei successivi ambiti di livello più alto finché l'operazione non riesce.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-152">If the provider cannot register at the narrowest scope, it tries to register at successively higher scopes until a registration finally succeeds.</span></span> <span data-ttu-id="a5c0a-153">Se l'esito dell'operazione è ancora negativo dopo aver raggiunto l'ambito di livello più alto, ovvero il livello del server, restituisce un errore al consumer.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-153">If it reaches the highest scope the server-level) and fails, it returns an error to the consumer.</span></span>  
  
 <span data-ttu-id="a5c0a-154">Se, ad esempio, si specifica DatabaseName =**'** AdventureWorks **'** nella clausola WHERE, il provider prova a registrare una notifica degli eventi nel [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-154">For example, if DatabaseName=**'** AdventureWorks **'** is specified in the WHERE clause, the provider tries to register an event notification in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="a5c0a-155">Se il database [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] esiste e il client chiamante dispone delle autorizzazioni necessarie per creare una notifica degli eventi in [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], la registrazione riesce.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-155">If the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database exists and the calling client has the required permissions to create an event notification in [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], the registration is successful.</span></span> <span data-ttu-id="a5c0a-156">In caso contrario, viene eseguito un tentativo di registrazione della notifica degli eventi a livello di server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-156">Otherwise, an attempt is made to register the event notification at the server level.</span></span> <span data-ttu-id="a5c0a-157">La registrazione riesce se il client WMI dispone delle autorizzazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-157">The registration succeeds if the WMI client has the required permissions.</span></span> <span data-ttu-id="a5c0a-158">In questo scenario, tuttavia, gli eventi non vengono restituiti al client finché il database [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] non sarà stato creato.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-158">However, under this scenario, events are not returned to the client until the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database has been created.</span></span>  
  
 <span data-ttu-id="a5c0a-159">Il *where_condition* può fungere anche da filtro per limitare ulteriormente la query a un database, uno schema o un oggetto specifico.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-159">The *where_condition* can also act as a filter to additionally limit the query to a specific database, schema, or object.</span></span> <span data-ttu-id="a5c0a-160">Si consideri, ad esempio, la query WQL seguente:</span><span class="sxs-lookup"><span data-stu-id="a5c0a-160">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
 <span data-ttu-id="a5c0a-161">A seconda del risultato del processo di registrazione, questa query WQL può essere registrata a livello di database o di server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-161">Depending on the outcome of the registration process, this WQL query may be registered either at the database or server level.</span></span> <span data-ttu-id="a5c0a-162">Anche se viene registrata a livello di server, tuttavia, il provider alla fine filtra gli eventi `ALTER_TABLE` che non sono applicabili alla tabella `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-162">However, even if it is registered at the server level, the provider ultimately filters any `ALTER_TABLE` events that do not apply to the `AdventureWorks.Sales.SalesOrderDetail` table.</span></span> <span data-ttu-id="a5c0a-163">In altre parole, il provider restituisce solo le proprietà degli eventi `ALTER_TABLE` che si verificano in quella tabella specifica.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-163">In other words, the provider returns only the properties of the `ALTER_TABLE` events that occur on that specific table.</span></span>  
  
 <span data-ttu-id="a5c0a-164">Se si specifica un'espressione composta, ad esempio `DatabaseName='AW1'` OR `DatabaseName='AW2'`, viene effettuato il tentativo di registrare una singola notifica degli eventi nell'ambito server anziché due notifiche degli eventi separate.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-164">If a compound expression such as `DatabaseName='AW1'` OR `DatabaseName='AW2'` is specified, an attempt is made to register a single event notification at the server scope instead of two separate event notifications.</span></span> <span data-ttu-id="a5c0a-165">La registrazione riesce se il client chiamante dispone di autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-165">The registration succeeds if the calling client has permissions.</span></span>  
  
 <span data-ttu-id="a5c0a-166">Se `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` tutti gli oggetti sono specificati nella `WHERE` clausola, viene effettuato un tentativo di registrare la notifica degli eventi direttamente sull'oggetto `Z` nello schema `X` .</span><span class="sxs-lookup"><span data-stu-id="a5c0a-166">If `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` are all specified in the `WHERE` clause, an attempt is made to register the event notification directly on object `Z` in schema `X`.</span></span> <span data-ttu-id="a5c0a-167">La registrazione riesce se il client dispone di autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-167">The registration succeeds if the client has permissions.</span></span> <span data-ttu-id="a5c0a-168">Si noti che attualmente gli eventi a livello di oggetto sono supportati solo nelle code e solo per il *event_type*QUEUE_ACTIVATION.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-168">Note that currently, object-level events are supported only on queues, and only for the QUEUE_ACTIVATION *event_type*.</span></span>  
  
 <span data-ttu-id="a5c0a-169">Notare che non tutti gli eventi possono essere sottoposti a query in qualsiasi ambito specifico.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-169">Note that not all events can be queried at any particular scope.</span></span> <span data-ttu-id="a5c0a-170">Una query WQL su un evento di traccia quale Lock_Deadlock o un gruppo di eventi di traccia quale TRC_LOCKS può essere, ad esempio, registrata solo a livello di server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-170">For example, a WQL query on a trace event such as Lock_Deadlock, or a trace event group such as TRC_LOCKS, can only be registered at the server level.</span></span> <span data-ttu-id="a5c0a-171">Analogamente, anche l'evento CREATE_ENDPOINT e il gruppo di eventi DDL_ENDPOINT_EVENTS possono essere registrati solo a livello di server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-171">Similarly, the CREATE_ENDPOINT event and the DDL_ENDPOINT_EVENTS event group can also be registered only at the server level.</span></span> <span data-ttu-id="a5c0a-172">Per ulteriori informazioni sull'ambito appropriato per la registrazione degli eventi, vedere [progettazione di notifiche degli eventi](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="a5c0a-172">For more information about the appropriate scope for registering events, see [Designing Event Notifications](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span></span> <span data-ttu-id="a5c0a-173">Il tentativo di registrare una query WQL il cui *event_type* può essere registrato solo a livello di server viene sempre eseguito a livello di server.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-173">An attempt to register a WQL query whose *event_type* can only be registered at the server level is always made at the server level.</span></span> <span data-ttu-id="a5c0a-174">La registrazione riesce se il client WMI dispone di autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-174">Registration succeeds if the WMI client has permissions.</span></span> <span data-ttu-id="a5c0a-175">In caso contrario, al client viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-175">Otherwise, an error is returned to the client.</span></span> <span data-ttu-id="a5c0a-176">In alcuni casi, tuttavia, è ancora possibile utilizzare la clausola WHERE come filtro per gli eventi a livello di server in base alle proprietà che corrispondono all'evento.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-176">In some cases, however, you can still use the WHERE clause as a filter for server-level events based on the properties that correspond to the event.</span></span> <span data-ttu-id="a5c0a-177">Molti eventi di traccia includono, ad esempio, una proprietà `DatabaseName` che può essere utilizzata nella clausola WHERE come filtro.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-177">For example, many trace events have a `DatabaseName` property that can be used in the WHERE clause as a filter.</span></span>  
  
 <span data-ttu-id="a5c0a-178">Le notifiche degli eventi con ambito server vengono create nel database **Master** e possono essere sottoposte a query per i metadati utilizzando la vista del catalogo [sys. server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="a5c0a-178">Server-scoped event notifications are created in the **master** database and can be queried for metadata by using the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view.</span></span>  
  
 <span data-ttu-id="a5c0a-179">Le notifiche degli eventi con ambito database o oggetto vengono create nel database specificato e possono essere sottoposte a query per i metadati utilizzando la vista del catalogo [sys. event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="a5c0a-179">Database-scoped or object-scoped event notifications are created in the specified database and can be queried for metadata by using the [sys.event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) catalog view.</span></span> <span data-ttu-id="a5c0a-180">È necessario anteporre alla vista del catalogo il nome del database corrispondente.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-180">(You must prefix the catalog view with the corresponding database name.)</span></span>  
  
## <a name="examples"></a><span data-ttu-id="a5c0a-181">Esempi</span><span class="sxs-lookup"><span data-stu-id="a5c0a-181">Examples</span></span>  
  
### <a name="a-querying-for-events-at-the-server-scope"></a><span data-ttu-id="a5c0a-182">R.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-182">A.</span></span> <span data-ttu-id="a5c0a-183">Query su eventi nell'ambito server</span><span class="sxs-lookup"><span data-stu-id="a5c0a-183">Querying for events at the server scope</span></span>  
 <span data-ttu-id="a5c0a-184">Nella query WQL seguente vengono recuperate tutte le proprietà di evento per qualsiasi evento di traccia `SERVER_MEMORY_CHANGE` che si verifica sull'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a5c0a-184">The following WQL query retrieves all event properties for any `SERVER_MEMORY_CHANGE` trace event that occurs on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
```  
SELECT * FROM SERVER_MEMORY_CHANGE  
```  
  
### <a name="b-querying-for-events-at-the-database-scope"></a><span data-ttu-id="a5c0a-185">B.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-185">B.</span></span> <span data-ttu-id="a5c0a-186">Query su eventi nell'ambito database</span><span class="sxs-lookup"><span data-stu-id="a5c0a-186">Querying for events at the database scope</span></span>  
 <span data-ttu-id="a5c0a-187">Nella query WQL seguente vengono recuperate proprietà di evento specifiche per qualsiasi evento che si verifica nel database `AdventureWorks` ed è incluso nel gruppo di eventi `DDL_DATABASE_LEVEL_EVENTS`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-187">The following WQL query retrieves specific event properties for any event that occurs in the `AdventureWorks` database and exists under the `DDL_DATABASE_LEVEL_EVENTS` event group.</span></span>  
  
```  
SELECT SPID, SQLInstance, DatabaseName FROM DDL_DATABASE_LEVEL_EVENTS   
WHERE DatabaseName = 'AdventureWorks'   
```  
  
### <a name="c-querying-for-events-at-the-database-scope-filtering-by-schema-and-object"></a><span data-ttu-id="a5c0a-188">C.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-188">C.</span></span> <span data-ttu-id="a5c0a-189">Query su eventi nell'ambito database mediante l'applicazione di un filtro per schema e per oggetto</span><span class="sxs-lookup"><span data-stu-id="a5c0a-189">Querying for events at the database scope, filtering by schema and object</span></span>  
 <span data-ttu-id="a5c0a-190">Nella query seguente vengono recuperate tutte le proprietà di evento per qualsiasi evento `ALTER_TABLE` che si verifica nella tabella `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="a5c0a-190">The following query retrieves all event properties for any `ALTER_TABLE` event that occurs on table `AdventureWorks.Sales.SalesOrderDetail`.</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
## <a name="see-also"></a><span data-ttu-id="a5c0a-191">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a5c0a-191">See Also</span></span>  
 <span data-ttu-id="a5c0a-192">[Concetti relativi al provider WMI per eventi del server](https://technet.microsoft.com/library/ms180560.aspx) </span><span class="sxs-lookup"><span data-stu-id="a5c0a-192">[WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx) </span></span>  
 [<span data-ttu-id="a5c0a-193">Notifiche degli eventi (Motore di database)</span><span class="sxs-lookup"><span data-stu-id="a5c0a-193">Event Notifications (Database Engine)</span></span>](https://technet.microsoft.com/library/ms182602.aspx)  
  
  
