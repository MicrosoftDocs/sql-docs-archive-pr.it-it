---
title: Creare server collegati (motore di database di SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 11/20/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- sql12.swb.linkedserver.properties.general.f1
- sql12.swb.linkedserver.properties.security.f1
- sql12.swb.linkedserver.properties.provider.f1
- sql12.swb.linkedserver.properties.options.f1
helpviewer_keywords:
- linked servers [SQL Server], creating
ms.assetid: 3228065d-de8f-4ece-a9b1-e06d3dca9310
author: stevestein
ms.author: sstein
ms.openlocfilehash: 6b28468db1024a9789364e5b6e5c115cba71fa9f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714355"
---
# <a name="create-linked-servers-sql-server-database-engine"></a><span data-ttu-id="380d6-102">Creazione di server collegati (Motore di database di SQL Server)</span><span class="sxs-lookup"><span data-stu-id="380d6-102">Create Linked Servers (SQL Server Database Engine)</span></span>
  <span data-ttu-id="380d6-103">In questo argomento viene illustrato come creare un server collegato e come accedere ai dati da un'altra istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tramite [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="380d6-103">This topic shows how to create a linked server and access data from another [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="380d6-104">La creazione di server collegati consente di utilizzare dati di più origini.</span><span class="sxs-lookup"><span data-stu-id="380d6-104">By creating a linked server,  you can work with data from multiple sources.</span></span> <span data-ttu-id="380d6-105">Il server collegato non deve essere un'altra istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], tuttavia si tratta di uno scenario comune.</span><span class="sxs-lookup"><span data-stu-id="380d6-105">The linked server does not have to be another instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but that is a common scenario.</span></span>  
  
##  <a name="background"></a><a name="Background"></a> <span data-ttu-id="380d6-106">Background</span><span class="sxs-lookup"><span data-stu-id="380d6-106">Background</span></span>  
 <span data-ttu-id="380d6-107">il quale consente l'accesso a query distribuite ed eterogenee in origini dati OLE DB.</span><span class="sxs-lookup"><span data-stu-id="380d6-107">A linked server allows for access to distributed, heterogeneous queries against OLE DB data sources.</span></span> <span data-ttu-id="380d6-108">Dopo aver creato un server collegato, le query distribuite possono essere eseguite in questo server e consentono di creare un join di tabelle provenienti da più origini dati.</span><span class="sxs-lookup"><span data-stu-id="380d6-108">After a linked server is created, distributed queries can be run against this server, and queries can join tables from more than one data source.</span></span> <span data-ttu-id="380d6-109">Se il server collegato viene definito come un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], è possibile eseguire stored procedure remote.</span><span class="sxs-lookup"><span data-stu-id="380d6-109">If the linked server is defined as an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], remote stored procedures can be executed.</span></span>  
  
 <span data-ttu-id="380d6-110">Le funzionalità e gli argomenti obbligatori del server collegato possono variare in modo significativo.</span><span class="sxs-lookup"><span data-stu-id="380d6-110">The capabilities and required arguments of the linked server can vary significantly.</span></span> <span data-ttu-id="380d6-111">Tra gli esempi contenuti in questo argomento ne viene fornito uno tipico nel quale però non sono descritte tutte le opzioni.</span><span class="sxs-lookup"><span data-stu-id="380d6-111">The examples in this topic provide a typical example but all options are not described.</span></span> <span data-ttu-id="380d6-112">Per altre informazioni, vedere [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="380d6-112">For more information, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
##  <a name="security"></a><a name="Security"></a> <span data-ttu-id="380d6-113">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="380d6-113">Security</span></span>  
  
### <a name="permissions"></a><span data-ttu-id="380d6-114">Autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="380d6-114">Permissions</span></span>  
 <span data-ttu-id="380d6-115">Quando si usano le [!INCLUDE[tsql](../../includes/tsql-md.md)] istruzioni, è richiesta l' `ALTER ANY LINKED SERVER` autorizzazione per il server o l'appartenenza al ruolo predefinito del server **setupadmin** .</span><span class="sxs-lookup"><span data-stu-id="380d6-115">When using [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, requires `ALTER ANY LINKED SERVER` permission on the server or membership in the **setupadmin** fixed server role.</span></span> <span data-ttu-id="380d6-116">Quando si utilizza è [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] richiesta `CONTROL SERVER` l'autorizzazione o l'appartenenza al ruolo predefinito del server **sysadmin** .</span><span class="sxs-lookup"><span data-stu-id="380d6-116">When using [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] requires `CONTROL SERVER` permission or membership in the **sysadmin** fixed server role.</span></span>  
  
##  <a name="how-to-create-a-linked-server"></a><a name="Procedures"></a> <span data-ttu-id="380d6-117">Come creare un server collegato</span><span class="sxs-lookup"><span data-stu-id="380d6-117">How to Create a Linked Server</span></span>  
 <span data-ttu-id="380d6-118">È possibile utilizzare uno degli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="380d6-118">You can use any of the following:</span></span>  
  
-   [<span data-ttu-id="380d6-119">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="380d6-119">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
-   [<span data-ttu-id="380d6-120">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="380d6-120">Transact-SQL</span></span>](#TsqlProcedure)  
  
###  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="380d6-121">Con SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="380d6-121">Using SQL Server Management Studio</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-sql-server-management-studio"></a><span data-ttu-id="380d6-122">Per creare un server collegato a un'altra istanza di SQL Server tramite SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="380d6-122">To create a linked server to another instance of SQL Server Using SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="380d6-123">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]aprire Esplora oggetti, espandere **Oggetti server**, fare clic con il pulsante destro del mouse su **Server collegati**, quindi **Nuovo server collegato**.</span><span class="sxs-lookup"><span data-stu-id="380d6-123">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], open Object Explorer, expand **Server Objects**, right-click **Linked Servers**, and then click **New Linked Server**.</span></span>  
  
2.  <span data-ttu-id="380d6-124">Nella casella **Server collegato** della pagina **Generale** digitare il nome dell'istanza di **SQL Server** a cui si sta eseguendo il collegamento.</span><span class="sxs-lookup"><span data-stu-id="380d6-124">On the **General** page, in the **Linked server** box, type the name of the instance of **SQL Server** that you area linking to.</span></span>  
  
     <span data-ttu-id="380d6-125">**SQL Server**</span><span class="sxs-lookup"><span data-stu-id="380d6-125">**SQL Server**</span></span>  
     <span data-ttu-id="380d6-126">Consente di identificare il server collegato come istanza di [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="380d6-126">Identify the linked server as an instance of [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="380d6-127">Se per definire un server [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collegato si utilizza questo metodo, il nome specificato in **Server collegato** deve essere quello di rete del server.</span><span class="sxs-lookup"><span data-stu-id="380d6-127">If you use this method of defining a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] linked server, the name specified in **Linked server** must be the network name of the server.</span></span> <span data-ttu-id="380d6-128">Inoltre, le eventuali tabelle recuperate dal server provengono dal database predefinito impostato per l'account di accesso del server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-128">Also, any tables retrieved from the server are from the default database defined for the login on the linked server.</span></span>  
  
     <span data-ttu-id="380d6-129">**Altra origine dati**</span><span class="sxs-lookup"><span data-stu-id="380d6-129">**Other data source**</span></span>  
     <span data-ttu-id="380d6-130">Specificare un tipo di server OLE DB diverso da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="380d6-130">Specify an OLE DB server type other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="380d6-131">La selezione di questa opzione determina l'attivazione delle opzioni sottostanti.</span><span class="sxs-lookup"><span data-stu-id="380d6-131">Clicking this option activates the options below it.</span></span>  
  
     <span data-ttu-id="380d6-132">**Provider**</span><span class="sxs-lookup"><span data-stu-id="380d6-132">**Provider**</span></span>  
     <span data-ttu-id="380d6-133">Consente di selezionare un'origine dati OLE DB nella casella di riepilogo.</span><span class="sxs-lookup"><span data-stu-id="380d6-133">Select an OLE DB data source from the list box.</span></span> <span data-ttu-id="380d6-134">Il provider OLE DB viene registrato nel Registro di sistema con il valore PROGID specificato.</span><span class="sxs-lookup"><span data-stu-id="380d6-134">The OLE DB provider is registered with the given PROGID in the registry.</span></span>  
  
     <span data-ttu-id="380d6-135">**Nome prodotto**</span><span class="sxs-lookup"><span data-stu-id="380d6-135">**Product name**</span></span>  
     <span data-ttu-id="380d6-136">Consente di specificare il nome del prodotto dell'origine dati OLE DB da aggiungere come server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-136">Type the product name of the OLE DB data source to add as a linked server.</span></span>  
  
     <span data-ttu-id="380d6-137">**Origine dati**</span><span class="sxs-lookup"><span data-stu-id="380d6-137">**Data source**</span></span>  
     <span data-ttu-id="380d6-138">Consente di digitare il nome dell'origine dati in base alla modalità di interpretazione del provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="380d6-138">Type the name of the data source as interpreted by the OLE DB provider.</span></span> <span data-ttu-id="380d6-139">Se ci si connette a un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], specificare il nome dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="380d6-139">If you are connecting to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], provide the instance name.</span></span>  
  
     <span data-ttu-id="380d6-140">**Stringa provider**</span><span class="sxs-lookup"><span data-stu-id="380d6-140">**Provider string**</span></span>  
     <span data-ttu-id="380d6-141">Digitare il ProgID univoco del provider OLE DB che corrisponde all'origine dati.</span><span class="sxs-lookup"><span data-stu-id="380d6-141">Type the unique programmatic identifier (PROGID) of the OLE DB provider that corresponds to the data source.</span></span> <span data-ttu-id="380d6-142">Per esempi di stringhe provider valide, vedere [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="380d6-142">For examples of valid provider strings, see [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
     <span data-ttu-id="380d6-143">**Posizione**</span><span class="sxs-lookup"><span data-stu-id="380d6-143">**Location**</span></span>  
     <span data-ttu-id="380d6-144">Digitare la posizione del database secondo la modalità di interpretazione del provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="380d6-144">Type the location of the database as interpreted by the OLE DB provider.</span></span>  
  
     <span data-ttu-id="380d6-145">**Catalogo**</span><span class="sxs-lookup"><span data-stu-id="380d6-145">**Catalog**</span></span>  
     <span data-ttu-id="380d6-146">Digitare il nome del catalogo da utilizzare durante la connessione al provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="380d6-146">Type the name of the catalog to use when making a connection to the OLE DB provider.</span></span>  
  
     <span data-ttu-id="380d6-147">Per verificare la possibilità di eseguire una connessione a un server collegato, in Esplora oggetti fare clic con il pulsante destro del mouse sul server collegato, quindi scegliere **Test connessione**.</span><span class="sxs-lookup"><span data-stu-id="380d6-147">To test the ability to connect to a linked server, in Object Explorer, right-click the linked server and then click **Test Connection**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="380d6-148">Se l'istanza di **SQL Server** è quella predefinita, immettere il nome del computer che ospita l'istanza di **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="380d6-148">If the instance of **SQL Server** is the default instance, enter the name of the computer that hosts the instance of **SQL Server**.</span></span> <span data-ttu-id="380d6-149">Se l'istanza di **SQL Server** è un'istanza denominata, immettere il nome del computer e il nome dell'istanza, ad esempio **Contabilità\SQLExpress**.</span><span class="sxs-lookup"><span data-stu-id="380d6-149">If the **SQL Server** is a named instance, enter the name of the computer and the name of the instance, such as **Accounting\SQLExpress**.</span></span>  
  
3.  <span data-ttu-id="380d6-150">Nell'area **Tipo di server** selezionare **SQL Server** per indicare che il server collegato è un'altra istanza di **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="380d6-150">In the **Server type** area, select **SQL Server** to indicate that the linked server is another instance of **SQL Server**.</span></span>  
  
4.  <span data-ttu-id="380d6-151">Nella pagina **Sicurezza** specificare il contesto di sicurezza che verrà utilizzato quando la connessione al server collegato viene eseguita dall'istanza originale di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-151">On the **Security** page, specify the security context that will be used when the original [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connects to the linked server.</span></span> <span data-ttu-id="380d6-152">In un ambiente di dominio in cui gli utenti eseguono la connessione tramite account di dominio personalizzati, la selezione di **Verranno effettuate con il contesto di sicurezza corrente dell'account di accesso** è spesso la soluzione migliore.</span><span class="sxs-lookup"><span data-stu-id="380d6-152">In a domain environment where users are connecting by using their domain logins, selecting **Be made using the login's current security context** is often the best choice.</span></span> <span data-ttu-id="380d6-153">Quando gli utenti eseguono la connessione all'istanza originale di **SQL Server** utilizzando un account di accesso di **SQL Server** , la scelta ottimale spesso consiste nel selezionare **Verranno effettuate con il contesto di sicurezza seguente**, quindi fornendo le credenziali necessarie per l'autenticazione nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-153">When users connect to the original **SQL Server** by using a **SQL Server** login, the best choice is often to select **By using this security context**, and then providing the necessary credentials to authenticate at the linked server.</span></span>  
  
     <span data-ttu-id="380d6-154">**Account di accesso locale**</span><span class="sxs-lookup"><span data-stu-id="380d6-154">**Local login**</span></span>  
     <span data-ttu-id="380d6-155">Consente di specificare l'ID di accesso locale con cui è possibile connettersi al server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-155">Specify the local login that can connect to the linked server.</span></span> <span data-ttu-id="380d6-156">L'account di accesso locale può essere un account basato sull'autenticazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] o un account basato sull'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="380d6-156">The local login can be either a login using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication or a Windows Authentication login.</span></span> <span data-ttu-id="380d6-157">Utilizzare questo elenco per limitare la connessione a determinati account di accesso o per consentire ad alcuni account di connettersi con un account di accesso diverso.</span><span class="sxs-lookup"><span data-stu-id="380d6-157">Use this list to restrict the connection to specific logins, or to allow some logins to connect as a different login.</span></span>  
  
     <span data-ttu-id="380d6-158">**Impersonate**</span><span class="sxs-lookup"><span data-stu-id="380d6-158">**Impersonate**</span></span>  
     <span data-ttu-id="380d6-159">Consente di passare il nome utente e la password dall'account di accesso locale al server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-159">Pass the username and password from the local login to the linked server.</span></span> <span data-ttu-id="380d6-160">Nel caso dell'autenticazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , è necessario che nel server remoto esista un account di accesso con un nome e una password identici.</span><span class="sxs-lookup"><span data-stu-id="380d6-160">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, a login with the exact same name and password must exist on the remote server.</span></span> <span data-ttu-id="380d6-161">Nel caso degli account di accesso Windows, è necessario che l'account di accesso sia valido nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-161">For Windows logins, the login must be a valid login on the linked server.</span></span>  
  
     <span data-ttu-id="380d6-162">Per utilizzare la funzionalità di rappresentazione, è indispensabile che la configurazione risponda ai requisiti per la delega.</span><span class="sxs-lookup"><span data-stu-id="380d6-162">To use impersonation, the configuration must meet the requirement for delegation.</span></span>  
  
     <span data-ttu-id="380d6-163">**Utente remoto**</span><span class="sxs-lookup"><span data-stu-id="380d6-163">**Remote User**</span></span>  
     <span data-ttu-id="380d6-164">Usare l'utente remoto per eseguire il mapping di utenti non definiti in **Account di accesso locale**.</span><span class="sxs-lookup"><span data-stu-id="380d6-164">Use the remote user to map users not defined in **Local login**.</span></span> <span data-ttu-id="380d6-165">L' **Utente remoto** deve essere un account di accesso basato sull'autenticazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nel server remoto.</span><span class="sxs-lookup"><span data-stu-id="380d6-165">The **Remote User** must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
     <span data-ttu-id="380d6-166">**Password remota**</span><span class="sxs-lookup"><span data-stu-id="380d6-166">**Remote Password**</span></span>  
     <span data-ttu-id="380d6-167">Consente di specificare la password dell'Utente remoto.</span><span class="sxs-lookup"><span data-stu-id="380d6-167">Specify the password of the Remote User.</span></span>  
  
     <span data-ttu-id="380d6-168">**Aggiungere**</span><span class="sxs-lookup"><span data-stu-id="380d6-168">**Add**</span></span>  
     <span data-ttu-id="380d6-169">Consente di aggiungere un nuovo account di accesso locale.</span><span class="sxs-lookup"><span data-stu-id="380d6-169">Add a new local login.</span></span>  
  
     <span data-ttu-id="380d6-170">**Rimuovi**</span><span class="sxs-lookup"><span data-stu-id="380d6-170">**Remove**</span></span>  
     <span data-ttu-id="380d6-171">Consente di rimuovere un account di accesso locale esistente.</span><span class="sxs-lookup"><span data-stu-id="380d6-171">Remove an existing local login.</span></span>  
  
     <span data-ttu-id="380d6-172">**Non verranno effettuate**</span><span class="sxs-lookup"><span data-stu-id="380d6-172">**Not be made**</span></span>  
     <span data-ttu-id="380d6-173">Consente di specificare che non verrà effettuata una connessione per gli account di accesso non definiti nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="380d6-173">Specify that a connection will not be made for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="380d6-174">**Verranno effettuate senza un contesto di sicurezza**</span><span class="sxs-lookup"><span data-stu-id="380d6-174">**Be made without using a security context**</span></span>  
     <span data-ttu-id="380d6-175">Consente di specificare che verrà effettuata una connessione senza un contesto di sicurezza per gli account di accesso non definiti nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="380d6-175">Specify that a connection will be made without using a security context for logins not defined in the list.</span></span>  
  
     <span data-ttu-id="380d6-176">**Verranno effettuate con il contesto di sicurezza corrente dell'account di accesso**</span><span class="sxs-lookup"><span data-stu-id="380d6-176">**Be made using the login's current security context**</span></span>  
     <span data-ttu-id="380d6-177">Consente di specificare che verrà effettuata una connessione con il contesto di sicurezza corrente dell'account di accesso per gli account di accesso non definiti nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="380d6-177">Specify that a connection will be made using the current security context of the login for logins not defined in the list.</span></span> <span data-ttu-id="380d6-178">Se la connessione al server locale è stata effettuata utilizzando l'autenticazione di Windows, per la connessione al server remoto verranno utilizzate le credenziali di Windows.</span><span class="sxs-lookup"><span data-stu-id="380d6-178">If connected to the local server using Windows Authentication, your windows credentials will be used to connect to the remote server.</span></span> <span data-ttu-id="380d6-179">Se la connessione al server locale è stata effettuata utilizzando l'autenticazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , per la connessione al server remoto verranno utilizzati il nome e la password dell'account di accesso.</span><span class="sxs-lookup"><span data-stu-id="380d6-179">If connected to the local server using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication, login name and password will be used to connect to the remote server.</span></span> <span data-ttu-id="380d6-180">In tal caso, è necessario che nel server remoto esista un account di accesso con un nome e una password identici.</span><span class="sxs-lookup"><span data-stu-id="380d6-180">In this case a login with the exact same name and password must exist on the remote server.</span></span>  
  
     <span data-ttu-id="380d6-181">**Verranno effettuate con il contesto di sicurezza seguente**</span><span class="sxs-lookup"><span data-stu-id="380d6-181">**Be made using this security context**</span></span>  
     <span data-ttu-id="380d6-182">Consente di specificare che verrà effettuata una connessione utilizzando l'account di accesso e la password specificati in **Account di accesso remoto** e **Password** per gli account di accesso non definiti nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="380d6-182">Specify that a connection will be made using the login and password specified in the **Remote login** and **With password** boxes for logins not defined in the list.</span></span> <span data-ttu-id="380d6-183">L'account di accesso remoto deve essere un account di accesso basato sull'autenticazione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nel server remoto.</span><span class="sxs-lookup"><span data-stu-id="380d6-183">The remote login must be a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication login on the remote server.</span></span>  
  
5.  <span data-ttu-id="380d6-184">Facoltativamente, visualizzare o specificare opzioni server, fare clic sulla pagina **Opzioni server**  .</span><span class="sxs-lookup"><span data-stu-id="380d6-184">Optionally, to view or specify server options, click the **Server Options**  page.</span></span>  
  
     <span data-ttu-id="380d6-185">**Regole di confronto compatibili**</span><span class="sxs-lookup"><span data-stu-id="380d6-185">**Collation Compatible**</span></span>  
     <span data-ttu-id="380d6-186">Influisce sull'esecuzione delle query distribuite in server collegati.</span><span class="sxs-lookup"><span data-stu-id="380d6-186">Affects Distributed Query execution against linked servers.</span></span> <span data-ttu-id="380d6-187">Se questa opzione è impostata su true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] considera tutti i caratteri del server collegato compatibili con il server locale, relativamente al set di caratteri e alla sequenza delle regole di confronto oppure al tipo di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="380d6-187">If this option is set to true, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] assumes that all characters in the linked server are compatible with the local server, with regard to character set and collation sequence (or sort order).</span></span> <span data-ttu-id="380d6-188">Ciò consente a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di inviare al provider i confronti per colonne di tipo carattere.</span><span class="sxs-lookup"><span data-stu-id="380d6-188">This enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send comparisons on character columns to the provider.</span></span> <span data-ttu-id="380d6-189">Se questa opzione non è impostata, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] valuta sempre i confronti per le colonne di tipo carattere localmente.</span><span class="sxs-lookup"><span data-stu-id="380d6-189">If this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] always evaluates comparisons on character columns locally.</span></span>  
  
     <span data-ttu-id="380d6-190">Impostare questa opzione solo se nell'origine dei dati corrispondente al server collegato il set di caratteri e il tipo di ordinamento corrispondono a quelli del server locale.</span><span class="sxs-lookup"><span data-stu-id="380d6-190">This option should be set only if it is certain that the data source corresponding to the linked server has the same character set and sort order as the local server.</span></span>  
  
     <span data-ttu-id="380d6-191">**Accesso ai dati**</span><span class="sxs-lookup"><span data-stu-id="380d6-191">**Data Access**</span></span>  
     <span data-ttu-id="380d6-192">Consente di attivare e disabilitare un server collegato per l'accesso a query distribuite.</span><span class="sxs-lookup"><span data-stu-id="380d6-192">Enables and disables a linked server for distributed query access.</span></span>  
  
     <span data-ttu-id="380d6-193">**RPC**</span><span class="sxs-lookup"><span data-stu-id="380d6-193">**RPC**</span></span>  
     <span data-ttu-id="380d6-194">Attiva l'esecuzione di chiamate RPC dal server specificato.</span><span class="sxs-lookup"><span data-stu-id="380d6-194">Enables RPC from the specified server.</span></span>  
  
     <span data-ttu-id="380d6-195">**Chiamate RPC in uscita**</span><span class="sxs-lookup"><span data-stu-id="380d6-195">**RPC Out**</span></span>  
     <span data-ttu-id="380d6-196">Viene abilitata l'esecuzione di chiamate RPC al server specificato.</span><span class="sxs-lookup"><span data-stu-id="380d6-196">Enables RPC to the specified server.</span></span>  
  
     <span data-ttu-id="380d6-197">**Usa regole di confronto remote**</span><span class="sxs-lookup"><span data-stu-id="380d6-197">**Use Remote Collation**</span></span>  
     <span data-ttu-id="380d6-198">Determina se vengono utilizzate le regole di confronto di una colonna remota o di un server locale.</span><span class="sxs-lookup"><span data-stu-id="380d6-198">Determines whether the collation of a remote column or of a local server will be used.</span></span>  
  
     <span data-ttu-id="380d6-199">Se è true, per le origini dei dati di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] vengono adottate le regole di confronto delle colonne remote, mentre le regole di confronto specificate nel nome delle regole di confronto vengono utilizzate per origini dei dati diverse da[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-199">If true, the collation of remote columns is used for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources, and the collation specified in collation name is used for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data sources.</span></span>  
  
     <span data-ttu-id="380d6-200">Se è false, per le query distribuite vengono sempre utilizzate le regole di confronto predefinite del server locale, mentre il nome delle regole di confronto e le regole di confronto delle colonne remote vengono ignorati.</span><span class="sxs-lookup"><span data-stu-id="380d6-200">If false, distributed queries will always use the default collation of the local server, while collation name and the collation of remote columns are ignored.</span></span> <span data-ttu-id="380d6-201">Il valore predefinito è false.</span><span class="sxs-lookup"><span data-stu-id="380d6-201">The default is false.</span></span>  
  
     <span data-ttu-id="380d6-202">**Nome regole di confronto**</span><span class="sxs-lookup"><span data-stu-id="380d6-202">**Collation Name**</span></span>  
     <span data-ttu-id="380d6-203">Consente di specificare il nome delle regole di confronto utilizzate dall'origine dei dati remota quando l'opzione Usa regole di confronto remote è true e l'origine dei dati non è un'origine dei dati di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-203">Specifies the name of the collation used by the remote data source if use remote collation is true and the data source is not a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source.</span></span> <span data-ttu-id="380d6-204">È necessario specificare il nome di uno dei set di regole di confronto supportate da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="380d6-204">The name must be one of the collations supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
     <span data-ttu-id="380d6-205">Utilizzare questa opzione per accedere a un'origine dei dati OLE DB diversa da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]che utilizza regole di confronto di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-205">Use this option when accessing an OLE DB data source other than [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but whose collation matches one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="380d6-206">Il server collegato deve supportare regole di confronto singole da utilizzare per tutte le colonne del server.</span><span class="sxs-lookup"><span data-stu-id="380d6-206">The linked server must support a single collation to be used for all columns in that server.</span></span> <span data-ttu-id="380d6-207">Non impostare questa opzione quando il server collegato supporta più regole di confronto nella stessa origine dei dati oppure non è possibile stabilire se le regole di confronto del server collegato corrispondono a una delle regole di confronto di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-207">Do not set this option if the linked server supports multiple collations within a single data source, or if the linked server's collation cannot be determined to match one of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collations.</span></span>  
  
     <span data-ttu-id="380d6-208">**Timeout connessione**</span><span class="sxs-lookup"><span data-stu-id="380d6-208">**Connection Timeout**</span></span>  
     <span data-ttu-id="380d6-209">Valore di timeout espresso in secondi per la connessione al server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-209">Time-out value in seconds for connecting to a linked server.</span></span>  
  
     <span data-ttu-id="380d6-210">Se il valore è 0, usare il valore predefinito **sp_configure** dell'opzione [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="380d6-210">If 0, use the **sp_configure** default [remote login timeout](../../database-engine/configure-windows/configure-the-remote-login-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="380d6-211">**Timeout query**</span><span class="sxs-lookup"><span data-stu-id="380d6-211">**Query Timeout**</span></span>  
     <span data-ttu-id="380d6-212">Valore di timeout espresso in secondi per le query eseguite nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-212">Time-out value in seconds for queries against a linked server.</span></span>  
  
     <span data-ttu-id="380d6-213">Se 0, usare il valore predefinito **sp_configure** dell'opzione [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) .</span><span class="sxs-lookup"><span data-stu-id="380d6-213">If 0, use the **sp_configure** default [remote query timeout](../../database-engine/configure-windows/configure-the-remote-query-timeout-server-configuration-option.md) option value.</span></span>  
  
     <span data-ttu-id="380d6-214">**Abilita promozione delle transazioni distribuite**</span><span class="sxs-lookup"><span data-stu-id="380d6-214">**Enable Promotion of Distributed Transactions**</span></span>  
     <span data-ttu-id="380d6-215">Questa opzione consente di proteggere le azioni di una procedura da server a server tramite una transazione MS DTC ( [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator).</span><span class="sxs-lookup"><span data-stu-id="380d6-215">Use this option to protect the actions of a server-to-server procedure through a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MS DTC) transaction.</span></span> <span data-ttu-id="380d6-216">Quando questa opzione è impostata su TRUE, la chiamata di una stored procedure remota comporta l'avvio di una transazione distribuita e l'integrazione della transazione in MS DTC.</span><span class="sxs-lookup"><span data-stu-id="380d6-216">When this option is TRUE, calling a remote stored procedure starts a distributed transaction and enlists the transaction with MS DTC.</span></span> <span data-ttu-id="380d6-217">Per altre informazioni, vedere [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="380d6-217">For more information, see [sp_serveroption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql).</span></span>  
  
6.  <span data-ttu-id="380d6-218">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="380d6-218">Click **OK**.</span></span>  
  
##### <a name="to-view-the-provider-options"></a><span data-ttu-id="380d6-219">Per visualizzare le opzioni del provider</span><span class="sxs-lookup"><span data-stu-id="380d6-219">To view the provider options</span></span>  
  
-   <span data-ttu-id="380d6-220">Per visualizzare le opzioni rese disponibili dal provider, fare clic sulla pagina **Opzioni provider** .</span><span class="sxs-lookup"><span data-stu-id="380d6-220">To view the options that the provider makes available, click the **Providers Options** page.</span></span>  
  
     <span data-ttu-id="380d6-221">Non tutti i provider dispongono delle stesse opzioni.</span><span class="sxs-lookup"><span data-stu-id="380d6-221">All providers do not have the same options available.</span></span> <span data-ttu-id="380d6-222">Ad esempio, alcuni tipi di dati, a differenza di altri, dispongono di indici.</span><span class="sxs-lookup"><span data-stu-id="380d6-222">For example, some types of data have indexes available and some might not.</span></span> <span data-ttu-id="380d6-223">Utilizzare questa finestra di dialogo per consentire a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di capire le funzionalità del provider.</span><span class="sxs-lookup"><span data-stu-id="380d6-223">Use this dialog box to help [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] understand the capabilities of the provider.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="380d6-224">installa alcuni provider di dati comuni; tuttavia, quando il prodotto che fornisce i dati cambia, il provider installato da [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] potrebbe non supportare tutte le funzionalità nuove.</span><span class="sxs-lookup"><span data-stu-id="380d6-224">installs some common data providers, however when the product providing the data changes, the provider installed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might not support all the newest features.</span></span> <span data-ttu-id="380d6-225">La migliore fonte di informazioni sulle funzionalità del prodotto che fornisce i dati è la documentazione di quel prodotto.</span><span class="sxs-lookup"><span data-stu-id="380d6-225">The best source of information about the capabilities of the product providing the data is the documentation for that product.</span></span>  
  
     <span data-ttu-id="380d6-226">**Parametro dinamico**</span><span class="sxs-lookup"><span data-stu-id="380d6-226">**Dynamic parameter**</span></span>  
     <span data-ttu-id="380d6-227">Indica che il provider consente l'utilizzo della sintassi con il marcatore di parametro "?" nel caso di query con parametri.</span><span class="sxs-lookup"><span data-stu-id="380d6-227">Indicates that the provider allows '?' parameter marker syntax for parameterized queries.</span></span> <span data-ttu-id="380d6-228">Impostare questa opzione solo se il provider supporta l'interfaccia **ICommandWithParameters** e "?" come marcatore di parametro.</span><span class="sxs-lookup"><span data-stu-id="380d6-228">Set this option only if the provider supports the **ICommandWithParameters** interface and supports a '?' as the parameter marker.</span></span> <span data-ttu-id="380d6-229">L'impostazione di questa opzione consente a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di eseguire query con parametri sul provider.</span><span class="sxs-lookup"><span data-stu-id="380d6-229">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute parameterized queries against the provider.</span></span> <span data-ttu-id="380d6-230">In determinati casi, la possibilità di eseguire query con parametri sul provider può determinare un miglioramento delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="380d6-230">The ability to execute parameterized queries against the provider can result in better performance for certain queries.</span></span>  
  
     <span data-ttu-id="380d6-231">**Query nidificate**</span><span class="sxs-lookup"><span data-stu-id="380d6-231">**Nested queries**</span></span>  
     <span data-ttu-id="380d6-232">Indica che il provider supporta le istruzioni  `SELECT` nidificate nella clausola FROM.</span><span class="sxs-lookup"><span data-stu-id="380d6-232">Indicates that the provider allows nested  `SELECT` statements in the FROM clause.</span></span> <span data-ttu-id="380d6-233">L'impostazione di questa opzione consente a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] di delegare al provider le query che richiedono la nidificazione di istruzioni SELECT nella clausola FROM.</span><span class="sxs-lookup"><span data-stu-id="380d6-233">Setting this option allows [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to delegate certain queries to the provider that require nesting SELECT statements in the FROM clause.</span></span>  
  
     <span data-ttu-id="380d6-234">**Solo livello zero**</span><span class="sxs-lookup"><span data-stu-id="380d6-234">**Level zero only**</span></span>  
     <span data-ttu-id="380d6-235">Indica che sul provider vengono richiamate solo le interfacce OLE DB di livello 0.</span><span class="sxs-lookup"><span data-stu-id="380d6-235">Only level 0 OLE DB interfaces are invoked against the provider.</span></span>  
  
     <span data-ttu-id="380d6-236">**Consenti in-process**</span><span class="sxs-lookup"><span data-stu-id="380d6-236">**Allow inprocess**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="380d6-237">consente la creazione di un'istanza del provider come server in-process.</span><span class="sxs-lookup"><span data-stu-id="380d6-237">allows the provider to be instantiated as an in-process server.</span></span> <span data-ttu-id="380d6-238">Se questa opzione non viene impostata, per impostazione predefinita viene creata un'istanza del provider al di fuori del processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="380d6-238">When this option is not set, the default behavior is to instantiate the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="380d6-239">La creazione di un'istanza del provider al di fuori del processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] consente di proteggere il processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dagli errori che si verificano nel provider.</span><span class="sxs-lookup"><span data-stu-id="380d6-239">Instantiating the provider outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process protects the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process from errors in the provider.</span></span> <span data-ttu-id="380d6-240">Quando l'istanza del provider viene creata al di fuori del processo di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], gli aggiornamenti o gli inserimenti che fanno riferimento a colonne per valori di grandi dimensioni (`text`, `ntext` o `image`) non sono consentiti.</span><span class="sxs-lookup"><span data-stu-id="380d6-240">When the provider is instantiated outside the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process, updates or inserts referencing long columns (`text`, `ntext`, or `image`) are not allowed.</span></span>  
  
     <span data-ttu-id="380d6-241">**Aggiornamenti non in transazioni**</span><span class="sxs-lookup"><span data-stu-id="380d6-241">**Non transacted updates**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="380d6-242">consente gli aggiornamenti anche se **ITransactionLocal** non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="380d6-242">allows updates, even if **ITransactionLocal** is not available.</span></span> <span data-ttu-id="380d6-243">Se questa opzione è abilitata, gli aggiornamenti sul provider non sono recuperabili poiché il provider non supporta le transazioni.</span><span class="sxs-lookup"><span data-stu-id="380d6-243">If this option is enabled, updates against the provider are not recoverable, because the provider does not support transactions.</span></span>  
  
     <span data-ttu-id="380d6-244">**Indici come percorso di accesso**</span><span class="sxs-lookup"><span data-stu-id="380d6-244">**Index as access path**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="380d6-245">tenta di usare gli indici del provider per recuperare i dati.</span><span class="sxs-lookup"><span data-stu-id="380d6-245">attempts to use indexes of the provider to fetch data.</span></span> <span data-ttu-id="380d6-246">Per impostazione predefinita, gli indici vengono utilizzati solo per i metadati e non vengono mai aperti</span><span class="sxs-lookup"><span data-stu-id="380d6-246">By default, indexes are used only for metadata and are never opened</span></span>  
  
     <span data-ttu-id="380d6-247">**Accesso ad hoc non consentito**</span><span class="sxs-lookup"><span data-stu-id="380d6-247">**Disallow ad hoc access**</span></span>  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="380d6-248">non consente l'accesso ad hoc tramite le funzioni OPENROWSET e OPENDATASOURCE sul provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="380d6-248">does not allow ad hoc access through the OPENROWSET and OPENDATASOURCE functions against the OLE DB provider.</span></span> <span data-ttu-id="380d6-249">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non consente l'accesso ad hoc anche se questa opzione non è impostata.</span><span class="sxs-lookup"><span data-stu-id="380d6-249">When this option is not set, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] also does not allow ad hoc access.</span></span>  
  
     <span data-ttu-id="380d6-250">**Supporta l'operatore 'Like'**</span><span class="sxs-lookup"><span data-stu-id="380d6-250">**Supports 'Like' operator**</span></span>  
     <span data-ttu-id="380d6-251">Indica che il provider supporta le query che utilizzano la parola chiave LIKE.</span><span class="sxs-lookup"><span data-stu-id="380d6-251">Indicates that the provider supports queries using the LIKE key word.</span></span>  
  
###  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="380d6-252">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="380d6-252">Using Transact-SQL</span></span>  
 <span data-ttu-id="380d6-253">Per creare un server collegato con [!INCLUDE[tsql](../../includes/tsql-md.md)], usare le istruzioni [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) e [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="380d6-253">To create a linked server by using [!INCLUDE[tsql](../../includes/tsql-md.md)], use the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)[CREATE LOGIN &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-login-transact-sql) and [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql) statements.</span></span>  
  
##### <a name="to-create-a-linked-server-to-another-instance-of-sql-server-using-transact-sql"></a><span data-ttu-id="380d6-254">Per creare un server collegato a un'altra istanza di SQL Server tramite Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="380d6-254">To create a linked server to another instance of SQL Server using Transact-SQL</span></span>  
  
1.  <span data-ttu-id="380d6-255">Nell'Editor query immettere il comando [!INCLUDE[tsql](../../includes/tsql-md.md)] seguente per il collegamento a un'istanza di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] denominata `SRVR002\ACCTG`:</span><span class="sxs-lookup"><span data-stu-id="380d6-255">In Query Editor, enter the following [!INCLUDE[tsql](../../includes/tsql-md.md)] command to link to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] named `SRVR002\ACCTG`:</span></span>  
  
    ```sql  
    USE [master]  
    GO  
    EXEC master.dbo.sp_addlinkedserver   
        @server = N'SRVR002\ACCTG',   
        @srvproduct=N'SQL Server' ;  
    GO  
  
    ```  
  
2.  <span data-ttu-id="380d6-256">Eseguire il codice riportato di seguito per configurare il server collegato in modo da utilizzare le credenziali di dominio dell'account di accesso utilizzate dal server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-256">Execute the following code to configure the linked server to use the domain credentials of the login that is using the linked server.</span></span>  
  
    ```sql  
    EXEC master.dbo.sp_addlinkedsrvlogin   
        @rmtsrvname = N'SRVR002\ACCTG',   
        @locallogin = NULL ,   
        @useself = N'True' ;  
    GO  
  
    ```  
  
##  <a name="follow-up-steps-to-take-after-you-create-a-linked-server"></a><a name="FollowUp"></a> <span data-ttu-id="380d6-257">Completamento: passaggi da effettuare dopo aver creato un server collegato</span><span class="sxs-lookup"><span data-stu-id="380d6-257">Follow Up: Steps to take after you create a linked server</span></span>  
  
#### <a name="to-test-the-linked-server"></a><span data-ttu-id="380d6-258">Per testare il server collegato</span><span class="sxs-lookup"><span data-stu-id="380d6-258">To test the linked server</span></span>  
  
-   <span data-ttu-id="380d6-259">Eseguire il codice riportato di seguito per testare la connessione al server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-259">Execute the following code to test the connection to the linked server.</span></span> <span data-ttu-id="380d6-260">In questo esempio vengono restituiti i nomi dei database nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-260">This example the returns the names of the databases on the linked server.</span></span>  
  
    ```sql  
    SELECT name FROM [SRVR002\ACCTG].master.sys.databases ;  
    GO  
  
    ```  
  
#### <a name="writing-a-query-that-joins-tables-from-a-linked-server"></a><span data-ttu-id="380d6-261">Scrittura di una query che consente creare un join di tabelle di un server collegato</span><span class="sxs-lookup"><span data-stu-id="380d6-261">Writing a query that joins tables from a linked server</span></span>  
  
-   <span data-ttu-id="380d6-262">Utilizzare nomi in quattro parti per fare riferimento a un oggetto in un server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-262">Use four-part names to refer to an object on a linked server.</span></span> <span data-ttu-id="380d6-263">Eseguire il codice riportato di seguito per restituire un elenco di tutti gli account di accesso nel server locale e i relativi account di accesso corrispondenti nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-263">Execute the following code to return a list of all logins on the local server and their matching logins on the linked server.</span></span>  
  
    ```sql  
    SELECT local.name AS LocalLogins, linked.name AS LinkedLogins  
    FROM master.sys.server_principals AS local  
    LEFT JOIN [SRVR002\ACCTG].master.sys.server_principals AS linked  
        ON local.name = linked.name ;  
    GO  
    ```  
  
     <span data-ttu-id="380d6-264">Quando viene restituito NULL per l'account di accesso del server collegato, tale account di accesso non è presente nel server collegato.</span><span class="sxs-lookup"><span data-stu-id="380d6-264">When NULL is returned for the linked server login it indicates that the login does not exist on the linked server.</span></span> <span data-ttu-id="380d6-265">Questi account di accesso non potranno essere utilizzati dal server collegato a meno tale server non sia configurato per passare un contesto di sicurezza differente oppure il server collegato accetta connessioni anonime.</span><span class="sxs-lookup"><span data-stu-id="380d6-265">These logins will not be able to use the linked server unless the linked server is configured to pass a different security context or the linked server accepts anonymous connections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="380d6-266">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="380d6-266">See Also</span></span>  
 <span data-ttu-id="380d6-267">[Server collegati &#40;Motore di database&#41;](linked-servers-database-engine.md) </span><span class="sxs-lookup"><span data-stu-id="380d6-267">[Linked Servers &#40;Database Engine&#41;](linked-servers-database-engine.md) </span></span>  
 <span data-ttu-id="380d6-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="380d6-268">[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) </span></span>  
 [<span data-ttu-id="380d6-269">sp_serveroption &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="380d6-269">sp_serveroption &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-serveroption-transact-sql)  
  
  
