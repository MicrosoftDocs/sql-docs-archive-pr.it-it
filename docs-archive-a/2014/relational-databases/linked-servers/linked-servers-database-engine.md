---
title: Server collegati (motore di database) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624142"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="b34bc-102">Server collegati (Motore di database)</span><span class="sxs-lookup"><span data-stu-id="b34bc-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="b34bc-103">Configurare un server collegato per consentire a [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] di eseguire comandi su origini dati OLE DB all'esterno dell'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b34bc-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b34bc-104">In genere i server collegati sono configurati per consentire a [!INCLUDE[ssDE](../../includes/ssde-md.md)] di eseguire l'istruzione [!INCLUDE[tsql](../../includes/tsql-md.md)] che include tabelle in un'altra istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]o un altro prodotto del database quale Oracle.</span><span class="sxs-lookup"><span data-stu-id="b34bc-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="b34bc-105">Molti tipi di origini dati OLE DB possono essere configurati come server collegati, incluso Access e Excel [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b34bc-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="b34bc-106">I server collegati offrono i vantaggi riportati di seguito:</span><span class="sxs-lookup"><span data-stu-id="b34bc-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="b34bc-107">Possibilità di accedere ai dati dall'esterno di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b34bc-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="b34bc-108">Possibilità di eseguire query distribuite, aggiornamenti, comandi e transazioni su origini dati eterogenee in tutta l'azienda.</span><span class="sxs-lookup"><span data-stu-id="b34bc-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="b34bc-109">Possibilità di utilizzare origini dati diverse in modo analogo.</span><span class="sxs-lookup"><span data-stu-id="b34bc-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="b34bc-110">È possibile configurare un server collegato usando [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] o l'istruzione [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="b34bc-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="b34bc-111">I provider OLE DB variano in modo sostanziale nel tipo e nel numero di parametri richiesti.</span><span class="sxs-lookup"><span data-stu-id="b34bc-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="b34bc-112">Ad esempio alcuni provider richiedono di fornire un contesto di sicurezza per la connessione usando [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="b34bc-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="b34bc-113">Alcuni provider OLE DB consentono a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] di aggiornare i dati sull'origine OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b34bc-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="b34bc-114">Altri forniscono accesso soltanto ai dati di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="b34bc-114">Others provide only read-only data access.</span></span> <span data-ttu-id="b34bc-115">Per informazioni su ogni provider OLE DB, consultare la documentazione relativa a detto provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b34bc-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="b34bc-116">Componenti di un server collegato</span><span class="sxs-lookup"><span data-stu-id="b34bc-116">Linked Server Components</span></span>
 <span data-ttu-id="b34bc-117">Nella definizione di un server collegato sono specificati gli oggetti seguenti:</span><span class="sxs-lookup"><span data-stu-id="b34bc-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="b34bc-118">Un provider OLE DB</span><span class="sxs-lookup"><span data-stu-id="b34bc-118">An OLE DB provider</span></span>

-   <span data-ttu-id="b34bc-119">Un'origine dei dati OLE DB</span><span class="sxs-lookup"><span data-stu-id="b34bc-119">An OLE DB data source</span></span>

 <span data-ttu-id="b34bc-120">Un *provider OLE DB* è una DLL in grado di gestire un'origine dei dati specifica e interagire con essa.</span><span class="sxs-lookup"><span data-stu-id="b34bc-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="b34bc-121">Un' *origine dei dati OLE DB* identifica lo specifico database a cui è possibile accedere con OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b34bc-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="b34bc-122">Anche se le origini dei dati su cui si eseguono query tramite definizioni di server collegati sono in genere database, esistono provider OLE DB per un'ampia gamma di file e formati di file,</span><span class="sxs-lookup"><span data-stu-id="b34bc-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="b34bc-123">quali file di testo, dati di fogli di calcolo e risultati di ricerche di contenuto full-text.</span><span class="sxs-lookup"><span data-stu-id="b34bc-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="b34bc-124">Il [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] provider di OLE DB di Native Client (ProgID: SQLNCLI11) è il provider OLE DB ufficiale per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b34bc-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b34bc-125">Le query distribuite sono progettate per funzionare con qualsiasi provider OLE DB che implementi le interfacce OLE DB necessarie.</span><span class="sxs-lookup"><span data-stu-id="b34bc-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="b34bc-126">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] è stato tuttavia testato solo con il provider OLE DB di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client e con alcuni altri provider.</span><span class="sxs-lookup"><span data-stu-id="b34bc-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="b34bc-127">Dettagli relativi ai server collegati</span><span class="sxs-lookup"><span data-stu-id="b34bc-127">Linked Server Details</span></span>
 <span data-ttu-id="b34bc-128">Nella figura seguente vengono illustrati i componenti di base di una configurazione con server collegati.</span><span class="sxs-lookup"><span data-stu-id="b34bc-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="b34bc-129">![Livello client, livello server e livello server di database](../../database-engine/media/lsvr.gif "Livello client, livello server e livello server di database")</span><span class="sxs-lookup"><span data-stu-id="b34bc-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="b34bc-130">I server collegati vengono in genere utilizzati per la gestione delle query distribuite.</span><span class="sxs-lookup"><span data-stu-id="b34bc-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="b34bc-131">Quando un'applicazione client esegue una query distribuita tramite un server collegato, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] analizza il comando e invia le richieste a OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b34bc-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="b34bc-132">È possibile richiedere l'esecuzione di una query sul provider o l'apertura di una tabella di base dal provider.</span><span class="sxs-lookup"><span data-stu-id="b34bc-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="b34bc-133">Un'origine dei dati può restituire dati tramite un server collegato solo se il relativo provider OLE DB (DLL) è presente nello stesso server dell'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b34bc-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="b34bc-134">Quando viene utilizzato un provider OLE DB di terze parti, l'account con cui viene eseguito il servizio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] deve disporre di autorizzazioni di lettura ed esecuzione per la directory, e tutte le sottodirectory, in cui è installato il provider.</span><span class="sxs-lookup"><span data-stu-id="b34bc-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="b34bc-135">Gestione dei provider</span><span class="sxs-lookup"><span data-stu-id="b34bc-135">Managing Providers</span></span>
 <span data-ttu-id="b34bc-136">È disponibile un set di opzioni che consente di controllare la modalità con cui [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] carica e utilizza i provider OLE DB specificati nel Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="b34bc-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="b34bc-137">Gestione delle definizioni dei server collegati</span><span class="sxs-lookup"><span data-stu-id="b34bc-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="b34bc-138">Quando si configura un server collegato è necessario registrare in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]i dati per la connessione e le informazioni sull'origine dei dati.</span><span class="sxs-lookup"><span data-stu-id="b34bc-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b34bc-139">Dopo la registrazione sarà possibile fare riferimento all'origine dei dati utilizzando un singolo nome logico.</span><span class="sxs-lookup"><span data-stu-id="b34bc-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="b34bc-140">Per gestire le definizioni dei server collegati è possibile utilizzare stored procedure e viste del catalogo:</span><span class="sxs-lookup"><span data-stu-id="b34bc-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="b34bc-141">Creare una definizione di un server collegato eseguendo **sp_addlinkedserver**.</span><span class="sxs-lookup"><span data-stu-id="b34bc-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="b34bc-142">Per visualizzare informazioni sui server collegati definiti in una specifica istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , eseguire una query sulle viste del catalogo di sistema **sys.servers** .</span><span class="sxs-lookup"><span data-stu-id="b34bc-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="b34bc-143">Eliminare la definizione di un server collegato eseguendo **sp_dropserver**.</span><span class="sxs-lookup"><span data-stu-id="b34bc-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="b34bc-144">Questa stored procedure può essere utilizzata anche per rimuovere un server remoto.</span><span class="sxs-lookup"><span data-stu-id="b34bc-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="b34bc-145">Per definire i server collegati è inoltre possibile utilizzare [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b34bc-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="b34bc-146">In Esplora oggetti fare clic con il pulsante destro del mouse su **Oggetti server**, scegliere **Nuovo**e quindi **Server collegato**.</span><span class="sxs-lookup"><span data-stu-id="b34bc-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="b34bc-147">Per eliminare la definizione di un server collegato, è possibile fare clic con il pulsante destro del mouse sul nome del server collegato e scegliere **Elimina**.</span><span class="sxs-lookup"><span data-stu-id="b34bc-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="b34bc-148">Quando si esegue una query distribuita su un server collegato, per ogni origine dei dati su cui viene eseguita la query specificare un nome di tabella completo in quattro parti.</span><span class="sxs-lookup"><span data-stu-id="b34bc-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="b34bc-149">Questo nome in quattro parti deve essere nel formato _linked_server_name. Catalog_\*\*. _`schema`_ \*\* . _object_name_.</span><span class="sxs-lookup"><span data-stu-id="b34bc-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="b34bc-150">È possibile definire un server collegato in modo che punti all'indietro (loopback) al server in cui è stato definito.</span><span class="sxs-lookup"><span data-stu-id="b34bc-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="b34bc-151">I server di loopback risultano particolarmente utili durante il test di un'applicazione in cui vengono utilizzate query distribuite in una rete con un solo server.</span><span class="sxs-lookup"><span data-stu-id="b34bc-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="b34bc-152">I server collegati di loopback sono destinati ai test e non sono supportati per molte operazioni, ad esempio le transazioni distribuite.</span><span class="sxs-lookup"><span data-stu-id="b34bc-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="b34bc-153">Attività correlate</span><span class="sxs-lookup"><span data-stu-id="b34bc-153">Related Tasks</span></span>
 [<span data-ttu-id="b34bc-154">Creare server collegati &#40;Motore di database di SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="b34bc-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="b34bc-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="b34bc-157">sp_dropserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="b34bc-158">Contenuto correlato</span><span class="sxs-lookup"><span data-stu-id="b34bc-158">Related Content</span></span>
 [<span data-ttu-id="b34bc-159">sys.servers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="b34bc-160">sp_linkedservers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b34bc-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)


