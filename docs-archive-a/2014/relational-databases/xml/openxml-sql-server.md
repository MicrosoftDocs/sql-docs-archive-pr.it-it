---
title: OPENXML (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
helpviewer_keywords:
- ColPattern [XML in SQL Server]
- OPENXML statement, about OPENXML statement
- writing XML, OPENXML statement
- OPENXML statement, querying XML
- attribute-centric mapping
- SELECT statement [SQL Server], OPENXML keyword
- column patterns [XML in SQL Server]
- row patterns [XML in SQL Server]
- rowpattern [XML in SQL Server]
- queries [XML in SQL Server], OPENXML statement
- XML [SQL Server], OPENXML statement
- element-centric mapping [SQL Server]
ms.assetid: 060126fc-ed0f-478f-830a-08e418d410dc
author: rothja
ms.author: jroth
ms.openlocfilehash: 1849029e6654fcd629499cceeff9957e5389370f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87726724"
---
# <a name="openxml-sql-server"></a><span data-ttu-id="138d1-102">OPENXML (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="138d1-102">OPENXML (SQL Server)</span></span>
  <span data-ttu-id="138d1-103">La parola chiave [!INCLUDE[tsql](../../includes/tsql-md.md)] OPENXML restituisce un set di righe simile a una tabella o una vista da documenti XML in memoria.</span><span class="sxs-lookup"><span data-stu-id="138d1-103">OPENXML, a [!INCLUDE[tsql](../../includes/tsql-md.md)] keyword, provides a rowset over in-memory XML documents that is similar to a table or a view.</span></span> <span data-ttu-id="138d1-104">OPENXML consente di accedere ai dati XML come se si trattasse di un set di righe relazionali,</span><span class="sxs-lookup"><span data-stu-id="138d1-104">OPENXML allows access to XML data as though it is a relational rowset.</span></span> <span data-ttu-id="138d1-105">visualizzando la rappresentazione interna di un documento XML come un set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-105">It does this by providing a rowset view of the internal representation of an XML document.</span></span> <span data-ttu-id="138d1-106">I record del set di righe possono essere archiviati in tabelle di database.</span><span class="sxs-lookup"><span data-stu-id="138d1-106">The records in the rowset can be stored in database tables.</span></span>

 <span data-ttu-id="138d1-107">È possibile usare OPENXML nelle istruzioni SELECT e SELECT INTO ogni volta che i provider di set di righe, una vista o OPENROWSET possono comparire come origine.</span><span class="sxs-lookup"><span data-stu-id="138d1-107">OPENXML can be used in SELECT and SELECT INTO statements wherever rowset providers, a view, or OPENROWSET can appear as the source.</span></span> <span data-ttu-id="138d1-108">Per informazioni sulla sintassi di OPENXML, vedere [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="138d1-108">For information about the syntax of OPENXML, see [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql).</span></span>

 <span data-ttu-id="138d1-109">Per scrivere query su un documento XML tramite OPENXML, è innanzitutto necessario chiamare `sp_xml_preparedocument` .</span><span class="sxs-lookup"><span data-stu-id="138d1-109">To write queries against an XML document by using OPENXML, you must first call `sp_xml_preparedocument`.</span></span> <span data-ttu-id="138d1-110">che analizza il documento XML e restituisce un handle al documento analizzato e pronto per l'utilizzo.</span><span class="sxs-lookup"><span data-stu-id="138d1-110">This parses the XML document and returns a handle to the parsed document that is ready for consumption.</span></span> <span data-ttu-id="138d1-111">Il documento analizzato è una rappresentazione dell'albero del modello a oggetti documento (DOM, Document Object Model) dei vari nodi inclusi nel documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-111">The parsed document is a document object model (DOM) tree representation of various nodes in the XML document.</span></span> <span data-ttu-id="138d1-112">L'handle del documento viene quindi passato a OPENXML,</span><span class="sxs-lookup"><span data-stu-id="138d1-112">The document handle is passed to OPENXML.</span></span> <span data-ttu-id="138d1-113">che a sua volta visualizza il documento come un set di righe in base ai parametri passati.</span><span class="sxs-lookup"><span data-stu-id="138d1-113">OPENXML then provides a rowset view of the document, based on the parameters passed to it.</span></span>

> [!NOTE]
>  <span data-ttu-id="138d1-114">`sp_xml_preparedocument`Usa una versione aggiornata di SQL del parser MSXML, Msxmlsql.dll.</span><span class="sxs-lookup"><span data-stu-id="138d1-114">`sp_xml_preparedocument` uses a SQL-updated version of the MSXML parser, Msxmlsql.dll.</span></span> <span data-ttu-id="138d1-115">Questa versione è stata progettata per supportare [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e garantire la compatibilità con MSXML versione 2.6.</span><span class="sxs-lookup"><span data-stu-id="138d1-115">This version of the MSXML parser was designed to support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and remain backward compatible with MSXML version 2.6.</span></span>

 <span data-ttu-id="138d1-116">La rappresentazione interna di un documento XML deve essere rimossa dalla memoria tramite una chiamata alla stored procedure di sistema **sp_xml_removedocument** , in modo tale da liberare memoria.</span><span class="sxs-lookup"><span data-stu-id="138d1-116">The internal representation of an XML document must be removed from memory by calling the **sp_xml_removedocument** system stored procedure to free the memory.</span></span>

 <span data-ttu-id="138d1-117">Nella figura seguente è illustrato questo processo.</span><span class="sxs-lookup"><span data-stu-id="138d1-117">The following illustration shows the process.</span></span>

 <span data-ttu-id="138d1-118">![Analisi XML con OPENXML](../../database-engine/media/xmlsp.gif "Analisi XML con OPENXML")</span><span class="sxs-lookup"><span data-stu-id="138d1-118">![Parsing XML with OPENXML](../../database-engine/media/xmlsp.gif "Parsing XML with OPENXML")</span></span>

 <span data-ttu-id="138d1-119">Si noti che per comprendere l'utilizzo di OPENXML, è necessario avere familiarità con le query XPath e XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-119">Note that to understand OPENXML, familiarity with XPath queries and an understanding of XML is required.</span></span> <span data-ttu-id="138d1-120">Per altre informazioni sul supporto di XPath in SQL Server, vedere [Utilizzo di query XPath in SQLXML 4.0](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="138d1-120">For more information about XPath support in SQL Server, see [Using XPath Queries in SQLXML 4.0](../sqlxml-annotated-xsd-schemas-xpath-queries/using-xpath-queries-in-sqlxml-4-0.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="138d1-121">OpenXML consente di parametrizzare i modelli XPath di riga e colonna come le variabili.</span><span class="sxs-lookup"><span data-stu-id="138d1-121">OpenXML allows the row and column XPath patterns to be parameterized as variables.</span></span> <span data-ttu-id="138d1-122">La parametrizzazione può comportare attacchi intrusivi nelle espressioni XPath se viene esposta dal programmatore a utenti esterni, ad esempio se i parametri sono forniti tramite una stored procedure chiamata dall'esterno.</span><span class="sxs-lookup"><span data-stu-id="138d1-122">Such parameterization could lead to XPath expression injections, if the programmer exposes the parameterization to outside users (for example, if the parameters are provided via an externally called stored procedure).</span></span> <span data-ttu-id="138d1-123">Per evitare questi problemi potenziali di sicurezza, è consigliabile non esporre mai i parametri XPath a chiamanti esterni.</span><span class="sxs-lookup"><span data-stu-id="138d1-123">To avoid such potential security issues, it is recommended that XPath parameters should never be exposed to external callers.</span></span>

## <a name="example"></a><span data-ttu-id="138d1-124">Esempio</span><span class="sxs-lookup"><span data-stu-id="138d1-124">Example</span></span>
 <span data-ttu-id="138d1-125">Nell'esempio seguente viene illustrato l'utilizzo di `OPENXML` in un'istruzione `INSERT` e in un'istruzione `SELECT` .</span><span class="sxs-lookup"><span data-stu-id="138d1-125">The following example shows the use of `OPENXML` in an `INSERT` statement and a `SELECT` statement.</span></span> <span data-ttu-id="138d1-126">Il documento XML di esempio contiene gli elementi `<Customers>` e `<Orders>` .</span><span class="sxs-lookup"><span data-stu-id="138d1-126">The sample XML document contains `<Customers>` and `<Orders>` elements.</span></span>

 <span data-ttu-id="138d1-127">La stored procedure `sp_xml_preparedocument` analizza innanzitutto il documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-127">First, the `sp_xml_preparedocument` stored procedure parses the XML document.</span></span> <span data-ttu-id="138d1-128">Il documento analizzato corrisponde a una rappresentazione ad albero dei vari nodi (elementi, attributi, testo, commenti e così via) del documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-128">The parsed document is a tree representation of the nodes (elements, attributes, text, and comments) in the XML document.</span></span> <span data-ttu-id="138d1-129">`OPENXML` si riferisce quindi al documento XML analizzato e fornisce una visualizzazione del set di righe di tutto o parte del documento.</span><span class="sxs-lookup"><span data-stu-id="138d1-129">`OPENXML` then refers to this parsed XML document and provides a rowset view of all or parts of this XML document.</span></span> <span data-ttu-id="138d1-130">Un'istruzione `INSERT` che usa `OPENXML` può inserire i dati di tale set di righe in una tabella di database.</span><span class="sxs-lookup"><span data-stu-id="138d1-130">An `INSERT` statement using `OPENXML` can insert data from such a rowset into a database table.</span></span> <span data-ttu-id="138d1-131">È possibile usare diverse chiamate a `OPENXML` per ottenere una vista del set di righe di diverse parti del documento XML ed elaborarle, ad esempio inserendole in tabelle diverse.</span><span class="sxs-lookup"><span data-stu-id="138d1-131">Several `OPENXML` calls can be used to provide a rowset view of various parts of the XML document and process them, for example, by inserting them into different tables.</span></span> <span data-ttu-id="138d1-132">Tale processo è noto anche come "suddivisione del documento XML in tabelle".</span><span class="sxs-lookup"><span data-stu-id="138d1-132">This process is also referred to as shredding XML into tables.</span></span>

 <span data-ttu-id="138d1-133">Nell'esempio seguente un documento XML viene suddiviso in modo che gli elementi `<Customers>` vengano archiviati nella tabella `Customers` e gli elementi `<Orders>` vengano archiviati nella tabella `Orders` usando due istruzioni `INSERT` .</span><span class="sxs-lookup"><span data-stu-id="138d1-133">In the following example, an XML document is shredded in a way that `<Customers>` elements are stored in the `Customers` table and `<Orders>` elements are stored in the `Orders` table by using two `INSERT` statements.</span></span> <span data-ttu-id="138d1-134">Nell'esempio viene inoltre illustrata un'istruzione `SELECT` con la funzione `OPENXML` che recupera `CustomerID` e `OrderDate` dal documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-134">The example also shows a `SELECT` statement with `OPENXML` that retrieves `CustomerID` and `OrderDate` from the XML document.</span></span> <span data-ttu-id="138d1-135">L'ultimo passaggio del processo consiste nel chiamare `sp_xml_removedocument`</span><span class="sxs-lookup"><span data-stu-id="138d1-135">The last step in the process is to call `sp_xml_removedocument`.</span></span> <span data-ttu-id="138d1-136">in modo da rilasciare la memoria allocata per includere la rappresentazione dell'albero XML interno creata durante la fase di analisi.</span><span class="sxs-lookup"><span data-stu-id="138d1-136">This is done in order to release the memory allocated to contain the internal XML tree representation that was created during the parse phase.</span></span>

```
-- Create tables for later population using OPENXML.
CREATE TABLE Customers (CustomerID varchar(20) primary key,
                ContactName varchar(20), 
                CompanyName varchar(20));
GO
CREATE TABLE Orders( CustomerID varchar(20), OrderDate datetime);
GO
DECLARE @docHandle int;
DECLARE @xmlDocument nvarchar(max); -- or xml type
SET @xmlDocument = N'<ROOT>
<Customers CustomerID="XYZAA" ContactName="Joe" CompanyName="Company1">
<Orders CustomerID="XYZAA" OrderDate="2000-08-25T00:00:00"/>
<Orders CustomerID="XYZAA" OrderDate="2000-10-03T00:00:00"/>
</Customers>
<Customers CustomerID="XYZBB" ContactName="Steve"
CompanyName="Company2">No Orders yet!
</Customers>
</ROOT>';
EXEC sp_xml_preparedocument @docHandle OUTPUT, @xmlDocument;
-- Use OPENXML to provide rowset consisting of customer data.
INSERT Customers 
SELECT * 
FROM OPENXML(@docHandle, N'/ROOT/Customers') 
  WITH Customers;
-- Use OPENXML to provide rowset consisting of order data.
INSERT Orders 
SELECT * 
FROM OPENXML(@docHandle, N'//Orders') 
  WITH Orders;
-- Using OPENXML in a SELECT statement.
SELECT * FROM OPENXML(@docHandle, N'/ROOT/Customers/Orders') WITH (CustomerID nchar(5) '../@CustomerID', OrderDate datetime);
-- Remove the internal representation of the XML document.
EXEC sp_xml_removedocument @docHandle; 
```

 <span data-ttu-id="138d1-137">Nella figura seguente viene illustrato l'albero XML analizzato del documento XML precedente creato tramite sp_xml_preparedocument.</span><span class="sxs-lookup"><span data-stu-id="138d1-137">The following illustration shows the parsed XML tree of the previous XML document that was created by using sp_xml_preparedocument.</span></span>

 <span data-ttu-id="138d1-138">![Albero XML analizzato](../../database-engine/media/xmlparsedtree.gif "Albero XML analizzato")</span><span class="sxs-lookup"><span data-stu-id="138d1-138">![Parsed XML tree](../../database-engine/media/xmlparsedtree.gif "Parsed XML tree")</span></span>

## <a name="openxml-parameters"></a><span data-ttu-id="138d1-139">Parametri di OPENXML</span><span class="sxs-lookup"><span data-stu-id="138d1-139">OPENXML Parameters</span></span>
 <span data-ttu-id="138d1-140">I parametri passati a OPENXML includono:</span><span class="sxs-lookup"><span data-stu-id="138d1-140">The parameters to OPENXML include the following:</span></span>

-   <span data-ttu-id="138d1-141">L'handle di un documento XML (*idoc*)</span><span class="sxs-lookup"><span data-stu-id="138d1-141">An XML document handle (*idoc*)</span></span>

-   <span data-ttu-id="138d1-142">Un'espressione XPath che identifica i nodi di cui eseguire il mapping alle righe (*rowpattern*)</span><span class="sxs-lookup"><span data-stu-id="138d1-142">An XPath expression to identify the nodes to be mapped to rows (*rowpattern*)</span></span>

-   <span data-ttu-id="138d1-143">Una descrizione del set di righe da generare.</span><span class="sxs-lookup"><span data-stu-id="138d1-143">A description of the rowset to be generated</span></span>

-   <span data-ttu-id="138d1-144">Il mapping tra le colonne del set di righe e i nodi XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-144">Mapping between the rowset columns and the XML nodes</span></span>

### <a name="xml-document-handle-idoc"></a><span data-ttu-id="138d1-145">Handle del documento XML (idoc)</span><span class="sxs-lookup"><span data-stu-id="138d1-145">XML Document Handle (idoc)</span></span>
 <span data-ttu-id="138d1-146">L'handle del documento viene restituito dalla `sp_xml_preparedocument` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="138d1-146">The document handle is returned by the `sp_xml_preparedocument` stored procedure.</span></span>

### <a name="xpath-expression-to-identify-the-nodes-to-be-processed-rowpattern"></a><span data-ttu-id="138d1-147">Espressione XPath che identifica i nodi da elaborare (rowpattern)</span><span class="sxs-lookup"><span data-stu-id="138d1-147">XPath Expression to Identify the Nodes to Be Processed (rowpattern)</span></span>
 <span data-ttu-id="138d1-148">L'espressione XPath specificata come *rowpattern* identifica un set di nodi nel documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-148">The XPath expression specified as *rowpattern* identifies a set of nodes in the XML document.</span></span> <span data-ttu-id="138d1-149">Ogni nodo definito da *rowpattern* corrisponde a una riga specifica del set di righe generato da OPENXML.</span><span class="sxs-lookup"><span data-stu-id="138d1-149">Each node that is identified by *rowpattern* corresponds to a single row in the rowset that is generated by OPENXML.</span></span>

 <span data-ttu-id="138d1-150">I nodi definiti dall'espressione XPath possono essere qualsiasi nodo XML del documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-150">The nodes identified by the XPath expression can be any XML node in the XML document.</span></span> <span data-ttu-id="138d1-151">Se *rowpattern* identifica un set di elementi nel documento XML, a ogni nodo identificato corrisponderà una riga nel set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-151">If *rowpattern* identifies a set of elements in the XML document, there is one row in the rowset for each element node identified.</span></span> <span data-ttu-id="138d1-152">Ad esempio, se *rowpattern* restituisce un attributo, verrà creata una riga per ogni nodo attributo selezionato da *rowpattern*.</span><span class="sxs-lookup"><span data-stu-id="138d1-152">For example, if *rowpattern* ends in an attribute, a row is created for each attribute node selected by *rowpattern*.</span></span>

### <a name="description-of-the-rowset-to-be-generated"></a><span data-ttu-id="138d1-153">Descrizione del set di righe da generare</span><span class="sxs-lookup"><span data-stu-id="138d1-153">Description of the Rowset to Be Generated</span></span>
 <span data-ttu-id="138d1-154">OPENXML usa uno schema di set di righe per generare il set di righe risultante.</span><span class="sxs-lookup"><span data-stu-id="138d1-154">A rowset schema is used by OPENXML to generate the resulting rowset.</span></span> <span data-ttu-id="138d1-155">Per specificare uno schema di set di righe, è possibile usare le opzioni illustrate di seguito.</span><span class="sxs-lookup"><span data-stu-id="138d1-155">You can use the following options when specifying a rowset schema.</span></span>

#### <a name="using-the-edge-table-format"></a><span data-ttu-id="138d1-156">Utilizzo del formato di tabella edge</span><span class="sxs-lookup"><span data-stu-id="138d1-156">Using the Edge Table Format</span></span>
 <span data-ttu-id="138d1-157">Per specificare uno schema di set di righe è consigliabile usare il formato di tabella edge,</span><span class="sxs-lookup"><span data-stu-id="138d1-157">You should use the edge table format to specify a rowset schema.</span></span> <span data-ttu-id="138d1-158">evitando invece di usare la clausola WITH.</span><span class="sxs-lookup"><span data-stu-id="138d1-158">Do not use the WITH clause.</span></span>

 <span data-ttu-id="138d1-159">In questo caso, OPENXML restituisce un set di righe nel formato di tabella edge.</span><span class="sxs-lookup"><span data-stu-id="138d1-159">When you do this, OPENXML returns a rowset in the edge table format.</span></span> <span data-ttu-id="138d1-160">Il nome di questo formato deriva dal fatto che su ogni margine dell'albero del documento XML analizzato viene eseguito il mapping a una riga del set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-160">This is referred to as an edge table, because every edge in the parsed XML document tree maps to a row in the rowset.</span></span>

 <span data-ttu-id="138d1-161">In una tabella edge viene rappresentata la struttura dettagliata di un documento XML,</span><span class="sxs-lookup"><span data-stu-id="138d1-161">Edge tables represent within a single table the fine-grained XML document structure.</span></span> <span data-ttu-id="138d1-162">che include i nomi degli elementi e degli attributi, la gerarchia del documento, gli spazi dei nomi e le istruzioni per l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="138d1-162">This structure includes the element and attribute names, the document hierarchy, the namespaces, and the processing instructions.</span></span> <span data-ttu-id="138d1-163">Il formato di tabella edge consente di ottenere informazioni aggiuntive non esposte tramite le metaproprietà.</span><span class="sxs-lookup"><span data-stu-id="138d1-163">The edge table format allows you to obtain additional information that is not exposed through the metaproperties.</span></span> <span data-ttu-id="138d1-164">Per altre informazioni sulle metaproprietà, vedere [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span><span class="sxs-lookup"><span data-stu-id="138d1-164">For more information about metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="138d1-165">Le informazioni aggiuntive disponibili in una tabella edge consentono di archiviare e di eseguire query sul tipo di dati di un elemento o di un attributo e sul tipo di nodo, di archiviare ed eseguire query sulle informazioni relative alla struttura del documento XML,</span><span class="sxs-lookup"><span data-stu-id="138d1-165">The additional information provided by an edge table allows you to store and query the data type of an element and attribute, and the node type, and also store and query information about the XML document structure.</span></span> <span data-ttu-id="138d1-166">nonché di compilare un sistema di gestione dei documenti XML personalizzato.</span><span class="sxs-lookup"><span data-stu-id="138d1-166">With this additional information, it may also be possible to build your own XML document management system.</span></span>

 <span data-ttu-id="138d1-167">Tramite una tabella edge è possibile scrivere stored procedure che accettano i documenti XML come input BLOB (Binary Large Object), generano la tabella edge e quindi estraggono e analizzano il documento al massimo livello di dettaglio</span><span class="sxs-lookup"><span data-stu-id="138d1-167">By using an edge table, you can write stored procedures that take XML documents as binary large object (BLOB) input, produce the edge table, and then extract and analyze the document on a more detailed level.</span></span> <span data-ttu-id="138d1-168">(ricerca della gerarchia del documento, dei nomi di elementi e attributi, degli spazi dei nomi e delle istruzioni per l'elaborazione).</span><span class="sxs-lookup"><span data-stu-id="138d1-168">This detailed level could include finding the document hierarchy, the element and attribute names, the namespaces, and the processing instructions.</span></span>

 <span data-ttu-id="138d1-169">La tabella edge può inoltre fungere da formato di archiviazione per i documenti XML quando nessun altro tipo di mapping ad altri formati relazionali risulta appropriato e un campo ntext non restituisce informazioni strutturali sufficienti.</span><span class="sxs-lookup"><span data-stu-id="138d1-169">The edge table also can serve as a storage format for XML documents when mapping to other relational formats is not logical and an ntext field is not providing enough structural information.</span></span>

 <span data-ttu-id="138d1-170">L'utilizzo di una tabella edge per analizzare un documento XML equivale a usare un parser XML per ottenere le stesse informazioni.</span><span class="sxs-lookup"><span data-stu-id="138d1-170">In situations where you can use an XML parser to examine an XML document, you can use an edge table instead to obtain the same information.</span></span>

 <span data-ttu-id="138d1-171">Nella tabella seguente viene descritta la struttura della tabella edge.</span><span class="sxs-lookup"><span data-stu-id="138d1-171">The following table describes the structure of the edge table.</span></span>

|<span data-ttu-id="138d1-172">Nome colonna</span><span class="sxs-lookup"><span data-stu-id="138d1-172">Column name</span></span>|<span data-ttu-id="138d1-173">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="138d1-173">Data type</span></span>|<span data-ttu-id="138d1-174">Descrizione</span><span class="sxs-lookup"><span data-stu-id="138d1-174">Description</span></span>|
|-----------------|---------------|-----------------|
|<span data-ttu-id="138d1-175">**id**</span><span class="sxs-lookup"><span data-stu-id="138d1-175">**id**</span></span>|<span data-ttu-id="138d1-176">**bigint**</span><span class="sxs-lookup"><span data-stu-id="138d1-176">**bigint**</span></span>|<span data-ttu-id="138d1-177">ID univoco del nodo del documento.</span><span class="sxs-lookup"><span data-stu-id="138d1-177">Is the unique ID of the document node.</span></span><br /><br /> <span data-ttu-id="138d1-178">Il valore dell'ID dell'elemento radice è 0.</span><span class="sxs-lookup"><span data-stu-id="138d1-178">The root element has an ID value of 0.</span></span> <span data-ttu-id="138d1-179">I valori di ID negativi sono riservati.</span><span class="sxs-lookup"><span data-stu-id="138d1-179">The negative ID values are reserved.</span></span>|
|<span data-ttu-id="138d1-180">**parentid**</span><span class="sxs-lookup"><span data-stu-id="138d1-180">**parentid**</span></span>|<span data-ttu-id="138d1-181">**bigint**</span><span class="sxs-lookup"><span data-stu-id="138d1-181">**bigint**</span></span>|<span data-ttu-id="138d1-182">Identifica il padre del nodo.</span><span class="sxs-lookup"><span data-stu-id="138d1-182">Identifies the parent of the node.</span></span> <span data-ttu-id="138d1-183">Il padre identificato da questo ID non è necessariamente l'elemento padre,</span><span class="sxs-lookup"><span data-stu-id="138d1-183">The parent identified by this ID is not necessarily the parent element.</span></span> <span data-ttu-id="138d1-184">ma dipende dalla proprietà NodeType del nodo il cui padre è identificato da questo ID.</span><span class="sxs-lookup"><span data-stu-id="138d1-184">However, this depends on the NodeType of the node whose parent is identified by this ID.</span></span> <span data-ttu-id="138d1-185">Se ad esempio il nodo è di tipo testo, il relativo elemento padre potrebbe essere un nodo attributo.</span><span class="sxs-lookup"><span data-stu-id="138d1-185">For example, if the node is a text node, its parent may be an attribute node.</span></span><br /><br /> <span data-ttu-id="138d1-186">Se il nodo si trova al livello principale nel documento XML, il relativo valore **ParentID** è NULL.</span><span class="sxs-lookup"><span data-stu-id="138d1-186">If the node is at the top level in the XML document, its **ParentID** is NULL.</span></span>|
|<span data-ttu-id="138d1-187">**node type**</span><span class="sxs-lookup"><span data-stu-id="138d1-187">**node type**</span></span>|<span data-ttu-id="138d1-188">**int**</span><span class="sxs-lookup"><span data-stu-id="138d1-188">**int**</span></span>|<span data-ttu-id="138d1-189">Identifica il tipo di nodo ed è un intero che corrisponde alla numerazione del tipo di nodo DOM XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-189">Identifies the node type and is an integer that corresponds to the XML object model (DOM) node type numbering.</span></span><br /><br /> <span data-ttu-id="138d1-190">Di seguito sono riportati i valori che indicano il tipo di nodo visualizzabili nella colonna:</span><span class="sxs-lookup"><span data-stu-id="138d1-190">Following are the values that can appear in this column to indicate the node type:</span></span><br /><br /> <span data-ttu-id="138d1-191">**1** = Nodo elemento</span><span class="sxs-lookup"><span data-stu-id="138d1-191">**1** = Element node</span></span><br /><br /> <span data-ttu-id="138d1-192">**2** = Nodo attributo</span><span class="sxs-lookup"><span data-stu-id="138d1-192">**2** = Attribute node</span></span><br /><br /> <span data-ttu-id="138d1-193">**3** = Nodo di testo</span><span class="sxs-lookup"><span data-stu-id="138d1-193">**3** = Text node</span></span><br /><br /> <span data-ttu-id="138d1-194">**4** = Nodo sezione CDATA</span><span class="sxs-lookup"><span data-stu-id="138d1-194">**4** = CDATA section node</span></span><br /><br /> <span data-ttu-id="138d1-195">**5** = Nodo riferimento a entità</span><span class="sxs-lookup"><span data-stu-id="138d1-195">**5** = Entity reference node</span></span><br /><br /> <span data-ttu-id="138d1-196">**6** = Nodo entità</span><span class="sxs-lookup"><span data-stu-id="138d1-196">**6** = Entity node</span></span><br /><br /> <span data-ttu-id="138d1-197">**7** = Nodo istruzione di elaborazione</span><span class="sxs-lookup"><span data-stu-id="138d1-197">**7** = Processing instruction node</span></span><br /><br /> <span data-ttu-id="138d1-198">**8** = Nodo di commento</span><span class="sxs-lookup"><span data-stu-id="138d1-198">**8** = Comment node</span></span><br /><br /> <span data-ttu-id="138d1-199">**9** = Nodo di documento</span><span class="sxs-lookup"><span data-stu-id="138d1-199">**9** = Document node</span></span><br /><br /> <span data-ttu-id="138d1-200">**10** = Nodo tipo di documento</span><span class="sxs-lookup"><span data-stu-id="138d1-200">**10** = Document Type node</span></span><br /><br /> <span data-ttu-id="138d1-201">**11** = Nodo frammento di documento</span><span class="sxs-lookup"><span data-stu-id="138d1-201">**11** = Document Fragment node</span></span><br /><br /> <span data-ttu-id="138d1-202">**12** = Nodo di notazione</span><span class="sxs-lookup"><span data-stu-id="138d1-202">**12** = Notation node</span></span><br /><br /> <span data-ttu-id="138d1-203">Per altre informazioni, vedere l'argomento relativo alla proprietà nodeType nella documentazione di Microsoft XML (MSXML) SDK.</span><span class="sxs-lookup"><span data-stu-id="138d1-203">For more information, see the "nodeType Property" topic in the Microsoft XML (MSXML) SDK.</span></span>|
|<span data-ttu-id="138d1-204">**localname**</span><span class="sxs-lookup"><span data-stu-id="138d1-204">**localname**</span></span>|<span data-ttu-id="138d1-205">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="138d1-205">**nvarchar(max)**</span></span>|<span data-ttu-id="138d1-206">Nome locale dell'elemento o attributo.</span><span class="sxs-lookup"><span data-stu-id="138d1-206">Gives the local name of the element or attribute.</span></span> <span data-ttu-id="138d1-207">È NULL se l'oggetto DOM non è associato a un nome.</span><span class="sxs-lookup"><span data-stu-id="138d1-207">Is NULL if the DOM object does not have a name.</span></span>|
|<span data-ttu-id="138d1-208">**prefix**</span><span class="sxs-lookup"><span data-stu-id="138d1-208">**prefix**</span></span>|<span data-ttu-id="138d1-209">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="138d1-209">**nvarchar(max)**</span></span>|<span data-ttu-id="138d1-210">Prefisso dello spazio dei nomi del nome del nodo.</span><span class="sxs-lookup"><span data-stu-id="138d1-210">Is the namespace prefix of the node name.</span></span>|
|<span data-ttu-id="138d1-211">**namespaceuri**</span><span class="sxs-lookup"><span data-stu-id="138d1-211">**namespaceuri**</span></span>|<span data-ttu-id="138d1-212">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="138d1-212">**nvarchar(max)**</span></span>|<span data-ttu-id="138d1-213">URI dello spazio dei nomi del nodo.</span><span class="sxs-lookup"><span data-stu-id="138d1-213">Is the namespace URI of the node.</span></span> <span data-ttu-id="138d1-214">Se il valore è NULL, non sono presenti spazi dei nomi.</span><span class="sxs-lookup"><span data-stu-id="138d1-214">If the value is NULL, no namespace is present.</span></span>|
|<span data-ttu-id="138d1-215">**datatype**</span><span class="sxs-lookup"><span data-stu-id="138d1-215">**datatype**</span></span>|<span data-ttu-id="138d1-216">**nvarchar(max)**</span><span class="sxs-lookup"><span data-stu-id="138d1-216">**nvarchar(max)**</span></span>|<span data-ttu-id="138d1-217">Rappresenta il tipo di dati effettivo della riga dell'elemento o dell'attributo e in caso contrario è NULL.</span><span class="sxs-lookup"><span data-stu-id="138d1-217">Is the actual data type of the element or attribute row and is otherwise NULL.</span></span> <span data-ttu-id="138d1-218">Il tipo di dati viene ricavato dalla DTD o dallo schema inline.</span><span class="sxs-lookup"><span data-stu-id="138d1-218">The data type is inferred from the inline DTD or from the inline schema.</span></span>|
|<span data-ttu-id="138d1-219">**prev**</span><span class="sxs-lookup"><span data-stu-id="138d1-219">**prev**</span></span>|<span data-ttu-id="138d1-220">**bigint**</span><span class="sxs-lookup"><span data-stu-id="138d1-220">**bigint**</span></span>|<span data-ttu-id="138d1-221">ID XML dell'elemento di pari livello precedente.</span><span class="sxs-lookup"><span data-stu-id="138d1-221">Is the XML ID of the previous sibling element.</span></span> <span data-ttu-id="138d1-222">È NULL se non è presente alcun elemento diretto di pari livello precedente.</span><span class="sxs-lookup"><span data-stu-id="138d1-222">Is NULL if there is no direct previous sibling.</span></span>|
|<span data-ttu-id="138d1-223">**text**</span><span class="sxs-lookup"><span data-stu-id="138d1-223">**text**</span></span>|<span data-ttu-id="138d1-224">**ntext**</span><span class="sxs-lookup"><span data-stu-id="138d1-224">**ntext**</span></span>|<span data-ttu-id="138d1-225">Include il valore dell'attributo o il contenuto dell'elemento in formato testo</span><span class="sxs-lookup"><span data-stu-id="138d1-225">Contains the attribute value or the element content in text form.</span></span> <span data-ttu-id="138d1-226">oppure è NULL se la voce della tabella edge non richiede un valore.</span><span class="sxs-lookup"><span data-stu-id="138d1-226">Or is NULL, if the edge table entry does not need a value.</span></span>|

#### <a name="using-the-with-clause-to-specify-an-existing-table"></a><span data-ttu-id="138d1-227">Utilizzo della clausola WITH per specificare una tabella esistente</span><span class="sxs-lookup"><span data-stu-id="138d1-227">Using the WITH Clause to Specify an Existing Table</span></span>
 <span data-ttu-id="138d1-228">È possibile usare la clausola WITH per specificare il nome di una tabella esistente.</span><span class="sxs-lookup"><span data-stu-id="138d1-228">You can use the WITH clause to specify the name of an existing table.</span></span> <span data-ttu-id="138d1-229">A tale scopo, specificare il nome della tabella il cui schema può essere usato da OPENXML per generare il set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-229">To do this, just specify an existing table name whose schema can be used by OPENXML to generate the rowset.</span></span>

#### <a name="using-the-with-clause-to-specify-a-schema"></a><span data-ttu-id="138d1-230">Utilizzo della clausola WITH per specificare uno schema</span><span class="sxs-lookup"><span data-stu-id="138d1-230">Using the WITH Clause to Specify a Schema</span></span>
 <span data-ttu-id="138d1-231">È possibile usare la clausola WITH per specificare uno schema completo.</span><span class="sxs-lookup"><span data-stu-id="138d1-231">You can use the WITH Clause to specify a complete schema.</span></span> <span data-ttu-id="138d1-232">Quando si specifica lo schema del set di righe, si definiscono i nomi delle colonne e i rispettivi tipi di dati, nonché il mapping di tali colonne al documento XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-232">In specifying the rowset schema, you specify the column names, their data types, and their mapping to the XML document.</span></span>

 <span data-ttu-id="138d1-233">È possibile specificare il modello di colonna usando il parametro ColPattern nell'argomento SchemaDeclaration.</span><span class="sxs-lookup"><span data-stu-id="138d1-233">You can specify the column pattern by using the ColPattern parameter in the SchemaDeclaration.</span></span> <span data-ttu-id="138d1-234">Il modello di colonna specificato consente di eseguire il mapping di una colonna del set di righe al nodo XML identificato da rowpattern, nonché di determinare il tipo di mapping.</span><span class="sxs-lookup"><span data-stu-id="138d1-234">The specified column pattern is used to map a rowset column to the XML node that is identified by rowpattern and is also used to determine the type of mapping.</span></span>

 <span data-ttu-id="138d1-235">Se per una colonna non viene specificato il parametro ColPattern, viene eseguito il mapping della colonna del set di righe al nodo XML con lo stesso nome, in base al mapping specificato dal parametro *flags* .</span><span class="sxs-lookup"><span data-stu-id="138d1-235">If ColPattern is not specified for a column, the rowset column maps to the XML node with the same name, based on the mapping specified by the *flags* parameter.</span></span> <span data-ttu-id="138d1-236">Se viene impostato nell'ambito della specifica dello schema nella clausola WITH, il parametro ColPattern sarà tuttavia prioritario rispetto al mapping specificato dal parametro *flags* .</span><span class="sxs-lookup"><span data-stu-id="138d1-236">However, if ColPattern is specified as part of the schema specification in the WITH clause, it overwrites the mapping that is specified in the *flags* parameter.</span></span>

### <a name="mapping-between-the-rowset-columns-and-the-xml-nodes"></a><span data-ttu-id="138d1-237">Il mapping tra le colonne del set di righe e i nodi XML.</span><span class="sxs-lookup"><span data-stu-id="138d1-237">Mapping Between the Rowset Columns and the XML Nodes</span></span>
 <span data-ttu-id="138d1-238">Nell'istruzione OPENXML è anche possibile specificare facoltativamente il tipo di mapping (incentrato sugli attributi o sugli elementi) tra le colonne del set di righe e i nodi XML identificati da *rowpattern*.</span><span class="sxs-lookup"><span data-stu-id="138d1-238">In the OPENXML statement, you can optionally specify the type of mapping, such as attribute-centric or element-centric, between the rowset columns and the XML nodes that are identified by the *rowpattern*.</span></span> <span data-ttu-id="138d1-239">Questa informazione viene usata per la trasformazione tra i nodi XML e le colonne del set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-239">This information is used in the transformation between the XML nodes and the rowset columns.</span></span>

 <span data-ttu-id="138d1-240">Per specificare il tipo di mapping è possibile procedere in due modi e inoltre usare entrambi i sistemi:</span><span class="sxs-lookup"><span data-stu-id="138d1-240">You can specify the mapping in two ways, and you can also specify both:</span></span>

-   <span data-ttu-id="138d1-241">Tramite il parametro *flags* .</span><span class="sxs-lookup"><span data-stu-id="138d1-241">By using the *flags* parameter</span></span>

     <span data-ttu-id="138d1-242">Il mapping specificato dal parametro *flags* si basa sullo corrispondenza dei nomi, ovvero sui nodi XML viene eseguito il mapping alle colonne del set di righe corrispondenti con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="138d1-242">The mapping that is specified by the *flags* parameter assumes name correspondence in which the XML nodes map to the corresponding rowset columns with same name.</span></span>

-   <span data-ttu-id="138d1-243">Tramite il parametro *ColPattern* .</span><span class="sxs-lookup"><span data-stu-id="138d1-243">By using the *ColPattern* parameter</span></span>

     <span data-ttu-id="138d1-244">Il parametro*ColPattern*, ovvero un'espressione XPath, viene specificato nell'ambito di *SchemaDeclaration* nella clausola WITH.</span><span class="sxs-lookup"><span data-stu-id="138d1-244">*ColPattern*, an XPath expression, is specified as part of *SchemaDeclaration* in the WITH clause.</span></span> <span data-ttu-id="138d1-245">Il mapping specificato dal parametro *ColPattern* sovrascrive il mapping specificato dal parametro *flags* .</span><span class="sxs-lookup"><span data-stu-id="138d1-245">The mapping specified in *ColPattern* overwrites the mapping specified by the *flags* parameter.</span></span>

     <span data-ttu-id="138d1-246">Il parametro*ColPattern* consente di specificare il tipo di mapping, incentrato sugli attributi o sugli elementi, che sovrascrive o migliora il mapping predefinito indicato in *flags*.</span><span class="sxs-lookup"><span data-stu-id="138d1-246">*ColPattern* can be used to specify the type of mapping, such as attribute-centric or element-centric, that overwrites or enhances the default mapping indicated by the *flags*.</span></span>

     <span data-ttu-id="138d1-247">Il parametro*ColPattern* viene specificato nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="138d1-247">*ColPattern* is specified under the following circumstances:</span></span>

    -   <span data-ttu-id="138d1-248">Se il nome di colonna nel set di righe è diverso dal nome dell'elemento o dell'attributo al quale viene eseguito il mapping.</span><span class="sxs-lookup"><span data-stu-id="138d1-248">The column name in the rowset is different from the element or attribute name to which it is mapped.</span></span> <span data-ttu-id="138d1-249">In questo caso, il parametro *ColPattern* consente di identificare il nome dell'elemento o dell'attributo XML al quale viene eseguito il mapping della colonna del set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-249">In this case, *ColPattern* is used to identify the XML element and attribute name to which the rowset column maps.</span></span>

    -   <span data-ttu-id="138d1-250">Se si desidera eseguire il mapping di un attributo di una metaproprietà alla colonna.</span><span class="sxs-lookup"><span data-stu-id="138d1-250">You want to map a metaproperty attribute to the column.</span></span> <span data-ttu-id="138d1-251">In questo caso, il parametro *ColPattern* consente di definire la metaproprietà alla quale viene eseguito il mapping della colonna del set di righe.</span><span class="sxs-lookup"><span data-stu-id="138d1-251">In this case, *ColPattern* is used to identify the metaproperty to which the rowset column maps.</span></span> <span data-ttu-id="138d1-252">Per altre informazioni su come usare le metaproprietà, vedere [Impostazione di metaproprietà in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span><span class="sxs-lookup"><span data-stu-id="138d1-252">For more information about how to use metaproperties, see [Specify Metaproperties in OPENXML](../xml/specify-metaproperties-in-openxml.md).</span></span>

 <span data-ttu-id="138d1-253">I parametri *flags* e *ColPattern* sono entrambi facoltativi.</span><span class="sxs-lookup"><span data-stu-id="138d1-253">Both the *flags* and *ColPattern* parameters are optional.</span></span> <span data-ttu-id="138d1-254">Se non viene specificato un mapping, viene usato il mapping incentrato sugli attributi,</span><span class="sxs-lookup"><span data-stu-id="138d1-254">If no mapping is specified, attribute-centric mapping is assumed.</span></span> <span data-ttu-id="138d1-255">ovvero il valore predefinito del parametro *flags* .</span><span class="sxs-lookup"><span data-stu-id="138d1-255">Attribute-centric mapping is the default value of the *flags* parameter.</span></span>

#### <a name="attribute-centric-mapping"></a><span data-ttu-id="138d1-256">mapping incentrato sugli attributi</span><span class="sxs-lookup"><span data-stu-id="138d1-256">Attribute-centric Mapping</span></span>
 <span data-ttu-id="138d1-257">Se il parametro *flags* dell'istruzione OPENXML viene impostato su 1 (XML_ATTRIBUTES), viene definito un mapping **incentrato sugli attributi** .</span><span class="sxs-lookup"><span data-stu-id="138d1-257">Setting the *flags* parameter in OPENXML to 1 (XML_ATTRIBUTES) specifies **attribute-centric** mapping.</span></span> <span data-ttu-id="138d1-258">Se il parametro *flags* include XML_ ATTRIBUTES, il set di righe esposto restituisce o usa le righe nelle quali ogni elemento XML è rappresentato come una riga.</span><span class="sxs-lookup"><span data-stu-id="138d1-258">If *flags* contains XML_ ATTRIBUTES, the exposed rowset provides or consumes rows where each XML element is represented as a row.</span></span> <span data-ttu-id="138d1-259">Sugli attributi XML viene eseguito il mapping agli attributi definiti in SchemaDeclaration o restituiti da Tablename nella clausola WITH, in base alla corrispondenza dei nomi.</span><span class="sxs-lookup"><span data-stu-id="138d1-259">The XML attributes are mapped to the attributes that are defined in the SchemaDeclaration or that are provided by the Tablename of the WITH clause, based on name correspondence.</span></span> <span data-ttu-id="138d1-260">La corrispondenza dei nomi indica che gli attributi XML con un nome specifico vengono archiviati in una colonna del set di righe con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="138d1-260">Name correspondence means that the XML attributes of a particular name are stored in a column in the rowset with the same name.</span></span>

 <span data-ttu-id="138d1-261">Se il nome della colonna è diverso dal nome dell'attributo a cui viene eseguito il mapping della colonna, è necessario specificare il parametro *ColPattern* .</span><span class="sxs-lookup"><span data-stu-id="138d1-261">If the column name is different from the attribute name that it maps to, *ColPattern* must be specified.</span></span>

 <span data-ttu-id="138d1-262">Se l'attributo XML è associato a un qualificatore dello spazio dei nomi, anche il nome della colonna del set di righe deve essere associato a un qualificatore.</span><span class="sxs-lookup"><span data-stu-id="138d1-262">If the XML attribute has a namespace qualifier, the column name in the rowset must also have the qualifier.</span></span>

#### <a name="element-centric-mapping"></a><span data-ttu-id="138d1-263">Mapping incentrato sugli elementi</span><span class="sxs-lookup"><span data-stu-id="138d1-263">Element-centric Mapping</span></span>
 <span data-ttu-id="138d1-264">Se il parametro *flags* dell'istruzione OPENXML viene impostato su 2 (XML_ELEMENTS), viene definito un mapping **incentrato sugli elementi** .</span><span class="sxs-lookup"><span data-stu-id="138d1-264">Setting the *flags* parameter in OPENXML to 2 (XML_ELEMENTS) specifies **element-centric** mapping.</span></span> <span data-ttu-id="138d1-265">Pur essendo simile al mapping **incentrato sugli attributi** , questo tipo di mapping è caratterizzato dalle differenze seguenti:</span><span class="sxs-lookup"><span data-stu-id="138d1-265">It is similar to **attribute-centric** mapping, except for the following differences:</span></span>

-   <span data-ttu-id="138d1-266">In base alla corrispondenza dei nomi del mapping, ad esempio una colonna su cui viene eseguito il mapping a un elemento XML avente lo stesso nome, verranno selezionati i sottoelementi non complessi a meno che non venga specificato un modello dei livelli delle colonne.</span><span class="sxs-lookup"><span data-stu-id="138d1-266">The name correspondence of the mapping example, a column mapping to an XML element with the same name chooses the noncomplex subelements, unless a column-level pattern is specified.</span></span> <span data-ttu-id="138d1-267">Nella fase di recupero dei dati, se il sottoelemento è complesso perché include altri sottoelementi, la colonna verrà impostata su NULL</span><span class="sxs-lookup"><span data-stu-id="138d1-267">In the retrieval process, if the subelement is complex because it contains additional subelements, the column is set to NULL.</span></span> <span data-ttu-id="138d1-268">e i valori degli attributi dei sottoelementi verranno ignorati.</span><span class="sxs-lookup"><span data-stu-id="138d1-268">Attribute values of the subelements are then ignored.</span></span>

-   <span data-ttu-id="138d1-269">Nel caso di più sottoelementi con lo stesso nome, verrà restituito il primo nodo.</span><span class="sxs-lookup"><span data-stu-id="138d1-269">For multiple subelements that have the same name, the first node is returned.</span></span>

## <a name="see-also"></a><span data-ttu-id="138d1-270">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="138d1-270">See Also</span></span>
 <span data-ttu-id="138d1-271">[sp_xml_preparedocument &#40;Transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql) [sp_xml_removedocument &#40;Transact-sql](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql)&#41;[OpenXML &#40;Transact-SQL](/sql/t-sql/functions/openxml-transact-sql)&#41;[dati XML](../xml/xml-data-sql-server.md) &#40;SQL Server</span><span class="sxs-lookup"><span data-stu-id="138d1-271">[sp_xml_preparedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-preparedocument-transact-sql) [sp_xml_removedocument &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-xml-removedocument-transact-sql) [OPENXML &#40;Transact-SQL&#41;](/sql/t-sql/functions/openxml-transact-sql) [XML Data &#40;SQL Server&#41;](../xml/xml-data-sql-server.md)</span></span>


