---
title: Creare una sottoscrizione per un Sottoscrittore non SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- subscriptions [SQL Server replication], non-SQL Server Subscribers
- Subscribers [SQL Server replication], non-SQL Server Subscribers
- non-SQL Server Subscribers, subscriptions
ms.assetid: 5020ee68-b988-4d57-8066-67d183e61237
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 31a7d1e52c53cb858039f1fd0ed403f255ad5ca2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87714199"
---
# <a name="create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="d411a-102">Creazione di una sottoscrizione per un Sottoscrittore non SQL Server</span><span class="sxs-lookup"><span data-stu-id="d411a-102">Create a Subscription for a Non-SQL Server Subscriber</span></span>
  <span data-ttu-id="d411a-103">In questo argomento viene descritto come creare una sottoscrizione per un Sottoscrittore non SQL Server in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d411a-103">This topic describes how to create a subscription for a non-SQL Server Subscriber in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="d411a-104">La replica transazionale e la replica snapshot supportano la pubblicazione di dati su Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d411a-104">Transactional and snapshot replication support publishing data to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span> <span data-ttu-id="d411a-105">Per informazioni sulle piattaforme di Sottoscrittori supportate, vedere [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-105">For information about supported Subscriber platforms, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
 <span data-ttu-id="d411a-106">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="d411a-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="d411a-107">**Per creare una sottoscrizione per un Sottoscrittore non SQL Server, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="d411a-107">**To create a subscription for a non-SQL Server Subscriber, using:**</span></span>  
  
     [<span data-ttu-id="d411a-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="d411a-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="d411a-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d411a-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="d411a-110">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="d411a-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="d411a-111">Per creare una sottoscrizione per un Sottoscrittore non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="d411a-111">To create a subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber:</span></span>  
  
1.  <span data-ttu-id="d411a-112">Installare e configurare il software client e il provider o i provider OLE DB appropriati sul database di distribuzione [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d411a-112">Install and configure the appropriate client software and OLE DB provider(s) on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Distributor.</span></span> <span data-ttu-id="d411a-113">Per ulteriori informazioni, vedere [Oracle Subscribers](non-sql/oracle-subscribers.md) e [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-113">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="d411a-114">Creare una pubblicazione utilizzando la Creazione guidata nuova pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-114">Create a publication using the New Publication Wizard.</span></span> <span data-ttu-id="d411a-115">Per informazioni sulla creazione di pubblicazioni, vedere [Creare una pubblicazione](publish/create-a-publication.md) e [Creare una pubblicazione da un database Oracle](publish/create-a-publication-from-an-oracle-database.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-115">For more information about creating publications, see [Create a Publication](publish/create-a-publication.md) and [Create a Publication from an Oracle Database](publish/create-a-publication-from-an-oracle-database.md).</span></span> <span data-ttu-id="d411a-116">Specificare le opzioni seguenti nella Creazione guidata nuova pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-116">Specify the following options in the New Publication Wizard:</span></span>  
  
    -   <span data-ttu-id="d411a-117">Nella pagina **Tipo di pubblicazione** selezionare **Pubblicazione snapshot** o **Pubblicazione transazionale**.</span><span class="sxs-lookup"><span data-stu-id="d411a-117">On the **Publication Type** page, select **Snapshot publication** or **Transactional publication**.</span></span>  
  
    -   <span data-ttu-id="d411a-118">Nella pagina **Agente snapshot** , deselezionare **Crea snapshot immediatamente**.</span><span class="sxs-lookup"><span data-stu-id="d411a-118">On the **Snapshot Agent** page, clear **Create a snapshot immediately**.</span></span>  
  
         <span data-ttu-id="d411a-119">Lo snapshot viene creato dopo che la pubblicazione è stata attivata per i Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , in modo da garantire che l'agente snapshot generi uno snapshot e script di inizializzazione che siano adatti ai Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d411a-119">You create the snapshot after the publication is enabled for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers to ensure that the Snapshot Agent generates a snapshot and initialization scripts that are suitable for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
3.  <span data-ttu-id="d411a-120">Abilitare la pubblicazione per i Sottoscrittori non [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] usando la finestra di dialogo **Proprietà pubblicazione - \<PublicationName>** .</span><span class="sxs-lookup"><span data-stu-id="d411a-120">Enable the publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers using the **Publication Properties - \<PublicationName>** dialog box.</span></span> <span data-ttu-id="d411a-121">Per ulteriori informazioni su questo passaggio, vedere [Publication Properties, Subscription Options](publication-properties-subscription-options.md) .</span><span class="sxs-lookup"><span data-stu-id="d411a-121">See [Publication Properties, Subscription Options](publication-properties-subscription-options.md) for more information about this step.</span></span>  
  
4.  <span data-ttu-id="d411a-122">Creare una sottoscrizione utilizzando la Creazione guidata nuova sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-122">Create a subscription using the New Subscription Wizard.</span></span> <span data-ttu-id="d411a-123">In questo argomento sono presenti ulteriori informazioni su questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="d411a-123">This topic provides more information about this step.</span></span>  
  
5.  <span data-ttu-id="d411a-124">(Facoltativo) Modificare la proprietà di articolo **pre_creation_cmd** affinché le tabelle vengano mantenute nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="d411a-124">(Optional) Change the **pre_creation_cmd** article property to retain tables at the Subscriber.</span></span> <span data-ttu-id="d411a-125">In questo argomento sono presenti ulteriori informazioni su questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="d411a-125">This topic provides more information about this step.</span></span>  
  
6.  <span data-ttu-id="d411a-126">Generare uno snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-126">Generate a snapshot for the publication.</span></span> <span data-ttu-id="d411a-127">In questo argomento sono presenti ulteriori informazioni su questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="d411a-127">This topic provides more information about this step.</span></span>  
  
7.  <span data-ttu-id="d411a-128">Sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-128">Synchronize the subscription.</span></span> <span data-ttu-id="d411a-129">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione push](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-129">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-enable-a-publication-for-non-sql-server-subscribers"></a><span data-ttu-id="d411a-130">Per abilitare una pubblicazione per Sottoscrittori non SQL Server</span><span class="sxs-lookup"><span data-stu-id="d411a-130">To enable a publication for non-SQL Server Subscribers</span></span>  
  
1.  <span data-ttu-id="d411a-131">Connettersi al server di pubblicazione in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="d411a-131">Connect to the Publisher in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="d411a-132">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="d411a-132">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="d411a-133">Fare clic con il pulsante destro del mouse sulla pubblicazione e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="d411a-133">Right-click the publication, and then click **Properties**.</span></span>  
  
4.  <span data-ttu-id="d411a-134">Nella pagina **Opzioni sottoscrizione** , selezionare il valore **True** per l'opzione **Consenti Sottoscrittori non SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="d411a-134">On the **Subscription Options** page, select a value of **True** for the option **Allow non-SQL Server Subscribers**.</span></span> <span data-ttu-id="d411a-135">Se si seleziona questa opzione vengono modificate alcune proprietà in modo che la pubblicazione sia compatibile con i Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d411a-135">Selecting this option changes a number of properties so that the publication is compatible with non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d411a-136">Selezionando **True** , il valore della proprietà dell'articolo **pre_creation_cmd** viene impostato su 'drop'.</span><span class="sxs-lookup"><span data-stu-id="d411a-136">Selecting **True** sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="d411a-137">In base a tale impostazione, se una tabella nel Sottoscrittore corrisponde al nome della tabella nell'articolo, tale tabella verrà eliminata dalla replica.</span><span class="sxs-lookup"><span data-stu-id="d411a-137">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="d411a-138">Se si dispone di tabelle esistenti che si desidera mantenere, utilizzare la stored procedure [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) per ogni articolo e specificare il valore 'none' per **pre_creation_cmd**: `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span><span class="sxs-lookup"><span data-stu-id="d411a-138">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**: `sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
5.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="d411a-139">Verrà richiesto di creare un nuovo snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-139">You will be prompted to create a new snapshot for the publication.</span></span> <span data-ttu-id="d411a-140">Se non si desidera crearlo in questo momento, utilizzare i passaggi descritti nella "Procedura" seguente in un momento successivo.</span><span class="sxs-lookup"><span data-stu-id="d411a-140">If you do not want to create one at this time, use the steps described in the next "how to" procedure at a later time.</span></span>  
  
#### <a name="to-create-a-subscription-for-a-non-sql-server-subscriber"></a><span data-ttu-id="d411a-141">Per creare una sottoscrizione per un Sottoscrittore non SQL Server</span><span class="sxs-lookup"><span data-stu-id="d411a-141">To create a subscription for a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="d411a-142">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="d411a-142">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="d411a-143">Fare clic con il pulsante destro del mouse sulla pubblicazione appropriata e quindi scegliere **Nuove sottoscrizioni**.</span><span class="sxs-lookup"><span data-stu-id="d411a-143">Right-click the appropriate publication, and then click **New Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="d411a-144">Verificare che l'opzione **Esegui tutti gli agenti nel server di distribuzione** nella pagina **Posizione in cui eseguire l'agente di distribuzione** sia selezionata.</span><span class="sxs-lookup"><span data-stu-id="d411a-144">On the **Distribution Agent Location** page, ensure **Run all agents at the Distributor** is selected.</span></span> <span data-ttu-id="d411a-145">I Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] non supportano l'esecuzione di agenti nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="d411a-145">Non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers do not support running agents at the Subscriber.</span></span>  
  
4.  <span data-ttu-id="d411a-146">Nella pagina **Sottoscrittori** , fare clic su **Aggiungi Sottoscrittore** , quindi su **Aggiungi Sottoscrittore non SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="d411a-146">On the **Subscribers** page, click **Add Subscriber** and then click **Add Non-SQL Server Subscriber**.</span></span>  
  
5.  <span data-ttu-id="d411a-147">Nella finestra di dialogo **Aggiungi Sottoscrittore non SQL Server** , selezionare il tipo di Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="d411a-147">In the **Add Non-SQL Server Subscriber** dialog box, select the type of Subscriber.</span></span>  
  
6.  <span data-ttu-id="d411a-148">Inserire un valore nella casella **Nome origine dati**:</span><span class="sxs-lookup"><span data-stu-id="d411a-148">Enter a value in **Data source name**:</span></span>  
  
    -   <span data-ttu-id="d411a-149">Per Oracle, si tratta del nome TNS che è stato configurato.</span><span class="sxs-lookup"><span data-stu-id="d411a-149">For Oracle, this is the transparent network substrate (TNS) name you configured.</span></span>  
  
    -   <span data-ttu-id="d411a-150">Per IBM, può essere qualsiasi nome.</span><span class="sxs-lookup"><span data-stu-id="d411a-150">For IBM, this can be any name.</span></span> <span data-ttu-id="d411a-151">In genere viene utilizzato per specificare l'indirizzo di rete del Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="d411a-151">It is typical to specify the network address of the Subscriber.</span></span>  
  
     <span data-ttu-id="d411a-152">Il nome origine dati immesso in questo passaggio e le credenziali specificate nel passaggio 9 non vengono convalidati da questa procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="d411a-152">The data source name entered in this step and the credentials specified in step 9 are not validated by this wizard.</span></span> <span data-ttu-id="d411a-153">Non vengono utilizzati dalla replica fino all'esecuzione dell'agente di distribuzione per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-153">They are not used by replication until the Distribution Agent runs for the subscription.</span></span> <span data-ttu-id="d411a-154">Accertarsi che tutti i valori siano stati verificati connettendosi al Sottoscrittore con uno strumento client come **sqlplus** per Oracle.</span><span class="sxs-lookup"><span data-stu-id="d411a-154">Ensure that all values have been tested by connecting to the Subscriber using a client tool (such as **sqlplus** for Oracle).</span></span> <span data-ttu-id="d411a-155">Per ulteriori informazioni, vedere [Oracle Subscribers](non-sql/oracle-subscribers.md) e [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-155">For more information, see [Oracle Subscribers](non-sql/oracle-subscribers.md) and [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
7.  [!INCLUDE[clickOK](../../includes/clickok-md.md)] <span data-ttu-id="d411a-156">Nella pagina **Sottoscrittori** della procedura guidata, il Sottoscrittore è ora visualizzato nella colonna **Sottoscrittore** con una **(destinazione predefinita)** di sola lettura nella colonna **Database di sottoscrizione** :</span><span class="sxs-lookup"><span data-stu-id="d411a-156">On the **Subscribers** page of the wizard, the Subscriber is now displayed in the **Subscriber** column with a read-only **(default destination)** in the **Subscription Database** column:</span></span>  
  
    -   <span data-ttu-id="d411a-157">Per Oracle, un server include al massimo un database e pertanto non è necessario specificare il database.</span><span class="sxs-lookup"><span data-stu-id="d411a-157">For Oracle, a server has at most one database, so it is not necessary to specify the database.</span></span>  
  
    -   <span data-ttu-id="d411a-158">Per IBM DB2, il database viene specificato nella proprietà **Catalogo iniziale** della stringa di connessione DB2, che può essere inserita nel campo **Opzioni di connessione aggiuntive** descritto più avanti in questo processo.</span><span class="sxs-lookup"><span data-stu-id="d411a-158">For IBM DB2, the database is specified in the **Initial Catalog** property of the DB2 connection string, which can be entered in the **Additional connection options** field described later in this process.</span></span>  
  
8.  <span data-ttu-id="d411a-159">Nella pagina **sicurezza agente di distribuzione** fare clic sul pulsante delle proprietà (**...**) accanto al Sottoscrittore per accedere alla finestra di dialogo **agente di distribuzione sicurezza** .</span><span class="sxs-lookup"><span data-stu-id="d411a-159">On the **Distribution Agent Security** page, click the properties button (**...**) next to the Subscriber to access the **Distribution Agent Security** dialog box.</span></span>  
  
9. <span data-ttu-id="d411a-160">Nella finestra di dialogo **Sicurezza agente di distribuzione** :</span><span class="sxs-lookup"><span data-stu-id="d411a-160">In the **Distribution Agent Security** dialog box:</span></span>  
  
    -   <span data-ttu-id="d411a-161">Nei campi **Account processo**, **Password**e **Conferma password** , inserire l'account e la password di [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows con cui deve essere eseguito l'agente di distribuzione e stabilire le connessioni locali al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="d411a-161">In the **Process account**, **Password**, and **Confirm password** fields, enter the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account and password under which the Distribution Agent should run and make local connections to the Distributor.</span></span>  
  
         <span data-ttu-id="d411a-162">L'account richiede le autorizzazioni minime seguenti: membro del ruolo predefinito **db_owner** del database di distribuzione, membro dell'elenco di accesso alla pubblicazione, autorizzazione di lettura sulla condivisione snapshot e autorizzazione di lettura sulla directory di installazione del provider OLE DB.</span><span class="sxs-lookup"><span data-stu-id="d411a-162">The account requires these minimum permissions: member of the **db_owner** fixed database role in the distribution database; member of the publication access list (PAL); read permissions on the snapshot share; and read permission on the install directory of the OLE DB provider.</span></span> <span data-ttu-id="d411a-163">Per altre informazioni sull'elenco di acceso alla pubblicazione, vedere [Proteggere il server di pubblicazione](security/secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-163">For more information about the PAL, see [Secure the Publisher](security/secure-the-publisher.md).</span></span>  
  
    -   <span data-ttu-id="d411a-164">Nei campi **Nome account di accesso**, **Password**e **Conferma password**di **Connessione al Sottoscrittore** , inserire il nome account di accesso e la password da utilizzare per la connessione al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="d411a-164">Under **Connect to the Subscriber**, in the **Login**, **Password**, and **Confirm password** fields, enter the login and password that should be used to connect to the Subscriber.</span></span> <span data-ttu-id="d411a-165">Questo nome account di accesso dovrebbe essere già configurato ed avere autorizzazioni sufficienti per la creazione di oggetti nel database di sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-165">This login should already be configured and should have sufficient permissions to create objects in the subscription database.</span></span>  
  
    -   <span data-ttu-id="d411a-166">Nel campo **Opzioni di connessione aggiuntive** , specificare le eventuali opzioni di connessione per il Sottoscrittore nel formato di stringa di connessione (Oracle non richiede opzioni aggiuntive).</span><span class="sxs-lookup"><span data-stu-id="d411a-166">In the **Additional connection options** field, specify any connection options for the Subscriber in the form of a connection string (Oracle does not require additional options).</span></span> <span data-ttu-id="d411a-167">Le opzioni devono essere separate dal punto e virgola.</span><span class="sxs-lookup"><span data-stu-id="d411a-167">Each option should be separated by a semi-colon.</span></span> <span data-ttu-id="d411a-168">L'esempio seguente illustra una stringa di connessione DB2 (le interruzioni di riga sono inserite per agevolare la lettura):</span><span class="sxs-lookup"><span data-stu-id="d411a-168">The following is an example of a DB2 connection string (line breaks are for readability):</span></span>  
  
        ```  
        Provider=DB2OLEDB;Initial Catalog=MY_SUBSCRIBER_DB;Network Transport Library=TCP;Host CCSID=1252;  
        PC Code Page=1252;Network Address=MY_SUBSCRIBER;Network Port=50000;Package Collection=MY_PKGCOL;  
        Default Schema=MY_SCHEMA;Process Binary as Character=False;Units of Work=RUW;DBMS Platform=DB2/NT;  
        Persist Security Info=False;Connection Pooling=True;  
        ```  
  
         <span data-ttu-id="d411a-169">La maggior parte delle opzioni nella stringa è specifica per il server DB2 configurato, ma è necessario che l'opzione **Process Binary as Character** sia sempre impostata su **False**.</span><span class="sxs-lookup"><span data-stu-id="d411a-169">Most of the options in the string are specific to the DB2 server you are configuring, but the **Process Binary as Character** option should always be set to **False**.</span></span> <span data-ttu-id="d411a-170">È necessario specificare un valore per l'opzione **Initial Catalog** per identificare il database di sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-170">A value is required for the **Initial Catalog** option to identify the subscription database.</span></span>  
  
10. <span data-ttu-id="d411a-171">Nella pagina **Pianificazione della sincronizzazione** , selezionare una pianificazione per l'agente di distribuzione dal menu **Pianificazione agente** . In genere è **Esecuzione continua**.</span><span class="sxs-lookup"><span data-stu-id="d411a-171">On the **Synchronization Schedule** page, select a schedule for the Distribution Agent from the **Agent Schedule** menu (the schedule is typically **Run continuously**).</span></span>  
  
11. <span data-ttu-id="d411a-172">Nella pagina **Inizializzazione sottoscrizioni** , specificare se la sottoscrizione deve essere inizializzata e quando:</span><span class="sxs-lookup"><span data-stu-id="d411a-172">On the **Initialize Subscriptions** page, specify whether the subscription should be initialized and, if so, when it should be initialized:</span></span>  
  
    -   <span data-ttu-id="d411a-173">Deselezionare **Inizializzazione di** solo se nel database di sottoscrizione sono stati creati tutti gli oggetti e sono stati aggiunti tutti i dati necessari.</span><span class="sxs-lookup"><span data-stu-id="d411a-173">Clear **Initialize** only if you have created all objects and added all required data in the subscription database.</span></span>  
  
    -   <span data-ttu-id="d411a-174">Selezionare **Immediatamente** nell'elenco a discesa della colonna **Quando** per ottenere il trasferimento dei file di snapshot da parte dell'agente di distribuzione al Sottoscrittore al termine di questa procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="d411a-174">Select **Immediately** from the drop-down list in the **Initialize When** column to have the Distribution Agent transfer snapshot files to the Subscriber after this wizard is completed.</span></span> <span data-ttu-id="d411a-175">Selezionare **Alla prima sincronizzazione** per fare in modo che l'agente trasferisca i file alla successiva esecuzione pianificata dell'agente.</span><span class="sxs-lookup"><span data-stu-id="d411a-175">Select **At first synchronization** to have the agent transfer the files the next time it is scheduled to run.</span></span>  
  
12. <span data-ttu-id="d411a-176">Nella pagina **Azioni procedura guidata** , se si desidera, creare lo script della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-176">On the **Wizard Actions** page, optionally script the subscription.</span></span> <span data-ttu-id="d411a-177">Per altre informazioni, vedere [Scripting Replication](scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-177">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
#### <a name="to-retain-tables-at-the-subscriber"></a><span data-ttu-id="d411a-178">Per mantenere le tabelle nel Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="d411a-178">To retain tables at the Subscriber</span></span>  
  
-   <span data-ttu-id="d411a-179">Per impostazione predefinita, se si attiva una pubblicazione per Sottoscrittori non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , il valore della proprietà di articolo **pre_creation_cmd** verrà impostato su 'drop'.</span><span class="sxs-lookup"><span data-stu-id="d411a-179">By default, enabling a publication for non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers sets the value of the **pre_creation_cmd** article property to 'drop'.</span></span> <span data-ttu-id="d411a-180">In base a tale impostazione, se una tabella nel Sottoscrittore corrisponde al nome della tabella nell'articolo, tale tabella verrà eliminata dalla replica.</span><span class="sxs-lookup"><span data-stu-id="d411a-180">This setting specifies that replication should drop a table at the Subscriber if it matches the name of the table in the article.</span></span> <span data-ttu-id="d411a-181">Se si dispone di tabelle esistenti nel Sottoscrittore che si desidera mantenere, utilizzare la stored procedure [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) per ogni articolo e specificare il valore 'none' per **pre_creation_cmd**.</span><span class="sxs-lookup"><span data-stu-id="d411a-181">If you have existing tables at the Subscriber that you want to keep, use the [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql) stored procedure for each article; specify a value 'none' for **pre_creation_cmd**.</span></span> <span data-ttu-id="d411a-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span><span class="sxs-lookup"><span data-stu-id="d411a-182">`sp_changearticle @publication= 'MyPublication', @article= 'MyArticle', @property='pre_creation_cmd', @value='none'`.</span></span>  
  
#### <a name="to-generate-a-snapshot-for-the-publication"></a><span data-ttu-id="d411a-183">Per generare uno snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-183">To generate a snapshot for the publication</span></span>  
  
1.  <span data-ttu-id="d411a-184">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="d411a-184">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
2.  <span data-ttu-id="d411a-185">Fare clic con il pulsante destro del mouse sulla pubblicazione e quindi scegliere **Visualizza stato agente snapshot**.</span><span class="sxs-lookup"><span data-stu-id="d411a-185">Right-click the publication, and then click **View Snapshot Agent Status**.</span></span>  
  
3.  <span data-ttu-id="d411a-186">Nella finestra di dialogo **Visualizza stato agente snapshot - \<Publication>** fare clic su **Avvia**.</span><span class="sxs-lookup"><span data-stu-id="d411a-186">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="d411a-187">Al termine della generazione dello snapshot da parte dell'agente, viene visualizzato un messaggio come ""[100%] Generato uno snapshot di 17 articoli."</span><span class="sxs-lookup"><span data-stu-id="d411a-187">When the Snapshot Agent finishes generating the snapshot, a message is displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="d411a-188">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d411a-188">Using Transact-SQL</span></span>  
 <span data-ttu-id="d411a-189">È possibile creare sottoscrizioni push a Sottoscrittori[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="d411a-189">You can create push subscriptions to non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers programmatically using replication stored procedures.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="d411a-190">Se possibile, richiedere agli utenti di immettere le credenziali di sicurezza in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="d411a-190">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="d411a-191">Se è necessario archiviare le credenziali in un file script, è fondamentale proteggere il file per evitare accessi non autorizzati.</span><span class="sxs-lookup"><span data-stu-id="d411a-191">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-for-a-transactional-or-snapshot-publication-to-a-non-sql-server-subscriber"></a><span data-ttu-id="d411a-192">Per creare una sottoscrizione push per una pubblicazione transazionale o snapshot in un Sottoscrittore non SQL Server</span><span class="sxs-lookup"><span data-stu-id="d411a-192">To create a push subscription for a transactional or snapshot publication to a non-SQL Server Subscriber</span></span>  
  
1.  <span data-ttu-id="d411a-193">Installare il provider OLE DB più recente per il Sottoscrittore non[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sia nel server di pubblicazione che nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="d411a-193">Install the most recent OLE DB provider for the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber at both the Publisher and Distributor.</span></span> <span data-ttu-id="d411a-194">Per i requisiti di replica relativi a un provider OLE DB, vedere [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md), [Oracle Subscribers](non-sql/oracle-subscribers.md), [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-194">For the replication requirements for an OLE DB provider, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md), [Oracle Subscribers](non-sql/oracle-subscribers.md), [IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md).</span></span>  
  
2.  <span data-ttu-id="d411a-195">Nel database di pubblicazione del server di pubblicazione eseguire [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql) per verificare che la pubblicazione supporti Sottoscrittori non [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d411a-195">At the Publisher on the publication database, verify that the publication supports non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers by executing [sp_helppublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="d411a-196">Se il valore di `enabled_for_het_sub` è 1, i Sottoscrittori non [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sono supportati.</span><span class="sxs-lookup"><span data-stu-id="d411a-196">If the value of `enabled_for_het_sub` is 1, non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscribers are supported.</span></span>  
  
    -   <span data-ttu-id="d411a-197">Se il valore di `enabled_for_het_sub` è 0, eseguire [sp_changepublication &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specificando `enabled_for_het_sub` per **@property** e `true` per **@value** .</span><span class="sxs-lookup"><span data-stu-id="d411a-197">If the value of `enabled_for_het_sub` is 0, execute [sp_changepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `enabled_for_het_sub` for **@property** and `true` for **@value**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="d411a-198">Prima di impostare `enabled_for_het_sub` su `true`, è necessario eliminare eventuali sottoscrizioni esistenti nella pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-198">Before changing `enabled_for_het_sub` to `true`, you must drop any existing subscriptions to the publication.</span></span> <span data-ttu-id="d411a-199">Non è possibile impostare `enabled_for_het_sub` su `true` se la pubblicazione supporta anche sottoscrizioni aggiornabili.</span><span class="sxs-lookup"><span data-stu-id="d411a-199">You cannot set `enabled_for_het_sub` to `true` when the publication also supports updating subscriptions.</span></span> <span data-ttu-id="d411a-200">La modifica dell'impostazione `enabled_for_het_sub` influirà su altre proprietà della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="d411a-200">Changing `enabled_for_het_sub` will affect other publication properties.</span></span> <span data-ttu-id="d411a-201">Per altre informazioni, vedere [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-201">For more information, see [Non-SQL Server Subscribers](non-sql/non-sql-server-subscribers.md).</span></span>  
  
3.  <span data-ttu-id="d411a-202">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d411a-202">At the Publisher on the publication database, execute [sp_addsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="d411a-203">Specificare **@publication** , **@subscriber** , il valore **(destinazione predefinita)** per **@destination_db** , il valore **push** per **@subscription_type** e il valore 3 per **@subscriber_type** (specifica un provider di OLE DB).</span><span class="sxs-lookup"><span data-stu-id="d411a-203">Specify **@publication**, **@subscriber**, a value of **(default destination)** for **@destination_db**, a value of **push** for **@subscription_type**, and a value of 3 for **@subscriber_type** (specifies an OLE DB provider).</span></span>  
  
4.  <span data-ttu-id="d411a-204">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d411a-204">At the Publisher on the publication database, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="d411a-205">Specificare le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="d411a-205">Specify the following:</span></span>  
  
    -   <span data-ttu-id="d411a-206">**@subscriber**Parametri e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="d411a-206">The **@subscriber**and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="d411a-207">Valore **(destinazione predefinita)** per **@subscriber_db** ,</span><span class="sxs-lookup"><span data-stu-id="d411a-207">A value of **(default destination)** for **@subscriber_db**,</span></span>  
  
    -   <span data-ttu-id="d411a-208">Proprietà dell' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] origine dati non per **@subscriber_provider** , **@subscriber_datasrc** , **@subscriber_location** , **@subscriber_provider_string** e **@subscriber_catalog** .</span><span class="sxs-lookup"><span data-stu-id="d411a-208">The properties of the non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data source for **@subscriber_provider**, **@subscriber_datasrc**, **@subscriber_location**, **@subscriber_provider_string**, and **@subscriber_catalog**.</span></span>  
  
    -   <span data-ttu-id="d411a-209">Le [!INCLUDE[msCoName](../../includes/msconame-md.md)] credenziali di Windows con cui viene eseguito il agente di distribuzione nel server di distribuzione per **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="d411a-209">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="d411a-210">Le connessioni effettuate con l'autenticazione integrata di Windows utilizzano sempre le credenziali di Windows specificate da **@job_login** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="d411a-210">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="d411a-211">L'agente di distribuzione esegue sempre la connessione locale al server di distribuzione utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="d411a-211">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="d411a-212">Per impostazione predefinita, l'agente si connette al Sottoscrittore utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="d411a-212">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="d411a-213">Il valore **0** per **@subscriber_security_mode** e le informazioni sull'account di accesso del provider OLE DB per **@subscriber_login** e **@subscriber_password** .</span><span class="sxs-lookup"><span data-stu-id="d411a-213">A value of **0** for **@subscriber_security_mode** and the OLE DB provider login information for **@subscriber_login** and **@subscriber_password**.</span></span>  
  
    -   <span data-ttu-id="d411a-214">Specificare una pianificazione per il processo dell'agente di distribuzione da eseguire per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="d411a-214">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="d411a-215">Per altre informazioni, vedere [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-215">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="d411a-216">Quando si crea una sottoscrizione push in un server di pubblicazione per un server di distribuzione remoto, i valori specificati per tutti i parametri, compresi *job_login* e *job_password*, vengono inviati al server di distribuzione come testo normale.</span><span class="sxs-lookup"><span data-stu-id="d411a-216">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="d411a-217">È consigliabile crittografare la connessione tra il server di pubblicazione e il server di distribuzione remoto prima di eseguire questa stored procedure.</span><span class="sxs-lookup"><span data-stu-id="d411a-217">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="d411a-218">Per altre informazioni, vedere [Abilitare le connessioni crittografate al motore di database &#40;Gestione configurazione SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="d411a-218">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d411a-219">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="d411a-219">See Also</span></span>  
 <span data-ttu-id="d411a-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="d411a-220">[IBM DB2 Subscribers](non-sql/ibm-db2-subscribers.md) </span></span>  
 <span data-ttu-id="d411a-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="d411a-221">[Oracle Subscribers](non-sql/oracle-subscribers.md) </span></span>  
 <span data-ttu-id="d411a-222">[Altri Sottoscrittori non SQL Server](non-sql/other-non-sql-server-subscribers.md) </span><span class="sxs-lookup"><span data-stu-id="d411a-222">[Other Non-SQL Server Subscribers](non-sql/other-non-sql-server-subscribers.md) </span></span>  
 <span data-ttu-id="d411a-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="d411a-223">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="d411a-224">Procedure consigliate per la sicurezza della replica</span><span class="sxs-lookup"><span data-stu-id="d411a-224">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
