---
title: Implementare un gestore della logica di business per un articolo di merge | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], business logic handlers
- merge replication business logic handlers [SQL Server replication]
- conflict resolution [SQL Server replication], merge replication
- business logic handlers [SQL Server replication]
- BusinessLogicModule class
ms.assetid: ed477595-6d46-4fa2-b0d3-a5358903ec05
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c2996a8ca8471ef59d4781e21239a72262daa759
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624591"
---
# <a name="implement-a-business-logic-handler-for-a-merge-article"></a><span data-ttu-id="c554a-102">Implementazione di un gestore della logica di business per un articolo di merge</span><span class="sxs-lookup"><span data-stu-id="c554a-102">Implement a Business Logic Handler for a Merge Article</span></span>
  <span data-ttu-id="c554a-103">In questo argomento viene descritto come implementare un gestore della logica di business per un articolo di tipo merge in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] tramite la programmazione della replica o RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="c554a-103">This topic describes how to implement a business logic handler for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using replication programming or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="c554a-104">Lo spazio dei nomi <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> implementa un'interfaccia che consente di scrivere logica di business complessa per gestire gli eventi che si verificano durante il processo di sincronizzazione della replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="c554a-104">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="c554a-105">I metodi del gestore della logica di business possono essere richiamati dal processo di replica per ogni riga modificata che viene replicata durante la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="c554a-105">Methods in the business logic handler can be invoked by the replication process for each changed row that is replicated during synchronization.</span></span>  
  
 <span data-ttu-id="c554a-106">Il processo generale per l'implementazione di un gestore della logica di business è il seguente:</span><span class="sxs-lookup"><span data-stu-id="c554a-106">The general process for implementing a business logic handler is:</span></span>  
  
1.  <span data-ttu-id="c554a-107">Creazione dell'assembly del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-107">Create the business logic hander assembly.</span></span>  
  
2.  <span data-ttu-id="c554a-108">Registrazione dell'assembly nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c554a-108">Register the assembly at the Distributor.</span></span>  
  
3.  <span data-ttu-id="c554a-109">Distribuzione dell'assembly nel server in cui viene eseguito l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="c554a-109">Deploy the assembly at the server on which the Merge Agent runs.</span></span> <span data-ttu-id="c554a-110">Per una sottoscrizione pull, l'agente viene eseguito nel Sottoscrittore, mentre per una sottoscrizione push nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c554a-110">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="c554a-111">Quando si utilizza la sincronizzazione tramite il Web, l'agente viene eseguito nel server Web.</span><span class="sxs-lookup"><span data-stu-id="c554a-111">When you are using Web synchronization, the agent runs on the Web server.</span></span>  
  
4.  <span data-ttu-id="c554a-112">Creazione di un articolo che utilizza il gestore della logica di business o modifica di un articolo esistente per l'utilizzo del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-112">Create an article that uses the business logic handler or modify an existing article to use the business logic handler.</span></span>  
  
 <span data-ttu-id="c554a-113">Il gestore della logica di business specificato viene eseguito per ogni riga sincronizzata.</span><span class="sxs-lookup"><span data-stu-id="c554a-113">The business logic handler you specify is executed for every row that is synchronized.</span></span> <span data-ttu-id="c554a-114">La complessità della logica e le chiamate ad altre applicazioni o servizi di rete possono ridurre le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="c554a-114">Complex logic and calls to other applications or network services can impact performance.</span></span> <span data-ttu-id="c554a-115">Per altre informazioni sui gestori della logica di business, vedere [Eseguire logiche di business durante la sincronizzazione di tipo merge](merge/execute-business-logic-during-merge-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="c554a-115">For more information about business logic handlers, see [Execute Business Logic During Merge Synchronization](merge/execute-business-logic-during-merge-synchronization.md).</span></span>  
  
 <span data-ttu-id="c554a-116">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="c554a-116">**In This Topic**</span></span>  
  
-   <span data-ttu-id="c554a-117">**Per implementare un gestore della logica di business per un articolo di merge, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="c554a-117">**To implement a business logic handler for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="c554a-118">Programmazione della replica</span><span class="sxs-lookup"><span data-stu-id="c554a-118">Replication Programming</span></span>](#ReplProg)  
  
     [<span data-ttu-id="c554a-119">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="c554a-119">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-replication-programming"></a><a name="ReplProg"></a> <span data-ttu-id="c554a-120">Utilizzo della programmazione della replica</span><span class="sxs-lookup"><span data-stu-id="c554a-120">Using Replication Programming</span></span>  
  
#### <a name="to-create-and-deploy-a-business-logic-handler"></a><span data-ttu-id="c554a-121">Per creare e distribuire un gestore della logica di business</span><span class="sxs-lookup"><span data-stu-id="c554a-121">To create and deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="c554a-122">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio creare un nuovo progetto per l'assembly .NET contenente il codice che implementa il gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-122">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="c554a-123">Aggiungere i riferimenti al progetto per gli spazi dei nomi seguenti.</span><span class="sxs-lookup"><span data-stu-id="c554a-123">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="c554a-124">Riferimento all'assembly</span><span class="sxs-lookup"><span data-stu-id="c554a-124">Assembly Reference</span></span>|<span data-ttu-id="c554a-125">Location</span><span class="sxs-lookup"><span data-stu-id="c554a-125">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="c554a-126">COM (installazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="c554a-126">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="c554a-127">GAC (componente di .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="c554a-127">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="c554a-128">GAC (componente di .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="c554a-128">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="c554a-129">Aggiungere una classe che esegue l'override della classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> .</span><span class="sxs-lookup"><span data-stu-id="c554a-129">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="c554a-130">Implementare la proprietà <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> per indicare i tipi di modifiche gestite.</span><span class="sxs-lookup"><span data-stu-id="c554a-130">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="c554a-131">Eseguire l'override di uno o più dei seguenti metodi della classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> :</span><span class="sxs-lookup"><span data-stu-id="c554a-131">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="c554a-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> : viene richiamato quando si esegue il commit di una modifica ai dati durante la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="c554a-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="c554a-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione DELETE.</span><span class="sxs-lookup"><span data-stu-id="c554a-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked when an error occurs when a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni DELETE.</span><span class="sxs-lookup"><span data-stu-id="c554a-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione INSERT.</span><span class="sxs-lookup"><span data-stu-id="c554a-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked when an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni INSERT.</span><span class="sxs-lookup"><span data-stu-id="c554a-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> : viene richiamato quando si verificano conflitti di istruzioni UPDATE nel server di pubblicazione e nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="c554a-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="c554a-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> : viene richiamato quando si verificano conflitti tra istruzioni UPDATE e istruzioni DELETE nel server di pubblicazione e nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="c554a-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="c554a-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione UPDATE.</span><span class="sxs-lookup"><span data-stu-id="c554a-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked when an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni UPDATE.</span><span class="sxs-lookup"><span data-stu-id="c554a-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
6.  <span data-ttu-id="c554a-141">Compilare il progetto per creare l'assembly del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-141">Build the project to create the business logic handler assembly.</span></span>  
  
7.  <span data-ttu-id="c554a-142">Distribuire l'assembly nella directory che contiene il file eseguibile dell'agente di merge (replmerg.exe), che per un'installazione predefinita è [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM, o installarlo nella Global Assembly Cache (GAC) .NET.</span><span class="sxs-lookup"><span data-stu-id="c554a-142">Deploy the assembly in the directory that contains the Merge Agent executable file (replmerg.exe), which for a default installation is [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM, or install it in the .NET global assembly cache (GAC).</span></span> <span data-ttu-id="c554a-143">È necessario installare l'assembly nella GAC solo se applicazioni diverse dall'agente di merge richiedono l'accesso all'assembly.</span><span class="sxs-lookup"><span data-stu-id="c554a-143">You should only install the assembly in the GAC if applications other than the Merge Agent require access to the assembly.</span></span> <span data-ttu-id="c554a-144">L'assembly può essere installato nella GAC tramite lo strumento Global Assembly Cache (**Gacutil.exe)** disponibile in .NET Framework SDK.</span><span class="sxs-lookup"><span data-stu-id="c554a-144">The assembly can be installed into the GAC using the Global Assembly Cache tool (**Gacutil.exe)** provided in the .NET Framework SDK.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c554a-145">È necessario distribuire un gestore della logica di business su ogni server in cui viene eseguito l'agente di merge, incluso il server IIS che ospita il file replisapi.dll quando si utilizza la sincronizzazione tramite il Web.</span><span class="sxs-lookup"><span data-stu-id="c554a-145">A business logic handler must be deployed on every server on which the Merge Agent runs, which includes the IIS server that hosts the replisapi.dll when using Web synchronization.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="c554a-146">Per registrare un gestore della logica di business</span><span class="sxs-lookup"><span data-stu-id="c554a-146">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="c554a-147">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) per verificare che l'assembly non sia già stato registrato come gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-147">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the assembly has not already been registered as a business logic handler.</span></span>  
  
2.  <span data-ttu-id="c554a-148">Nel server di distribuzione eseguire [sp_registercustomresolver &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), specificando un nome descrittivo per il gestore della logica di business per **@article_resolver** , `true` il valore per **@is_dotnet_assembly** , il nome dell'assembly per **@dotnet_assembly_name** e il nome completo della classe che esegue l'override di <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> per **@dotnet_class_name** .</span><span class="sxs-lookup"><span data-stu-id="c554a-148">At the Distributor, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), specifying a friendly name for the business logic handler for **@article_resolver**, a value of `true` for **@is_dotnet_assembly**, the name of the assembly for **@dotnet_assembly_name**, and the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> for **@dotnet_class_name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c554a-149">Se l'assembly non viene distribuito nella stessa directory del agente di merge eseguibile, nella stessa directory dell'applicazione che avvia in modo sincrono il agente di merge o nella Global Assembly Cache (GAC), è necessario specificare il percorso completo con il nome dell'assembly per **@dotnet_assembly_name** .</span><span class="sxs-lookup"><span data-stu-id="c554a-149">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the global assembly cache (GAC), you need to specify the full path with the assembly name for **@dotnet_assembly_name**.</span></span> <span data-ttu-id="c554a-150">Quando si utilizza la sincronizzazione tramite il Web, è necessario specificare il percorso dell'assembly nel server Web.</span><span class="sxs-lookup"><span data-stu-id="c554a-150">When using Web synchronization, you must specify the location of assembly at the Web server.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="c554a-151">Per utilizzare un gestore della logica di business con un nuovo articolo di tabella</span><span class="sxs-lookup"><span data-stu-id="c554a-151">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="c554a-152">Eseguire [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) per definire l'articolo, specificando il nome descrittivo del gestore della logica di business per **@article_resolver**.</span><span class="sxs-lookup"><span data-stu-id="c554a-152">Execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying the friendly name of the business logic handler for **@article_resolver**.</span></span> <span data-ttu-id="c554a-153">Per altre informazioni, vedere [definire un articolo](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="c554a-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="c554a-154">Per utilizzare un gestore della logica di business con un articolo di tabella esistente</span><span class="sxs-lookup"><span data-stu-id="c554a-154">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="c554a-155">Eseguire [sp_changemergearticle &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specificando **@publication** , **@article** , il valore **article_resolver** per **@property** e il nome descrittivo del gestore della logica di business per **@value** .</span><span class="sxs-lookup"><span data-stu-id="c554a-155">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the business logic handler for **@value**.</span></span>  
  
###  <a name="examples-replication-programming"></a><a name="TsqlExample"></a> <span data-ttu-id="c554a-156">Esempi (programmazione della replica)</span><span class="sxs-lookup"><span data-stu-id="c554a-156">Examples (Replication Programming)</span></span>  
 <span data-ttu-id="c554a-157">In questo esempio è illustrato un gestore della logica di business che crea un log di controllo.</span><span class="sxs-lookup"><span data-stu-id="c554a-157">This example shows a business logic handler that creates an audit log.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="c554a-158">Nell'esempio seguente viene registrato un assembly del gestore della logica di business nel database di distribuzione e viene modificato un articolo di merge esistente per l'utilizzo di questa logica di business personalizzata.</span><span class="sxs-lookup"><span data-stu-id="c554a-158">The following example registers a business logic handler assembly at the Distributor and changes an existing merge article to use this custom business logic.</span></span>  
  
 [!code-sql[HowTo#sp_RegisterBLH_10](../../snippets/tsql/SQL15/replication/howto/tsql/registerblh_10.sql#sp_registerblh_10)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="c554a-159">Utilizzo di RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="c554a-159">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-create-a-business-logic-handler"></a><span data-ttu-id="c554a-160">Per creare un gestore della logica di business</span><span class="sxs-lookup"><span data-stu-id="c554a-160">To create a business logic handler</span></span>  
  
1.  <span data-ttu-id="c554a-161">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio creare un nuovo progetto per l'assembly .NET contenente il codice che implementa il gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-161">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="c554a-162">Aggiungere i riferimenti al progetto per gli spazi dei nomi seguenti.</span><span class="sxs-lookup"><span data-stu-id="c554a-162">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="c554a-163">Riferimento all'assembly</span><span class="sxs-lookup"><span data-stu-id="c554a-163">Assembly Reference</span></span>|<span data-ttu-id="c554a-164">Location</span><span class="sxs-lookup"><span data-stu-id="c554a-164">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="c554a-165">COM (installazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="c554a-165">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="c554a-166">GAC (componente di .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="c554a-166">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="c554a-167">GAC (componente di .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="c554a-167">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="c554a-168">Aggiungere una classe che esegue l'override della classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> .</span><span class="sxs-lookup"><span data-stu-id="c554a-168">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="c554a-169">Implementare la proprietà <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> per indicare i tipi di modifiche gestite.</span><span class="sxs-lookup"><span data-stu-id="c554a-169">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="c554a-170">Eseguire l'override di uno o più dei seguenti metodi della classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> :</span><span class="sxs-lookup"><span data-stu-id="c554a-170">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="c554a-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> : viene richiamato quando si esegue il commit di una modifica ai dati durante la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="c554a-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="c554a-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione DELETE.</span><span class="sxs-lookup"><span data-stu-id="c554a-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked if an error occurs while a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni DELETE.</span><span class="sxs-lookup"><span data-stu-id="c554a-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione INSERT.</span><span class="sxs-lookup"><span data-stu-id="c554a-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked if an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni INSERT.</span><span class="sxs-lookup"><span data-stu-id="c554a-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> : viene richiamato quando si verificano conflitti di istruzioni UPDATE nel server di pubblicazione e nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="c554a-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="c554a-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> : viene richiamato quando si verificano conflitti tra istruzioni UPDATE e istruzioni DELETE nel server di pubblicazione e nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="c554a-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="c554a-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> : viene richiamato se si verifica un errore durante il caricamento o il download di un'istruzione UPDATE.</span><span class="sxs-lookup"><span data-stu-id="c554a-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked if an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="c554a-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> : viene richiamato durante il caricamento o il download delle istruzioni UPDATE.</span><span class="sxs-lookup"><span data-stu-id="c554a-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c554a-180">I conflitti di articoli non gestiti in modo esplicito dalla logica di business personalizzata vengono gestiti dal sistema di risoluzione predefinito per l'articolo.</span><span class="sxs-lookup"><span data-stu-id="c554a-180">Any article conflicts not explicitly handled by your custom business logic are handled by the default resolver for the article.</span></span>  
  
6.  <span data-ttu-id="c554a-181">Compilare il progetto per creare l'assembly del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-181">Build the project to create the business logic handler assembly.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="c554a-182">Per registrare un gestore della logica di business</span><span class="sxs-lookup"><span data-stu-id="c554a-182">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="c554a-183">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c554a-183">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c554a-184">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="c554a-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="c554a-185">Passare il valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="c554a-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="c554a-186">Chiamare <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> e controllare l'oggetto <xref:System.Collections.ArrayList> restituito per verificare che l'assembly non sia già stato registrato come gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-186">Call <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> and check the returned <xref:System.Collections.ArrayList> object to ensure that the assembly has not already been registered as a business logic handler.</span></span>  
  
4.  <span data-ttu-id="c554a-187">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler>.</span><span class="sxs-lookup"><span data-stu-id="c554a-187">Create an instance of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler> class.</span></span> <span data-ttu-id="c554a-188">Specificare le proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="c554a-188">Specify the following properties:</span></span>  
  
    -   <span data-ttu-id="c554a-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> : nome dell'assembly .NET.</span><span class="sxs-lookup"><span data-stu-id="c554a-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> - the name of the .NET assembly.</span></span> <span data-ttu-id="c554a-190">Se l'assembly non viene distribuito nella stessa directory del file eseguibile dell'agente di merge, nella stessa directory dell'applicazione che avvia in modo sincrono l'agente di merge o nella GAC (Global Assembly Cache), è necessario includere il percorso completo con il nome dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="c554a-190">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the GAC, you must include the full path with the assembly name.</span></span> <span data-ttu-id="c554a-191">È necessario includere il percorso completo con il nome dell'assembly quando si utilizza un gestore della logica di business con la sincronizzazione tramite il Web.</span><span class="sxs-lookup"><span data-stu-id="c554a-191">You must include the full path with the assembly name when using a business logic handler with Web synchronization.</span></span>  
  
    -   <span data-ttu-id="c554a-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> : nome completo della classe che esegue l'override di <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> e implementa il gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> - the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> and implements the business logic handler.</span></span>  
  
    -   <span data-ttu-id="c554a-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> : nome descrittivo utilizzato per l'accesso al gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> - a friendly name you use when you access the business logic handler.</span></span>  
  
    -   <span data-ttu-id="c554a-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A>: valore `true`.</span><span class="sxs-lookup"><span data-stu-id="c554a-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A> - a value of `true`.</span></span>  
  
#### <a name="to-deploy-a-business-logic-handler"></a><span data-ttu-id="c554a-195">Per distribuire un gestore della logica di business</span><span class="sxs-lookup"><span data-stu-id="c554a-195">To deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="c554a-196">Distribuire l'assembly nel server in cui viene eseguito l'agente merge, nel percorso file specificato durante la registrazione del gestore della logica di business nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c554a-196">Deploy the assembly on the server where the Merge Agent runs in the file location specified when the business logic handler was registered at the Distributor.</span></span> <span data-ttu-id="c554a-197">Per una sottoscrizione pull, l'agente viene eseguito nel Sottoscrittore, mentre per una sottoscrizione push nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c554a-197">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="c554a-198">Quando si utilizza la sincronizzazione tramite il Web, l'agente viene eseguito nel server Web.</span><span class="sxs-lookup"><span data-stu-id="c554a-198">When you are using Web synchronization, the agent runs on the Web server.</span></span> <span data-ttu-id="c554a-199">Se con il nome dell'assembly non è stato incluso il percorso completo durante la registrazione del gestore della logica di business, distribuire l'assembly nella stessa directory del file eseguibile dell'agente di merge o nella stessa directory dell'applicazione che avvia in modo sincrono l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="c554a-199">If the full path was not included with the assembly name when the business logic handler was registered, deploy the assembly in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent.</span></span> <span data-ttu-id="c554a-200">È possibile installare l'assembly nella GAC se più applicazioni utilizzano lo stesso assembly.</span><span class="sxs-lookup"><span data-stu-id="c554a-200">You may install the assembly in the GAC if there are multiple applications that use the same assembly.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="c554a-201">Per utilizzare un gestore della logica di business con un nuovo articolo di tabella</span><span class="sxs-lookup"><span data-stu-id="c554a-201">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="c554a-202">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c554a-202">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c554a-203">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergeArticle>.</span><span class="sxs-lookup"><span data-stu-id="c554a-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span> <span data-ttu-id="c554a-204">Impostare le proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="c554a-204">Set the following properties:</span></span>  
  
    -   <span data-ttu-id="c554a-205">Nome dell'articolo per <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="c554a-205">The name of the article for <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="c554a-206">Nome della pubblicazione per <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="c554a-206">The name of the publication for <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="c554a-207">Nome del database di pubblicazione per <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="c554a-207">The name of the publication database for <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="c554a-208">Nome descrittivo del gestore della logica di business (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) per <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span><span class="sxs-lookup"><span data-stu-id="c554a-208">The friendly name of the business logic handler (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span>  
  
3.  <span data-ttu-id="c554a-209">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.Article.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="c554a-209">Call the <xref:Microsoft.SqlServer.Replication.Article.Create%2A> method.</span></span> <span data-ttu-id="c554a-210">Per altre informazioni, vedere [definire un articolo](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="c554a-210">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="c554a-211">Per utilizzare un gestore della logica di business con un articolo di tabella esistente</span><span class="sxs-lookup"><span data-stu-id="c554a-211">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="c554a-212">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c554a-212">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c554a-213">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergeArticle>.</span><span class="sxs-lookup"><span data-stu-id="c554a-213">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span>  
  
3.  <span data-ttu-id="c554a-214">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>e <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> .</span><span class="sxs-lookup"><span data-stu-id="c554a-214">Set the <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>, and <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> properties.</span></span>  
  
4.  <span data-ttu-id="c554a-215">Impostare la connessione del passaggio 1 per la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> .</span><span class="sxs-lookup"><span data-stu-id="c554a-215">Set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
5.  <span data-ttu-id="c554a-216">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="c554a-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="c554a-217">Se questo metodo restituisce `false`, le proprietà dell'articolo sono state definite in modo non corretto nel passaggio 3 oppure l'articolo non esiste.</span><span class="sxs-lookup"><span data-stu-id="c554a-217">If this method returns `false`, either the article properties in step 3 were defined incorrectly or the article does not exist.</span></span> <span data-ttu-id="c554a-218">Per altre informazioni, vedere [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c554a-218">For more information, see [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span></span>  
  
6.  <span data-ttu-id="c554a-219">Impostare il nome descrittivo del gestore della logica di business per <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span><span class="sxs-lookup"><span data-stu-id="c554a-219">Set the friendly name of the business logic handler for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span> <span data-ttu-id="c554a-220">Si tratta del valore della proprietà <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> specificato durante la registrazione del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-220">This is the value of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> property specified when registering the business logic handler.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="c554a-221">Esempi (RMO)</span><span class="sxs-lookup"><span data-stu-id="c554a-221">Examples (RMO)</span></span>  
 <span data-ttu-id="c554a-222">In questo esempio è illustrato un gestore della logica di business che registra informazioni sulle operazioni di inserimento, aggiornamento ed eliminazione nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="c554a-222">This example is a business logic handler that logs information about inserts, updates, and deletes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="c554a-223">In questo esempio viene registrato un gestore della logica di business nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c554a-223">This example registers a business logic handler at the Distributor.</span></span>  
  
 [!code-csharp[HowTo#rmo_RegisterBLH_10](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_registerblh_10)]  
  
 [!code-vb[HowTo#rmo_vb_RegisterBLH_10](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_registerblh_10)]  
  
 <span data-ttu-id="c554a-224">In questo esempio viene modificato un articolo esistente per l'utilizzo del gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="c554a-224">This example changes an existing article to use the business logic handler.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeMergeArticle_BLH](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changemergearticle_blh)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeMergeArticle_BLH](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changemergearticle_blh)]  
  
## <a name="see-also"></a><span data-ttu-id="c554a-225">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="c554a-225">See Also</span></span>  
 <span data-ttu-id="c554a-226">[Implementare un sistema di risoluzione dei conflitti personalizzato per un articolo di merge](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span><span class="sxs-lookup"><span data-stu-id="c554a-226">[Implement a Custom Conflict Resolver for a Merge Article](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span></span>  
 <span data-ttu-id="c554a-227">[Eseguire il debug di un gestore della logica di business &#40;la programmazione della replica&#41;](debug-a-business-logic-handler-replication-programming.md) </span><span class="sxs-lookup"><span data-stu-id="c554a-227">[Debug a Business Logic Handler &#40;Replication Programming&#41;](debug-a-business-logic-handler-replication-programming.md) </span></span>  
 <span data-ttu-id="c554a-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="c554a-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 [<span data-ttu-id="c554a-229">Concetti di base relativi a RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="c554a-229">Replication Management Objects Concepts</span></span>](concepts/replication-management-objects-concepts.md)  
  
  
