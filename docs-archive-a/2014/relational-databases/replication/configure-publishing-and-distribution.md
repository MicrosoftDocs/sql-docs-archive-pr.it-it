---
title: Configurare la pubblicazione e la distribuzione | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], distribution
- distribution configuration [SQL Server replication]
- publishing [SQL Server replication], configuring
ms.assetid: 3cfc8966-833e-42fa-80cb-09175d1feed7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: afd1544b5412c6ce2d83a9a1e9a50ddf662b3056
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624093"
---
# <a name="configure-publishing-and-distribution"></a><span data-ttu-id="68bed-102">Configurazione della pubblicazione e della distribuzione</span><span class="sxs-lookup"><span data-stu-id="68bed-102">Configure Publishing and Distribution</span></span>
  <span data-ttu-id="68bed-103">In questo argomento viene descritto come configurare la pubblicazione e la distribuzione in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]o RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="68bed-103">This topic describes how to configure publishing and distribution in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="68bed-104">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="68bed-104">Before You Begin</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="68bed-105">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="68bed-105">Security</span></span>  
 <span data-ttu-id="68bed-106">Per ulteriori informazioni, vedere la pagina relativa alla [distribuzione protetta della replica](security/view-and-modify-replication-security-settings.md).</span><span class="sxs-lookup"><span data-stu-id="68bed-106">For more information, see [Secure Replication Deployment](security/view-and-modify-replication-security-settings.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="68bed-107">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="68bed-107">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="68bed-108">Configurare la distribuzione mediante la Creazione guidata nuova pubblicazione o la Configurazione guidata distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-108">Configure distribution using the New Publication Wizard or the Configure Distribution Wizard.</span></span> <span data-ttu-id="68bed-109">Dopo la configurazione iniziale del database di distribuzione, è possibile visualizzare e modificare le proprietà nella finestra di dialogo **Proprietà database di distribuzione - \<Distributor>** .</span><span class="sxs-lookup"><span data-stu-id="68bed-109">After the Distributor is configured, view and modify properties in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="68bed-110">Utilizzare la Configurazione guidata distribuzione se si desidera configurare un database di distribuzione in modo che i membri dei ruoli predefiniti del database **db_owner** possano creare pubblicazioni o per configurare un server di distribuzione remoto che non è un server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-110">Use the Configure Distribution Wizard if you want to configure a Distributor so that members of the **db_owner** fixed database roles can create publications, or because you want to configure a remote Distributor that is not a Publisher.</span></span>  
  
#### <a name="to-configure-distribution"></a><span data-ttu-id="68bed-111">Per configurare la distribuzione</span><span class="sxs-lookup"><span data-stu-id="68bed-111">To configure distribution</span></span>  
  
1.  <span data-ttu-id="68bed-112">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] connettersi al server che diventerà il server di distribuzione (in molti casi, il server di distribuzione e quello di pubblicazione coincidono) e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="68bed-112">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], connect to the server that will be the Distributor (in many cases, the Publisher and Distributor are the same server), and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="68bed-113">Fare clic con il pulsante destro del mouse sulla cartella **Replica** e quindi fare clic su **Configura distribuzione**.</span><span class="sxs-lookup"><span data-stu-id="68bed-113">Right-click the **Replication** folder, and then click **Configure Distribution**.</span></span>  
  
3.  <span data-ttu-id="68bed-114">Eseguire i vari passaggi della Configurazione guidata distribuzione per:</span><span class="sxs-lookup"><span data-stu-id="68bed-114">Follow the Configure Distribution Wizard to:</span></span>  
  
    -   <span data-ttu-id="68bed-115">Selezionare un server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-115">Select a Distributor.</span></span> <span data-ttu-id="68bed-116">Per utilizzare un server di distribuzione locale, selezionare **'' fungerà \<ServerName> da server di distribuzione per se stesso. SQL Server creerà un database di distribuzione e un log**.</span><span class="sxs-lookup"><span data-stu-id="68bed-116">To use a local Distributor, select **'\<ServerName>' will act as its own Distributor; SQL Server will create a distribution database and log**.</span></span> <span data-ttu-id="68bed-117">Per utilizzare un server di distribuzione remoto, selezionare **Usa il server seguente come server di distribuzione**e quindi specificare un server.</span><span class="sxs-lookup"><span data-stu-id="68bed-117">To use a remote Distributor, select **Use the following server as the Distributor**, and then select a server.</span></span> <span data-ttu-id="68bed-118">È necessario che il server sia già configurato come server di distribuzione e che il server di pubblicazione sia abilitato per l'utilizzo del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-118">The server must already be configured as a Distributor, and the Publisher must be enabled to use the Distributor.</span></span> <span data-ttu-id="68bed-119">Per altre informazioni, vedere [Abilitazione di un server di pubblicazione remoto in un database di distribuzione &#40;SQL Server Management Studio&#41;](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="68bed-119">For more information, see [Enable a Remote Publisher at a Distributor &#40;SQL Server Management Studio&#41;](enable-a-remote-publisher-at-a-distributor-sql-server-management-studio.md).</span></span>  
  
         <span data-ttu-id="68bed-120">Se si seleziona un server di distribuzione remoto, è necessario immettere la password nella pagina **Password amministrativa** per le connessioni effettuate dal server di pubblicazione a quello di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-120">If you select a remote Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="68bed-121">Questa password deve corrispondere a quella specificata quando il server di pubblicazione è stato attivato nel server di distribuzione remoto.</span><span class="sxs-lookup"><span data-stu-id="68bed-121">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
    -   <span data-ttu-id="68bed-122">Specificare una cartella snapshot radice per un server di distribuzione locale.</span><span class="sxs-lookup"><span data-stu-id="68bed-122">Specify a root snapshot folder (for a local Distributor).</span></span> <span data-ttu-id="68bed-123">La cartella snapshot è semplicemente una directory designata come condivisione. Gli agenti che eseguono letture e scritture in questa cartella devono disporre di autorizzazioni sufficienti per accedervi.</span><span class="sxs-lookup"><span data-stu-id="68bed-123">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="68bed-124">Ogni server di pubblicazione che utilizza questo server di distribuzione crea una cartella nella cartella radice e ogni pubblicazione crea cartelle nella cartella del server di pubblicazione per l'archiviazione dei file snapshot.</span><span class="sxs-lookup"><span data-stu-id="68bed-124">Each Publisher that uses this Distributor creates a folder under the root folder, and each publication creates folders under the Publisher folder in which to store snapshot files.</span></span> <span data-ttu-id="68bed-125">Per altre informazioni sulle impostazioni di sicurezza appropriate per la cartella, vedere [Sicurezza della cartella snapshot](security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="68bed-125">For more information on securing the folder appropriately, see [Secure the Snapshot Folder](security/secure-the-snapshot-folder.md).</span></span>  
  
    -   <span data-ttu-id="68bed-126">Specificare il database di distribuzione (per un server di distribuzione locale).</span><span class="sxs-lookup"><span data-stu-id="68bed-126">Specify the distribution database (for a local Distributor).</span></span> <span data-ttu-id="68bed-127">Nel database di distribuzione vengono memorizzati metadati e dati di cronologia relativi a tutti i tipi di replica e alle transazioni per la replica transazionale.</span><span class="sxs-lookup"><span data-stu-id="68bed-127">The distribution database stores metadata and history data for all types of replication and transactions for transactional replication.</span></span>  
  
    -   <span data-ttu-id="68bed-128">Facoltativamente, consentire ad altri server di pubblicazione di utilizzare il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-128">Optionally enable other Publishers to use the Distributor.</span></span> <span data-ttu-id="68bed-129">Se viene consentito ad altri server di pubblicazione di utilizzare il server di distribuzione, è necessario immettere la password nella pagina **Password server di distribuzione** per le connessioni effettuate da questi server di pubblicazione al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-129">If other Publishers are enabled to use the Distributor, you must enter a password on the **Distributor Password** page for connections made from these Publishers to the Distributor.</span></span>  
  
    -   <span data-ttu-id="68bed-130">Facoltativamente, creare lo script delle impostazioni di configurazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-130">Optionally script configuration settings.</span></span> <span data-ttu-id="68bed-131">Per altre informazioni, vedere [Scripting Replication](scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="68bed-131">For more information, see [Scripting Replication](scripting-replication.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="68bed-132">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="68bed-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="68bed-133">La pubblicazione e la distribuzione della replica possono essere configurate a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="68bed-133">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
#### <a name="to-configure-publishing-using-a-local-distributor"></a><span data-ttu-id="68bed-134">Per configurare la pubblicazione utilizzando un server di distribuzione locale</span><span class="sxs-lookup"><span data-stu-id="68bed-134">To configure publishing using a local distributor</span></span>  
  
1.  <span data-ttu-id="68bed-135">Eseguire [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) per determinare se il server è già configurato come database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-135">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="68bed-136">Se il valore di **installed** nel set di risultati è **0**, eseguire [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) nel database master del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-136">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span>  
  
    -   <span data-ttu-id="68bed-137">Se il valore di **distribution db installed** nel set di risultati è **0**, eseguire [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) nel database master del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-137">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="68bed-138">Specificare il nome del database di distribuzione per il \*\* \@ database\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-138">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="68bed-139">Facoltativamente, è possibile specificare il periodo di memorizzazione massimo delle transazioni per \*\* \@ max_distretention\*\* e il periodo di memorizzazione della cronologia per \*\* \@ history_retention\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-139">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="68bed-140">Se viene creato un nuovo database, specificare i parametri desiderati per le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="68bed-140">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="68bed-141">Nel database di distribuzione, che è anche il server di pubblicazione, eseguire [sp_adddistpublisher &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specificando la condivisione UNC che verrà utilizzata come cartella snapshot predefinita per \*\* \@ working_directory\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-141">At the Distributor, which is also the Publisher, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span>  
  
3.  <span data-ttu-id="68bed-142">Nel server di pubblicazione eseguire [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="68bed-142">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="68bed-143">Specificare il database da pubblicare per \*\* \@ dbname**, il tipo di replica per \*\* \@ optname**e il valore `true` per \*\* \@ value\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-143">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of `true` for **\@value**.</span></span>  
  
#### <a name="to-configure-publishing-using-a-remote-distributor"></a><span data-ttu-id="68bed-144">Per configurare la pubblicazione utilizzando un server di distribuzione remoto</span><span class="sxs-lookup"><span data-stu-id="68bed-144">To configure publishing using a remote distributor</span></span>  
  
1.  <span data-ttu-id="68bed-145">Eseguire [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) per determinare se il server è già configurato come database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-145">Execute [sp_get_distributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-get-distributor-transact-sql) to determine if the server is already configured as a Distributor.</span></span>  
  
    -   <span data-ttu-id="68bed-146">Se il valore di **installed** nel set di risultati è **0**, eseguire [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) nel database master del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-146">If the value of **installed** in the result set is **0**, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="68bed-147">Specificare una password complessa per la \*\* \@ password\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-147">Specify a strong password for **\@password**.</span></span> <span data-ttu-id="68bed-148">Questa password per l'account **distributor_admin** verrà utilizzata per la connessione del server di pubblicazione al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-148">This password for the **distributor_admin** account will be used by the Publisher when connecting to the Distributor.</span></span>  
  
    -   <span data-ttu-id="68bed-149">Se il valore di **distribution db installed** nel set di risultati è **0**, eseguire [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) nel database master del server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-149">If the value of **distribution db installed** in the result set is **0**, execute [sp_adddistributiondb &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributiondb-transact-sql) at the Distributor on the master database.</span></span> <span data-ttu-id="68bed-150">Specificare il nome del database di distribuzione per il \*\* \@ database\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-150">Specify the name of the distribution database for **\@database**.</span></span> <span data-ttu-id="68bed-151">Facoltativamente, è possibile specificare il periodo di memorizzazione massimo delle transazioni per \*\* \@ max_distretention\*\* e il periodo di memorizzazione della cronologia per \*\* \@ history_retention\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-151">Optionally, you can specify the maximum transactional retention period for **\@max_distretention** and the history retention period for **\@history_retention**.</span></span> <span data-ttu-id="68bed-152">Se viene creato un nuovo database, specificare i parametri desiderati per le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="68bed-152">If a new database is being created, specify the desired database property parameters.</span></span>  
  
2.  <span data-ttu-id="68bed-153">Nel server di distribuzione eseguire [sp_adddistpublisher &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specificando la condivisione UNC che verrà utilizzata come cartella snapshot predefinita per \*\* \@ working_directory\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-153">At the Distributor, execute [sp_adddistpublisher &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistpublisher-transact-sql), specifying the UNC share that will be used as default snapshot folder for **\@working_directory**.</span></span> <span data-ttu-id="68bed-154">Se il server di distribuzione utilizza l'autenticazione di per la [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connessione al server di pubblicazione, è necessario specificare anche il valore **0** per \*\* \@ security_mode\*\* e le [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] informazioni di accesso per l' \*\* \@ account di accesso\*\* e la \*\* \@ password\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-154">If the Distributor will use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **\@login** and **\@password**.</span></span>  
  
3.  <span data-ttu-id="68bed-155">Nel database master del server di pubblicazione eseguire [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="68bed-155">At the Publisher on the master database, execute [sp_adddistributor &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adddistributor-transact-sql).</span></span> <span data-ttu-id="68bed-156">Specificare la password complessa utilizzata nel passaggio 1 per la \*\* \@ password\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-156">Specify the strong password used in step 1 for **\@password**.</span></span> <span data-ttu-id="68bed-157">Questa password verrà utilizzata per la connessione del server di pubblicazione al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-157">This password will be used by the Publisher when connecting to the Distributor.</span></span>  
  
4.  <span data-ttu-id="68bed-158">Nel server di pubblicazione eseguire [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="68bed-158">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span> <span data-ttu-id="68bed-159">Specificare il database da pubblicare per \*\* \@ dbname**, il tipo di replica per \*\* \@ optname**e il valore true per \*\* \@ value\*\*.</span><span class="sxs-lookup"><span data-stu-id="68bed-159">Specify the database being published for **\@dbname**, the type of replication for **\@optname**, and a value of true for **\@value**.</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="68bed-160">Esempio (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="68bed-160">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="68bed-161">Nell'esempio seguente viene illustrato come configurare la pubblicazione e la distribuzione a livello di programmazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-161">The following example demonstrates how to configure publishing and distribution programmatically.</span></span> <span data-ttu-id="68bed-162">Il nome del server da configurare come server di pubblicazione e database di distribuzione locale viene specificato utilizzando variabili di scripting.</span><span class="sxs-lookup"><span data-stu-id="68bed-162">In this example, the name of the server that is being configured as a publisher and a local distributor is supplied using scripting variables.</span></span> <span data-ttu-id="68bed-163">La pubblicazione e la distribuzione della replica possono essere configurate a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="68bed-163">Replication publishing and distribution can be configured programmatically using replication stored procedures.</span></span>  
  
 [!code-sql[HowTo#AddDistPub](../../snippets/tsql/SQL15/replication/howto/tsql/adddistpub.sql#adddistpub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="68bed-164">Utilizzo di RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="68bed-164">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-on-a-single-server"></a><span data-ttu-id="68bed-165">Per configurare la pubblicazione e la distribuzione su un singolo server</span><span class="sxs-lookup"><span data-stu-id="68bed-165">To configure publishing and distribution on a single server</span></span>  
  
1.  <span data-ttu-id="68bed-166">Creare una connessione al server tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="68bed-166">Create a connection to the server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="68bed-167">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="68bed-167">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="68bed-168">Passare il valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-168">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="68bed-169">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.DistributionDatabase>.</span><span class="sxs-lookup"><span data-stu-id="68bed-169">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="68bed-170">Impostare la proprietà <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> sul nome del database e la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sul valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-170">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="68bed-171">Installare il server di distribuzione chiamando il metodo <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-171">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="68bed-172">Passare l'oggetto <xref:Microsoft.SqlServer.Replication.DistributionDatabase> indicato nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="68bed-172">Pass the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span>  
  
6.  <span data-ttu-id="68bed-173">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="68bed-173">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="68bed-174">Impostare le proprietà seguenti di <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span><span class="sxs-lookup"><span data-stu-id="68bed-174">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="68bed-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> : nome del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-175"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="68bed-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> : valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-176"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="68bed-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> : nome del database creato al passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="68bed-177"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="68bed-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> : condivisione utilizzata per accedere ai file snapshot.</span><span class="sxs-lookup"><span data-stu-id="68bed-178"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="68bed-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> : la modalità di sicurezza utilizzata durante la connessione al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-179"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="68bed-180">È consigliato<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-180"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="68bed-181">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-181">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
#### <a name="to-configure-publishing-and-distribution-using-a-remote-distributor"></a><span data-ttu-id="68bed-182">Per configurare la pubblicazione e la distribuzione utilizzando un server di distribuzione remoto</span><span class="sxs-lookup"><span data-stu-id="68bed-182">To configure publishing and distribution using a remote Distributor</span></span>  
  
1.  <span data-ttu-id="68bed-183">Creare una connessione al server di distribuzione remoto tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="68bed-183">Create a connection to the remote Distributor server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="68bed-184">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="68bed-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="68bed-185">Passare il valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="68bed-186">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.DistributionDatabase>.</span><span class="sxs-lookup"><span data-stu-id="68bed-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> class.</span></span>  
  
4.  <span data-ttu-id="68bed-187">Impostare la proprietà <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> sul nome del database e la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sul valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-187">Set the <xref:Microsoft.SqlServer.Replication.DistributionDatabase.Name%2A> property to the database name, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
5.  <span data-ttu-id="68bed-188">Installare il server di distribuzione chiamando il metodo <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-188">Install the Distributor by calling the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="68bed-189">Specificare una password sicura (utilizzata dal server di pubblicazione per la connessione al server di distribuzione remoto) e l'oggetto <xref:Microsoft.SqlServer.Replication.DistributionDatabase> ottenuto al passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="68bed-189">Specify a secure password (used by the Publisher when connecting to the remote Distributor) and the <xref:Microsoft.SqlServer.Replication.DistributionDatabase> object from step 3.</span></span> <span data-ttu-id="68bed-190">Per altre informazioni, vedere [Sicurezza del database di distribuzione](security/secure-the-distributor.md).</span><span class="sxs-lookup"><span data-stu-id="68bed-190">For more information, see [Secure the Distributor](security/secure-the-distributor.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="68bed-191">Se possibile, richiedere agli utenti di immettere le credenziali di sicurezza in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-191">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="68bed-192">Se è necessario archiviare le credenziali, utilizzare i [servizi di crittografia](https://go.microsoft.com/fwlink/?LinkId=34733) offerti da [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="68bed-192">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
6.  <span data-ttu-id="68bed-193">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.DistributionPublisher>.</span><span class="sxs-lookup"><span data-stu-id="68bed-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.DistributionPublisher> class.</span></span>  
  
7.  <span data-ttu-id="68bed-194">Impostare le proprietà seguenti di <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span><span class="sxs-lookup"><span data-stu-id="68bed-194">Set the following properties of <xref:Microsoft.SqlServer.Replication.DistributionPublisher>:</span></span>  
  
    -   <span data-ttu-id="68bed-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> : nome del server di pubblicazione locale.</span><span class="sxs-lookup"><span data-stu-id="68bed-195"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.Name%2A> - name of the local Publisher server.</span></span>  
  
    -   <span data-ttu-id="68bed-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> : valore di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> ottenuto al passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="68bed-196"><xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> - the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
    -   <span data-ttu-id="68bed-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> : nome del database creato al passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="68bed-197"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.DistributionDatabase%2A> - the name of the database created in step 5.</span></span>  
  
    -   <span data-ttu-id="68bed-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> : condivisione utilizzata per accedere ai file snapshot.</span><span class="sxs-lookup"><span data-stu-id="68bed-198"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.WorkingDirectory%2A> - the share used to access snapshot files.</span></span>  
  
    -   <span data-ttu-id="68bed-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> : la modalità di sicurezza utilizzata durante la connessione al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="68bed-199"><xref:Microsoft.SqlServer.Replication.DistributionPublisher.PublisherSecurity%2A> - the security mode used when connecting to the Publisher.</span></span> <span data-ttu-id="68bed-200">È consigliato<xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-200"><xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> is recommended.</span></span>  
  
8.  <span data-ttu-id="68bed-201">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-201">Call the <xref:Microsoft.SqlServer.Replication.DistributionPublisher.Create%2A> method.</span></span>  
  
9. <span data-ttu-id="68bed-202">Creare una connessione al server di pubblicazione locale tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="68bed-202">Create a connection to the local Publisher server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
10. <span data-ttu-id="68bed-203">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="68bed-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="68bed-204">Passare l'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> indicato nel passaggio 9.</span><span class="sxs-lookup"><span data-stu-id="68bed-204">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 9.</span></span>  
  
11. <span data-ttu-id="68bed-205">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> .</span><span class="sxs-lookup"><span data-stu-id="68bed-205">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.InstallDistributor%2A> method.</span></span> <span data-ttu-id="68bed-206">Passare il nome e la password del server di distribuzione remoto specificati al passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="68bed-206">Pass the name of the remote Distributor and the password for the remote Distributor specified in step 5.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="68bed-207">Se possibile, richiedere agli utenti di immettere le credenziali di sicurezza in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="68bed-207">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="68bed-208">Se è necessario archiviare le credenziali, utilizzare i [servizi di crittografia](https://go.microsoft.com/fwlink/?LinkId=34733) offerti da Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="68bed-208">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="68bed-209">Esempio (RMO)</span><span class="sxs-lookup"><span data-stu-id="68bed-209">Example (RMO)</span></span>  
 <span data-ttu-id="68bed-210">È possibile configurare a livello di programmazione la pubblicazione e la distribuzione della replica utilizzando gli oggetti RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="68bed-210">You can programmatically configure replication publishing and distribution by using Replication Management Objects (RMO).</span></span>  
  
 [!code-csharp[HowTo#rmo_AddDistPub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_adddistpub)]  
  
 [!code-vb[HowTo#rmo_vb_AddDistPub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_adddistpub)]  
  
## <a name="see-also"></a><span data-ttu-id="68bed-211">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="68bed-211">See Also</span></span>  
 <span data-ttu-id="68bed-212">[Visualizzare e modificare le proprietà del server di pubblicazione e del database di distribuzione](view-and-modify-distributor-and-publisher-properties.md) </span><span class="sxs-lookup"><span data-stu-id="68bed-212">[View and Modify Distributor and Publisher Properties](view-and-modify-distributor-and-publisher-properties.md) </span></span>  
 <span data-ttu-id="68bed-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="68bed-213">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 <span data-ttu-id="68bed-214">[Configura distribuzione](configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="68bed-214">[Configure Distribution](configure-distribution.md) </span></span>  
 <span data-ttu-id="68bed-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="68bed-215">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="68bed-216">Configurare la replica per Gruppi di disponibilità AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="68bed-216">Configure Replication for AlwaysOn Availability Groups &#40;SQL Server&#41;</span></span>](../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md) 
  
  
