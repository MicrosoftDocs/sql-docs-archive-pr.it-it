---
title: Rigenerare procedure transazionali personalizzate per riflettere le modifiche dello schema | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- custom procedures [SQL Server replication]
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
ms.assetid: ccf68a13-e748-4455-8168-90e6d2868098
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 7b41b5309816e037ce3619e880b796e0653c7506
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87722688"
---
# <a name="regenerate-custom-transactional-procedures-to-reflect-schema-changes"></a><span data-ttu-id="5528e-102">Rigenerazione di procedure transazionali personalizzate per riflettere le modifiche dello schema</span><span class="sxs-lookup"><span data-stu-id="5528e-102">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>
  <span data-ttu-id="5528e-103">Per impostazione predefinita, la replica transazionale apporta tutte le modifiche di dati nei Sottoscrittori tramite stored procedure generate mediante procedure interne per ogni articolo di tabella nella pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5528e-103">By default transactional replication makes all data changes at Subscribers through stored procedures that are generated by internal procedures for each table article in the publication.</span></span> <span data-ttu-id="5528e-104">Le tre procedure, rispettivamente per inserimenti, aggiornamenti ed eliminazioni, vengono copiate nel Sottoscrittore ed eseguite in caso di replica di un inserimento, un aggiornamento o un'eliminazione nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5528e-104">The three procedures (one each for inserts, updates, and deletes) are copied to the Subscriber and execute when an insert, update, or delete is replicated to the Subscriber.</span></span> <span data-ttu-id="5528e-105">Quando viene apportata una modifica dello schema a una tabella in un server di pubblicazione [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , queste procedure vengono rigenerate automaticamente dalla replica chiamando lo stesso set di procedure di scripting interne affinché le nuove procedure corrispondano al nuovo schema. La replica di modifiche dello schema non è supportata per i server di pubblicazione Oracle.</span><span class="sxs-lookup"><span data-stu-id="5528e-105">When a schema change is made to a table on a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, replication regenerates these procedures automatically by calling the same set of internal scripting procedures so that the new procedures match the new schema (replication of schema changes is not supported for Oracle Publishers).</span></span>  
  
 <span data-ttu-id="5528e-106">È inoltre possibile specificare procedure personalizzate per sostituire una o più procedure predefinite.</span><span class="sxs-lookup"><span data-stu-id="5528e-106">It is also possible to specify custom procedures to replace one or more of the default procedures.</span></span> <span data-ttu-id="5528e-107">Le procedure personalizzate vanno modificate in caso di modifica dello schema che influisce sulla procedura.</span><span class="sxs-lookup"><span data-stu-id="5528e-107">The custom procedures should be changed if the schema change will affect the procedure.</span></span> <span data-ttu-id="5528e-108">Ad esempio, se una procedura fa riferimento a una colonna eliminata con una modifica dello schema, occorre rimuovere i riferimenti alla colonna dalla procedura.</span><span class="sxs-lookup"><span data-stu-id="5528e-108">For example, if a procedure references a column that is dropped in a schema change, references to the column should be removed from the procedure.</span></span> <span data-ttu-id="5528e-109">Per propagare una nuova procedura personalizzata ai Sottoscrittori con la replica sono disponibili due modi.</span><span class="sxs-lookup"><span data-stu-id="5528e-109">There are two ways for replication to propagate a new custom procedure to Subscribers:</span></span>  
  
-   <span data-ttu-id="5528e-110">La prima opzione consiste nell'utilizzare una procedura di scripting personalizzata per sostituire le impostazioni predefinite utilizzate dalla replica:</span><span class="sxs-lookup"><span data-stu-id="5528e-110">The first option is to use a custom scripting procedure to replace the defaults used by replication:</span></span>  
  
    1.  <span data-ttu-id="5528e-111">Quando si eseguono [sp_addarticle &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), assicurarsi **@schema_option** che il bit 0x02 sia **true**.</span><span class="sxs-lookup"><span data-stu-id="5528e-111">When executing [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), ensure the **@schema_option** 0x02 bit is to **true**.</span></span>  
  
    2.  <span data-ttu-id="5528e-112">Eseguire [sp_register_custom_scripting &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql) e specificare il valore ' Insert ',' Update ' o ' Delete ' per il parametro **@type** e il nome della procedura di scripting personalizzata per il parametro **@value** .</span><span class="sxs-lookup"><span data-stu-id="5528e-112">Execute [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql) and specify a value of 'insert', 'update', or 'delete' for the parameter **@type** and the name of the custom scripting procedure for the parameter **@value**.</span></span>  
  
     <span data-ttu-id="5528e-113">Alla successiva modifica dello schema, la replica chiama questa stored procedure per inserire nello script la definizione per la nuova stored procedure personalizzata definita dall'utente e quindi propaga la procedura a ogni Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5528e-113">The next time a schema change is made, replication calls this stored procedure to script out the definition for the new user defined custom stored procedure, and then propagates the procedure to each Subscriber.</span></span>  
  
-   <span data-ttu-id="5528e-114">La seconda opzione consiste nell'utilizzare uno script contenente una nuova definizione di procedura personalizzata:</span><span class="sxs-lookup"><span data-stu-id="5528e-114">The second option is to use a script that contains a new custom procedure definition:</span></span>  
  
    1.  <span data-ttu-id="5528e-115">Quando si esegue [sp_addarticle &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), impostare il **@schema_option** bit 0x02 su **false** in modo che la replica non generi automaticamente procedure personalizzate nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5528e-115">When executing [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), set the **@schema_option** 0x02 bit to **false** so replication does not automatically generate custom procedures at the Subscriber.</span></span>  
  
    2.  <span data-ttu-id="5528e-116">Prima di ogni modifica dello schema, creare un nuovo file script e registrare lo script con la replica eseguendo [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5528e-116">Before each schema change, create a new script file and register the script with replication by executing [sp_register_custom_scripting &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-register-custom-scripting-transact-sql).</span></span> <span data-ttu-id="5528e-117">Specificare il valore ' custom_script ' per il parametro **@type** e il percorso dello script nel server di pubblicazione per il parametro **@value** .</span><span class="sxs-lookup"><span data-stu-id="5528e-117">Specify a value of 'custom_script' for the parameter **@type** and the path to the script on the Publisher for the parameter **@value**.</span></span>  
  
     <span data-ttu-id="5528e-118">Alla successiva modifica significativa dello schema, questo script viene eseguito in ogni Sottoscrittore all'interno della stessa transazione del comando DDL.</span><span class="sxs-lookup"><span data-stu-id="5528e-118">The next time a relevant schema change is made, this script executes on each Subscriber within the same transaction as the DDL command.</span></span> <span data-ttu-id="5528e-119">Dopo che è stata apportata la modifica dello schema, la registrazione dello script viene annullata.</span><span class="sxs-lookup"><span data-stu-id="5528e-119">After the schema change is made, the script is unregistered.</span></span> <span data-ttu-id="5528e-120">Per consentire l'esecuzione dello script dopo una successiva modifica dello schema, è necessario registrarlo nuovamente.</span><span class="sxs-lookup"><span data-stu-id="5528e-120">You must re-register the script to have it executed after a subsequent schema change.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5528e-121">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="5528e-121">See Also</span></span>  
 <span data-ttu-id="5528e-122">[Specificare la modalità di propagazione delle modifiche per gli articoli transazionali](transactional-articles-specify-how-changes-are-propagated.md) </span><span class="sxs-lookup"><span data-stu-id="5528e-122">[Specify How Changes Are Propagated for Transactional Articles](transactional-articles-specify-how-changes-are-propagated.md) </span></span>  
 [<span data-ttu-id="5528e-123">Apportare modifiche allo schema nei database di pubblicazione</span><span class="sxs-lookup"><span data-stu-id="5528e-123">Make Schema Changes on Publication Databases</span></span>](../publish/make-schema-changes-on-publication-databases.md)  
  
  
