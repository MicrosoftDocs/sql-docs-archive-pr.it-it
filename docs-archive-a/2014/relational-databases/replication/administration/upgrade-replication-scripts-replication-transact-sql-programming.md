---
title: Aggiornare gli script di replica (programmazione Transact-SQL della replica) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626671"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="8f320-102">Aggiornamento di script di replica (programmazione Transact-SQL della replica)</span><span class="sxs-lookup"><span data-stu-id="8f320-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  <span data-ttu-id="8f320-103">È possibile utilizzare i file script[!INCLUDE[tsql](../../../includes/tsql-md.md)] per configurare a livello di programmazione una topologia di replica.</span><span class="sxs-lookup"><span data-stu-id="8f320-103">[!INCLUDE[tsql](../../../includes/tsql-md.md)] script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="8f320-104">Per altre informazioni, vedere [Concetti di base relativi alle stored procedure del sistema di replica](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8f320-105">Sebbene non sia necessario aggiornare gli script eseguiti da membri del ruolo `sysadmin`, si consiglia di modificare gli script esistenti come descritto in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="8f320-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="8f320-106">Specificare un account con autorizzazioni minime per ogni agente di replica, come descritto nella sezione relativa alle autorizzazioni necessarie per gli agenti dell'argomento [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="8f320-107">Oltre a offrire un maggior controllo delle autorizzazioni, consentendo di specificare in modo esplicito gli account di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows in cui vengono eseguiti i processi dell'agente di replica, questi miglioramenti apportati alla sicurezza influiscono sulle seguenti stored procedure negli script esistenti:</span><span class="sxs-lookup"><span data-stu-id="8f320-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="8f320-108">**sp_addpublication_snapshot**:</span><span class="sxs-lookup"><span data-stu-id="8f320-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="8f320-109">È ora necessario specificare le credenziali di Windows come **@job_login** e **@job_password** durante l'esecuzione di [Sp_addpublication_snapshot &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) per creare il processo in cui viene eseguito il agente di snapshot nel database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="8f320-110">**sp_addpushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="8f320-111">È ora necessario eseguire [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) per aggiungere in modo esplicito un processo e specificare le credenziali di Windows (**@job_login** e **@job_password**) usate per l'esecuzione del processo dell'agente di distribuzione nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="8f320-112">Nelle versioni di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]tale operazione viene eseguita automaticamente al momento della creazione di una sottoscrizione push.</span><span class="sxs-lookup"><span data-stu-id="8f320-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="8f320-113">**sp_addmergepushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="8f320-114">È ora necessario eseguire [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) per aggiungere in modo esplicito un processo e specificare le credenziali di Windows (**@job_login** e **@job_password**) usate per l'esecuzione del processo dell'agente di merge nel database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="8f320-115">Nelle versioni di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]tale operazione viene eseguita automaticamente al momento della creazione di una sottoscrizione push.</span><span class="sxs-lookup"><span data-stu-id="8f320-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="8f320-116">**sp_addpullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="8f320-117">È ora necessario specificare le credenziali di Windows come **@job_login** e **@job_password** durante l'esecuzione di [Sp_addpullsubscription_agent &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) per creare il processo in cui viene eseguito il agente di distribuzione nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="8f320-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="8f320-118">**sp_addmergepullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="8f320-119">È ora necessario specificare le credenziali di Windows come **@job_login** e **@job_password** durante l'esecuzione di [Sp_addmergepullsubscription_agent &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) per creare il processo in cui viene eseguito il agente di merge nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="8f320-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="8f320-120">**sp_addlogreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="8f320-121">È ora necessario eseguire [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) per aggiungere in modo manuale il processo e specificare le credenziali di Windows usate per l'esecuzione dell'agente di lettura log nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="8f320-122">Nelle versioni di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]tale operazione viene eseguita automaticamente al momento della creazione di una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="8f320-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="8f320-123">**sp_addqreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="8f320-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="8f320-124">È ora necessario eseguire [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) per aggiungere in modo manuale il processo e specificare le credenziali di Windows usate per l'esecuzione dell'agente di lettura coda nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="8f320-125">Nelle versioni di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] precedenti a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]tale operazione viene eseguita automaticamente al momento della creazione di una pubblicazione transazionale con supporto dell'aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="8f320-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="8f320-126">Nel modello di sicurezza introdotto in gli [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] agenti di replica rendono sempre le connessioni all'istanza locale di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] con l'autenticazione di Windows usando le credenziali fornite in **@job_name** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-127">Per informazioni sui requisiti degli account di Windows utilizzati quando si eseguono processi dell'agente di replica, vedere [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="8f320-128">Se possibile, richiedere agli utenti di immettere le credenziali di sicurezza in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="8f320-129">Se si archiviano le credenziali in un file script, assicurarsi che quest'ultimo sia protetto.</span><span class="sxs-lookup"><span data-stu-id="8f320-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="8f320-130">Per aggiornare gli script di configurazione di una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="8f320-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="8f320-131">Nello script esistente, prima di [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), eseguire [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) nel server di pubblicazione nel database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="8f320-132">Specificare le credenziali di Windows con cui viene eseguito il agente di lettura log per **@job_name** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-133">Se l'agente utilizzerà l'autenticazione di per la [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] connessione al server di pubblicazione, è necessario specificare anche il valore **0** per **@publisher_security_mode** e le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] informazioni sull'account di accesso di per **@publisher_login** e **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="8f320-134">Verrà creato un processo dell'agente di lettura log per il database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8f320-135">Questo passaggio è necessario solo per le pubblicazioni transazionali, non per le pubblicazioni snapshot.</span><span class="sxs-lookup"><span data-stu-id="8f320-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="8f320-136">(Facoltativo) Prima di [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), eseguire [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) nel server di distribuzione nel database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="8f320-137">Specificare le credenziali di Windows con cui viene eseguito il agente di lettura coda per **@job_name** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-138">Verrà creato un processo dell'agente di lettura coda per il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="8f320-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8f320-139">Questo passaggio è necessario solo per le pubblicazioni transazionali che supportano Sottoscrittori ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="8f320-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="8f320-140">(Facoltativo) Aggiornare l'esecuzione di [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) per impostare eventuali valori non predefiniti per i parametri che implementano nuove funzionalità di replica.</span><span class="sxs-lookup"><span data-stu-id="8f320-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="8f320-141">Dopo [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), eseguire [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) nel server di pubblicazione nel database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="8f320-142">Specificare **@publication** e le credenziali di Windows con cui viene eseguito il agente di snapshot per **@job_name** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-143">Se l'agente utilizzerà l'autenticazione di per la [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] connessione al server di pubblicazione, è necessario specificare anche il valore **0** per **@publisher_security_mode** e le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] informazioni sull'account di accesso di per **@publisher_login** e **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="8f320-144">Verrà creato un processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="8f320-145">(Facoltativo) Aggiornare l'esecuzione di [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) per impostare eventuali valori non predefiniti per i parametri che implementano nuove funzionalità di replica.</span><span class="sxs-lookup"><span data-stu-id="8f320-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="8f320-146">Per aggiornare gli script per l'aggiunta di sottoscrizioni di una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="8f320-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="8f320-147">Dopo avere eseguito la stored procedure di creazione della sottoscrizione, assicurarsi di eseguire la stored procedure di creazione di un processo dell'agente di distribuzione per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="8f320-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="8f320-148">La stored procedure utilizzata varia in base al tipo di sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="8f320-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="8f320-149">Nel caso di una sottoscrizione pull, aggiornare l'esecuzione di [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) in modo da specificare le credenziali di Windows usate per l'esecuzione dell'agente di distribuzione nel Sottoscrittore per **@job_name** e **@job_password**.</span><span class="sxs-lookup"><span data-stu-id="8f320-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-150">Tale operazione viene effettuata dopo l'esecuzione di [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8f320-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="8f320-151">Per altre informazioni, vedere [Creazione di una sottoscrizione pull](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="8f320-152">Per una sottoscrizione push, eseguire [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="8f320-153">Specificare **@subscriber** , **@subscriber_db** , **@publication** , le credenziali di Windows con cui il agente di distribuzione viene eseguito nel server di distribuzione per **@job_name** e **@job_password** e una pianificazione per il processo di Agent.</span><span class="sxs-lookup"><span data-stu-id="8f320-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="8f320-154">Per altre informazioni, vedere [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="8f320-155">Tale operazione viene effettuata dopo l'esecuzione di [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8f320-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="8f320-156">Per altre informazioni, vedere [Creazione di una sottoscrizione push](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="8f320-157">Per aggiornare gli script di configurazione di una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="8f320-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="8f320-158">(Facoltativo) Nello script esistente aggiornare l'esecuzione di [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) per impostare eventuali valori non predefiniti per i parametri che implementano nuove funzionalità di replica.</span><span class="sxs-lookup"><span data-stu-id="8f320-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="8f320-159">Dopo [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), eseguire [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) nel server di pubblicazione nel database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="8f320-160">Specificare **@publication** e le credenziali di Windows con cui viene eseguito il agente di snapshot per **@job_name** e **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-161">Se l'agente utilizzerà l'autenticazione di per la [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] connessione al server di pubblicazione, è necessario specificare anche il valore **0** per **@publisher_security_mode** e le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] informazioni sull'account di accesso di per **@publisher_login** e **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="8f320-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="8f320-162">Verrà creato un processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="8f320-163">(Facoltativo) Aggiornare l'esecuzione di [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) per impostare eventuali valori non predefiniti per i parametri che implementano nuove funzionalità di replica.</span><span class="sxs-lookup"><span data-stu-id="8f320-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="8f320-164">Per aggiornare gli script per l'aggiunta di sottoscrizioni di una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="8f320-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="8f320-165">Dopo avere eseguito la stored procedure di creazione della sottoscrizione, assicurarsi di eseguire la stored procedure di creazione di un processo dell'agente di merge per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="8f320-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="8f320-166">La stored procedure utilizzata varia in base al tipo di sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="8f320-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="8f320-167">Nel caso di una sottoscrizione pull, aggiornare l'esecuzione di [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) in modo da specificare le credenziali di Windows usate per l'esecuzione dell'agente di merge nel Sottoscrittore per **@job_name** e **@job_password**.</span><span class="sxs-lookup"><span data-stu-id="8f320-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="8f320-168">Tale operazione viene effettuata dopo l'esecuzione di [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8f320-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="8f320-169">Per altre informazioni, vedere [Creazione di una sottoscrizione pull](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="8f320-170">Per una sottoscrizione push, eseguire [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="8f320-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="8f320-171">Specificare **@subscriber** , **@subscriber_db** , **@publication** , le credenziali di Windows con cui viene eseguito il agente di merge nel server di distribuzione per **@job_name** e e **@job_password** una pianificazione per il processo di Agent.</span><span class="sxs-lookup"><span data-stu-id="8f320-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="8f320-172">Per altre informazioni, vedere [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="8f320-173">Tale operazione viene effettuata dopo l'esecuzione di [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8f320-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="8f320-174">Per altre informazioni, vedere [Creazione di una sottoscrizione push](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="8f320-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="8f320-175">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-175">Example</span></span>  
 <span data-ttu-id="8f320-176">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una pubblicazione transazionale per la tabella Product.</span><span class="sxs-lookup"><span data-stu-id="8f320-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="8f320-177">Questa pubblicazione supporta l'aggiornamento immediato sostituito dall'aggiornamento in coda come soluzione di failover.</span><span class="sxs-lookup"><span data-stu-id="8f320-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="8f320-178">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-179">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-179">Example</span></span>  
 <span data-ttu-id="8f320-180">Di seguito è riportato un esempio dello script precedente per la creazione di una pubblicazione transazionale, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-181">Questa pubblicazione supporta l'aggiornamento immediato sostituito dall'aggiornamento in coda come soluzione di failover.</span><span class="sxs-lookup"><span data-stu-id="8f320-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="8f320-182">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-183"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-184">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-184">Example</span></span>  
 <span data-ttu-id="8f320-185">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una pubblicazione di tipo merge per la tabella Customers.</span><span class="sxs-lookup"><span data-stu-id="8f320-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="8f320-186">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-187">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-187">Example</span></span>  
 <span data-ttu-id="8f320-188">Di seguito è riportato un esempio dello script precedente per la creazione di una pubblicazione di tipo merge, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-189">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-190"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-191">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-191">Example</span></span>  
 <span data-ttu-id="8f320-192">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una sottoscrizione push di una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="8f320-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="8f320-193">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-194">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-194">Example</span></span>  
 <span data-ttu-id="8f320-195">Di seguito è riportato un esempio dello script precedente per la creazione di una sottoscrizione push di una pubblicazione transazionale, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-196">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-197"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-198">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-198">Example</span></span>  
 <span data-ttu-id="8f320-199">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una sottoscrizione push di una pubblicazione di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="8f320-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="8f320-200">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-201">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-201">Example</span></span>  
 <span data-ttu-id="8f320-202">Di seguito è riportato un esempio dello script precedente per la creazione di una sottoscrizione push di una pubblicazione di tipo merge, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-203">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-204"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-205">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-205">Example</span></span>  
 <span data-ttu-id="8f320-206">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una sottoscrizione pull di una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="8f320-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="8f320-207">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-208">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-208">Example</span></span>  
 <span data-ttu-id="8f320-209">Di seguito è riportato un esempio dello script precedente per la creazione di una sottoscrizione pull di una pubblicazione transazionale, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-210">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-211"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-212">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-212">Example</span></span>  
 <span data-ttu-id="8f320-213">Di seguito è riportato un esempio di uno script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] per la creazione di una sottoscrizione pull di una pubblicazione di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="8f320-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="8f320-214">I parametri predefiniti sono stati rimossi per una maggiore leggibilità.</span><span class="sxs-lookup"><span data-stu-id="8f320-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="8f320-215">Esempio</span><span class="sxs-lookup"><span data-stu-id="8f320-215">Example</span></span>  
 <span data-ttu-id="8f320-216">Di seguito è riportato un esempio dello script precedente per la creazione di una sottoscrizione pull di una pubblicazione di tipo merge, aggiornato in modo da essere eseguito correttamente in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8f320-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="8f320-217">I valori predefiniti dei nuovi parametri sono stati dichiarati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="8f320-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f320-218"> Le credenziali di Windows vengono specificate in fase di esecuzione mediante variabili di scripting **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="8f320-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="8f320-219">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="8f320-219">See Also</span></span>  
 <span data-ttu-id="8f320-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="8f320-221">[Create a Push Subscription](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="8f320-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="8f320-223">[Visualizzare e modificare le impostazioni di sicurezza della replica](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="8f320-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="8f320-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="8f320-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="8f320-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="8f320-227">Aggiornare database replicati</span><span class="sxs-lookup"><span data-stu-id="8f320-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
