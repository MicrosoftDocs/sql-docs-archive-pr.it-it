---
title: Migliorare le prestazioni della replica di tipo merge | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], design and performance
- designing databases [SQL Server], replication performance
- Merge Agent, performance
- snapshots [SQL Server replication], performance considerations
- merge replication performance [SQL Server replication]
- subscriptions [SQL Server replication], performance considerations
- performance [SQL Server replication], merge replication
- agents [SQL Server replication], performance
ms.assetid: f929226f-b83d-4900-a07c-a62f64527c7f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 41dc258e9b45e9839ad142e73cb145999d02986c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725560"
---
# <a name="enhance-merge-replication-performance"></a><span data-ttu-id="5251f-102">Miglioramento delle prestazioni della replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5251f-102">Enhance Merge Replication Performance</span></span>
  <span data-ttu-id="5251f-103">Dopo aver valutato i suggerimenti relativi alle prestazioni generali descritti in [Miglioramento delle prestazioni generali della replica](enhance-general-replication-performance.md), è opportuno considerare questi ulteriori aspetti specifici della replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-103">After considering the general performance tips described in [Enhancing General Replication Performance](enhance-general-replication-performance.md), consider these additional areas specific to merge replication.</span></span>  
  
## <a name="database-design"></a><span data-ttu-id="5251f-104">Progettazione di database</span><span class="sxs-lookup"><span data-stu-id="5251f-104">Database Design</span></span>  
  
-   <span data-ttu-id="5251f-105">Colonne di indice utilizzate in filtri di riga e filtri join.</span><span class="sxs-lookup"><span data-stu-id="5251f-105">Index columns used in row filters and join filters.</span></span>  
  
     <span data-ttu-id="5251f-106">Se si applica un filtro di riga a un articolo pubblicato, è necessario creare un indice per ogni colonna specificata nella clausola WHERE del filtro.</span><span class="sxs-lookup"><span data-stu-id="5251f-106">When you use a row filter on a published article, create an index on each of the columns that is used in the filter's WHERE clause.</span></span> <span data-ttu-id="5251f-107">In assenza di un indice, ogni riga della tabella deve essere letta da [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per determinare se debba essere inclusa o meno nella partizione.</span><span class="sxs-lookup"><span data-stu-id="5251f-107">Without an index, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has to read each row in the table to determine whether the row should be included in the partition.</span></span> <span data-ttu-id="5251f-108">In presenza dell'indice, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] è in grado di individuare rapidamente le righe da includere.</span><span class="sxs-lookup"><span data-stu-id="5251f-108">With an index, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can quickly locate which rows should be included.</span></span> <span data-ttu-id="5251f-109">L'elaborazione più rapida si ottiene quando tramite la replica è possibile risolvere completamente la clausola WHERE del filtro solo in base all'indice.</span><span class="sxs-lookup"><span data-stu-id="5251f-109">The fastest processing takes place if replication can fully resolve the WHERE clause of the filter from the index alone.</span></span>  
  
     <span data-ttu-id="5251f-110">È inoltre importante indicizzare tutte le colonne utilizzate nei filtri join.</span><span class="sxs-lookup"><span data-stu-id="5251f-110">Indexing all the columns used in join filters is also important.</span></span> <span data-ttu-id="5251f-111">A ogni esecuzione dell'agente di merge viene eseguita la ricerca della tabella di base per determinare quali righe della tabella padre e delle tabelle correlate sono incluse in una partizione.</span><span class="sxs-lookup"><span data-stu-id="5251f-111">Each time the Merge Agent runs, it searches the base table to determine which rows in a parent table and which rows in related tables are included in a partition.</span></span> <span data-ttu-id="5251f-112">La creazione di un indice delle colonne unite in join consente di evitare la lettura di ogni riga della tabella da parte di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] a ogni esecuzione dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-112">Creating an index on the joined columns avoids having [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] read each row in the table every time the Merge Agent runs.</span></span>  
  
     <span data-ttu-id="5251f-113">Per altre informazioni sui filtri, vedere [Filtrare i dati pubblicati per la replica di tipo merge](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-113">For more information on filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="5251f-114">‏Si considerino le tabelle in fase di sovranormalizzazione che includono tipi di dati LOB (Large Object).</span><span class="sxs-lookup"><span data-stu-id="5251f-114">Consider overnormalizing tables that include Large Object (LOB) data types.</span></span>  
  
     <span data-ttu-id="5251f-115">Quando viene eseguita la sincronizzazione, è possibile che l'agente di merge debba leggere e trasferire l'intera riga di dati da un server di pubblicazione o un Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5251f-115">When synchronization occurs, the Merge Agent might need to read and transfer the entire data row from a Publisher or Subscriber.</span></span> <span data-ttu-id="5251f-116">Se la riga include colonne con dati LOB, questo processo può richiedere l'allocazione di memoria aggiuntiva e influire negativamente sulle prestazioni anche se tali colonne non sono state aggiornate.</span><span class="sxs-lookup"><span data-stu-id="5251f-116">If the row contains columns that use LOBs, this process can require additional memory allocation and negatively impact performance even though these columns may not have been updated.</span></span> <span data-ttu-id="5251f-117">Per ridurre la probabilità di tale impatto negativo sulle prestazioni, è possibile inserire le colonne LOB in una tabella distinta utilizzando una relazione uno-a-uno con la parte rimanente della riga di dati.</span><span class="sxs-lookup"><span data-stu-id="5251f-117">To reduce the likelihood that this performance impact occurs, consider putting LOB columns in a separate table using a one-to-one relationship to the rest of the row data.</span></span> <span data-ttu-id="5251f-118">I tipi di dati `text`, `ntext` e `image` sono deprecati.</span><span class="sxs-lookup"><span data-stu-id="5251f-118">The data types `text`, `ntext`, and `image` are deprecated.</span></span> <span data-ttu-id="5251f-119">Se è necessario includere dati LOB, è consigliabile utilizzare rispettivamente i tipi di dati `varchar(max)`, `nvarchar(max)` e `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="5251f-119">If you do include LOBs, we recommend that you use the data types `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, respectively.</span></span>  
  
## <a name="publication-design"></a><span data-ttu-id="5251f-120">Progettazione della pubblicazione</span><span class="sxs-lookup"><span data-stu-id="5251f-120">Publication Design</span></span>  
  
-   <span data-ttu-id="5251f-121">Impostare il livello di compatibilità della pubblicazione su 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o versione successiva).</span><span class="sxs-lookup"><span data-stu-id="5251f-121">Use a publication compatibility level of 90RTM ([!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version).</span></span>  
  
     <span data-ttu-id="5251f-122">A meno che uno o più Sottoscrittori utilizzino una versione diversa di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], specificare che la pubblicazione deve supportare solo [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="5251f-122">Unless one or more Subscribers use a different version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], specify that the publication must support only [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span> <span data-ttu-id="5251f-123">Ciò consente di sfruttare le nuove funzionalità e le ottimizzazioni delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="5251f-123">This allows the publication to take advantage of new features and performance optimizations.</span></span>  
  
-   <span data-ttu-id="5251f-124">Utilizzare impostazioni appropriate relative al periodo di memorizzazione della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-124">Use appropriate publication retention settings.</span></span>  
  
     <span data-ttu-id="5251f-125">Il periodo di memorizzazione della pubblicazione, ovvero il periodo di tempo massimo prima che una sottoscrizione debba essere sincronizzata, determina la durata dell'archiviazione dei metadati di rilevamento.</span><span class="sxs-lookup"><span data-stu-id="5251f-125">The publication retention period, which is the maximum amount of time before a subscription must be synchronized, determines how long tracking metadata is stored.</span></span> <span data-ttu-id="5251f-126">Un valore elevato può influire sulle prestazioni di elaborazione e archiviazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-126">A high value can affect storage and processing performance.</span></span> <span data-ttu-id="5251f-127">Per ulteriori informazioni sull'impostazione del periodo di memorizzazione della pubblicazione, vedere [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-127">For more information about setting the publication retention period, see [Subscription Expiration and Deactivation](../subscription-expiration-and-deactivation.md).</span></span>  
  
-   <span data-ttu-id="5251f-128">Utilizzare articoli di solo download per le tabelle modificate solo nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-128">Use download-only articles on those tables that are only changed at the Publisher.</span></span> <span data-ttu-id="5251f-129">Per altre informazioni, vedere [Ottimizzare le prestazioni della replica di tipo merge con gli articoli di solo download](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-129">For more information, see [Optimize Merge Replication Performance with Download-Only Articles](../merge/optimize-merge-replication-performance-with-download-only-articles.md).</span></span>  
  
### <a name="filter-design-and-use"></a><span data-ttu-id="5251f-130">Progettazione e utilizzo dei filtri</span><span class="sxs-lookup"><span data-stu-id="5251f-130">Filter Design and Use</span></span>  
  
-   <span data-ttu-id="5251f-131">Limitare la complessità delle clausole dei filtri di riga.</span><span class="sxs-lookup"><span data-stu-id="5251f-131">Limit the complexity of row filter clauses.</span></span>  
  
     <span data-ttu-id="5251f-132">Limitando la complessità dei criteri di filtro è possibile migliorare le prestazioni durante la valutazione da parte dell'agente di merge delle modifiche delle righe da inviare ai Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="5251f-132">Limiting the complexity of the filtering criteria helps improve performance when the Merge Agent is evaluating row changes to send to Subscribers.</span></span> <span data-ttu-id="5251f-133">Evitare di utilizzare selezioni secondarie all'interno delle clausole dei filtri di riga.</span><span class="sxs-lookup"><span data-stu-id="5251f-133">Avoid using sub-selects within merge row filter clauses.</span></span> <span data-ttu-id="5251f-134">Considerare, invece, l'opportunità di utilizzare filtri di join, in genere più efficienti se utilizzati per partizionare i dati di una tabella in base alla clausola del filtro di riga di un'altra tabella.</span><span class="sxs-lookup"><span data-stu-id="5251f-134">Instead, consider using join filters, which are generally more efficient when used to partition data in one table based on the row filter clause in another table.</span></span> <span data-ttu-id="5251f-135">Per altre informazioni sui filtri, vedere [Filtrare i dati pubblicati per la replica di tipo merge](../merge/filter-published-data-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-135">For more information about filtering, see [Filter Published Data for Merge Replication](../merge/filter-published-data-for-merge-replication.md).</span></span>  
  
-   <span data-ttu-id="5251f-136">Utilizzare partizioni pre-calcolate con filtri con parametri (funzionalità utilizzata per impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="5251f-136">Use precomputed partitions with parameterized filters (this feature is used by default).</span></span> <span data-ttu-id="5251f-137">Per altre informazioni, vedere [Ottimizzare le prestazioni dei filtri con parametri con le partizioni pre-calcolate](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-137">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](../merge/parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>  
  
     <span data-ttu-id="5251f-138">Le partizioni pre-calcolate impongono vari limiti al funzionamento dei filtri.</span><span class="sxs-lookup"><span data-stu-id="5251f-138">Precomputed partitions impose a number of limits on filtering behavior.</span></span> <span data-ttu-id="5251f-139">Se l'applicazione non è in grado di rispettare tali limiti, impostare l'opzione **keep_partition_changes** su **True**. Ciò consente di migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="5251f-139">If your application cannot adhere to these limitations, set the **keep_partition_changes** option to **True**, which provides a performance benefit.</span></span> <span data-ttu-id="5251f-140">Per altre informazioni sui filtri di riga con parametri, vedere [Filtri di riga con parametri](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-140">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="5251f-141">Utilizzare partizioni non sovrapposte se i dati vengono filtrati ma non condivisi tra gli utenti.</span><span class="sxs-lookup"><span data-stu-id="5251f-141">Use nonoverlapping partitions if data is filtered but not shared among users.</span></span>  
  
     <span data-ttu-id="5251f-142">La replica consente di ottimizzare le prestazioni dei dati che non vengono condivisi tra partizioni o sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="5251f-142">Replication can optimize performance for data that is not shared between partitions or subscriptions.</span></span> <span data-ttu-id="5251f-143">Per altre informazioni sui filtri di riga con parametri, vedere [Filtri di riga con parametri](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-143">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
-   <span data-ttu-id="5251f-144">Evitare di creare gerarchie di filtri join complesse.</span><span class="sxs-lookup"><span data-stu-id="5251f-144">Do not create complex join filter hierarchies.</span></span>  
  
     <span data-ttu-id="5251f-145">I filtri join composti da più di cinque tabelle possono avere un impatto decisivo sulle prestazioni durante l'elaborazione di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-145">Join filters with five or more tables can significantly impact performance during merge processing.</span></span> <span data-ttu-id="5251f-146">Se è necessario generare filtri join per cinque o più tabelle, è consigliabile optare per altre soluzioni:</span><span class="sxs-lookup"><span data-stu-id="5251f-146">We recommend that if you are generating join filters of five or more tables that you consider other solutions:</span></span>  
  
    -   <span data-ttu-id="5251f-147">Evitare di filtrare le tabelle che fungono principalmente da tabelle di ricerca, le tabelle di dimensioni ridotte e le tabelle non soggette a modifica,</span><span class="sxs-lookup"><span data-stu-id="5251f-147">Avoid filtering tables that are primarily lookup tables, smaller tables, and tables that are not subject to change.</span></span> <span data-ttu-id="5251f-148">che è preferibile inserire nella pubblicazione senza ricorrere ad alcun filtro.</span><span class="sxs-lookup"><span data-stu-id="5251f-148">Make those tables part of the publication in their entirety.</span></span> <span data-ttu-id="5251f-149">È consigliabile utilizzare filtri join solo tra tabelle che devono essere partizionate tra i Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="5251f-149">We recommend that you use join filters only between tables that must be partitioned among Subscribers.</span></span> <span data-ttu-id="5251f-150">Per altre informazioni, vedere [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-150">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
    -   <span data-ttu-id="5251f-151">Considerare la denormalizzazione della progettazione del database o l'utilizzo di una tabella di mapping qualora in un join siano presenti molte tabelle.</span><span class="sxs-lookup"><span data-stu-id="5251f-151">Consider denormalizing the database design or using a mapping table if there are a large number of tables in a join.</span></span> <span data-ttu-id="5251f-152">Ad esempio, se un venditore necessita solo dei dati relativi ai propri clienti e per associare un cliente a un determinato venditore sono necessari sei join, considerare l'opportunità di aggiungere alla tabella dei clienti una colonna che identifica il venditore.</span><span class="sxs-lookup"><span data-stu-id="5251f-152">For example, if a sales person needs only the data for her customers, but it requires six joins to associate a customer with a sales person, consider adding a column to the customer table that identifies the sales person.</span></span> <span data-ttu-id="5251f-153">I dati del venditore sono ridondanti, ma i costi della denormalizzazione delle tabelle vengono compensati in una certa misura dai vantaggi a livello delle prestazioni per la partizione della replica.</span><span class="sxs-lookup"><span data-stu-id="5251f-153">The sales person data is redundant, but the costs of denormalizing the tables somewhat might be outweighed by the performance benefits for replication partitioning.</span></span>  
  
    -   <span data-ttu-id="5251f-154">Per migliorare le prestazioni delle partizioni pre-calcolate quando i batch contengono molte modifiche ai dati, progettare l'applicazione con attenzione.</span><span class="sxs-lookup"><span data-stu-id="5251f-154">To improve the performance of precomputed partitions when batches contain lots of data changes, design your application with care.</span></span> <span data-ttu-id="5251f-155">Assicurare che le modifiche ai dati nella tabella padre in un filtro join vengano apportate prima delle corrispondenti modifiche nelle tabelle figlio.</span><span class="sxs-lookup"><span data-stu-id="5251f-155">Make sure that changes to data in the parent table in a join filter are made before corresponding changes in the child tables.</span></span>  
  
-   <span data-ttu-id="5251f-156">Impostare l'opzione **join_unique_key** su **1** se la logica lo consente.</span><span class="sxs-lookup"><span data-stu-id="5251f-156">Set the **join_unique_key** option to **1** if logic allows.</span></span>  
  
     <span data-ttu-id="5251f-157">Impostando questo parametro su **1** , la relazione tra le tabelle figlio e le tabelle padre in un filtro join sarà di tipo uno-a-uno o uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="5251f-157">Setting this parameter to **1** indicates that the relationship between the child and parent tables in a join filter is one to one or one to many.</span></span> <span data-ttu-id="5251f-158">Impostare questo parametro su **1** solo se esiste un vincolo nella colonna di join della tabella figlio che garantisce l'univocità.</span><span class="sxs-lookup"><span data-stu-id="5251f-158">Only set this parameter to **1** if you have a constraint on the joining column in the child table that guarantees uniqueness.</span></span> <span data-ttu-id="5251f-159">Un'impostazione non corretta del parametro su **1** può impedire la convergenza dei dati.</span><span class="sxs-lookup"><span data-stu-id="5251f-159">If the parameter is set to **1** incorrectly, non-convergence of data can occur.</span></span> <span data-ttu-id="5251f-160">Per altre informazioni, vedere [Join Filters](../merge/join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-160">For more information, see [Join Filters](../merge/join-filters.md).</span></span>  
  
-   <span data-ttu-id="5251f-161">Non eseguire batch con molte modifiche se si utilizzano partizioni pre-calcolate.</span><span class="sxs-lookup"><span data-stu-id="5251f-161">Avoid executing batches with lots of changes when you use precomputed partitions.</span></span>  
  
     <span data-ttu-id="5251f-162">Se l'agente di merge viene eseguito dopo un batch che contiene molte modifiche ai dati, tenterà di suddividere il batch di grandi dimensioni in batch minori.</span><span class="sxs-lookup"><span data-stu-id="5251f-162">When the Merge Agent is run after you run a batch that contains lots of data changes, the agent tries to divide the large batch into smaller batches.</span></span> <span data-ttu-id="5251f-163">Nel frattempo altri processi dell'agente di merge potrebbero risultare bloccati.</span><span class="sxs-lookup"><span data-stu-id="5251f-163">During this time, other Merge Agent processes may be blocked.</span></span> <span data-ttu-id="5251f-164">Provare a ridurre il numero di modifiche contenute in un batch e ad eseguire l'agente di merge tra i batch.</span><span class="sxs-lookup"><span data-stu-id="5251f-164">Consider reducing the number of changes in a batch and run the Merge Agent between batches.</span></span> <span data-ttu-id="5251f-165">Se non è possibile, aumentare il valore di **generation_leveling_threshold** per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-165">If this cannot be done, increase the value of **generation_leveling_threshold** for the publication.</span></span>  
  
## <a name="subscription-considerations"></a><span data-ttu-id="5251f-166">Considerazioni sulle sottoscrizioni</span><span class="sxs-lookup"><span data-stu-id="5251f-166">Subscription Considerations</span></span>  
  
-   <span data-ttu-id="5251f-167">Scaglionare le pianificazioni di sincronizzazione delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="5251f-167">Stagger subscription synchronization schedules.</span></span>  
  
     <span data-ttu-id="5251f-168">Nel caso in cui un numero elevato di Sottoscrittori esegua la sincronizzazione con un server di pubblicazione, considerare l'opportunità di scaglionare le pianificazioni in modo che gli agenti di merge vengano eseguiti in momenti diversi.</span><span class="sxs-lookup"><span data-stu-id="5251f-168">If a large number of Subscribers synchronize with a Publisher, consider staggering the schedules so that Merge Agents run at different times.</span></span> <span data-ttu-id="5251f-169">Per altre informazioni, vedere [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-169">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span>  
  
## <a name="merge-agent-parameters"></a><span data-ttu-id="5251f-170">Parametri dell'agente di merge</span><span class="sxs-lookup"><span data-stu-id="5251f-170">Merge Agent Parameters</span></span>  
 <span data-ttu-id="5251f-171">Per informazioni sull'agente di merge e sui relativi parametri, vedere [Replication Merge Agent](../agents/replication-merge-agent.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-171">For information about the Merge Agent and its parameters, see [Replication Merge Agent](../agents/replication-merge-agent.md).</span></span>  
  
-   <span data-ttu-id="5251f-172">Aggiornare tutti i Sottoscrittori per le sottoscrizioni pull a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="5251f-172">Upgrade all Subscribers for pull subscriptions to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version.</span></span>  
  
     <span data-ttu-id="5251f-173">Se si aggiorna il Sottoscrittore a [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o versione successiva, viene aggiornato anche l'agente di merge utilizzato dalle sottoscrizioni nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5251f-173">Upgrading the Subscriber to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version upgrades the Merge Agent used by the subscriptions at that Subscriber.</span></span> <span data-ttu-id="5251f-174">Per poter utilizzare molte delle nuove funzionalità e ottimizzazioni delle prestazioni, è necessario l'agente di merge di [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="5251f-174">To take advantage of many of the new features and performance optimizations, the Merge Agent from [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version is required.</span></span>  
  
-   <span data-ttu-id="5251f-175">Se la sincronizzazione di una sottoscrizione avviene con una connessione veloce e le modifiche vengono inviate dal server di pubblicazione e dal Sottoscrittore, usare il parametro **-ParallelUploadDownload** per l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-175">If a subscription is synchronized over a fast connection and changes are sent from the Publisher and Subscriber, use the **-ParallelUploadDownload** parameter for the Merge Agent.</span></span>  
  
     [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]<span data-ttu-id="5251f-176">è stato introdotto un nuovo agente di merge parametro: **-ParallelUploadDownload**.</span><span class="sxs-lookup"><span data-stu-id="5251f-176">introduced a new Merge Agent parameter: **-ParallelUploadDownload**.</span></span> <span data-ttu-id="5251f-177">L'impostazione di questo parametro consente di elaborare in parallelo le modifiche caricate nel server di pubblicazione e le modifiche scaricate nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5251f-177">Setting this parameter allows the Merge Agent to process in parallel the changes uploaded to the Publisher and those downloaded to the Subscriber.</span></span> <span data-ttu-id="5251f-178">Ciò è utile negli ambienti caratterizzati da volumi di traffico elevati con un'ampia larghezza di banda di rete.</span><span class="sxs-lookup"><span data-stu-id="5251f-178">This is useful in high volume environments with high network bandwidth.</span></span> <span data-ttu-id="5251f-179">I parametri degli agenti possono essere specificati nei profili agente e dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="5251f-179">Agent parameters can be specified in agent profiles and on the command line.</span></span> <span data-ttu-id="5251f-180">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="5251f-180">For more information, see:</span></span>  
  
    -   [<span data-ttu-id="5251f-181">Usare i profili agenti di replica</span><span class="sxs-lookup"><span data-stu-id="5251f-181">Work with Replication Agent Profiles</span></span>](../agents/replication-agent-profiles.md)  
  
    -   [<span data-ttu-id="5251f-182">Visualizzare e modificare i parametri del prompt dei comandi dell'agente di replica &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="5251f-182">View and Modify Replication Agent Command Prompt Parameters &#40;SQL Server Management Studio&#41;</span></span>](../agents/view-and-modify-replication-agent-command-prompt-parameters.md)  
  
    -   [<span data-ttu-id="5251f-183">Replication Agent Executables Concepts</span><span class="sxs-lookup"><span data-stu-id="5251f-183">Replication Agent Executables Concepts</span></span>](../concepts/replication-agent-executables-concepts.md)  
  
-   <span data-ttu-id="5251f-184">Provare ad aumentare il valore del parametro **-MakeGenerationInterval** , in particolare se la sincronizzazione prevede più caricamenti che download dai Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="5251f-184">Consider increasing the value of the **-MakeGenerationInterval** parameter, especially if synchronization involves more uploads from Subscribers than downloads to Subscribers.</span></span>  
  
-   <span data-ttu-id="5251f-185">Quando si sincronizzano righe di dati con un'ingente quantità di dati, ad esempio righe con colonne LOB, la sincronizzazione tramite il Web può richiedere l'allocazione di memoria aggiuntiva e ridurre le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="5251f-185">When you synchronize data rows with a large amount of data, such as rows with LOB columns, Web synchronization can require additional memory allocation and hurt performance.</span></span> <span data-ttu-id="5251f-186">Ciò si verifica quando l'agente di merge genera un messaggio XML contenente un numero troppo elevato di righe di dati con ingenti quantità di dati.</span><span class="sxs-lookup"><span data-stu-id="5251f-186">This occurs when the Merge Agent generates an XML message that contains too many data rows with large amounts of data.</span></span> <span data-ttu-id="5251f-187">Se l'agente di merge utilizza una quantità eccessiva di risorse durante la sincronizzazione tramite il Web, ridurre il numero di righe inviate in un singolo messaggio in uno dei modi seguenti:</span><span class="sxs-lookup"><span data-stu-id="5251f-187">If the Merge Agent is consuming too many resources during Web synchronization, reduce the number of rows sent in a single message in one of the following ways:</span></span>  
  
    -   <span data-ttu-id="5251f-188">Utilizzare il profilo agente a collegamento lento per l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-188">Use the slow link agent profile for the Merge Agent.</span></span> <span data-ttu-id="5251f-189">Per altre informazioni, vedere [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-189">For more information, see [Replication Agent Profiles](../agents/replication-agent-profiles.md).</span></span>  
  
    -   <span data-ttu-id="5251f-190">Ridurre i parametri **- DownloadGenerationsPerBatch** e **- UploadGenerationsPerBatch** per l'agente di merge a un valore pari a 10 o meno.</span><span class="sxs-lookup"><span data-stu-id="5251f-190">Decrease the **-DownloadGenerationsPerBatch** and **-UploadGenerationsPerBatch** parameters for the Merge Agent to a value of 10 or less.</span></span> <span data-ttu-id="5251f-191">Il valore predefinito di questi parametri è 50.</span><span class="sxs-lookup"><span data-stu-id="5251f-191">The default value of these parameters is 50.</span></span>  
  
## <a name="snapshot-considerations"></a><span data-ttu-id="5251f-192">Considerazioni sugli snapshot</span><span class="sxs-lookup"><span data-stu-id="5251f-192">Snapshot Considerations</span></span>  
  
-   <span data-ttu-id="5251f-193">Creare una colonna ROWGUIDCOL nelle tabelle di grandi dimensioni prima di generare lo snapshot iniziale.</span><span class="sxs-lookup"><span data-stu-id="5251f-193">Create a ROWGUIDCOL column on large tables prior to generating the initial snapshot.</span></span>  
  
     <span data-ttu-id="5251f-194">La replica di tipo merge richiede che ogni tabella pubblicata includa una colonna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="5251f-194">Merge replication requires that each published table have a ROWGUIDCOL column.</span></span> <span data-ttu-id="5251f-195">Se la colonna ROWGUIDCOL non è disponibile quando l'agente snapshot crea i file di snapshot iniziali, l'agente dovrà innanzitutto aggiungere e popolare la colonna ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="5251f-195">If a ROWGUIDCOL column does not exist in the table before the Snapshot Agent creates the initial snapshot files, the agent must first add and populate the ROWGUIDCOL column.</span></span> <span data-ttu-id="5251f-196">Per migliorare le prestazioni delle operazioni di generazione di snapshot durante la replica di tipo merge, creare la colonna ROWGUIDCOL in tutte le tabelle prima della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-196">To gain a performance advantage when generating snapshots during merge replication, create the ROWGUIDCOL column on each table before publishing.</span></span> <span data-ttu-id="5251f-197">Anche se, per impostazione predefinita, l'agente snapshot utilizza il nome**rowguid** , a tale colonna può essere assegnato qualsiasi nome che includa le funzionalità seguenti relative al tipo di dati:</span><span class="sxs-lookup"><span data-stu-id="5251f-197">The column can have any name (**rowguid** is used by the Snapshot Agent by default), but must have the following data type characteristics:</span></span>  
  
    -   <span data-ttu-id="5251f-198">Un tipo di dati UNIQUEIDENTIFIER.</span><span class="sxs-lookup"><span data-stu-id="5251f-198">A data type of UNIQUEIDENTIFIER.</span></span>  
  
    -   <span data-ttu-id="5251f-199">Un valore predefinito di tipo NEWSEQUENTIALID() o NEWID().</span><span class="sxs-lookup"><span data-stu-id="5251f-199">A default of NEWSEQUENTIALID() or NEWID().</span></span> <span data-ttu-id="5251f-200">Per garantire un migliore livello di prestazioni durante l'inserimento e il rilevamento di modifiche, è consigliabile utilizzare NEWSEQUENTIALID().</span><span class="sxs-lookup"><span data-stu-id="5251f-200">NEWSEQUENTIALID() is recommended because it can provide increased performance when making and tracking changes.</span></span>  
  
    -   <span data-ttu-id="5251f-201">Il set di proprietà ROWGUIDCOL.</span><span class="sxs-lookup"><span data-stu-id="5251f-201">The ROWGUIDCOL property set.</span></span>  
  
    -   <span data-ttu-id="5251f-202">Un indice univoco nella colonna.</span><span class="sxs-lookup"><span data-stu-id="5251f-202">A unique index on the column.</span></span>  
  
-   <span data-ttu-id="5251f-203">Creare snapshot preliminari e/o consentire ai Sottoscrittori di richiedere la generazione e l'applicazione di snapshot alla prima sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="5251f-203">Pre-generate snapshots and/or allow Subscribers to request snapshot generation and application the first time they synchronize.</span></span>  
  
     <span data-ttu-id="5251f-204">Utilizzare una o entrambe le opzioni per generare snapshot per le pubblicazioni che utilizzando filtri con parametri.</span><span class="sxs-lookup"><span data-stu-id="5251f-204">Use one or both of these options to provide snapshots for publications that use parameterized filters.</span></span> <span data-ttu-id="5251f-205">Se non si specifica alcuna opzione, le sottoscrizioni vengono inizializzate tramite una serie di istruzioni SELECT e INSERT, anziché tramite l'utilità **bcp** . Questo processo risulta decisamente più lento.</span><span class="sxs-lookup"><span data-stu-id="5251f-205">If you do not specify one of these options, subscriptions are initialized using a series of SELECT and INSERT statements, rather than using the **bcp** utility; this process is much slower.</span></span> <span data-ttu-id="5251f-206">Per altre informazioni, vedere [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-206">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
## <a name="maintenance-and-monitoring-considerations"></a><span data-ttu-id="5251f-207">Considerazioni sulla manutenzione e sul monitoraggio</span><span class="sxs-lookup"><span data-stu-id="5251f-207">Maintenance and Monitoring Considerations</span></span>  
  
-   <span data-ttu-id="5251f-208">Eseguire occasionalmente la reindicizzazione delle tabelle di sistema per la replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-208">Occasionally re-index merge replication system tables.</span></span>  
  
     <span data-ttu-id="5251f-209">Come parte della manutenzione per la replica di tipo merge, controllare occasionalmente l'aumento delle dimensioni delle tabelle di sistema associate alla replica di tipo merge: **MSmerge_contents**, **MSmerge_genhistory**e **MSmerge_tombstone**, **MSmerge_current_partition_mappings**e **MSmerge_past_partition_mappings**.</span><span class="sxs-lookup"><span data-stu-id="5251f-209">As part of maintenance for merge replication, occasionally check the growth of the system tables associated with merge replication: **MSmerge_contents**, **MSmerge_genhistory**, and **MSmerge_tombstone**, **MSmerge_current_partition_mappings**, and **MSmerge_past_partition_mappings**.</span></span> <span data-ttu-id="5251f-210">Reindicizzare periodicamente queste tabelle.</span><span class="sxs-lookup"><span data-stu-id="5251f-210">Periodically re-index these tables.</span></span> <span data-ttu-id="5251f-211">Per altre informazioni, vedere [Riorganizzare e ricompilare gli indici](../../indexes/reorganize-and-rebuild-indexes.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-211">For more information, see [Reorganize and Rebuild Indexes](../../indexes/reorganize-and-rebuild-indexes.md).</span></span>  
  
-   <span data-ttu-id="5251f-212">Monitorare le prestazioni della sincronizzazione utilizzando la scheda **Cronologia sincronizzazione** in Monitoraggio replica.</span><span class="sxs-lookup"><span data-stu-id="5251f-212">Monitor synchronization performance using the **Synchronization History** tab in Replication Monitor.</span></span>  
  
     <span data-ttu-id="5251f-213">Per la replica di tipo merge in Monitoraggio replica nella scheda **Cronologia sincronizzazione** vengono visualizzate statistiche dettagliate di ogni articolo elaborato durante la sincronizzazione, inclusa la quantità di tempo impiegato in ogni fase di elaborazione (caricamento delle modifiche, download delle modifiche e così via).</span><span class="sxs-lookup"><span data-stu-id="5251f-213">For merge replication, Replication Monitor displays detailed statistics in the **Synchronization History** tab for each article processed during synchronization, including the amount of time spent in each processing phase (uploading changes, downloading changes, and so on).</span></span> <span data-ttu-id="5251f-214">Ciò può essere utile per individuare tabelle specifiche che determinano rallentamenti ed è l'opzione migliore per risolvere problemi relativi alle prestazioni delle sottoscrizioni di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="5251f-214">It can help pinpoint specific tables that are causing slow downs and is the best place to troubleshoot performance issues with merge subscriptions.</span></span> <span data-ttu-id="5251f-215">Per altre informazioni sulla visualizzazione di statistiche dettagliate, vedere [Visualizzare le informazioni ed eseguire attività usando Monitoraggio replica](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="5251f-215">For more information on viewing detailed statistics, see [View Information and Perform Tasks using Replication Monitor](../monitor/view-information-and-perform-tasks-replication-monitor.md).</span></span>  
  
  
