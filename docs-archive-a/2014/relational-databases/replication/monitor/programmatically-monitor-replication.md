---
title: Monitorare la replica a livello di programmazione | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725519"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="fceda-102">Monitoraggio della replica a livello di programmazione</span><span class="sxs-lookup"><span data-stu-id="fceda-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="fceda-103">Monitoraggio replica è uno strumento grafico che consente di monitorare una topologia di replica.</span><span class="sxs-lookup"><span data-stu-id="fceda-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="fceda-104">È possibile accedere agli stessi dati di monitoraggio a livello di programmazione utilizzando le stored procedure di replica [!INCLUDE[tsql](../../../includes/tsql-md.md)] o gli oggetti RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="fceda-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="fceda-105">Tali oggetti consentono di programmare le attività seguenti:</span><span class="sxs-lookup"><span data-stu-id="fceda-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="fceda-106">Monitoraggio dello stato dei server di pubblicazione, delle pubblicazioni e delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="fceda-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="fceda-107">Monitoraggio delle sessioni dell'agente di merge in uno o più Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="fceda-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="fceda-108">Monitoraggio dei comandi transazionali in attesa di essere applicati a uno o più Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="fceda-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="fceda-109">Definizione delle metriche di soglia che determinano la necessità di un intervento per una pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="fceda-110">Monitoraggio dello stato dei token di traccia.</span><span class="sxs-lookup"><span data-stu-id="fceda-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="fceda-111">**Contenuto dell'argomento:**</span><span class="sxs-lookup"><span data-stu-id="fceda-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="fceda-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="fceda-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="fceda-113">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="fceda-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="fceda-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="fceda-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="fceda-115">Per monitorare i server di pubblicazione, le pubblicazioni e le sottoscrizioni dal database di distribuzione</span><span class="sxs-lookup"><span data-stu-id="fceda-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="fceda-116">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="fceda-117">Vengono restituite le informazioni di monitoraggio per tutti i server di pubblicazione che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="fceda-118">Per limitare il set di risultati a un solo server di pubblicazione, specificare **@publisher** .</span><span class="sxs-lookup"><span data-stu-id="fceda-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="fceda-119">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="fceda-120">Vengono restituite le informazioni di monitoraggio per tutte le pubblicazioni che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="fceda-121">Per limitare il set di risultati a un solo server di pubblicazione, a una sola pubblicazione o a un solo database pubblicato, specificare **@publisher** **@publication** rispettivamente, o **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="fceda-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="fceda-122">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="fceda-123">Vengono restituite le informazioni di monitoraggio per tutte le sottoscrizioni che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="fceda-124">Per limitare il set di risultati alle sottoscrizioni appartenenti a un solo server di pubblicazione, a una sola pubblicazione o a un solo database pubblicato, specificare **@publisher** **@publication** rispettivamente, o **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="fceda-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="fceda-125">Per monitorare i comandi transazionali in attesa di essere applicati al Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="fceda-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="fceda-126">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="fceda-127">Vengono restituite le informazioni di monitoraggio per tutti i comandi in sospeso per tutte le sottoscrizioni che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="fceda-128">Per limitare il set di risultati ai comandi in sospeso per le sottoscrizioni appartenenti a un solo server di pubblicazione, a un Sottoscrittore, a una pubblicazione o a un database pubblicato, specificare **@publisher** **@subscriber** rispettivamente,, **@publication** o **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="fceda-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="fceda-129">Per monitorare le modifiche di tipo merge in attesa di essere caricate o scaricate</span><span class="sxs-lookup"><span data-stu-id="fceda-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="fceda-130">Nel database di pubblicazione del server di pubblicazione eseguire [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="fceda-131">Viene restituito un set di risultati in cui sono indicate le informazioni sulle modifiche in attesa di essere replicate nei Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="fceda-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="fceda-132">Per limitare il set di risultati alle modifiche che appartengono a una sola pubblicazione o a un solo articolo, specificare **@publication** **@article** rispettivamente o.</span><span class="sxs-lookup"><span data-stu-id="fceda-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="fceda-133">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="fceda-134">Viene restituito un set di risultati in cui sono indicate le informazioni sulle modifiche in attesa di essere replicate nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="fceda-135">Per limitare il set di risultati alle modifiche che appartengono a una sola pubblicazione o a un solo articolo, specificare **@publication** **@article** rispettivamente o.</span><span class="sxs-lookup"><span data-stu-id="fceda-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="fceda-136">Per monitorare sessioni dell'agente di merge</span><span class="sxs-lookup"><span data-stu-id="fceda-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="fceda-137">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="fceda-138">Vengono restituite le informazioni di monitoraggio, **Session_id**incluso, relative a tutte le sessioni dell'agente di merge per tutte le sottoscrizioni che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="fceda-139">È anche possibile ottenere il valore **Session_id** eseguendo una query sulla tabella di sistema [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="fceda-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="fceda-140">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="fceda-141">Specificare il valore **Session_id** indicato al passaggio 1 per **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="fceda-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="fceda-142">Vengono visualizzate informazioni di monitoraggio dettagliate sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="fceda-143">Ripetere il passaggio 2 per ciascuna sessione desiderata.</span><span class="sxs-lookup"><span data-stu-id="fceda-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="fceda-144">Per monitorare le sessioni dell'agente di merge per le sottoscrizioni pull dal Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="fceda-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="fceda-145">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="fceda-146">Per una determinata sottoscrizione, specificare **@publisher** , **@publication** e il nome del database di pubblicazione per **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="fceda-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="fceda-147">Vengono restituite le informazioni di monitoraggio per le ultime cinque sessioni dell'agente di merge della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="fceda-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="fceda-148">Tenere presente il valore di **Session_id** per le sessioni desiderate nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="fceda-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="fceda-149">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="fceda-150">Specificare il valore **Session_id** indicato al passaggio 1 per **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="fceda-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="fceda-151">Vengono visualizzate informazioni di monitoraggio dettagliate sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="fceda-152">Ripetere il passaggio 2 per ciascuna sessione desiderata.</span><span class="sxs-lookup"><span data-stu-id="fceda-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="fceda-153">Per visualizzare e modificare le misurazioni del valore soglia di monitoraggio per una pubblicazione</span><span class="sxs-lookup"><span data-stu-id="fceda-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="fceda-154">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="fceda-155">Vengono restituiti i valore soglia di monitoraggio impostati per tutte le pubblicazioni che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="fceda-156">Per limitare il set di risultati al monitoraggio delle soglie per le pubblicazioni appartenenti a un singolo server di pubblicazione o a un solo database pubblicato o a una sola pubblicazione, specificare **@publisher** **@publisher_db** rispettivamente, o **@publication** .</span><span class="sxs-lookup"><span data-stu-id="fceda-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="fceda-157">Tenere presente il valore di **Metric_id** per i valore soglia da modificare.</span><span class="sxs-lookup"><span data-stu-id="fceda-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="fceda-158">Per altre informazioni, vedere [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="fceda-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="fceda-159">Nel database di distribuzione del server di distribuzione eseguire [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="fceda-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="fceda-160">Specificare i parametri seguenti, in base alle esigenze:</span><span class="sxs-lookup"><span data-stu-id="fceda-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="fceda-161">Il valore **Metric_id** ottenuto nel passaggio 1 per **@metric_id**.</span><span class="sxs-lookup"><span data-stu-id="fceda-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="fceda-162">Nuovo valore per la metrica di soglia di monitoraggio per **@value** .</span><span class="sxs-lookup"><span data-stu-id="fceda-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="fceda-163">Un valore pari a **1** per **@shouldalert** se è necessaria la registrazione di un avviso al raggiungimento del valore soglia specificato o un valore pari a **0** se la registrazione dell'avviso non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="fceda-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="fceda-164">Un valore pari a **1** per **@mode** per abilitare la metrica di soglia di monitoraggio o un valore pari a **2** per disabilitarla.</span><span class="sxs-lookup"><span data-stu-id="fceda-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="fceda-165">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="fceda-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="fceda-166">Per monitorare una sottoscrizione di una pubblicazione di tipo merge nel Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="fceda-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="fceda-167">Creare una connessione al Sottoscrittore tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-168">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> e impostare le proprietà <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>e <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> per la sottoscrizione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="fceda-169">Chiamare uno dei metodi indicati di seguito per ottenere informazioni sulle sessioni dell'agente di merge per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="fceda-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="fceda-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> : restituisce una matrice di oggetti <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> con informazioni sulle ultime cinque sessioni dell'agente di merge al massimo.</span><span class="sxs-lookup"><span data-stu-id="fceda-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="fceda-171">Tenere presente il valore della proprietà <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> per le sessioni desiderate.</span><span class="sxs-lookup"><span data-stu-id="fceda-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="fceda-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> : restituisce una matrice di oggetti <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> con informazioni sulle sessioni dell'agente di merge che hanno avuto luogo durante il numero passato di ore specificato come parametro *hours* (ultime cinque sessioni al massimo).</span><span class="sxs-lookup"><span data-stu-id="fceda-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="fceda-173">Tenere presente il valore della proprietà <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> per le sessioni desiderate.</span><span class="sxs-lookup"><span data-stu-id="fceda-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="fceda-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> : restituisce un oggetto <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> con informazioni sull'ultima sessione dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="fceda-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="fceda-175">Tenere presente il valore della proprietà <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> per questa sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="fceda-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> : restituisce un oggetto <xref:System.Data.DataSet> con informazioni sulle ultime cinque sessioni dell'agente di merge al massimo, una in ciascuna riga.</span><span class="sxs-lookup"><span data-stu-id="fceda-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="fceda-177">Tenere presente il valore della colonna **Session_id** per le sessioni desiderate.</span><span class="sxs-lookup"><span data-stu-id="fceda-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="fceda-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> : restituisce un oggetto <xref:System.Data.DataRow> con informazioni sull'ultima sessione dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="fceda-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="fceda-179">Tenere presente il valore della colonna **Session_id** per questa sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="fceda-180">(Facoltativo) Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> per aggiornare i dati per l'oggetto <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> passato come *mss,* o chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> per aggiornare i dati nell'oggetto <xref:System.Data.DataRow> passato come *drRefresh*.</span><span class="sxs-lookup"><span data-stu-id="fceda-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="fceda-181">Utilizzando l'ID sessione ottenuto nel passaggio 3, chiamare uno dei metodi indicati di seguito per ottenere informazioni sui dettagli di una determinata sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="fceda-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>: restituisce una matrice di <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> oggetti per l'oggetto *SessionID*fornito.</span><span class="sxs-lookup"><span data-stu-id="fceda-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="fceda-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>: restituisce un <xref:System.Data.DataSet> oggetto con le informazioni per l'oggetto *SessionID*specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="fceda-184">Per monitorare le proprietà di replica per tutte le pubblicazioni in un server di distribuzione</span><span class="sxs-lookup"><span data-stu-id="fceda-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="fceda-185">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-186">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="fceda-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="fceda-187">Impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="fceda-188">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="fceda-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="fceda-189">Eseguire uno o più metodi riportati di seguito per ottenere le informazioni di replica per tutti i server di pubblicazione che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli agenti di distribuzione nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sugli errori archiviati nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli agenti di lettura log nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli agenti di merge nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli altri agenti di replica nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti i server di pubblicazione nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> : restituisce un oggetto <xref:System.Data.DataSet> che restituisce i server di pubblicazione che utilizzano il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli agenti di lettura coda nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene dettagli sull'agente di lettura coda specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni di sessione relative all'agente di lettura coda specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti gli agenti snapshot nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="fceda-201">Per monitorare le proprietà della pubblicazione per un server di pubblicazione specifico nel server di distribuzione</span><span class="sxs-lookup"><span data-stu-id="fceda-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="fceda-202">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-203">Recuperare un oggetto <xref:Microsoft.SqlServer.Replication.PublisherMonitor> mediante uno dei modi indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="fceda-204">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.PublisherMonitor>.</span><span class="sxs-lookup"><span data-stu-id="fceda-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="fceda-205">Impostare la proprietà <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> per il server di pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="fceda-206">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="fceda-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="fceda-207">Se questo metodo restituisce `false`, il nome del server di pubblicazione è definito in modo non corretto o la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="fceda-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="fceda-208">Utilizzare l'oggetto <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> a cui si accede mediante la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> di un oggetto <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> esistente.</span><span class="sxs-lookup"><span data-stu-id="fceda-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="fceda-209">Eseguire uno o più metodi riportati di seguito per ottenere le informazioni di replica per tutte le pubblicazioni appartenenti al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="fceda-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene dettagli sull'agente di distribuzione specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni di sessione relative all'agente di distribuzione specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni del record di errori relative all'errore specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="fceda-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene dettagli sull'agente di lettura log specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni di sessione relative all'agente di lettura log specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene dettagli sull'agente di merge specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene ulteriori dettagli sull'agente di merge specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni di sessione relative all'agente di merge specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene ulteriori informazioni di sessione relative all'agente di merge specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutte le pubblicazioni nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene ulteriori informazioni su tutte le pubblicazioni nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="fceda-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene dettagli sull'agente snapshot specificato e sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="fceda-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="fceda-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni di sessione relative all'agente snapshot specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="fceda-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutte le sottoscrizioni delle pubblicazioni nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="fceda-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="fceda-224">Per monitorare le proprietà di una pubblicazione specifica nel server di distribuzione</span><span class="sxs-lookup"><span data-stu-id="fceda-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="fceda-225">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-226">Recuperare un oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitor> mediante uno dei modi indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="fceda-227">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="fceda-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="fceda-228">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>e <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> per la pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="fceda-229">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="fceda-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="fceda-230">Se questo metodo restituisce `false`, le proprietà della pubblicazione sono definite in modo non corretto o la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="fceda-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="fceda-231">Utilizzare l'oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> a cui si accede mediante la proprietà <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> di un oggetto <xref:Microsoft.SqlServer.Replication.PublisherMonitor> esistente.</span><span class="sxs-lookup"><span data-stu-id="fceda-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="fceda-232">Eseguire uno o più metodi riportati di seguito per ottenere informazioni su questa pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene record di errori relativi all'errore specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="fceda-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sull'agente di lettura log della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sui valore soglia degli avvisi di monitoraggio impostati per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sull'agente di lettura coda utilizzato dalla pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sull'agente snapshot della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sulle sottoscrizioni della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="fceda-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - restituisce un oggetto <xref:System.Data.DataSet> che contiene ulteriori informazioni sulle sottoscrizioni della pubblicazione in base all'oggetto <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="fceda-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni sulla latenza per il token di traccia specificato.</span><span class="sxs-lookup"><span data-stu-id="fceda-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="fceda-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> : restituisce un oggetto <xref:System.Data.DataSet> che contiene informazioni su tutti i token di traccia inseriti nella pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="fceda-242">Per monitorare i comandi transazionali in attesa di essere applicati al Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="fceda-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="fceda-243">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-244">Recuperare un oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitor> mediante uno dei modi indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="fceda-245">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="fceda-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="fceda-246">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>e <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> per la pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="fceda-247">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="fceda-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="fceda-248">Se questo metodo restituisce `false`, le proprietà della pubblicazione sono definite in modo non corretto o la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="fceda-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="fceda-249">Utilizzare l'oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> a cui si accede mediante la proprietà <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> di un oggetto <xref:Microsoft.SqlServer.Replication.PublisherMonitor> esistente.</span><span class="sxs-lookup"><span data-stu-id="fceda-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="fceda-250">Eseguire il metodo <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> che restituisce un oggetto <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> .</span><span class="sxs-lookup"><span data-stu-id="fceda-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="fceda-251">Utilizzare le proprietà dell'oggetto <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> per determinare il numero stimato di comandi in sospeso e il tempo necessario per completare il recapito di tali comandi.</span><span class="sxs-lookup"><span data-stu-id="fceda-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="fceda-252">Per impostare i valore soglia degli avvisi di monitoraggio per una pubblicazione</span><span class="sxs-lookup"><span data-stu-id="fceda-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="fceda-253">Creare una connessione al server di distribuzione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="fceda-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="fceda-254">Recuperare un oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitor> mediante uno dei modi indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="fceda-255">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="fceda-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="fceda-256">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>e <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> per la pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="fceda-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="fceda-257">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="fceda-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="fceda-258">Se questo metodo restituisce `false`, le proprietà della pubblicazione sono definite in modo non corretto o la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="fceda-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="fceda-259">Utilizzare l'oggetto <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> a cui si accede mediante la proprietà <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> di un oggetto <xref:Microsoft.SqlServer.Replication.PublisherMonitor> esistente.</span><span class="sxs-lookup"><span data-stu-id="fceda-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="fceda-260">Eseguire il metodo <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> .</span><span class="sxs-lookup"><span data-stu-id="fceda-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="fceda-261">Tenere presenti le impostazioni dei valore soglia correnti nell'oggetto <xref:System.Collections.ArrayList> restituito degli oggetti <xref:Microsoft.SqlServer.Replication.MonitorThreshold> .</span><span class="sxs-lookup"><span data-stu-id="fceda-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="fceda-262">Eseguire il metodo <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> .</span><span class="sxs-lookup"><span data-stu-id="fceda-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="fceda-263">Passare i parametri indicati di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="fceda-264">*metricID* : un valore <xref:System.Int32> che rappresenta la misurazione del valore soglia di monitoraggio nella tabella riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="fceda-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="fceda-265">valore</span><span class="sxs-lookup"><span data-stu-id="fceda-265">Value</span></span>|<span data-ttu-id="fceda-266">Descrizione</span><span class="sxs-lookup"><span data-stu-id="fceda-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="fceda-267">1</span><span class="sxs-lookup"><span data-stu-id="fceda-267">1</span></span>|<span data-ttu-id="fceda-268">`expiration`: esegue il monitoraggio delle scadenze imminenti delle sottoscrizioni di pubblicazioni transazionali.</span><span class="sxs-lookup"><span data-stu-id="fceda-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="fceda-269">2</span><span class="sxs-lookup"><span data-stu-id="fceda-269">2</span></span>|<span data-ttu-id="fceda-270">`latency`: esegue il monitoraggio delle prestazioni delle sottoscrizioni di pubblicazioni transazionali.</span><span class="sxs-lookup"><span data-stu-id="fceda-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="fceda-271">4</span><span class="sxs-lookup"><span data-stu-id="fceda-271">4</span></span>|<span data-ttu-id="fceda-272">`mergeexpiration`: esegue il monitoraggio delle scadenze imminenti delle sottoscrizioni di pubblicazioni di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="fceda-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="fceda-273">5</span><span class="sxs-lookup"><span data-stu-id="fceda-273">5</span></span>|<span data-ttu-id="fceda-274">`mergeslowrunduration`: esegue il monitoraggio della durata delle sincronizzazioni di tipo merge attraverso connessioni remote a larghezza di banda ridotta.</span><span class="sxs-lookup"><span data-stu-id="fceda-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="fceda-275">6</span><span class="sxs-lookup"><span data-stu-id="fceda-275">6</span></span>|<span data-ttu-id="fceda-276">`mergefastrunduration`: esegue il monitoraggio della durata delle sincronizzazioni di tipo merge attraverso connessioni LAN ad alta larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="fceda-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="fceda-277">7</span><span class="sxs-lookup"><span data-stu-id="fceda-277">7</span></span>|<span data-ttu-id="fceda-278">`mergefastrunspeed` - esegue il monitoraggio della frequenza delle sincronizzazioni di tipo merge su connessioni tramite rete locale (LAN) a larghezza di banda elevata.</span><span class="sxs-lookup"><span data-stu-id="fceda-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="fceda-279">8</span><span class="sxs-lookup"><span data-stu-id="fceda-279">8</span></span>|<span data-ttu-id="fceda-280">`mergeslowrunspeed`: esegue il monitoraggio della velocità delle sincronizzazioni di tipo merge attraverso connessioni remote a larghezza di banda ridotta.</span><span class="sxs-lookup"><span data-stu-id="fceda-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="fceda-281">*enable* - <xref:System.Boolean> che indica se la misurazione è attivata per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="fceda-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="fceda-282">*thresholdValue* : valore integer che imposta il valore soglia.</span><span class="sxs-lookup"><span data-stu-id="fceda-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="fceda-283">*shouldAlert* - Integer che indica se il valore soglia deve generare un avviso.</span><span class="sxs-lookup"><span data-stu-id="fceda-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
