---
title: Proteggere la cartella snapshot | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], security
ms.assetid: 3cd877d1-ffb8-48fd-a72b-98eb948aad27
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c977936ad2aca6e5a98ee685a15662a00b625494
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87635481"
---
# <a name="secure-the-snapshot-folder"></a><span data-ttu-id="a38ab-102">Sicurezza della cartella snapshot</span><span class="sxs-lookup"><span data-stu-id="a38ab-102">Secure the Snapshot Folder</span></span>
  <span data-ttu-id="a38ab-103">La cartella snapshot è una directory in cui vengono archiviati i file di snapshot. È consigliabile dedicare questa directory esclusivamente all'archiviazione degli snapshot.</span><span class="sxs-lookup"><span data-stu-id="a38ab-103">The snapshot folder is a directory that stores snapshot files; it is recommended that you dedicate the directory for snapshot storage.</span></span> <span data-ttu-id="a38ab-104">Concedere all'agente snapshot l'autorizzazione di scrittura per la cartella e verificare che l'autorizzazione di lettura sia concessa solo all'account di Windows utilizzato dall'agente di merge o dall'agente di distribuzione per accedere alla cartella.</span><span class="sxs-lookup"><span data-stu-id="a38ab-104">Grant the Snapshot Agent write permission to the folder, and ensure that read permission is granted only to the Windows account that the Merge Agent or Distribution agent uses when accessing the folder.</span></span> <span data-ttu-id="a38ab-105">L'account di Windows associato all'agente deve essere un account di dominio per poter accedere a una cartella snapshot posizionata in un computer remoto.</span><span class="sxs-lookup"><span data-stu-id="a38ab-105">The Windows account associated with the agent must be a domain account to access a snapshot folder that is located on a remote computer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a38ab-106">Controllo account utente consente agli amministratori di gestire i propri diritti utente elevati (detti anche *privilegi*).</span><span class="sxs-lookup"><span data-stu-id="a38ab-106">User Account Control (UAC)  helps administrators manage their elevated user rights (sometimes called *privileges*).</span></span> <span data-ttu-id="a38ab-107">Quando l'esecuzione avviene in sistemi operativi con Controllo account utente abilitato, gli amministratori non utilizzano i propri diritti amministrativi,</span><span class="sxs-lookup"><span data-stu-id="a38ab-107">When running on operating systems that have UAC enabled, administrators do not use their administrative rights.</span></span> <span data-ttu-id="a38ab-108">ma eseguono la maggior parte delle azioni come utenti standard (non amministrativi), assumendo temporaneamente i diritti di amministratore solo se necessario.</span><span class="sxs-lookup"><span data-stu-id="a38ab-108">Instead, they perform most actions as standard (non-administrative) users, temporarily assuming their administrative rights only when it is required.</span></span> <span data-ttu-id="a38ab-109">Controllo account utente può impedire l'accesso amministrativo alla condivisione snapshot.</span><span class="sxs-lookup"><span data-stu-id="a38ab-109">UAC can prevent administrative access to the snapshot share.</span></span> <span data-ttu-id="a38ab-110">Le autorizzazioni per la condivisione snapshot devono pertanto essere concesse in modo esplicito agli account di Windows utilizzati dall'agente snapshot, dall'agente di distribuzione e dall'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="a38ab-110">You must therefore explicitly grant snapshot share permissions to the Windows accounts that are used by the Snapshot Agent, Distribution Agent, and Merge Agent.</span></span> <span data-ttu-id="a38ab-111">È necessario eseguire questa operazione anche se gli account di Windows sono membri del gruppo Administrators.</span><span class="sxs-lookup"><span data-stu-id="a38ab-111">You must do this even if the Windows accounts are members of the Administrators group.</span></span>  
  
 <span data-ttu-id="a38ab-112">Se si configura un server di distribuzione tramite Configurazione guidata distribuzione o Creazione guidata pubblicazione, la cartella snapshot viene configurata per impostazione predefinita su un percorso locale: X:\Programmi\Microsoft SQL Server\\ *\<instance>* \MSSQL\ReplData.</span><span class="sxs-lookup"><span data-stu-id="a38ab-112">When configuring a Distributor through the Configure Distribution Wizard or the New Publication Wizard, the snapshot folder defaults to a local path: X:\Program Files\Microsoft SQL Server\\*\<instance>* \MSSQL\ReplData.</span></span> <span data-ttu-id="a38ab-113">Se si usano un server di distribuzione remoto o sottoscrizioni pull, è necessario specificare una condivisione di rete UNC (ad esempio \\\\<*nomecomputer>* \snapshot) anziché un percorso locale.</span><span class="sxs-lookup"><span data-stu-id="a38ab-113">If you are using a remote Distributor or pull subscriptions, you must specify a UNC network share (such as \\\\<*computername>* \snapshot) rather than a local path.</span></span>  
  
 <span data-ttu-id="a38ab-114">Quando si concedono le autorizzazioni di accesso alla cartella snapshot, è necessario valutare il tipo di accesso che verrà utilizzato per la cartella.</span><span class="sxs-lookup"><span data-stu-id="a38ab-114">When granting permissions to access the snapshot folder, you must grant them according to the way in which the folder is accessed.</span></span> <span data-ttu-id="a38ab-115">In [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003 vengono utilizzate le schede di finestre di dialogo seguenti:</span><span class="sxs-lookup"><span data-stu-id="a38ab-115">The following dialog box tabs are used in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 2003:</span></span>  
  
-   <span data-ttu-id="a38ab-116">Se si specifica un percorso locale, concedere le autorizzazioni mediante la scheda **Sicurezza** della finestra di dialogo **Proprietà** per la cartella.</span><span class="sxs-lookup"><span data-stu-id="a38ab-116">If you specify a local path, grant permissions through the **Security** tab of the **Properties** dialog box for the folder.</span></span>  
  
-   <span data-ttu-id="a38ab-117">Se si specifica una condivisione di rete, concedere le autorizzazioni mediante la scheda **Condivisione** della finestra di dialogo **Proprietà** per la cartella.</span><span class="sxs-lookup"><span data-stu-id="a38ab-117">If you specify a network share, grant permissions through the **Sharing** tab of the **Properties** dialog box for the folder.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a38ab-118">Se l'agente di replica viene eseguito nel server di distribuzione, utilizzare la scheda **Sicurezza** della finestra di dialogo **Proprietà** della cartella per concedere autorizzazioni all'account di Windows utilizzato per l'esecuzione dell'agente.</span><span class="sxs-lookup"><span data-stu-id="a38ab-118">If the replication agent runs on the Distributor, use the **Security** tab of the **Properties** dialog box for the folder to grant permissions to the Windows account used to run the agent.</span></span> <span data-ttu-id="a38ab-119">Eseguire questa operazione anche in caso di utilizzo di una condivisione di rete.</span><span class="sxs-lookup"><span data-stu-id="a38ab-119">Do this even when a network share is used.</span></span> <span data-ttu-id="a38ab-120">Ciò è applicabile all'agente di merge e all'agente di distribuzione per una sottoscrizione push e all'agente snapshot quando il server di pubblicazione e il server di distribuzione risiedono nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="a38ab-120">This applies to the Merge Agent and Distribution Agent for a push subscription and to the Snapshot Agent when the Publisher and Distributor are on the same computer.</span></span>  
  
 <span data-ttu-id="a38ab-121">Per ulteriori informazioni sull'impostazione di autorizzazioni per i percorsi locali e le condivisioni di rete, vedere la documentazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="a38ab-121">For more information about setting permissions for local paths and network shares, see the Windows documentation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a38ab-122">Se una pubblicazione viene rimossa, la replica tenta di rimuovere la cartella snapshot nel contesto di sicurezza dell'account del servizio [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a38ab-122">If a publication is dropped, replication attempts to remove the snapshot folder under the security context of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="a38ab-123">Se questo account non dispone di privilegi sufficienti, accedere con un account che dispone di privilegi adeguati e rimuovere manualmente la cartella.</span><span class="sxs-lookup"><span data-stu-id="a38ab-123">If this account does not have sufficient privileges, log in with an account that does have sufficient privileges and remove the folder manually.</span></span> <span data-ttu-id="a38ab-124">Per rimuovere una cartella, è necessario il privilegio **Modifica** se la cartella si trova in un percorso locale oppure il privilegio **Controllo completo** se la cartella è una condivisione di rete.</span><span class="sxs-lookup"><span data-stu-id="a38ab-124">Removing a folder requires the **Modify** privilege if the folder is a local path or the **Full Control** privilege if the folder is a network path.</span></span>  
  
## <a name="delivering-snapshots-through-ftp"></a><span data-ttu-id="a38ab-125">Recapito di snapshot tramite FTP</span><span class="sxs-lookup"><span data-stu-id="a38ab-125">Delivering Snapshots Through FTP</span></span>  
 <span data-ttu-id="a38ab-126">Sebbene sia consigliabile dal punto di vista della sicurezza archiviare gli snapshot in una condivisione UNC, gli snapshot possono essere archiviati in una condivisione FTP e quindi recapitati a un Sottoscrittore tramite FTP.</span><span class="sxs-lookup"><span data-stu-id="a38ab-126">It is recommended as a security best practice that snapshots be stored in a UNC share, but snapshots can be stored in an FTP share and then delivered to a Subscriber through FTP.</span></span> <span data-ttu-id="a38ab-127">Quando si configura il server FTP, verificare che la directory virtuale esponga una condivisione UNC sottostante che consente l'accesso in scrittura all'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="a38ab-127">When configuring the FTP server, ensure that the virtual directory exposes an underlying UNC share that permits write access by the Snapshot Agent for the publication.</span></span>  
  
 <span data-ttu-id="a38ab-128">Per configurare un Sottoscrittore in modo che recuperi lo snapshot tramite FTP, impostare innanzitutto un server FTP con un account di accesso e password per l'FTP che consenta ai Sottoscrittori l'accesso in lettura per poter scaricare i file di snapshot.</span><span class="sxs-lookup"><span data-stu-id="a38ab-128">To configure a Subscriber to retrieve the Snapshot via FTP, first set up an FTP server with an FTP login and password that allows Subscribers read (or "get") access to allow the snapshot files to be downloaded.</span></span>  
  
 <span data-ttu-id="a38ab-129">Per recapitare uno snapshot tramite FTP, vedere [Recapitare uno snapshot tramite FTP](../publish/deliver-a-snapshot-through-ftp.md).</span><span class="sxs-lookup"><span data-stu-id="a38ab-129">To deliver snapshots through FTP, see [Deliver a Snapshot Through FTP](../publish/deliver-a-snapshot-through-ftp.md).</span></span>  
  
 <span data-ttu-id="a38ab-130">Per informazioni sull'impostazione e la modifica delle password per l'accesso agli snapshot tramite FTP, vedere la sezione relativa al recapito degli snapshot tramite FTP in [Secure the Publisher](secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="a38ab-130">For information about setting and changing the password for access to snapshots through FTP, see the section "FTP Snapshot Delivery" in the topic [Secure the Publisher](secure-the-publisher.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a38ab-131">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="a38ab-131">See Also</span></span>  
 <span data-ttu-id="a38ab-132">[Percorsi alternativi cartella snapshot](../alternate-snapshot-folder-locations.md) </span><span class="sxs-lookup"><span data-stu-id="a38ab-132">[Alternate Snapshot Folder Locations](../alternate-snapshot-folder-locations.md) </span></span>  
 <span data-ttu-id="a38ab-133">[Inizializzare una sottoscrizione con uno snapshot](../initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="a38ab-133">[Initialize a Subscription with a Snapshot](../initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="a38ab-134">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="a38ab-134">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="a38ab-135">[Sicurezza replica di SQL Server](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="a38ab-135">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="a38ab-136">Trasferire snapshot tramite FTP</span><span class="sxs-lookup"><span data-stu-id="a38ab-136">Transfer Snapshots Through FTP</span></span>](../transfer-snapshots-through-ftp.md)  
  
  
