---
title: Configurare IIS per la sincronizzazione Web | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- IIS server configuration [SQL Server replication]
- websync.log
- Web synchronization, IIS servers
ms.assetid: d651186e-c9ca-4864-a444-2cd6943b8e35
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 523c4fc30151acd3ee4df21f2fdaa2187e702870
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626651"
---
# <a name="configure-iis-for-web-synchronization"></a><span data-ttu-id="59bc3-102">Configurazione di IIS per la sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="59bc3-102">Configure IIS for Web Synchronization</span></span>
  <span data-ttu-id="59bc3-103">Le procedure descritte in questo argomento rappresentano il secondo passaggio nella configurazione della sincronizzazione Web per la replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="59bc3-103">The procedures in this topic make up the second step in configuring Web synchronization for merge replication.</span></span> <span data-ttu-id="59bc3-104">Questo passaggio è successivo all'abilitazione di una pubblicazione per la sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-104">You perform this step after you enable a publication for Web synchronization.</span></span> <span data-ttu-id="59bc3-105">Per una panoramica del processo di configurazione, vedere [Configura sincronizzazione Web](configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="59bc3-105">For an overview of the configuration process, see [Configure Web Synchronization](configure-web-synchronization.md).</span></span> <span data-ttu-id="59bc3-106">Al termine delle procedure indicate in questo argomento, procedere al terzo passaggio, che consiste nella configurazione di una sottoscrizione per l'utilizzo della sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-106">After you complete the procedures in this topic, continue to the third step, configuring a subscription to use Web synchronization.</span></span> <span data-ttu-id="59bc3-107">Questo terzo passaggio è descritto negli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="59bc3-107">This third step is described in the following topics:</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]<span data-ttu-id="59bc3-108">: [Procedura: Configurazione di una sottoscrizione per l'utilizzo della sincronizzazione tramite il Web \(SQL Server Management Studio\)](https://msdn.microsoft.com/library/ms345214.aspx)</span><span class="sxs-lookup"><span data-stu-id="59bc3-108">: [How to: Configure a Subscription to Use Web Synchronization \(SQL Server Management Studio\)](https://msdn.microsoft.com/library/ms345214.aspx)</span></span>  
  
-   <span data-ttu-id="59bc3-109">Programmazione [!INCLUDE[tsql](../../includes/tsql-md.md)] della replica: [Procedura: Configurazione di una sottoscrizione per l'utilizzo della sincronizzazione Web (Programmazione Transact-SQL della replica)](https://msdn.microsoft.com/library/ms345206.aspx)</span><span class="sxs-lookup"><span data-stu-id="59bc3-109">Replication [!INCLUDE[tsql](../../includes/tsql-md.md)] programming: [How to: Configure a Subscription to Use Web Synchronization (Replication Transact-SQL Programming)](https://msdn.microsoft.com/library/ms345206.aspx)</span></span>  
  
-   <span data-ttu-id="59bc3-110">RMO: [Procedura: Configurazione di una sottoscrizione per l'utilizzo di una sottoscrizione Web (Programmazione RMO)](https://msdn.microsoft.com/library/ms345207.aspx)</span><span class="sxs-lookup"><span data-stu-id="59bc3-110">RMO: [How to: Configure a Subscription to Use Web Synchronization (RMO Programming)](https://msdn.microsoft.com/library/ms345207.aspx)</span></span>  
  
 <span data-ttu-id="59bc3-111">Nella sincronizzazione Web viene utilizzato un computer che esegue [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Information Services (IIS) per sincronizzare le sottoscrizioni pull con le pubblicazioni di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="59bc3-111">Web synchronization uses a computer that is running [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Information Services (IIS) to synchronize pull subscriptions to merge publications.</span></span> <span data-ttu-id="59bc3-112">Sono supportate le versioni 5.0, 6.0 e 7.0 di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-112">IIS version 5.0, IIS version 6.0, and IIS version 7.0 are supported.</span></span> <span data-ttu-id="59bc3-113">La Configurazione guidata sincronizzazione Web non è supportata in IIS versione 7.0.</span><span class="sxs-lookup"><span data-stu-id="59bc3-113">The Configure Web Synchronization Wizard is not supported on IIS version 7.0.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="59bc3-114">Verificare che nell'applicazione venga utilizzato solo [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] o versione successiva e che le versioni precedenti di [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] non siano installate sul server IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-114">Make sure that your application uses only [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] or later versions, and that earlier versions of the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] are not installed on the IIS server.</span></span> <span data-ttu-id="59bc3-115">Le versioni precedenti di [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] possono causare errori</span><span class="sxs-lookup"><span data-stu-id="59bc3-115">Earlier versions of the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] can cause errors.</span></span> <span data-ttu-id="59bc3-116">come, ad esempio, "Formato di messaggio non valido durante la sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-116">These include the following: "The format of a message during Web synchronization was invalid.</span></span> <span data-ttu-id="59bc3-117">Verificare che i componenti di replica siano configurati correttamente nel server Web".</span><span class="sxs-lookup"><span data-stu-id="59bc3-117">Ensure that replication components are properly configured at the Web server".</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="59bc3-118">Non utilizzare contemporaneamente sia WebSync sia percorsi alternativi della cartella snapshot.</span><span class="sxs-lookup"><span data-stu-id="59bc3-118">Do not use both WebSync and alternate snapshot folder locations at the same time.</span></span>  
  
 <span data-ttu-id="59bc3-119">Per utilizzare la sincronizzazione Web, è necessario configurare IIS eseguendo la procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="59bc3-119">To use Web synchronization, you must configure IIS by completing the following steps.</span></span> <span data-ttu-id="59bc3-120">Ogni passaggio è descritto in dettaglio in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="59bc3-120">Each step is described in detail in this topic.</span></span>  
  
1.  <span data-ttu-id="59bc3-121">Configurare SSL (Secure Sockets Layer).</span><span class="sxs-lookup"><span data-stu-id="59bc3-121">Configure Secure Sockets Layer (SSL).</span></span> <span data-ttu-id="59bc3-122">L'utilizzo di SSL è obbligatorio per la comunicazione tra IIS e tutti i Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="59bc3-122">SSL is required for communication between IIS and all Subscribers.</span></span>  
  
2.  <span data-ttu-id="59bc3-123">Installare [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] i componenti di connettività nel computer che esegue IIS utilizzando l' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installazione guidata di.</span><span class="sxs-lookup"><span data-stu-id="59bc3-123">Install [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connectivity components on the computer that is running IIS by using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Installation Wizard.</span></span> <span data-ttu-id="59bc3-124">Se si intende utilizzare la procedura di configurazione guidata della sincronizzazione Web citata nel passaggio 3, è necessario installare anche [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] nel computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-124">If you plan to use the Configure Web Synchronization Wizard that is mentioned in step 3, you must also install [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] on the computer that is running IIS.</span></span>  
  
3.  <span data-ttu-id="59bc3-125">Configurare il computer che esegue IIS per la sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-125">Configure the computer that is running IIS for Web synchronization.</span></span> <span data-ttu-id="59bc3-126">È possibile configurare manualmente il computer oppure utilizzare la procedura di configurazione guidata della sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-126">You can configure the computer manually or use the Configure Web Synchronization Wizard.</span></span> <span data-ttu-id="59bc3-127">È consigliabile utilizzare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="59bc3-127">We recommend that you use the wizard.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="59bc3-128">Se nel computer con IIS viene eseguita una versione a 64 bit di Windows, è necessario eseguire il comando seguente per garantire la corretta configurazione del server per le applicazioni ISAPI.</span><span class="sxs-lookup"><span data-stu-id="59bc3-128">If the computer that is running IIS is running on a 64-bit version of Windows, you must run following command to make sure that the server is properly configured to run Internet Server API (ISAPI) applications.</span></span> <span data-ttu-id="59bc3-129">Per ulteriori informazioni, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-129">For more information, see the IIS documentation.</span></span>  
  
    ```  
    cscript %SystemDrive%\inetpub\AdminScripts\adsutil.vbs set w3svc/AppPools/Enable32bitAppOnWin64 1  
    ```  
  
4.  <span data-ttu-id="59bc3-130">Impostare le autorizzazioni appropriate per Listener per la replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-130">Set the appropriate permissions for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener.</span></span>  
  
5.  <span data-ttu-id="59bc3-131">Eseguire la sincronizzazione Web in modalità diagnostica per testare la connessione al computer che esegue IIS e verificare la corretta installazione del certificato SSL (Secure Sockets Layer).</span><span class="sxs-lookup"><span data-stu-id="59bc3-131">Run Web synchronization in diagnostic mode to test the connection to the computer that is running IIS and to make sure that the SSL certificate is properly installed.</span></span>  
  
## <a name="configuring-secure-sockets-layer"></a><span data-ttu-id="59bc3-132">Configurazione di SSL (Secure Sockets Layer)</span><span class="sxs-lookup"><span data-stu-id="59bc3-132">Configuring Secure Sockets Layer</span></span>  
 <span data-ttu-id="59bc3-133">Per configurare SSL, specificare un certificato che il computer che esegue IIS deve utilizzare.</span><span class="sxs-lookup"><span data-stu-id="59bc3-133">To configure SSL, specify a certificate for the computer that is running IIS to use.</span></span> <span data-ttu-id="59bc3-134">La sincronizzazione Web per la replica di tipo merge supporta l'utilizzo di certificati server ma non di certificati client.</span><span class="sxs-lookup"><span data-stu-id="59bc3-134">Web synchronization for merge replication supports using server certificates but not client certificates.</span></span> <span data-ttu-id="59bc3-135">Per configurare IIS per la distribuzione, è innanzitutto necessario ottenere un certificato da un'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-135">To configure IIS for deployment, you must first obtain a certificate from a certification authority (CA).</span></span> <span data-ttu-id="59bc3-136">Un'autorità di certificazione è un'entità responsabile di determinare e garantire l'autenticità delle chiavi di crittografia pubbliche appartenenti a utenti, computer o altre autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-136">A certificate authority is an entity that is responsible for establishing and vouching for the authenticity of public encryption keys that belong to users, computers, or other certification authorities.</span></span> <span data-ttu-id="59bc3-137">Per ulteriori informazioni sui certificati, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-137">For more information about certificates, see the IIS documentation.</span></span> <span data-ttu-id="59bc3-138">Dopo l'installazione del certificato, è necessario associare il certificato al sito Web utilizzato nella sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-138">After you install the certificate, you must associate the certificate with the Web site that is used by Web synchronization.</span></span>  
  
#### <a name="to-specify-a-certificate-for-deployment"></a><span data-ttu-id="59bc3-139">Per specificare un certificato per la distribuzione</span><span class="sxs-lookup"><span data-stu-id="59bc3-139">To specify a certificate for deployment</span></span>  
  
1.  <span data-ttu-id="59bc3-140">Accedere come amministratore al computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-140">Log on to the computer that is running IIS as an administrator.</span></span>  
  
2.  <span data-ttu-id="59bc3-141">Avviare **Gestione Internet Information Services (IIS)**:</span><span class="sxs-lookup"><span data-stu-id="59bc3-141">Start **Internet Information Services (IIS) Manager**:</span></span>  
  
    1.  <span data-ttu-id="59bc3-142">Fare clic sul pulsante **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-142">Click **Start**, and then click **Run**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-143">Nella casella **Apri** Digitare `inetmgr` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-143">In the **Open** box, type `inetmgr`, and then click **OK**.</span></span>  
  
3.  <span data-ttu-id="59bc3-144">Eseguire la Gestione guidata certificati IIS:</span><span class="sxs-lookup"><span data-stu-id="59bc3-144">Run the IIS Certificate Wizard:</span></span>  
  
    1.  <span data-ttu-id="59bc3-145">In **Gestione Internet Information Services (IIS)** espandere il nodo **computer locale** e quindi la cartella **Siti Web** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-145">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand the **Web Sites** folder.</span></span>  
  
    2.  <span data-ttu-id="59bc3-146">Fare clic con il pulsante destro del mouse su **Sito Web predefinito**e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-146">Right-click **Default Web Site**, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-147">Nella scheda **Sicurezza directory** della finestra di dialogo **Proprietà - Sito Web predefinito** fare clic su **Certificato server**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-147">In the **Default Web Site Properties** dialog box, on the **Directory Security** tab, click **Server Certificate**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-148">Completare la Gestione guidata certificati server Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-148">Complete the Web Server Certificate Wizard.</span></span>  
  
4.  <span data-ttu-id="59bc3-149">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-149">Click **OK**.</span></span>  
  
 <span data-ttu-id="59bc3-150">Se non è possibile ottenere un certificato server da un'autorità di certificazione, è possibile specificare un certificato per l'esecuzione di test.</span><span class="sxs-lookup"><span data-stu-id="59bc3-150">If you cannot obtain a server certificate from a CA, you can specify a certificate for testing.</span></span> <span data-ttu-id="59bc3-151">Per configurare IIS 6.0 per l'esecuzione di test, installare un certificato mediante l'utilità SelfSSL</span><span class="sxs-lookup"><span data-stu-id="59bc3-151">To configure IIS 6.0 for testing, install a certificate by using the SelfSSL utility.</span></span> <span data-ttu-id="59bc3-152">disponibile nel Resource Kit di IIS 6.0.</span><span class="sxs-lookup"><span data-stu-id="59bc3-152">This utility is available in the IIS 6.0 Resource Kit.</span></span> <span data-ttu-id="59bc3-153">È possibile scaricare gli strumenti dall' [Area download Microsoft](https://www.microsoft.com/download/details.aspx?id=5135).</span><span class="sxs-lookup"><span data-stu-id="59bc3-153">You can download the tools from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=5135).</span></span> <span data-ttu-id="59bc3-154">Per IIS 5.0, visitare il sito [Supporto Tecnico Microsoft](https://go.microsoft.com/fwlink/?LinkId=46229).</span><span class="sxs-lookup"><span data-stu-id="59bc3-154">For IIS 5.0, go to [Microsoft Help and Support](https://go.microsoft.com/fwlink/?LinkId=46229).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="59bc3-155">Affinché un sito Web possa utilizzare SSL, è necessario che a tale sito sia associato un certificato.</span><span class="sxs-lookup"><span data-stu-id="59bc3-155">A certificate must be associated with a Web site before that Web site can use SSL.</span></span> <span data-ttu-id="59bc3-156">SelfSSL associa automaticamente il certificato al sito Web predefinito.</span><span class="sxs-lookup"><span data-stu-id="59bc3-156">SelfSSL automatically associates the certificate with the default Web site.</span></span> <span data-ttu-id="59bc3-157">Se si dispone già di un certificato oppure si installa successivamente un certificato di un'autorità di certificazione, è necessario associare tale certificato in modo esplicito al sito Web utilizzato nella sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-157">If you already have a certificate or later install a certificate from a CA, you must explicitly associate that certificate with the Web site that is used by Web synchronization.</span></span> <span data-ttu-id="59bc3-158">Assicurarsi che al sito Web utilizzato per la sincronizzazione delle sottoscrizioni sia associato un solo certificato.</span><span class="sxs-lookup"><span data-stu-id="59bc3-158">Make sure there is only one certificate associated with the Web site that is used to synchronize subscriptions.</span></span> <span data-ttu-id="59bc3-159">Se sono associati più certificati, il Sottoscrittore utilizzerà il primo sito Web disponibile.</span><span class="sxs-lookup"><span data-stu-id="59bc3-159">If there are multiple certificates, the Subscriber will use the first available Web site.</span></span>  
  
#### <a name="to-specify-a-certificate-for-testing-in-iis-60"></a><span data-ttu-id="59bc3-160">Per specificare un certificato per l'esecuzione di test in IIS 6.0</span><span class="sxs-lookup"><span data-stu-id="59bc3-160">To specify a certificate for testing in IIS 6.0</span></span>  
  
1.  <span data-ttu-id="59bc3-161">Accedere come amministratore al computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-161">Log on to the computer that is running IIS as an administrator.</span></span>  
  
2.  <span data-ttu-id="59bc3-162">Scaricare e installare SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="59bc3-162">Download and install SelfSSL.</span></span> <span data-ttu-id="59bc3-163">Per impostazione predefinita, l'applicazione viene installata in \<*drive*> : \Program \Programmi\iis Resources\SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="59bc3-163">By default, the application is installed to \<*drive*>:\Program Files\IIS Resources\SelfSSL.</span></span> <span data-ttu-id="59bc3-164">I collegamenti all'applicazione e alla documentazione vengono copiati in \<*drive*> : \Documents and Settings\All Users\Menu Start\programmi\iis Resources\SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="59bc3-164">Application and documentation shortcuts are copied to \<*drive*>:\Documents and Settings\All Users\Start Menu\Programs\IIS Resources\SelfSSL.</span></span>  
  
3.  <span data-ttu-id="59bc3-165">Eseguire SelfSSL:</span><span class="sxs-lookup"><span data-stu-id="59bc3-165">Run SelfSSL:</span></span>  
  
    -   <span data-ttu-id="59bc3-166">Per eseguire SelfSSL con i valori predefiniti per tutti i parametri, individuare la directory di installazione dell'applicazione e fare doppio clic su SelfSSL.exe.</span><span class="sxs-lookup"><span data-stu-id="59bc3-166">To run SelfSSL with default values for all parameters, locate the installation directory for the application, and then double-click SelfSSL.exe.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="59bc3-167">Per impostazione predefinita, il certificato installato da SelfSSL ha una validità di sette giorni.</span><span class="sxs-lookup"><span data-stu-id="59bc3-167">By default, the certificate that is installed by SelfSSL is valid for seven days.</span></span>  
  
    -   <span data-ttu-id="59bc3-168">Per specificare valori per uno o più parametri, fare clic sul menu **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-168">To specify values for one or more parameters: click **Start**, and then click **Run**.</span></span> <span data-ttu-id="59bc3-169">Nella casella **Apri** immettere `cmd` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-169">In the **Open** box, enter `cmd`, and then click **OK**.</span></span> <span data-ttu-id="59bc3-170">Individuare la directory di installazione di SelfSSL, digitare `SelfSSL`e quindi specificare i valori per uno o più parametri.</span><span class="sxs-lookup"><span data-stu-id="59bc3-170">Locate the SelfSSL installation directory, type `SelfSSL`, and then specify values for one or more parameters.</span></span> <span data-ttu-id="59bc3-171">Per un elenco di parametri, digitare `SelfSSL -?`.</span><span class="sxs-lookup"><span data-stu-id="59bc3-171">For a list of parameters, type `SelfSSL -?`.</span></span>  
  
## <a name="installing-connectivity-components-and-sql-server-management-studio"></a><span data-ttu-id="59bc3-172">Installazione di componenti di connettività e SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="59bc3-172">Installing Connectivity Components and SQL Server Management Studio</span></span>  
  
#### <a name="to-install-sql-server-connectivity-components-and-sql-server-management-studio"></a><span data-ttu-id="59bc3-173">Per installare i componenti di connettività di SQL Server e SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="59bc3-173">To install SQL Server connectivity components and SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="59bc3-174">Accedere come amministratore al computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-174">Log on as an administrator to the computer that is running IIS.</span></span>  
  
2.  <span data-ttu-id="59bc3-175">Dal disco di installazione di [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] avviare l'Installazione guidata di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-175">From the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] installation disk, start the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Installation Wizard.</span></span> <span data-ttu-id="59bc3-176">Per ulteriori informazioni sull'utilizzo di questa procedura guidata, vedere [installare SQL Server 2014 dall'installazione guidata &#40;&#41;di ](../../database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup.md)installazione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-176">For more information about using this wizard, see [Install SQL Server 2014 from the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup.md).</span></span>  
  
3.  <span data-ttu-id="59bc3-177">Nella pagina **Selezione funzionalità** selezionare **Connettività strumenti client**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-177">On the **Feature Selection** page, select **Client Tools Connectivity**.</span></span>  
  
4.  <span data-ttu-id="59bc3-178">Se si intende utilizzare la Configurazione guidata sincronizzazione Web, selezionare **Strumenti di gestione - Di base**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-178">If you plan to use the Configure Web Synchronization Wizard, select **Management Tools - Basic**.</span></span>  
  
5.  <span data-ttu-id="59bc3-179">Completare la procedura guidata e quindi riavviare il computer.</span><span class="sxs-lookup"><span data-stu-id="59bc3-179">Complete the wizard, and then restart the computer.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="59bc3-180">È possibile installare componenti aggiuntivi, ma per la sincronizzazione Web sono necessari soltanto i componenti di connettività.</span><span class="sxs-lookup"><span data-stu-id="59bc3-180">You can install additional components, but only the connectivity components are required for Web synchronization.</span></span>  
  
## <a name="configuring-the-computer-that-is-running-iis-by-using-the-configure-web-synchronization-wizard"></a><span data-ttu-id="59bc3-181">Configurazione del computer che esegue IIS utilizzando la procedura di configurazione guidata della sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="59bc3-181">Configuring the Computer That Is Running IIS by Using the Configure Web Synchronization Wizard</span></span>  
 <span data-ttu-id="59bc3-182">Configurare il server IIS mediante la procedura di configurazione guidata della sincronizzazione Web o manualmente.</span><span class="sxs-lookup"><span data-stu-id="59bc3-182">Configure the IIS server by using the Configure Web Synchronization Wizard or manually.</span></span> <span data-ttu-id="59bc3-183">Sebbene sia consigliabile utilizzare la procedura guidata, nella prossima sezione verranno illustrati i passaggi necessari per la configurazione manuale.</span><span class="sxs-lookup"><span data-stu-id="59bc3-183">We recommend using the wizard, but we also provide steps for manual configuration in the next section.</span></span> <span data-ttu-id="59bc3-184">La Configurazione guidata sincronizzazione Web, disponibile in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , può essere utilizzata solo per le pubblicazioni create in un server di pubblicazione che esegue [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]o è stato aggiornato a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59bc3-184">The Web Synchronization Wizard that is available with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] can be used only for publications that were created on a Publisher that is running [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], or a Publisher that was upgraded to [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span></span> <span data-ttu-id="59bc3-185">Non può essere utilizzata per le pubblicazioni in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59bc3-185">The wizard cannot be used for publications on [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="59bc3-186">Può essere utilizzata con le sottoscrizioni in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] e versioni successive e [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="59bc3-186">The wizard can be used with subscriptions on [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and later versions, and [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 and later versions.</span></span>  
  
 <span data-ttu-id="59bc3-187">La configurazione presenta le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="59bc3-187">The configuration has the following characteristics:</span></span>  
  
-   <span data-ttu-id="59bc3-188">Utilizza il sito Web predefinito in IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-188">Uses the default Web site in IIS.</span></span> <span data-ttu-id="59bc3-189">È comunque possibile utilizzare un altro sito Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-189">However, you can use another Web site.</span></span> <span data-ttu-id="59bc3-190">Per ulteriori informazioni sulla creazione di siti Web, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-190">For more information about how to create Web sites, see the IIS documentation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="59bc3-191">Il sito Web specificato garantisce l'accesso ai componenti utilizzati nella sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="59bc3-191">The Web site that you specify provides access to the components that are used by Web synchronization.</span></span> <span data-ttu-id="59bc3-192">e consente l'accesso ad altri dati o ad altre pagine Web solo se configurato a tale scopo.</span><span class="sxs-lookup"><span data-stu-id="59bc3-192">The Web site does not provide access to other data or Web pages unless you configure the site to do so.</span></span>  
  
-   <span data-ttu-id="59bc3-193">Crea una directory virtuale e gli alias associati.</span><span class="sxs-lookup"><span data-stu-id="59bc3-193">Creates a virtual directory and its associated alias.</span></span> <span data-ttu-id="59bc3-194">L'alias viene utilizzato per l'accesso ai componenti della sincronizzazione Web.</span><span class="sxs-lookup"><span data-stu-id="59bc3-194">The alias is used when accessing the Web synchronization components.</span></span> <span data-ttu-id="59bc3-195">Ad esempio, se l'indirizzo IIS è `https://*server.domain.com*` e si specifica l'alias 'websync1', l'indirizzo per l'accesso al componente replisapi.dll sarà `https://*server.domain.com*/websync1/replisapi.dll`.</span><span class="sxs-lookup"><span data-stu-id="59bc3-195">For example, if the IIS address is `https://*server.domain.com*` and you specify an alias of 'websync1', the address to access the replisapi.dll component is `https://*server.domain.com*/websync1/replisapi.dll`.</span></span>  
  
-   <span data-ttu-id="59bc3-196">Utilizza l'autenticazione di base.</span><span class="sxs-lookup"><span data-stu-id="59bc3-196">Uses Basic Authentication.</span></span> <span data-ttu-id="59bc3-197">È consigliabile utilizzare l'autenticazione di base poiché consente di eseguire IIS e il server di pubblicazione/distribuzione di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in computer separati (configurazione consigliata) senza la delega Kerberos.</span><span class="sxs-lookup"><span data-stu-id="59bc3-197">We recommend using Basic Authentication because Basic Authentication enables you to run IIS and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Publisher/Distributor on separate computers (the recommended configuration) without requiring Kerberos delegation.</span></span> <span data-ttu-id="59bc3-198">L'utilizzo di SSL con l'autenticazione di base assicura la crittografia degli account di accesso, delle password e di tutti i dati in transito.</span><span class="sxs-lookup"><span data-stu-id="59bc3-198">Using SSL with Basic Authentication makes sure that logins, passwords, and all data are encrypted in transit.</span></span> <span data-ttu-id="59bc3-199">SSL è obbligatorio, indipendentemente dal tipo di autenticazione utilizzato. Per ulteriori informazioni sulle procedure consigliate per la sincronizzazione Web, vedere la sezione "procedure consigliate per la sicurezza per la sincronizzazione Web" in [configurare la sincronizzazione Web](configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="59bc3-199">(SSL is required, regardless of the type of authentication that is used.) For more information about best practices for Web synchronization, see the section "Security Best Practices for Web Synchronization" in [Configure Web Synchronization](configure-web-synchronization.md).</span></span>  
  
#### <a name="to-configure-the-computer-that-is-running-iis-by-using-the-configure-web-synchronization-wizard"></a><span data-ttu-id="59bc3-200">Per configurare il computer che esegue IIS utilizzando la procedura di configurazione guidata della sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="59bc3-200">To configure the computer that is running IIS by using the Configure Web Synchronization Wizard</span></span>  
  
1.  <span data-ttu-id="59bc3-201">Nel computer che esegue IIS avviare [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59bc3-201">On the computer that is running IIS, start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span>  
  
2.  <span data-ttu-id="59bc3-202">Connettersi al server di pubblicazione e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="59bc3-202">Connect to the Publisher, and then expand the server node.</span></span>  
  
3.  <span data-ttu-id="59bc3-203">Espandere la cartella **Pubblicazioni locali** , fare clic con il pulsante destro del mouse sulla pubblicazione e quindi scegliere **Configura sincronizzazione Web**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-203">Expand the **Local Publications** folder, right-click the publication, and then click **Configure Web Synchronization**.</span></span>  
  
4.  <span data-ttu-id="59bc3-204">Nella pagina **Tipo di Sottoscrittore** della Configurazione guidata sincronizzazione Web selezionare **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-204">In the Configure Web Synchronization Wizard, on the **Subscriber Type** page, select **SQL Server**.</span></span>  
  
5.  <span data-ttu-id="59bc3-205">Nella pagina **Web Server** :</span><span class="sxs-lookup"><span data-stu-id="59bc3-205">On the **Web Server** page:</span></span>  
  
    1.  <span data-ttu-id="59bc3-206">Selezionare l'istanza di IIS che eseguirà la sincronizzazione delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="59bc3-206">Select the instance of IIS that will synchronize subscriptions.</span></span>  
  
    2.  <span data-ttu-id="59bc3-207">Selezionare **Crea una nuova directory virtuale**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-207">Select **Create a new virtual directory**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-208">Nel riquadro inferiore della pagina espandere l'istanza di IIS, quindi **Siti Web**e infine fare clic su **Sito Web predefinito**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-208">In the lower pane of the page, expand the instance of IIS, expand **Web Sites**, and then click **Default Web Site**.</span></span>  
  
6.  <span data-ttu-id="59bc3-209">Nella pagina **Informazioni directory virtuale** :</span><span class="sxs-lookup"><span data-stu-id="59bc3-209">On the **Virtual Directory Information** page:</span></span>  
  
    1.  <span data-ttu-id="59bc3-210">Nella casella **Alias** immettere un alias per la directory virtuale.</span><span class="sxs-lookup"><span data-stu-id="59bc3-210">In the **Alias** box, enter an alias for the virtual directory.</span></span>  
  
    2.  <span data-ttu-id="59bc3-211">Nella casella **Percorso** immettere un percorso per la directory virtuale.</span><span class="sxs-lookup"><span data-stu-id="59bc3-211">In the **Path** box, enter a path of the virtual directory.</span></span> <span data-ttu-id="59bc3-212">Ad esempio, se è stato immesso `websync1` nella casella **alias** , immettere `C:\Inetpub\wwwroot\websync1` nella casella **percorso** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-212">For example, if you entered `websync1` in the **Alias** box, enter `C:\Inetpub\wwwroot\websync1` in the **Path** box.</span></span> <span data-ttu-id="59bc3-213">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-213">Click **Next**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-214">In entrambe le finestre di dialogo fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-214">On both dialog boxes, click **Yes**.</span></span> <span data-ttu-id="59bc3-215">In questo modo viene specificato che si intende creare una nuova cartella e copiare la DLL ISAPI (Internet Server API) di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-215">This specifies that you want to create a new folder and that you want to copy the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Internet Server API (ISAPI) DLL.</span></span> <span data-ttu-id="59bc3-216">.</span><span class="sxs-lookup"><span data-stu-id="59bc3-216">.</span></span>  
  
7.  <span data-ttu-id="59bc3-217">Nella pagina **Accesso autenticato** :</span><span class="sxs-lookup"><span data-stu-id="59bc3-217">On the **Authenticated Access** page:</span></span>  
  
    1.  <span data-ttu-id="59bc3-218">Assicurarsi che le opzioni **Autenticazione integrata di Windows** e **Autenticazione del digest per server di dominio Windows** siano deselezionate.</span><span class="sxs-lookup"><span data-stu-id="59bc3-218">Make sure that **Integrated Windows authentication** and **Digest authentication for Windows domain servers** are cleared.</span></span>  
  
    2.  <span data-ttu-id="59bc3-219">Selezionare **Autenticazione di base**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-219">Select **Basic Authentication**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-220">Nelle caselle **Dominio predefinito** e **Area autenticazione** immettere il dominio del computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-220">In the **Default Domain** and **Realm** boxes, enter the domain of the computer that is running IIS.</span></span>  
  
8.  <span data-ttu-id="59bc3-221">Nella pagina **Accesso alla directory** :</span><span class="sxs-lookup"><span data-stu-id="59bc3-221">On the **Directory Access** page:</span></span>  
  
    1.  <span data-ttu-id="59bc3-222">Fare clic su **Aggiungi**e quindi nella finestra di dialogo **Seleziona Utenti o gruppi** aggiungere gli account che verranno utilizzati dai Sottoscrittori per le connessioni al server IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-222">Click **Add**, and then in the **Select Users or Groups** dialog box, add the accounts under which Subscribers will make connections to IIS.</span></span> <span data-ttu-id="59bc3-223">Si tratta degli account che verranno specificati nella pagina **Informazioni server Web** della Creazione guidata nuova sottoscrizione oppure come valore per il parametro [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)*@internet_login* .</span><span class="sxs-lookup"><span data-stu-id="59bc3-223">These are the accounts that you will specify on the **Web Server Information** page of the New Subscription Wizard or as the value for the [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)*@internet_login* parameter.</span></span>  
  
9. <span data-ttu-id="59bc3-224">Nella pagina **Accesso alla condivisione snapshot** immettere la condivisione snapshot.</span><span class="sxs-lookup"><span data-stu-id="59bc3-224">On the **Snapshot Share Access** page, enter the snapshot share.</span></span> <span data-ttu-id="59bc3-225">In questa condivisione vengono impostate le autorizzazioni appropriate affinché i Sottoscrittori possano accedere ai file di snapshot.</span><span class="sxs-lookup"><span data-stu-id="59bc3-225">The appropriate permissions are set on this share so that Subscribers can access the snapshot files.</span></span> <span data-ttu-id="59bc3-226">Per altre informazioni sulle autorizzazioni per la condivisione, vedere [Proteggere la cartella snapshot](security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="59bc3-226">For more information about permissions for the share, see [Secure the Snapshot Folder](security/secure-the-snapshot-folder.md).</span></span>  
  
10. <span data-ttu-id="59bc3-227">Nella pagina **Completamento procedura guidata** fare clic su **Fine**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-227">On the **Completing the Wizard** page, click **Finish**.</span></span>  
  
     <span data-ttu-id="59bc3-228">In caso di errore, ad esempio un errore di rete durante il tentativo di configurazione di un computer remoto che esegue IIS, verrà eseguito il rollback di tutte le azioni completate e tutte le restanti azioni verranno annullate.</span><span class="sxs-lookup"><span data-stu-id="59bc3-228">If a failure occurs, such as a network error while trying to configure a remote computer that is running IIS, all completed actions are rolled back and all remaining actions are canceled.</span></span> <span data-ttu-id="59bc3-229">Se non può essere eseguito il rollback di un'azione completata, nella pagina finale della procedura guidata verrà segnalato l' **esito positivo** e verrà mantenuto il commit delle azioni completate.</span><span class="sxs-lookup"><span data-stu-id="59bc3-229">If a completed action cannot be rolled back, the status in the final page of the wizard displays **Success** and the completed actions remain committed.</span></span>  
  
11. <span data-ttu-id="59bc3-230">Se nel computer con IIS è in esecuzione una versione a 64 bit di Windows, è necessario copiare replisapi.dll nella directory appropriata:</span><span class="sxs-lookup"><span data-stu-id="59bc3-230">If the computer that is running IIS is running on a 64-bit version of Windows, replisapi.dll must be copied to the appropriate directory:</span></span>  
  
    1.  <span data-ttu-id="59bc3-231">Fare clic sul pulsante **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-231">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="59bc3-232">Nella casella **Apri** immettere `iisreset` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-232">In the **Open** box, enter `iisreset`, and then click **OK**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-233">Dopo l'arresto e il riavvio di IIS, copiare il file replisapi.dll da [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi nella directory specificata nel passaggio 6b.</span><span class="sxs-lookup"><span data-stu-id="59bc3-233">After IIS stops and restarts, copy replisapi.dll from [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi to the directory that is specified in step 6b.</span></span>  
  
    3.  <span data-ttu-id="59bc3-234">Fare clic sul pulsante **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-234">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="59bc3-235">Nella casella **Apri** immettere `cmd` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-235">In the **Open** box, enter `cmd`, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-236">Nella directory specificata al passaggio 6b eseguire il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="59bc3-236">In the directory that you specified in step 6b, execute the following command:</span></span>  
  
         `regsvr32 replisapi.dll`  
  
## <a name="manually-configuring-the-computer-that-is-running-iis"></a><span data-ttu-id="59bc3-237">Configurazione manuale del computer che esegue IIS</span><span class="sxs-lookup"><span data-stu-id="59bc3-237">Manually Configuring the Computer That Is Running IIS</span></span>  
 <span data-ttu-id="59bc3-238">Per configurare manualmente il computer che esegue IIS, è necessario installare e configurare Listener per la replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] e quindi configurare l'autorizzazione per i Sottoscrittori che si connetteranno a IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-238">To configure the computer that is running IIS manually, you must install and configure the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener, and then configure authorization for Subscribers that will connect to IIS.</span></span>  
  
#### <a name="to-install-and-configure-the-sql-server-replication-listener"></a><span data-ttu-id="59bc3-239">Per installare e configurare Listener per la replica di SQL Server</span><span class="sxs-lookup"><span data-stu-id="59bc3-239">To install and configure the SQL Server Replication Listener</span></span>  
  
1.  <span data-ttu-id="59bc3-240">Creare una directory di file nel computer che esegue IIS per contenere replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="59bc3-240">Create a file directory on the computer that is running IIS to contain replisapi.dll.</span></span> <span data-ttu-id="59bc3-241">Sebbene sia possibile creare la directory in un percorso qualsiasi, è preferibile crearla nella directory \<*drive*>:\Inetpub.</span><span class="sxs-lookup"><span data-stu-id="59bc3-241">You can create the directory wherever you want, but we recommend that you create the directory under the \<*drive*>:\Inetpub directory.</span></span> <span data-ttu-id="59bc3-242">Ad esempio, creare la directory \<*drive*>:\Inetpub\SQLReplication\\.</span><span class="sxs-lookup"><span data-stu-id="59bc3-242">For example, create the directory \<*drive*>:\Inetpub\SQLReplication\\.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="59bc3-243">È consigliabile creare questa directory in una partizione del file system NTFS anziché in un file system FAT.</span><span class="sxs-lookup"><span data-stu-id="59bc3-243">We strongly recommend that you create this directory on an NTFS file system partition instead of a FAT file system.</span></span> <span data-ttu-id="59bc3-244">Quando si utilizza il file system NTFS, è possibile utilizzare le autorizzazioni di tale file system per controllare esattamente gli utenti che possono accedere alla replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-244">When you use the NTFS file system, you can use NTFS file system permissions to control precisely the users that can access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span>  
  
2.  <span data-ttu-id="59bc3-245">Copiare replisapi.dll dalla directory [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ alla directory di file creata nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="59bc3-245">Copy replisapi.dll from the directory [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ to the file directory that you created in step 1.</span></span>  
  
3.  <span data-ttu-id="59bc3-246">Registrare replisapi.dll:</span><span class="sxs-lookup"><span data-stu-id="59bc3-246">Register replisapi.dll:</span></span>  
  
    1.  <span data-ttu-id="59bc3-247">Fare clic sul pulsante **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-247">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="59bc3-248">Nella casella **Apri** immettere `cmd` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-248">In the **Open** box, enter `cmd`, and then click **OK**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-249">Nella directory creata al passaggio 1 eseguire il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="59bc3-249">In the directory that you created in step 1, execute the following command:</span></span>  
  
         `regsvr32 replisapi.dll`  
  
4.  <span data-ttu-id="59bc3-250">Creare un nuovo sito Web per la replica oppure utilizzare un sito esistente.</span><span class="sxs-lookup"><span data-stu-id="59bc3-250">Create a new Web site for replication, or use an existing site.</span></span> <span data-ttu-id="59bc3-251">I componenti di replica accederanno al sito Web durante la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-251">The Web site will be accessed by replication components during synchronization.</span></span> <span data-ttu-id="59bc3-252">Per ulteriori informazioni sulla creazione di siti Web, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-252">For more information about how to create Web sites, see the IIS documentation.</span></span>  
  
5.  <span data-ttu-id="59bc3-253">Creare una directory virtuale in IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-253">Create a virtual directory in IIS.</span></span> <span data-ttu-id="59bc3-254">È consigliabile creare la directory virtuale nel sito Web creato nel passaggio 4 ed eseguirne il mapping alla directory creata nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="59bc3-254">The virtual directory should be created under the Web site that was created in step 4, and should be mapped to the directory that was created in step 1.</span></span> <span data-ttu-id="59bc3-255">Per ulteriori informazioni sulla creazione di directory virtuali, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-255">For more information about how to create virtual directories, see the IIS documentation.</span></span> <span data-ttu-id="59bc3-256">È consigliabile applicare le massime restrizioni nell'assegnazione delle autorizzazioni per questa directory.</span><span class="sxs-lookup"><span data-stu-id="59bc3-256">We recommend that you be as restrictive as possible when you assign permissions to this directory.</span></span> <span data-ttu-id="59bc3-257">È necessario selezionare le autorizzazioni **Lettura** ed **Esecuzione** ma è possibile deselezionare le autorizzazioni **Esecuzione script**, **Scrittura**ed **Esplorazione** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-257">You must select **Read** and **Execute** permissions, but you can clear **Run scripts**, **Write**, and **Browse** permissions.</span></span>  
  
6.  <span data-ttu-id="59bc3-258">Configurare IIS in modo da consentire l'esecuzione di replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="59bc3-258">Configure IIS to enable replisapi.dll to execute.</span></span> <span data-ttu-id="59bc3-259">Le autorizzazioni assegnate nel passaggio 4 sono sufficienti per le versioni precedenti di IIS, ma IIS 6.0 richiede l'abilitazione delle estensioni ISAPI (Internet Server API).</span><span class="sxs-lookup"><span data-stu-id="59bc3-259">The permissions that are assigned in step 4 are sufficient for earlier versions of IIS; however, IIS version 6.0 requires Internet Server API (ISAPI) extensions to be enabled.</span></span> <span data-ttu-id="59bc3-260">Per ulteriori informazioni, vedere le sezioni relative alla configurazione di estensioni ISAPI e all'abilitazione e disabilitazione di contenuto dinamico nella documentazione di IIS 6.0.</span><span class="sxs-lookup"><span data-stu-id="59bc3-260">For more information, see "Configuring ISAPI Extensions" and "Enabling and Disabling Dynamic Content" in the IIS 6.0 documentation.</span></span>  
  
#### <a name="to-configure-iis-authentication"></a><span data-ttu-id="59bc3-261">Per configurare l'autenticazione di IIS</span><span class="sxs-lookup"><span data-stu-id="59bc3-261">To configure IIS authentication</span></span>  
  
-   <span data-ttu-id="59bc3-262">Quando i Sottoscrittori si connettono a IIS, è necessario che vengano autenticati da IIS affinché possano accedere a risorse e processi.</span><span class="sxs-lookup"><span data-stu-id="59bc3-262">When Subscribers connect to IIS, IIS must authenticate the Subscribers before they can access resources and processes.</span></span> <span data-ttu-id="59bc3-263">IIS offre tre tipi di autenticazione: anonima, di base e integrata.</span><span class="sxs-lookup"><span data-stu-id="59bc3-263">IIS offers three types of authentication: Anonymous, Basic, and Integrated.</span></span> <span data-ttu-id="59bc3-264">L'autenticazione può essere applicata all'intero sito Web oppure alla directory virtuale creata.</span><span class="sxs-lookup"><span data-stu-id="59bc3-264">Authentication can be applied to the whole Web site or to the virtual directory that you created.</span></span>  
  
     <span data-ttu-id="59bc3-265">È consigliabile utilizzare l'autenticazione di base con SSL.</span><span class="sxs-lookup"><span data-stu-id="59bc3-265">We recommend that you use Basic Authentication with SSL.</span></span> <span data-ttu-id="59bc3-266">SSL è necessario indipendentemente dal tipo di autenticazione utilizzato.</span><span class="sxs-lookup"><span data-stu-id="59bc3-266">SSL is required, regardless of the type of authentication that is used.</span></span> <span data-ttu-id="59bc3-267">Per ulteriori informazioni sulla configurazione dell'autenticazione, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-267">For more information about how to configure authentication, see the IIS documentation.</span></span>  
  
## <a name="setting-permissions-for-the-sql-server-replication-listener"></a><span data-ttu-id="59bc3-268">Impostazione delle autorizzazioni per Listener per la replica di SQL Server</span><span class="sxs-lookup"><span data-stu-id="59bc3-268">Setting Permissions for the SQL Server Replication Listener</span></span>  
 <span data-ttu-id="59bc3-269">Quando un Sottoscrittore si connette al computer che esegue IIS, viene autenticato mediante il tipo di autenticazione specificato durante la configurazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-269">When a Subscriber connects to the computer that is running IIS, the Subscriber is authenticated by using the type of authentication that was specified when you configured IIS.</span></span> <span data-ttu-id="59bc3-270">Dopo l'autenticazione del Sottoscrittore, IIS controlla se il Sottoscrittore è autorizzato a richiamare la replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-270">After IIS authenticates the Subscriber, IIS checks whether the Subscriber is authorized to invoke [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="59bc3-271">Per controllare gli utenti autorizzati a richiamare le replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , è necessario impostare le autorizzazioni per replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="59bc3-271">You control the users that can invoke [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication by setting permissions for replisapi.dll.</span></span> <span data-ttu-id="59bc3-272">La corretta configurazione delle autorizzazioni è fondamentale per impedire l'accesso non autorizzato alla replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59bc3-272">Properly configuring permissions is necessary to prevent unauthorized access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span>  
  
 <span data-ttu-id="59bc3-273">Per configurare le autorizzazioni minime per l'account utilizzato per l'esecuzione di Listener per la replica di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , completare la procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="59bc3-273">To configure the minimum permissions for the account under which the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener runs, complete the following procedure.</span></span> <span data-ttu-id="59bc3-274">I passaggi della procedura si applicano all' [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] esecuzione di IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="59bc3-274">The steps in the procedure apply to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] running IIS 6.0.</span></span>  
  
 <span data-ttu-id="59bc3-275">Oltre a eseguire la procedura seguente, assicurarsi che gli account di accesso necessari siano inclusi nell'elenco di accesso alla pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-275">In addition to performing the following steps, make sure that the required logins are in the publication access list (PAL).</span></span> <span data-ttu-id="59bc3-276">Per altre informazioni sull'elenco di acceso alla pubblicazione, vedere [Proteggere il server di pubblicazione](security/secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="59bc3-276">For more information about the PAL, see [Secure the Publisher](security/secure-the-publisher.md).</span></span>  
  
#### <a name="to-configure-the-account-and-permissions"></a><span data-ttu-id="59bc3-277">Per configurare l'account e le autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="59bc3-277">To configure the account and permissions</span></span>  
  
1.  <span data-ttu-id="59bc3-278">Creare un account locale nel computer che esegue IIS:</span><span class="sxs-lookup"><span data-stu-id="59bc3-278">Create a local account on the computer that is running IIS:</span></span>  
  
    1.  <span data-ttu-id="59bc3-279">Fare clic con il pulsante destro del mouse su **Risorse del computer**, quindi fare clic su **Gestione**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-279">Right-click **My Computer**, and then click **Manage**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-280">In **Gestione computer**espandere **Utenti e gruppi locali**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-280">In **Computer Management**, expand **Local Users and Groups**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-281">Fare clic con il pulsante destro del mouse su **Utenti**e quindi scegliere **Nuovo utente**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-281">Right-click **Users**, and then click **New User**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-282">Immettere un nome utente e una password complessa.</span><span class="sxs-lookup"><span data-stu-id="59bc3-282">Enter a user name and a strong password.</span></span>  
  
    5.  <span data-ttu-id="59bc3-283">Fare clic su **Crea**e quindi su **Chiudi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-283">Click **Create**, and then click **Close**.</span></span>  
  
2.  <span data-ttu-id="59bc3-284">Aggiungere l'account al gruppo IIS_WPG:</span><span class="sxs-lookup"><span data-stu-id="59bc3-284">Add the account to the IIS_WPG group:</span></span>  
  
    1.  <span data-ttu-id="59bc3-285">In **Gestione computer**espandere **Utenti e gruppi locali**e quindi fare clic su **Gruppi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-285">In **Computer Management**, expand **Local Users and Groups**, and then click **Groups**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-286">Fare clic con il pulsante destro del mouse su **IIS_WPG**e quindi scegliere **Aggiungi al gruppo**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-286">Right-click **IIS_WPG**, and then click **Add to Group**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-287">Nella finestra di dialogo **Proprietà - IIS_WPG** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-287">In the **IIS_WPG Properties** dialog box, click **Add**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-288">Nella finestra di dialogo **Seleziona Utenti** aggiungere l'account creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="59bc3-288">In the **Select Users, Computers, or Groups** dialog box, add the account created in step 1.</span></span>  
  
    5.  <span data-ttu-id="59bc3-289">Assicurarsi che nel campo **Da questo percorso** sia presente il nome del computer locale e non di un dominio.</span><span class="sxs-lookup"><span data-stu-id="59bc3-289">Make sure that the name in the **From this location** field is the name of the local computer instead of a domain.</span></span> <span data-ttu-id="59bc3-290">Se il nome non corrisponde a un computer locale, fare clic su **Percorsi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-290">If the name is not a local computer, click **Locations**.</span></span> <span data-ttu-id="59bc3-291">Nella finestra di dialogo **Percorsi** selezionare il computer locale e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-291">In the **Locations** dialog box, elect the local computer, and then click **OK**.</span></span>  
  
    6.  <span data-ttu-id="59bc3-292">Nelle finestre di dialogo **Seleziona Utenti** e **Proprietà - IIS_WPG** fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-292">In the **Select Users** dialog box and the **IIS_WPG Properties** dialog box, click **OK**.</span></span>  
  
3.  <span data-ttu-id="59bc3-293">Concedere all'account le autorizzazioni minime per la cartella contenente replisapi.dll:</span><span class="sxs-lookup"><span data-stu-id="59bc3-293">Grant the minimum permissions on the folder that contains replisapi.dll to the account :</span></span>  
  
    1.  <span data-ttu-id="59bc3-294">Fare clic con il pulsante destro del mouse sulla cartella creata per replisapi.dll e quindi scegliere **Condivisione e sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-294">Locate the folder that you created for replisapi.dll, right-click the folder, and then click **Sharing and Security**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-295">Nella scheda **Sicurezza** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-295">On the **Security** tab, click **Add**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-296">Nella finestra di dialogo **Seleziona Utenti** aggiungere l'account creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="59bc3-296">In the **Select Users, Computers, or Groups** dialog box, add the account that you created in step 1.</span></span>  
  
    4.  <span data-ttu-id="59bc3-297">Assicurarsi che nel campo **Da questo percorso** sia presente il nome del computer locale e non di un dominio.</span><span class="sxs-lookup"><span data-stu-id="59bc3-297">Make sure that the name in the **From this location** field is the name of the local computer instead of a domain.</span></span> <span data-ttu-id="59bc3-298">Se il nome non corrisponde a un computer locale, fare clic su **Percorsi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-298">If the name is not a local computer, click **Locations**.</span></span> <span data-ttu-id="59bc3-299">Nella finestra di dialogo **Percorsi** selezionare il computer locale e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-299">In the **Locations** dialog box, select the local computer, and then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="59bc3-300">Assicurarsi che all'account siano concesse soltanto le autorizzazioni **Lettura**, **Lettura ed esecuzione** e **Visualizzazione contenuto cartella**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-300">Make sure that the account is granted only **Read**, **Read & Execute**, and **List Folder Contents** permissions.</span></span>  
  
    6.  <span data-ttu-id="59bc3-301">Selezionare gli utenti o i gruppi che non necessitano dell'accesso alla directory e quindi fare clic su **Rimuovi**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-301">Select any users or groups that do not require access to the directory, and then click **Remove**.</span></span>  
  
    7.  <span data-ttu-id="59bc3-302">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-302">Click **OK**.</span></span>  
  
4.  <span data-ttu-id="59bc3-303">Creare un pool di applicazioni in **Gestione Internet Information Services (IIS)** :</span><span class="sxs-lookup"><span data-stu-id="59bc3-303">Create an application pool in **Internet Information Services (IIS) Manager**:</span></span>  
  
    1.  <span data-ttu-id="59bc3-304">Fare clic sul pulsante **Start**e quindi scegliere **Esegui**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-304">Click **Start**, and then click **Run**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-305">Nella casella **Apri** Digitare `inetmgr` , quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-305">In the **Open** box, type `inetmgr`, and then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-306">In **Gestione Internet Information Services (IIS)** espandere il nodo **computer locale** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-306">In **Internet Information Services (IIS) Manager**, expand the **local computer** node.</span></span>  
  
    4.  <span data-ttu-id="59bc3-307">Fare clic con il pulsante destro del mouse su **Pool di applicazioni**, scegliere **Nuovo** e quindi **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-307">Right-click **Application Pools**, point to **New** and then click **Application Pool**.</span></span>  
  
    5.  <span data-ttu-id="59bc3-308">Immettere un nome per il pool nel campo **ID pool di applicazioni** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-308">Enter a name for the pool in the **Application pool ID** field, and then click **OK**.</span></span>  
  
5.  <span data-ttu-id="59bc3-309">Associare l'account al pool di applicazioni:</span><span class="sxs-lookup"><span data-stu-id="59bc3-309">Associate the account with the application pool:</span></span>  
  
    1.  <span data-ttu-id="59bc3-310">In **Gestione Internet Information Services (IIS)** espandere il nodo **computer locale** e quindi **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-310">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand **Application Pools**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-311">Fare clic con il pulsante destro del mouse sul pool di applicazioni creato e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-311">Right-click the application pool that you created, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-312">Nella scheda **identità** della finestra di dialogo \*\* \<ApplicationPoolName> Proprietà\*\* fare clic su **configurabile**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-312">In the **\<ApplicationPoolName> Properties** dialog box, on the **Identity** tab, click **Configurable**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-313">Nei campi **Nome utente** e **Password** immettere l'account e la password creati nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="59bc3-313">In the **User name** and **password** fields, enter the account and password that were created in step 1.</span></span>  
  
    5.  <span data-ttu-id="59bc3-314">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-314">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="59bc3-315">Associare il pool di applicazioni alla directory virtuale utilizzata per la sincronizzazione Web:</span><span class="sxs-lookup"><span data-stu-id="59bc3-315">Associate the application pool with the virtual directory that is used for Web synchronization:</span></span>  
  
    1.  <span data-ttu-id="59bc3-316">In **Gestione Internet Information Services (IIS)** espandere il nodo **computer locale** e quindi **Siti Web**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-316">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand **Web Sites**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-317">Espandere il sito Web utilizzato per la sincronizzazione Web, fare clic con il pulsante destro del mouse sulla directory virtuale creata per tale sincronizzazione e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-317">Expand the Web site that you are using for Web synchronization, right-click the virtual directory that you created for Web synchronization, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-318">Nella scheda **directory virtuale** della finestra di dialogo \*\* \<VirtualDirectoryName> proprietà\*\* , dall'elenco a discesa **pool di applicazioni** , selezionare il pool di applicazioni creato nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="59bc3-318">On the **Virtual Directory** tab of the **\<VirtualDirectoryName> Properties** dialog box, from the **Application pool** drop-down list, select the application pool that was created in step 5.</span></span>  
  
    4.  <span data-ttu-id="59bc3-319">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-319">Click **OK**.</span></span>  
  
## <a name="testing-the-connection-to-replisapidll"></a><span data-ttu-id="59bc3-320">Test della connessione a replisapi.dll</span><span class="sxs-lookup"><span data-stu-id="59bc3-320">Testing the Connection to replisapi.dll</span></span>  
 <span data-ttu-id="59bc3-321">Eseguire la sincronizzazione Web in modalità diagnostica per testare la connessione al computer che esegue IIS e verificare la corretta installazione del certificato SSL (Secure Sockets Layer).</span><span class="sxs-lookup"><span data-stu-id="59bc3-321">Run Web synchronization in diagnostic mode to test the connection to the computer that is running IIS and to make sure that the Secure Sockets Layer (SSL) certificate is properly installed.</span></span> <span data-ttu-id="59bc3-322">Per eseguire la sincronizzazione Web in modalità diagnostica, è necessario disporre dei privilegi di amministratore sul computer che esegue IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-322">To run Web synchronization in diagnostic mode, you must be an administrator on the computer running IIS.</span></span>  
  
#### <a name="to-test-the-connection-to-replisapidll"></a><span data-ttu-id="59bc3-323">Per testare la connessione a replisapi.dll</span><span class="sxs-lookup"><span data-stu-id="59bc3-323">To test the connection to replisapi.dll</span></span>  
  
1.  <span data-ttu-id="59bc3-324">Assicurarsi che le impostazioni per la rete LAN (Local Area Network) nel Sottoscrittore siano corrette:</span><span class="sxs-lookup"><span data-stu-id="59bc3-324">Make sure that local area network (LAN) settings at the Subscriber are correct:</span></span>  
  
    1.  <span data-ttu-id="59bc3-325">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer fare clic su **Opzioni Internet** dal menu **Strumenti**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-325">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer, on the **Tools** menu, click **Internet Options**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-326">Nella scheda **Connessioni** fare clic su **Impostazioni LAN**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-326">On the **Connections** tab, click **LAN Settings**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-327">Se nella rete LAN non viene utilizzato un server proxy, deselezionare **Rileva automaticamente impostazioni** e **Utilizza un server proxy server per le connessioni LAN**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-327">If a proxy server is not used on the LAN, clear **Automatically Detect Settings** and **Use a proxy server for your LAN**.</span></span>  
  
    4.  <span data-ttu-id="59bc3-328">Se viene utilizzato un server proxy, selezionare **Utilizza un server proxy server per le connessioni LAN** e **Ignora server proxy per indirizzi locali**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-328">If a proxy server is used, select **Use a proxy server for your LAN** and **Bypass proxy server for local addresses**.</span></span>  
  
    5.  <span data-ttu-id="59bc3-329">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-329">Click **OK**.</span></span>  
  
2.  <span data-ttu-id="59bc3-330">Nel Sottoscrittore, in Internet Explorer, connettersi al server in modalità diagnostica aggiungendo `?diag` alla fine dell'indirizzo di replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="59bc3-330">At the Subscriber, in Internet Explorer, connect to the server in diagnostic mode by appending `?diag` to the address for the replisapi.dll.</span></span> <span data-ttu-id="59bc3-331">Ad esempio: `https://server.domain.com/directory/replisapi.dll?diag`.</span><span class="sxs-lookup"><span data-stu-id="59bc3-331">For example: `https://server.domain.com/directory/replisapi.dll?diag`.</span></span>  
  
3.  <span data-ttu-id="59bc3-332">Se il certificato specificato per IIS non viene riconosciuto dal sistema operativo Windows, viene visualizzata la finestra di dialogo **Avviso di sicurezza** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-332">If the certificate that you specified for IIS is not recognized by the Windows operating system, the **Security Alert** dialog box appears.</span></span> <span data-ttu-id="59bc3-333">Questo avviso può essere visualizzato perché il certificato è un certificato di prova o è stato emesso da un'autorità di certificazione non riconosciuta da Windows.</span><span class="sxs-lookup"><span data-stu-id="59bc3-333">This alert might occur because the certificate is a test certificate or the certificate was issued by a certification authority (CA) that Windows does not recognize.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="59bc3-334">Se questa finestra di dialogo non viene visualizzata, verificare che il certificato per il server a cui si accede sia stato aggiunto all'archivio certificati nel Sottoscrittore come certificato attendibile.</span><span class="sxs-lookup"><span data-stu-id="59bc3-334">If this dialog box does not appear, make sure that the certificate for the server that you are accessing has been added to the certificate store at the Subscriber as a trusted certificate.</span></span> <span data-ttu-id="59bc3-335">Per ulteriori informazioni sull'esportazione dei certificati, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-335">For more information about exporting certificates, see the IIS documentation.</span></span>  
  
    1.  <span data-ttu-id="59bc3-336">Nella finestra di dialogo **Avviso di sicurezza** fare clic su **Visualizza certificato**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-336">In the **Security Alert** dialog box, click **View Certificate**.</span></span>  
  
    2.  <span data-ttu-id="59bc3-337">Nella scheda **Generale** della finestra di dialogo **Certificato** fare clic su **Installa certificato**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-337">In the **Certificate** dialog box, on the **General** tab, click **Install Certificate**.</span></span>  
  
    3.  <span data-ttu-id="59bc3-338">Completare l'Importazione guidata certificati, accettando le impostazioni predefinite.</span><span class="sxs-lookup"><span data-stu-id="59bc3-338">Complete the Certificate Import Wizard, accepting the defaults.</span></span>  
  
    4.  <span data-ttu-id="59bc3-339">Nella finestra di dialogo **Avviso di sicurezza** fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-339">In the **Security Warning** dialog box, click **Yes**.</span></span>  
  
    5.  <span data-ttu-id="59bc3-340">Nella finestra di dialogo di conferma dell'Importazione guidata certificati fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-340">In the Certificate Import Wizard confirmation dialog box, click **OK**.</span></span>  
  
    6.  <span data-ttu-id="59bc3-341">Chiudere la finestra di dialogo **Certificato** .</span><span class="sxs-lookup"><span data-stu-id="59bc3-341">Close the **Certificate** dialog box.</span></span>  
  
    7.  <span data-ttu-id="59bc3-342">Nella finestra di dialogo **Avviso di sicurezza** fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-342">In the **Security Alert** dialog box, click **Yes**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="59bc3-343">I certificati vengono installati per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="59bc3-343">Certificates are installed for users.</span></span> <span data-ttu-id="59bc3-344">Questo processo deve pertanto essere eseguito per ogni utente che eseguirà la sincronizzazione con IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-344">This process must be performed for each user that will synchronize with IIS.</span></span>  
  
4.  <span data-ttu-id="59bc3-345">Nella finestra di dialogo **Connetti a \<ServerName>** specificare l'account di accesso e la password che verranno utilizzati dall'agente di merge per la connessione a IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-345">In the **Connect to \<ServerName>** dialog box, specify the login and password that the Merge Agent will use to connect to IIS.</span></span> <span data-ttu-id="59bc3-346">Queste credenziali verranno inoltre specificate nella Creazione guidata nuova sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="59bc3-346">These credentials will also be specified in the New Subscription Wizard.</span></span>  
  
5.  <span data-ttu-id="59bc3-347">Nella finestra di Internet Explorer denominata **Informazioni diagnostica SQL Websync**, verificare che il valore contenuto in ogni colonna **Stato** della pagina sia **SUCCESS**.</span><span class="sxs-lookup"><span data-stu-id="59bc3-347">In the Internet Explorer window called **SQL Websync diagnostic information**, verify that the value in each **Status** column on the page is **SUCCESS**.</span></span>  
  
6.  <span data-ttu-id="59bc3-348">Assicurarsi che il certificato sia installato correttamente nel Sottoscrittore:</span><span class="sxs-lookup"><span data-stu-id="59bc3-348">Make sure that the certificate is installed correctly on the Subscriber:</span></span>  
  
    1.  <span data-ttu-id="59bc3-349">Chiudere e riaprire Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="59bc3-349">Close and then reopen Internet Explorer.</span></span>  
  
    2.  <span data-ttu-id="59bc3-350">Connettersi al server in modalità diagnostica.</span><span class="sxs-lookup"><span data-stu-id="59bc3-350">Connect to the server in diagnostic mode.</span></span> <span data-ttu-id="59bc3-351">Se il certificato è stato installato correttamente, la finestra di dialogo **Avviso di sicurezza** non verrà visualizzata.</span><span class="sxs-lookup"><span data-stu-id="59bc3-351">If the certificate is installed properly, the **Security Alert** dialog box will not appear.</span></span> <span data-ttu-id="59bc3-352">Se la finestra di dialogo viene visualizzata, i tentativi dell'agente di merge di connettersi al computer che esegue IIS avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="59bc3-352">If the dialog box appears, the Merge Agent will fail when it tries to connect to the computer that is running IIS.</span></span> <span data-ttu-id="59bc3-353">È necessario verificare che il certificato per il server a cui si accede sia stato aggiunto all'archivio certificati del Sottoscrittore come certificato attendibile.</span><span class="sxs-lookup"><span data-stu-id="59bc3-353">You must make sure that the certificate for the server that you are accessing has been added to the certificate store at the Subscriber as a trusted certificate.</span></span> <span data-ttu-id="59bc3-354">Per ulteriori informazioni sull'esportazione dei certificati, vedere la documentazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="59bc3-354">For more information about exporting certificates, see the IIS documentation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="59bc3-355">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="59bc3-355">See Also</span></span>  
 [<span data-ttu-id="59bc3-356">Configurare la sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="59bc3-356">Configure Web Synchronization</span></span>](configure-web-synchronization.md)  
  
  
