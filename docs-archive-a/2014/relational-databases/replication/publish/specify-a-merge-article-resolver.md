---
title: Specificare un sistema di risoluzione dei conflitti dell'articolo di merge | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
- merge replication conflict resolution [SQL Server replication], merge article resolvers
ms.assetid: a40083b3-4f7b-4a25-a5a3-6ef67bdff440
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ca32ef4936f31ca5c75dfc2df1eb965d17f7b039
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87717855"
---
# <a name="specify-a-merge-article-resolver"></a><span data-ttu-id="6d630-102">Impostazione di un sistema di risoluzione dei conflitti dell'articolo di merge</span><span class="sxs-lookup"><span data-stu-id="6d630-102">Specify a Merge Article Resolver</span></span>
  <span data-ttu-id="6d630-103">In questo argomento viene descritto come specificare un sistema di risoluzione dell'articolo di merge in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6d630-103">This topic describes how to specify a merge article resolver in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
 <span data-ttu-id="6d630-104">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="6d630-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="6d630-105">**Prima di iniziare:**</span><span class="sxs-lookup"><span data-stu-id="6d630-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="6d630-106">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="6d630-106">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="6d630-107">**Per specificare un sistema di risoluzione dell'articolo di merge, utilizzando**</span><span class="sxs-lookup"><span data-stu-id="6d630-107">**To specify a merge article resolver, using:**</span></span>  
  
     [<span data-ttu-id="6d630-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6d630-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="6d630-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6d630-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="6d630-110">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="6d630-110">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="6d630-111">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="6d630-111">Recommendations</span></span>  
  
-   <span data-ttu-id="6d630-112">La replica di tipo merge consente i tipi di sistemi di risoluzione dei conflitti dell'articolo indicati di seguito:</span><span class="sxs-lookup"><span data-stu-id="6d630-112">Merge replication allows the following types of article resolvers:</span></span>  
  
    -   <span data-ttu-id="6d630-113">Il sistema di risoluzione dei conflitti predefinito.</span><span class="sxs-lookup"><span data-stu-id="6d630-113">The default resolver.</span></span> <span data-ttu-id="6d630-114">Il comportamento del sistema di risoluzione dei conflitti predefinito dipende dal tipo di sottoscrizione, ovvero se si tratta di una sottoscrizione client o server.</span><span class="sxs-lookup"><span data-stu-id="6d630-114">The behavior of the default resolver depends on whether the subscription is a client subscription or a server subscription.</span></span> <span data-ttu-id="6d630-115">Per altre informazioni sulla specifica del tipo di sottoscrizione, vedere [Specificare una sottoscrizione di tipo merge e la priorità per la risoluzione dei conflitti &#40;SQL Server Management Studio&#41;](../specify-a-merge-subscription-type-and-conflict-resolution-priority.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-115">For more information about specifying subscription type, see [Specify a Merge Subscription Type and Conflict Resolution Priority &#40;SQL Server Management Studio&#41;](../specify-a-merge-subscription-type-and-conflict-resolution-priority.md).</span></span>  
  
    -   <span data-ttu-id="6d630-116">Un sistema di risoluzione dei conflitti personalizzato, che può essere un gestore della logica di business (scritto in codice gestito) oppure un sistema di risoluzione dei conflitti personalizzato basato su COM.</span><span class="sxs-lookup"><span data-stu-id="6d630-116">A custom resolver you have written, which can be a business logic handler (written in managed code) or a custom COM-based resolver.</span></span> <span data-ttu-id="6d630-117">Per altre informazioni, vedere [Rilevamento e risoluzione avanzati dei conflitti nella replica di tipo merge](../merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-117">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](../merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span> <span data-ttu-id="6d630-118">Se è necessario implementare logica personalizzata che viene eseguita per ogni riga replicata e non solo per quelle in conflitto, vedere [Implementare un gestore della logica di business per un articolo di merge](../implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-118">If you need to implement custom logic that is executed for each replicated row, not just for conflicting rows, see [Implement a Business Logic Handler for a Merge Article](../implement-a-business-logic-handler-for-a-merge-article.md).</span></span>  
  
    -   <span data-ttu-id="6d630-119">Un sistema di risoluzione dei conflitti standard basato su COM, incluso in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6d630-119">A standard COM-based resolver, which is included with [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="6d630-120">Per utilizzare un sistema di risoluzione dei conflitti diverso da quello predefinito, è necessario copiare il sistema desiderato nel computer in cui è in esecuzione l'agente di merge e registrarlo. Se si utilizza un gestore della logica di business, è necessario eseguire la registrazione anche nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="6d630-120">To use a resolver other than the default resolver, you must copy the resolver to the computer on which the Merge Agent runs and register it (if you are using a business logic handler, it must also be registered at the Publisher).</span></span> <span data-ttu-id="6d630-121">L'agente di merge viene eseguito nei sistemi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6d630-121">The Merge Agent runs at:</span></span>  
  
    -   <span data-ttu-id="6d630-122">Server di distribuzione per una sottoscrizione push</span><span class="sxs-lookup"><span data-stu-id="6d630-122">The Distributor for a push subscription</span></span>  
  
    -   <span data-ttu-id="6d630-123">Sottoscrittore per una sottoscrizione pull</span><span class="sxs-lookup"><span data-stu-id="6d630-123">The Subscriber for a pull subscription</span></span>  
  
    -   <span data-ttu-id="6d630-124">Server [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) per una sottoscrizione pull che utilizza la sincronizzazione Web</span><span class="sxs-lookup"><span data-stu-id="6d630-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) server for a pull subscription that uses Web synchronization</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="6d630-125">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6d630-125">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="6d630-126">In seguito alla registrazione del sistema di risoluzione dei conflitti, specificare che è necessario che un articolo usi il sistema nella scheda **Sistema di risoluzione** della finestra di dialogo **Proprietà articolo - \<Article>** , disponibile nella Creazione guidata nuova pubblicazione e nella finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="6d630-126">After the resolver is registered, specify that an article should use the resolver on the **Resolver** tab of the **Article Properties - \<Article>** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="6d630-127">Per altre informazioni sull'uso della creazione guidata e l'accesso alla finestra di dialogo, vedere [Creare una pubblicazione](create-a-publication.md) e [Visualizzare e modificare le proprietà della pubblicazione](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-127">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-a-resolver"></a><span data-ttu-id="6d630-128">Per specificare un sistema di risoluzione dei conflitti</span><span class="sxs-lookup"><span data-stu-id="6d630-128">To specify a resolver</span></span>  
  
1.  <span data-ttu-id="6d630-129">Selezionare una tabella nella pagina **Articoli** della Creazione guidata nuova pubblicazione o nella finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="6d630-129">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span>  
  
2.  <span data-ttu-id="6d630-130">Fare clic su **Proprietà articolo**e quindi su **Imposta proprietà dell'articolo di tabella evidenziato**.</span><span class="sxs-lookup"><span data-stu-id="6d630-130">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article**.</span></span>  
  
3.  <span data-ttu-id="6d630-131">Nella pagina **Proprietà articolo - \<Article>** fare clic sulla scheda **Sistema di risoluzione**.</span><span class="sxs-lookup"><span data-stu-id="6d630-131">On the **Article Properties - \<Article>** page, click the **Resolver** tab.</span></span>  
  
4.  <span data-ttu-id="6d630-132">Selezionare **Usa un sistema di risoluzione personalizzato (registrato nel server di distribuzione)** e quindi fare clic sul sistema di risoluzione nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="6d630-132">Select **Use a custom resolver (registered at the Distributor)**, and then in the list, click the resolver.</span></span>  
  
5.  <span data-ttu-id="6d630-133">Se il sistema di risoluzione dei conflitti richiede un input, ad esempio un nome di colonna, specificarlo nella casella di testo **Immettere le informazioni necessarie per il sistema di risoluzione** .</span><span class="sxs-lookup"><span data-stu-id="6d630-133">If the resolver requires input (such as a column name), specify it in the **Enter information needed by the resolver** text box.</span></span>  
  
6.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
7.  <span data-ttu-id="6d630-134">Ripetere questa procedura per ogni articolo che richiede un sistema di risoluzione dei conflitti.</span><span class="sxs-lookup"><span data-stu-id="6d630-134">Repeat this process for each article that requires a resolver.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="6d630-135">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6d630-135">Using Transact-SQL</span></span>  
  
#### <a name="to-register-a-custom-conflict-resolver"></a><span data-ttu-id="6d630-136">Per registrare un sistema di risoluzione dei conflitti personalizzato</span><span class="sxs-lookup"><span data-stu-id="6d630-136">To register a custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="6d630-137">Se si intende registrare un sistema di risoluzione dei conflitti personalizzato, creare uno dei tipi seguenti:</span><span class="sxs-lookup"><span data-stu-id="6d630-137">If you plan to register your own custom conflict resolver, create one of the following types:</span></span>  
  
    -   <span data-ttu-id="6d630-138">Sistema di risoluzione basato su codice gestito come gestore della logica di business.</span><span class="sxs-lookup"><span data-stu-id="6d630-138">Managed code-based resolver as a business logic handler.</span></span> <span data-ttu-id="6d630-139">Per altre informazioni, vedere [Implementare un gestore della logica di business per un articolo di merge](../implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-139">For more information, see [Implement a Business Logic Handler for a Merge Article](../implement-a-business-logic-handler-for-a-merge-article.md).</span></span>  
  
    -   <span data-ttu-id="6d630-140">Sistema di risoluzione basato sulla stored procedure e sistema di risoluzione basato su COM.</span><span class="sxs-lookup"><span data-stu-id="6d630-140">Stored procedure-based resolver and COM-based resolver.</span></span> <span data-ttu-id="6d630-141">Per altre informazioni, vedere [Implementare un sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span><span class="sxs-lookup"><span data-stu-id="6d630-141">For more information, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span></span>  
  
2.  <span data-ttu-id="6d630-142">Per determinare se il sistema di risoluzione desiderato è già registrato, eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) in qualsiasi database nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="6d630-142">To determine if the desired resolver is already registered, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) at the Publisher on any database.</span></span> <span data-ttu-id="6d630-143">Verrà visualizzata una descrizione del sistema di risoluzione personalizzato, nonché l'identificatore di classe (CLSID) di ogni sistema di risoluzione basato su COM registrato nel server di distribuzione oppure informazioni sull'assembly gestito per ogni gestore della logica di business registrato nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6d630-143">This displays a description of the custom resolver as well as the class identifier (CLSID) for each COM-based resolver registered at the Distributor or information on the managed assembly for each business logic handler registered at the Distributor.</span></span>  
  
3.  <span data-ttu-id="6d630-144">Se il sistema di risoluzione desiderato non è già registrato, eseguire [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) nel database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6d630-144">If the desired custom resolver is not already registered, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) at the Distributor.</span></span> <span data-ttu-id="6d630-145">Specificare un nome per il resolver per **@article_resolver** ; per un gestore della logica di business, si tratta del nome descrittivo dell'assembly.</span><span class="sxs-lookup"><span data-stu-id="6d630-145">Specify a name for the resolver for **@article_resolver**; for a business logic handler, this is the friendly name of the assembly.</span></span> <span data-ttu-id="6d630-146">Per i resolver basati su COM, specificare il CLSID della DLL per **@resolver_clsid** e per un gestore della logica di business specificare il valore `true` per **@is_dotnet_assembly** , il nome dell'assembly per **@dotnet_assembly_name** e il nome completo della classe che esegue l'override di <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> per **@dotnet_class_name** .</span><span class="sxs-lookup"><span data-stu-id="6d630-146">For COM-based resolvers, specify the CLSID of the DLL for **@resolver_clsid**, and for a business logic handler, specify a value of `true` for **@is_dotnet_assembly**, the name of the assembly for **@dotnet_assembly_name**, and the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> for **@dotnet_class_name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6d630-147">Se un assembly del gestore della logica di business non viene distribuito nella stessa directory del agente di merge eseguibile, nella stessa directory dell'applicazione che avvia in modo sincrono il agente di merge o nella Global Assembly Cache (GAC), è necessario specificare il percorso completo con il nome dell'assembly per **@dotnet_assembly_name** .</span><span class="sxs-lookup"><span data-stu-id="6d630-147">If a business logic handler assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the global assembly cache (GAC), you need to specify the full path with the assembly name for **@dotnet_assembly_name**.</span></span>  
  
4.  <span data-ttu-id="6d630-148">Se il sistema di risoluzione è basato su COM:</span><span class="sxs-lookup"><span data-stu-id="6d630-148">If the resolver is a COM-based resolver:</span></span>  
  
    -   <span data-ttu-id="6d630-149">Copiare la DLL del sistema di risoluzione personalizzato nel server di distribuzione per le sottoscrizioni push o nel Sottoscrittore per le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="6d630-149">Copy the custom resolver DLL to the Distributor for push subscriptions or to the Subscriber for pull subscriptions.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6d630-150">I sistemi di risoluzione personalizzati[!INCLUDE[msCoName](../../../includes/msconame-md.md)] sono disponibili nella directory [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="6d630-150">[!INCLUDE[msCoName](../../../includes/msconame-md.md)] custom resolvers can be found in the [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM directory.</span></span>  
  
    -   <span data-ttu-id="6d630-151">Utilizzare regsvr32.exe per registrare la DLL del sistema di risoluzione personalizzato con il sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="6d630-151">Use regsvr32.exe to register the custom resolver DLL with the operating system.</span></span> <span data-ttu-id="6d630-152">Ad esempio, eseguire il seguente comando dal prompt dei comandi per registrare il sistema di risoluzione dei conflitti aggiuntivi [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="6d630-152">For example, executing the following from the command prompt registers the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver:</span></span>  
  
        ```  
        regsvr32 ssradd.dll  
        ```  
  
5.  <span data-ttu-id="6d630-153">Se il sistema di risoluzione è un gestore della logica di business, distribuire l'assembly nella stessa cartella del agente di merge eseguibile (replmerg.exe), nella stessa cartella di un'applicazione che richiama il agente di merge o nella cartella specificata per il **@dotnet_assembly_name** parametro nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="6d630-153">If the resolver is a business logic handler, deploy the assembly in the same folder as the Merge Agent executable (replmerg.exe), in the same folder as an application that invokes the Merge Agent, or in the folder specified for the **@dotnet_assembly_name** parameter in step 3.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6d630-154">Il percorso di installazione predefinito del file eseguibile dell'agente di merge è [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="6d630-154">The default installation location of the Merge Agent executable is [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span></span>  
  
#### <a name="to-specify-a-custom-resolver-when-defining-a-merge-article"></a><span data-ttu-id="6d630-155">Per specificare un sistema di risoluzione personalizzato durante la definizione di un articolo di merge</span><span class="sxs-lookup"><span data-stu-id="6d630-155">To specify a custom resolver when defining a merge article</span></span>  
  
1.  <span data-ttu-id="6d630-156">Se si intende utilizzare un sistema di risoluzione dei conflitti personalizzato, crearlo e registrarlo utilizzando la procedura sopra riportata.</span><span class="sxs-lookup"><span data-stu-id="6d630-156">If you plan to use a custom conflict resolver, create and register the resolver using the above procedure.</span></span>  
  
2.  <span data-ttu-id="6d630-157">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e prendere nota del nome del sistema di risoluzione personalizzato desiderato nel campo **valore** del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="6d630-157">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the desired custom resolver in the **value** field of result set.</span></span>  
  
3.  <span data-ttu-id="6d630-158">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6d630-158">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="6d630-159">Specificare il nome del sistema di risoluzione ottenuto al passaggio 2 per **@article_resolver** ed eventuali input necessari per il resolver personalizzato utilizzando il **@resolver_info** parametro.</span><span class="sxs-lookup"><span data-stu-id="6d630-159">Specify the name of the resolver from step 2 for **@article_resolver** and any required input to the custom resolver using the **@resolver_info** parameter.</span></span> <span data-ttu-id="6d630-160">Per i resolver personalizzati basati su stored procedure, **@resolver_info** è il nome del stored procedure.</span><span class="sxs-lookup"><span data-stu-id="6d630-160">For stored procedure-based custom resolvers, **@resolver_info** is the name of the stored procedure.</span></span> <span data-ttu-id="6d630-161">Per altre informazioni sull'input richiesto per i sistemi di risoluzione dei conflitti forniti da [!INCLUDE[msCoName](../../../includes/msconame-md.md)], vedere [Sistemi di risoluzione dei conflitti basati su Microsoft COM](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-161">For more information about required input for resolvers supplied by [!INCLUDE[msCoName](../../../includes/msconame-md.md)], see [Microsoft COM-Based Resolvers](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span></span>  
  
#### <a name="to-specify-or-change-a-custom-resolver-for-an-existing-merge-article"></a><span data-ttu-id="6d630-162">Per specificare o modificare un sistema di risoluzione personalizzato per un articolo di merge esistente</span><span class="sxs-lookup"><span data-stu-id="6d630-162">To specify or change a custom resolver for an existing merge article</span></span>  
  
1.  <span data-ttu-id="6d630-163">Per determinare se per un articolo è stato definito un sistema di risoluzione personalizzato oppure per ottenere il nome del sistema di risoluzione, eseguire [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6d630-163">To determine if a custom resolver has been defined for an article, or to get the name of the resolver, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="6d630-164">Se per l'articolo è stato definito un sistema di risoluzione personalizzato, il relativo nome verrà visualizzato nel campo **article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="6d630-164">If there is a custom resolver defined for the article, its name will be displayed in the **article_resolver** field.</span></span> <span data-ttu-id="6d630-165">Eventuale input fornito al sistema di risoluzione verrà visualizzato nel campo **resolver_info** del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="6d630-165">Any input supplied to the resolver will be displayed in the **resolver_info** field of the result set.</span></span>  
  
2.  <span data-ttu-id="6d630-166">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e prendere nota del nome del sistema di risoluzione personalizzato desiderato nel campo **value** del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="6d630-166">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the desired custom resolver in the **value** field of the result set.</span></span>  
  
3.  <span data-ttu-id="6d630-167">Nel database di pubblicazione del server di pubblicazione eseguire [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6d630-167">At the Publisher on the publication database, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="6d630-168">Specificare il valore **article_resolver**, incluso il percorso completo dei gestori della logica di business, per **@property**, nonché il nome del sistema di risoluzione personalizzato desiderato ottenuto al passaggio 2 per **@value**.</span><span class="sxs-lookup"><span data-stu-id="6d630-168">Specify a value of **article_resolver**, including the full path for business logic handlers, for **@property**, and the name of the desired custom resolver from step 2 for **@value**.</span></span>  
  
4.  <span data-ttu-id="6d630-169">Per modificare l'eventuale input richiesto per il sistema di risoluzione personalizzato, eseguire nuovamente [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="6d630-169">To change any required input for the custom resolver, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) again.</span></span> <span data-ttu-id="6d630-170">Specificare il valore **resolver_info** per **@property** ed eventuale input obbligatorio per il sistema di risoluzione personalizzato per **@value**.</span><span class="sxs-lookup"><span data-stu-id="6d630-170">Specify a value of **resolver_info** for **@property** and any required input to the custom resolver for **@value**.</span></span> <span data-ttu-id="6d630-171">Per i resolver personalizzati basati su stored procedure, **@resolver_info** è il nome del stored procedure.</span><span class="sxs-lookup"><span data-stu-id="6d630-171">For stored procedure-based custom resolvers, **@resolver_info** is the name of the stored procedure.</span></span> <span data-ttu-id="6d630-172">Per altre informazioni sull'input richiesto, vedere [Sistemi di risoluzione dei conflitti basati su Microsoft COM](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="6d630-172">For more information about required input, see [Microsoft COM-Based Resolvers](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span></span>  
  
#### <a name="to-unregister-a-custom-conflict-resolver"></a><span data-ttu-id="6d630-173">Per annullare la registrazione di un sistema di risoluzione dei conflitti personalizzato</span><span class="sxs-lookup"><span data-stu-id="6d630-173">To unregister a custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="6d630-174">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e prendere nota del nome del sistema di risoluzione personalizzato da rimuovere nel campo **value** del set di risultati.</span><span class="sxs-lookup"><span data-stu-id="6d630-174">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the custom resolver to remove in the **value** field of the result set.</span></span>  
  
2.  <span data-ttu-id="6d630-175">Eseguire [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql) nel database di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6d630-175">Execute [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql) at the Distributor.</span></span> <span data-ttu-id="6d630-176">Specificare il nome completo del sistema di risoluzione personalizzato ottenuto al passaggio 1 per **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="6d630-176">Specify the full name of the custom resolver from step 1 for **@article_resolver**.</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="6d630-177">Esempi (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="6d630-177">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="6d630-178">In questo esempio viene creato un nuovo articolo e viene impostato l'utilizzo del sistema di risoluzione dei conflitti medi [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per calcolare la media della colonna **UnitPrice** in caso di conflitti.</span><span class="sxs-lookup"><span data-stu-id="6d630-178">This example creates a new article and specifies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Averaging Conflict Resolver be used to calculate the average of the **UnitPrice** column when conflicts occur.</span></span>  
  
 [!code-sql[HowTo#sp_addmerge_resolver](../../../snippets/tsql/SQL15/replication/howto/tsql/mergearticleresolvers.sql#sp_addmerge_resolver)]  
  
 <span data-ttu-id="6d630-179">In questo esempio un articolo viene impostato in modo da utilizzare il sistema di risoluzione dei conflitti aggiuntivi [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per calcolare la somma della colonna **UnitsOnOrder** in caso di conflitti.</span><span class="sxs-lookup"><span data-stu-id="6d630-179">This example changes an article to specify using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver to calculate the sum of the **UnitsOnOrder** column when conflicts occur.</span></span>  
  
 [!code-sql[HowTo#sp_changemerge_resolver](../../../snippets/tsql/SQL15/replication/howto/tsql/mergearticleresolvers.sql#sp_changemerge_resolver)]  
  
## <a name="see-also"></a><span data-ttu-id="6d630-180">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6d630-180">See Also</span></span>  
 <span data-ttu-id="6d630-181">[Advanced Merge Replication Conflict Detection and Resolution](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="6d630-181">[Advanced Merge Replication Conflict Detection and Resolution](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="6d630-182">Implementare un gestore della logica di business per un articolo di merge</span><span class="sxs-lookup"><span data-stu-id="6d630-182">Implement a Business Logic Handler for a Merge Article</span></span>](../implement-a-business-logic-handler-for-a-merge-article.md)  
  
  
