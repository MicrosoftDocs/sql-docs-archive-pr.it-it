---
title: Creazione di una sottoscrizione aggiornabile di una pubblicazione transazionale (Management Studio) | Microsoft Docs
ms.custom: ''
ms.date: 07/20/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- updateable transactional subscriptions
- updateable transactional subscriptions, SSMS
ms.assetid: f9ef89ed-36f6-431b-8843-25d445ec137f
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e784216116bdb9ab308dff5fa998740b0fa459b0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725468"
---
# <a name="create-an-updatable-subscription-to-a-transactional-publication-management-studio"></a><span data-ttu-id="e1e7b-102">Creare una sottoscrizione aggiornabile di una pubblicazione transazionale (Management Studio)</span><span class="sxs-lookup"><span data-stu-id="e1e7b-102">Create an Updatable Subscription to a Transactional Publication (Management Studio)</span></span>

> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
 
<span data-ttu-id="e1e7b-103">La replica transazionale consente di ripropagare al server di pubblicazione le modifiche apportate a un Sottoscrittore utilizzando sottoscrizioni ad aggiornamento immediato o ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-103">Transactional replication enables changes made at a Subscriber to be propagated back to the Publisher using either immediate or queued updating subscriptions.</span></span> <span data-ttu-id="e1e7b-104">È possibile creare una sottoscrizione ad aggiornamento a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-104">You can create an updating subscription programmatically using replication stored procedures.</span></span>

<span data-ttu-id="e1e7b-105">Configurare le sottoscrizioni aggiornabili nella pagina **Sottoscrizioni aggiornabili** della **Creazione guidata nuova sottoscrizione**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-105">Configure updatable subscriptions on the **Updatable Subscriptions** page of the **New Subscription Wizard**.</span></span> <span data-ttu-id="e1e7b-106">Questa pagina è disponibile solo se è stata attivata una pubblicazione transazionale per le sottoscrizioni aggiornabili.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-106">This page is only available if you have enabled a transactional publication for updatable subscriptions.</span></span> <span data-ttu-id="e1e7b-107">Per altre informazioni sull'abilitazione delle sottoscrizione aggiornabili, vedere [Abilitare le sottoscrizioni aggiornabili per le pubblicazioni transazionali](enable-updating-subscriptions-for-transactional-publications.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-107">For more information about enabling updatable subscriptions, see [Enable Updating Subscriptions for Transactional Publications](enable-updating-subscriptions-for-transactional-publications.md).</span></span>   
  
## <a name="configure-an-updatable-subscription-from-the-publisher"></a><span data-ttu-id="e1e7b-108">Configurare una sottoscrizione aggiornabile dal server di pubblicazione</span><span class="sxs-lookup"><span data-stu-id="e1e7b-108">Configure an updatable subscription from the Publisher</span></span>  

1. <span data-ttu-id="e1e7b-109">Connettersi al server di pubblicazione in Microsoft SQL Server Management Studio e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-109">Connect to the Publisher in Microsoft SQL Server Management Studio, and then expand the server node.</span></span>
2. <span data-ttu-id="e1e7b-110">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-110">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>
3. <span data-ttu-id="e1e7b-111">Fare clic col pulsante destro del mouse su una pubblicazione transazionale abilitata per l'aggiornamento di sottoscrizioni e quindi scegliere **Nuove sottoscrizioni**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-111">Right-click a transactional publication enabled for updating subscriptions, and then click **New Subscriptions**.</span></span>
4. <span data-ttu-id="e1e7b-112">Seguire i passaggi della procedura guidata per specificare le opzioni della sottoscrizione, ad esempio il server nel quale deve essere eseguito l'agente di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-112">Follow pages in the wizard to specify options for the subscription, such as where the Distribution Agent should run.</span></span>
5. <span data-ttu-id="e1e7b-113">Nella pagina **Sottoscrizioni aggiornabili** della **Creazione guidata nuova sottoscrizione** verificare che **Replica** sia selezionato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-113">On the **Updatable Subscriptions** page of the **New Subscription Wizard**, ensure **Replicate** is selected.</span></span>
6. <span data-ttu-id="e1e7b-114">Selezionare un'opzione nell'elenco a discesa **Commit nel server di pubblicazione**:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-114">Select an option from the **Commit at Publisher** drop-down list:</span></span>

    *  <span data-ttu-id="e1e7b-115">Per usare sottoscrizioni ad aggiornamento immediato, selezionare **Commit delle modifiche simultaneo**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-115">To use immediate updating subscriptions, select **Simultaneously commit changes**.</span></span> <span data-ttu-id="e1e7b-116">Se si seleziona questa opzione e la pubblicazione consente sottoscrizioni ad aggiornamento in coda (impostazione predefinita per le pubblicazioni create con la Creazione guidata nuova pubblicazione), la proprietà della sottoscrizione **update_mode** è impostata su **failover**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-116">If you select this option, and the publication allows queued updating subscriptions (the default for publications created with the New Publication Wizard), the subscription property **update_mode** is set to **failover**.</span></span> <span data-ttu-id="e1e7b-117">Questa modalità consente di passare all'aggiornamento in coda in un momento successivo se necessario.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-117">This mode allows you to switch to queued updating later if necessary.</span></span>
    *  <span data-ttu-id="e1e7b-118">Per usare sottoscrizioni ad aggiornamento in coda, selezionare **Accoda le modifiche ed esegui il commit appena possibile**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-118">To use queued updating subscriptions, select **Queue changes and commit when possible**.</span></span> <span data-ttu-id="e1e7b-119">Se si seleziona questa opzione e la pubblicazione consente sottoscrizioni ad aggiornamento immediato (impostazione predefinita per le pubblicazioni create con Creazione guidata nuova pubblicazione) e se il Sottoscrittore esegue SQL Server 2005 o versione successiva, la proprietà della sottoscrizione **update_mode** è impostata su queued failover.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-119">If you select this option, and the publication allows immediate updating subscriptions (the default for publications created with the New Publication Wizard), and the Subscriber is running SQL Server 2005 or a later version, the subscription property **update_mode** is set to queued failover.</span></span> <span data-ttu-id="e1e7b-120">Questa modalità consente di passare all'aggiornamento immediato in un momento successivo se necessario.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-120">This mode allows you to switch to immediate updating later if necessary.</span></span>

    <span data-ttu-id="e1e7b-121">Per altre informazioni su come cambiare modalità di aggiornamento, vedere [Passare da una modalità di aggiornamento all'altra per una sottoscrizione transazionale aggiornabile](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-121">For information about switching update modes, see [Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>

7. <span data-ttu-id="e1e7b-122">La pagina **Account di accesso per sottoscrizioni aggiornabili** viene visualizzata per le sottoscrizioni che usano l'aggiornamento immediato o la cui proprietà **update_mode** è impostata su **queued failover**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-122">The **Login for Updatable Subscriptions** page is displayed for subscriptions that use immediate updating or have **update_mode** set to **queued failover**.</span></span> <span data-ttu-id="e1e7b-123">Nella pagina **Account di accesso per sottoscrizioni aggiornabili** specificare un server collegato tramite il quale vengono eseguite le connessioni al server di pubblicazione per sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-123">On the **Login for Updatable Subscriptions** page, specify a linked server over which connections to the Publisher are made for immediate updating subscriptions.</span></span> <span data-ttu-id="e1e7b-124">Le connessioni vengono utilizzate dai trigger che si attivano presso il Sottoscrittore e propagano le modifiche al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-124">Connections are used by the triggers that fire at the Subscriber and propagate changes to the Publisher.</span></span> <span data-ttu-id="e1e7b-125">Selezionare una delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-125">Select one of the following options:</span></span>

    * <span data-ttu-id="e1e7b-126">**Crea un server collegato che stabilisce la connessione utilizzando l'autenticazione di SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-126">**Create a linked server that connects using SQL Server Authentication.**</span></span> <span data-ttu-id="e1e7b-127">Selezionare questa opzione se non è stato definito un server remoto o un server collegato tra il Sottoscrittore e il server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-127">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="e1e7b-128">Durante la replica verrà creato automaticamente un server collegato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-128">Replication creates a linked server for you.</span></span> <span data-ttu-id="e1e7b-129">È necessario che l'account specificato esista già nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-129">The account you specify must already exist at the Publisher.</span></span>
    * <span data-ttu-id="e1e7b-130">**Usa un server collegato o remoto già definito**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-130">**Use a linked server or remote server that you have already defined.**</span></span> <span data-ttu-id="e1e7b-131">Selezionare questa opzione se è stato definito un server remoto o un server collegato tra il Sottoscrittore e il server di pubblicazione tramite [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio o un altro metodo.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-131">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio, or another method.</span></span>

    <span data-ttu-id="e1e7b-132">Per informazioni sulle autorizzazioni necessarie per l'account di accesso al server collegato, vedere **Sottoscrizioni ad aggiornamento in coda** in [descrizione collegamento](../security/secure-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-132">For information about the permissions required by the linked server account, see the **Queued Updating Subscriptions** of [enter link description here](../security/secure-the-subscriber.md).</span></span>

8. <span data-ttu-id="e1e7b-133">Completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-133">Complete the wizard.</span></span>

## <a name="configure-an-updatable-subscription-from-the-subscriber"></a><span data-ttu-id="e1e7b-134">Configurare una sottoscrizione aggiornabile dal Sottoscrittore</span><span class="sxs-lookup"><span data-stu-id="e1e7b-134">Configure an updatable subscription from the Subscriber</span></span>


1. <span data-ttu-id="e1e7b-135">Connettersi al Sottoscrittore in SQL Server Management Studio e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-135">Connect to the Subscriber in SQL Server Management Studio, and then expand the server node.</span></span>
2. <span data-ttu-id="e1e7b-136">Espandere la cartella **Replica** .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-136">Expand the **Replication** folder.</span></span>
3. <span data-ttu-id="e1e7b-137">Fare clic col pulsante destro del mouse sulla cartella **Sottoscrizioni locali** e quindi scegliere **Nuove sottoscrizioni**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-137">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>
4. <span data-ttu-id="e1e7b-138">Nella pagina **Pubblicazione** della **Creazione guidata nuova sottoscrizione** selezionare **Trova server di pubblicazione SQL Server** nell'elenco a discesa **Server di pubblicazione**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-138">On the **Publication** page of the **New Subscription Wizard**, select **Find SQL Server Publisher** from the **Publisher** drop-down list.</span></span>
5. <span data-ttu-id="e1e7b-139">Connettersi al server di pubblicazione nella finestra di dialogo **Connetti a server** .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-139">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>
6. <span data-ttu-id="e1e7b-140">Nella pagina **Pubblicazione** selezionare una pubblicazione transazionale abilitata per l'aggiornamento di sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-140">Select a transactional publication enabled for updating subscriptions on the **Publication** page.</span></span>
7. <span data-ttu-id="e1e7b-141">Seguire i passaggi della procedura guidata per specificare le opzioni della sottoscrizione, ad esempio il server nel quale deve essere eseguito l'agente di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-141">Follow pages in the wizard to specify options for the subscription, such as where the Distribution Agent should run.</span></span>
8. <span data-ttu-id="e1e7b-142">Nella pagina **Sottoscrizioni aggiornabili** della Creazione guidata nuova sottoscrizione verificare che **Replica** sia selezionato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-142">On the **Updatable Subscriptions** page of the New Subscription Wizard, ensure **Replicate** is selected.</span></span>
9. <span data-ttu-id="e1e7b-143">Selezionare un'opzione nell'elenco a discesa **Commit nel server di pubblicazione**:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-143">Select an option from the **Commit at Publisher** drop-down list:</span></span>

    * <span data-ttu-id="e1e7b-144">Per usare sottoscrizioni ad aggiornamento immediato, selezionare **Commit delle modifiche simultaneo**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-144">To use immediate updating subscriptions, select **Simultaneously commit changes**.</span></span> <span data-ttu-id="e1e7b-145">Se si seleziona questa opzione e la pubblicazione consente sottoscrizioni ad aggiornamento in coda (impostazione predefinita per le pubblicazioni create con la Creazione guidata nuova pubblicazione), la proprietà della sottoscrizione **update_mode** è impostata su **failover**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-145">If you select this option, and the publication allows queued updating subscriptions (the default for publications created with the New Publication Wizard), the subscription property **update_mode** is set to **failover**.</span></span> <span data-ttu-id="e1e7b-146">Questa modalità consente di passare all'aggiornamento in coda in un momento successivo se necessario.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-146">This mode allows you to switch to queued updating later if necessary.</span></span>
    * <span data-ttu-id="e1e7b-147">Per usare sottoscrizioni ad aggiornamento in coda, selezionare **Accoda le modifiche ed esegui il commit appena possibile**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-147">To use queued updating subscriptions, select **Queue changes and commit when possible**.</span></span> <span data-ttu-id="e1e7b-148">Se si seleziona questa opzione e la pubblicazione consente sottoscrizioni ad aggiornamento immediato (impostazione predefinita per le pubblicazioni create con Creazione guidata nuova pubblicazione) e se il Sottoscrittore esegue SQL Server 2005 o versione successiva, la proprietà della sottoscrizione **update_mode** è impostata su **queued failover**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-148">If you select this option, and the publication allows immediate updating subscriptions (the default for publications created with the New Publication Wizard), and the Subscriber is running SQL Server 2005 or a later version, the subscription property **update_mode** is set to queued **failover**.</span></span> <span data-ttu-id="e1e7b-149">Questa modalità consente di passare all'aggiornamento immediato in un momento successivo se necessario.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-149">This mode allows you to switch to immediate updating later if necessary.</span></span>

    <span data-ttu-id="e1e7b-150">Per altre informazioni su come cambiare modalità di aggiornamento, vedere [Passare da una modalità di aggiornamento all'altra per una sottoscrizione transazionale aggiornabile](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-150">For information about switching update modes, see [Switch Between Update Modes for an Updatable Transactional Subscription](../administration/switch-between-update-modes-for-an-updatable-transactional-subscription.md).</span></span>

10. <span data-ttu-id="e1e7b-151">La pagina **Account di accesso per sottoscrizioni aggiornabili** viene visualizzata per le sottoscrizioni che usano l'aggiornamento immediato o la cui proprietà **update_mode** è impostata su **failover**.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-151">The **Login for Updatable Subscriptions** page is displayed for subscriptions that use immediate updating or have **update_mode** set to queued **failover**.</span></span> <span data-ttu-id="e1e7b-152">Nella pagina **Account di accesso per sottoscrizioni aggiornabili** specificare un server collegato tramite il quale vengono eseguite le connessioni al server di pubblicazione per sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-152">On the **Login for Updatable Subscriptions** page, specify a linked server over which connections to the Publisher are made for immediate updating subscriptions.</span></span> <span data-ttu-id="e1e7b-153">Le connessioni vengono utilizzate dai trigger che si attivano presso il Sottoscrittore e propagano le modifiche al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-153">Connections are used by the triggers that fire at the Subscriber and propagate changes to the Publisher.</span></span> <span data-ttu-id="e1e7b-154">Selezionare una delle opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-154">Select one of the following options:</span></span>

    * <span data-ttu-id="e1e7b-155">**Crea un server collegato che stabilisce la connessione utilizzando l'autenticazione di SQL Server.**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-155">**Create a linked server that connects using SQL Server Authentication.**</span></span> <span data-ttu-id="e1e7b-156">Selezionare questa opzione se non è stato definito un server remoto o un server collegato tra il Sottoscrittore e il server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-156">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="e1e7b-157">Durante la replica verrà creato automaticamente un server collegato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-157">Replication creates a linked server for you.</span></span> <span data-ttu-id="e1e7b-158">È necessario che l'account specificato esista già nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-158">The account you specify must already exist at the Publisher.</span></span>
    * <span data-ttu-id="e1e7b-159">**Usa un server collegato o remoto già definito**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-159">**Use a linked server or remote server that you have already defined.**</span></span> <span data-ttu-id="e1e7b-160">Selezionare questa opzione se è stato definito un server remoto o un server collegato tra il Sottoscrittore e il server di pubblicazione tramite [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio o un altro metodo.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-160">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), SQL Server Management Studio, or another method.</span></span>

    <span data-ttu-id="e1e7b-161">Per informazioni sulle autorizzazioni necessarie per l'account di accesso al server collegato, vedere **Sottoscrizioni ad aggiornamento in coda** in [descrizione collegamento](../security/secure-the-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-161">For information about the permissions required by the linked server account, see the **Queued Updating Subscriptions** of [enter link description here](../security/secure-the-subscriber.md).</span></span>

11. <span data-ttu-id="e1e7b-162">Completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-162">Complete the wizard.</span></span>

## <a name="create-an-immediate-updating-pull-subscription"></a><span data-ttu-id="e1e7b-163">Creare una sottoscrizione pull ad aggiornamento immediato</span><span class="sxs-lookup"><span data-stu-id="e1e7b-163">Create an immediate updating pull subscription</span></span>

1. <span data-ttu-id="e1e7b-164">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-164">At the Publisher, verify that the publication supports immediate updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-165">Se il valore di `allow_sync_tran` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-165">If the value of `allow_sync_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-166">Se il valore di `allow_sync_tran` nel set di risultati è `0`, sarà necessario creare nuovamente la pubblicazione abilitando le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-166">If the value of `allow_sync_tran` in the result set is `0`, the publication must be recreated with immediate updating subscriptions enabled.</span></span>

2. <span data-ttu-id="e1e7b-167">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-167">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-168">Se il valore di `allow_pull` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-168">If the value of `allow_pull` in the result set is `1`, the publication supports pull subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-169">Se il valore di `allow_pull` è `0`, eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specificando `allow_pull` per `@property` e `true` per `@value`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-169">If the value of `allow_pull` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_pull` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="e1e7b-170">Nel Sottoscrittore eseguire [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-170">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="e1e7b-171">Specificare `@publisher` e `@publication`, nonché uno dei seguenti valori per `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-171">Specify `@publisher` and `@publication`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="e1e7b-172">`sync tran` - abilita la sottoscrizione per l'aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-172">`sync tran` - enables the subscription for immediate updating.</span></span>
    * <span data-ttu-id="e1e7b-173">`failover` - abilita la sottoscrizione per l'aggiornamento immediato sostituito dall'aggiornamento in coda in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-173">`failover` - enables the subscription for immediate updating with queued updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-174">`failover` richiede che la pubblicazione sia abilitata anche per le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-174">`failover` requires that the publication also be enabled for queued updating subscriptions.</span></span> 
 
4. <span data-ttu-id="e1e7b-175">Nel Sottoscrittore eseguire [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-175">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e1e7b-176">Specificare le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-176">Specify the following:</span></span>

    * <span data-ttu-id="e1e7b-177">I parametri `@publisher`, `@publisher_db`e `@publication` .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-177">The `@publisher`, `@publisher_db`, and `@publication` parameters.</span></span> 
    * <span data-ttu-id="e1e7b-178">Le credenziali di Microsoft Windows per l'esecuzione dell'agente di distribuzione nel Sottoscrittore per `@job_login``@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-178">The Microsoft Windows credentials under which the Distribution Agent at the Subscriber runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-179">Per le connessioni attivate con l'autenticazione integrata di Windows vengono sempre usate le credenziali di Windows specificate da `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-179">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="e1e7b-180">L'agente di distribuzione attiva sempre la connessione locale al Sottoscrittore utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-180">The Distribution Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="e1e7b-181">Per impostazione predefinita, l'agente si connette al server di distribuzione con l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-181">By default, the agent connects to the Distributor using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="e1e7b-182">(Facoltativo) Il valore `0` per `@distributor_security_mode` e le informazioni sull'account di accesso di Microsoft SQL Server per `@distributor_login` e `@distributor_password`, se è necessario usare l'autenticazione di SQL Server per la connessione al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-182">(Optional) A value of `0` for `@distributor_security_mode` and the Microsoft SQL Server login information for `@distributor_login` and `@distributor_password`, if you need to use SQL Server Authentication when connecting to the Distributor.</span></span> 
    * <span data-ttu-id="e1e7b-183">Specificare una pianificazione per il processo dell'agente di distribuzione da eseguire per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-183">A schedule for the Distribution Agent job for this subscription.</span></span> 

5. <span data-ttu-id="e1e7b-184">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-184">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="e1e7b-185">Specificare `@publisher`, `@publication`, il nome del database di pubblicazione per `@publisher_db`e uno dei valori seguenti per `@security_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-185">Specify `@publisher`, `@publication`, the name of the publication database for `@publisher_db`, and one of the following values for `@security_mode`:</span></span> 

    * <span data-ttu-id="e1e7b-186">`0` - Usare l'autenticazione di SQL Server quando si eseguono aggiornamenti nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-186">`0` - Use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="e1e7b-187">Questa opzione richiede di specificare un account di accesso valido nel server di pubblicazione per `@login` e `@password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-187">This option requires you to specify a valid login at the Publisher for `@login` and `@password`.</span></span>
    * <span data-ttu-id="e1e7b-188">`1` - Usare il contesto di sicurezza dell'utente che esegue le modifiche nel Sottoscrittore quando ci si connette al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-188">`1` - Use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="e1e7b-189">Per informazioni sulle restrizioni correlate a questa modalità di sicurezza, vedere [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-189">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>
    * <span data-ttu-id="e1e7b-190">`2` - Usare un account di accesso esistente e definito dall'utente per il server collegato, creato con [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-190">`2` - Use an existing, user-defined linked server login created using [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>

6. <span data-ttu-id="e1e7b-191">Nel server di pubblicazione eseguire [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) specificando `@publication`, `@subscriber`, `@destination_db`, il valore pull per `@subscription_type`e lo stesso valore specificato al passaggio 3 per `@update_mode`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-191">At the publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) specifying `@publication`, `@subscriber`, `@destination_db`, a value of pull for `@subscription_type`, and the same value specified in step 3 for `@update_mode`.</span></span>

<span data-ttu-id="e1e7b-192">La sottoscrizione pull verrà registrata nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-192">This registers the pull subscription at the Publisher.</span></span> 


## <a name="create-an-immediate-updating-push-subscription"></a><span data-ttu-id="e1e7b-193">Creare una sottoscrizione push ad aggiornamento immediato</span><span class="sxs-lookup"><span data-stu-id="e1e7b-193">Create an immediate updating push subscription</span></span> 

1. <span data-ttu-id="e1e7b-194">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-194">At the Publisher, verify that the publication supports immediate updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-195">Se il valore di `allow_sync_tran` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-195">If the value of `allow_sync_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-196">Se il valore di `allow_sync_tran` nel set di risultati è `0`, sarà necessario creare nuovamente la pubblicazione abilitando le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-196">If the value of `allow_sync_tran` in the result set is `0`, the publication must be recreated with immediate updating subscriptions enabled.</span></span>

2. <span data-ttu-id="e1e7b-197">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni push.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-197">At the Publisher, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-198">Se il valore di `allow_push` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni push.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-198">If the value of `allow_push` in the result set is `1`, the publication supports push subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-199">Se il valore di `allow_push` è `0`, eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specificando `allow_push` per `@property` e `true` per `@value`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-199">If the value of `allow_push` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_push` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="e1e7b-200">Nel server di pubblicazione eseguire [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-200">At the Publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="e1e7b-201">Specificare `@publication`, `@subscriber`, `@destination_db`, nonché uno dei seguenti valori per `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-201">Specify `@publication`, `@subscriber`, `@destination_db`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="e1e7b-202">`sync tran` - abilita il supporto per l'aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-202">`sync tran` - enables support for immediate updating.</span></span>
    * <span data-ttu-id="e1e7b-203">`failover` - abilita il supporto per l'aggiornamento immediato sostituito dall'aggiornamento in coda in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-203">`failover` - enables support for immediate updating with queued updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-204">`failover` richiede che la pubblicazione sia abilitata anche per le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-204">`failover` requires that the publication also be enabled for queued updating subscriptions.</span></span> 
 
4. <span data-ttu-id="e1e7b-205">Nel server di pubblicazione eseguire [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-205">At the Publisher, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e1e7b-206">Specificare i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-206">Specify the following parameters:</span></span>

    * <span data-ttu-id="e1e7b-207">`@subscriber`, `@subscriber_db`e `@publication`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-207">`@subscriber`, `@subscriber_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="e1e7b-208">Le credenziali di Windows usate per eseguire l'agente di distribuzione nel server di distribuzione per `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-208">The Windows credentials under which the Distribution Agent at the Distributor runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-209">Per le connessioni attivate con l'autenticazione integrata di Windows vengono sempre usate le credenziali di Windows specificate da `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-209">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="e1e7b-210">L'agente di distribuzione esegue sempre la connessione locale al server di distribuzione utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-210">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="e1e7b-211">Per impostazione predefinita, l'agente si connette al Sottoscrittore utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-211">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span> 

    * <span data-ttu-id="e1e7b-212">(Facoltativo) Il valore `0` per `@subscriber_security_mode` e le informazioni sull'account di accesso di SQL Server per `@subscriber_login` e `@subscriber_password`, se è necessario usare l'autenticazione di SQL Server per la connessione al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-212">(Optional) A value of `0` for `@subscriber_security_mode` and the SQL Server login information for `@subscriber_login` and `@subscriber_password`, if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span> 
    * <span data-ttu-id="e1e7b-213">Specificare una pianificazione per il processo dell'agente di distribuzione da eseguire per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-213">A schedule for the Distribution Agent job for this subscription.</span></span>

5. <span data-ttu-id="e1e7b-214">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-214">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="e1e7b-215">Specificare `@publisher`, `@publication`, il nome del database di pubblicazione per `@publisher_db`e uno dei valori seguenti per `@security_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-215">Specify `@publisher`, `@publication`, the name of the publication database for `@publisher_db`, and one of the following values for `@security_mode`:</span></span> 

     * <span data-ttu-id="e1e7b-216">`0` - Usare l'autenticazione di SQL Server quando si eseguono aggiornamenti nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-216">`0` - Use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="e1e7b-217">Questa opzione richiede di specificare un account di accesso valido nel server di pubblicazione per `@login` e `@password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-217">This option requires you to specify a valid login at the Publisher for `@login` and `@password`.</span></span>
     * <span data-ttu-id="e1e7b-218">`1` - Usare il contesto di sicurezza dell'utente che esegue le modifiche nel Sottoscrittore quando ci si connette al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-218">`1` - Use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="e1e7b-219">Per informazioni sulle restrizioni correlate a questa modalità di sicurezza, vedere [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-219">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>
     * <span data-ttu-id="e1e7b-220">`2` - Usare un account di accesso esistente e definito dall'utente per il server collegato, creato con [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-220">`2` - Use an existing, user-defined linked server login created using [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>


## <a name="create-a-queued-updating-pull-subscription"></a><span data-ttu-id="e1e7b-221">Creare una sottoscrizione pull ad aggiornamento in coda</span><span class="sxs-lookup"><span data-stu-id="e1e7b-221">Create a queued updating pull subscription</span></span> ##

1. <span data-ttu-id="e1e7b-222">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-222">At the Publisher, verify that the publication supports queued updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-223">Se il valore di `allow_queued_tran` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-223">If the value of `allow_queued_tran` in the result set is `1`, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-224">Se il valore di `allow_queued_tran` nel set di risultati è `0`, sarà necessario creare nuovamente la pubblicazione abilitando le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-224">If the value of `allow_queued_tran` in the result set is `0`, the publication must be recreated with queued updating subscriptions enabled.</span></span>

2. <span data-ttu-id="e1e7b-225">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-225">At the Publisher, verify that the publication supports pull subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-226">Se il valore di `allow_pull` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-226">If the value of `allow_pull` in the result set is `1`, the publication supports pull subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-227">Se il valore di `allow_pull` è `0`, eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specificando `allow_pull` per `@property` e `true` per `@value`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-227">If the value of `allow_pull` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying `allow_pull` for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="e1e7b-228">Nel Sottoscrittore eseguire [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-228">At the Subscriber, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="e1e7b-229">Specificare `@publisher` e `@publication`, nonché uno dei seguenti valori per `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-229">Specify `@publisher` and `@publication`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="e1e7b-230">`queued tran` - abilita la sottoscrizione per l'aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-230">`queued tran` - enables the subscription for queued updating.</span></span>
    * <span data-ttu-id="e1e7b-231">`queued failover` - abilita il supporto per l'aggiornamento in coda sostituito dall'aggiornamento immediato in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-231">`queued failover` - enables support for queued updating with immediate updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-232">`queued failover` richiede che la pubblicazione sia abilitata anche per le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-232">`queued failover` requires that the publication also be enabled for immediate updating subscriptions.</span></span> <span data-ttu-id="e1e7b-233">Per eseguire il failover all'aggiornamento immediato, è necessario usare [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) per definire le credenziali con cui replicare nel server di pubblicazione le modifiche apportate al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-233">To fail over to immediate updating, you must use [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) to define the credentials under which changes at the Subscriber are replicated to the Publisher.</span></span>
 
4. <span data-ttu-id="e1e7b-234">Nel Sottoscrittore eseguire [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-234">At the Subscriber, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e1e7b-235">Specificare i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-235">Specify the following parameters:</span></span>

    * <span data-ttu-id="e1e7b-236">@publisher, `@publisher_db`e `@publication`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-236">@publisher, `@publisher_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="e1e7b-237">Le credenziali di Windows per l'esecuzione dell'agente di distribuzione nel Sottoscrittore per `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-237">The Windows credentials under which the Distribution Agent at the Subscriber runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-238">Per le connessioni attivate con l'autenticazione integrata di Windows vengono sempre usate le credenziali di Windows specificate da `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-238">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="e1e7b-239">L'agente di distribuzione attiva sempre la connessione locale al Sottoscrittore utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-239">The Distribution Agent always makes the local connection to the Subscriber using Windows Integrated Authentication.</span></span> <span data-ttu-id="e1e7b-240">Per impostazione predefinita, l'agente si connette al server di distribuzione con l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-240">By default, the agent connects to the Distributor using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="e1e7b-241">(Facoltativo) Il valore `0` per `@distributor_security_mode` e le informazioni sull'account di accesso di SQL Server per `@distributor_login` e `@distributor_password`, se è necessario usare l'autenticazione di SQL Server per la connessione al server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-241">(Optional) A value of `0` for `@distributor_security_mode` and the SQL Server login information for `@distributor_login` and `@distributor_password`, if you need to use SQL Server Authentication when connecting to the Distributor.</span></span> 
    * <span data-ttu-id="e1e7b-242">Specificare una pianificazione per il processo dell'agente di distribuzione da eseguire per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-242">A schedule for the Distribution Agent job for this subscription.</span></span>

5. <span data-ttu-id="e1e7b-243">Nel server di pubblicazione eseguire [sp_addsubscriber](/sql/relational-databases/system-stored-procedures/sp-addsubscriber-transact-sql) per registrare il Sottoscrittore nel server di pubblicazione specificando `@publication`, `@subscriber`, `@destination_db`, il valore pull per `@subscription_type`e lo stesso valore specificato al passaggio 3 per `@update_mode`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-243">At the publisher, execute [sp_addsubscriber](/sql/relational-databases/system-stored-procedures/sp-addsubscriber-transact-sql) to register the Subscriber at the Publisher, specifying `@publication`, `@subscriber`, `@destination_db`, a value of pull for `@subscription_type`, and the same value specified in step 3 for `@update_mode`.</span></span>

<span data-ttu-id="e1e7b-244">La sottoscrizione pull verrà registrata nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-244">This registers the pull subscription at the Publisher.</span></span> 


## <a name="to-create-a-queued-updating-push-subscription"></a><span data-ttu-id="e1e7b-245">Per creare una sottoscrizione push ad aggiornamento in coda</span><span class="sxs-lookup"><span data-stu-id="e1e7b-245">To create a queued updating push subscription</span></span> ##

1. <span data-ttu-id="e1e7b-246">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-246">At the Publisher, verify that the publication supports queued updating subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-247">Se il valore di allow_queued_tran nel set di risultati è 1, la pubblicazione supporta le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-247">If the value of allow_queued_tran in the result set is 1, the publication supports immediate updating subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-248">Se il valore di allow_queued_tran nel set di risultati è 0, sarà necessario creare nuovamente la pubblicazione abilitando le sottoscrizioni ad aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-248">If the value of allow_queued_tran in the result set is 0, the publication must be recreated with queued updating subscriptions enabled.</span></span> <span data-ttu-id="e1e7b-249">Per altre informazioni, vedere Procedura: Abilitare le sottoscrizioni aggiornabili per le pubblicazioni transazionali (Programmazione Transact-SQL della replica).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-249">For more information, see How to: Enable Updating Subscriptions for Transactional Publications (Replication Transact-SQL Programming).</span></span>

2. <span data-ttu-id="e1e7b-250">Nel server di pubblicazione eseguire [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)per verificare che la pubblicazione supporti le sottoscrizioni push.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-250">At the Publisher, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span> 

    * <span data-ttu-id="e1e7b-251">Se il valore di `allow_push` nel set di risultati è `1`, la pubblicazione supporta le sottoscrizioni push.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-251">If the value of `allow_push` in the result set is `1`, the publication supports push subscriptions.</span></span>
    * <span data-ttu-id="e1e7b-252">Se il valore di `allow_push` è `0`, eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specificando allow_push per `@property` e `true` per `@value`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-252">If the value of `allow_push` is `0`, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying allow_push for `@property` and `true` for `@value`.</span></span> 

3. <span data-ttu-id="e1e7b-253">Nel server di pubblicazione eseguire [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-253">At the Publisher, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="e1e7b-254">Specificare `@publication`, `@subscriber`, `@destination_db`, nonché uno dei seguenti valori per `@update_mode`:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-254">Specify `@publication`, `@subscriber`, `@destination_db`, and one of the following values for `@update_mode`:</span></span>

    * <span data-ttu-id="e1e7b-255">`queued tran` - abilita la sottoscrizione per l'aggiornamento in coda.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-255">`queued tran` - enables the subscription for queued updating.</span></span>
    * <span data-ttu-id="e1e7b-256">`queued failover` - abilita il supporto per l'aggiornamento in coda sostituito dall'aggiornamento immediato in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-256">`queued failover` - enables support for queued updating with immediate updating as a failover option.</span></span>

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-257">Con l'opzione queued failover è necessario che la pubblicazione sia abilitata anche per le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-257">The queued failover option requires that the publication also be enabled for immediate updating subscriptions.</span></span> <span data-ttu-id="e1e7b-258">Per eseguire il failover all'aggiornamento immediato, è necessario usare [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) per definire le credenziali con cui replicare nel server di pubblicazione le modifiche apportate al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-258">To fail over to immediate updating, you must use [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) to define the credentials under which changes at the Subscriber are replicated to the Publisher.</span></span>

4. <span data-ttu-id="e1e7b-259">Nel server di pubblicazione eseguire [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-259">At the Publisher, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="e1e7b-260">Specificare i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-260">Specify the following parameters:</span></span>

    * <span data-ttu-id="e1e7b-261">`@subscriber`, `@subscriber_db`e `@publication`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-261">`@subscriber`, `@subscriber_db`, and `@publication`.</span></span> 
    * <span data-ttu-id="e1e7b-262">Le credenziali di Windows usate per eseguire l'agente di distribuzione nel server di distribuzione per `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-262">The Windows credentials under which the Distribution Agent at the Distributor runs for `@job_login` and `@job_password`.</span></span> 

    > [!NOTE]  
>  <span data-ttu-id="e1e7b-263">Per le connessioni attivate con l'autenticazione integrata di Windows vengono sempre usate le credenziali di Windows specificate da `@job_login` e `@job_password`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-263">Connections made using Windows Integrated Authentication are always made using the Windows credentials specified by `@job_login` and `@job_password`.</span></span> <span data-ttu-id="e1e7b-264">L'agente di distribuzione esegue sempre la connessione locale al server di distribuzione utilizzando l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-264">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="e1e7b-265">Per impostazione predefinita, l'agente si connette al Sottoscrittore con l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-265">By default, the agent connects to the Subscriber using Windows Integrated Authentication.</span></span> 
 
    * <span data-ttu-id="e1e7b-266">(Facoltativo) Il valore `0` per `@subscriber_security_mode` e le informazioni sull'account di accesso di SQL Server per `@subscriber_login` e `@subscriber_password`, se è necessario usare l'autenticazione di SQL Server per la connessione al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-266">(Optional) A value of `0` for `@subscriber_security_mode` and the SQL Server login information for `@subscriber_login` and `@subscriber_password`, if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span> 
    * <span data-ttu-id="e1e7b-267">Specificare una pianificazione per il processo dell'agente di distribuzione da eseguire per la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-267">A schedule for the Distribution Agent job for this subscription.</span></span>


## <a name="example"></a><span data-ttu-id="e1e7b-268">Esempio</span><span class="sxs-lookup"><span data-stu-id="e1e7b-268">Example</span></span> ##

<span data-ttu-id="e1e7b-269">In questo esempio viene creata una sottoscrizione pull ad aggiornamento immediata di una pubblicazione che supporta le sottoscrizioni ad aggiornamento immediato.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-269">This example creates an immediate updating pull subscription to a publication that supports immediate updating subscriptions.</span></span> <span data-ttu-id="e1e7b-270">I valori per l'account di accesso e la relativa password vengono specificati in fase di esecuzione tramite variabili di scripting sqlcmd.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-270">Login and password values are supplied at runtime using sqlcmd scripting variables.</span></span>

> [!NOTE]  
>  <span data-ttu-id="e1e7b-271">Questo script usa le variabili di scripting di sqlcmd,</span><span class="sxs-lookup"><span data-stu-id="e1e7b-271">This script uses sqlcmd scripting variables.</span></span> <span data-ttu-id="e1e7b-272">nel formato `$(MyVariable)`.</span><span class="sxs-lookup"><span data-stu-id="e1e7b-272">They are in the form `$(MyVariable)`.</span></span> <span data-ttu-id="e1e7b-273">Per informazioni su come usare le variabili di scripting nella riga di comando e in SQL Server Management Studio, vedere la sezione **Esecuzione di script di replica** nell'argomento [Concetti di base relativi alle stored procedure del sistema di replica](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-273">For information about how to use scripting variables on the command line and in SQL Server Management Studio, see the **Executing Replication Scripts** section in the topic [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>

```sql
-- Execute this batch at the Subscriber.
DECLARE @publication AS sysname;
DECLARE @publicationDB AS sysname;
DECLARE @publisher AS sysname;
DECLARE @login AS sysname;
DECLARE @password AS nvarchar(512);
SET @publication = N'AdvWorksProductTran';
SET @publicationDB = N'AdventureWorks2008R2';
SET @publisher = $(PubServer);
SET @login = $(Login);
SET @password = $(Password);

-- At the subscription database, create a pull subscription to a transactional 
-- publication using immediate updating with queued updating as a failover.
EXEC sp_addpullsubscription 
    @publisher = @publisher, 
    @publication = @publication, 
    @publisher_db = @publicationDB, 
    @update_mode = N'failover', 
    @subscription_type = N'pull';

-- Add an agent job to synchronize the pull subscription, 
-- which uses Windows Authentication when connecting to the Distributor.
EXEC sp_addpullsubscription_agent 
    @publisher = @publisher, 
    @publisher_db = @publicationDB, 
    @publication = @publication,
    @job_login = @login,
    @job_password = @password; 

-- Add a Windows Authentication-based linked server that enables the 
-- Subscriber-side triggers to make updates at the Publisher. 
EXEC sp_link_publication 
    @publisher = @publisher, 
    @publication = @publication,
    @publisher_db = @publicationDB, 
    @security_mode = 0,
    @login = @login,
    @password = @password;
GO

USE AdventureWorks2008R2;
GO

-- Execute this batch at the Publisher.
DECLARE @publication AS sysname;
DECLARE @subscriptionDB AS sysname;
DECLARE @subscriber AS sysname;
SET @publication = N'AdvWorksProductTran'; 
SET @subscriptionDB = N'AdventureWorks2008R2Replica'; 
SET @subscriber = $(SubServer);

-- At the Publisher, register the subscription, using the defaults.
USE [AdventureWorks2008R2]
EXEC sp_addsubscription 
    @publication = @publication, 
    @subscriber = @subscriber, 
    @destination_db = @subscriptionDB, 
    @subscription_type = N'pull', 
    @update_mode = N'failover';
GO
```

## <a name="set-queued-updating-conflict-resolution-options-sql-server-management-studio"></a><span data-ttu-id="e1e7b-274">Impostazione delle opzioni di risoluzione dei conflitti per l'aggiornamento in coda (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="e1e7b-274">Set Queued Updating Conflict Resolution Options (SQL Server Management Studio)</span></span>
  <span data-ttu-id="e1e7b-275">Per impostare le opzioni di risoluzione dei conflitti per le pubblicazioni che supportano sottoscrizioni ad aggiornamento in coda, usare la pagina **Opzioni sottoscrizione** della finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="e1e7b-275">Set conflict resolution options for publications that support queued updating subscriptions on the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="e1e7b-276">Per ulteriori informazioni sull'accesso a questa finestra di dialogo, vedere [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="e1e7b-276">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
### <a name="to-set-queued-updating-conflict-resolution-options"></a><span data-ttu-id="e1e7b-277">Per impostare le opzioni di risoluzione dei conflitti per l'aggiornamento in coda</span><span class="sxs-lookup"><span data-stu-id="e1e7b-277">To set queued updating conflict resolution options</span></span>  
  
1.  <span data-ttu-id="e1e7b-278">Nella pagina **Opzioni sottoscrizione** della finestra di dialogo **Proprietà pubblicazione - \<Publication>** selezionare uno dei valori seguenti per l'opzione **Criteri di risoluzione dei conflitti**:</span><span class="sxs-lookup"><span data-stu-id="e1e7b-278">On the **Subscription Options** page of the **Publication Properties - \<Publication>** dialog box, select one of the following values for the **Conflict resolution policy** option:</span></span>    
    -   <span data-ttu-id="e1e7b-279">**Mantieni la modifica del server di pubblicazione**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-279">**Keep the Publisher change**</span></span>    
    -   <span data-ttu-id="e1e7b-280">**Mantieni la modifica del Sottoscrittore**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-280">**Keep the Subscriber change**</span></span>    
    -   <span data-ttu-id="e1e7b-281">**Reinizializza la sottoscrizione**</span><span class="sxs-lookup"><span data-stu-id="e1e7b-281">**Reinitialize the subscription**</span></span>    
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  

## <a name="see-also"></a><span data-ttu-id="e1e7b-282">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e1e7b-282">See Also</span></span> ##
 <span data-ttu-id="e1e7b-283">[Create a Publication](create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="e1e7b-283">[Create a Publication](create-a-publication.md) </span></span>  
 <span data-ttu-id="e1e7b-284">[Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md) </span><span class="sxs-lookup"><span data-stu-id="e1e7b-284">[Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md) </span></span>  
 [<span data-ttu-id="e1e7b-285">Utilizzo di sqlcmd con variabili di scripting</span><span class="sxs-lookup"><span data-stu-id="e1e7b-285">Use sqlcmd with Scripting Variables</span></span>](../../scripting/sqlcmd-use-with-scripting-variables.md)   

  
