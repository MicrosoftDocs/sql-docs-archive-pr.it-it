---
title: Gestire le partizioni di una pubblicazione di tipo merge con filtri con parametri | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- partitions [SQL Server replication]
- merge replication partitions [SQL Server replication], SQL Server Management Studio
- parameterized filters [SQL Server replication], partition management
ms.assetid: fb5566fe-58c5-48f7-8464-814ea78e6221
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 983b02865c0564919259f896bf09d8bdb0cd969f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624040"
---
# <a name="manage-partitions-for-a-merge-publication-with-parameterized-filters"></a><span data-ttu-id="9c80e-102">Gestione delle partizioni di una pubblicazione di tipo merge con filtri con parametri</span><span class="sxs-lookup"><span data-stu-id="9c80e-102">Manage Partitions for a Merge Publication with Parameterized Filters</span></span>
  <span data-ttu-id="9c80e-103">In questo argomento viene descritto come gestire le partizioni per una pubblicazione di tipo merge con i filtri con parametri in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]o Replication Management Objects (RMO).</span><span class="sxs-lookup"><span data-stu-id="9c80e-103">This topic describes how to manage partitions for a merge publication with parameterized filters in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="9c80e-104">È possibile utilizzare i filtri di riga con parametri per generare partizioni non sovrapposte.</span><span class="sxs-lookup"><span data-stu-id="9c80e-104">Parameterized row filters can be used to generate nonoverlapping partitions.</span></span> <span data-ttu-id="9c80e-105">È possibile limitare tali partizioni in modo che solo una sottoscrizione riceva una determinata partizione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-105">These partitions can be restricted so that only one subscription receives a given partition.</span></span> <span data-ttu-id="9c80e-106">In questi casi, la presenza di un numero elevato di Sottoscrittori comporta un numero elevato di partizioni, che richiedono anche un numero uguale di snapshot partizionati.</span><span class="sxs-lookup"><span data-stu-id="9c80e-106">In these cases, a large number of subscribers will result in a large number of partitions, which in turn requires an equal number of partitioned snapshots.</span></span> <span data-ttu-id="9c80e-107">Per altre informazioni sui filtri di riga con parametri, vedere [Filtri di riga con parametri](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-107">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="9c80e-108">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="9c80e-108">**In This Topic**</span></span>  
  
-   <span data-ttu-id="9c80e-109">**Prima di iniziare:**</span><span class="sxs-lookup"><span data-stu-id="9c80e-109">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="9c80e-110">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="9c80e-110">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="9c80e-111">**Per gestire le partizioni di una pubblicazione di tipo merge con filtri con parametri, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="9c80e-111">**To manage partitions for a merge publication with parameterized filters, using:**</span></span>  
  
     [<span data-ttu-id="9c80e-112">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="9c80e-112">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="9c80e-113">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9c80e-113">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="9c80e-114">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="9c80e-114">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="9c80e-115">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="9c80e-115">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="9c80e-116">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="9c80e-116">Recommendations</span></span>  
  
-   <span data-ttu-id="9c80e-117">Se si crea, come consigliato, uno script per la topologia di replica, gli script di pubblicazione contengono le chiamate di stored procedure necessarie per creare le partizioni di dati.</span><span class="sxs-lookup"><span data-stu-id="9c80e-117">If you script a replication topology, which is recommended, publication scripts contain the stored procedure calls to create data partitions.</span></span> <span data-ttu-id="9c80e-118">Lo script offre un riferimento per le partizioni create e un modo per ricreare, se necessario, una o più partizioni.</span><span class="sxs-lookup"><span data-stu-id="9c80e-118">The script provides a reference for the partitions created and a way in which to re-create one or more partitions if necessary.</span></span> <span data-ttu-id="9c80e-119">Per altre informazioni, vedere [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-119">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
-   <span data-ttu-id="9c80e-120">Se una pubblicazione contiene filtri con parametri che producono sottoscrizioni con partizioni non sovrapposte ed è necessario ricreare un'eventuale sottoscrizione persa, rimuovere la partizione sottoscritta, ricreare la sottoscrizione, quindi ricreare la partizione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-120">When a publication has parameterized filters that yield subscriptions with nonoverlapping partitions, and if a particular subscription is lost and needs to be re-created, you must do the following: remove the partition that was subscribed to, re-create the subscription, and then re-create the partition.</span></span> <span data-ttu-id="9c80e-121">Per altre informazioni sui filtri di riga con parametri, vedere [Filtri di riga con parametri](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-121">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span> <span data-ttu-id="9c80e-122">La replica genera script di creazione per le partizioni del Sottoscrittore esistenti al momento della generazione di uno script per la creazione della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-122">Replication generates creation scripts for existing Subscriber partitions when a publication creation script is generated.</span></span> <span data-ttu-id="9c80e-123">Per altre informazioni, vedere [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-123">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="9c80e-124">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="9c80e-124">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="9c80e-125">Gestire le partizioni nella pagina **Partizioni dati** della finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="9c80e-125">Manage partitions on the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="9c80e-126">Per ulteriori informazioni sull'accesso a questa finestra di dialogo, vedere [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-126">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span> <span data-ttu-id="9c80e-127">In questa pagina è possibile creare ed eliminare partizioni, consentire ai Sottoscrittori di avviare la generazione e il recapito di snapshot, generare snapshot per una o più partizioni ed eliminare snapshot.</span><span class="sxs-lookup"><span data-stu-id="9c80e-127">On this page you can: create and delete partitions; allow Subscribers to initiate snapshot generation and delivery; generate snapshots for one or more partitions; and clean up snapshots.</span></span>  
  
#### <a name="to-create-a-partition"></a><span data-ttu-id="9c80e-128">Per creare una partizione</span><span class="sxs-lookup"><span data-stu-id="9c80e-128">To create a partition</span></span>  
  
1.  <span data-ttu-id="9c80e-129">Nella pagina **Partizioni dati** della finestra di dialogo **Proprietà pubblicazione - \<Publication>** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-129">On the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box, click **Add**.</span></span>  
  
2.  <span data-ttu-id="9c80e-130">Nella finestra di dialogo **Aggiungi partizione dati** immettere un valore per **HOST_NAME()** e/o un valore **SUSER_SNAME()** associato alla partizione che si desidera creare.</span><span class="sxs-lookup"><span data-stu-id="9c80e-130">In the **Add Data Partition** dialog box, enter a value for the **HOST_NAME()** and/or **SUSER_SNAME()** value associated with the partition you want to create.</span></span>  
  
3.  <span data-ttu-id="9c80e-131">Facoltativamente, specificare una pianificazione per l'aggiornamento degli snapshot:</span><span class="sxs-lookup"><span data-stu-id="9c80e-131">Optionally specify a schedule for refreshing snapshots:</span></span>  
  
    1.  <span data-ttu-id="9c80e-132">Selezionare **Usa la pianificazione seguente per l'esecuzione dell'agente snapshot per questa partizione**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-132">Select **Schedule the Snapshot Agent for this partition to run at the following time(s)**</span></span>  
  
    2.  <span data-ttu-id="9c80e-133">Accettare la pianificazione predefinita per l'aggiornamento degli snapshot oppure fare clic su **Cambia** per specificare una pianificazione diversa.</span><span class="sxs-lookup"><span data-stu-id="9c80e-133">Accept the default schedule for refreshing snapshots, or click **Change** to specify a different schedule.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="9c80e-134">Per eliminare una partizione</span><span class="sxs-lookup"><span data-stu-id="9c80e-134">To delete a partition</span></span>  
  
1.  <span data-ttu-id="9c80e-135">Nella pagina **Partizioni dati** selezionare una partizione della griglia.</span><span class="sxs-lookup"><span data-stu-id="9c80e-135">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="9c80e-136">Fare clic su **Elimina**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-136">Click **Delete**.</span></span>  
  
#### <a name="to-allow-subscribers-to-initiate-snapshot-generation-and-delivery"></a><span data-ttu-id="9c80e-137">Per consentire ai Sottoscrittori di avviare la generazione e il recapito di snapshot</span><span class="sxs-lookup"><span data-stu-id="9c80e-137">To allow Subscribers to initiate snapshot generation and delivery</span></span>  
  
1.  <span data-ttu-id="9c80e-138">Nella pagina **Partizioni dati** selezionare **Definisci automaticamente una partizione e genera uno snapshot, se necessario, quando un nuovo Sottoscrittore cerca di eseguire la sincronizzazione**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-138">On the **Data Partitions** page, select **Automatically define a partition and generate a snapshot if needed when a new Subscriber tries to synchronize**.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-generate-a-snapshot-for-a-partition"></a><span data-ttu-id="9c80e-139">Per generare lo snapshot di una partizione</span><span class="sxs-lookup"><span data-stu-id="9c80e-139">To generate a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="9c80e-140">Nella pagina **Partizioni dati** selezionare una partizione della griglia.</span><span class="sxs-lookup"><span data-stu-id="9c80e-140">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="9c80e-141">Fare clic su **Genera gli snapshot selezionati adesso**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-141">Click **Generate the selected snapshots now**.</span></span>  
  
#### <a name="to-clean-up-a-snapshot-for-a-partition"></a><span data-ttu-id="9c80e-142">Per eliminare lo snapshot di una partizione</span><span class="sxs-lookup"><span data-stu-id="9c80e-142">To clean up a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="9c80e-143">Nella pagina **Partizioni dati** selezionare una partizione della griglia.</span><span class="sxs-lookup"><span data-stu-id="9c80e-143">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="9c80e-144">Fare clic su **Elimina gli snapshot esistenti**.</span><span class="sxs-lookup"><span data-stu-id="9c80e-144">Click **Clean up the existing snapshots**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="9c80e-145">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9c80e-145">Using Transact-SQL</span></span>  
 <span data-ttu-id="9c80e-146">Per migliorare la gestione di una pubblicazione con filtri con parametri, è possibile enumerare le partizioni esistenti a livello di programmazione, utilizzando stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="9c80e-146">To better manage a publication with parameterized filters, you can programmatically enumerate the existing partitions using replication stored procedures.</span></span> <span data-ttu-id="9c80e-147">È inoltre possibile creare ed eliminare le partizioni esistenti.</span><span class="sxs-lookup"><span data-stu-id="9c80e-147">You can also create and delete existing partitions.</span></span> <span data-ttu-id="9c80e-148">È possibile ottenere le informazioni seguenti sulle partizioni esistenti:</span><span class="sxs-lookup"><span data-stu-id="9c80e-148">The following information on existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="9c80e-149">Modalità in cui una partizione viene filtrata (tramite [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) o [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="9c80e-149">How a partition is filtered (using [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) or [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span></span>  
  
-   <span data-ttu-id="9c80e-150">Nome del processo che genera uno snapshot partizionato.</span><span class="sxs-lookup"><span data-stu-id="9c80e-150">The name of the job that generates a partitioned snapshot.</span></span>  
  
-   <span data-ttu-id="9c80e-151">Ora dell'ultima esecuzione di un processo di snapshot partizionato.</span><span class="sxs-lookup"><span data-stu-id="9c80e-151">The last time that a partitioned snapshot job ran.</span></span>  
  
 <span data-ttu-id="9c80e-152">Mentre la seconda parte dello snapshot a due parti può essere generata su richiesta quando viene inizializzata una nuova sottoscrizione, le procedure descritte di seguito consentono di controllare il modo in cui tale snapshot viene generato e di effettuare la pregenerazione dello snapshot nel momento più appropriato.</span><span class="sxs-lookup"><span data-stu-id="9c80e-152">While the second part of the two-part snapshot can be generated on-demand when a new subscription is initialized, the procedures below enable you to control how this snapshot is generated and to pre-generate this snapshot when it is most convenient.</span></span> <span data-ttu-id="9c80e-153">Per altre informazioni, vedere [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-153">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="9c80e-154">Per visualizzare informazioni sulle partizioni esistenti</span><span class="sxs-lookup"><span data-stu-id="9c80e-154">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="9c80e-155">Nel database di pubblicazione del server di pubblicazione eseguire [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-155">At the Publisher on the publication database, execute [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span></span> <span data-ttu-id="9c80e-156">Consente di specificare il nome della pubblicazione per la \*\* \@ pubblicazione\*\*.</span><span class="sxs-lookup"><span data-stu-id="9c80e-156">Specify the name of the publication for **\@publication**.</span></span> <span data-ttu-id="9c80e-157">Opzionale Specificare \*\* \@ suser_sname\*\* o \*\* \@ HOST_NAME\*\* per restituire solo le informazioni basate su un solo criterio di filtro.</span><span class="sxs-lookup"><span data-stu-id="9c80e-157">(Optional) Specify **\@suser_sname** or **\@host_name** to return only information based on a single filtering criterion.</span></span>  
  
#### <a name="to-define-a-new-partition-and-generate-a-new-partitioned-snapshot"></a><span data-ttu-id="9c80e-158">Per definire una nuova partizione e generare un nuovo snapshot partizionato</span><span class="sxs-lookup"><span data-stu-id="9c80e-158">To define a new partition and generate a new partitioned snapshot</span></span>  
  
1.  <span data-ttu-id="9c80e-159">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-159">At the Publisher on the publication database, execute [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span></span> <span data-ttu-id="9c80e-160">Specificare il nome della pubblicazione per la \*\* \@ pubblicazione\*\*e il valore con parametri che definisce la partizione per uno degli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="9c80e-160">Specify the name of the publication for **\@publication**, and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="9c80e-161">\*\* \@ SUSER_SNAME\*\* -quando il filtro con parametri è definito dal valore restituito da [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-161">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="9c80e-162">\*\* \@ HOST_NAME\*\* -quando il filtro con parametri è definito dal valore restituito da [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-162">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
2.  <span data-ttu-id="9c80e-163">Creare e inizializzare lo snapshot con parametri per la nuova partizione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-163">Create and initialize the parameterized snapshot for this new partition.</span></span> <span data-ttu-id="9c80e-164">Per altre informazioni, vedere [Creazione di uno snapshot per una pubblicazione di tipo merge con filtri con parametri](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-164">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="9c80e-165">Per eliminare una partizione</span><span class="sxs-lookup"><span data-stu-id="9c80e-165">To delete a partition</span></span>  
  
1.  <span data-ttu-id="9c80e-166">Nel database di pubblicazione del server di pubblicazione eseguire [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-166">At the Publisher on the publication database, execute [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span></span> <span data-ttu-id="9c80e-167">Specificare il nome della pubblicazione per la \*\* \@ pubblicazione\*\* e il valore con parametri che definisce la partizione per uno degli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="9c80e-167">Specify the name of the publication for **\@publication** and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="9c80e-168">\*\* \@ SUSER_SNAME\*\* -quando il filtro con parametri è definito dal valore restituito da [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-168">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="9c80e-169">\*\* \@ HOST_NAME\*\* -quando il filtro con parametri è definito dal valore restituito da [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9c80e-169">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
     <span data-ttu-id="9c80e-170">Viene inoltre effettuata la rimozione del processo di snapshot e degli eventuali file di snapshot per la partizione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-170">This also removes the snapshot job and any snapshot files for the partition.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="9c80e-171">Utilizzo di RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="9c80e-171">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="9c80e-172">Per migliorare la gestione di una pubblicazione con filtri con parametri, è possibile creare nuove partizioni del Sottoscrittore a livello di programmazione, enumerare le partizioni del Sottoscrittore esistenti ed eliminare quelle desiderate utilizzando oggetti RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="9c80e-172">To better manage a publication with parameterized filters, you can programmatically create new Subscriber partitions, enumerate the existing Subscriber partitions, and delete Subscriber partitions by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="9c80e-173">Per informazioni sulla creazione di partizioni del Sottoscrittore, vedere [Creazione di uno snapshot per una pubblicazione di tipo merge con filtri con parametri](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="9c80e-173">For information about how to create Subscriber partitions, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span> <span data-ttu-id="9c80e-174">È possibile ottenere le informazioni seguenti sulle partizioni esistenti:</span><span class="sxs-lookup"><span data-stu-id="9c80e-174">The following information about existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="9c80e-175">Valore e funzione di filtro su cui si basa la partizione.</span><span class="sxs-lookup"><span data-stu-id="9c80e-175">The value and filtering function upon which the partition is based.</span></span>  
  
-   <span data-ttu-id="9c80e-176">Nome del processo che genera uno snapshot con parametri per il Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="9c80e-176">The name of the job that generates a parameterized snapshot for the Subscriber.</span></span>  
  
-   <span data-ttu-id="9c80e-177">Ora dell'ultima esecuzione di un processo di snapshot con parametri.</span><span class="sxs-lookup"><span data-stu-id="9c80e-177">The last time that a parameterized snapshot job ran.</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="9c80e-178">Per visualizzare informazioni sulle partizioni esistenti</span><span class="sxs-lookup"><span data-stu-id="9c80e-178">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="9c80e-179">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="9c80e-179">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="9c80e-180">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="9c80e-180">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="9c80e-181">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> e <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> per la pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="9c80e-181">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="9c80e-182">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9c80e-182">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="9c80e-183">Se questo metodo restituisce `false`, le proprietà della pubblicazione sono state definite in modo non corretto nel passaggio 2 oppure la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="9c80e-183">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="9c80e-184">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> e passare il risultato a una matrice di oggetti <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="9c80e-184">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="9c80e-185">Per ogni oggetto <xref:Microsoft.SqlServer.Replication.MergePartition> nella matrice, ottenere le proprietà desiderate.</span><span class="sxs-lookup"><span data-stu-id="9c80e-185">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, get any properties of interest.</span></span>  
  
#### <a name="to-delete-existing-partitions"></a><span data-ttu-id="9c80e-186">Per eliminare partizioni esistenti</span><span class="sxs-lookup"><span data-stu-id="9c80e-186">To delete existing partitions</span></span>  
  
1.  <span data-ttu-id="9c80e-187">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="9c80e-187">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="9c80e-188">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="9c80e-188">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="9c80e-189">Impostare le proprietà <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> e <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> per la pubblicazione, quindi impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> creato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="9c80e-189">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="9c80e-190">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9c80e-190">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="9c80e-191">Se questo metodo restituisce `false`, le proprietà della pubblicazione sono state definite in modo non corretto nel passaggio 2 oppure la pubblicazione non esiste.</span><span class="sxs-lookup"><span data-stu-id="9c80e-191">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="9c80e-192">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> e passare il risultato a una matrice di oggetti <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="9c80e-192">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="9c80e-193">Per ogni oggetto <xref:Microsoft.SqlServer.Replication.MergePartition> nella matrice, determinare se la partizione deve essere eliminata.</span><span class="sxs-lookup"><span data-stu-id="9c80e-193">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, determine whether the partition should be deleted.</span></span> <span data-ttu-id="9c80e-194">Questa decisione si basa in genere sul valore della proprietà <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> o <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> .</span><span class="sxs-lookup"><span data-stu-id="9c80e-194">This decision is usually based on the value of the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> property or the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> property.</span></span>  
  
6.  <span data-ttu-id="9c80e-195">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> sull'oggetto <xref:Microsoft.SqlServer.Replication.MergePublication> indicato nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="9c80e-195">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> method on the <xref:Microsoft.SqlServer.Replication.MergePublication> object from step 2.</span></span> <span data-ttu-id="9c80e-196">Passare l'oggetto <xref:Microsoft.SqlServer.Replication.MergePartition> indicato nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="9c80e-196">Pass the <xref:Microsoft.SqlServer.Replication.MergePartition> object from step 5.</span></span>  
  
7.  <span data-ttu-id="9c80e-197">Ripetere il passaggio 6 per ogni partizione eliminata.</span><span class="sxs-lookup"><span data-stu-id="9c80e-197">Repeat step 6 for each partition that is deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9c80e-198">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9c80e-198">See Also</span></span>  
 <span data-ttu-id="9c80e-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="9c80e-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="9c80e-200">Snapshot per pubblicazioni di tipo merge con filtri con parametri</span><span class="sxs-lookup"><span data-stu-id="9c80e-200">Snapshots for Merge Publications with Parameterized Filters</span></span>](../snapshots-for-merge-publications-with-parameterized-filters.md)  
  
  
