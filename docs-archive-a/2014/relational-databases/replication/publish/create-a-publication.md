---
title: Creare una pubblicazione | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], creating
- articles [SQL Server replication], defining
- adding articles
- articles [SQL Server replication], adding
ms.assetid: 52ee6de9-1d58-4cb9-8711-372bddbe7154
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 14d8b3f1a998b18ae0153c1771fa11afd925da9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87637772"
---
# <a name="create-a-publication"></a><span data-ttu-id="7d5b3-102">Create a Publication</span><span class="sxs-lookup"><span data-stu-id="7d5b3-102">Create a Publication</span></span>
  <span data-ttu-id="7d5b3-103">In questo argomento viene descritto come creare una pubblicazione in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)]o RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-103">This topic describes how to create a publication in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="7d5b3-104">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="7d5b3-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="7d5b3-105">**Prima di iniziare:**</span><span class="sxs-lookup"><span data-stu-id="7d5b3-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="7d5b3-106">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="7d5b3-106">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="7d5b3-107">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="7d5b3-107">Security</span></span>](#Security)  
  
-   <span data-ttu-id="7d5b3-108">**Per creare una pubblicazione e definire articoli, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="7d5b3-108">**To create a publication and define articles, using:**</span></span>  
  
     [<span data-ttu-id="7d5b3-109">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="7d5b3-109">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="7d5b3-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="7d5b3-110">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="7d5b3-111">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="7d5b3-111">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="7d5b3-112">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="7d5b3-112">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="7d5b3-113">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="7d5b3-113">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="7d5b3-114">I nomi di pubblicazioni e articoli non possono includere i caratteri seguenti: % , \* , [ , ] , | , : , " , ?</span><span class="sxs-lookup"><span data-stu-id="7d5b3-114">Publication and article names cannot include any of the following characters: % , \* , [ , ] , | , : , " , ?</span></span> <span data-ttu-id="7d5b3-115">, ' , \ , / , \< , >.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-115">, ' , \ , / , \< , >.</span></span> <span data-ttu-id="7d5b3-116">Se gli oggetti del database includono uno di questi caratteri e si vuole replicarli, è necessario specificare un nome di articolo diverso dal nome oggetto nella finestra di dialogo **Proprietà articolo - \<Article>** , accessibile dalla pagina **Articoli** della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-116">If objects in the database include any of these characters and you want to replicate them, you must specify an article name that is different from the object name in the **Article Properties - \<Article>** dialog box, which is available from the **Articles** page in the wizard.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="7d5b3-117">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="7d5b3-117">Security</span></span>  
 <span data-ttu-id="7d5b3-118">Se possibile, richiedere agli utenti di immettere le credenziali di sicurezza in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-118">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="7d5b3-119">Se è necessario archiviare le credenziali, utilizzare i [servizi di crittografia](https://go.microsoft.com/fwlink/?LinkId=34733) offerti da [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-119">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="7d5b3-120">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="7d5b3-120">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="7d5b3-121">Creare le pubblicazioni e definire gli articoli utilizzando la Creazione guidata nuova pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-121">Create publications and define articles with the New Publication Wizard.</span></span> <span data-ttu-id="7d5b3-122">Dopo aver creato una pubblicazione, visualizzare e modificare le relative proprietà nella finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-122">After a publication is created, view and modify publication properties in the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="7d5b3-123">Per informazioni sulla creazione di una pubblicazione da un database Oracle, vedere [Creare una pubblicazione da un database Oracle](create-a-publication-from-an-oracle-database.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-123">For information about creating a publication from an Oracle database, see [Create a Publication from an Oracle Database](create-a-publication-from-an-oracle-database.md).</span></span>  
  
#### <a name="to-create-a-publication-and-define-articles"></a><span data-ttu-id="7d5b3-124">Per creare una pubblicazione e definire articoli</span><span class="sxs-lookup"><span data-stu-id="7d5b3-124">To create a publication and define articles</span></span>  
  
1.  <span data-ttu-id="7d5b3-125">Connettersi al server di pubblicazione in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-125">Connect to the Publisher in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="7d5b3-126">Espandere la cartella **Replica** e quindi fare clic con il pulsante destro del mouse sulla cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-126">Expand the **Replication** folder, and then right-click the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="7d5b3-127">Fare clic su **Nuova pubblicazione**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-127">Click **New Publication**.</span></span>  
  
4.  <span data-ttu-id="7d5b3-128">Eseguire i vari passaggi della Creazione guidata nuova pubblicazione per:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-128">Follow the pages in the New Publication Wizard to:</span></span>  
  
    -   <span data-ttu-id="7d5b3-129">Specificare un server di distribuzione se la distribuzione non è stata configurata sul server.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-129">Specify a Distributor if distribution has not been configured on the server.</span></span> <span data-ttu-id="7d5b3-130">Per altre informazioni sulla configurazione della distribuzione, vedere [Configurare la pubblicazione e la distribuzione](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-130">For more information about configuring distribution, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
         <span data-ttu-id="7d5b3-131">Se nella pagina **Server di distribuzione** si specifica che il server di pubblicazione deve agire come server di distribuzione per se stesso (server di distribuzione locale) e il server non è configurato come server di distribuzione, la Creazione guidata nuova pubblicazione eseguirà la configurazione del server.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-131">If you specify on the **Distributor** page that the Publisher server will act as its own Distributor (a local Distributor), and the server is not configured as a Distributor, the New Publication Wizard will configure the server.</span></span> <span data-ttu-id="7d5b3-132">Nella pagina **Cartella snapshot** è necessario specificare una cartella snapshot predefinita per il server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-132">You will specify a default snapshot folder for the Distributor on the **Snapshot Folder** page.</span></span> <span data-ttu-id="7d5b3-133">La cartella snapshot è semplicemente una directory designata come condivisione. Gli agenti che eseguono letture e scritture in questa cartella devono disporre di autorizzazioni sufficienti per accedervi.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-133">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="7d5b3-134">Per altre informazioni sulle impostazioni di sicurezza appropriate per la cartella, vedere [Proteggere la cartella snapshot](../security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-134">For more information about securing the folder appropriately, see [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md).</span></span>  
  
         <span data-ttu-id="7d5b3-135">Se si specifica che un altro server deve agire come server di distribuzione, è necessario immettere una password nella pagina **Password amministrativa** per le connessioni effettuate dal server di pubblicazione a quello di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-135">If you specify that another server should act as the Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="7d5b3-136">Questa password deve corrispondere a quella specificata quando il server di pubblicazione è stato attivato nel server di distribuzione remoto.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-136">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
         <span data-ttu-id="7d5b3-137">Per altre informazioni, vedere [Configure Distribution](../configure-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-137">For more information, see [Configure Distribution](../configure-distribution.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-138">Scegliere un database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-138">Choose a publication database.</span></span>  
  
    -   <span data-ttu-id="7d5b3-139">Selezionare un tipo di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-139">Select a publication type.</span></span> <span data-ttu-id="7d5b3-140">Per altre informazioni, vedere [Tipi di replica](../types-of-replication.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-140">For more information, see [Types of Replication](../types-of-replication.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-141">Specificare i dati e gli oggetti di database da pubblicare; facoltativamente, filtrare le colonne dagli articoli di tabelle e impostare le proprietà degli articoli.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-141">Specify data and database objects to publish; optionally filter columns from table articles, and set article properties.</span></span>  
  
    -   <span data-ttu-id="7d5b3-142">Facoltativamente, filtrate le righe dagli articoli di tabelle.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-142">Optionally filter rows from table articles.</span></span> <span data-ttu-id="7d5b3-143">Per altre informazioni, vedere [Filtrare i dati pubblicati](filter-published-data.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-143">For more information, see [Filter Published Data](filter-published-data.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-144">Impostare la pianificazione dell'agente snapshot.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-144">Set the Snapshot Agent schedule.</span></span>  
  
    -   <span data-ttu-id="7d5b3-145">Specificare le credenziali con cui gli agenti di replica seguenti vengono eseguiti e stabiliscono le connessioni:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-145">Specify the credentials under which the following replication agents run and make connections:</span></span>  
  
         <span data-ttu-id="7d5b3-146">\- Agente snapshot per tutte le pubblicazioni.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-146">\- Snapshot Agent for all publications.</span></span>  
  
         <span data-ttu-id="7d5b3-147">\- Agente di lettura log per tutte le pubblicazioni transazionali.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-147">\- Log Reader Agent for all transactional publications.</span></span>  
  
         <span data-ttu-id="7d5b3-148">\- Agente di lettura coda per le pubblicazioni transazionali che consentono l'aggiornamento delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-148">\- Queue Reader Agent for transactional publications that allow updating subscriptions.</span></span>  
  
         <span data-ttu-id="7d5b3-149">Per ulteriori informazioni, vedere [Replication Agent Security Model](../security/replication-agent-security-model.md) e [Replication Security Best Practices](../security/replication-security-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-149">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md) and [Replication Security Best Practices](../security/replication-security-best-practices.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-150">Facoltativamente, creare lo script della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-150">Optionally script the publication.</span></span> <span data-ttu-id="7d5b3-151">Per altre informazioni, vedere [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-151">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-152">Specificare un nome per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-152">Specify a name for the publication.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="7d5b3-153">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="7d5b3-153">Using Transact-SQL</span></span>  
 <span data-ttu-id="7d5b3-154">È possibile creare pubblicazioni a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-154">Publications can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="7d5b3-155">Le stored procedure utilizzate dipenderanno dal tipo di pubblicazione creato.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-155">The stored procedures that are used will depend on the type of publication being created.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="7d5b3-156">Per creare una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="7d5b3-156">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="7d5b3-157">Nel database di pubblicazione del server di pubblicazione eseguire [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) per abilitare la pubblicazione del database corrente usando la replica snapshot o transazionale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-157">At the Publisher on the publication database, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using snapshot or transactional replication.</span></span>  
  
2.  <span data-ttu-id="7d5b3-158">Per una pubblicazione transazionale, determinare se esiste un processo dell'agente di lettura log per il database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-158">For a transactional publication, determine whether a Log Reader Agent job exists for the publication database.</span></span> <span data-ttu-id="7d5b3-159">Questo passaggio non è necessario per le pubblicazioni snapshot.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-159">(This step is not required for snapshot publications.)</span></span>  
  
    -   <span data-ttu-id="7d5b3-160">Se per il database di pubblicazione esiste un processo dell'agente di lettura log, procedere con il passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-160">If a Log Reader Agent job exists for the publication database, proceed to step 3.</span></span>  
  
    -   <span data-ttu-id="7d5b3-161">Per sapere se un processo dell'agente di lettura log esiste già per un database pubblicato, eseguire [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) nel database di pubblicazione nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-161">If you are unsure whether a Log Reader Agent job exists for a published database, execute [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) at the Publisher on the publication database.</span></span>  
  
    -   <span data-ttu-id="7d5b3-162">Se il set di risultati è vuoto, creare un processo dell'agente di lettura log.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-162">If the result set is empty, create a Log Reader Agent job.</span></span> <span data-ttu-id="7d5b3-163">Nel server di pubblicazione eseguire [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-163">At the Publisher, execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span></span> <span data-ttu-id="7d5b3-164">Specificare le credenziali di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows usate per l'esecuzione dell'agente per **\@job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-164">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows credentials under which the agent runs for **\@job_name** and **\@password**.</span></span> <span data-ttu-id="7d5b3-165">Se l'agente userà l'autenticazione di SQL Server per la connessione al server di pubblicazione, è anche necessario specificare il valore **0** per **\@publisher_security_mode** e le informazioni sull'account di accesso di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-165">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="7d5b3-166">Procedere al passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-166">Proceed to step 3.</span></span>  
  
3.  <span data-ttu-id="7d5b3-167">Nel server di pubblicazione eseguire [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-167">At the Publisher, execute [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span></span> <span data-ttu-id="7d5b3-168">Specificare un nome di pubblicazione per la \*\* \@ pubblicazione**e, per il parametro \*\* \@ repl_freq** , specificare il valore `snapshot` per una pubblicazione snapshot o il valore `continuous` per una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-168">Specify a publication name for **\@publication**, and, for the **\@repl_freq** parameter, specify a value of `snapshot` for a snapshot publication or a value of `continuous` for a transactional publication.</span></span> <span data-ttu-id="7d5b3-169">Specificare eventuali altre opzioni della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-169">Specify any other publication options.</span></span> <span data-ttu-id="7d5b3-170">In questo modo viene definita la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-170">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7d5b3-171">I nomi delle pubblicazioni non possono includere i caratteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-171">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="7d5b3-172">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="7d5b3-172">% \* [ ] | : " ?</span></span> <span data-ttu-id="7d5b3-173">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="7d5b3-173">\ / \< ></span></span>  
  
4.  <span data-ttu-id="7d5b3-174">Nel server di pubblicazione eseguire [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-174">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="7d5b3-175">Specificare il nome della pubblicazione usato nel passaggio 3 per **\@publication** e le credenziali di Windows usate per l'agente di snapshot per **\@snapshot_job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-175">Specify the publication name used in step 3 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="7d5b3-176">Se l'agente userà l'autenticazione di SQL Server per la connessione al server di pubblicazione, è anche necessario specificare il valore **0** per **\@publisher_security_mode** e le informazioni sull'account di accesso di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-176">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="7d5b3-177">Verrà creato un processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-177">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7d5b3-178">Quando si configura un server di pubblicazione con un server di distribuzione remoto, i valori specificati per tutti i parametri, inclusi *job_login* e *job_password*, vengono inviati al server di distribuzione come testo normale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-178">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7d5b3-179">È consigliabile crittografare la connessione tra il server di pubblicazione e il server di distribuzione remoto prima di eseguire questa stored procedure.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-179">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="7d5b3-180">Per altre informazioni, vedere [Abilitare le connessioni crittografate al motore di database &#40;Gestione configurazione SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-180">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
5.  <span data-ttu-id="7d5b3-181">Aggiungere articoli alla pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-181">Add articles to the publication.</span></span> <span data-ttu-id="7d5b3-182">Per altre informazioni, vedere [definire un articolo](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-182">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
6.  <span data-ttu-id="7d5b3-183">Avviare il processo dell'agente snapshot per generare lo snapshot iniziale per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-183">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="7d5b3-184">Per altre informazioni, vedere [Creazione e applicazione dello snapshot iniziale](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-184">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="7d5b3-185">Per creare una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="7d5b3-185">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="7d5b3-186">Nel server di pubblicazione eseguire [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) per abilitare la pubblicazione del database corrente usando la replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-186">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using merge replication.</span></span>  
  
2.  <span data-ttu-id="7d5b3-187">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-187">At the Publisher on the publication database, execute [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span> <span data-ttu-id="7d5b3-188">Specificare il nome della pubblicazione per **\@publication** ed eventuali altre opzioni della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-188">Specify a name for the publication for **\@publication** and any other publication options.</span></span> <span data-ttu-id="7d5b3-189">In questo modo viene definita la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-189">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7d5b3-190">I nomi delle pubblicazioni non possono includere i caratteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-190">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="7d5b3-191">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="7d5b3-191">% \* [ ] | : " ?</span></span> <span data-ttu-id="7d5b3-192">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="7d5b3-192">\ / \< ></span></span>  
  
3.  <span data-ttu-id="7d5b3-193">Nel server di pubblicazione eseguire [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-193">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="7d5b3-194">Specificare il nome della pubblicazione usato nel passaggio 2 per **\@publication** e le credenziali di Windows usate per l'agente di snapshot per **\@snapshot_job_name** e **\@password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-194">Specify the publication name used in step 2 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="7d5b3-195">Se l'agente userà l'autenticazione di SQL Server per la connessione al server di pubblicazione, è anche necessario specificare il valore **0** per **\@publisher_security_mode** e le informazioni sull'account di accesso di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per **\@publisher_login** e **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-195">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="7d5b3-196">Verrà creato un processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-196">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7d5b3-197">Quando si configura un server di pubblicazione con un server di distribuzione remoto, i valori specificati per tutti i parametri, inclusi *job_login* e *job_password*, vengono inviati al server di distribuzione come testo normale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-197">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7d5b3-198">È consigliabile crittografare la connessione tra il server di pubblicazione e il server di distribuzione remoto prima di eseguire questa stored procedure.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-198">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="7d5b3-199">Per altre informazioni, vedere [Abilitare le connessioni crittografate al motore di database &#40;Gestione configurazione SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-199">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
4.  <span data-ttu-id="7d5b3-200">Aggiungere articoli alla pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-200">Add articles to the publication.</span></span> <span data-ttu-id="7d5b3-201">Per altre informazioni, vedere [definire un articolo](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-201">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
5.  <span data-ttu-id="7d5b3-202">Avviare il processo dell'agente snapshot per generare lo snapshot iniziale per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-202">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="7d5b3-203">Per altre informazioni, vedere [Creazione e applicazione dello snapshot iniziale](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-203">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="7d5b3-204">Esempio (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="7d5b3-204">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="7d5b3-205">In questo esempio viene creata una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-205">This example creates a transactional publication.</span></span> <span data-ttu-id="7d5b3-206">Per passare le credenziali di Windows necessarie per la creazione di processi per l'agente snapshot e per l'agente di lettura log, vengono utilizzate variabili di scripting.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-206">Scripting variables are used to pass Windows credentials that are needed to create jobs for the Snapshot Agent and Log Reader Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddTranPub](../../../snippets/tsql/SQL15/replication/howto/tsql/createtranpub.sql#sp_addtranpub)]  
  
 <span data-ttu-id="7d5b3-207">In questo esempio viene creata una pubblicazione di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-207">This example creates a merge publication.</span></span> <span data-ttu-id="7d5b3-208">Per passare le credenziali di Windows necessarie per la creazione del processo per l'agente snapshot, vengono utilizzate variabili di scripting.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-208">Scripting variables are used to pass Windows credentials that are needed to create the job for the Snapshot Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddMergePub](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepub.sql#sp_addmergepub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="7d5b3-209">Utilizzo di RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="7d5b3-209">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="7d5b3-210">È possibile creare pubblicazioni a livello di programmazione tramite gli oggetti RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-210">You can create publications programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="7d5b3-211">Le classi RMO utilizzate per creare una pubblicazione dipendono dal tipo di pubblicazione creata.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-211">The RMO classes that you use to create a publication depend on the type of publication you create.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="7d5b3-212">Per creare una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="7d5b3-212">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="7d5b3-213">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="7d5b3-214">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> per il database di pubblicazione, impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'istanza di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> del passaggio 1, quindi chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="7d5b3-215">Se <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> restituisce `false`, verificare che il database esista.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-215">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="7d5b3-216">Se la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> è impostata su `false`, impostarla su `true`.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-216">If the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> property is `false`, set it to `true`.</span></span>  
  
4.  <span data-ttu-id="7d5b3-217">Per una pubblicazione transazionale, verificare il valore della proprietà <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-217">For a transactional publication, check the value of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> property.</span></span> <span data-ttu-id="7d5b3-218">Se questa proprietà è impostata su `true`, per il database esiste già un processo dell'agente di lettura log.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-218">If this property is `true`, a Log Read Agent job already exists for this database.</span></span> <span data-ttu-id="7d5b3-219">Se questa proprietà è impostata su `false`, eseguire le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-219">If this property is `false`, do the following:</span></span>  
  
    -   <span data-ttu-id="7d5b3-220">Impostare i campi <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> o <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> di <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> in modo da fornire le credenziali dell'account [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows utilizzato per l'esecuzione dell'agente di lettura log.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-220">Set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account under which the Log Reader Agent runs.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7d5b3-221">Non è necessario impostare <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> quando la pubblicazione viene creata da un membro del ruolo predefinito del server `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-221">Setting <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="7d5b3-222">In questo caso l'agente rappresenterà l'account di SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-222">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="7d5b3-223">Per altre informazioni, vedere [Modello di sicurezza dell'agente di replica](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-223">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-224">(Facoltativo) Impostare i campi <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> o <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> di <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> quando si utilizza l'autenticazione di SQL Server per la connessione al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-224">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="7d5b3-225">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> per creare il processo dell'agente di lettura log per il database.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-225">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> method to create the Log Reader Agent job for the database.</span></span>  
  
5.  <span data-ttu-id="7d5b3-226">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.TransPublication> e impostare le proprietà seguenti per questo oggetto:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-226">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="7d5b3-227">Oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> indicato nel passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-227">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-228">Nome del database pubblicato per <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-228">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-229">Nome per la pubblicazione per <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-229">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-230">Valore <xref:Microsoft.SqlServer.Replication.PublicationType> di <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> o <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-230">A <xref:Microsoft.SqlServer.Replication.PublicationType> of either <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-231">Campi <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> di <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> per fornire le credenziali per l'account di Windows con cui verrà eseguito il processo dell'agente snapshot.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-231">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="7d5b3-232">Questo account viene utilizzato anche quando l'agente snapshot stabilisce connessioni al server di distribuzione locale e per qualsiasi connessione remota quando si utilizza l'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-232">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7d5b3-233">Non è necessario impostare <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> quando la pubblicazione viene creata da un membro del ruolo predefinito del server `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-233">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="7d5b3-234">In questo caso l'agente rappresenterà l'account di SQL Server Agent.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-234">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="7d5b3-235">Per altre informazioni, vedere [Modello di sicurezza dell'agente di replica](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-235">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-236">(Facoltativo) Campi <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> e <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> o <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> di <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> quando si utilizza l'autenticazione di SQL Server per la connessione al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-236">(Optional) The <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="7d5b3-237">(Facoltativo) Utilizzare l'operatore logico OR inclusivo (`|` in Visual C# e `Or` in Visual Basic) e l'operatore logico OR esclusivo (`^` in Visual C# e `Xor` in Visual Basic) per impostare i valori di <xref:Microsoft.SqlServer.Replication.PublicationAttributes> per la proprietà <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-237">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
    -   <span data-ttu-id="7d5b3-238">(Facoltativo) Nome del server di pubblicazione per <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> quando il server di pubblicazione non è non SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-238">(Optional) The name of the Publisher for <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> when the Publisher is a non-SQL Server Publisher.</span></span>  
  
6.  <span data-ttu-id="7d5b3-239">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> per creare la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-239">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7d5b3-240">Quando si configura un server di pubblicazione con un server di distribuzione remoto, i valori specificati per tutte le proprietà, inclusa <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, vengono inviati al server di distribuzione come testo normale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-240">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7d5b3-241">È consigliabile crittografare la connessione tra il server di pubblicazione e il server di distribuzione remoto prima di chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-241">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="7d5b3-242">Per altre informazioni, vedere [Abilitare le connessioni crittografate al motore di database &#40;Gestione configurazione SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-242">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
7.  <span data-ttu-id="7d5b3-243">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> per creare il processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-243">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="7d5b3-244">Per creare una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="7d5b3-244">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="7d5b3-245">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-245">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="7d5b3-246">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> per il database di pubblicazione, impostare la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> sull'istanza di <xref:Microsoft.SqlServer.Management.Common.ServerConnection> del passaggio 1, quindi chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="7d5b3-246">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="7d5b3-247">Se <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> restituisce `false`, verificare che il database esista.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-247">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="7d5b3-248">Se la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> è `false`, impostarla su `true` e chiamare <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-248">If <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> Property is `false`, set it to `true`, and call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A>.</span></span>  
  
4.  <span data-ttu-id="7d5b3-249">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergePublication> e impostare le proprietà seguenti per questo oggetto:</span><span class="sxs-lookup"><span data-stu-id="7d5b3-249">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="7d5b3-250">Oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> indicato nel passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-250">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-251">Nome del database pubblicato per <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-251">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-252">Nome per la pubblicazione per <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-252">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="7d5b3-253">Campi <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> e <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> di <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> per fornire le credenziali per l'account di Windows con cui verrà eseguito il processo dell'agente snapshot.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-253">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="7d5b3-254">Questo account viene utilizzato anche quando l'agente snapshot stabilisce connessioni al server di distribuzione locale e per qualsiasi connessione remota quando si utilizza l'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-254">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7d5b3-255">Non è necessario impostare <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> quando la pubblicazione viene creata da un membro del ruolo predefinito del server `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-255">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="7d5b3-256">Per altre informazioni, vedere [Modello di sicurezza dell'agente di replica](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-256">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="7d5b3-257">(Facoltativo) Utilizzare l'operatore logico OR inclusivo (`|` in Visual C# e `Or` in Visual Basic) e l'operatore logico OR esclusivo (`^` in Visual C# e `Xor` in Visual Basic) per impostare i valori di <xref:Microsoft.SqlServer.Replication.PublicationAttributes> per la proprietà <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-257">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
5.  <span data-ttu-id="7d5b3-258">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> per creare la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-258">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7d5b3-259">Quando si configura un server di pubblicazione con un server di distribuzione remoto, i valori specificati per tutte le proprietà, inclusa <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, vengono inviati al server di distribuzione come testo normale.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-259">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7d5b3-260">È consigliabile crittografare la connessione tra il server di pubblicazione e il server di distribuzione remoto prima di chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.Create%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-260">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="7d5b3-261">Per altre informazioni, vedere [Abilitare le connessioni crittografate al motore di database &#40;Gestione configurazione SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-261">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
6.  <span data-ttu-id="7d5b3-262">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> per creare il processo dell'agente snapshot per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-262">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="7d5b3-263">Esempi (RMO)</span><span class="sxs-lookup"><span data-stu-id="7d5b3-263">Examples (RMO)</span></span>  
 <span data-ttu-id="7d5b3-264">In questo esempio il database AdventureWorks viene abilitato per la pubblicazione transazionale, viene definito un processo dell'agente di lettura log e viene creata la pubblicazione AdvWorksProductTran.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-264">This example enables the AdventureWorks database for transactional publishing, defines a Log Reader Agent job, and creates the AdvWorksProductTran publication.</span></span> <span data-ttu-id="7d5b3-265">Per questa pubblicazione è necessario definire un articolo.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-265">An article must be defined for this publication.</span></span> <span data-ttu-id="7d5b3-266">Le credenziali dell'account di Windows necessarie per creare il processo dell'agente di lettura log e il processo dell'agente snapshot vengono passate in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-266">The Windows account credentials that are needed to create the Log Reader Agent job and the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="7d5b3-267">Per informazioni sull'utilizzo di oggetti RMO per definire articoli snapshot e transazionali, vedere [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-267">To learn how to use RMO to define snapshot and transactional articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpub)]  
  
 <span data-ttu-id="7d5b3-268">In questo esempio il database AdventureWorks viene abilitato per la pubblicazione di tipo merge e viene creata la pubblicazione AdvWorksSalesOrdersMerge.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-268">This example enables the AdventureWorks database for merge publishing and creates the AdvWorksSalesOrdersMerge publication.</span></span> <span data-ttu-id="7d5b3-269">Per questa pubblicazione è ancora necessario definire gli articoli.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-269">Articles must still be defined for this publication.</span></span> <span data-ttu-id="7d5b3-270">Le credenziali dell'account di Windows necessarie per creare il processo dell'agente snapshot vengono passate in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="7d5b3-270">The Windows account credentials that are needed to create the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="7d5b3-271">Per informazioni sull'utilizzo di oggetti RMO per definire articoli di merge, vedere [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="7d5b3-271">To learn how to use RMO to define merge articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepub)]  
  
## <a name="see-also"></a><span data-ttu-id="7d5b3-272">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="7d5b3-272">See Also</span></span>  
 <span data-ttu-id="7d5b3-273">[Utilizzo di sqlcmd con variabili di scripting](../../scripting/sqlcmd-use-with-scripting-variables.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-273">[Use sqlcmd with Scripting Variables](../../scripting/sqlcmd-use-with-scripting-variables.md) </span></span>  
 <span data-ttu-id="7d5b3-274">[Pubblicare dati e oggetti di database](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-274">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="7d5b3-275">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-275">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="7d5b3-276">[Define an Article](define-an-article.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-276">[Define an Article](define-an-article.md) </span></span>  
 <span data-ttu-id="7d5b3-277">[Visualizzare e modificare le proprietà della pubblicazione](view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-277">[View and Modify Publication Properties](view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="7d5b3-278">[Configura distribuzione](../configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-278">[Configure Distribution](../configure-distribution.md) </span></span>  
 <span data-ttu-id="7d5b3-279">[Proteggere il database di distribuzione](../security/secure-the-distributor.md) </span><span class="sxs-lookup"><span data-stu-id="7d5b3-279">[Secure the Distributor](../security/secure-the-distributor.md) </span></span>  
 [<span data-ttu-id="7d5b3-280">Proteggere il server di pubblicazione</span><span class="sxs-lookup"><span data-stu-id="7d5b3-280">Secure the Publisher</span></span>](../security/secure-the-publisher.md)  
  
  
