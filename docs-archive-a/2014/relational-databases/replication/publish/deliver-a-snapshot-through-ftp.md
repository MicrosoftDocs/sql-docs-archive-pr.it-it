---
title: Recapitare uno snapshot tramite FTP | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], FTP snapshots
- FTP snapshots [SQL Server replication]
- snapshot replication [SQL Server], FTP
ms.assetid: 99872c4f-40ce-4405-8fd4-44052d3bd827
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2e6700e6989a5a7e32202a0710bc663978a136cf
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87625321"
---
# <a name="deliver-a-snapshot-through-ftp"></a><span data-ttu-id="623a1-102">Recapito di snapshot tramite FTP</span><span class="sxs-lookup"><span data-stu-id="623a1-102">Deliver a Snapshot Through FTP</span></span>
  <span data-ttu-id="623a1-103">In questo argomento viene descritto come recapitare uno snapshot utilizzando l'FTP in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] o [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="623a1-103">This topic describes how to deliver a snapshot through FTP in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
##  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="623a1-104">Limitazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="623a1-104">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="623a1-105">L'agente snapshot deve disporre delle autorizzazioni di scrittura per la directory specificata, mentre l'agente di distribuzione o l'agente di merge deve disporre delle autorizzazioni di lettura.</span><span class="sxs-lookup"><span data-stu-id="623a1-105">The Snapshot Agent must have write permissions for the directory you specify, and the Distribution Agent or Merge Agent must have read permissions.</span></span> <span data-ttu-id="623a1-106">Se vengono usate sottoscrizioni pull, è necessario specificare una directory condivisa come percorso UNC (Universal Naming Convention), ad esempio \\\serverftp\home\snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-106">If pull subscriptions are used, you must specify a shared directory as a universal naming convention (UNC) path, such as \\\ftpserver\home\snapshots.</span></span> <span data-ttu-id="623a1-107">Per altre informazioni, vedere [Proteggere la cartella snapshot](../security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-107">For more information, see [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md).</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="623a1-108">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="623a1-108">Prerequisites</span></span>  
  
-   <span data-ttu-id="623a1-109">Prima di trasferire file snapshot tramite il protocollo FTP (File Transfer Protocol), è necessario configurare un server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-109">To transfer snapshot files using File Transfer Protocol (FTP), you must first configure an FTP server.</span></span> <span data-ttu-id="623a1-110">Per ulteriori informazioni, vedere la documentazione di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="623a1-110">For more information, see the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) documentation.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="623a1-111">Sicurezza</span><span class="sxs-lookup"><span data-stu-id="623a1-111">Security</span></span>  
 <span data-ttu-id="623a1-112">Per migliorare la sicurezza, si consiglia di implementare una rete privata virtuale (VPN) quando si utilizza il recapito di snapshot tramite FTP in Internet.</span><span class="sxs-lookup"><span data-stu-id="623a1-112">To help improve security, we recommend that you implement a virtual private network (VPN) when using FTP snapshot delivery over the Internet.</span></span> <span data-ttu-id="623a1-113">Per altre informazioni, vedere [Pubblicare i dati su Internet tramite VPN](../publish-data-over-the-internet-using-vpn.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-113">For more information, see [Publish Data over the Internet Using VPN](../publish-data-over-the-internet-using-vpn.md).</span></span>  
  
 <span data-ttu-id="623a1-114">Ai fini della sicurezza è consigliabile non consentire accessi anonimi al server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-114">As a security best practice, do not allow anonymous logins to the FTP server.</span></span> <span data-ttu-id="623a1-115">L'agente snapshot deve disporre delle autorizzazioni di scrittura per la directory specificata, mentre l'agente di distribuzione o l'agente di merge deve disporre delle autorizzazioni di lettura.</span><span class="sxs-lookup"><span data-stu-id="623a1-115">The Snapshot Agent must have write permissions for the directory you specify, and the Distribution Agent or Merge Agent must have read permissions.</span></span> <span data-ttu-id="623a1-116">Se vengono usate sottoscrizioni pull, è necessario specificare una directory condivisa come percorso UNC (Universal Naming Convention), ad esempio \\\serverftp\home\snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-116">If pull subscriptions are used, you must specify a shared directory as a universal naming convention (UNC) path, such as \\\ftpserver\home\snapshots.</span></span> <span data-ttu-id="623a1-117">Per altre informazioni, vedere [Proteggere la cartella snapshot](../security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-117">For more information, see [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md).</span></span>  
  
 <span data-ttu-id="623a1-118">Se possibile, richiedere agli utenti di immettere le credenziali in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="623a1-118">When possible, prompt users to enter their credentials at runtime.</span></span> <span data-ttu-id="623a1-119">Se si archiviano le credenziali in un file script, è necessario proteggere il file.</span><span class="sxs-lookup"><span data-stu-id="623a1-119">If you store credentials in a script file, you must secure the file.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="623a1-120">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="623a1-120">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="623a1-121">Dopo la configurazione del server FTP specificare la directory e le informazioni di sicurezza relative a questo server nella finestra di dialogo **Proprietà pubblicazione \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="623a1-121">After the FTP server is configured, specify directory and security information for this server in the **Publication Properties \<Publication>** dialog box.</span></span> <span data-ttu-id="623a1-122">Per ulteriori informazioni sull'accesso a questa finestra di dialogo, vedere [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-122">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-ftp-information"></a><span data-ttu-id="623a1-123">Per specificare informazioni FTP</span><span class="sxs-lookup"><span data-stu-id="623a1-123">To specify FTP information</span></span>  
  
1.  <span data-ttu-id="623a1-124">Nella finestra di dialogo **Proprietà pubblicazione - \<Publication>** selezionare **I Sottoscrittori possono scaricare i file di snapshot utilizzando FTP (File Transfer Protocol)** in una delle pagine seguenti:</span><span class="sxs-lookup"><span data-stu-id="623a1-124">In the **Publication Properties - \<Publication>** dialog box, select **Allow Subscribers to download snapshot files using FTP** from one of the following pages:</span></span>   
    -   <span data-ttu-id="623a1-125">La pagina **Snapshot FTP**, per le pubblicazioni di snapshot e transazionali e le pubblicazioni di tipo merge per i server di pubblicazione che eseguono versioni precedenti a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="623a1-125">The **FTP Snapshot** page, for snapshot and transactional publications, and merge publications for Publishers running versions prior to [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>    
    -   <span data-ttu-id="623a1-126">La pagina **Snapshot FTP e Internet** , per le pubblicazioni di tipo merge provenienti dai server di pubblicazione in cui è in esecuzione [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o una versione successiva.</span><span class="sxs-lookup"><span data-stu-id="623a1-126">The **FTP Snapshot and Internet** page, for merge publications from Publishers running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or later.</span></span>    
2.  <span data-ttu-id="623a1-127">Specificare i valori per **Nome server FTP**, **Numero di porta**, **Percorso dalla cartella radice FTP**, **Nome account di accesso**e **Password**.</span><span class="sxs-lookup"><span data-stu-id="623a1-127">Specify values for **FTP server name**, **Port number**, **Path from the FTP root folder**, **Login**, and **Password**.</span></span>    
     <span data-ttu-id="623a1-128">Ad esempio, se la radice del server FTP è \\\serverftp\home e si vogliono archiviare gli snapshot nel percorso \\\serverftp\home\snapshot, specificare \snapshot\ftp per la proprietà **Percorso dalla cartella radice FTP**. La replica aggiunge "ftp" al percorso della cartella snapshot durante la creazione dei file di snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-128">For example, if the FTP server root is \\\ftpserver\home and you want snapshots to be stored at \\\ftpserver\home\snapshots, specify \snapshots\ftp for the property **Path from the FTP root folder** (replication appends 'ftp' to the snapshot folder path when it creates snapshot files).</span></span>    
3.  <span data-ttu-id="623a1-129">Specificare che tramite l'agente snapshot i file di snapshot devono essere scritti nella directory specificata al passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="623a1-129">Specify that the Snapshot Agent should write the snapshot files to the directory specified in step 2.</span></span> <span data-ttu-id="623a1-130">Ad esempio, per fare in modo che l'agente snapshot scriva i file di snapshot in \\\serverftp\home\snapshot\ftp, è necessario specificare il percorso \\\serverftp\home\snapshot in una delle due posizioni indicate di seguito:</span><span class="sxs-lookup"><span data-stu-id="623a1-130">For example, to have the Snapshot Agent write the snapshot files to \\\ftpserver\home\snapshots\ftp, you must specify the path \\\ftpserver\home\snapshots in one of two places:</span></span>    
    -   <span data-ttu-id="623a1-131">Il percorso predefinito dello snapshot per il server di distribuzione associato a questa pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="623a1-131">The default snapshot location for the Distributor associated with this publication.</span></span>    
         <span data-ttu-id="623a1-132">Per ulteriori informazioni su come specificare la posizione predefinita degli snapshot, vedere [specificare la posizione predefinita degli snapshot](../snapshot-options.md#snapshot-folder-locations).</span><span class="sxs-lookup"><span data-stu-id="623a1-132">For more information about specifying the default snapshot location, see [Specify the Default Snapshot Location](../snapshot-options.md#snapshot-folder-locations).</span></span>    
    -   <span data-ttu-id="623a1-133">Un percorso alternativo per la cartella snapshot per questa pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="623a1-133">An alternate snapshot folder location for this publication.</span></span> <span data-ttu-id="623a1-134">Se lo snapshot è compresso viene richiesto un percorso alternativo.</span><span class="sxs-lookup"><span data-stu-id="623a1-134">An alternate location is required if the snapshot is compressed.</span></span>    
         <span data-ttu-id="623a1-135">Immettere il percorso nella casella di testo Inserisci i **file nella cartella seguente** nella pagina snapshot della finestra di dialogo **proprietà \<Publication> pubblicazione-** .</span><span class="sxs-lookup"><span data-stu-id="623a1-135">Enter the path in the **Put files in the following folder** textbox on the Snapshot page of the **Publication Properties - \<Publication>** dialog box.</span></span>   
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="623a1-136">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="623a1-136">Using Transact-SQL</span></span>  
 <span data-ttu-id="623a1-137">È possibile impostare l'opzione per rendere i file snapshot disponibili in un server FTP e modificare le impostazioni FTP a livello di programmazione utilizzando stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="623a1-137">The option to make snapshot files available on an FTP server can be set and these FTP settings can be modified programmatically using replication stored procedures.</span></span> <span data-ttu-id="623a1-138">La stored procedure utilizzata varia a seconda del tipo di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="623a1-138">The procedure used depends on the type of publication.</span></span> <span data-ttu-id="623a1-139">Il recapito di snapshot tramite FTP viene utilizzato solo con le sottoscrizioni pull.</span><span class="sxs-lookup"><span data-stu-id="623a1-139">FTP snapshot delivery is only used with pull subscriptions.</span></span>  
  
#### <a name="to-enable-ftp-snapshot-delivery-for-a-snapshot-or-transactional-publication"></a><span data-ttu-id="623a1-140">Per abilitare il recapito di snapshot tramite FTP per una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="623a1-140">To enable FTP snapshot delivery for a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="623a1-141">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addpublication](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-141">At the Publisher on the publication database, execute [sp_addpublication](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span></span> <span data-ttu-id="623a1-142">Specificare **@publication** , il valore `true` per **@enabled_for_internet** e i valori appropriati per i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="623a1-142">Specify **@publication**, a value of `true` for **@enabled_for_internet**, and appropriate values for the following parameters:</span></span>    
    -   <span data-ttu-id="623a1-143">**@ftp_address**: indirizzo del server FTP utilizzato per il recapito dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-143">**@ftp_address** - the address of the FTP server used to deliver the snapshot.</span></span>    
    -   <span data-ttu-id="623a1-144">(Facoltativo) **@ftp_port** : porta utilizzata dal server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-144">(Optional) **@ftp_port** - the port used by the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-145">(Facoltativo) **@ftp_subdirectory** : sottodirectory della directory FTP predefinita assegnata a un account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-145">(Optional) **@ftp_subdirectory** - the subdirectory of the default FTP directory assigned to an FTP login.</span></span> <span data-ttu-id="623a1-146">Ad esempio, se la radice del server FTP è \\ \serverftp\home e si desidera archiviare gli snapshot in \\ \serverftp\home\snapshot, specificare **\snapshots\ftp** per **@ftp_subdirectory** (la replica aggiunge "FTP" al percorso della cartella snapshot durante la creazione dei file di snapshot).</span><span class="sxs-lookup"><span data-stu-id="623a1-146">For example, if the FTP server root is \\\ftpserver\home and you want snapshots to be stored at \\\ftpserver\home\snapshots, specify **\snapshots\ftp** for **@ftp_subdirectory** (replication appends 'ftp' to the snapshot folder path when it creates snapshot files).</span></span>    
    -   <span data-ttu-id="623a1-147">(Facoltativo) **@ftp_login** : account di accesso utilizzato per la connessione al server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-147">(Optional) **@ftp_login** - a login account used when connecting to the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-148">(Facoltativo) **@ftp_password** : password per l'account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-148">(Optional) **@ftp_password** - the password for the FTP login.</span></span>  
  
     <span data-ttu-id="623a1-149">Verrà creata una pubblicazione che utilizza FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-149">This creates a publication that uses FTP.</span></span> <span data-ttu-id="623a1-150">Per altre informazioni, vedere [Create a Publication](create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-150">For more information, see [Create a Publication](create-a-publication.md).</span></span>  
  
#### <a name="to-enable-ftp-snapshot-delivery-for-a-merge-publication"></a><span data-ttu-id="623a1-151">Per attivare il recapito di snapshot tramite FTP per una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="623a1-151">To enable FTP snapshot delivery for a merge publication</span></span>  
  
1.  <span data-ttu-id="623a1-152">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-152">At the Publisher on the publication database, execute [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span> <span data-ttu-id="623a1-153">Specificare **@publication** , il valore `true` per **@enabled_for_internet** e i valori appropriati per i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="623a1-153">Specify **@publication**, a value of `true` for **@enabled_for_internet** and appropriate values for the following parameters:</span></span>  
  
    -   <span data-ttu-id="623a1-154">**@ftp_address**: indirizzo del server FTP utilizzato per il recapito dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-154">**@ftp_address** - the address of the FTP server used to deliver the snapshot.</span></span>    
    -   <span data-ttu-id="623a1-155">(Facoltativo) **@ftp_port** : porta utilizzata dal server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-155">(Optional) **@ftp_port** - the port used by the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-156">(Facoltativo) **@ftp_subdirectory** : sottodirectory della directory FTP predefinita assegnata a un account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-156">(Optional) **@ftp_subdirectory** - the subdirectory of the default FTP directory assigned to an FTP login.</span></span> <span data-ttu-id="623a1-157">Ad esempio, se la radice del server FTP è \\ \serverftp\home e si desidera archiviare gli snapshot in \\ \serverftp\home\snapshot, specificare **\snapshots\ftp** per **@ftp_subdirectory** (la replica aggiunge "FTP" al percorso della cartella snapshot durante la creazione dei file di snapshot).</span><span class="sxs-lookup"><span data-stu-id="623a1-157">For example, if the FTP server root is \\\ftpserver\home and you want snapshots to be stored at \\\ftpserver\home\snapshots, specify **\snapshots\ftp** for **@ftp_subdirectory** (replication appends 'ftp' to the snapshot folder path when it creates snapshot files).</span></span>    
    -   <span data-ttu-id="623a1-158">(Facoltativo) **@ftp_login** : account di accesso utilizzato per la connessione al server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-158">(Optional) **@ftp_login** - a login account used when connecting to the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-159">(Facoltativo) **@ftp_password** : password per l'account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-159">(Optional) **@ftp_password** - the password for the FTP login.</span></span>  
  
     <span data-ttu-id="623a1-160">Verrà creata una pubblicazione che utilizza FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-160">This creates a publication that uses FTP.</span></span> <span data-ttu-id="623a1-161">Per altre informazioni, vedere [Create a Publication](create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-161">For more information, see [Create a Publication](create-a-publication.md).</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-snapshot-or-transactional-publication-that-uses-ftp-snapshot-delivery"></a><span data-ttu-id="623a1-162">Per creare una sottoscrizione pull in una pubblicazione snapshot o transazionale che utilizza il recapito di snapshot tramite FTP</span><span class="sxs-lookup"><span data-stu-id="623a1-162">To create a pull subscription to a snapshot or transactional publication that uses FTP snapshot delivery</span></span>  
  
1.  <span data-ttu-id="623a1-163">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-163">At the Subscriber on the subscription database, execute [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="623a1-164">Specificare **@publisher** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="623a1-164">Specify **@publisher** and **@publication**.</span></span>  
  
    -   <span data-ttu-id="623a1-165">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-165">At the Subscriber on the subscription database, execute [sp_addpullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="623a1-166">Specificare **@publisher** , **@publisher_db** , **@publication** , le [!INCLUDE[msCoName](../../../includes/msconame-md.md)] credenziali di Windows con cui viene eseguito il agente di distribuzione nel Sottoscrittore per **@job_login** e **@job_password** e il valore `true` per **@use_ftp** .</span><span class="sxs-lookup"><span data-stu-id="623a1-166">Specify **@publisher**, **@publisher_db**, **@publication**, the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Subscriber runs for **@job_login** and **@job_password**, and a value of `true` for **@use_ftp**.</span></span>  
  
2.  <span data-ttu-id="623a1-167">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) per registrare la sottoscrizione pull.</span><span class="sxs-lookup"><span data-stu-id="623a1-167">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql) to register the pull subscription.</span></span> <span data-ttu-id="623a1-168">Per altre informazioni, vedere [Creazione di una sottoscrizione pull](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-168">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
#### <a name="to-create-a-pull-subscription-to-a-merge-publication-that-uses-ftp-snapshot-delivery"></a><span data-ttu-id="623a1-169">Per creare una sottoscrizione pull in una pubblicazione di tipo merge che utilizza il recapito di snapshot tramite FTP</span><span class="sxs-lookup"><span data-stu-id="623a1-169">To create a pull subscription to a merge publication that uses FTP snapshot delivery</span></span>  
  
1.  <span data-ttu-id="623a1-170">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-170">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="623a1-171">Specificare **@publisher** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="623a1-171">Specify **@publisher** and **@publication**.</span></span>   
2.  <span data-ttu-id="623a1-172">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-172">At the Subscriber on the subscription database, execute [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql).</span></span> <span data-ttu-id="623a1-173">Specificare **@publisher** , **@publisher_db** , **@publication** , le credenziali di Windows con cui viene eseguito il agente di distribuzione nel Sottoscrittore per **@job_login** e **@job_password** e il valore `true` per **@use_ftp** .</span><span class="sxs-lookup"><span data-stu-id="623a1-173">Specify **@publisher**, **@publisher_db**, **@publication**, the Windows credentials under which the Distribution Agent at the Subscriber runs for **@job_login** and **@job_password**, and a value of `true` for **@use_ftp**.</span></span>    
3.  <span data-ttu-id="623a1-174">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql) per registrare la sottoscrizione pull.</span><span class="sxs-lookup"><span data-stu-id="623a1-174">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql) to register the pull subscription.</span></span> <span data-ttu-id="623a1-175">Per altre informazioni, vedere [Creazione di una sottoscrizione pull](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-175">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
#### <a name="to-change-one-or-more-ftp-snapshot-delivery-settings-for-a-snapshot-or-transactional-publication"></a><span data-ttu-id="623a1-176">Per modificare una o più impostazioni del recapito di snapshot tramite FTP per una pubblicazione snapshot o transazionale</span><span class="sxs-lookup"><span data-stu-id="623a1-176">To change one or more FTP snapshot delivery settings for a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="623a1-177">Nel database di pubblicazione del server di pubblicazione eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-177">At the Publisher on the publication database, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql).</span></span> <span data-ttu-id="623a1-178">Specificare uno dei valori seguenti per **@property** e un nuovo valore di questa impostazione per **@value** :</span><span class="sxs-lookup"><span data-stu-id="623a1-178">Specify one of the following values for **@property** and a new value of this setting for **@value**:</span></span>    
    -   <span data-ttu-id="623a1-179">`ftp_address`: indirizzo del server FTP utilizzato per il recapito dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-179">`ftp_address` - the address of the FTP server used to deliver the snapshot.</span></span>    
    -   <span data-ttu-id="623a1-180">`ftp_port`: porta utilizzata dal server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-180">`ftp_port` - the port used by the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-181">`ftp_subdirectory`: sottodirectory della directory FTP predefinita utilizzata per lo snapshot tramite FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-181">`ftp_subdirectory` - the subdirectory of the default FTP directory used for the FTP snapshot.</span></span>    
    -   <span data-ttu-id="623a1-182">`ftp_login`: account di accesso utilizzato per la connessione al server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-182">`ftp_login` - a login used to connect to the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-183">`ftp_password`: password per l'account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-183">`ftp_password` - the password for the FTP login.</span></span>  
  
2.  <span data-ttu-id="623a1-184">(Facoltativo) Ripetere il passaggio 1 per ogni impostazione FTP da modificare.</span><span class="sxs-lookup"><span data-stu-id="623a1-184">(Optional) Repeat step 1 for each FTP setting being changed.</span></span>    
3.  <span data-ttu-id="623a1-185">(Facoltativo) Per disabilitare il recapito di snapshot tramite FTP, eseguire [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql) nel database di pubblicazione del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="623a1-185">(Optional) To disable FTP snapshot delivery, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="623a1-186">Specificare il valore `enabled_for_internet` per **@property** e il valore `false` per **@value** .</span><span class="sxs-lookup"><span data-stu-id="623a1-186">Specify a value of `enabled_for_internet` for **@property** and a value of `false` for **@value**.</span></span>  
  
#### <a name="to-change-ftp-snapshot-delivery-settings-for-a-merge-publication"></a><span data-ttu-id="623a1-187">Per modificare le impostazioni del recapito di snapshot tramite FTP per una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="623a1-187">To change FTP snapshot delivery settings for a merge publication</span></span>  
  
1.  <span data-ttu-id="623a1-188">Nel database di pubblicazione del server di pubblicazione eseguire [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="623a1-188">At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql).</span></span> <span data-ttu-id="623a1-189">Specificare uno dei valori seguenti per **@property** e un nuovo valore di questa impostazione per **@value** :</span><span class="sxs-lookup"><span data-stu-id="623a1-189">Specify one of the following values for **@property** and a new value of this setting for **@value**:</span></span>  
  
    -   <span data-ttu-id="623a1-190">`ftp_address`: indirizzo del server FTP utilizzato per il recapito dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="623a1-190">`ftp_address` - the address of the FTP server used to deliver the snapshot.</span></span>    
    -   <span data-ttu-id="623a1-191">`ftp_port`: porta utilizzata dal server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-191">`ftp_port` - the port used by the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-192">`ftp_subdirectory`: sottodirectory della directory FTP predefinita utilizzata per lo snapshot tramite FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-192">`ftp_subdirectory` - the subdirectory of the default FTP directory used for the FTP snapshot.</span></span>   
    -   <span data-ttu-id="623a1-193">`ftp_login`: account di accesso utilizzato per la connessione al server FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-193">`ftp_login` - a login used to connect to the FTP server.</span></span>    
    -   <span data-ttu-id="623a1-194">`ftp_password`: password per l'account di accesso FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-194">`ftp_password` - the password for the FTP login.</span></span>    
2.  <span data-ttu-id="623a1-195">(Facoltativo) Ripetere il passaggio 1 per ogni impostazione FTP da modificare.</span><span class="sxs-lookup"><span data-stu-id="623a1-195">(Optional) Repeat step 1 for each FTP setting being changed.</span></span>    
3.  <span data-ttu-id="623a1-196">(Facoltativo) Per disabilitare il recapito di snapshot tramite FTP, eseguire [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) nel database di pubblicazione del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="623a1-196">(Optional) To disable FTP snapshot delivery, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="623a1-197">Specificare il valore `enabled_for_internet` per **@property** e il valore `false` per **@value** .</span><span class="sxs-lookup"><span data-stu-id="623a1-197">Specify a value of `enabled_for_internet` for **@property** and a value of `false` for **@value**.</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="623a1-198">Esempi (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="623a1-198">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="623a1-199">Nell'esempio seguente viene creata una pubblicazione di tipo merge che consente ai Sottoscrittori di accedere ai dati dello snapshot tramite FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-199">The following example creates a merge publication that allows Subscribers to access the snapshot data using FTP.</span></span> <span data-ttu-id="623a1-200">Il Sottoscrittore deve utilizzare una connessione VPN sicura per l'accesso alla condivisione FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-200">The Subscriber should use a secure VPN connection when accessing the FTP share.</span></span> <span data-ttu-id="623a1-201">I valori dell'account di accesso e della password vengono forniti tramite le variabili di scripting**sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="623a1-201">**sqlcmd** scripting variables are used to supply login and password values.</span></span> <span data-ttu-id="623a1-202">Per altre informazioni, vedere [Usare sqlcmd con variabili di scripting](../../scripting/sqlcmd-use-with-scripting-variables.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-202">For more information, see [Use sqlcmd with Scripting Variables](../../scripting/sqlcmd-use-with-scripting-variables.md).</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_ftp](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepubftp.sql#sp_createmergepub_ftp)]  
  
 <span data-ttu-id="623a1-203">Nell'esempio seguente viene creata una sottoscrizione in una pubblicazione di tipo merge in cui il Sottoscrittore ottiene lo snapshot tramite FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-203">The following example creates a subscription to a merge publication, where the Subscriber obtains the snapshot using FTP.</span></span> <span data-ttu-id="623a1-204">Il Sottoscrittore deve utilizzare una connessione VPN sicura per l'accesso alla condivisione FTP.</span><span class="sxs-lookup"><span data-stu-id="623a1-204">The Subscriber should use a secure VPN connection when accessing the FTP share.</span></span> <span data-ttu-id="623a1-205">I valori dell'account di accesso e della password vengono forniti tramite le variabili di scripting**sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="623a1-205">**sqlcmd** scripting variables are used to supply login and password values.</span></span> <span data-ttu-id="623a1-206">Per altre informazioni, vedere [Usare sqlcmd con variabili di scripting](../../scripting/sqlcmd-use-with-scripting-variables.md).</span><span class="sxs-lookup"><span data-stu-id="623a1-206">For more information, see [Use sqlcmd with Scripting Variables](../../scripting/sqlcmd-use-with-scripting-variables.md).</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_ftp](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepullsubftp.sql#sp_createmergepullsub_ftp)]  
  
 [!code-sql[HowTo#sp_createmergepullsubagent_ftp](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepullsubftp.sql#sp_createmergepullsubagent_ftp)]  
  
## <a name="see-also"></a><span data-ttu-id="623a1-207">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="623a1-207">See Also</span></span>  
 <span data-ttu-id="623a1-208">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="623a1-208">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 <span data-ttu-id="623a1-209">[Trasferire snapshot tramite FTP](../transfer-snapshots-through-ftp.md) </span><span class="sxs-lookup"><span data-stu-id="623a1-209">[Transfer Snapshots Through FTP](../transfer-snapshots-through-ftp.md) </span></span>  
 <span data-ttu-id="623a1-210">[Modificare le proprietà di pubblicazioni e articoli](change-publication-and-article-properties.md) </span><span class="sxs-lookup"><span data-stu-id="623a1-210">[Change Publication and Article Properties](change-publication-and-article-properties.md) </span></span>  
 [<span data-ttu-id="623a1-211">Inizializzare una sottoscrizione con uno snapshot</span><span class="sxs-lookup"><span data-stu-id="623a1-211">Initialize a Subscription with a Snapshot</span></span>](../initialize-a-subscription-with-a-snapshot.md)  
  
  
