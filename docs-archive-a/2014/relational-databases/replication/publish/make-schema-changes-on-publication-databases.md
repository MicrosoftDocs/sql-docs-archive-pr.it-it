---
title: Apportare modifiche allo schema nei database di pubblicazione | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], schema changes
- snapshot replication [SQL Server], replicating schema changes
- merge replication [SQL Server replication], replicating schema changes
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
- publishing [SQL Server replication], schema changes
ms.assetid: 926c88d7-a844-402f-bcb9-db49e5013b69
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26d3e89fcba41d474ca56637f9e465f17127348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624046"
---
# <a name="make-schema-changes-on-publication-databases"></a><span data-ttu-id="ee77c-102">Modifiche allo schema nei database di pubblicazione</span><span class="sxs-lookup"><span data-stu-id="ee77c-102">Make Schema Changes on Publication Databases</span></span>
  <span data-ttu-id="ee77c-103">La replica supporta una vasta gamma di modifiche dello schema negli oggetti pubblicati.</span><span class="sxs-lookup"><span data-stu-id="ee77c-103">Replication supports a wide range of schema changes to published objects.</span></span> <span data-ttu-id="ee77c-104">Quando si apporta una delle seguenti modifiche dello schema nell'oggetto pubblicato appropriato nel server di pubblicazione [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], tale modifica viene propagata per impostazione predefinita a tutti i Sottoscrittori [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="ee77c-104">When you make any of the following schema changes on the appropriate published object at a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, that change is propagated by default to all [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscribers:</span></span>  
  
-   <span data-ttu-id="ee77c-105">MODIFICA TABELLA</span><span class="sxs-lookup"><span data-stu-id="ee77c-105">ALTER TABLE</span></span>  
  
-   <span data-ttu-id="ee77c-106">ALTER TABLE SET LOCK ESCALATION non deve essere utilizzato se la replica della modifica dello schema è abilitata e una topologia include [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] o [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span><span class="sxs-lookup"><span data-stu-id="ee77c-106">ALTER TABLE SET LOCK ESCALATION should not be used if schema change replication is enabled and a topology includes [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span></span>  
  
-   <span data-ttu-id="ee77c-107">ALTER PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="ee77c-107">ALTER PROCEDURE</span></span>  
  
-   <span data-ttu-id="ee77c-108">ALTER FUNCTION</span><span class="sxs-lookup"><span data-stu-id="ee77c-108">ALTER FUNCTION</span></span>  
  
-   <span data-ttu-id="ee77c-109">ALTER TRIGGER</span><span class="sxs-lookup"><span data-stu-id="ee77c-109">ALTER TRIGGER</span></span>  
  
     <span data-ttu-id="ee77c-110">È possibile utilizzare ALTER TRIGGER solo per trigger [DML]\ (Data Manipulation Language), in quanto non è possibile replicare trigger [DDL] \(Data Definition Language).</span><span class="sxs-lookup"><span data-stu-id="ee77c-110">ALTER TRIGGER can be used only for data manipulation language [DML] triggers because data definition language [DDL] triggers cannot be replicated.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ee77c-111">È necessario apportare le modifiche dello schema nelle tabelle tramite [!INCLUDE[tsql](../../../includes/tsql-md.md)] o [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO).</span><span class="sxs-lookup"><span data-stu-id="ee77c-111">Schema changes to tables must be made by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="ee77c-112">Quando si apportano modifiche dello schema in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] tenta di eliminare e ricreare la tabella.</span><span class="sxs-lookup"><span data-stu-id="ee77c-112">When schema changes are made in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] attempts to drop and re-create the table.</span></span> <span data-ttu-id="ee77c-113">Poiché non è possibile eliminare gli oggetti pubblicati, la modifica dello schema ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="ee77c-113">You cannot drop published objects, therefore the schema change fails.</span></span>  
  
 <span data-ttu-id="ee77c-114">Per la replica transazionale e di tipo merge, le modifiche dello schema vengono propagate in modo incrementale quando l'agente di distribuzione o l'agente di merge è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-114">For transactional replication and merge replication, schema changes are propagated incrementally when the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="ee77c-115">Per la replica snapshot, le modifiche dello schema vengono propagate quando viene applicato un nuovo snapshot al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-115">For snapshot replication, schema changes are propagated when a new snapshot is applied at the Subscriber.</span></span> <span data-ttu-id="ee77c-116">Nella replica snapshot, una nuova copia dello schema viene inviata al Sottoscrittore ogni volta che viene eseguita la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-116">In snapshot replication, a new copy of the schema is sent to the Subscriber each time synchronization occurs.</span></span> <span data-ttu-id="ee77c-117">Pertanto, tutte le modifiche dello schema, non solo quelle elencate sopra, negli oggetti pubblicati in precedenza vengono automaticamente propagate con ogni sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-117">Therefore, all schema changes (not just those listed above) to previously published objects are automatically propagated with each synchronization.</span></span>  
  
 <span data-ttu-id="ee77c-118">Per informazioni sull'aggiunta e l'eliminazione di articoli nelle pubblicazioni, vedere [Aggiungere ed eliminare articoli in pubblicazioni esistenti](add-articles-to-and-drop-articles-from-existing-publications.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-118">For information about adding and removing articles from publications, see [Add Articles to and Drop Articles from Existing Publications](add-articles-to-and-drop-articles-from-existing-publications.md).</span></span>  
  
 <span data-ttu-id="ee77c-119">**Per replicare le modifiche dello schema**</span><span class="sxs-lookup"><span data-stu-id="ee77c-119">**To replicate schema changes**</span></span>  
  
 <span data-ttu-id="ee77c-120">Le modifiche dello schema elencate sopra vengono replicate per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="ee77c-120">The schema changes listed above are replicated by default.</span></span> <span data-ttu-id="ee77c-121">Per informazioni sulla disabilitazione della replica delle modifiche dello schema, vedere [Replicate Schema Changes](replicate-schema-changes.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-121">For information about disabling the replication of schema changes, see [Replicate Schema Changes](replicate-schema-changes.md).</span></span>  
  
## <a name="considerations-for-schema-changes"></a><span data-ttu-id="ee77c-122">Considerazioni sulle modifiche dello schema</span><span class="sxs-lookup"><span data-stu-id="ee77c-122">Considerations for Schema Changes</span></span>  
 <span data-ttu-id="ee77c-123">Quando si replicano le modifiche dello schema, tenere presenti le considerazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="ee77c-123">Keep the following considerations in mind when replicating schema changes.</span></span>  
  
### <a name="general-considerations"></a><span data-ttu-id="ee77c-124">Considerazioni generali</span><span class="sxs-lookup"><span data-stu-id="ee77c-124">General Considerations</span></span>  
  
-   <span data-ttu-id="ee77c-125">Le modifiche dello schema sono soggette a tutte le restrizioni imposte da [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee77c-125">Schema changes are subject to any restrictions imposed by [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="ee77c-126">ALTER TABLE, ad esempio, non consente di eseguire l'istruzione ALTER per le colonne chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="ee77c-126">For example, ALTER TABLE does not allow you to ALTER primary key columns.</span></span>  
  
-   <span data-ttu-id="ee77c-127">Il mapping dei tipi di dati viene eseguito solo per lo snapshot iniziale.</span><span class="sxs-lookup"><span data-stu-id="ee77c-127">Data type mapping is performed only for the initial snapshot.</span></span> <span data-ttu-id="ee77c-128">Il mapping delle modifiche dello schema alle versioni precedenti dei tipi di dati non viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="ee77c-128">Schema changes are not mapped to previous versions of data types.</span></span> <span data-ttu-id="ee77c-129">Se ad esempio viene utilizzata l'istruzione `ALTER TABLE ADD datetime2 column` in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], il tipo di dati non viene convertito in `nvarchar` per i Sottoscrittori di [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ee77c-129">For example, if the statement `ALTER TABLE ADD datetime2 column` is used in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the data type is not translated to `nvarchar` for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Subscribers.</span></span> <span data-ttu-id="ee77c-130">In alcuni casi, le modifiche dello schema vengono bloccate nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-130">In some cases, schema changes are blocked on the Publisher.</span></span>  
  
-   <span data-ttu-id="ee77c-131">Se si imposta una pubblicazione in modo da consentire la propagazione delle modifiche dello schema, queste ultime vengono propagate indipendentemente da come è impostata la relativa opzione dello schema per un articolo nella pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-131">If a publication is set to allow the propagation of schema changes, schema changes are propagated regardless of how the related schema option is set for an article in the publication.</span></span> <span data-ttu-id="ee77c-132">Se, ad esempio, si sceglie di non replicare i vincoli di chiave esterna per un articolo di tabella, ma in seguito si esegue un comando ALTER TABLE che aggiunge una chiave esterna alla tabella nel server di pubblicazione, la chiave esterna viene aggiunta alla tabella nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-132">For example, if you select not to replicate foreign key constraints for a table article, but then issue an ALTER TABLE command that adds a foreign key to the table at the Publisher, the foreign key is added to the table at the Subscriber.</span></span> <span data-ttu-id="ee77c-133">Per evitare questo problema, disabilitare la propagazione delle modifiche dello schema prima di eseguire il comando ALTER TABLE.</span><span class="sxs-lookup"><span data-stu-id="ee77c-133">To prevent this, disable the propagation of schema changes before issuing the ALTER TABLE command.</span></span>  
  
-   <span data-ttu-id="ee77c-134">Le modifiche dello schema devono essere apportate solo nel server di pubblicazione, non nei Sottoscrittori, inclusi i Sottoscrittori di ripubblicazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-134">Schema changes should be made only at the Publisher, not at Subscribers (including republishing Subscribers).</span></span> <span data-ttu-id="ee77c-135">La replica di tipo merge impedisce le modifiche dello schema nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-135">Merge replication prevents schema changes at the Subscriber.</span></span> <span data-ttu-id="ee77c-136">La replica transazionale non impedisce le modifiche, ma le modifiche possono provocare errori nella replica.</span><span class="sxs-lookup"><span data-stu-id="ee77c-136">Transactional replication does not prevent the changes, but the changes can cause replication to fail.</span></span>  
  
-   <span data-ttu-id="ee77c-137">Per impostazione predefinita, le modifiche propagate a un Sottoscrittore di ripubblicazione vengono propagate ai relativi Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="ee77c-137">Changes propagated to a republishing Subscriber are by default propagated to its Subscribers.</span></span>  
  
-   <span data-ttu-id="ee77c-138">Se la modifica dello schema fa riferimento a oggetti o vincoli esistenti nel server di pubblicazione, ma non nel Sottoscrittore, la modifica dello schema avrà esito positivo nel server di pubblicazione, ma negativo nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-138">If the schema change references objects or constraints existing on the Publisher but not on the Subscriber, the schema change will succeed on the Publisher but will fail on the Subscriber.</span></span>  
  
-   <span data-ttu-id="ee77c-139">È necessario che il nome e il proprietario di tutti gli oggetti nel Sottoscrittore a cui si fa riferimento quando si aggiunge una chiave esterna siano gli stessi dell'oggetto corrispondente nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-139">All objects on the Subscriber that are referenced when adding a foreign key must have the same name and owner as the corresponding object on the Publisher.</span></span>  
  
-   <span data-ttu-id="ee77c-140">L'aggiunta, la rimozione e la modifica di indici in modo esplicito non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="ee77c-140">Explicitly adding, dropping, or altering indexes is not supported.</span></span> <span data-ttu-id="ee77c-141">Gli indici creati in modo implicito per i vincoli, ad esempio un vincolo di chiave primaria, sono supportati.</span><span class="sxs-lookup"><span data-stu-id="ee77c-141">Indexes created implicitly for constraints (such as a primary key constraint) are supported.</span></span>  
  
-   <span data-ttu-id="ee77c-142">La modifica o l'eliminazione di colonne Identity gestite dalla replica non è supportata.</span><span class="sxs-lookup"><span data-stu-id="ee77c-142">Altering or dropping identity columns that are managed by replication is not supported.</span></span> <span data-ttu-id="ee77c-143">Per altre informazioni sulla gestione automatica di colonne Identity, vedere [Replicare colonne Identity](replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-143">For more information about automatic management of identity columns, see [Replicate Identity Columns](replicate-identity-columns.md).</span></span>  
  
-   <span data-ttu-id="ee77c-144">Le modifiche dello schema che includono funzioni non deterministiche non sono supportate, in quanto possono restituire dati diversi nel server di pubblicazione e nel Sottoscrittore, impedendo la convergenza.</span><span class="sxs-lookup"><span data-stu-id="ee77c-144">Schema changes that include nondeterministic functions are not supported because they can result in data at the Publisher and Subscriber being different (referred to as non-convergence).</span></span> <span data-ttu-id="ee77c-145">Se, ad esempio, si esegue il comando `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`nel server di pubblicazione, i valori saranno diversi quando il comando viene replicato nel Sottoscrittore ed eseguito.</span><span class="sxs-lookup"><span data-stu-id="ee77c-145">For example, if you issue the following command at the Publisher: `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, the values are different when the command is replicated to the Subscriber and executed.</span></span> <span data-ttu-id="ee77c-146">Per altre informazioni sulle funzioni non deterministiche, vedere [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-146">For more information about nondeterministic functions, see [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span></span>  
  
-   <span data-ttu-id="ee77c-147">È consigliabile denominare i vincoli in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="ee77c-147">It is recommended that constraints be explicitly named.</span></span> <span data-ttu-id="ee77c-148">Se un vincolo non viene denominato in modo esplicito, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] genera un nome per il vincolo, che sarà diverso nel server di pubblicazione e in ogni Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-148">If a constraint is not explicitly named, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a name for the constraint, and these names will be different on the Publisher and each Subscriber.</span></span> <span data-ttu-id="ee77c-149">Ciò può causare problemi durante la replica delle modifiche dello schema.</span><span class="sxs-lookup"><span data-stu-id="ee77c-149">This can cause issues during the replication of schema changes.</span></span> <span data-ttu-id="ee77c-150">Se ad esempio viene eliminata una colonna nel server di pubblicazione, insieme a un vincolo dipendente, il processo di replica tenterà di eliminare tale vincolo nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-150">For example, if you drop a column at the Publisher and a dependent constraint is dropped, replication will attempt to drop the constraint at the Subscriber.</span></span> <span data-ttu-id="ee77c-151">L'eliminazione del vincolo nel Sottoscrittore non potrà tuttavia essere eseguita, poiché il nome del vincolo è diverso.</span><span class="sxs-lookup"><span data-stu-id="ee77c-151">The drop at the Subscriber will fail because the name of the constraint is different.</span></span> <span data-ttu-id="ee77c-152">Se la sincronizzazione ha esito negativo per un problema di denominazione del vincolo, eliminare manualmente il vincolo nel Sottoscrittore e quindi eseguire nuovamente l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="ee77c-152">If synchronization fails because of a constraint naming issue, manually drop the constraint at the Subscriber and then rerun the Merge Agent.</span></span>  
  
-   <span data-ttu-id="ee77c-153">Se viene pubblicata una tabella per la replica, non è possibile modificare una colonna in tale tabella impostando il tipo di dati XML se è già stato generato uno snapshot di pubblicazione. Per modificare la colonna, è necessario prima rimuovere la replica.</span><span class="sxs-lookup"><span data-stu-id="ee77c-153">If a table is published for replication, it is not possible to alter a column in that table to a data type of XML if a publication snapshot has already been generated To alter the column, you must first remove replication.</span></span>  
  
-   <span data-ttu-id="ee77c-154">Read Uncommitted non è un livello di isolamento supportato quando si esegue la DDL in una tabella pubblicata.</span><span class="sxs-lookup"><span data-stu-id="ee77c-154">Read uncommitted is not a supported isolation level when doing DDL on a published table.</span></span>  
  
-   <span data-ttu-id="ee77c-155">È consigliabile non utilizzare `SET CONTEXT_INFO` per modificare il contesto delle transazioni in cui le modifiche dello schema vengono effettuate negli oggetti pubblicati.</span><span class="sxs-lookup"><span data-stu-id="ee77c-155">`SET CONTEXT_INFO` should not be used to modify the context of transactions where schema changes are performed against published objects.</span></span>  
  
#### <a name="adding-columns"></a><span data-ttu-id="ee77c-156">Aggiunta di colonne</span><span class="sxs-lookup"><span data-stu-id="ee77c-156">Adding Columns</span></span>  
  
-   <span data-ttu-id="ee77c-157">Per aggiungere una nuova colonna a una tabella e includere la colonna in una pubblicazione esistente, eseguire ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="ee77c-157">To add a new column to a table and include that column in an existing publication, execute ALTER TABLE \<Table> ADD \<Column>.</span></span> <span data-ttu-id="ee77c-158">Per impostazione predefinita, la colonna viene quindi replicata a tutti i Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="ee77c-158">By default, the column is then replicated to all Subscribers.</span></span> <span data-ttu-id="ee77c-159">È necessario che la colonna consenta i valori NULL o che includa un vincolo DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="ee77c-159">The column must allow NULL values or include a default constraint.</span></span> <span data-ttu-id="ee77c-160">Per altre informazioni sull'aggiunta di colonne, vedere la sezione "Replica di tipo merge" in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="ee77c-160">For more information about adding columns, see the "Merge Replication" section in this topic.</span></span>  
  
-   <span data-ttu-id="ee77c-161">Per aggiungere una nuova colonna a una tabella e non includere la colonna in una pubblicazione esistente, disabilitare la replica delle modifiche dello schema e quindi eseguire ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="ee77c-161">To add a new column to a table and not include that column in an existing publication, disable the replication of schema changes, and then execute ALTER TABLE \<Table> ADD \<Column>.</span></span>  
  
-   <span data-ttu-id="ee77c-162">Per includere una colonna esistente in una pubblicazione esistente, usare [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) o la finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="ee77c-162">To include an existing column in an existing publication, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="ee77c-163">Per altre informazioni, vedere [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-163">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="ee77c-164">Sarà necessario reinizializzare le sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="ee77c-164">This will require subscriptions to be reinitialized.</span></span>  
  
-   <span data-ttu-id="ee77c-165">Non è consentito aggiungere una colonna Identity a una tabella pubblicata, perché ciò può impedire la convergenza dei dati durante la replica della colonna nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-165">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="ee77c-166">I valori della colonna Identity nel server di pubblicazione dipendono dall'ordine in cui vengono fisicamente archiviate le righe della tabella interessata.</span><span class="sxs-lookup"><span data-stu-id="ee77c-166">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="ee77c-167">Nel caso in cui le righe siano state archiviate in modo diverso nel Sottoscrittore, il valore della colonna Identity può essere diverso per le stesse righe.</span><span class="sxs-lookup"><span data-stu-id="ee77c-167">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
#### <a name="dropping-columns"></a><span data-ttu-id="ee77c-168">Eliminazione di colonne</span><span class="sxs-lookup"><span data-stu-id="ee77c-168">Dropping Columns</span></span>  
  
-   <span data-ttu-id="ee77c-169">Per eliminare una colonna da una pubblicazione esistente e dalla tabella nel server di pubblicazione, eseguire ALTER TABLE \<Table> DROP \<Column>.</span><span class="sxs-lookup"><span data-stu-id="ee77c-169">To drop a column from an existing publication and drop the column from the table at the Publisher, execute ALTER TABLE \<Table> DROP \<Column>.</span></span> <span data-ttu-id="ee77c-170">Per impostazione predefinita, la colonna viene quindi eliminata dalla tabella in tutti i Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="ee77c-170">By default, the column is then dropped from the table at all Subscribers.</span></span>  
  
-   <span data-ttu-id="ee77c-171">Per eliminare una colonna da una pubblicazione esistente, ma mantenerla nella tabella del server di pubblicazione, usare [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) o la finestra di dialogo **Proprietà pubblicazione - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="ee77c-171">To drop a column from an existing publication but retain the column in the table at the Publisher, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="ee77c-172">Per altre informazioni, vedere [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-172">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="ee77c-173">Sarà necessario generare un nuovo snapshot.</span><span class="sxs-lookup"><span data-stu-id="ee77c-173">This will require a new snapshot to be generated.</span></span>  
  
-   <span data-ttu-id="ee77c-174">La colonna da eliminare non può essere utilizzata nelle clausole di filtro degli articoli contenuti nelle pubblicazioni del database.</span><span class="sxs-lookup"><span data-stu-id="ee77c-174">The column to be dropped cannot be used in the filter clauses of any article of any publication in the database.</span></span>  
  
-   <span data-ttu-id="ee77c-175">Quando si elimina una colonna da un articolo pubblicato, considerare eventuali vincoli, indici o proprietà della colonna che potrebbero avere conseguenze sul database.</span><span class="sxs-lookup"><span data-stu-id="ee77c-175">When dropping a column from a published article, take into consideration any constraints, indexes, or properties of the column that could affect the database.</span></span> <span data-ttu-id="ee77c-176">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="ee77c-176">For example:</span></span>  
  
    -   <span data-ttu-id="ee77c-177">Non è possibile eliminare le colonne utilizzate in una chiave primaria dagli articoli nelle pubblicazioni transazionali, in quanto vengono utilizzate dalla replica.</span><span class="sxs-lookup"><span data-stu-id="ee77c-177">You cannot drop columns used in a primary key from articles in transactional publications, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="ee77c-178">Non è possibile eliminare la colonna rowguid dagli articoli nelle pubblicazioni di tipo merge o la colonna mstran_repl_version dagli articoli nelle pubblicazioni transazionali che supportano l'aggiornamento delle sottoscrizioni, in quanto queste colonne vengono utilizzate dalla replica.</span><span class="sxs-lookup"><span data-stu-id="ee77c-178">You cannot drop the rowguid column from articles in merge publications or the mstran_repl_version column from articles in transactional publications that support updating subscriptions, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="ee77c-179">Le modifiche degli indici non vengono propagate ai Sottoscrittori. Se si elimina una colonna e un indice dipendente nel server di pubblicazione, l'eliminazione dell'indice non viene replicata.</span><span class="sxs-lookup"><span data-stu-id="ee77c-179">Index changes are not propagated to Subscribers: if you drop a column at the Publisher and a dependent index is dropped, the index drop is not replicated.</span></span> <span data-ttu-id="ee77c-180">È necessario eliminare l'indice nel Sottoscrittore prima di eliminare la colonna nel server di pubblicazione, in modo che l'eliminazione della colonna abbia esito positivo quando viene replicata dal server di pubblicazione al Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-180">You should drop the index at the Subscriber before dropping the column at the Publisher, so that the column drop succeeds when it is replicated from the Publisher to the Subscriber.</span></span> <span data-ttu-id="ee77c-181">Se la sincronizzazione non riesce a causa di un indice nel Sottoscrittore, eliminare manualmente l'indice nel Sottoscrittore e quindi eseguire nuovamente l'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="ee77c-181">If synchronization fails because of an index at the Subscriber, manually drop the index and then rerun the Merge Agent.</span></span>  
  
    -   <span data-ttu-id="ee77c-182">I vincoli devono essere denominati in modo esplicito per poter essere eliminati.</span><span class="sxs-lookup"><span data-stu-id="ee77c-182">Constraints should be explicitly named to allow for dropping.</span></span> <span data-ttu-id="ee77c-183">Per altre informazioni, vedere la sezione "Considerazioni generali" più indietro in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="ee77c-183">For more information, see the "General Considerations" section earlier in this topic.</span></span>  
  
### <a name="transactional-replication"></a><span data-ttu-id="ee77c-184">Replica transazionale</span><span class="sxs-lookup"><span data-stu-id="ee77c-184">Transactional Replication</span></span>  
  
-   <span data-ttu-id="ee77c-185">Le modifiche dello schema vengono propagate ai Sottoscrittori in cui sono in esecuzione versioni precedenti di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], ma l'istruzione DDL deve includere solo la sintassi supportata dalla versione nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-185">Schema changes are propagated to Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], but the DDL statement should only include syntax supported by the version at the Subscriber.</span></span>  
  
     <span data-ttu-id="ee77c-186">Se il Sottoscrittore ripubblica i dati, le uniche modifiche dello schema supportate sono l'aggiunta e l'eliminazione di una colonna.</span><span class="sxs-lookup"><span data-stu-id="ee77c-186">If the Subscriber republishes data, the only supported schema changes are adding and dropping a column.</span></span> <span data-ttu-id="ee77c-187">Queste modifiche devono essere apportate nel server di pubblicazione tramite [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) e [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) anziché con la sintassi ALTER TABLE DDL.</span><span class="sxs-lookup"><span data-stu-id="ee77c-187">These changes should be made on the Publisher using [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) rather than ALTER TABLE DDL syntax.</span></span>  
  
-   <span data-ttu-id="ee77c-188">Le modifiche dello schema non vengono replicate nei Sottoscrittori non SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ee77c-188">Schema changes are not replicated to non-SQL Server Subscribers.</span></span>  
  
-   <span data-ttu-id="ee77c-189">Le modifiche dello schema non vengono propagate dai server di pubblicazione non[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ee77c-189">Schema changes are not propagated from non-[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publishers.</span></span>  
  
-   <span data-ttu-id="ee77c-190">Non è possibile modificare le viste indicizzate replicate come tabelle.</span><span class="sxs-lookup"><span data-stu-id="ee77c-190">You cannot alter indexed views that are replicated as tables.</span></span> <span data-ttu-id="ee77c-191">È possibile modificare le viste indicizzate replicate come viste indicizzate, ma la modifica ne comporta la trasformazione in viste normali.</span><span class="sxs-lookup"><span data-stu-id="ee77c-191">Indexed views that are replicated as indexed views can be altered, but altering them will cause them to become regular views, rather than indexed views.</span></span>  
  
-   <span data-ttu-id="ee77c-192">Se la pubblicazione supporta le sottoscrizioni ad aggiornamento immediato o ad aggiornamento in coda, il sistema deve essere messo in stato di inattività prima di apportare modifiche dello schema: è necessario arrestare tutte le attività nella tabella pubblicata nel server di pubblicazione e nei Sottoscrittori e propagare a tutti i nodi le modifiche ai dati in sospeso.</span><span class="sxs-lookup"><span data-stu-id="ee77c-192">If the publication supports immediate updating or queued updating subscriptions, the system must be quiesced before making schema changes: all activity on the published table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes.</span></span> <span data-ttu-id="ee77c-193">Dopo avere propagato a tutti i nodi le modifiche dello schema, è possibile riprendere le attività nelle tabelle pubblicate.</span><span class="sxs-lookup"><span data-stu-id="ee77c-193">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span>  
  
-   <span data-ttu-id="ee77c-194">Se la pubblicazione si trova in una topologia peer-to-peer, è necessario mettere il sistema in stato di inattività prima di apportare modifiche dello schema.</span><span class="sxs-lookup"><span data-stu-id="ee77c-194">If the publication is in a peer-to-peer topology, the system must be quiesced before making schema changes.</span></span> <span data-ttu-id="ee77c-195">Per altre informazioni, vedere [Come mettere una topologia di replica in stato di inattività &#40;programmazione Transact-SQL della replica&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="ee77c-195">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="ee77c-196">L'aggiunta di una colonna timestamp a una tabella e il mapping tra timestamp e binary(8) provoca la reinizializzazione dell'articolo per tutte le sottoscrizioni attive.</span><span class="sxs-lookup"><span data-stu-id="ee77c-196">Adding a timestamp column to a table and mapping the timestamp to binary(8) causes the article to be reinitialized for all active subscriptions.</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="ee77c-197">Replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="ee77c-197">Merge Replication</span></span>  
  
-   <span data-ttu-id="ee77c-198">La modalità di gestione delle modifiche dello schema da parte della replica di tipo merge è determinata dal livello di compatibilità della pubblicazione e dal fatto che lo snapshot sia impostato in modalità nativa (impostazione predefinita) o in modalità carattere:</span><span class="sxs-lookup"><span data-stu-id="ee77c-198">How merge replication handles schema changes is determined by the publication compatibility level, and whether the snapshot is set to native mode (default) or character mode:</span></span>  
  
    -   <span data-ttu-id="ee77c-199">Per replicare le modifiche dello schema, è necessario che il livello di compatibilità della pubblicazione sia almeno 90RTM.</span><span class="sxs-lookup"><span data-stu-id="ee77c-199">To replicate schema changes, the compatibility level of the publication must be at least 90RTM.</span></span> <span data-ttu-id="ee77c-200">Se nei Sottoscrittori sono in esecuzione versioni precedenti di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] o se il livello di compatibilità è inferiore a 90RTM, è possibile usare [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) e [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) per aggiungere ed eliminare colonne.</span><span class="sxs-lookup"><span data-stu-id="ee77c-200">If Subscribers are running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or the compatibility level is less than 90RTM you can use [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) to add and drop columns.</span></span> <span data-ttu-id="ee77c-201">Tuttavia, queste procedure sono deprecate.</span><span class="sxs-lookup"><span data-stu-id="ee77c-201">However, these procedures are deprecated.</span></span>  
  
    -   <span data-ttu-id="ee77c-202">Se si tenta di aggiungere a un articolo esistente una colonna con un tipo di dati introdotto in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] presenta il comportamento seguente:</span><span class="sxs-lookup"><span data-stu-id="ee77c-202">If you try to add to an existing article a column with a data type that was introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has the following behavior:</span></span>  
  
        ||<span data-ttu-id="ee77c-203">100RTM, snapshot nativo</span><span class="sxs-lookup"><span data-stu-id="ee77c-203">100RTM, native snapshot</span></span>|<span data-ttu-id="ee77c-204">100RTM, snapshot carattere</span><span class="sxs-lookup"><span data-stu-id="ee77c-204">100RTM, character snapshot</span></span>|<span data-ttu-id="ee77c-205">Tutti gli altri livelli di compatibilità</span><span class="sxs-lookup"><span data-stu-id="ee77c-205">All other compatibility levels</span></span>|  
        |-|-----------------------------|--------------------------------|------------------------------------|  
        |`hierarchyid`|<span data-ttu-id="ee77c-206">Modifica consentita</span><span class="sxs-lookup"><span data-stu-id="ee77c-206">Allow change</span></span>|<span data-ttu-id="ee77c-207">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-207">Block change</span></span>|<span data-ttu-id="ee77c-208">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-208">Block change</span></span>|  
        |<span data-ttu-id="ee77c-209">`geography` e `geometry`</span><span class="sxs-lookup"><span data-stu-id="ee77c-209">`geography` and `geometry`</span></span>|<span data-ttu-id="ee77c-210">Modifica consentita</span><span class="sxs-lookup"><span data-stu-id="ee77c-210">Allow change</span></span>|<span data-ttu-id="ee77c-211">Consenti modifica<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="ee77c-211">Allow change<sup>1</sup></span></span>|<span data-ttu-id="ee77c-212">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-212">Block change</span></span>|  
        |`filestream`|<span data-ttu-id="ee77c-213">Modifica consentita</span><span class="sxs-lookup"><span data-stu-id="ee77c-213">Allow change</span></span>|<span data-ttu-id="ee77c-214">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-214">Block change</span></span>|<span data-ttu-id="ee77c-215">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-215">Block change</span></span>|  
        |<span data-ttu-id="ee77c-216">`date`, `time`, `datetime2` e `datetimeoffset`</span><span class="sxs-lookup"><span data-stu-id="ee77c-216">`date`, `time`, `datetime2`, and `datetimeoffset`</span></span>|<span data-ttu-id="ee77c-217">Modifica consentita</span><span class="sxs-lookup"><span data-stu-id="ee77c-217">Allow change</span></span>|<span data-ttu-id="ee77c-218">Consenti modifica<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="ee77c-218">Allow change<sup>1</sup></span></span>|<span data-ttu-id="ee77c-219">Modifica bloccata</span><span class="sxs-lookup"><span data-stu-id="ee77c-219">Block change</span></span>|  
  
         <span data-ttu-id="ee77c-220"><sup>1</sup> SQL Server Compact i sottoscrittori convertono questi tipi di dati nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="ee77c-220"><sup>1</sup> SQL Server Compact Subscribers convert these data types at the Subscriber.</span></span>  
  
-   <span data-ttu-id="ee77c-221">Se si verifica un errore quando si applica una modifica dello schema, ad esempio un errore dovuto all'aggiunta di una chiave esterna che fa riferimento a una tabella non disponibile nel Sottoscrittore, la sincronizzazione ha esito negativo ed è necessario reinizializzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="ee77c-221">If an error occurs when applying a schema change (such as an error resulting from adding a foreign key that references a table not available at the Subscriber), synchronization fails and the subscription must be reinitialized.</span></span>  
  
-   <span data-ttu-id="ee77c-222">Se si apporta una modifica dello schema in una colonna coinvolta in un filtro join o in un filtro con parametri, è necessario reinizializzare tutte le sottoscrizioni e rigenerare lo snapshot.</span><span class="sxs-lookup"><span data-stu-id="ee77c-222">If a schema change is made on a column involved in a join filter or parameterized filter, you must reinitialize all subscriptions and regenerate the snapshot.</span></span>  
  
-   <span data-ttu-id="ee77c-223">La replica di tipo merge offre stored procedure che consentono di ignorare le modifiche dello schema durante la risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="ee77c-223">Merge replication provides stored procedures to skip schema changes during troubleshooting.</span></span> <span data-ttu-id="ee77c-224">Per altre informazioni, vedere [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) e [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="ee77c-224">For more information, see [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) and [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ee77c-225">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ee77c-225">See Also</span></span>  
 <span data-ttu-id="ee77c-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ee77c-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span></span>  
 <span data-ttu-id="ee77c-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ee77c-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span></span>  
 <span data-ttu-id="ee77c-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ee77c-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span></span>  
 <span data-ttu-id="ee77c-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ee77c-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span></span>  
 <span data-ttu-id="ee77c-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="ee77c-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span></span>  
 <span data-ttu-id="ee77c-231">[Pubblicare dati e oggetti di database](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="ee77c-231">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="ee77c-232">Rigenerare procedure transazionali personalizzate per riflettere le modifiche dello schema</span><span class="sxs-lookup"><span data-stu-id="ee77c-232">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>](../transactional/transactional-articles-regenerate-to-reflect-schema-changes.md)  
  
  
