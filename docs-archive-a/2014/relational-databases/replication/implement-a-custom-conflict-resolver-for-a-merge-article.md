---
title: Implementare un sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], stored procedure-based resolvers
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
ms.assetid: 76bd8524-ebc1-4d80-b5a2-4169944d6ac0
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 23e684213114f3c9bb2f1ad56de06fcfc89b819a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87624589"
---
# <a name="implement-a-custom-conflict-resolver-for-a-merge-article"></a><span data-ttu-id="e1434-102">Implementazione di un sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge</span><span class="sxs-lookup"><span data-stu-id="e1434-102">Implement a Custom Conflict Resolver for a Merge Article</span></span>
  <span data-ttu-id="e1434-103"> Questo argomento illustra come implementare il sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] tramite [!INCLUDE[tsql](../../includes/tsql-md.md)] o un [sistema di risoluzione personalizzato basato su COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="e1434-103">This topic describes how to implement custom conflict resolver for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[tsql](../../includes/tsql-md.md)] or a [COM-based custom resolver](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span></span>  
  
 <span data-ttu-id="e1434-104">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="e1434-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="e1434-105">**Per implementare un sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="e1434-105">**To implement custom conflict resolver for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="e1434-106">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e1434-106">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="e1434-107">Sistema di risoluzione basato su COM</span><span class="sxs-lookup"><span data-stu-id="e1434-107">COM-based Resolver</span></span>](#COM)  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="e1434-108">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e1434-108">Using Transact-SQL</span></span>  
 <span data-ttu-id="e1434-109">È possibile scrivere un sistema di risoluzione dei conflitti personalizzato come stored procedure [!INCLUDE[tsql](../../includes/tsql-md.md)] in ogni server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-109">You can write your own custom conflict resolver as a [!INCLUDE[tsql](../../includes/tsql-md.md)] stored procedure at each Publisher.</span></span> <span data-ttu-id="e1434-110">Durante la sincronizzazione questa stored procedure viene richiamata quando vengono rilevati conflitti in un articolo per il quale il sistema di risoluzione è stato registrato e l'agente di merge passa le informazioni sulla riga con conflitti ai parametri obbligatori della procedura.</span><span class="sxs-lookup"><span data-stu-id="e1434-110">During synchronization, this stored procedure is invoked when conflicts are encountered in an article to which the resolver was registered, and information on the conflict row is passed by the Merge Agent to the required parameters of the procedure.</span></span> <span data-ttu-id="e1434-111">I sistemi di risoluzione dei conflitti personalizzati basati su stored procedure vengono sempre creati nel server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-111">Stored procedure-based custom conflict resolvers are always created at the Publisher.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="e1434-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]i resolver di stored procedure vengono richiamati solo per gestire i conflitti basati sulla modifica delle righe.</span><span class="sxs-lookup"><span data-stu-id="e1434-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stored procedure resolvers are only invoked to handle row change-based conflicts.</span></span> <span data-ttu-id="e1434-113">Non possono essere utilizzati per gestire altri tipi di conflitti, ad esempio errori di inserimento dovuti a violazioni di PRIMARY KEY o del vincolo di indice univoco.</span><span class="sxs-lookup"><span data-stu-id="e1434-113">They cannot be used to handle other types of conflicts such as insert failures due to PRIMARY KEY violations or unique index constraint violations.</span></span>  
  
#### <a name="to-create-a-stored-procedure-based-custom-conflict-resolver"></a><span data-ttu-id="e1434-114">Per creare un sistema di risoluzione dei conflitti personalizzato basato su stored procedure</span><span class="sxs-lookup"><span data-stu-id="e1434-114">To create a stored procedure-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="e1434-115">Nella pubblicazione o nel database **msdb** del server di pubblicazione creare una nuova stored procedure di sistema che implementi i parametri obbligatori seguenti:</span><span class="sxs-lookup"><span data-stu-id="e1434-115">At the Publisher in either the publication or **msdb** database, create a new system stored procedure that implements the following required parameters:</span></span>  
  
    |<span data-ttu-id="e1434-116">Parametro</span><span class="sxs-lookup"><span data-stu-id="e1434-116">Parameter</span></span>|<span data-ttu-id="e1434-117">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="e1434-117">Data type</span></span>|<span data-ttu-id="e1434-118">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e1434-118">Description</span></span>|  
    |---------------|---------------|-----------------|  
    |**@tableowner**|`sysname`|<span data-ttu-id="e1434-119">Nome del proprietario della tabella per la quale risolvere un conflitto.</span><span class="sxs-lookup"><span data-stu-id="e1434-119">Name of the owner of the table for which a conflict is being resolved.</span></span> <span data-ttu-id="e1434-120">Si tratta del proprietario della tabella nel database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-120">This is the owner for the table in the publication database.</span></span>|  
    |**@tablename**|`sysname`|<span data-ttu-id="e1434-121">Nome della tabella per la quale risolvere un conflitto.</span><span class="sxs-lookup"><span data-stu-id="e1434-121">Name of the table for which a conflict is being resolved.</span></span>|  
    |**@rowguid**|`uniqueidentifier`|<span data-ttu-id="e1434-122">Identificatore univoco per la riga in cui è presente il conflitto.</span><span class="sxs-lookup"><span data-stu-id="e1434-122">Unique identifier for the row having the conflict.</span></span>|  
    |**@subscriber**|`sysname`|<span data-ttu-id="e1434-123">Nome del server da cui viene propagata una modifica in conflitto.</span><span class="sxs-lookup"><span data-stu-id="e1434-123">Name of the server from where a conflicting change is being propagated.</span></span>|  
    |**@subscriber_db**|`sysname`|<span data-ttu-id="e1434-124">Nome del database da cui viene propagata una modifica in conflitto.</span><span class="sxs-lookup"><span data-stu-id="e1434-124">Name of the database from where conflicting change is being propagated.</span></span>|  
    |<span data-ttu-id="e1434-125">**@log_conflictOUTPUT**</span><span class="sxs-lookup"><span data-stu-id="e1434-125">**@log_conflict OUTPUT**</span></span>|`int`|<span data-ttu-id="e1434-126">Indica se il processo di merge deve registrare un conflitto da risolvere in un secondo momento:</span><span class="sxs-lookup"><span data-stu-id="e1434-126">Whether the merge process should log a conflict for later resolution:</span></span><br /><br /> <span data-ttu-id="e1434-127">**0** = Il conflitto non viene registrato.</span><span class="sxs-lookup"><span data-stu-id="e1434-127">**0** = Do not log the conflict.</span></span><br /><br /> <span data-ttu-id="e1434-128">**1** = La riga in conflitto è quella del Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1434-128">**1** = Subscriber is the conflict loser.</span></span><br /><br /> <span data-ttu-id="e1434-129">**2** = La riga in conflitto è quella del server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-129">**2** = Publisher is the conflict loser.</span></span>|  
    |<span data-ttu-id="e1434-130">**@conflict_messageOUTPUT**</span><span class="sxs-lookup"><span data-stu-id="e1434-130">**@conflict_message OUTPUT**</span></span>|`nvarchar(512)`|<span data-ttu-id="e1434-131">Messaggio da visualizzare per la risoluzione se il conflitto viene registrato.</span><span class="sxs-lookup"><span data-stu-id="e1434-131">Message to be given about the resolution if the conflict is logged.</span></span>|  
    |**@destowner**|`sysname`|<span data-ttu-id="e1434-132">Proprietario della tabella pubblicata nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="e1434-132">The owner of the published table at the Subscriber.</span></span>|  
  
     <span data-ttu-id="e1434-133">Questa stored procedure utilizza i valori passati dall'agente di merge a questi parametri per implementare la logica di risoluzione dei conflitti personalizzata. Deve restituire un solo set di risultati della riga la cui struttura è identica a quella della tabella di base e che contiene i valori dei dati per la versione confermata della riga.</span><span class="sxs-lookup"><span data-stu-id="e1434-133">This stored procedure uses the values passed by the Merge Agent to these parameters to implement your custom conflict resolution logic; it must return a single row result set that is identical in structure to the base table and contains the data values for the winning version of the row.</span></span>  
  
2.  <span data-ttu-id="e1434-134">Concedere autorizzazioni EXECUTE sulla stored procedure a qualsiasi account di accesso utilizzato dai Sottoscrittori per la connessione al server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-134">Grant EXECUTE permissions on the stored procedure to any logins used by Subscribers to connect to the Publisher.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="e1434-135">Per utilizzare un sistema di risoluzione dei conflitti personalizzato con un nuovo articolo di tabella</span><span class="sxs-lookup"><span data-stu-id="e1434-135">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="e1434-136">Eseguire [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) per definire un articolo, specificando il valore **MicrosoftSQL** **Server Stored Procedure Resolver** per il parametro **@article_resolver** e il nome della stored procedure che implementa la logica del sistema di risoluzione dei conflitti per il parametro **@resolver_info**.</span><span class="sxs-lookup"><span data-stu-id="e1434-136">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying a value of **MicrosoftSQL** **Server Stored Procedure Resolver** for the **@article_resolver** parameter and the name of the stored procedure that implements the conflict resolver logic for the **@resolver_info** parameter.</span></span> <span data-ttu-id="e1434-137">Per altre informazioni, vedere [definire un articolo](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="e1434-137">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="e1434-138">Per utilizzare un sistema di risoluzione dei conflitti personalizzato con un articolo di tabella esistente</span><span class="sxs-lookup"><span data-stu-id="e1434-138">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="e1434-139">Eseguire [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specificando **@publication** , **@article** , il valore **Article_resolver** per **@property** e il valore **Microsoft SQL** **Server archiviato ProcedureResolver** per **@value** .</span><span class="sxs-lookup"><span data-stu-id="e1434-139">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and a value of **MicrosoftSQL** **Server Stored ProcedureResolver** for **@value**.</span></span>  
  
2.  <span data-ttu-id="e1434-140">Eseguire [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specificando **@publication** , **@article** , il valore **resolver_info** per **@property** e il nome del stored procedure che implementa la logica del sistema di risoluzione dei conflitti per **@value** .</span><span class="sxs-lookup"><span data-stu-id="e1434-140">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **resolver_info** for **@property**, and the name of the stored procedure that implements the conflict resolver logic for **@value**.</span></span>  
  
##  <a name="using-a-com-based-custom-resolver"></a><a name="COM"></a><span data-ttu-id="e1434-141">Uso di un sistema di risoluzione personalizzato basato su COM</span><span class="sxs-lookup"><span data-stu-id="e1434-141">Using a COM-based Custom Resolver</span></span>  
 <span data-ttu-id="e1434-142">Lo spazio dei nomi <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> implementa un'interfaccia che consente di scrivere logica di business complessa per gestire gli eventi e i risolvere conflitti che si verificano durante il processo di sincronizzazione della replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="e1434-142">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events and resolve conflicts that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="e1434-143">Per altre informazioni, vedere [Implementare un gestore della logica di business per un articolo di merge](implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="e1434-143">For more information, see [Implement a Business Logic Handler for a Merge Article](implement-a-business-logic-handler-for-a-merge-article.md).</span></span> <span data-ttu-id="e1434-144">Per risolvere i conflitti, è inoltre possibile scrivere una logica di business personalizzata basata su codice nativo.</span><span class="sxs-lookup"><span data-stu-id="e1434-144">You can also write your own native code-based custom business logic to resolve conflicts.</span></span> <span data-ttu-id="e1434-145">Tale logica viene compilata come un componente COM in DLL, utilizzando prodotti quali [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="e1434-145">This logic is built as a COM component and compiled into dynamic-link libraries (DLL), using products such as [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="e1434-146">Un sistema di risoluzione dei conflitti personalizzato basato su COM deve implementare l'interfaccia **ICustomResolver con** , progettata specificamente per la risoluzione dei conflitti.</span><span class="sxs-lookup"><span data-stu-id="e1434-146">Such a COM-based custom conflict resolver must implement the **ICustomResolver** interface, which is designed specifically for conflict resolution.</span></span>  
  
#### <a name="to-create-and-register-a-com-based-custom-conflict-resolver"></a><span data-ttu-id="e1434-147">Per creare e registrare un sistema di risoluzione dei conflitti personalizzato basato su COM</span><span class="sxs-lookup"><span data-stu-id="e1434-147">To create and register a COM-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="e1434-148">In un ambiente di creazione compatibile con COM aggiungere riferimenti alla libreria del sistema di risoluzione dei conflitti personalizzato.</span><span class="sxs-lookup"><span data-stu-id="e1434-148">In a COM-compatible authoring environment, add references to the Custom Conflict Resolver library.</span></span>  
  
2.  <span data-ttu-id="e1434-149">Per un progetto Visual C++ utilizzare la direttiva #import per importare la libreria nel progetto.</span><span class="sxs-lookup"><span data-stu-id="e1434-149">For a Visual C++ project, use the #import directive to import this library into your project.</span></span>  
  
3.  <span data-ttu-id="e1434-150">Creare una classe che implementa l'interfaccia **ICustomResolver** .</span><span class="sxs-lookup"><span data-stu-id="e1434-150">Create a class that implements the **ICustomResolver** interface.</span></span>  
  
4.  <span data-ttu-id="e1434-151">Implementare determinati metodi e proprietà.</span><span class="sxs-lookup"><span data-stu-id="e1434-151">Implement certain methods and properties.</span></span>  
  
5.  <span data-ttu-id="e1434-152">Compilare il progetto per creare il file della libreria del sistema di risoluzione dei conflitti personalizzato.</span><span class="sxs-lookup"><span data-stu-id="e1434-152">Build the project to create the custom conflict resolver library file.</span></span>  
  
6.  <span data-ttu-id="e1434-153">Distribuire la libreria nella directory che contiene il file eseguibile dell'agente di merge, in genere \Microsoft SQL Server\100\COM.</span><span class="sxs-lookup"><span data-stu-id="e1434-153">Deploy the library in the directory containing the merge agent executable (usually \Microsoft SQL Server\100\COM).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e1434-154">Un sistema di risoluzione dei conflitti personalizzato deve essere distribuito nel Sottoscrittore per una sottoscrizione pull, nel server di distribuzione per una sottoscrizione push o nel server Web utilizzato con sincronizzazione tramite il Web.</span><span class="sxs-lookup"><span data-stu-id="e1434-154">A custom conflict resolver must be deployed at the Subscriber for a pull subscription, at the Distributor for a push subscription, or at the Web server used with Web synchronization.</span></span>  
  
7.  <span data-ttu-id="e1434-155">Registrare la libreria del sistema di risoluzione dei conflitti personalizzato utilizzando regsvr32.exe nella directory di distribuzione come descritto di seguito:</span><span class="sxs-lookup"><span data-stu-id="e1434-155">Register the custom conflict resolver library using regsvr32.exe from the deployment directory as follows:</span></span>  
  
    ```  
    regsvr32.exe mycustomresolver.dll  
    ```  
  
8.  <span data-ttu-id="e1434-156">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) per verificare che la libreria non sia già registrata come sistema di risoluzione dei conflitti personalizzato.</span><span class="sxs-lookup"><span data-stu-id="e1434-156">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the library is not already registered as a custom conflict resolver.</span></span>  
  
9. <span data-ttu-id="e1434-157">Per registrare la libreria come sistema di risoluzione dei conflitti personalizzato, eseguire [sp_registercustomresolver &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql)nel server di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="e1434-157">To register the library as a custom conflict resolver, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), at the Distributor.</span></span> <span data-ttu-id="e1434-158">Specificare il nome descrittivo dell'oggetto COM per **@article_resolver** , l'ID (CLSID) della libreria per **@resolver_clsid** e il valore `false` per **@is_dotnet_assembly** .</span><span class="sxs-lookup"><span data-stu-id="e1434-158">Specify the friendly name of the COM object for **@article_resolver**, the library's ID (CLSID) for **@resolver_clsid**, and a value of `false` for **@is_dotnet_assembly**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e1434-159">Quando un sistema di risoluzione dei conflitti personalizzato non è più necessario, è possibile annullarne la registrazione con [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e1434-159">When no longer needed, a custom conflict resolver can be unregistered using [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span></span>  
  
10. <span data-ttu-id="e1434-160">(Facoltativo) In un cluster ripetere i passaggi da 5 a 8 per registrare il sistema di risoluzione personalizzato in tutti i nodi del cluster.</span><span class="sxs-lookup"><span data-stu-id="e1434-160">(Optional) On a cluster, repeat steps 5-8 to register the custom resolver on all nodes of the cluster.</span></span> <span data-ttu-id="e1434-161">Tale operazione è necessaria per garantire che il sistema di risoluzione personalizzato sia in grado di caricare correttamente il riconciliatore in seguito a un failover.</span><span class="sxs-lookup"><span data-stu-id="e1434-161">This is required to ensure that the custom resolver will be able to properly load the reconciler following a failover.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="e1434-162">Per utilizzare un sistema di risoluzione dei conflitti personalizzato con un nuovo articolo di tabella</span><span class="sxs-lookup"><span data-stu-id="e1434-162">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="e1434-163">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e prendere nota del nome descrittivo del sistema di risoluzione desiderato.</span><span class="sxs-lookup"><span data-stu-id="e1434-163">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="e1434-164">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) per definire un articolo.</span><span class="sxs-lookup"><span data-stu-id="e1434-164">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article.</span></span> <span data-ttu-id="e1434-165">Specificare il nome descrittivo del sistema di risoluzione dell'articolo dal passaggio 1 per **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="e1434-165">Specify the friendly name of the article resolver from step 1 for **@article_resolver**.</span></span> <span data-ttu-id="e1434-166">Per altre informazioni, vedere [definire un articolo](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="e1434-166">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="e1434-167">Per utilizzare un sistema di risoluzione dei conflitti personalizzato con un articolo di tabella esistente</span><span class="sxs-lookup"><span data-stu-id="e1434-167">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="e1434-168">Nel server di pubblicazione eseguire [sp_enumcustomresolvers &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) e prendere nota del nome descrittivo del sistema di risoluzione desiderato.</span><span class="sxs-lookup"><span data-stu-id="e1434-168">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="e1434-169">Eseguire [sp_changemergearticle &#40;&#41;Transact-SQL ](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specificando **@publication** , **@article** , il valore **article_resolver** per **@property** e il nome descrittivo del sistema di risoluzione dell'articolo dal passaggio 1 per **@value** .</span><span class="sxs-lookup"><span data-stu-id="e1434-169">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the article resolver from step 1 for **@value**.</span></span>  
  
#### <a name="viewing-a-sample-custom-resolver"></a><span data-ttu-id="e1434-170">Visualizzazione di un sistema di risoluzione personalizzato di esempio</span><span class="sxs-lookup"><span data-stu-id="e1434-170">Viewing a Sample Custom Resolver</span></span>  
  
1.  <span data-ttu-id="e1434-171">Un esempio è disponibile nei file di esempio di SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="e1434-171">A sample is available in the SQL Server 2000 sample files.</span></span> <span data-ttu-id="e1434-172">Scaricare il [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span><span class="sxs-lookup"><span data-stu-id="e1434-172">Download the [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span></span> <span data-ttu-id="e1434-173">Questa operazione Scarica 3 file con dimensioni pari a 6,9 MB.</span><span class="sxs-lookup"><span data-stu-id="e1434-173">This downloads 3 files amounting to 6.9 MB.</span></span>  
  
2.  <span data-ttu-id="e1434-174">Estrarre i file dal file con estensione cab compresso scaricato.</span><span class="sxs-lookup"><span data-stu-id="e1434-174">Extract the files from downloaded compressed .cab file.</span></span>  
  
3.  <span data-ttu-id="e1434-175">Esegui **setup.exe**</span><span class="sxs-lookup"><span data-stu-id="e1434-175">Run **setup.exe**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e1434-176">Quando si scelgono le opzioni di installazione, è necessario installare solo gli esempi relativi alla **replica**</span><span class="sxs-lookup"><span data-stu-id="e1434-176">When choosing the installation options, it is only necessary to install the **Replication** samples.</span></span> <span data-ttu-id="e1434-177">Il percorso di installazione predefinito è \*\*c:\Programmi (x86) \microsoft SQL Server 2000 Samples\1033 \\ \*\*)</span><span class="sxs-lookup"><span data-stu-id="e1434-177">(The default installation path is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\\**)</span></span>  
  
4.  <span data-ttu-id="e1434-178">Passare alla cartella di installazione.</span><span class="sxs-lookup"><span data-stu-id="e1434-178">Go to installation folder.</span></span> <span data-ttu-id="e1434-179">La cartella predefinita è **C:\Programmi (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**</span><span class="sxs-lookup"><span data-stu-id="e1434-179">(The default folder is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span></span>  
  
5.  <span data-ttu-id="e1434-180">Eseguire il programma **unzip_sqlreplSP3.exe** .</span><span class="sxs-lookup"><span data-stu-id="e1434-180">Run the **unzip_sqlreplSP3.exe** program.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e1434-181">Il sistema di risoluzione COM di esempio viene installato per impostazione predefinita nella cartella **C:\Programmi (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** .</span><span class="sxs-lookup"><span data-stu-id="e1434-181">The sample com resolver will install (by default) to the **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** folder.</span></span>  
  
6.  <span data-ttu-id="e1434-182">Nella cartella **subspres** trovare tutte le occorrenze di **#include sqlres.h** in tutti i file di origine e sostituirle con **#import "replrec.dll" no_namespace, raw_interfaces_only**</span><span class="sxs-lookup"><span data-stu-id="e1434-182">In the **subspres** folder, find all occurrences of **#include sqlres.h** in all of the source files and replace them with **#import "replrec.dll" no_namespace, raw_interfaces_only**</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e1434-183">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="e1434-183">See Also</span></span>  
 <span data-ttu-id="e1434-184">[Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="e1434-184">[Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="e1434-185">[Resolver personalizzati basati su COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span><span class="sxs-lookup"><span data-stu-id="e1434-185">[COM-Based Custom Resolvers](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span></span>  
 [<span data-ttu-id="e1434-186">Procedure consigliate per la sicurezza della replica</span><span class="sxs-lookup"><span data-stu-id="e1434-186">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
