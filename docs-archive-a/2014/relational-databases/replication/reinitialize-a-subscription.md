---
title: Reinizializzare una sottoscrizione | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- initializing subscriptions [SQL Server replication], reinitializing
- subscriptions [SQL Server replication], reinitializing
- reinitializing subscriptions
ms.assetid: ca3625c5-c62e-4ab7-9829-d511f838e385
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f751928c05caa5c4acdcc6c667dc59bb7824021b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87725452"
---
# <a name="reinitialize-a-subscription"></a><span data-ttu-id="5afc4-102">Reinizializzare una sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="5afc4-102">Reinitialize a Subscription</span></span>
  <span data-ttu-id="5afc4-103">In questo argomento viene descritto come reinizializzare una sottoscrizione in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] tramite [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)]o RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="5afc4-103">This topic describes how to reinitialize a subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="5afc4-104">È possibile contrassegnare singole sottoscrizioni per la reinizializzazione in modo che nel corso della successiva sincronizzazione venga applicato un nuovo snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-104">Individual subscriptions can be marked for reinitialization so that a new snapshot is applied during the next synchronization.</span></span>  
  
 <span data-ttu-id="5afc4-105">**Contenuto dell'articolo**</span><span class="sxs-lookup"><span data-stu-id="5afc4-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="5afc4-106">**Per reinizializzare una sottoscrizione, utilizzando:**</span><span class="sxs-lookup"><span data-stu-id="5afc4-106">**To reinitialize a subscription, using:**</span></span>  
  
     [<span data-ttu-id="5afc4-107">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="5afc4-107">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="5afc4-108">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="5afc4-108">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="5afc4-109">Oggetti RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="5afc4-109">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="5afc4-110">Utilizzo di SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="5afc4-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="5afc4-111">Il processo di reinizializzazione di una sottoscrizione è articolato in due parti.</span><span class="sxs-lookup"><span data-stu-id="5afc4-111">Reinitializing a subscription is a two-part process:</span></span>  
  
1.  <span data-ttu-id="5afc4-112">Una singola sottoscrizione o tutte le sottoscrizioni di una pubblicazione vengono *contrassegnate* per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-112">A single subscription or all subscriptions to a publication are *marked* for reinitialization.</span></span> <span data-ttu-id="5afc4-113">Contrassegnare le sottoscrizioni per la reinizializzazione nella finestra di dialogo **Reinizializza sottoscrizioni**, accessibile dalla cartella **Pubblicazioni locali** e dalla cartella **Sottoscrizioni locali** in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5afc4-113">Mark subscriptions for reinitialization in the **Reinitialize Subscription(s)** dialog box, which is available from the **Local Publications** folder and the **Local Subscriptions** folder in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="5afc4-114">È inoltre possibile contrassegnare le sottoscrizioni nella scheda **Tutte le sottoscrizioni** e nel nodo delle pubblicazioni in Monitoraggio replica.</span><span class="sxs-lookup"><span data-stu-id="5afc4-114">You can also mark subscriptions from the **All Subscriptions** tab and the publications node in Replication Monitor.</span></span> <span data-ttu-id="5afc4-115">Per informazioni sull'avvio di Monitoraggio replica, vedere [Avviare Monitoraggio replica](monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span> <span data-ttu-id="5afc4-116">Quando si contrassegna una sottoscrizione per la reinizializzazione, sono disponibili le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="5afc4-116">When you mark a subscription for reinitialization, you have the following options:</span></span>  
  
     <span data-ttu-id="5afc4-117">**Usa lo snapshot corrente**</span><span class="sxs-lookup"><span data-stu-id="5afc4-117">**Use the current snapshot**</span></span>  
     <span data-ttu-id="5afc4-118">Selezionare questa opzione per applicare lo snapshot corrente al Sottoscrittore alla successiva esecuzione dell'agente di distribuzione o dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="5afc4-118">Select to apply the current snapshot to the Subscriber the next time the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="5afc4-119">Se non sono disponibili snapshot validi, questa opzione non può essere selezionata.</span><span class="sxs-lookup"><span data-stu-id="5afc4-119">If there is no valid snapshot available, this option cannot be selected.</span></span>  
  
     <span data-ttu-id="5afc4-120">**Usa un nuovo snapshot**</span><span class="sxs-lookup"><span data-stu-id="5afc4-120">**Use a new snapshot**</span></span>  
     <span data-ttu-id="5afc4-121">Selezionare questa opzione per reinizializzare la sottoscrizione con un nuovo snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-121">Select to reinitialize the subscription with a new snapshot.</span></span> <span data-ttu-id="5afc4-122">Lo snapshot può essere applicato al Sottoscrittore solo dopo essere stato generato dall'agente snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-122">The snapshot can be applied to the Subscriber only after it has been generated by the Snapshot Agent.</span></span> <span data-ttu-id="5afc4-123">Se l'agente snapshot è impostato in modo da essere eseguito in base a una pianificazione, la sottoscrizione verrà reinizializzata soltanto dopo la successiva esecuzione pianificata dell'agente snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-123">If the Snapshot Agent is set to run on a schedule, the subscription is not reinitialized until after the next scheduled Snapshot Agent run.</span></span> <span data-ttu-id="5afc4-124">Per avviare l'agente snapshot immediatamente, selezionare **Genera il nuovo snapshot ora** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-124">Select **Generate the new snapshot now** to start the Snapshot Agent immediately.</span></span>  
  
     <span data-ttu-id="5afc4-125">**Carica le modifiche non sincronizzate prima della reinizializzazione**</span><span class="sxs-lookup"><span data-stu-id="5afc4-125">**Upload unsynchronized changes before reinitialization**</span></span>  
     <span data-ttu-id="5afc4-126">Solo per la replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="5afc4-126">Merge replication only.</span></span> <span data-ttu-id="5afc4-127">Selezionare questa opzione per caricare le eventuali modifiche in sospeso dal database della sottoscrizione prima che i dati nel Sottoscrittore vengano sovrascritti con uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-127">Select to upload any pending changes from the subscription database before the data at the Subscriber is overwritten with a snapshot.</span></span>  
  
     <span data-ttu-id="5afc4-128">Se si aggiunge, elimina o modifica un filtro con parametri, le modifiche in sospeso nel Sottoscrittore non possono essere caricate nel server di pubblicazione durante la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-128">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="5afc4-129">Per caricare le modifiche in sospeso, sincronizzare tutte le sottoscrizioni prima di modificare il filtro.</span><span class="sxs-lookup"><span data-stu-id="5afc4-129">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="5afc4-130">Una sottoscrizione viene reinizializzata alla successiva sincronizzazione. L'agente di distribuzione (per la replica transazionale) o l'agente di merge (per la replica di tipo merge) applica lo snapshot più recente a ogni Sottoscrittore dotato di una sottoscrizione contrassegnata per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-130">A subscription is reinitialized the next time it is synchronized: the Distribution Agent (for transactional replication) or Merge Agent (for merge replication) applies the most recent snapshot to each Subscriber that has a subscription marked for reinitialization.</span></span> <span data-ttu-id="5afc4-131">Per ulteriori informazioni sulla sincronizzazione delle sottoscrizioni, vedere [Synchronize a Push Subscription](synchronize-a-push-subscription.md) e [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-management-studio-at-the-publisher"></a><span data-ttu-id="5afc4-132">Per contrassegnare una singola sottoscrizione push o pull per la reinizializzazione in Management Studio (nel server di pubblicazione)</span><span class="sxs-lookup"><span data-stu-id="5afc4-132">To mark a single push or pull subscription for reinitialization in Management Studio (at the Publisher)</span></span>  
  
1.  <span data-ttu-id="5afc4-133">Connettersi al server di pubblicazione in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="5afc4-133">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="5afc4-134">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-134">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="5afc4-135">Espandere la pubblicazione di cui si desidera reinizializzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-135">Expand the publication that has the subscription you want to reinitialize.</span></span>  
  
4.  <span data-ttu-id="5afc4-136">Fare clic con il pulsante destro del mouse sulla sottoscrizione e quindi scegliere **Reinizializza**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-136">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
5.  <span data-ttu-id="5afc4-137">Nella finestra di dialogo **Reinizializza sottoscrizioni** selezionare le opzioni desiderate e quindi fare clic su **Contrassegna per la reinizializzazione**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-137">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-pull-subscription-for-reinitialization-in-management-studio-at-the-subscriber"></a><span data-ttu-id="5afc4-138">Per contrassegnare una singola sottoscrizione pull per la reinizializzazione in Management Studio (nel Sottoscrittore)</span><span class="sxs-lookup"><span data-stu-id="5afc4-138">To mark a single pull subscription for reinitialization in Management Studio (at the Subscriber)</span></span>  
  
1.  <span data-ttu-id="5afc4-139">Connettersi al Sottoscrittore in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="5afc4-139">Connect to the Subscriber in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="5afc4-140">Espandere la cartella **Replica** e quindi la cartella **Sottoscrizioni locali** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-140">Expand the **Replication** folder, and then expand the **Local Subscriptions** folder.</span></span>  
  
3.  <span data-ttu-id="5afc4-141">Fare clic con il pulsante destro del mouse sulla sottoscrizione e quindi scegliere **Reinizializza**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-141">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
4.  <span data-ttu-id="5afc4-142">Nella finestra di dialogo di conferma che viene visualizzata, fare clic su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-142">In the confirmation dialog box that is displayed, click **Yes**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-management-studio"></a><span data-ttu-id="5afc4-143">Per contrassegnare tutte le sottoscrizioni per la reinizializzazione in Management Studio</span><span class="sxs-lookup"><span data-stu-id="5afc4-143">To mark all subscriptions for reinitialization in Management Studio</span></span>  
  
1.  <span data-ttu-id="5afc4-144">Connettersi al server di pubblicazione in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]e quindi espandere il nodo del server.</span><span class="sxs-lookup"><span data-stu-id="5afc4-144">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="5afc4-145">Espandere la cartella **Replica** e quindi la cartella **Pubblicazioni locali** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-145">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="5afc4-146">Fare clic con il pulsante destro del mouse sulla pubblicazione di cui desidera reinizializzare le sottoscrizioni e quindi scegliere **Reinizializza tutte le sottoscrizioni**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-146">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="5afc4-147">Nella finestra di dialogo **Reinizializza sottoscrizioni** selezionare le opzioni desiderate e quindi fare clic su **Contrassegna per la reinizializzazione**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-147">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="5afc4-148">Per contrassegnare una singola sottoscrizione push o pull per la reinizializzazione in Monitoraggio replica</span><span class="sxs-lookup"><span data-stu-id="5afc4-148">To mark a single push or pull subscription for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="5afc4-149">In Monitoraggio replica espandere un gruppo di server di pubblicazione nel riquadro di sinistra, espandere un server di pubblicazione e quindi fare clic su una pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-149">In Replication Monitor, expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="5afc4-150">Fare clic sulla scheda **Tutte le sottoscrizioni** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-150">Click the **All Subscriptions** tab.</span></span>  
  
3.  <span data-ttu-id="5afc4-151">Fare clic con il pulsante destro del mouse sulla sottoscrizione che si desidera reinizializzare e quindi scegliere **Reinizializza sottoscrizione**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-151">Right-click the subscription you want to reinitialize, and then click **Reinitialize Subscription**.</span></span>  
  
4.  <span data-ttu-id="5afc4-152">Nella finestra di dialogo **Reinizializza sottoscrizioni** selezionare le opzioni desiderate e quindi fare clic su **Contrassegna per la reinizializzazione**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-152">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="5afc4-153">Per contrassegnare tutte le sottoscrizioni per la reinizializzazione in Monitoraggio replica</span><span class="sxs-lookup"><span data-stu-id="5afc4-153">To mark all subscriptions for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="5afc4-154">In Monitoraggio replica espandere un gruppo di server di pubblicazione nel riquadro di sinistra e quindi espandere un server di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-154">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="5afc4-155">Fare clic con il pulsante destro del mouse sulla pubblicazione di cui desidera reinizializzare le sottoscrizioni e quindi scegliere **Reinizializza tutte le sottoscrizioni**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-155">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="5afc4-156">Nella finestra di dialogo **Reinizializza sottoscrizioni** selezionare le opzioni desiderate e quindi fare clic su **Contrassegna per la reinizializzazione**.</span><span class="sxs-lookup"><span data-stu-id="5afc4-156">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="5afc4-157">Uso di Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="5afc4-157">Using Transact-SQL</span></span>  
 <span data-ttu-id="5afc4-158">È possibile reinizializzare le sottoscrizioni a livello di programmazione tramite le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="5afc4-158">Subscriptions can be reinitialized programmatically using replication stored procedures.</span></span> <span data-ttu-id="5afc4-159">La stored procedure utilizzata dipende dal tipo di sottoscrizione, ovvero push o pull, nonché dal tipo di pubblicazione a cui appartiene la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-159">The stored procedure that is used depends on the type of subscription (push or pull) and the type of publication to which the subscription belongs.</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="5afc4-160">Per reinizializzare una sottoscrizione pull in una pubblicazione transazionale</span><span class="sxs-lookup"><span data-stu-id="5afc4-160">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="5afc4-161">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_reinitpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5afc4-161">At the Subscriber on the subscription database, execute [sp_reinitpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span></span> <span data-ttu-id="5afc4-162">Specificare **@publisher** , **@publisher_db** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-162">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="5afc4-163">La sottoscrizione verrà contrassegnata per la reinizializzazione alla successiva esecuzione dell'agente di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-163">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="5afc4-164">(Facoltativo) Avviare l'agente di distribuzione nel Sottoscrittore per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-164">(Optional) Start the Distribution Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="5afc4-165">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione pull](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-165">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="5afc4-166">Per reinizializzare una sottoscrizione push in una pubblicazione transazionale</span><span class="sxs-lookup"><span data-stu-id="5afc4-166">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="5afc4-167">Nel server di pubblicazione eseguire [sp_reinitsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5afc4-167">At the Publisher, execute [sp_reinitsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql).</span></span> <span data-ttu-id="5afc4-168">Specificare **@publication** , **@subscriber** e **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-168">Specify **@publication**, **@subscriber**, and **@destination_db**.</span></span> <span data-ttu-id="5afc4-169">La sottoscrizione verrà contrassegnata per la reinizializzazione alla successiva esecuzione dell'agente di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-169">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="5afc4-170">(Facoltativo) Avviare l'agente di distribuzione nel server di distribuzione per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-170">(Optional) Start the Distribution Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="5afc4-171">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione push](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-171">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="5afc4-172">Per reinizializzare una sottoscrizione pull in una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5afc4-172">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-173">Nel database di sottoscrizione del Sottoscrittore eseguire [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5afc4-173">At the Subscriber on the subscription database, execute [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="5afc4-174">Specificare **@publisher** , **@publisher_db** e **@publication** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-174">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="5afc4-175">Per caricare le modifiche dal Sottoscrittore prima che venga eseguita la reinizializzazione, specificare il valore `true` per **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-175">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="5afc4-176">La sottoscrizione verrà contrassegnata per la reinizializzazione alla successiva esecuzione dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="5afc4-176">This marks the subscription for reinitialization the next time the Merge Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="5afc4-177">Se si aggiunge, elimina o modifica un filtro con parametri, le modifiche in sospeso nel Sottoscrittore non possono essere caricate nel server di pubblicazione durante la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-177">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="5afc4-178">Per caricare le modifiche in sospeso, sincronizzare tutte le sottoscrizioni prima di modificare il filtro.</span><span class="sxs-lookup"><span data-stu-id="5afc4-178">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="5afc4-179">(Facoltativo) Avviare l'agente di merge nel Sottoscrittore per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-179">(Optional) Start the Merge Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="5afc4-180">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione pull](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-180">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="5afc4-181">Per reinizializzare una sottoscrizione push in una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5afc4-181">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-182">Nel server di pubblicazione eseguire [sp_reinitmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="5afc4-182">At the Publisher, execute [sp_reinitmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql).</span></span> <span data-ttu-id="5afc4-183">Specificare **@publication** , **@subscriber** e **@subscriber_db** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-183">Specify **@publication**, **@subscriber**, and **@subscriber_db**.</span></span> <span data-ttu-id="5afc4-184">Per caricare le modifiche dal Sottoscrittore prima che venga eseguita la reinizializzazione, specificare il valore `true` per **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="5afc4-184">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="5afc4-185">La sottoscrizione verrà contrassegnata per la reinizializzazione alla successiva esecuzione dell'agente di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-185">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="5afc4-186">Se si aggiunge, elimina o modifica un filtro con parametri, le modifiche in sospeso nel Sottoscrittore non possono essere caricate nel server di pubblicazione durante la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-186">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="5afc4-187">Per caricare le modifiche in sospeso, sincronizzare tutte le sottoscrizioni prima di modificare il filtro.</span><span class="sxs-lookup"><span data-stu-id="5afc4-187">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="5afc4-188">(Facoltativo) Avviare l'agente di merge nel server di distribuzione per sincronizzare la sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-188">(Optional) Start the Merge Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="5afc4-189">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione push](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-189">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-set-the-reinitialization-policy-when-creating-a-new-merge-publication"></a><span data-ttu-id="5afc4-190">Per impostare i criteri di reinizializzazione durante la creazione di una nuova pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5afc4-190">To set the reinitialization policy when creating a new merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-191">Nel database di pubblicazione del server di pubblicazione eseguire [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), specificando uno dei valori seguenti per **@automatic_reinitialization_policy**:</span><span class="sxs-lookup"><span data-stu-id="5afc4-191">At the Publisher on the publication database, execute [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), specifying one of the following values for **@automatic_reinitialization_policy**:</span></span>  
  
    -   <span data-ttu-id="5afc4-192">**1** : le modifiche vengono caricate dal Sottoscrittore prima della reinizializzazione automatica di una sottoscrizione in seguito a una modifica della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-192">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="5afc4-193">**0** : le modifiche nel Sottoscrittore vengono eliminate quando una sottoscrizione viene reinizializzata automaticamente in seguito a una modifica della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-193">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="5afc4-194">Se si aggiunge, elimina o modifica un filtro con parametri, le modifiche in sospeso nel Sottoscrittore non possono essere caricate nel server di pubblicazione durante la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-194">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="5afc4-195">Per caricare le modifiche in sospeso, sincronizzare tutte le sottoscrizioni prima di modificare il filtro.</span><span class="sxs-lookup"><span data-stu-id="5afc4-195">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="5afc4-196">Per altre informazioni, vedere [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-196">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
#### <a name="to-change-the-reinitialization-policy-for-an-existing-merge-publication"></a><span data-ttu-id="5afc4-197">Per modificare i criteri di reinizializzazione per una pubblicazione di tipo merge esistente</span><span class="sxs-lookup"><span data-stu-id="5afc4-197">To change the reinitialization policy for an existing merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-198">Nel database di pubblicazione del server di pubblicazione eseguire [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specificando **automatic_reinitialization_policy** per **@property** e uno dei valori seguenti per **@value**:</span><span class="sxs-lookup"><span data-stu-id="5afc4-198">At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **automatic_reinitialization_policy** for **@property** and one of the following values for **@value**:</span></span>  
  
    -   <span data-ttu-id="5afc4-199">**1** : le modifiche vengono caricate dal Sottoscrittore prima della reinizializzazione automatica di una sottoscrizione in seguito a una modifica della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-199">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="5afc4-200">**0** : le modifiche nel Sottoscrittore vengono eliminate quando una sottoscrizione viene reinizializzata automaticamente in seguito a una modifica della pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-200">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="5afc4-201">Se si aggiunge, elimina o modifica un filtro con parametri, le modifiche in sospeso nel Sottoscrittore non possono essere caricate nel server di pubblicazione durante la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-201">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="5afc4-202">Per caricare le modifiche in sospeso, sincronizzare tutte le sottoscrizioni prima di modificare il filtro.</span><span class="sxs-lookup"><span data-stu-id="5afc4-202">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="5afc4-203">Per altre informazioni, vedere [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-203">For more information, see [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="5afc4-204">Utilizzo di RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="5afc4-204">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="5afc4-205">È possibile contrassegnare singole sottoscrizioni per la reinizializzazione in modo che nel corso della successiva sincronizzazione venga applicato un nuovo snapshot.</span><span class="sxs-lookup"><span data-stu-id="5afc4-205">Individual subscriptions can be marked for reinitialization so that during the next synchronization, a new snapshot is applied.</span></span> <span data-ttu-id="5afc4-206">Le sottoscrizioni possono essere reinizializzate a livello di programmazione tramite gli oggetti RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="5afc4-206">Subscriptions can be reinitialized programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="5afc4-207">Le classi utilizzate dipendono dal tipo di pubblicazione a cui appartiene la sottoscrizione e dal tipo di sottoscrizione, ovvero push o pull.</span><span class="sxs-lookup"><span data-stu-id="5afc4-207">The classes you use depend on the type of publication to which the subscription belongs and the type of subscription (that is, a push or pull subscription).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="5afc4-208">Per reinizializzare una sottoscrizione pull in una pubblicazione transazionale</span><span class="sxs-lookup"><span data-stu-id="5afc4-208">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="5afc4-209">Creare una connessione al Sottoscrittore tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-209">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="5afc4-210">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.TransPullSubscription> , quindi impostare <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>e la connessione ottenuta al passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="5afc4-210">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="5afc4-211">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="5afc4-211">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-212">Se questo metodo restituisce `false`, le proprietà di sottoscrizione sono state definite in modo non corretto nel passaggio 2 oppure la sottoscrizione pull non esiste.</span><span class="sxs-lookup"><span data-stu-id="5afc4-212">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="5afc4-213">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-213">Call the <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="5afc4-214">Questo metodo contrassegna la sottoscrizione per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-214">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="5afc4-215">Sincronizzare la sottoscrizione pull.</span><span class="sxs-lookup"><span data-stu-id="5afc4-215">Synchronize the pull subscription.</span></span> <span data-ttu-id="5afc4-216">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione pull](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-216">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="5afc4-217">Per reinizializzare una sottoscrizione push in una pubblicazione transazionale</span><span class="sxs-lookup"><span data-stu-id="5afc4-217">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="5afc4-218">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-218">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="5afc4-219">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.TransSubscription> , quindi impostare <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>e la connessione ottenuta al passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="5afc4-219">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="5afc4-220">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="5afc4-220">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-221">Se questo metodo restituisce `false`, le proprietà di sottoscrizione sono state definite in modo non corretto nel passaggio 2 oppure la sottoscrizione push non esiste.</span><span class="sxs-lookup"><span data-stu-id="5afc4-221">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="5afc4-222">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-222">Call the <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="5afc4-223">Questo metodo contrassegna la sottoscrizione per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-223">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="5afc4-224">Sincronizzare la sottoscrizione push.</span><span class="sxs-lookup"><span data-stu-id="5afc4-224">Synchronize the push subscription.</span></span> <span data-ttu-id="5afc4-225">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione push](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-225">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="5afc4-226">Per reinizializzare una sottoscrizione pull in una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5afc4-226">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-227">Creare una connessione al Sottoscrittore tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-227">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="5afc4-228">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergePullSubscription> , quindi impostare <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>e la connessione ottenuta al passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="5afc4-228">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="5afc4-229">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="5afc4-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-230">Se questo metodo restituisce `false`, le proprietà di sottoscrizione sono state definite in modo non corretto nel passaggio 2 oppure la sottoscrizione pull non esiste.</span><span class="sxs-lookup"><span data-stu-id="5afc4-230">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="5afc4-231">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-231">Call the <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="5afc4-232">Passare il valore `true` per caricare le modifiche nel Sottoscrittore prima della reinizializzazione oppure il valore `false` per eseguire la reinizializzazione e perdere eventuali modifiche in sospeso nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5afc4-232">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="5afc4-233">Questo metodo contrassegna la sottoscrizione per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-233">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-234">Se la sottoscrizione è scaduta, non sarà possibile caricare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="5afc4-234">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="5afc4-235">Per altre informazioni, vedere [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-235">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="5afc4-236">Sincronizzare la sottoscrizione pull.</span><span class="sxs-lookup"><span data-stu-id="5afc4-236">Synchronize the pull subscription.</span></span> <span data-ttu-id="5afc4-237">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione pull](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-237">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="5afc4-238">Per reinizializzare una sottoscrizione push in una pubblicazione di tipo merge</span><span class="sxs-lookup"><span data-stu-id="5afc4-238">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="5afc4-239">Creare una connessione al server di pubblicazione tramite la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-239">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="5afc4-240">Creare un'istanza della classe <xref:Microsoft.SqlServer.Replication.MergeSubscription> , quindi impostare <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>e la connessione ottenuta al passaggio 1 per <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="5afc4-240">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="5afc4-241">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per recuperare le proprietà dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="5afc4-241">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-242">Se questo metodo restituisce `false`, le proprietà di sottoscrizione sono state definite in modo non corretto nel passaggio 2 oppure la sottoscrizione push non esiste.</span><span class="sxs-lookup"><span data-stu-id="5afc4-242">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="5afc4-243">Chiamare il metodo <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="5afc4-243">Call the <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="5afc4-244">Passare il valore `true` per caricare le modifiche nel Sottoscrittore prima della reinizializzazione oppure il valore `false` per eseguire la reinizializzazione e perdere eventuali modifiche in sospeso nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5afc4-244">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="5afc4-245">Questo metodo contrassegna la sottoscrizione per la reinizializzazione.</span><span class="sxs-lookup"><span data-stu-id="5afc4-245">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5afc4-246">Se la sottoscrizione è scaduta, non sarà possibile caricare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="5afc4-246">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="5afc4-247">Per altre informazioni, vedere [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-247">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="5afc4-248">Sincronizzare la sottoscrizione push.</span><span class="sxs-lookup"><span data-stu-id="5afc4-248">Synchronize the push subscription.</span></span> <span data-ttu-id="5afc4-249">Per altre informazioni, vedere [Sincronizzazione di una sottoscrizione push](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="5afc4-249">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="5afc4-250">Esempi (RMO)</span><span class="sxs-lookup"><span data-stu-id="5afc4-250">Examples (RMO)</span></span>  
 <span data-ttu-id="5afc4-251">In questo esempio viene eseguita la reinizializzazione di una sottoscrizione pull in una pubblicazione transazionale.</span><span class="sxs-lookup"><span data-stu-id="5afc4-251">This example reinitializes a pull subscription to a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitTranPullSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinittranpullsub)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitTranPullSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinittranpullsub)]  
  
 <span data-ttu-id="5afc4-252">In questo esempio viene eseguita la reinizializzazione di una sottoscrizione pull in una pubblicazione di tipo merge dopo aver prima caricato le modifiche in sospeso nel Sottoscrittore.</span><span class="sxs-lookup"><span data-stu-id="5afc4-252">This example reinitializes a pull subscription to a merge publication after first uploading pending changes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitMergePullSub_WithUpload](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinitmergepullsub_withupload)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitMergePullSub_WithUpload](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinitmergepullsub_withupload)]  
  
## <a name="see-also"></a><span data-ttu-id="5afc4-253">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="5afc4-253">See Also</span></span>  
 <span data-ttu-id="5afc4-254">[Reinizializzare le sottoscrizioni](reinitialize-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="5afc4-254">[Reinitialize Subscriptions](reinitialize-subscriptions.md) </span></span>  
 <span data-ttu-id="5afc4-255">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="5afc4-255">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="5afc4-256">Procedure consigliate per la sicurezza della replica</span><span class="sxs-lookup"><span data-stu-id="5afc4-256">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
