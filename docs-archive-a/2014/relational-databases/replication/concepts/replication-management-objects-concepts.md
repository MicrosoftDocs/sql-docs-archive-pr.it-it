---
title: Concetti di base relativi a RMO (Replication Management Objects) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87628625"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="54da1-102">Replication Management Objects Concepts</span><span class="sxs-lookup"><span data-stu-id="54da1-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="54da1-103">RMO (Replication Management Objects) è un assembly di codice gestito che incapsula le funzionalità di replica per [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="54da1-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="54da1-104">RMO viene implementato dallo spazio dei nomi <xref:Microsoft.SqlServer.Replication>.</span><span class="sxs-lookup"><span data-stu-id="54da1-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="54da1-105">Negli argomenti seguenti viene descritto come utilizzare RMO a livello di programmazione per controllare le attività di replica:</span><span class="sxs-lookup"><span data-stu-id="54da1-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="54da1-106">Configurare la distribuzione</span><span class="sxs-lookup"><span data-stu-id="54da1-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="54da1-107">Negli argomenti inclusi in questa sezione viene illustrato come utilizzare RMO per configurare la pubblicazione e la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="54da1-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 [<span data-ttu-id="54da1-108">Creare una pubblicazione</span><span class="sxs-lookup"><span data-stu-id="54da1-108">Create a Publication</span></span>](../publish/create-a-publication.md)  
 <span data-ttu-id="54da1-109">Negli argomenti inclusi in questa sezione viene illustrato come utilizzare RMO per creare, eliminare e modificare pubblicazioni e articoli.</span><span class="sxs-lookup"><span data-stu-id="54da1-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="54da1-110">Sottoscrizione delle pubblicazioni</span><span class="sxs-lookup"><span data-stu-id="54da1-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="54da1-111">Negli argomenti inclusi in questa sezione viene illustrato come utilizzare RMO per creare, eliminare e modificare sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="54da1-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 [<span data-ttu-id="54da1-112">Proteggere una topologia di replica</span><span class="sxs-lookup"><span data-stu-id="54da1-112">Secure a Replication Topology</span></span>](../security/view-and-modify-replication-security-settings.md)  
 <span data-ttu-id="54da1-113">Negli argomenti inclusi in questa sezione viene illustrato come utilizzare RMO per visualizzare e modificare le impostazioni di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="54da1-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 [<span data-ttu-id="54da1-114">Sincronizzare le sottoscrizioni &#40;replica&#41;</span><span class="sxs-lookup"><span data-stu-id="54da1-114">Synchronize Subscriptions &#40;Replication&#41;</span></span>](../synchronize-data.md)  
 <span data-ttu-id="54da1-115">Negli argomenti inclusi in questa sezione viene illustrato come sincronizzare le sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="54da1-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="54da1-116">Monitoraggio della replica</span><span class="sxs-lookup"><span data-stu-id="54da1-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="54da1-117">Negli argomenti inclusi in questa sezione viene illustrato come monitorare a livello di codice una topologia di replica.</span><span class="sxs-lookup"><span data-stu-id="54da1-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="54da1-118">Introduzione alla programmazione RMO</span><span class="sxs-lookup"><span data-stu-id="54da1-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="54da1-119">RMO è progettato per consentire la programmazione di tutti gli aspetti della replica di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="54da1-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="54da1-120">Lo spazio dei nomi di RMO è <xref:Microsoft.SqlServer.Replication> e viene implementato da Microsoft.SqlServer.Rmo.dll, un assembly di [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="54da1-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="54da1-121">L'assembly Microsoft.SqlServer.Replication.dll, che appartiene allo spazio dei nomi <xref:Microsoft.SqlServer.Replication>, implementa un'interfaccia di codice gestito per la programmazione dei vari agenti di replica (Agente snapshot, Agente di distribuzione e Agente di merge).</span><span class="sxs-lookup"><span data-stu-id="54da1-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="54da1-122">È possibile accedere alle classi corrispondenti da RMO per sincronizzare le sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="54da1-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="54da1-123">Le classi nello spazio dei nomi <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>, implementato dall'assembly Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, vengono utilizzate per creare la logica di business personalizzata per la replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="54da1-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="54da1-124">Questo assembly è indipendente da RMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="54da1-125">Distribuzione di applicazioni basate su RMO</span><span class="sxs-lookup"><span data-stu-id="54da1-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="54da1-126">RMO dipende dai componenti di replica e dai componenti di connettività del client inclusi in tutte le versioni di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], tranne SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="54da1-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="54da1-127">Per distribuire un'applicazione basata su RMO, è necessario installare una versione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] che includa componenti di replica e componenti di connettività del client nel computer in cui verrà eseguita l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="54da1-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="54da1-128">Introduzione a RMO</span><span class="sxs-lookup"><span data-stu-id="54da1-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="54da1-129">In questa sezione viene descritto come creare un progetto RMO semplice utilizzando [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="54da1-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="54da1-130">Per creare un nuovo progetto di Microsoft Visual C#</span><span class="sxs-lookup"><span data-stu-id="54da1-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="54da1-131">Avviare Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="54da1-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="54da1-132">Scegliere **Nuovo progetto** dal menu **File**.</span><span class="sxs-lookup"><span data-stu-id="54da1-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="54da1-133">Verrà visualizzata la finestra di dialogo **Nuovo progetto** .</span><span class="sxs-lookup"><span data-stu-id="54da1-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="54da1-134">Nella finestra di dialogo **Tipi progetto** selezionare **Progetti di Visual C#** .</span><span class="sxs-lookup"><span data-stu-id="54da1-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="54da1-135">Nel riquadro **Modelli** selezionare **Applicazione Windows**.</span><span class="sxs-lookup"><span data-stu-id="54da1-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="54da1-136">(Facoltativo) In **Nome** digitare il nome della nuova applicazione.</span><span class="sxs-lookup"><span data-stu-id="54da1-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="54da1-137">Fare clic su **OK** per caricare il modello di Windows per Visual C#.</span><span class="sxs-lookup"><span data-stu-id="54da1-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="54da1-138">Scegliere **Aggiungi riferimento** dal menu **Progetto**.</span><span class="sxs-lookup"><span data-stu-id="54da1-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="54da1-139">Verrà visualizzata la finestra di dialogo **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="54da1-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="54da1-140">Selezionare gli assembly seguenti nell'elenco della scheda **.NET** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="54da1-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="54da1-141">Interfaccia di programmazione .NET per Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="54da1-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="54da1-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="54da1-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="54da1-143">Libreria dell'agente di replica</span><span class="sxs-lookup"><span data-stu-id="54da1-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="54da1-144">Per selezionare più file, utilizzare il tasto CTRL.</span><span class="sxs-lookup"><span data-stu-id="54da1-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="54da1-145">(Facoltativo) Ripetere il passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="54da1-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="54da1-146">Fare clic sulla scheda **Sfoglia**, passare a [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, selezionare Microsoft.SqlServer.Replication.BusinessLogicSupport.dll e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="54da1-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="54da1-147">Scegliere **Codice** dal menu **Visualizza**.</span><span class="sxs-lookup"><span data-stu-id="54da1-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="54da1-148">Nel codice, prima dell'istruzione dello spazio dei nomi, digitare le istruzioni `using` seguenti per qualificare i tipi negli spazi dei nomi di RMO:</span><span class="sxs-lookup"><span data-stu-id="54da1-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="54da1-149">Per creare un nuovo progetto di Microsoft Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="54da1-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="54da1-150">Avviare Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="54da1-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="54da1-151">Scegliere **Nuovo progetto** dal menu **File**.</span><span class="sxs-lookup"><span data-stu-id="54da1-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="54da1-152">Verrà visualizzata la finestra di dialogo **Nuovo progetto** .</span><span class="sxs-lookup"><span data-stu-id="54da1-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="54da1-153">Nel riquadro Tipi progetto selezionare **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="54da1-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="54da1-154">Nel riquadro Modelli selezionare **Applicazione Windows**.</span><span class="sxs-lookup"><span data-stu-id="54da1-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="54da1-155">(Facoltativo) Nella casella **Nome** digitare il nome della nuova applicazione.</span><span class="sxs-lookup"><span data-stu-id="54da1-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="54da1-156">Fare clic su **OK** per caricare il modello di Windows per Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="54da1-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="54da1-157">Scegliere **Aggiungi riferimento** dal menu **Progetto**.</span><span class="sxs-lookup"><span data-stu-id="54da1-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="54da1-158">Verrà visualizzata la finestra di dialogo **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="54da1-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="54da1-159">Selezionare gli assembly seguenti nell'elenco della scheda **.NET** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="54da1-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="54da1-160">Interfaccia di programmazione .NET per Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="54da1-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="54da1-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="54da1-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="54da1-162">Libreria dell'agente di replica</span><span class="sxs-lookup"><span data-stu-id="54da1-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="54da1-163">Per selezionare più file, utilizzare il tasto CTRL.</span><span class="sxs-lookup"><span data-stu-id="54da1-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="54da1-164">(Facoltativo) Ripetere il passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="54da1-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="54da1-165">Fare clic sulla scheda **Sfoglia**, passare a [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, selezionare Microsoft.SqlServer.Replication.BusinessLogicSupport.dll e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="54da1-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="54da1-166">Scegliere **Codice** dal menu **Visualizza**.</span><span class="sxs-lookup"><span data-stu-id="54da1-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="54da1-167">Nel codice, prima di qualsiasi dichiarazione, digitare le istruzioni `Imports` seguenti per qualificare i tipi negli spazi dei nomi di RMO:</span><span class="sxs-lookup"><span data-stu-id="54da1-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="54da1-168">Connessione a un server di replica</span><span class="sxs-lookup"><span data-stu-id="54da1-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="54da1-169">Gli oggetti di programmazione RMO richiedono che una connessione a un'istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] venga stabilita mediante un'istanza della classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="54da1-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="54da1-170">Questa connessione al server viene stabilita indipendentemente da qualsiasi oggetto di programmazione RMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="54da1-171">Viene quindi passata all'oggetto RMO durante la creazione dell'istanza o mediante l'assegnazione alla proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="54da1-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="54da1-172">In questo modo, un oggetto di programmazione RMO e le istanze dell'oggetto connessione possono essere creati e gestiti separatamente e un singolo oggetto connessione può essere riutilizzato con più oggetti di programmazione RMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="54da1-173">Le regole seguenti sono valide per le connessioni a un server di replica:</span><span class="sxs-lookup"><span data-stu-id="54da1-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="54da1-174">Tutte le proprietà per la connessione sono definite per un oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> specificato.</span><span class="sxs-lookup"><span data-stu-id="54da1-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="54da1-175">La connessione a ogni istanza di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] deve disporre del relativo oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="54da1-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="54da1-176">L'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> è assegnato alla proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> dell'oggetto di programmazione RMO creato o a cui si accede nel server.</span><span class="sxs-lookup"><span data-stu-id="54da1-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="54da1-177">Il metodo <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> apre la connessione al server.</span><span class="sxs-lookup"><span data-stu-id="54da1-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="54da1-178">Questo metodo deve essere chiamato prima di chiamare i metodi che consentono di accedere al server su qualsiasi oggetto di programmazione RMO utilizzando la connessione.</span><span class="sxs-lookup"><span data-stu-id="54da1-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="54da1-179">Poiché RMO e SMO ([!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects) utilizzano entrambi la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> per le connessioni a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], la stessa connessione può essere utilizzata sia da oggetti RMO che SMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="54da1-180">Per altre informazioni, vedere [Connessione a un'istanza di SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="54da1-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="54da1-181">Tutte le informazioni di autenticazione che consentono di stabilire la connessione e accedere correttamente al server vengono fornite nell'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="54da1-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="54da1-182">L'autenticazione di Windows rappresenta l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="54da1-182">Windows Authentication is the default.</span></span> <span data-ttu-id="54da1-183">Per utilizzare l'autenticazione di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> deve essere impostato su `false` e <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> e <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> devono essere impostati su un accesso e una password di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="54da1-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="54da1-184">Le credenziali di sicurezza devono essere sempre archiviate e gestite in modo protetto, nonché fornite in fase di esecuzione quando possibile.</span><span class="sxs-lookup"><span data-stu-id="54da1-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="54da1-185">Per le applicazioni multithreading, in ogni thread è necessario utilizzare un oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> separato.</span><span class="sxs-lookup"><span data-stu-id="54da1-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="54da1-186">Chiamare il metodo <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> sull'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> per chiudere le connessioni al server attive utilizzate da oggetti RMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="54da1-187">Impostazione delle proprietà RMO</span><span class="sxs-lookup"><span data-stu-id="54da1-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="54da1-188">Le proprietà degli oggetti di programmazione RMO rappresentano le proprietà di tali oggetti di replica nel server.</span><span class="sxs-lookup"><span data-stu-id="54da1-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="54da1-189">Quando si creano nuovi oggetti di replica nel server, le proprietà RMO vengono utilizzate per definire tali oggetti.</span><span class="sxs-lookup"><span data-stu-id="54da1-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="54da1-190">Per gli oggetti esistenti, le proprietà RMO rappresentano le proprietà dell'oggetto esistente, che possono essere modificate solo per le proprietà scrivibili o configurabili.</span><span class="sxs-lookup"><span data-stu-id="54da1-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="54da1-191">Le proprietà possono essere impostate su oggetti nuovi o esistenti.</span><span class="sxs-lookup"><span data-stu-id="54da1-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="54da1-192">Impostazione delle proprietà per oggetti di replica nuovi</span><span class="sxs-lookup"><span data-stu-id="54da1-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="54da1-193">Quando si crea un nuovo oggetto di replica nel server, è necessario specificare tutte le proprietà obbligatorie prima di chiamare il metodo `Create` dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="54da1-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="54da1-194">Per altre informazioni sull'impostazione delle proprietà per un nuovo oggetto di replica, vedere [Configurare la pubblicazione e la distribuzione](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="54da1-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="54da1-195">Impostazione delle proprietà per oggetti di replica esistenti</span><span class="sxs-lookup"><span data-stu-id="54da1-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="54da1-196">Per gli oggetti di replica che esistono nel server, a seconda dell'oggetto, RMO potrebbe supportare la possibilità di modificare alcune o tutte le proprietà corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="54da1-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="54da1-197">Solo le proprietà scrivibili o configurabili possono essere modificate.</span><span class="sxs-lookup"><span data-stu-id="54da1-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="54da1-198">Prima di poter modificare le proprietà, è necessario chiamare il metodo `Load` o <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> per ottenere le proprietà correnti dal server.</span><span class="sxs-lookup"><span data-stu-id="54da1-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="54da1-199">La chiamata di questi metodi indica che è in corso la modifica di un oggetto esistente.</span><span class="sxs-lookup"><span data-stu-id="54da1-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="54da1-200">Per impostazione predefinita, quando si modificano le proprietà degli oggetti, RMO esegue il commit di tali modifiche nel server in base alla modalità di esecuzione dell'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> in uso.</span><span class="sxs-lookup"><span data-stu-id="54da1-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="54da1-201">Il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> può essere utilizzato per verificare che un oggetto esista nel server prima di tentare di recuperare o modificare le proprietà corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="54da1-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="54da1-202">Per altre informazioni sulla modifica delle proprietà di un oggetto di replica, vedere [Visualizzare e modificare le proprietà del server di pubblicazione e del database di distribuzione](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="54da1-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="54da1-203">Se più client RMO o più istanze di un oggetto di programmazione RMO stanno accedendo allo stesso oggetto di replica nel server, il metodo `Refresh` dell'oggetto RMO può essere chiamato per aggiornare le proprietà in base allo stato corrente dell'oggetto nel server.</span><span class="sxs-lookup"><span data-stu-id="54da1-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="54da1-204">Memorizzazione nella cache delle modifiche alle proprietà</span><span class="sxs-lookup"><span data-stu-id="54da1-204">Caching Property Changes</span></span>  
 <span data-ttu-id="54da1-205">Quando la proprietà <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> è impostata su <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql>, tutte le istruzioni [!INCLUDE[tsql](../../../includes/tsql-md.md)] generate da RMO vengono acquisite in modo che possano essere eseguite manualmente in un unico batch mediante uno dei metodo di esecuzione disponibili.</span><span class="sxs-lookup"><span data-stu-id="54da1-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="54da1-206">RMO consente di memorizzare nella cache le modifiche alle proprietà e di eseguirne il commit contemporaneamente in un unico batch mediante il metodo <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="54da1-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="54da1-207">Per memorizzare nella cache le modifiche alle proprietà, la proprietà <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> dell'oggetto deve essere impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="54da1-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="54da1-208">Quando si memorizzano nella cache le modifiche alle proprietà apportate in RMO, l'oggetto <xref:Microsoft.SqlServer.Management.Common.ServerConnection> controlla comunque quando viene eseguito l'invio delle modifiche al server.</span><span class="sxs-lookup"><span data-stu-id="54da1-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="54da1-209">Per altre informazioni sulla modifica delle proprietà di un oggetto di replica, vedere [Visualizzare e modificare le proprietà del server di pubblicazione e del database di distribuzione](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="54da1-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="54da1-210">Sebbene la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> supporti la dichiarazione di transazioni esplicite durante l'impostazione delle proprietà, tali transazioni possono interferire con le transazioni di replica interne e produrre risultati inaspettati. Per questo motivo non devono essere utilizzate con RMO.</span><span class="sxs-lookup"><span data-stu-id="54da1-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="54da1-211">Esempio</span><span class="sxs-lookup"><span data-stu-id="54da1-211">Example</span></span>  
 <span data-ttu-id="54da1-212">In questo esempio viene illustrata la memorizzazione nella cache delle modifiche alle proprietà.</span><span class="sxs-lookup"><span data-stu-id="54da1-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="54da1-213">Le modifiche apportate agli attributi di una pubblicazione transazionale rimangono memorizzate nella cache fino a quando non vengono inviate in modo esplicito al server.</span><span class="sxs-lookup"><span data-stu-id="54da1-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="54da1-214">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="54da1-214">See Also</span></span>  
 <span data-ttu-id="54da1-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="54da1-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="54da1-216">Concetti di base relativi alla programmazione della replica</span><span class="sxs-lookup"><span data-stu-id="54da1-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  
