---
title: Replica di tipo merge | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication [SQL Server replication], about merge replication
- merge replication [SQL Server replication]
ms.assetid: ff87c368-4c00-4e48-809d-ea752839551e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 7feef9e4debc228d1685c664c072139d60b56c22
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87623193"
---
# <a name="merge-replication"></a><span data-ttu-id="ddc18-102">Replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="ddc18-102">Merge Replication</span></span>
  <span data-ttu-id="ddc18-103">In genere la replica di tipo merge, come la replica transazionale, inizia con uno snapshot degli oggetti e dei dati del database di pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="ddc18-103">Merge replication, like transactional replication, typically starts with a snapshot of the publication database objects and data.</span></span> <span data-ttu-id="ddc18-104">Eventuali modifiche dei dati e dello schema apportate successivamente nel server di pubblicazione e nei Sottoscrittori vengono rilevate tramite trigger.</span><span class="sxs-lookup"><span data-stu-id="ddc18-104">Subsequent data changes and schema modifications made at the Publisher and Subscribers are tracked with triggers.</span></span> <span data-ttu-id="ddc18-105">Al momento della connessione alla rete il Sottoscrittore esegue la sincronizzazione con il server di pubblicazione e scambia con esso le righe modificate dopo l'ultima sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="ddc18-105">The Subscriber synchronizes with the Publisher when connected to the network and exchanges all rows that have changed between the Publisher and Subscriber since the last time synchronization occurred.</span></span>

 <span data-ttu-id="ddc18-106">In genere la replica di tipo merge è utilizzata in ambienti server-to-client.</span><span class="sxs-lookup"><span data-stu-id="ddc18-106">Merge replication is typically used in server-to-client environments.</span></span> <span data-ttu-id="ddc18-107">La replica di tipo merge è adatta alle seguenti situazioni:</span><span class="sxs-lookup"><span data-stu-id="ddc18-107">Merge replication is appropriate in any of the following situations:</span></span>

-   <span data-ttu-id="ddc18-108">Più Sottoscrittori potrebbero richiedere l'aggiornamento dei dati in ore diverse e la distribuzione delle modifiche al server di pubblicazione e ad altri Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="ddc18-108">Multiple Subscribers might update the same data at various times and propagate those changes to the Publisher and to other Subscribers.</span></span>

-   <span data-ttu-id="ddc18-109">I Sottoscrittori devono ricevere i dati, eseguire le modifiche offline e sincronizzarle successivamente con il server di pubblicazione e i Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="ddc18-109">Subscribers need to receive data, make changes offline, and later synchronize changes with the Publisher and other Subscribers.</span></span>

-   <span data-ttu-id="ddc18-110">Per ogni Sottoscrittore è necessaria una diversa partizione di dati.</span><span class="sxs-lookup"><span data-stu-id="ddc18-110">Each Subscriber requires a different partition of data.</span></span>

-   <span data-ttu-id="ddc18-111">È necessario essere in grado di individuare e risolvere tempestivamente eventuali conflitti che potrebbero verificarsi.</span><span class="sxs-lookup"><span data-stu-id="ddc18-111">Conflicts might occur and, when they do, you need the ability to detect and resolve them.</span></span>

-   <span data-ttu-id="ddc18-112">È necessario lo scambio di dati net piuttosto che l'accesso a stati di dati intermedi.</span><span class="sxs-lookup"><span data-stu-id="ddc18-112">The application requires net data change rather than access to intermediate data states.</span></span> <span data-ttu-id="ddc18-113">Ad esempio, se una riga viene modificata cinque volte nel Sottoscrittore prima della sincronizzazione con un server di pubblicazione, la riga verrà modificata solo una volta nel server di pubblicazione per riflettere la modifica dei dati net, ovvero il quinto valore.</span><span class="sxs-lookup"><span data-stu-id="ddc18-113">For example, if a row changes five times at a Subscriber before it synchronizes with a Publisher, the row will change only once at the Publisher to reflect the net data change (that is, the fifth value).</span></span>

 <span data-ttu-id="ddc18-114">La replica di tipo merge consente a vari siti di eseguire elaborazioni in modo autonomo e di unire quindi gli aggiornamenti in un unico risultato uniforme.</span><span class="sxs-lookup"><span data-stu-id="ddc18-114">Merge replication allows various sites to work autonomously and later merge updates into a single, uniform result.</span></span> <span data-ttu-id="ddc18-115">Dato che gli aggiornamenti vengono eseguiti in più nodi, è possibile che dati uguali siano aggiornati dal server di pubblicazione e da più Sottoscrittori,</span><span class="sxs-lookup"><span data-stu-id="ddc18-115">Because updates are made at more than one node, the same data may have been updated by the Publisher and by more than one Subscriber.</span></span> <span data-ttu-id="ddc18-116">con la conseguente possibilità di conflitti quando viene eseguito il merge degli aggiornamenti. La replica di tipo merge offre tuttavia diversi modi di risoluzione dei conflitti.</span><span class="sxs-lookup"><span data-stu-id="ddc18-116">Therefore, conflicts can occur when updates are merged and merge replication provides a number of ways to handle conflicts.</span></span>

 <span data-ttu-id="ddc18-117">La replica di tipo merge viene implementata dall'agente snapshot e dall'agente di merge di [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ddc18-117">Merge replication is implemented by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Snapshot Agent and Merge Agent.</span></span> <span data-ttu-id="ddc18-118">Se la pubblicazione non è filtrata o utilizza filtri statici, l'agente snapshot crea un singolo snapshot.</span><span class="sxs-lookup"><span data-stu-id="ddc18-118">If the publication is unfiltered or uses static filters, the Snapshot Agent creates a single snapshot.</span></span> <span data-ttu-id="ddc18-119">Se la pubblicazione utilizza filtri con parametri, l'agente snapshot crea uno snapshot per ogni partizione di dati.</span><span class="sxs-lookup"><span data-stu-id="ddc18-119">If the publication uses parameterized filters, the Snapshot Agent creates a snapshot for each partition of data.</span></span> <span data-ttu-id="ddc18-120">L'agente di merge applica gli snapshot iniziali ai Sottoscrittori</span><span class="sxs-lookup"><span data-stu-id="ddc18-120">The Merge Agent applies the initial snapshots to the Subscribers.</span></span> <span data-ttu-id="ddc18-121">e unisce le modifiche ai dati incrementali apportate nel server di pubblicazione o nei Sottoscrittori dopo la creazione dello snapshot iniziale, quindi rileva e risolve eventuali conflitti in base alle regole configurate.</span><span class="sxs-lookup"><span data-stu-id="ddc18-121">It also merges incremental data changes that occurred at the Publisher or Subscribers after the initial snapshot was created, and detects and resolves any conflicts according to rules you configure.</span></span>

 <span data-ttu-id="ddc18-122">Per tener traccia delle modifiche, tramite la replica di tipo merge e la replica transazionale con sottoscrizioni ad aggiornamento in coda deve essere possibile identificare in modo univoco ogni riga di ogni tabella pubblicata.</span><span class="sxs-lookup"><span data-stu-id="ddc18-122">To track changes, merge replication (and transactional replication with queued updating subscriptions) must be able to uniquely identify every row in every published table.</span></span> <span data-ttu-id="ddc18-123">A tale scopo, tramite la replica di tipo merge la colonna `rowguid` viene aggiunta a ogni tabella, a meno che in essa non sia già inclusa una colonna di tipo di dati `uniqueidentifier` con il set di proprietà `ROWGUIDCOL`, in questo caso viene utilizzata la colonna in questione.</span><span class="sxs-lookup"><span data-stu-id="ddc18-123">To accomplish this merge replication adds the column `rowguid` to every table, unless the table already has a column of data type `uniqueidentifier` with the `ROWGUIDCOL` property set (in which case this column is used).</span></span> <span data-ttu-id="ddc18-124">Se la tabella viene rimossa dalla pubblicazione, la colonna `rowguid` viene eliminata; se per il rilevamento è stata utilizzata una colonna esistente, questa non viene eliminata.</span><span class="sxs-lookup"><span data-stu-id="ddc18-124">If the table is dropped from the publication, the `rowguid` column is removed; if an existing column was used for tracking, the column is not removed.</span></span> <span data-ttu-id="ddc18-125">In un filtro non deve essere inclusa la colonna `rowguidcol` utilizzata dalla replica per identificare le righe.</span><span class="sxs-lookup"><span data-stu-id="ddc18-125">A filter must not include the `rowguidcol` used by replication to identify rows.</span></span> <span data-ttu-id="ddc18-126">La funzione `newid()` è predefinita per la colonna `rowguid`, in ogni caso i clienti possono fornire un GUID per ogni riga, se necessario.</span><span class="sxs-lookup"><span data-stu-id="ddc18-126">The `newid()` function is provided as a default for the `rowguid` column, however customers can provide a guid for each row if needed.</span></span> <span data-ttu-id="ddc18-127">Non specificare tuttavia il valore 00000000-0000-0000-0000-000000000000.</span><span class="sxs-lookup"><span data-stu-id="ddc18-127">However, do not provide value 00000000-0000-0000-0000-000000000000.</span></span>

 <span data-ttu-id="ddc18-128">Nella figura seguente vengono illustrati i componenti utilizzati nella replica di tipo merge.</span><span class="sxs-lookup"><span data-stu-id="ddc18-128">The following diagram shows the components used in merge replication.</span></span>

 <span data-ttu-id="ddc18-129">![Componenti e flusso di dati per la replica di tipo merge](../media/merge.gif "Componenti e flusso di dati per la replica di tipo merge")</span><span class="sxs-lookup"><span data-stu-id="ddc18-129">![Merge replication components and data flow](../media/merge.gif "Merge replication components and data flow")</span></span>


