---
title: Raggruppare modifiche alle righe correlate con record logici | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication logical records [SQL Server replication]
- articles [SQL Server replication], logical records
- logical records [SQL Server replication]
ms.assetid: ad76799c-4486-4b98-9705-005433041321
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 433e0edbe83d102e6002bd133f967f27a236f66e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87623207"
---
# <a name="group-changes-to-related-rows-with-logical-records"></a><span data-ttu-id="94813-102">Raggruppamento di modifiche alla righe correlate con record logici</span><span class="sxs-lookup"><span data-stu-id="94813-102">Group Changes to Related Rows with Logical Records</span></span>
  
> [!NOTE]
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]

 <span data-ttu-id="94813-103">Per impostazione predefinita, i dati dei processi di replica di tipo merge cambiano riga per riga.</span><span class="sxs-lookup"><span data-stu-id="94813-103">By default, merge replication processes data changes on a row-by-row basis.</span></span> <span data-ttu-id="94813-104">In molti casi questo comportamento è appropriato, ma per alcune applicazioni è essenziale che le righe correlate vengano elaborate come unità.</span><span class="sxs-lookup"><span data-stu-id="94813-104">In many circumstances this is appropriate, but for some applications, it is essential that related rows be processed as a unit.</span></span> <span data-ttu-id="94813-105">La funzionalità di record logici della replica di tipo merge consente di definire una relazione tra righe correlate di tabelle diverse, in modo che le righe vengano elaborate come unità.</span><span class="sxs-lookup"><span data-stu-id="94813-105">The logical records feature of merge replication allows you to define a relationship between related rows in different tables so that the rows are processed as a unit.</span></span>

> [!NOTE]
>  <span data-ttu-id="94813-106">La funzionalità di record logici può essere utilizzata da sola o unitamente a filtri join.</span><span class="sxs-lookup"><span data-stu-id="94813-106">The logical records feature can be used alone or in conjunction with join filters.</span></span> <span data-ttu-id="94813-107">Per ulteriori informazioni sui filtri join, vedere [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="94813-107">For more information about join filters, see [Join Filters](join-filters.md).</span></span> <span data-ttu-id="94813-108">Per utilizzare i record logici, è necessario che il livello di compatibilità della pubblicazione sia almeno 90RTM.</span><span class="sxs-lookup"><span data-stu-id="94813-108">To use logical records, the compatibility level of the publication must be at least 90RTM.</span></span>

 <span data-ttu-id="94813-109">Si considerino le tre tabelle correlate seguenti:</span><span class="sxs-lookup"><span data-stu-id="94813-109">Consider these three related tables:</span></span>

 <span data-ttu-id="94813-110">![Record logico per tre tabelle con solo i nomi di colonna](../media/logical-records-01.gif "Record logico per tre tabelle con solo i nomi di colonna")</span><span class="sxs-lookup"><span data-stu-id="94813-110">![Three table logical record, with column names only](../media/logical-records-01.gif "Three table logical record, with column names only")</span></span>

 <span data-ttu-id="94813-111">La tabella **Customers** è la tabella padre in questa relazione e presenta una colonna chiave primaria **CustID**.</span><span class="sxs-lookup"><span data-stu-id="94813-111">The **Customers** table is the parent table in this relationship and has a primary key column **CustID**.</span></span> <span data-ttu-id="94813-112">La tabella **Orders** ha una colonna chiave primaria **OrderID**, con un vincolo di chiave esterna nella colonna **CustID** che fa riferimento alla colonna **CustID** nella tabella **Customers** .</span><span class="sxs-lookup"><span data-stu-id="94813-112">The **Orders** table has a primary key column **OrderID**, with a foreign key constraint on the **CustID** column that references the **CustID** column in the **Customers** table.</span></span> <span data-ttu-id="94813-113">Analogamente, la tabella **OrderItems** ha una colonna chiave primaria **OrderItemID**, con un vincolo di chiave esterna nella colonna **OrderID** che fa riferimento alla colonna **OrderID** nella tabella **Orders** .</span><span class="sxs-lookup"><span data-stu-id="94813-113">Similarly, the **OrderItems** table has a primary key column **OrderItemID**, with a foreign key constraint on the **OrderID** column that references the **OrderID** column in the **Orders** table.</span></span>

 <span data-ttu-id="94813-114">In questo esempio un record logico è composto da tutte le righe della tabella **Orders** correlate a un unico valore di **CustID** e da tutte le righe della tabella **OrderItems** correlate a tali righe della tabella **Orders** .</span><span class="sxs-lookup"><span data-stu-id="94813-114">In this example, a logical record consists of all the rows in the **Orders** table that are related to a single **CustID** value and all of the rows in the **OrderItems** table that are related to those rows in the **Orders** table.</span></span> <span data-ttu-id="94813-115">Nel grafico seguente vengono illustrate tutte le righe delle tre tabelle che si trovano nel record logico di Customer2:</span><span class="sxs-lookup"><span data-stu-id="94813-115">This diagram shows all the rows in the three tables that are in the logical record for Customer2:</span></span>

 <span data-ttu-id="94813-116">![Record logico per tre tabelle con valori](../media/logical-records-02.gif "Record logico per tre tabelle con valori")</span><span class="sxs-lookup"><span data-stu-id="94813-116">![Three table logical record with values](../media/logical-records-02.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="94813-117">Per definire una relazione tra record logici per gli articoli, vedere [Definizione di una relazione tra record logici degli articoli di tabelle di merge](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span><span class="sxs-lookup"><span data-stu-id="94813-117">To define a logical record relationship between articles, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>

## <a name="benefits-of-logical-records"></a><span data-ttu-id="94813-118">Vantaggi dei record logici</span><span class="sxs-lookup"><span data-stu-id="94813-118">Benefits of Logical Records</span></span>
 <span data-ttu-id="94813-119">La funzionalità di record logici offre due vantaggi principali:</span><span class="sxs-lookup"><span data-stu-id="94813-119">The logical records feature has two primary benefits:</span></span>

-   <span data-ttu-id="94813-120">Applicazione delle modifiche ai dati come unità.</span><span class="sxs-lookup"><span data-stu-id="94813-120">Application of data changes as a unit.</span></span>

-   <span data-ttu-id="94813-121">Rilevamento e risoluzione di conflitti contemporaneamente in più righe di più tabelle.</span><span class="sxs-lookup"><span data-stu-id="94813-121">The detection and resolution of conflicts simultaneously on multiple rows from multiple tables.</span></span>

### <a name="the-application-of-changes-as-a-unit"></a><span data-ttu-id="94813-122">Applicazione di modifiche come unità</span><span class="sxs-lookup"><span data-stu-id="94813-122">The Application of Changes As a Unit</span></span>
 <span data-ttu-id="94813-123">Se l'elaborazione di tipo merge viene interrotta, ad esempio nel caso di interruzione della connessione, se sono stati utilizzati record logici, viene eseguito il rollback del set parzialmente completato di modifiche replicate correlate.</span><span class="sxs-lookup"><span data-stu-id="94813-123">If merge processing is interrupted, such as in the case of a dropped connection, the partially completed set of related replicated changes is rolled back if logical records are used.</span></span> <span data-ttu-id="94813-124">Si consideri, ad esempio, il caso in cui un Sottoscrittore aggiunga un nuovo ordine con **OrderID** = 6 e due nuove righe nella tabella **OrderItems** con **OrderItemID** = 10 e **OrderItemID** = 11 per **OrderID** = 6.</span><span class="sxs-lookup"><span data-stu-id="94813-124">For example, consider the case where a Subscriber adds a new order with **OrderID** = 6 and two new rows in the **OrderItems** table with **OrderItemID** = 10 and **OrderItemID** = 11 for **OrderID** = 6.</span></span>

 <span data-ttu-id="94813-125">![Record logico per tre tabelle con valori](../media/logical-records-04.gif "Record logico per tre tabelle con valori")</span><span class="sxs-lookup"><span data-stu-id="94813-125">![Three table logical record with values](../media/logical-records-04.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="94813-126">Se il processo di replica viene interrotto dopo che la riga **Orders** per **OrderID** = 6 è stata completata, ma prima che gli elementi 11 e 12 della tabella **OrderItems** siano completati e se i record logici non vengono utilizzati, il valore di **OrderTotal** per **OrderID** = 6 non coinciderà con la somma dei valori di **OrderAmount** per le righe di **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="94813-126">If the replication process is interrupted after the **Orders** row for **OrderID** = 6 is complete, but before the **OrderItems** 10 and 11 are completed, and logical records are not used, the **OrderTotal** value for **OrderID** = 6 will not be consistent with the sum of the **OrderAmount** values for the **OrderItems** rows.</span></span> <span data-ttu-id="94813-127">Se vengono utilizzati record logici, non verrà eseguito il commit della riga **Orders** per **OrderID** = 6 fino a quando le modifiche correlate nella tabella **OrderItems** non saranno replicate.</span><span class="sxs-lookup"><span data-stu-id="94813-127">If logical records are used, the **Orders** row for **OrderID** = 6 is not committed until the related **OrderItems** changes are replicated.</span></span>

 <span data-ttu-id="94813-128">In uno scenario diverso, se vengono utilizzati i record logici e si esegue una query sulle tabelle mentre il processo di tipo merge sta applicando le modifiche, l'utente non vedrà le modifiche parzialmente replicate fino a quando non saranno tutte complete.</span><span class="sxs-lookup"><span data-stu-id="94813-128">In a different scenario, if logical records are used, and someone is querying tables when the merge process is applying changes, the user will not see the partially replicated changes until they are all complete.</span></span> <span data-ttu-id="94813-129">Se, ad esempio, tramite il processo di replica è stata caricata la riga Orders per **OrderID** = 6, ma un utente esegue una query sulle tabelle prima che tramite il processo di replica siano state replicate le righe di **OrderItems** , il valore di **OrderTotal** non sarà uguale alla somma dei valori di **OrderAmount** .</span><span class="sxs-lookup"><span data-stu-id="94813-129">For example, the replication process has uploaded the Orders row for **OrderID** = 6, but a user queries the tables before the replication process has replicated the **OrderItems** rows, the **OrderTotal** value would not be the same as the sum of the **OrderAmount** values.</span></span> <span data-ttu-id="94813-130">Se vengono utilizzati record logici, la riga **Orders** non sarà visibile fino a quando le righe di **OrderItems** non saranno complete e non sarà stato eseguito il commit della transazione come unità.</span><span class="sxs-lookup"><span data-stu-id="94813-130">If logical records are used, the **Orders** row would not be visible until the **OrderItems** rows are complete and the transaction has been committed as a unit.</span></span>

### <a name="the-application-of-conflict-handling-to-more-than-one-table"></a><span data-ttu-id="94813-131">Applicazione della gestione dei conflitti a più di una tabella</span><span class="sxs-lookup"><span data-stu-id="94813-131">The Application of Conflict Handling to More Than One Table</span></span>
 <span data-ttu-id="94813-132">Si consideri il caso in cui due Sottoscrittori dispongono del set di dati illustrato in precedenza:</span><span class="sxs-lookup"><span data-stu-id="94813-132">Consider the case where two Subscribers have the data set above:</span></span>

-   <span data-ttu-id="94813-133">Un utente nel primo Sottoscrittore modifica il valore di **OrderAmount** per **OrderItemID** 5 da 100 a 150 e il valore di **OrderTotal** per **OrderID** 3 da 200 a 250.</span><span class="sxs-lookup"><span data-stu-id="94813-133">A user at the first Subscriber changes the **OrderAmount** of **OrderItemID** 5 from 100 to 150 and the **OrderTotal** of **OrderID** 3 from 200 to 250.</span></span>

-   <span data-ttu-id="94813-134">Un utente nel secondo Sottoscrittore modifica il valore di **OrderAmount** per **OrderItemID** 6 da 25 a 125 e il valore di **OrderTotal** per **OrderID** 3 da 200 a 300.</span><span class="sxs-lookup"><span data-stu-id="94813-134">A user at the second Subscriber changes the **OrderAmount** of **OrderItemID** 6 from 25 to 125 and the **OrderTotal** of **OrderID** 3 from 200 to 300.</span></span>

 <span data-ttu-id="94813-135">Se queste modifiche vengono replicate senza utilizzare record logici, i diversi valori di **OrderTotal** daranno luogo a un conflitto e solo uno di essi verrà replicato.</span><span class="sxs-lookup"><span data-stu-id="94813-135">If these changes are replicated without using logical records, the different **OrderTotal** values would result in a conflict and only one of them would be replicated.</span></span> <span data-ttu-id="94813-136">Le modifiche non in conflitto presenti nella tabella **OrderItems** verranno tuttavia replicate senza alcun conflitto, lasciando i valori finali di **OrderTotal** in uno stato inconsistente rispetto alle righe di **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="94813-136">But the non-conflicting changes in the **OrderItems** table would be replicated without conflict, leaving the final **OrderTotal** values in an inconsistent state with respect to the **OrderItems** rows.</span></span> <span data-ttu-id="94813-137">Se in questo scenario vengono utilizzati i record logici, verrà eseguito il rollback della modifica a **OrderItems** associata alla modifica della tabella **Orders** in perdita e il valore di **OrderTotal** finale sarà costituito da un riepilogo accurato delle righe di **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="94813-137">If logical records are used in this scenario, the **OrderItems** change associated with the losing **Orders** table change would also be rolled back, and the final **OrderTotal** value would be an accurate summary of the **OrderItems** rows.</span></span>

 <span data-ttu-id="94813-138">Per altre informazioni sulle opzioni correlate al rilevamento e alla risoluzione dei conflitti per i record logici, vedere [Rilevamento e risoluzione dei conflitti nei record logici](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="94813-138">For more information about options related to conflict detection and resolution with logical records, see [Detecting and Resolving Conflicts in Logical Records](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>

## <a name="considerations-for-using-logical-records"></a><span data-ttu-id="94813-139">Considerazioni sull'utilizzo di record logici</span><span class="sxs-lookup"><span data-stu-id="94813-139">Considerations for Using Logical Records</span></span>
 <span data-ttu-id="94813-140">Quando si utilizzano i record logici, tenere presenti le considerazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="94813-140">Keep the following considerations in mind when using logical records.</span></span>

### <a name="general-considerations"></a><span data-ttu-id="94813-141">Considerazioni generali</span><span class="sxs-lookup"><span data-stu-id="94813-141">General Considerations</span></span>

-   <span data-ttu-id="94813-142">È consigliabile che il numero di tabelle in un record logico sia il più basso possibile, ad esempio cinque tabelle o un numero inferiore.</span><span class="sxs-lookup"><span data-stu-id="94813-142">It is recommended that you keep the number of tables in a logical record as low as possible; five tables or less is recommended.</span></span>

-   <span data-ttu-id="94813-143">I record logici non possono fare riferimento a colonne con i tipi di dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="94813-143">Logical records cannot reference columns with any of the following data types:</span></span>

    -   <span data-ttu-id="94813-144">`varchar(max)` e `nvarchar(max)`</span><span class="sxs-lookup"><span data-stu-id="94813-144">`varchar(max)` and `nvarchar(max)`</span></span>

    -   `varbinary(max)`

    -   <span data-ttu-id="94813-145">`text` e `ntext`</span><span class="sxs-lookup"><span data-stu-id="94813-145">`text` and `ntext`</span></span>

    -   `image`

    -   `XML`

    -   `UDT`

-   <span data-ttu-id="94813-146">Le relazioni di chiavi esterne nelle tabelle pubblicate non possono essere definite mediante l'opzione CASCADE.</span><span class="sxs-lookup"><span data-stu-id="94813-146">Foreign key relationships in published tables cannot be defined with the CASCADE option.</span></span> <span data-ttu-id="94813-147">Per altre informazioni, vedere [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) e [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="94813-147">For more information, see [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) and [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span></span>

-   <span data-ttu-id="94813-148">Non è possibile aggiornare le colonne utilizzate nella clausola di relazione logica.</span><span class="sxs-lookup"><span data-stu-id="94813-148">You cannot update any columns that are used in the logical relation clause.</span></span>

-   <span data-ttu-id="94813-149">La risoluzione dei conflitti personalizzata con gestori della logica di business o sistemi di risoluzione personalizzati non è supportata per gli articoli inclusi in un record logico.</span><span class="sxs-lookup"><span data-stu-id="94813-149">Custom conflict resolution with business logic handlers or custom resolvers is not supported for articles that are included in a logical record.</span></span>

-   <span data-ttu-id="94813-150">Se in una pubblicazione che include filtri con parametri vengono utilizzati record logici, è necessario inizializzare ogni Sottoscrittore con uno snapshot per la relativa partizione.</span><span class="sxs-lookup"><span data-stu-id="94813-150">If logical records are used in a publication that includes parameterized filters, you must initialize each Subscriber with a snapshot for its partition.</span></span> <span data-ttu-id="94813-151">Se si inizializza un Sottoscrittore con un altro metodo, l'agente di merge non verrà eseguito in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="94813-151">If you initialize a Subscriber with another method, the Merge Agent will fail.</span></span> <span data-ttu-id="94813-152">Per altre informazioni, vedere [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="94813-152">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>

-   <span data-ttu-id="94813-153">I conflitti a livello di record logici non vengono visualizzati nel Visualizzatore conflitti.</span><span class="sxs-lookup"><span data-stu-id="94813-153">Conflicts that involve logical records are not displayed in Conflict Viewer.</span></span> <span data-ttu-id="94813-154">Per visualizzare informazioni relative a questi conflitti, utilizzare le stored procedure di replica.</span><span class="sxs-lookup"><span data-stu-id="94813-154">To view information about these conflicts, use replication stored procedures.</span></span> <span data-ttu-id="94813-155">Per altre informazioni, vedere [Visualizzare le informazioni sui conflitti per le pubblicazioni di tipo merge &#40;programmazione Transact-SQL della replica&#41;](../view-conflict-information-for-merge-publications.md).</span><span class="sxs-lookup"><span data-stu-id="94813-155">For more information, see [View Conflict Information for Merge Publications &#40;Replication Transact-SQL Programming&#41;](../view-conflict-information-for-merge-publications.md).</span></span>

### <a name="publication-settings"></a><span data-ttu-id="94813-156">Impostazioni di pubblicazione</span><span class="sxs-lookup"><span data-stu-id="94813-156">Publication Settings</span></span>

-   <span data-ttu-id="94813-157">È necessario che la pubblicazione abbia un livello di compatibilità pari a 90RTM o superiore.</span><span class="sxs-lookup"><span data-stu-id="94813-157">The publication must have a compatibility level of 90RTM or greater.</span></span> <span data-ttu-id="94813-158">Per altre informazioni, vedere la sezione "Livello di compatibilità della pubblicazione" in [Compatibilità con le versioni precedenti della replica](../replication-backward-compatibility.md).</span><span class="sxs-lookup"><span data-stu-id="94813-158">For more information, see the "Publication Compatibility Level" section of [Replication Backward Compatibility](../replication-backward-compatibility.md).</span></span>

-   <span data-ttu-id="94813-159">È necessario che nella pubblicazione sia utilizzata la modalità snapshot nativa.</span><span class="sxs-lookup"><span data-stu-id="94813-159">The publication must use native snapshot mode.</span></span> <span data-ttu-id="94813-160">Si tratta dell'impostazione predefinita a meno che non si esegua la replica in [!INCLUDE[ssEW](../../../includes/ssew-md.md)], che non supporta i record logici.</span><span class="sxs-lookup"><span data-stu-id="94813-160">This is the default unless you are replicating to [!INCLUDE[ssEW](../../../includes/ssew-md.md)], which does not support logical records.</span></span>

-   <span data-ttu-id="94813-161">La pubblicazione non consente la sincronizzazione tramite il Web.</span><span class="sxs-lookup"><span data-stu-id="94813-161">The publication cannot allow Web synchronization.</span></span> <span data-ttu-id="94813-162">Per ulteriori informazioni sulla sincronizzazione Web, vedere [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="94813-162">For more information about Web synchronization, see [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span></span>

-   <span data-ttu-id="94813-163">Per utilizzare record logici in una pubblicazione filtrata:</span><span class="sxs-lookup"><span data-stu-id="94813-163">In order to use logical records on a filtered publication:</span></span>

    -   <span data-ttu-id="94813-164">È necessario utilizzare partizioni pre-calcolate.</span><span class="sxs-lookup"><span data-stu-id="94813-164">Precomputed partitions must also be used.</span></span> <span data-ttu-id="94813-165">I requisiti delle partizioni pre-calcolate si applicano anche ai record logici.</span><span class="sxs-lookup"><span data-stu-id="94813-165">The requirements of precomputed partitions also apply to logical records.</span></span> <span data-ttu-id="94813-166">Per altre informazioni, vedere [Ottimizzare le prestazioni dei filtri con parametri con le partizioni pre-calcolate](parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="94813-166">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>

    -   <span data-ttu-id="94813-167">Non è possibile utilizzare filtri con parametri non sovrapposti.</span><span class="sxs-lookup"><span data-stu-id="94813-167">You cannot use nonoverlapping parameterized filters.</span></span> <span data-ttu-id="94813-168">Per ulteriori informazioni, vedere la sezione Impostazione delle opzioni delle partizioni in [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="94813-168">For more information, see the "Setting 'partition options'" section of [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span></span>

-   <span data-ttu-id="94813-169">Se nella pubblicazione sono utilizzati filtri join, è necessario che la proprietà **join unique key** sia impostata su **true** per tutti i filtri join coinvolti in relazioni tra record logici.</span><span class="sxs-lookup"><span data-stu-id="94813-169">If the publication uses join filters, the **join unique key** property must be set to **true** for all join filters that are involved in logical record relationships.</span></span> <span data-ttu-id="94813-170">Per altre informazioni, vedere [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="94813-170">For more information, see [Join Filters](join-filters.md).</span></span>

### <a name="relationships-between-tables"></a><span data-ttu-id="94813-171">Relazioni tra tabelle</span><span class="sxs-lookup"><span data-stu-id="94813-171">Relationships Between Tables</span></span>

-   <span data-ttu-id="94813-172">È necessario che le tabelle correlate tramite record logici presentino una relazione tra chiave primaria e chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="94813-172">Tables related through logical records must have a primary key-foreign key relationship.</span></span>

-   <span data-ttu-id="94813-173">Non è possibile impostare l'opzione NOT FOR REPLICATION per i vincoli di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="94813-173">The NOT FOR REPLICATION option cannot be set for foreign key constraints.</span></span>

-   <span data-ttu-id="94813-174">Le tabelle figlio possono avere solo una tabella padre.</span><span class="sxs-lookup"><span data-stu-id="94813-174">Child tables can have only one parent table.</span></span>

     <span data-ttu-id="94813-175">Un database utilizzato per tenere traccia di classi e studenti potrebbe, ad esempio, avere una struttura simile alla seguente:</span><span class="sxs-lookup"><span data-stu-id="94813-175">For example, a database tracking classes and students might have a design similar to:</span></span>

     <span data-ttu-id="94813-176">![Tabella figlio con più di una tabella padre](../media/logical-records-03.gif "Tabella figlio con più di una tabella padre")</span><span class="sxs-lookup"><span data-stu-id="94813-176">![Child table with more than one parent table](../media/logical-records-03.gif "Child table with more than one parent table")</span></span>

     <span data-ttu-id="94813-177">Non è possibile utilizzare un record logico per rappresentare le tre tabelle di questa relazione, in quanto le righe in **ClassMembers** non sono associate a una singola riga chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="94813-177">You cannot use a logical record to represent the three tables in this relationship, because the rows in **ClassMembers** are not associated with a single primary key row.</span></span> <span data-ttu-id="94813-178">Le tabelle **Classes** e **ClassMembers** potrebbero formare un record logico, così come potrebbero formarlo le tabelle **ClassMembers** e **Students**, ma non tutte e tre.</span><span class="sxs-lookup"><span data-stu-id="94813-178">The tables **Classes** and **ClassMembers** could still form a logical record, as could the tables **ClassMembers** and **Students**, but not all three.</span></span>

-   <span data-ttu-id="94813-179">La pubblicazione non può contenere relazioni circolari tra filtri join.</span><span class="sxs-lookup"><span data-stu-id="94813-179">The publication cannot contain circular join filter relationships.</span></span>

     <span data-ttu-id="94813-180">Utilizzando l'esempio con le tabelle **Customers**, **Orders**e **OrderItems**, non è possibile utilizzare record logici se la tabella **Orders** presenta anche un vincolo di chiave esterna che fa riferimento alla tabella **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="94813-180">Using the example with the tables **Customers**, **Orders**, and **OrderItems**, you could not use logical records if the **Orders** table also had a foreign key constraint that referenced the **OrderItems** table.</span></span>

## <a name="performance-implications-of-logical-records"></a><span data-ttu-id="94813-181">Effetti dei record logici sulle prestazioni</span><span class="sxs-lookup"><span data-stu-id="94813-181">Performance implications of logical records</span></span>
 <span data-ttu-id="94813-182">La funzionalità di record logici comporta alcuni costi relativi alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="94813-182">The logical record feature does come with a performance cost.</span></span> <span data-ttu-id="94813-183">Se non vengono utilizzati record logici, l'agente di replica può elaborare contemporaneamente tutte le modifiche relative a un determinato articolo e poiché le modifiche vengono applicate riga per riga, i requisiti del log delle transazioni e di blocco necessari per l'applicazione di tali modifiche sono minimi.</span><span class="sxs-lookup"><span data-stu-id="94813-183">If logical records are not used, the replication agent can process all of the changes for a given article at the same time, and because the changes are applied in a row-by-row fashion, the locking and transaction log requirements necessary for applying the changes are minimal.</span></span>

 <span data-ttu-id="94813-184">Se vengono utilizzati record logici, è necessario che l'agente di merge elabori insieme le modifiche per ogni record logico completo.</span><span class="sxs-lookup"><span data-stu-id="94813-184">If logical records are used, the Merge Agent must process the changes for each entire logical record together.</span></span> <span data-ttu-id="94813-185">Questa operazione influisce sulla quantità di tempo necessaria per la replica delle righe da parte dell'agente di merge.</span><span class="sxs-lookup"><span data-stu-id="94813-185">This has an effect on the amount of time it takes the Merge Agent to replicate the rows.</span></span> <span data-ttu-id="94813-186">Poiché, inoltre, tramite l'agente viene aperta una transazione separata per ogni record logico, i requisiti di blocco possono aumentare.</span><span class="sxs-lookup"><span data-stu-id="94813-186">Additionally, because the agent opens a separate transaction for each logical record, locking requirements can increase.</span></span>

## <a name="see-also"></a><span data-ttu-id="94813-187">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="94813-187">See Also</span></span>
 [<span data-ttu-id="94813-188">Opzioni degli articoli per la replica di tipo merge</span><span class="sxs-lookup"><span data-stu-id="94813-188">Article Options for Merge Replication</span></span>](article-options-for-merge-replication.md)


