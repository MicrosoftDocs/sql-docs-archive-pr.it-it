---
title: Sistemi di risoluzione personalizzati basati su COM | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: 94195797-ad7a-4962-a8e3-b259cd13aa38
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2b28795c1a7d43bcd4e8cb3f18723e05f9e76966
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87718018"
---
# <a name="com-based-custom-resolvers"></a><span data-ttu-id="dc6e6-102">COM-Based Custom Resolvers</span><span class="sxs-lookup"><span data-stu-id="dc6e6-102">COM-Based Custom Resolvers</span></span>
  <span data-ttu-id="dc6e6-103">I sistemi di risoluzione personalizzati offrono una flessibilità maggiore rispetto al meccanismo di risoluzione predefinito e possono implementare la logica di business richiesta dalle applicazioni che utilizzano i dati replicati.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-103">Custom resolvers provide more flexibility than the default resolution mechanism, and they can implement business logic required by applications using the replicated data.</span></span> <span data-ttu-id="dc6e6-104">Un sistema di risoluzione personalizzato basato su COM è una libreria di collegamento dinamico (DLL, dynamic-link library) che implementa l'interfaccia COM **ICustomResolver** con i relativi metodi e proprietà e altre interfacce e definizioni di tipi di supporto progettate appositamente per la risoluzione dei conflitti.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-104">A COM-based custom resolver is a dynamic-link library (DLL) that implements the **ICustomResolver** COM interface, its methods and properties, and other supporting interfaces and type definitions designed specifically for conflict resolution.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="dc6e6-105">Se possibile, è consigliabile utilizzare un gestore della logica di business anziché un sistema di risoluzione personalizzato basato su COM.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-105">It is recommended to use a business logic handler rather than a COM-based custom resolver if possible.</span></span> <span data-ttu-id="dc6e6-106">Per altre informazioni sui gestori della logica di business, vedere [Eseguire logiche di business durante la sincronizzazione di tipo merge](execute-business-logic-during-merge-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="dc6e6-106">For more information on business logic handlers, see [Execute Business Logic During Merge Synchronization](execute-business-logic-during-merge-synchronization.md).</span></span>  
  
 <span data-ttu-id="dc6e6-107">Per compilare un sistema di risoluzione COM personalizzato, è possibile utilizzare la libreria dei tipi inclusa in replrec.dll. Per impostazione predefinita, questa libreria è installata in [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-107">To build a custom COM resolver, you can use the type library that is provided in the replrec.dll; by default, this library is installed at [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span></span>  
  
 <span data-ttu-id="dc6e6-108">Prima di creare un sistema di risoluzione COM personalizzato, è necessario stabilire i fattori seguenti:</span><span class="sxs-lookup"><span data-stu-id="dc6e6-108">Before writing a custom COM resolver, you need to decide:</span></span>  
  
-   <span data-ttu-id="dc6e6-109">I tipi di modifiche alle righe che si desidera risolvere, ad esempio le operazioni di aggiornamento, inserimento ed eliminazione oppure se il sistema di risoluzione deve essere richiamato durante le operazioni di caricamento o di download delle modifiche di tipo merge o durante entrambi i processi.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-109">The types of row changes you want to resolve, such as updates, inserts, and deletes, and whether the resolver should be invoked during the upload of merge changes, the download of merge changes, or both.</span></span> <span data-ttu-id="dc6e6-110">È possibile specificare un tipo di modifica, tutte le modifiche o qualsiasi combinazione di modifiche.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-110">You can specify one type of change, all changes, or any combination.</span></span> <span data-ttu-id="dc6e6-111">Il sistema di risoluzione dei conflitti del processo di merge predefinito gestisce tutti i conflitti non risolti da un sistema di risoluzione personalizzato.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-111">The default merge conflict resolver handles any conflicts not covered by a custom resolver.</span></span>  
  
-   <span data-ttu-id="dc6e6-112">Se utilizzare il rilevamento a livello di colonna per la risoluzione dei conflitti.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-112">Whether to use column tracking when resolving the conflict.</span></span> <span data-ttu-id="dc6e6-113">Quando si utilizza il rilevamento a livello di colonna, vengono contrassegnati come conflitti solo i dati delle colonne in cui si verifica un conflitto. Negli altri casi i dati vengono uniti.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-113">When column-level tracking is on, only data in those columns where a conflict exists are flagged as a conflict, otherwise the data is merged.</span></span> <span data-ttu-id="dc6e6-114">I conflitti tuttavia vengono risolti in base alle stesse modalità utilizzate per il rilevamento a livello di riga, ovvero il processo che prevale sovrascrive l'intera riga di dati. I dati tuttavia possono essere una combinazione dei valori del server di pubblicazione e dei Sottoscrittori oppure valori alterati che non provengono né dal server di pubblicazione, né dai Sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-114">However, conflicts are resolved in the same way as row-level tracking: the priority winner overwrites the entire row of data (but the data can be a mix of values from the Publisher, Subscribers, or some altered values that were from neither Publisher nor Subscribers).</span></span> <span data-ttu-id="dc6e6-115">Per altre informazioni, vedere [Rilevare e risolvere i conflitti tra repliche di tipo merge](advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="dc6e6-115">For more information, see [Detect and Resolve Merge Replication Conflicts](advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
 <span data-ttu-id="dc6e6-116">Per implementare un sistema di risoluzione dei conflitti personalizzato basato su COM, vedere [Implementazione di un sistema di risoluzione dei conflitti personalizzato per un articolo di tipo merge](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="dc6e6-116">To implement a COM-based custom conflict resolver, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span></span>  
  
 <span data-ttu-id="dc6e6-117">Un sistema di risoluzione personalizzato viene specificato per un articolo, non per un'intera pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-117">A custom resolver is specified for an article, not an entire publication.</span></span> <span data-ttu-id="dc6e6-118">Lo stesso sistema può essere utilizzato con più articoli, ma la logica nei sistemi di risoluzione personalizzati è spesso specifica di una particolare tabella.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-118">The same resolver can be used with more than one article, but the logic in custom resolvers is often specific to a particular table.</span></span> <span data-ttu-id="dc6e6-119">Se la tabella utilizzata nell'articolo viene modificata dopo la creazione del sistema, ad esempio rinominando la colonna utilizzata nella risoluzione dei conflitti, potrebbe essere necessario modificare e ricompilare il sistema di risoluzione personalizzato.</span><span class="sxs-lookup"><span data-stu-id="dc6e6-119">If the table used in the article is modified after the resolver is created (for example, renaming the column name that is used in conflict resolution), the custom resolver might need to be modified and recompiled.</span></span>  
  
 <span data-ttu-id="dc6e6-120">Per specificare un sistema di risoluzione personalizzato, vedere [Impostazione di un sistema di risoluzione dei conflitti dell'articolo di merge](../publish/specify-a-merge-article-resolver.md).</span><span class="sxs-lookup"><span data-stu-id="dc6e6-120">To specify a custom resolver, see [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dc6e6-121">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="dc6e6-121">See Also</span></span>  
 <span data-ttu-id="dc6e6-122">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="dc6e6-122">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="dc6e6-123">Microsoft COM-Based Resolvers</span><span class="sxs-lookup"><span data-stu-id="dc6e6-123">Microsoft COM-Based Resolvers</span></span>](advanced-merge-replication-conflict-com-based-resolvers.md)  
  
  
