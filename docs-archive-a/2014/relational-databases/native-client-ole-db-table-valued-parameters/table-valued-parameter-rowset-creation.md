---
title: Creazione di un set di righe di parametri con valori di tabella | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
ms.assetid: ffe213ca-cc0e-465e-b31c-a8272324c4fe
author: rothja
ms.author: jroth
ms.openlocfilehash: a22ccbd583d95c41daa0a113363985828cf1e9d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/04/2020
ms.locfileid: "87626728"
---
# <a name="table-valued-parameter-rowset-creation"></a><span data-ttu-id="fb69c-102">Creazione di un set di righe di parametri con valori di tabella</span><span class="sxs-lookup"><span data-stu-id="fb69c-102">Table-Valued Parameter Rowset Creation</span></span>
  <span data-ttu-id="fb69c-103">Sebbene i consumer siano in grado di fornire qualsiasi oggetto set di righe per i parametri con valori di tabella, vengono implementati gli oggetti set di righe tipici rispetto agli archivi dati di back-end, con conseguente limitazione delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="fb69c-103">Although consumers can provide any rowset object for table-valued parameters, typical rowset objects are implemented against back-end data stores, and therefore provide limited performance.</span></span> <span data-ttu-id="fb69c-104">Per questo motivo, il provider OLE DB di [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client consente ai consumer di creare un oggetto set di righe specializzato nei dati in memoria.</span><span class="sxs-lookup"><span data-stu-id="fb69c-104">For this reason, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider enables consumers to create a specialized rowset object on top of in-memory data.</span></span> <span data-ttu-id="fb69c-105">Questo speciale oggetto set di righe in memoria è un nuovo oggetto COM denominato set di righe di parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="fb69c-105">This special, in-memory rowset object is a new COM object called a table-valued parameter rowset .</span></span> <span data-ttu-id="fb69c-106">Tale oggetto fornisce funzionalità simili ai set di parametri.</span><span class="sxs-lookup"><span data-stu-id="fb69c-106">It provides functionality similar to parameter sets.</span></span>  
  
 <span data-ttu-id="fb69c-107">Gli oggetti set di righe di parametri con valori di tabella vengono creati in modo esplicito dal consumer per i parametri di input tramite più interfacce a livello di sessione.</span><span class="sxs-lookup"><span data-stu-id="fb69c-107">Table-valued parameter rowset objects are created explicitly by the consumer for input parameters through multiple session-level interfaces.</span></span> <span data-ttu-id="fb69c-108">Esiste una sola istanza di un oggetto set di righe di parametri con valori di tabella per parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="fb69c-108">There is one instance of a table-valued parameter rowset object per table-valued parameter.</span></span> <span data-ttu-id="fb69c-109">Il consumer può creare gli oggetti set di righe di parametri con valori di tabella fornendo le informazioni sui metadati già note (scenario statico) o individuandole tramite le interfacce del provider (scenario dinamico).</span><span class="sxs-lookup"><span data-stu-id="fb69c-109">The consumer can create the table-valued parameter rowset objects either by providing metadata information that is already known (static scenario), or by discovering it through provider interfaces (dynamic scenario).</span></span> <span data-ttu-id="fb69c-110">Nelle sezioni seguenti vengono descritti questi due scenari.</span><span class="sxs-lookup"><span data-stu-id="fb69c-110">The following sections describe these two scenarios.</span></span>  
  
## <a name="static-scenario"></a><span data-ttu-id="fb69c-111">Scenario statico</span><span class="sxs-lookup"><span data-stu-id="fb69c-111">Static Scenario</span></span>  
 <span data-ttu-id="fb69c-112">Quando le informazioni sul tipo sono note, il consumer usa ITableDefinitionWithConstraints::CreateTableWithConstraints per creare un'istanza dell'oggetto set di righe di parametri con valori di tabella che corrisponde a un parametro con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="fb69c-112">When the type information is known, the consumer uses ITableDefinitionWithConstraints::CreateTableWithConstraints to instantiate a table-valued parameter rowset object that corresponds to a table-valued parameter.</span></span>  
  
 <span data-ttu-id="fb69c-113">Il campo *guid* (parametro *pTableID*) contiene il GUID speciale (CLSID_ROWSET_TVP).</span><span class="sxs-lookup"><span data-stu-id="fb69c-113">The *guid* field (*pTableID* parameter) contains the special GUID (CLSID_ROWSET_TVP).</span></span> <span data-ttu-id="fb69c-114">Il membro *pwszName* contiene il nome del tipo di parametro con valori di tabella di cui il consumer intende creare un'istanza.</span><span class="sxs-lookup"><span data-stu-id="fb69c-114">The *pwszName* member contains the name of the table-valued parameter type that the consumer wants to instantiate.</span></span> <span data-ttu-id="fb69c-115">Il campo *eKind* sarà impostato su DBKIND_GUID_NAME.</span><span class="sxs-lookup"><span data-stu-id="fb69c-115">The *eKind* field will be set to DBKIND_GUID_NAME.</span></span> <span data-ttu-id="fb69c-116">Questo nome è necessario quando si tratta di un'istruzione SQL ad hoc; il nome è facoltativo se è una chiamata di procedura.</span><span class="sxs-lookup"><span data-stu-id="fb69c-116">This name is required when the statement is ad hoc SQL; the name is optional if it is a procedure call.</span></span>  
  
 <span data-ttu-id="fb69c-117">Per l'aggregazione il consumer passa il parametro *pUnkOuter* con IUnknown per il controllo.</span><span class="sxs-lookup"><span data-stu-id="fb69c-117">For aggregation, the consumer passes the *pUnkOuter* parameter with the controlling IUnknown.</span></span>  
  
 <span data-ttu-id="fb69c-118">Le proprietà dell'oggetto set di righe di parametri con valori di tabella sono di sola lettura, pertanto non è previsto che l'utente imposti proprietà in *rgPropertySets*.</span><span class="sxs-lookup"><span data-stu-id="fb69c-118">The table-valued parameter rowset object properties are read only, so the consumer is not expected to set any properties in *rgPropertySets*.</span></span>  
  
 <span data-ttu-id="fb69c-119">Per il membro *rgPropertySets* di ogni struttura DBCOLUMNDESC, il consumer può specificare proprietà aggiuntive per ogni colonna.</span><span class="sxs-lookup"><span data-stu-id="fb69c-119">For the *rgPropertySets* member of each DBCOLUMNDESC structure, the consumer can specify additional properties for each column.</span></span> <span data-ttu-id="fb69c-120">Queste proprietà appartengono al set di proprietà DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="fb69c-120">These properties belong to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span> <span data-ttu-id="fb69c-121">Tali proprietà consentono di specificare le impostazioni predefinite e calcolate per ogni colonna.</span><span class="sxs-lookup"><span data-stu-id="fb69c-121">They enable you to specify computed and default settings for each column.</span></span> <span data-ttu-id="fb69c-122">Supportano inoltre le proprietà esistenti della colonna, ad esempio nullability e identity.</span><span class="sxs-lookup"><span data-stu-id="fb69c-122">They also support existing column properties, such as nullability and identity.</span></span>  
  
 <span data-ttu-id="fb69c-123">Per recuperare le informazioni corrispondenti da un oggetto set di righe di parametri con valori di tabella, il consumer usa IRowsetInfo::GetProperties.</span><span class="sxs-lookup"><span data-stu-id="fb69c-123">To retrieve corresponding information from a table-valued parameter rowset object, the consumer uses IRowsetInfo::GetProperties.</span></span>  
  
 <span data-ttu-id="fb69c-124">Per recuperare informazioni sullo stato null, univoco, calcolato e di aggiornamento di ogni colonna, il consumer utilizza IColumnsRowset:: GetColumnsRowset o IColumnsInfo:: GetColumnInfo.</span><span class="sxs-lookup"><span data-stu-id="fb69c-124">To retrieve information about the null, unique, computed, and update status of each column, the consumer use IColumnsRowset::GetColumnsRowset or IColumnsInfo::GetColumnInfo.</span></span> <span data-ttu-id="fb69c-125">Questi metodi forniscono informazioni dettagliate su ogni colonna del set di righe di parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="fb69c-125">These methods provide detailed information about each table-valued parameter rowset column.</span></span>  
  
 <span data-ttu-id="fb69c-126">Il consumer specifica il tipo di ogni colonna del parametro con valori di tabella,</span><span class="sxs-lookup"><span data-stu-id="fb69c-126">The consumer specifies the type of each column of the table-valued parameter.</span></span> <span data-ttu-id="fb69c-127">analogamente al modo in cui vengono specificate le colonne quando viene creata una tabella in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fb69c-127">This is similar to how columns are specified when a table is created in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fb69c-128">Il consumer ottiene un oggetto set di righe di parametri con valori di tabella dal [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Provider OLE DB di Native client tramite il parametro di output *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="fb69c-128">The consumer obtains a table-valued parameter rowset object from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider through the *ppRowset* output parameter.</span></span>  
  
## <a name="dynamic-scenario"></a><span data-ttu-id="fb69c-129">Scenario dinamico</span><span class="sxs-lookup"><span data-stu-id="fb69c-129">Dynamic Scenario</span></span>  
 <span data-ttu-id="fb69c-130">Quando il consumer non dispone di informazioni sul tipo, è consigliabile utilizzare IOpenRowset:: OpenRowset per creare un'istanza di oggetti set di righe di parametri con valori di tabella.</span><span class="sxs-lookup"><span data-stu-id="fb69c-130">When the consumer does not have type information, it should use IOpenRowset::OpenRowset to instantiate table-valued parameter rowset objects.</span></span> <span data-ttu-id="fb69c-131">L'unica informazione che il consumer deve fornire al provider è il nome del tipo.</span><span class="sxs-lookup"><span data-stu-id="fb69c-131">All the consumer has to provide to the provider is the type name.</span></span>  
  
 <span data-ttu-id="fb69c-132">In questo scenario, il provider ottiene le informazioni sul tipo relative a un oggetto set di righe di parametri con valori di tabella dal server per conto del consumer.</span><span class="sxs-lookup"><span data-stu-id="fb69c-132">In this scenario, the provider obtains type information about a table-valued parameter rowset object from the server on behalf of the consumer.</span></span>  
  
 <span data-ttu-id="fb69c-133">I parametri *pTableID* e *pUnkOuter* devono essere impostati come nello scenario statico.</span><span class="sxs-lookup"><span data-stu-id="fb69c-133">The *pTableID* and *pUnkOuter* parameters should be set as in the static scenario.</span></span> <span data-ttu-id="fb69c-134">Il [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider di OLE DB di Native client ottiene quindi le informazioni sul tipo (vincoli e informazioni sulla colonna) dal server e restituisce un oggetto set di righe di parametri con valori di tabella tramite il parametro *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="fb69c-134">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider then obtains the type information (column information and constraints) from the server, and return a table-valued parameter rowset object through the *ppRowset* parameter.</span></span> <span data-ttu-id="fb69c-135">Questa operazione richiede la comunicazione con il server e pertanto viene eseguita in modo diverso rispetto allo scenario statico.</span><span class="sxs-lookup"><span data-stu-id="fb69c-135">This operation requires communication with the server, and therefore does not perform as well as the static scenario.</span></span> <span data-ttu-id="fb69c-136">Lo scenario dinamico funziona solo con le chiamate di procedura con parametri.</span><span class="sxs-lookup"><span data-stu-id="fb69c-136">The dynamic scenario works only with parameterized procedure calls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fb69c-137">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="fb69c-137">See Also</span></span>  
 <span data-ttu-id="fb69c-138">[Parametri con valori di tabella &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="fb69c-138">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="fb69c-139">Usare parametri con valori di tabella &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="fb69c-139">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
